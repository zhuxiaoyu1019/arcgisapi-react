/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{makeHandle as e}from"../../core/handleUtils.js";const t=Symbol("widget"),n=new WeakMap;function r(e,t){const n=t.vnodeSelector;if(a(n)){const r=t.properties||{},a=r.key||n;return{vnodeSelector:"div",properties:{parentWidget:e,widgetConstructor:n,key:a,widgetProps:{...r,key:a},afterCreate:o,afterUpdate:d,afterRemoved:i},children:void 0,text:void 0,domNode:null}}const c=t.children;if(c)for(let o=0;o<c.length;++o)c[o]=r(e,c[o]);return t}function o(t,r,o,{parentWidget:d,widgetConstructor:a,widgetProps:c}){const s=new a({...c,container:t});n.set(t,s),null==s.afterCreate||s.afterCreate(s,t),d._internalHandles.add(e((()=>i(t))))}function d(e,t,r,{widgetProps:o}){const d=n.get(e);d&&(d.set(o),null==d.afterUpdate||d.afterUpdate(d,e))}function i(e){const t=n.get(e);t&&(t.destroy(),n.delete(e))}function a(e){return"function"==typeof e&&e[t]}export{t as WIDGET_SYMBOL,a as isWidgetConstructor,r as processWidgets};
