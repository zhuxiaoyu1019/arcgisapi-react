/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import e from"../../../core/Handles.js";import{applySome as t,destroyMaybe as i}from"../../../core/maybe.js";import{reactionInit as o}from"../../../core/accessorSupport/trackingUtils.js";import{ElevationProfileState as s}from"./constants.js";import{HoveredPoints as r}from"./HoveredPoints.js";import{InputRepresentation3D as n}from"./InputRepresentation3D.js";import{ProfileLines3D as h}from"./ProfileLines3D.js";class p{constructor(i,s){this._handles=new e,this._inputRepresentation=new n({view:i}),this._hoveredPoints=new r({view:i}),this._profileLines=new h({view:i}),this._handles.add([o((()=>s.viewModel.hoveredPoints),(e=>this._hoveredPoints.update(e))),o((()=>{const{state:e,editable:i,highlightEnabled:o,viewModel:r}=s,n=r.input;return t(n,(e=>{e.commitProperty("geometry"),e.commitProperty("layer")})),{input:n,state:e,editable:i,highlightEnabled:o}}),(e=>this._updateInputRepresentation(e))),o((()=>s.viewModel.chartData),(e=>this._profileLines.update(e))),o((()=>t(s.viewModel.input,(e=>e.geometry))),(()=>{this._profileLines.remove()}))])}destroy(){this._handles=i(this._handles),this._inputRepresentation=i(this._inputRepresentation),this._hoveredPoints=i(this._hoveredPoints),this._profileLines=i(this._profileLines)}_updateInputRepresentation({input:e,state:t,editable:i,highlightEnabled:o}){const r=this._inputRepresentation;if(!o)return r.remove();t===s.Selected?r.showHighlight(e):t!==s.Created||i?r.remove():r.showReshaping(e)}}export{p as ElevationProfileView3D};
