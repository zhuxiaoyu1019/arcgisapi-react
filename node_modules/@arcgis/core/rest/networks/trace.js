/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import e from"../../request.js";import{parseUrl as t,encode as r,asValidOptions as o}from"../utils.js";import a from"./support/TraceResult.js";async function n(a,n,c){const i=t(a),s=n.toJSON();s.traceLocations=JSON.stringify(n.traceLocations);const l={...s,f:"json"},m=r({...i.query,...l}),p=o(m,c),u=`${i.path}/trace`;return e(u,p).then((e=>g(e,n.outSpatialReference)))}function g(e,t){const{data:r}=e;if(!r)return null;const o=a.fromJSON(r.traceResults);return o.aggregatedGeometry&&t&&(o.aggregatedGeometry.line&&(o.aggregatedGeometry.line.spatialReference=t.clone()),o.aggregatedGeometry.multipoint&&(o.aggregatedGeometry.multipoint.spatialReference=t.clone()),o.aggregatedGeometry.polygon&&(o.aggregatedGeometry.polygon.spatialReference=t.clone())),o}export{n as trace};
