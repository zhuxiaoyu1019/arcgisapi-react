/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import{makeHandle as e}from"../core/handleUtils.js";import{property as o}from"../core/accessorSupport/decorators/property.js";import"../core/has.js";import"../core/accessorSupport/ensureType.js";import"../core/Logger.js";import{subclass as s}from"../core/accessorSupport/decorators/subclass.js";import i from"../widgets/Widget.js";import{isWidget as r}from"../widgets/support/widget.js";import{createFocusTrap as n}from"focus-trap";import{tsx as a}from"../widgets/support/jsxFactory.js";import{messageBundle as c}from"../widgets/support/decorators/messageBundle.js";const d={base:"esri-identity-modal",open:"esri-identity-modal--open",closed:"esri-identity-modal--closed",title:"esri-identity-modal__title",dialog:"esri-identity-modal__dialog",content:"esri-identity-modal__content",closeButton:"esri-identity-modal__close-button",iconClose:"esri-icon-close"};let l=class extends i{constructor(t,e){super(t,e),this.container=document.createElement("div"),this.content=null,this.open=!1,this._close=()=>{this.open=!1},document.body.appendChild(this.container),this.own(this.watch("open",(()=>this._toggleFocusTrap())))}destroy(){this._destroyFocusTrap()}render(){const t=this.id,{open:e,content:o,title:s,messages:i}=this,r=e&&!!o,n={[d.open]:r,[d.closed]:!r},c=a("button",{class:d.closeButton,"aria-label":i.close,title:i.close,bind:this,onclick:this._close},a("span",{"aria-hidden":"true",class:d.iconClose})),l=`${t}_title`,p=`${t}_content`,u=s?a("h1",{id:l,class:d.title},s):null,m=r?a("div",{bind:this,class:d.dialog,role:"dialog","aria-labelledby":l,"aria-describedby":p,afterCreate:this._createFocusTrap},c,u,this._renderContent(p)):null;return a("div",{tabIndex:-1,class:this.classes(d.base,n)},m)}_destroyFocusTrap(){var t;null==(t=this._focusTrap)||t.deactivate({onDeactivate:null}),this._focusTrap=null}_toggleFocusTrap(){const{_focusTrap:t,open:e}=this;t&&(e?t.activate():t.deactivate())}_createFocusTrap(t){this._destroyFocusTrap();const o=requestAnimationFrame((()=>{this._focusTrap=n(t,{initialFocus:"input",onDeactivate:this._close}),this._toggleFocusTrap()}));this.own(e((()=>cancelAnimationFrame(o))))}_renderContent(t){const e=this.content;return"string"==typeof e?a("div",{class:d.content,id:t,innerHTML:e}):r(e)?a("div",{class:d.content,id:t},e.render()):e instanceof HTMLElement?a("div",{class:d.content,id:t,bind:e,afterCreate:this._attachToNode}):null}_attachToNode(t){const e=this;t.appendChild(e)}};t([o({readOnly:!0})],l.prototype,"container",void 0),t([o()],l.prototype,"content",void 0),t([o()],l.prototype,"open",void 0),t([o(),c("esri/t9n/common")],l.prototype,"messages",void 0),t([o({aliasOf:"messages.auth.signIn"})],l.prototype,"title",void 0),l=t([s("esri.identity.IdentityModal")],l);var p=l;export default p;
