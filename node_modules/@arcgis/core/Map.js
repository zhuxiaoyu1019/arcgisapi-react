/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{_ as e}from"./chunks/tslib.es6.js";import r from"./Basemap.js";import s from"./Ground.js";import t from"./core/Accessor.js";import o from"./core/CollectionFlattener.js";import a from"./core/Evented.js";import l from"./core/Logger.js";import{property as i}from"./core/accessorSupport/decorators/property.js";import"./core/has.js";import{cast as n}from"./core/accessorSupport/decorators/cast.js";import{subclass as p}from"./core/accessorSupport/decorators/subclass.js";import{isEditableLayer as d}from"./layers/support/editableLayers.js";import{createCache as u,destroyCache as m,ensureType as c}from"./support/basemapUtils.js";import{ensureType as y}from"./support/groundUtils.js";import{LayersMixin as h}from"./support/LayersMixin.js";import{TablesMixin as b}from"./support/TablesMixin.js";const f=l.getLogger("esri.Map");let g=class extends(b(h(a.EventedMixin(t)))){constructor(e){super(e),this.allLayers=new o({getCollections:()=>{var e,r,s;return[null==(e=this.basemap)?void 0:e.baseLayers,null==(r=this.ground)?void 0:r.layers,this.layers,null==(s=this.basemap)?void 0:s.referenceLayers]},getChildrenFunction:e=>"layers"in e?e.layers:null}),this.allTables=new o({getCollections:()=>[this.tables,this.layers],getChildrenFunction:e=>{const r=[];return"tables"in e&&r.push(e.tables),"layers"in e&&r.push(e.layers),r},itemFilterFunction:e=>{const r=e.parent;return r&&"tables"in r&&r.tables.includes(e)}}),this.basemap=null,this.editableLayers=new o({getCollections:()=>[this.allLayers],itemFilterFunction:d}),this.ground=new s,this._basemapCache=u()}destroy(){var e,r;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),null==(e=this.ground)||e.destroy(),null==(r=this.basemap)||r.destroy(),m(this._basemapCache),this._basemapCache=null}castBasemap(e){return c(e,this._basemapCache)}castGround(e){const r=y(e);return r||(f.error("Map.ground may not be set to null or undefined"),this._get("ground"))}findLayerById(e){return this.allLayers.find((r=>r.id===e))}findTableById(e){return this.allTables.find((r=>r.id===e))}};e([i({readOnly:!0,dependsOn:[]})],g.prototype,"allLayers",void 0),e([i({readOnly:!0})],g.prototype,"allTables",void 0),e([i({type:r})],g.prototype,"basemap",void 0),e([n("basemap")],g.prototype,"castBasemap",null),e([i({readOnly:!0})],g.prototype,"editableLayers",void 0),e([i({type:s,nonNullable:!0})],g.prototype,"ground",void 0),e([n("ground")],g.prototype,"castGround",null),g=e([p("esri.Map")],g);var j=g;export default j;
