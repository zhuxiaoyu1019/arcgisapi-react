/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{_ as t}from"../../chunks/tslib.es6.js";import{empty as i,insertBefore as o}from"../../core/domUtils.js";import e from"../../core/Evented.js";import n from"../../core/Handles.js";import{init as r}from"../../core/watchUtils.js";import{property as s}from"../../core/accessorSupport/decorators/property.js";import"../../core/has.js";import{cast as a}from"../../core/accessorSupport/decorators/cast.js";import"../../core/Logger.js";import{subclass as d}from"../../core/accessorSupport/decorators/subclass.js";import p from"./Component.js";import{getCalciteThemeClass as c,isRTL as l}from"../../widgets/support/widgetUtils.js";const h={left:0,top:0,bottom:0,right:0},m={bottom:30,top:15,right:15,left:15},u="manual",f={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function _(t){return t&&!t._started&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}function g(t){return"object"==typeof t&&!(t instanceof p)&&!("declaredClass"in t)&&("component"in t||"index"in t||"position"in t)?t:null}function y(t,{top:i,bottom:o,left:e,right:n}){t.style.top=i,t.style.bottom=o,t.style.left=e,t.style.right=n}let C=class extends e.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new n,this.view=null,this._initContainers()}initialize(){this._handles.add([r(this,"view.padding, container",this._applyViewPadding.bind(this)),r(this,"padding",this._applyUIPadding.bind(this))])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(t){const o=this._get("container");t!==o&&(t&&(t.classList.add(f.ui),t.classList.add(c()),this._attachContainers(t)),o&&(o.classList.remove(f.ui),y(o,{top:"",bottom:"",left:"",right:""}),i(o)),this._set("container",t))}get height(){const t=this.get("view.height")||0;if(0===t)return t;const i=this._getViewPadding(),o=i.top+i.bottom;return Math.max(t-o,0)}get padding(){return this._get("padding")}set padding(t){t?this._override("padding",t):this._clearOverride("padding")}castPadding(t){return"number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...m,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const i=this._getViewPadding(),o=i.left+i.right;return Math.max(t-o,0)}add(t,i){let o,e;if(Array.isArray(t))return void t.forEach((t=>this.add(t,i)));const n=g(t);n&&({index:o,position:i,component:t,key:e}=n),i&&"object"==typeof i&&({index:o,key:e,position:i}=i),!t||i&&!this._isValidPosition(i)||this._add(t,i,o,e)}remove(t,i){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,i)));const o=this._find(t);if(o){const e=this._componentToKey;if(e.has(t)&&e.get(t)!==i)return;const n=this._components.indexOf(o);return o.node.parentNode&&o.node.parentNode.removeChild(o.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){if(Array.isArray(t))return t.map((t=>this.empty(t))).reduce(((t,i)=>t.concat(i)));if((t=t||u)===u){return Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(f.corner))).map((t=>this.remove(t)))}return this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,i){if(Array.isArray(t)&&t.forEach((t=>this.move(t,i))),!t)return;let o;const e=g(t)||g(i);if(e&&(o=e.index,i=e.position,t=e.component||t),i&&!this._isValidPosition(i))return;const n=this.remove(t);n&&this.add(n,{position:i,index:o})}find(t){if(!t)return null;const i=this._findById(t);return i&&(i.widget||i.node)}getPosition(t){for(const i in this._positionNameToContainerLookup){if(this._positionNameToContainerLookup[i].contains(t))return i}return null}_add(t,i,o,e){t instanceof p||(t=new p({node:t})),this._place({component:t,position:i,index:o}),this._components.push(t),e&&this._componentToKey.set(t,e)}_find(t){return t?t instanceof p?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||h}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add(f.innerContainer),t.classList.add(f.cornerContainer);const i=document.createElement("div");i.classList.add(f.innerContainer),i.classList.add(f.manualContainer);const o=document.createElement("div");o.classList.add(f.topLeft),o.classList.add(f.corner),t.appendChild(o);const e=document.createElement("div");e.classList.add(f.topRight),e.classList.add(f.corner),t.appendChild(e);const n=document.createElement("div");n.classList.add(f.bottomLeft),n.classList.add(f.corner),t.appendChild(n);const r=document.createElement("div");r.classList.add(f.bottomRight),r.classList.add(f.corner),t.appendChild(r),this._innerContainer=t,this._manualContainer=i;const s=l();this._cornerNameToContainerLookup={"top-left":o,"top-right":e,"bottom-left":n,"bottom-right":r,"top-leading":s?e:o,"top-trailing":s?o:e,"bottom-leading":s?r:n,"bottom-trailing":s?n:r},this._positionNameToContainerLookup={manual:i,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const i=t.component,e=t.position||u,n=t.index,r=this._positionNameToContainerLookup[e],s=n>-1;if(_(i.widget)&&i.widget.startup(),!s)return void r.appendChild(i.node);const a=Array.prototype.slice.call(r.children);if(0===n)return void(r.firstChild?o(i.node,r.firstChild):r.appendChild(i.node));n>=a.length?r.appendChild(i.node):o(i.node,a[n])}_applyViewPadding(){const t=this.container;t&&y(t,this._toPxPosition(this._getViewPadding()))}_applyUIPadding(){const t=this._innerContainer;t&&y(t,this._toPxPosition(this.padding))}_toPxPosition(t){return{top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let i,o=null;return this._components.some((e=>(i=e===t,i&&(o=e),i))),o}_findById(t){let i,o=null;return this._components.some((e=>(i=e.id===t,i&&(o=e),i))),o}_findByNode(t){let i,o=null;return this._components.some((e=>(i=e.node===t,i&&(o=e),i))),o}};t([s()],C.prototype,"container",null),t([s()],C.prototype,"height",null),t([s({value:m})],C.prototype,"padding",null),t([a("padding")],C.prototype,"castPadding",null),t([s()],C.prototype,"view",void 0),t([s()],C.prototype,"width",null),C=t([d("esri.views.ui.UI")],C);var v=C;export default v;
