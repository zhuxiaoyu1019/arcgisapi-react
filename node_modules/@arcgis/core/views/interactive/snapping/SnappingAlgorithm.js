/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{isSome as e}from"../../../core/maybe.js";import{defaults as t}from"./Settings.js";import{squareDistance as s,anyMapPointToScreenPoint as r}from"./snappingUtils.js";class i{constructor(e,s){this.view=e,this.options=s,this.squaredShortLineThreshold=t.shortLineThreshold*t.shortLineThreshold}snap(t,s){return e(s.vertexHandle)?"vertex"!==s.vertexHandle.type?[]:this.snapExistingVertex(t,s):this.snapNewVertex(t,s)}edgeExceedsShortLineThreshold(e,t){return this.exceedsShortLineThreshold(e.left.pos,e.right.pos,t)}exceedsShortLineThreshold(e,t,{elevationInfo:i,geometry:o}){const h=o.editGeometry.coordinateHelper;return 0===this.squaredShortLineThreshold||s(r(t,h,i,this.view),r(e,h,i,this.view))>this.squaredShortLineThreshold}squaredProximityTreshold(e){return"touch"===e?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold}get squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,s=e*t;return s*s}}export{i as SnappingAlgorithm};
