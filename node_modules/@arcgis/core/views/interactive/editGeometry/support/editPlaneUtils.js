/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{a as s,b as o,h as i,p as n,s as r,u as t,w as a,i as e}from"../../../../chunks/vec2.js";import{b as c,G as b,a as g,f,e as u,c as p,n as m,d as I,l as d}from"../../../../chunks/vec3.js";import{f as N,Z as j}from"../../../../chunks/vec3f64.js";import{a as E,u as T}from"../../../../chunks/boundedPlane.js";import{sv2d as V,sv3d as h}from"../../../../geometry/support/vectorStacks.js";import{MoveVertex as x}from"../operations/MoveVertex.js";import{RotateVertex as v}from"../operations/RotateVertex.js";import{ScaleVertex as R}from"../operations/ScaleVertex.js";import{UpdateVertices as k}from"../operations/UpdateVertices.js";function l(s,o){return F(s,o,!1)}function C(s,o){return F(s,o,!0)}function F(s,o,i){if(s instanceof k){if(s.operation instanceof x)return S(s.operation,o,i),!0;if(s.operation instanceof v)return Y(s.operation,o,i),!0;if(s.operation instanceof R)return _(s.operation,o,i),!0}return!1}function S(s,o,i=!1){const n=i?-1:1,r=N(n*s.dx,n*s.dy,n*s.dz);c(o.origin,o.origin,r)}function Y(s,o,i=!1){const n=i?-s.angle:s.angle;b(o.basis1,o.basis1,j,n),b(o.basis2,o.basis2,j,n)}function _(s,o,i=!1){const n=i?1/s.factor1:s.factor1,r=i?1/s.factor2:s.factor2;g(o.basis1,o.basis1,n),g(o.basis2,o.basis2,r),G(o.origin,s.origin,s.axis1,n),G(o.origin,s.origin,s.axis2,r)}function G(r,t,a,e){const c=V.get(),b=s(c,r,t),g=o(c,a,i(a,b));n(r,r,g,e-1)}function P(n,c,b,g){g||(g=E());const f=r(V.get(),n[1],-n[0]),u=r(V.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),p=r(V.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),m=V.get();c.components.forEach((s=>s.vertices.forEach((s=>{const o=s.pos;r(m,i(n,o),i(f,o)),t(u,u,m),a(p,p,m)}))));const I=1e-6,d=r(V.get(),p[0]-u[0]<I?b/2:0,p[1]-u[1]<I?b/2:0);return s(u,u,d),e(p,p,d),o(g.basis1,n,(p[0]-u[0])/2),o(g.basis2,f,(p[1]-u[1])/2),r(g.origin,u[0]*n[0]+u[1]*f[0],u[0]*n[1]+u[1]*f[1]),e(g.origin,g.origin,g.basis1),e(g.origin,g.origin,g.basis2),g}function y(s,o,i,n=0,r){r||(r=E()),o.toRenderCoords(s.origin,i,r.origin);const t=h.get();c(t,s.origin,s.basis1),c(t,t,s.basis2),o.toRenderCoords(t,i,t);const a=h.get();c(a,s.origin,s.basis1),f(a,a,s.basis2),o.toRenderCoords(a,i,a);const e=h.get();f(e,s.origin,s.basis1),f(e,e,s.basis2),o.toRenderCoords(e,i,e);const b=h.get();f(b,s.origin,s.basis1),c(b,b,s.basis2),o.toRenderCoords(b,i,b);const N=u(h.get(),t,a,.5);f(N,N,r.origin);const j=u(h.get(),e,b,.5);f(j,r.origin,j),u(r.basis1,N,j,.5);const V=u(h.get(),b,t,.5);f(V,V,r.origin);const x=u(h.get(),a,e,.5);f(x,r.origin,x),u(r.basis2,V,x,.5);const v=p(h.get(),r.basis1,r.basis2),R=p(v,v,r.basis1);return m(R,R),g(r.basis2,R,I(r.basis2,R)),g(r.basis1,r.basis1,1+n/d(r.basis1)),g(r.basis2,r.basis2,1+n/d(r.basis2)),T(r),r}export{l as apply,P as calculateOrientedBounds,y as mapPlaneToRenderPlane,C as unapply};
