/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import t from"../../core/Evented.js";import r from"../../core/Logger.js";import{property as o}from"../../core/accessorSupport/decorators/property.js";import"../../core/has.js";import"../../core/accessorSupport/ensureType.js";import{subclass as i}from"../../core/accessorSupport/decorators/subclass.js";import{toExtent as s}from"../../geometry/support/aaBoundingRect.js";import{extentContainsPoint as n}from"../../geometry/support/contains.js";import{canProject as a}from"../../geometry/support/webMercatorUtils.js";import{updateGeometryElevation as p}from"../../layers/support/ElevationSampler.js";import{getElevationAtPoint as l}from"../3d/support/ElevationProvider.js";import{ELEVATION_NODATA_VALUE as m}from"../3d/terrain/TerrainConst.js";const c=r.getLogger("esri.views.support.GroundViewElevationSampler");let u=class extends t.EventedAccessor{constructor(e){super(e),this.demResolution={min:-1,max:-1},this.noDataValue=m}initialize(){this.view.basemapTerrain.on("elevation-change",(()=>this.emit("changed",{})))}get extent(){const e=this.view.basemapTerrain;return e.extent&&e.spatialReference?s(e.extent,e.spatialReference):null}elevationAt(e){const t=e.spatialReference,r=this.spatialReference;if(!a(t,r)){const e=t?t.wkid:"unknown";return c.error(`Cannot sample elevation at a location with spatial reference (${e}) different from the view (${r.wkid})`),null}if(!n(this.extent,e)){const t=this.extent,r=`${t.xmin}, ${t.ymin}, ${t.xmax}, ${t.ymax}`;c.warn("#elevationAt()",`Point used to sample elevation (${e.x}, ${e.y}) is outside of the sampler extent (${r})`)}return l(this.view.elevationProvider,e)}queryElevation(e){return p(e.clone(),this)}};e([o({readOnly:!0})],u.prototype,"demResolution",void 0),e([o({readOnly:!0})],u.prototype,"extent",null),e([o({readOnly:!0})],u.prototype,"noDataValue",void 0),e([o({readOnly:!0,aliasOf:"view.basemapTerrain.spatialReference"})],u.prototype,"spatialReference",void 0),e([o({constructOnly:!0})],u.prototype,"view",void 0),u=e([i("esri.views.support.GroundViewElevationSampler")],u);var d=u;export default d;
