/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{g as i,a as t,b as n}from"../../../../chunks/vec3.js";import{c as s,f as o}from"../../../../chunks/vec3f64.js";import{SphericalHarmonicsAmbientLight as r}from"./Lightsources.js";import{combineLights as h}from"./SphericalHarmonics.js";class e{constructor(){this._shOrder=2,this._ambientBoost=.4,this._oldSunlight={direction:s(),ambient:{color:s(),intensity:1},diffuse:{color:s(),intensity:1}},this.globalFactor=.5,this.groundLightingFactor=.5,this._sphericalHarmonics=new r,this._mainLight={intensity:s(),direction:o(1,0,0),castShadows:!1}}get lightingMainDirection(){return this._mainLight.direction}setLightDirectionUniform(i){i.setUniform3fv("lightingMainDirection",this._mainLight.direction)}setUniforms(i,t=!1){const n=t?(1-this.groundLightingFactor)*(1-this.globalFactor):0;i.setUniform1f("lightingFixedFactor",n),i.setUniform1f("lightingGlobalFactor",this.globalFactor),this.setLightDirectionUniform(i),i.setUniform3fv("lightingMainIntensity",this._mainLight.intensity),i.setUniform1f("ambientBoostFactor",this._ambientBoost);const s=this._sphericalHarmonics;0===this._shOrder?i.setUniform3f("lightingAmbientSH0",s.r[0],s.g[0],s.b[0]):1===this._shOrder?(i.setUniform4f("lightingAmbientSH_R",s.r[0],s.r[1],s.r[2],s.r[3]),i.setUniform4f("lightingAmbientSH_G",s.g[0],s.g[1],s.g[2],s.g[3]),i.setUniform4f("lightingAmbientSH_B",s.b[0],s.b[1],s.b[2],s.b[3])):2===this._shOrder&&(i.setUniform3f("lightingAmbientSH0",s.r[0],s.g[0],s.b[0]),i.setUniform4f("lightingAmbientSH_R1",s.r[1],s.r[2],s.r[3],s.r[4]),i.setUniform4f("lightingAmbientSH_G1",s.g[1],s.g[2],s.g[3],s.g[4]),i.setUniform4f("lightingAmbientSH_B1",s.b[1],s.b[2],s.b[3],s.b[4]),i.setUniform4f("lightingAmbientSH_R2",s.r[5],s.r[6],s.r[7],s.r[8]),i.setUniform4f("lightingAmbientSH_G2",s.g[5],s.g[6],s.g[7],s.g[8]),i.setUniform4f("lightingAmbientSH_B2",s.b[5],s.b[6],s.b[7],s.b[8]))}set(s){h(s,this._shOrder,this._mainLight,this._sphericalHarmonics),i(this._oldSunlight.direction,this._mainLight.direction);const o=1/Math.PI;this._oldSunlight.ambient.color[0]=.282095*this._sphericalHarmonics.r[0]*o,this._oldSunlight.ambient.color[1]=.282095*this._sphericalHarmonics.g[0]*o,this._oldSunlight.ambient.color[2]=.282095*this._sphericalHarmonics.b[0]*o,t(this._oldSunlight.diffuse.color,this._mainLight.intensity,o),i(g,this._oldSunlight.diffuse.color),t(g,g,this._ambientBoost*this.globalFactor),n(this._oldSunlight.ambient.color,this._oldSunlight.ambient.color,g)}get old(){return this._oldSunlight}}const g=s();export{e as SceneLighting};
