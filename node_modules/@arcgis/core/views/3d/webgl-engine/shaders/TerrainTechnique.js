/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{_ as e}from"../../../../chunks/tslib.es6.js";import{T as r}from"../../../../chunks/Terrain.glsl.js";import{ReloadableShaderModule as o}from"../core/shaderTechnique/ReloadableShaderModule.js";import{ShaderTechnique as t}from"../core/shaderTechnique/ShaderTechnique.js";import{ShaderTechniqueConfiguration as i,parameter as d}from"../core/shaderTechnique/ShaderTechniqueConfiguration.js";import{Default3D as s}from"../lib/DefaultVertexAttributeLocations.js";import{Program as n}from"../lib/Program.js";import{renderWhenBitIsNotSet as l}from"../lib/StencilUtils.js";import{makePipelineState as a,simpleBlendingParams as c,backFaceCullingParams as p,defaultDepthWriteParams as u,defaultColorWriteParams as h}from"../../../webgl/renderState.js";class b extends t{initializeProgram(e){const r=b.shader.get(),o=this.configuration,t=r.build({overlayMode:o.overlayMode,output:o.output,viewingMode:e.viewingMode,slicePlaneEnabled:o.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,textureFadingEnabled:o.textureFadingEnabled&&!o.renderOccluded,hasBackgroundColor:o.hasBackgroundColor,useGrid:o.useGrid,receiveShadows:o.receiveShadows&&!o.renderOccluded,receiveAmbientOcclusion:!1,atmosphere:o.atmosphere,tileBorders:o.tileBorders,screenSizePerspective:o.screenSizePerspective,pbrMode:0,ssrEnabled:o.ssrEnabled,highStepCount:!1});return new n(e.rctx,t,s)}initializePipeline(){const e=this.configuration,r=e.backfaceCullingEnabled&&!e.renderOccluded;return a({blending:e.renderOccluded?c(1,771):null,culling:r&&p,depthTest:!e.renderOccluded&&{func:513},depthWrite:!e.renderOccluded&&u,colorWrite:h,stencilTest:e.stencilEnabled?l(1):null})}}b.shader=new o(r,(()=>import("../core/shaderLibrary/terrain/Terrain.glsl.js")));class v extends i{constructor(){super(...arguments),this.output=0,this.overlayMode=0,this.atmosphere=!1,this.receiveShadows=!1,this.slicePlaneEnabled=!1,this.backfaceCullingEnabled=!1,this.stencilEnabled=!1,this.textureFadingEnabled=!1,this.hasBackgroundColor=!1,this.useGrid=!1,this.renderOccluded=!1,this.ssrEnabled=!1,this.tileBorders=!1,this.screenSizePerspective=!1}}e([d({count:8})],v.prototype,"output",void 0),e([d({count:3})],v.prototype,"overlayMode",void 0),e([d()],v.prototype,"atmosphere",void 0),e([d()],v.prototype,"receiveShadows",void 0),e([d()],v.prototype,"slicePlaneEnabled",void 0),e([d()],v.prototype,"backfaceCullingEnabled",void 0),e([d()],v.prototype,"stencilEnabled",void 0),e([d()],v.prototype,"textureFadingEnabled",void 0),e([d()],v.prototype,"hasBackgroundColor",void 0),e([d()],v.prototype,"useGrid",void 0),e([d()],v.prototype,"renderOccluded",void 0),e([d()],v.prototype,"ssrEnabled",void 0),e([d()],v.prototype,"tileBorders",void 0),e([d()],v.prototype,"screenSizePerspective",void 0);export{b as TerrainTechnique,v as TerrainTechniqueConfiguration};
