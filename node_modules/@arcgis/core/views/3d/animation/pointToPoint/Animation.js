/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{Milliseconds as t,MillisecondsFromSeconds as i}from"../../../../core/time.js";import{f as e,l as r,g as n}from"../../../../chunks/vec3.js";import{c as m}from"../../../../chunks/vec3f64.js";import o from"./Camera.js";import s from"../../webgl-engine/lib/Camera.js";import{Animation as a}from"../../../animation/pointToPoint/Animation.js";const c=m();class h{constructor(i){this.currentTime=t(0),this._animation=new a((()=>new o(i))),this._current=new o(i)}get finished(){return this.currentTime>=this._animation.time}get time(){return this._animation.time}update(i,m,o){const s=this._animation.definition.source,a=this._animation.definition.target,h=e(c,m.center,i.center),u=r(h);u>=1e-5?(h[0]/=u,h[1]/=u,h[2]/=u):(h[0]=0,h[1]=1,h[0]=0),n(s.lookAtDirection,h),n(a.lookAtDirection,h),s.copyFromRenderCamera(i),a.copyFromRenderCamera(m),this._current.copyFrom(s),this._animation.update(s,a,o),this.currentTime=t(0),i.almostEquals(m)&&(this.currentTime=this._animation.time)}cameraAt(t,i){return this._animation.cameraAt(t,this._current),i=i||new s,this._current.copyToRenderCamera(i),i}step(e,r){return this.finished||(this.currentTime=t(this.currentTime+i(e)),this.currentTime>=this.time&&(this.currentTime=this.time)),this.cameraAt(this.currentTime/this.time,r)}}export default h;export{h as Animation};
