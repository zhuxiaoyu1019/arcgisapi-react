/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{_ as e}from"../../../../../chunks/tslib.es6.js";import t from"../../../../../core/Handles.js";import{property as s}from"../../../../../core/accessorSupport/decorators/property.js";import"../../../../../core/has.js";import"../../../../../core/accessorSupport/ensureType.js";import"../../../../../core/Logger.js";import{subclass as i}from"../../../../../core/accessorSupport/decorators/subclass.js";import r from"./AreaMeasurement3DController.js";import a from"./AreaMeasurement3DModel.js";import o from"./AreaMeasurement3DView.js";import{InteractiveToolBase as n}from"../../../../interactive/InteractiveToolBase.js";let l=class extends n{constructor(e){super(e),this._handles=new t,this.model=new a({sceneView:e.view}),this.measurementView=new o({model:this.model,unit:e.unit,manipulators:this.manipulators})}initialize(){this.measurementView.when().then((()=>this._initialize()))}_initialize(){switch(this.toolState){case"pending":case"creating":case"created":break;case"destroyed":return}this._controller=new r(this.model,this.measurementView,this.manipulators),this.visible&&this.measurementView.show();const e=this.watch("state",(e=>{switch(e){case"measured":this.complete();break;case"measuring":case"ready":default:this.finishToolCreation()}}));this._handles.add(e),"measured"===this.state?this.complete():this.startToolCreation()}destroy(){switch(this.toolState){case"pending":this.measurementView.destroy(),this._set("measurementView",null),this.model.destroy(),this._set("model",null);break;case"creating":case"created":this.detach(),this.measurementView.destroy(),this._set("measurementView",null),this.model.destroy(),this._set("model",null),this._controller.destroy(),this._controller=null,this._handles.destroy(),this._handles=null}}get state(){switch(this.model.state){case"initial":return this.measurementView.path.numVertices>=1?"measuring":"ready";case"drawing":case"editing":return"measuring";case"measured":return"measured"}}get isSupported(){return"3d"===this.get("view.type")}get cursor(){switch(this.toolState){case"destroyed":return null;default:if(this.model.active&&("initial"===this.model.state||"drawing"===this.model.state))return"crosshair"}return null}set unit(e){this._set("unit",e),"ready"===this.measurementView.state&&(this.measurementView.layerView.unit=e)}activate(){this.model.active=!0}deactivate(){switch(this.toolState){case"created":case"creating":case"pending":this.model.active=!1}}onShow(){this.created&&this.measurementView.show()}onHide(){this.created&&this.measurementView.hide()}onDetach(){switch(this.toolState){case"created":case"creating":this.measurementView.path.clear(),this.measurementView.cursorPoint=null,this.model.state="initial"}}onInputEvent(e){this._controller.handleInputEvent(e)}};e([s({readOnly:!0})],l.prototype,"state",null),e([s({readOnly:!0})],l.prototype,"isSupported",null),e([s({readOnly:!0})],l.prototype,"cursor",null),e([s()],l.prototype,"unit",null),e([s({constructOnly:!0})],l.prototype,"model",void 0),e([s({constructOnly:!0})],l.prototype,"measurementView",void 0),l=e([i("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],l);var m=l;export default m;
