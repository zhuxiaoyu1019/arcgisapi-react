/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{createAbortController as t,isAbortError as o}from"../../../../core/promiseUtils.js";class l{constructor(t){this.schedule=t,this._abortController=null,this._loadStatus=0,this._loadError=null,this._loader=null,this.logger=null}get loadStatus(){return this._loadStatus}load(l,r){return 1===this._loadStatus?(l&&l(),this._loader):2===this._loadStatus?(r&&r(this._loadError),this._loader):(this._loader||(this._abortController=t(),this._loader=this.doLoad(this._abortController.signal).then((()=>{this._abortController=null,this._loadStatus=1}),(t=>{throw this._loadError=t,this._abortController=null,this._loadStatus=2,!o(t)&&this.logger&&t.message&&this.logger.warn(t.message),t}))),this._loader.then(l,r).catch((()=>{})),this._loader)}abortLoad(){this._abortController?(this._abortController.abort(),this._abortController=null):0===this._loadStatus&&(this._loadStatus=2),this._loader=null}}export{l as Loadable};
