/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{isSome as e,isNone as r}from"../../../../../core/maybe.js";import"../../../../../core/has.js";import{BufferData as o}from"./BufferData.js";import{DisplayRecordReader as t}from"./DisplayRecordReader.js";class s{constructor(){this._pools=new Map}acquire(e,r,s=0){const i=t.from(e.records,s),c=i.size();i.next();const n=i.vertexCount,u=i.indexCount,a=this._tryAcquire(e.stride,r,n,u);return o.createPooled(a,e,r,n,u,c,this)}release(e){e.isReleased||e.destroy()}destroy(){this._pools.forEach((r=>{e(r)&&r.clear((e=>e.destroy()))}))}_tryAcquire(o,t,s,i){const c=o<<3|t,n=this._pools.get(c);if(r(n))return null;const u=n.dequeue();return e(u)&&u.vertexBufferSize>=s&&u.indexBufferSize>=i?u:null}}export{s as BufferDataPool};
