/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{isNone as t}from"../../../../../core/maybe.js";import{f as r}from"../../../../../chunks/vec4f32.js";import{createProgramDescriptor as s}from"../Utils.js";import e from"./WGLBrush.js";import{background as o}from"../shaders/BackgroundPrograms.js";import{createProgram as i}from"../../../../webgl/programUtils.js";const a=()=>s("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});class n extends e{constructor(){super(...arguments),this._color=r(0,1,0,1)}dispose(){this._program&&this._program.dispose()}prepareState({context:t}){t.setStencilTestEnabled(!0),t.setBlendingEnabled(!1),t.setFaceCullingEnabled(!1),t.setColorMask(!1,!1,!1,!1),t.setStencilOp(7680,7680,7681),t.setStencilWriteMask(255),t.setStencilFunction(519,0,255)}draw(r,s){const{context:e,state:n}=r,m=a(),p=s.getVAO(e,n,m.attributes,m.bufferLayouts);t(p.indexBuffer)||(this._program||(this._program=i(e,o)),e.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",n.displayMat3),e.bindVAO(p),e.drawElements(4,p.indexBuffer.size,5125,0),e.bindVAO())}}export default n;
