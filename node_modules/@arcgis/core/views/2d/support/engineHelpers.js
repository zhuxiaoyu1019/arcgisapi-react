/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{pt2px as e}from"../../../core/screenUtils.js";import{getXAnchorDirection as t,getYAnchorDirection as i}from"../engine/webgl/alignmentUtils.js";import{MAGIC_LABEL_LINE_HEIGHT as n,GLYPH_SIZE as o}from"../engine/webgl/definitions.js";import{shapeGlyphs as s}from"../engine/webgl/mesh/templates/shapingUtils.js";import{bidiText as a}from"../engine/webgl/util/BidiText.js";async function l(l,r,m){const g=t("center"),f=i("middle"),h=r.textureManager.rasterizeItem(l.toJSON(),window.devicePixelRatio||1,null,m),[,d]=a(l.text),c=(await h).glyphMosaicItems;return s(c,d,{angle:l.angle||0,xOffset:e(l.xoffset||0),yOffset:e(l.yoffset||0),lineHeight:n*Math.max(.25,Math.min(l.lineHeight,4)),maxLineWidth:Math.max(32,Math.min(e(l.lineWidth),512)),decoration:l.font.decoration,scale:Math.min(Math.round(e(l.font.size)),127)/o,hAlign:g,vAlign:f,isCIM:!1}).boundsT}export{l as getTextBounds};
