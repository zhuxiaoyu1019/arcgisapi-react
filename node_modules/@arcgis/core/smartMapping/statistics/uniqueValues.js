/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import e from"../../core/Error.js";import{isSome as r}from"../../core/maybe.js";import{verifyBasicFieldValidity as s}from"./support/utils.js";import{getFieldsList as i}from"../support/utils.js";import{createLayerAdapter as a,getLayerTypeLabels as n}from"../support/adapters/support/layerUtils.js";async function o(o){if(!o||!o.layer||!o.field&&!o.valueExpression)throw new e("unique-values:missing-parameters","'layer' and 'field' or 'valueExpression' parameters are required");const t=o.valueExpression||o.sqlExpression,u=t&&!o.sqlExpression;if(t)if(u){if(!o.view)throw new e("unique-values:missing-parameters","View is required when 'valueExpression' is specified")}else if(!o.valueExpression)throw new e("unique-values:missing-parameters","'valueExpression' parameters are required");const l=[0,2,1,3,4,5],{layer:p,...m}=o,f=a(p,l),d={layerAdapter:f,...m};if(!f)throw new e("unique-values:invalid-parameters","'layer' must be one of these types: "+n(l).join(", "));const v=r(d.signal)?{signal:d.signal}:null;await f.load(v);const w=await i({field:d.field,valueExpression:d.valueExpression}),c=s(f,w,"unique-values:invalid-parameters");if(c)throw c;return d}async function t(e){const{layerAdapter:r,...s}=await o(e);return r.uniqueValues(s)}export default t;
