{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isNone as t, isSome as i, unwrapOr as r } from \"../../../../core/maybe.js\";\nimport { generateUID as s } from \"../../../../core/uid.js\";\nimport { d as a } from \"../../../../chunks/mat4.js\";\nimport { c as n, I as e } from \"../../../../chunks/mat4f64.js\";\nimport { m as o } from \"../../../../chunks/vec3.js\";\nimport { c as h } from \"../../../../chunks/vec4f64.js\";\nimport { maxScale as m } from \"../../support/mathUtils.js\";\nimport { computeAttachmentOriginTriangles as u } from \"./geometryDataUtils.js\";\nimport { Object3DStateID as d } from \"./Object3DStateID.js\";\nimport { addObject3DStateID as f, removeObject3DStateID as c } from \"../materials/renderers/utils.js\";\n\nclass l {\n  constructor(t, i, r = null, a = null, e = s(), o = null, m = null, u = !1) {\n    this.data = t, this.material = i, this.layerUid = r, this.graphicUid = a, this.id = e, this.boundingInfo = o, this.calculateShaderTransformation = m, this.castShadow = u, this.boundingSphere = h(), this.instanceParameters = {\n      highlights: null,\n      occludees: null,\n      visible: !0\n    }, this._transformation = n(), this._shaderTransformationDirty = !0;\n  }\n\n  get transformation() {\n    return this._transformation;\n  }\n\n  updateTransformation(t) {\n    t(this._transformation), this._shaderTransformationDirty = !0, this.computeBoundingSphere(this._transformation, this.boundingSphere);\n  }\n\n  shaderTransformationChanged() {\n    this._shaderTransformationDirty = !0;\n  }\n\n  computeBoundingSphere(i, r, s = m(i)) {\n    t(this.boundingInfo) || (o(r, this.boundingInfo.getCenter(), i), r[3] = this.boundingInfo.getBSRadius() * s);\n  }\n\n  get hasShaderTransformation() {\n    return i(this.calculateShaderTransformation);\n  }\n\n  get primitiveType() {\n    return this.data.primitiveType;\n  }\n\n  getShaderTransformation() {\n    return t(this.calculateShaderTransformation) ? r(this.transformation, e) : (this._shaderTransformationDirty && (this._shaderTransformation || (this._shaderTransformation = n()), a(this._shaderTransformation, this.calculateShaderTransformation(r(this.transformation, e))), this._shaderTransformationDirty = !1), this._shaderTransformation);\n  }\n\n  computeAttachmentOrigin(t) {\n    if (this.material.computeAttachmentOrigin) return !!this.material.computeAttachmentOrigin(this, t) && (i(this._transformation) && o(t, t, this._transformation), !0);\n    const r = this.indices.get(\"position\"),\n          s = this.vertexAttributes.get(\"position\");\n    return !!u(s, r, t) && (i(this._transformation) && o(t, t, this._transformation), !0);\n  }\n\n  get indices() {\n    return this.data.indices;\n  }\n\n  get vertexAttributes() {\n    return this.data.vertexAttributes;\n  }\n\n  addHighlight() {\n    const t = new d(0),\n          i = this.instanceParameters;\n    return i.highlights = f(i.highlights, t), t;\n  }\n\n  removeHighlight(t) {\n    const i = this.instanceParameters;\n    i.highlights = c(i.highlights, t);\n  }\n\n}\n\nclass g extends l {}\n\nexport { l as RenderGeometry, g as ValidatedRenderGeometry };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderGeometry.js"],"names":["isNone","t","isSome","i","unwrapOr","r","generateUID","s","d","a","c","n","I","e","m","o","h","maxScale","computeAttachmentOriginTriangles","u","Object3DStateID","addObject3DStateID","f","removeObject3DStateID","l","constructor","data","material","layerUid","graphicUid","id","boundingInfo","calculateShaderTransformation","castShadow","boundingSphere","instanceParameters","highlights","occludees","visible","_transformation","_shaderTransformationDirty","transformation","updateTransformation","computeBoundingSphere","shaderTransformationChanged","getCenter","getBSRadius","hasShaderTransformation","primitiveType","getShaderTransformation","_shaderTransformation","computeAttachmentOrigin","indices","get","vertexAttributes","addHighlight","removeHighlight","g","RenderGeometry","ValidatedRenderGeometry"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isNone as t,isSome as i,unwrapOr as r}from\"../../../../core/maybe.js\";import{generateUID as s}from\"../../../../core/uid.js\";import{d as a}from\"../../../../chunks/mat4.js\";import{c as n,I as e}from\"../../../../chunks/mat4f64.js\";import{m as o}from\"../../../../chunks/vec3.js\";import{c as h}from\"../../../../chunks/vec4f64.js\";import{maxScale as m}from\"../../support/mathUtils.js\";import{computeAttachmentOriginTriangles as u}from\"./geometryDataUtils.js\";import{Object3DStateID as d}from\"./Object3DStateID.js\";import{addObject3DStateID as f,removeObject3DStateID as c}from\"../materials/renderers/utils.js\";class l{constructor(t,i,r=null,a=null,e=s(),o=null,m=null,u=!1){this.data=t,this.material=i,this.layerUid=r,this.graphicUid=a,this.id=e,this.boundingInfo=o,this.calculateShaderTransformation=m,this.castShadow=u,this.boundingSphere=h(),this.instanceParameters={highlights:null,occludees:null,visible:!0},this._transformation=n(),this._shaderTransformationDirty=!0}get transformation(){return this._transformation}updateTransformation(t){t(this._transformation),this._shaderTransformationDirty=!0,this.computeBoundingSphere(this._transformation,this.boundingSphere)}shaderTransformationChanged(){this._shaderTransformationDirty=!0}computeBoundingSphere(i,r,s=m(i)){t(this.boundingInfo)||(o(r,this.boundingInfo.getCenter(),i),r[3]=this.boundingInfo.getBSRadius()*s)}get hasShaderTransformation(){return i(this.calculateShaderTransformation)}get primitiveType(){return this.data.primitiveType}getShaderTransformation(){return t(this.calculateShaderTransformation)?r(this.transformation,e):(this._shaderTransformationDirty&&(this._shaderTransformation||(this._shaderTransformation=n()),a(this._shaderTransformation,this.calculateShaderTransformation(r(this.transformation,e))),this._shaderTransformationDirty=!1),this._shaderTransformation)}computeAttachmentOrigin(t){if(this.material.computeAttachmentOrigin)return!!this.material.computeAttachmentOrigin(this,t)&&(i(this._transformation)&&o(t,t,this._transformation),!0);const r=this.indices.get(\"position\"),s=this.vertexAttributes.get(\"position\");return!!u(s,r,t)&&(i(this._transformation)&&o(t,t,this._transformation),!0)}get indices(){return this.data.indices}get vertexAttributes(){return this.data.vertexAttributes}addHighlight(){const t=new d(0),i=this.instanceParameters;return i.highlights=f(i.highlights,t),t}removeHighlight(t){const i=this.instanceParameters;i.highlights=c(i.highlights,t)}}class g extends l{}export{l as RenderGeometry,g as ValidatedRenderGeometry};\n"]},"metadata":{},"sourceType":"module"}