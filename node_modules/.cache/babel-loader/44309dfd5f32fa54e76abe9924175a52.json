{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport t from \"../PopupTemplate.js\";\nimport \"../renderers/ClassBreaksRenderer.js\";\nimport \"../renderers/DictionaryRenderer.js\";\nimport \"../renderers/DotDensityRenderer.js\";\nimport \"../renderers/HeatmapRenderer.js\";\nimport \"../renderers/Renderer.js\";\nimport \"../renderers/SimpleRenderer.js\";\nimport \"../renderers/UniqueValueRenderer.js\";\nimport \"../renderers/support/jsonUtils.js\";\nimport { webSceneRendererTypes as r } from \"../renderers/support/types.js\";\nimport s from \"../request.js\";\nimport o from \"../core/Error.js\";\nimport i from \"../core/Logger.js\";\nimport { isSome as a, isNone as n } from \"../core/maybe.js\";\nimport { MultiOriginJSONMixin as p } from \"../core/MultiOriginJSONSupport.js\";\nimport { throwIfAbortError as l, isAbortError as d } from \"../core/promiseUtils.js\";\nimport { join as y } from \"../core/urlUtils.js\";\nimport { whenValidOnce as u } from \"../core/watchUtils.js\";\nimport { property as c } from \"../core/accessorSupport/decorators/property.js\";\nimport \"../core/has.js\";\nimport { getProperties as f } from \"../core/accessorSupport/utils.js\";\nimport \"../core/accessorSupport/ensureType.js\";\nimport { reader as h } from \"../core/accessorSupport/decorators/reader.js\";\nimport { subclass as m } from \"../core/accessorSupport/decorators/subclass.js\";\nimport g from \"./Layer.js\";\nimport { APIKeyMixin as v } from \"./mixins/APIKeyMixin.js\";\nimport { ArcGISService as b } from \"./mixins/ArcGISService.js\";\nimport { OperationalLayer as I } from \"./mixins/OperationalLayer.js\";\nimport { PortalLayer as j } from \"./mixins/PortalLayer.js\";\nimport { ScaleRangeLayer as w } from \"./mixins/ScaleRangeLayer.js\";\nimport { SceneService as L } from \"./mixins/SceneService.js\";\nimport { zeroCapabilities as S } from \"./support/capabilities.js\";\nimport { elevationInfo as F, labelsVisible as O, legendEnabled as T, popupEnabled as _, screenSizePerspectiveEnabled as E } from \"./support/commonProperties.js\";\nimport P from \"./support/FeatureReduction.js\";\nimport x from \"./support/FeatureReductionSelection.js\";\nimport { FetchAssociatedFeatureLayer as A } from \"./support/FetchAssociatedFeatureLayer.js\";\nimport { defineFieldProperties as D } from \"./support/fieldProperties.js\";\nimport U from \"./support/FieldsIndex.js\";\nimport { fixRendererFields as R } from \"./support/fieldUtils.js\";\nimport { I3SNodePageDefinition as q, I3SMaterialDefinition as Q, I3STextureSetDefinition as N, I3SGeometryDefinition as k } from \"./support/I3SLayerDefinitions.js\";\nimport C from \"./support/LabelClass.js\";\nimport { reader as G } from \"./support/labelingInfo.js\";\nimport V from \"./support/LayerFloorInfo.js\";\nimport K from \"./support/RangeInfo.js\";\nimport { loadStyleRenderer as M } from \"../renderers/support/styleUtils.js\";\nimport $ from \"../rest/support/Query.js\";\nimport { createPopupTemplate as W } from \"../support/popupUtils.js\";\nimport { transparencyToOpacity as z } from \"../webdoc/support/opacityUtils.js\";\nconst Z = [\"3DObject\", \"Point\"],\n      B = i.getLogger(\"esri.layers.SceneLayer\"),\n      H = D();\nlet J = class extends L(b(I(j(w(p(v(g))))))) {\n  constructor(...e) {\n    super(...e), this.featureReduction = null, this.rangeInfos = null, this.operationalLayerType = \"ArcGISSceneServiceLayer\", this.type = \"scene\", this.fields = null, this.floorInfo = null, this.outFields = null, this.nodePages = null, this.materialDefinitions = null, this.textureSetDefinitions = null, this.geometryDefinitions = null, this.serviceUpdateTimeStamp = null, this.definitionExpression = null, this.path = null, this.labelsVisible = !0, this.labelingInfo = null, this.legendEnabled = !0, this.cachedDrawingInfo = {\n      color: !1\n    }, this.popupEnabled = !0, this.popupTemplate = null, this.objectIdField = null, this.globalIdField = null, this._fieldUsageInfo = {}, this.screenSizePerspectiveEnabled = !0;\n  }\n\n  normalizeCtorArgs(e, t) {\n    return \"string\" == typeof e ? {\n      url: e,\n      ...t\n    } : e;\n  }\n\n  getField(e) {\n    return this.fieldsIndex.get(e);\n  }\n\n  getFieldDomain(e, t) {\n    var r, s, o, i;\n    const a = null == (r = this.getFeatureType(null == t ? void 0 : t.feature)) || null == (s = r.domains) ? void 0 : s[e];\n    return a && \"inherited\" !== a.type ? a : null != (o = null == (i = this.getField(e)) ? void 0 : i.domain) ? o : null;\n  }\n\n  getFeatureType(e) {\n    return e && a(this.associatedLayer) ? this.associatedLayer.getFeatureType(e) : null;\n  }\n\n  get types() {\n    return a(this.associatedLayer) ? this.associatedLayer.types : [];\n  }\n\n  get typeIdField() {\n    return a(this.associatedLayer) ? this.associatedLayer.typeIdField : null;\n  }\n\n  get formTemplate() {\n    return a(this.associatedLayer) ? this.associatedLayer.formTemplate : null;\n  }\n\n  get fieldsIndex() {\n    return new U(this.fields);\n  }\n\n  readNodePages(e, t, r) {\n    return \"Point\" === t.layerType && (e = t.pointNodePages), null == e || \"object\" != typeof e ? null : q.fromJSON(e, r);\n  }\n\n  set elevationInfo(e) {\n    this._set(\"elevationInfo\", e), this.loaded && this._validateElevationInfo();\n  }\n\n  get geometryType() {\n    return Y[this.profile] || \"mesh\";\n  }\n\n  set renderer(e) {\n    R(e, this.fieldsIndex), this._set(\"renderer\", e);\n  }\n\n  readCachedDrawingInfo(e) {\n    return null != e && \"object\" == typeof e || (e = {}), null == e.color && (e.color = !1), e;\n  }\n\n  get capabilities() {\n    const e = a(this.associatedLayer) && this.associatedLayer.capabilities ? this.associatedLayer.capabilities : S,\n          {\n      query: t,\n      editing: {\n        supportsGlobalId: r,\n        supportsRollbackOnFailure: s,\n        supportsUploadWithItemId: o,\n        supportsReturnServiceEditsInSourceSpatialReference: i\n      },\n      data: {\n        supportsZ: n,\n        supportsM: p,\n        isVersioned: l,\n        supportsAttachment: d\n      },\n      operations: {\n        supportsEditing: y,\n        supportsUpdate: u,\n        supportsQuery: c,\n        supportsQueryAttachments: f\n      }\n    } = e,\n          h = e.operations.supportsChangeTracking;\n    return {\n      query: t,\n      editing: {\n        supportsGlobalId: r,\n        supportsReturnServiceEditsInSourceSpatialReference: i,\n        supportsRollbackOnFailure: s,\n        supportsGeometryUpdate: !1,\n        supportsUploadWithItemId: o\n      },\n      data: {\n        supportsAttachment: d,\n        supportsZ: n,\n        supportsM: p,\n        isVersioned: l\n      },\n      operations: {\n        supportsQuery: c,\n        supportsQueryAttachments: f,\n        supportsEditing: y && h,\n        supportsAdd: !1,\n        supportsDelete: !1,\n        supportsUpdate: u && h\n      }\n    };\n  }\n\n  get editingEnabled() {\n    return this._isOverridden(\"editingEnabled\") ? this._get(\"editingEnabled\") : this.userHasEditingPrivileges;\n  }\n\n  set editingEnabled(e) {\n    null != e ? this._override(\"editingEnabled\", e) : this._clearOverride(\"editingEnabled\");\n  }\n\n  get defaultPopupTemplate() {\n    return a(this.associatedLayer) || this.attributeStorageInfo ? this.createPopupTemplate() : null;\n  }\n\n  readObjectIdField(e, t) {\n    return !e && t.fields && t.fields.some(t => (\"esriFieldTypeOID\" === t.type && (e = t.name), !!e)), e || void 0;\n  }\n\n  readGlobalIdField(e, t) {\n    return !e && t.fields && t.fields.some(t => (\"esriFieldTypeGlobalID\" === t.type && (e = t.name), !!e)), e || void 0;\n  }\n\n  get displayField() {\n    return a(this.associatedLayer) ? this.associatedLayer.displayField : null;\n  }\n\n  readProfile(e, t) {\n    const r = t.store.profile;\n    return null != r && X[r] ? X[r] : (B.error(\"Unknown or missing profile\", {\n      profile: r,\n      layer: this\n    }), \"mesh-pyramids\");\n  }\n\n  load(e) {\n    const t = a(e) ? e.signal : null,\n          r = this.loadFromPortal({\n      supportedTypes: [\"Scene Service\"]\n    }, e).catch(l).then(() => this._fetchService(t)).then(() => Promise.all([this._fetchIndexAndUpdateExtent(this.nodePages, t), this._setAssociatedFeatureLayer(t)])).then(() => this._validateElevationInfo()).then(() => this._applyAssociatedLayerOverrides()).then(() => this._populateFieldUsageInfo()).then(() => M(this, {\n      origin: \"service\"\n    }, t)).then(() => R(this.renderer, this.fieldsIndex)).then(() => this.finishLoadEditablePortalLayer(e));\n    return this.addResolvingPromise(r), Promise.resolve(this);\n  }\n\n  createQuery() {\n    const e = new $();\n    return \"mesh\" !== this.geometryType && (e.returnGeometry = !0, e.returnZ = !0), e.where = this.definitionExpression || \"1=1\", e.sqlFormat = \"standard\", e;\n  }\n\n  queryExtent(e, t) {\n    return this._getAssociatedLayerForQuery().then(r => r.queryExtent(e || this.createQuery(), t));\n  }\n\n  queryFeatureCount(e, t) {\n    return this._getAssociatedLayerForQuery().then(r => r.queryFeatureCount(e || this.createQuery(), t));\n  }\n\n  queryFeatures(e, t) {\n    return this._getAssociatedLayerForQuery().then(r => r.queryFeatures(e || this.createQuery(), t)).then(e => {\n      if (null != e && e.features) for (const t of e.features) t.layer = this, t.sourceLayer = this;\n      return e;\n    });\n  }\n\n  queryObjectIds(e, t) {\n    return this._getAssociatedLayerForQuery().then(r => r.queryObjectIds(e || this.createQuery(), t));\n  }\n\n  queryAttachments(e, t) {\n    return this._getAssociatedLayerForQuery().then(r => r.queryAttachments(e, t));\n  }\n\n  getFieldUsageInfo(e) {\n    const t = {\n      supportsLabelingInfo: !1,\n      supportsRenderer: !1,\n      supportsPopupTemplate: !1,\n      supportsLayerQuery: !1\n    };\n    return this.loaded ? this._fieldUsageInfo[e] || t : (B.error(\"#getFieldUsageInfo()\", \"Unavailable until layer is loaded\"), t);\n  }\n\n  createPopupTemplate(e) {\n    return W(this, e);\n  }\n\n  _getAssociatedLayerForQuery() {\n    const e = this.associatedLayer;\n    return a(e) && e.loaded ? Promise.resolve(e) : this._loadAssociatedLayerForQuery();\n  }\n\n  async _loadAssociatedLayerForQuery() {\n    if (await this.load(), n(this.associatedLayer)) throw new o(\"scenelayer:query-not-available\", \"SceneLayer queries are not available without an associated feature layer\", {\n      layer: this\n    });\n\n    try {\n      await this.associatedLayer.load();\n    } catch (e) {\n      throw new o(\"scenelayer:query-not-available\", \"SceneLayer associated feature layer could not be loaded\", {\n        layer: this,\n        error: e\n      });\n    }\n\n    return this.associatedLayer;\n  }\n\n  hasCachedStatistics(e) {\n    return null != this.statisticsInfo && this.statisticsInfo.some(t => t.name === e);\n  }\n\n  async queryCachedStatistics(e, t) {\n    if (await this.load(t), !this.statisticsInfo) throw new o(\"scenelayer:no-cached-statistics\", \"Cached statistics are not available for this layer\");\n    const r = this.fieldsIndex.get(e);\n    if (!r) throw new o(\"scenelayer:field-unexisting\", `Field '${e}' does not exist on the layer`);\n\n    for (const o of this.statisticsInfo) if (o.name === r.name) {\n      const e = y(this.parsedUrl.path, o.href);\n      return s(e, {\n        query: {\n          f: \"json\",\n          token: this.apiKey\n        },\n        responseType: \"json\",\n        signal: t ? t.signal : null\n      }).then(e => e.data);\n    }\n\n    throw new o(\"scenelayer:no-cached-statistics\", \"Cached statistics for this attribute are not available\");\n  }\n\n  async saveAs(e, t) {\n    return this._debouncedSaveOperations(1, { ...t,\n      getTypeKeywords: () => this._getTypeKeywords(),\n      portalItemLayerType: \"scene\"\n    }, e);\n  }\n\n  async save() {\n    const e = {\n      getTypeKeywords: () => this._getTypeKeywords(),\n      portalItemLayerType: \"scene\"\n    };\n    return this._debouncedSaveOperations(0, e);\n  }\n\n  async applyEdits(e, t) {\n    const r = await import(\"./graphics/editingSupport.js\");\n    if (await this.load(), n(this.associatedLayer)) throw new o(`${this.type}-layer:not-editable`, \"Service is not editable\");\n    return await this.associatedLayer.load(), r.applyEdits(this, this.associatedLayer.source, e, t);\n  }\n\n  on(e, t) {\n    return super.on(e, t);\n  }\n\n  validateLayer(e) {\n    if (e.layerType && -1 === Z.indexOf(e.layerType)) throw new o(\"scenelayer:layer-type-not-supported\", \"SceneLayer does not support this layer type\", {\n      layerType: e.layerType\n    });\n    if (isNaN(this.version.major) || isNaN(this.version.minor)) throw new o(\"layer:service-version-not-supported\", \"Service version is not supported.\", {\n      serviceVersion: this.version.versionString,\n      supportedVersions: \"1.x\"\n    });\n    if (this.version.major > 1) throw new o(\"layer:service-version-too-new\", \"Service version is too new.\", {\n      serviceVersion: this.version.versionString,\n      supportedVersions: \"1.x\"\n    });\n\n    function t(e, t) {\n      let r = !1,\n          s = !1;\n      if (null == e) r = !0, s = !0;else {\n        const o = t && t.isGeographic;\n\n        switch (e) {\n          case \"east-north-up\":\n          case \"earth-centered\":\n            r = !0, s = o;\n            break;\n\n          case \"vertex-reference-frame\":\n            r = !0, s = !o;\n            break;\n\n          default:\n            r = !1;\n        }\n      }\n      if (!r) throw new o(\"scenelayer:unsupported-normal-reference-frame\", \"Normal reference frame is invalid.\");\n      if (!s) throw new o(\"scenelayer:incompatible-normal-reference-frame\", \"Normal reference frame is incompatible with layer spatial reference.\");\n    }\n\n    t(this.normalReferenceFrame, this.spatialReference);\n  }\n\n  _getTypeKeywords() {\n    const e = [];\n    if (\"points\" === this.profile) e.push(\"Point\");else {\n      if (\"mesh-pyramids\" !== this.profile) throw new o(\"scenelayer:unknown-profile\", \"SceneLayer:save() encountered an unknown SceneLayer profile: \" + this.profile);\n      e.push(\"3DObject\");\n    }\n    return e;\n  }\n\n  _populateFieldUsageInfo() {\n    if (this._fieldUsageInfo = {}, this.fields) for (const e of this.fields) {\n      const t = !(!this.attributeStorageInfo || !this.attributeStorageInfo.some(t => t.name === e.name)),\n            r = !!(a(this.associatedLayer) && this.associatedLayer.fields && this.associatedLayer.fields.some(t => t && e.name === t.name)),\n            s = {\n        supportsLabelingInfo: t,\n        supportsRenderer: t,\n        supportsPopupTemplate: t || r,\n        supportsLayerQuery: r\n      };\n      this._fieldUsageInfo[e.name] = s;\n    }\n  }\n\n  _applyAssociatedLayerOverrides() {\n    this._applyAssociatedLayerFieldsOverrides(), this._applyAssociatedLayerPopupOverrides();\n  }\n\n  _applyAssociatedLayerFieldsOverrides() {\n    if (n(this.associatedLayer) || !this.associatedLayer.fields) return;\n    let e = null;\n\n    for (const t of this.associatedLayer.fields) {\n      const r = this.getField(t.name);\n      r ? (!r.domain && t.domain && (r.domain = t.domain.clone()), r.editable = t.editable, r.nullable = t.nullable, r.length = t.length) : (e || (e = this.fields ? this.fields.slice() : []), e.push(t.clone()));\n    }\n\n    e && this._set(\"fields\", e);\n  }\n\n  _applyAssociatedLayerPopupOverrides() {\n    if (n(this.associatedLayer)) return;\n    const e = [\"popupTemplate\", \"popupEnabled\"],\n          t = f(this);\n\n    for (let r = 0; r < e.length; r++) {\n      const s = e[r],\n            o = this.originIdOf(s),\n            i = this.associatedLayer.originIdOf(s);\n      o < i && (2 === i || 3 === i) && t.setAtOrigin(s, this.associatedLayer[s], i);\n    }\n  }\n\n  async _setAssociatedFeatureLayer(e) {\n    if (-1 === [\"mesh-pyramids\", \"points\"].indexOf(this.profile)) return;\n    const t = new A(this.parsedUrl, this.portalItem, this.apiKey, e);\n\n    try {\n      this.associatedLayer = await t.fetch();\n    } catch (r) {\n      d(r) || this._logWarningOnPopupEnabled();\n    }\n  }\n\n  _logWarningOnPopupEnabled() {\n    u(this, [\"popupTemplate\", \"popupEnabled\"], () => this.popupEnabled && null != this.popupTemplate).then(() => () => {\n      const e = `this SceneLayer: ${this.title}`;\n      null == this.attributeStorageInfo ? B.warn(`Associated FeatureLayer could not be loaded and no binary attributes found. Popups will not work on ${e}`) : B.info(`Associated FeatureLayer could not be loaded. Falling back to binary attributes for Popups on ${e}`);\n    });\n  }\n\n  _validateElevationInfo() {\n    const e = this.elevationInfo;\n    e && (\"mesh-pyramids\" === this.profile && \"absolute-height\" !== e.mode && B.warn(\".elevationInfo=\", \"Mesh scene layers only support absolute-height elevation mode\"), e.featureExpressionInfo && \"0\" !== e.featureExpressionInfo.expression && B.warn(\".elevationInfo=\", \"Scene layers do not support featureExpressionInfo\"));\n  }\n\n};\ne([c({\n  types: {\n    key: \"type\",\n    base: P,\n    typeMap: {\n      selection: x\n    }\n  },\n  json: {\n    origins: {\n      \"web-scene\": {\n        name: \"layerDefinition.featureReduction\",\n        write: !0\n      },\n      \"portal-item\": {\n        name: \"layerDefinition.featureReduction\",\n        write: !0\n      }\n    }\n  }\n})], J.prototype, \"featureReduction\", void 0), e([c({\n  type: [K],\n  json: {\n    read: !1,\n    origins: {\n      \"web-scene\": {\n        name: \"layerDefinition.rangeInfos\",\n        write: !0\n      },\n      \"portal-item\": {\n        name: \"layerDefinition.rangeInfos\",\n        write: !0\n      }\n    }\n  }\n})], J.prototype, \"rangeInfos\", void 0), e([c({\n  json: {\n    read: !1\n  }\n})], J.prototype, \"associatedLayer\", void 0), e([c({\n  type: [\"show\", \"hide\"]\n})], J.prototype, \"listMode\", void 0), e([c({\n  type: [\"ArcGISSceneServiceLayer\"]\n})], J.prototype, \"operationalLayerType\", void 0), e([c({\n  json: {\n    read: !1\n  },\n  readOnly: !0\n})], J.prototype, \"type\", void 0), e([c({ ...H.fields,\n  readOnly: !0,\n  json: {\n    read: !1,\n    origins: {\n      service: {\n        read: !0\n      }\n    }\n  }\n})], J.prototype, \"fields\", void 0), e([c()], J.prototype, \"types\", null), e([c()], J.prototype, \"typeIdField\", null), e([c()], J.prototype, \"formTemplate\", null), e([c({\n  readOnly: !0\n})], J.prototype, \"fieldsIndex\", null), e([c({\n  type: V,\n  json: {\n    read: {\n      source: \"layerDefinition.floorInfo\"\n    },\n    write: {\n      target: \"layerDefinition.floorInfo\"\n    }\n  }\n})], J.prototype, \"floorInfo\", void 0), e([c(H.outFields)], J.prototype, \"outFields\", void 0), e([c({\n  type: q,\n  readOnly: !0,\n  json: {\n    read: !1\n  }\n})], J.prototype, \"nodePages\", void 0), e([h(\"service\", \"nodePages\", [\"nodePages\", \"pointNodePages\"])], J.prototype, \"readNodePages\", null), e([c({\n  type: [Q],\n  readOnly: !0\n})], J.prototype, \"materialDefinitions\", void 0), e([c({\n  type: [N],\n  readOnly: !0\n})], J.prototype, \"textureSetDefinitions\", void 0), e([c({\n  type: [k],\n  readOnly: !0\n})], J.prototype, \"geometryDefinitions\", void 0), e([c({\n  readOnly: !0\n})], J.prototype, \"serviceUpdateTimeStamp\", void 0), e([c({\n  readOnly: !0\n})], J.prototype, \"attributeStorageInfo\", void 0), e([c({\n  readOnly: !0\n})], J.prototype, \"statisticsInfo\", void 0), e([c({\n  type: String,\n  json: {\n    origins: {\n      service: {\n        read: !1,\n        write: !1\n      }\n    },\n    name: \"layerDefinition.definitionExpression\",\n    write: {\n      enabled: !0,\n      allowNull: !0\n    }\n  }\n})], J.prototype, \"definitionExpression\", void 0), e([c({\n  type: String,\n  json: {\n    origins: {\n      \"web-scene\": {\n        read: !0,\n        write: !0\n      }\n    },\n    read: !1\n  }\n})], J.prototype, \"path\", void 0), e([c(F)], J.prototype, \"elevationInfo\", null), e([c({\n  type: String\n})], J.prototype, \"geometryType\", null), e([c(O)], J.prototype, \"labelsVisible\", void 0), e([c({\n  type: [C],\n  json: {\n    origins: {\n      service: {\n        name: \"drawingInfo.labelingInfo\",\n        read: {\n          reader: G\n        },\n        write: !1\n      }\n    },\n    name: \"layerDefinition.drawingInfo.labelingInfo\",\n    read: {\n      reader: G\n    },\n    write: !0\n  }\n})], J.prototype, \"labelingInfo\", void 0), e([c(T)], J.prototype, \"legendEnabled\", void 0), e([c({\n  type: Number,\n  json: {\n    origins: {\n      \"web-document\": {\n        default: 1,\n        write: {\n          enabled: !0,\n          target: {\n            opacity: {\n              type: Number\n            },\n            \"layerDefinition.drawingInfo.transparency\": {\n              type: Number\n            }\n          }\n        },\n        read: {\n          source: [\"opacity\", \"layerDefinition.drawingInfo.transparency\"],\n\n          reader(e, t) {\n            var r, s;\n            if (\"number\" == typeof e && e >= 0 && e <= 1) return e;\n            const o = null == (r = t.layerDefinition) || null == (s = r.drawingInfo) ? void 0 : s.transparency;\n            return void 0 !== o ? z(o) : void 0;\n          }\n\n        }\n      },\n      \"portal-item\": {\n        write: !0\n      },\n      service: {\n        read: !1\n      }\n    }\n  }\n})], J.prototype, \"opacity\", void 0), e([c({\n  types: r,\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"drawingInfo.renderer\"\n        }\n      }\n    },\n    name: \"layerDefinition.drawingInfo.renderer\",\n    write: !0\n  },\n  value: null\n})], J.prototype, \"renderer\", null), e([c({\n  json: {\n    read: !1\n  }\n})], J.prototype, \"cachedDrawingInfo\", void 0), e([h(\"service\", \"cachedDrawingInfo\")], J.prototype, \"readCachedDrawingInfo\", null), e([c({\n  readOnly: !0,\n  json: {\n    read: !1\n  }\n})], J.prototype, \"capabilities\", null), e([c({\n  type: Boolean,\n  json: {\n    read: !1\n  }\n})], J.prototype, \"editingEnabled\", null), e([c(_)], J.prototype, \"popupEnabled\", void 0), e([c({\n  type: t,\n  json: {\n    name: \"popupInfo\",\n    write: !0\n  }\n})], J.prototype, \"popupTemplate\", void 0), e([c({\n  readOnly: !0,\n  json: {\n    read: !1\n  }\n})], J.prototype, \"defaultPopupTemplate\", null), e([c({\n  type: String,\n  json: {\n    read: !1\n  }\n})], J.prototype, \"objectIdField\", void 0), e([h(\"service\", \"objectIdField\", [\"objectIdField\", \"fields\"])], J.prototype, \"readObjectIdField\", null), e([c({\n  type: String,\n  json: {\n    read: !1\n  }\n})], J.prototype, \"globalIdField\", void 0), e([h(\"service\", \"globalIdField\", [\"globalIdField\", \"fields\"])], J.prototype, \"readGlobalIdField\", null), e([c({\n  readOnly: !0,\n  type: String,\n  json: {\n    read: !1\n  }\n})], J.prototype, \"displayField\", null), e([c({\n  type: String,\n  json: {\n    read: !1\n  }\n})], J.prototype, \"profile\", void 0), e([h(\"service\", \"profile\", [\"store.profile\"])], J.prototype, \"readProfile\", null), e([c({\n  readOnly: !0,\n  type: String,\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"store.normalReferenceFrame\"\n        }\n      }\n    },\n    read: !1\n  }\n})], J.prototype, \"normalReferenceFrame\", void 0), e([c(E)], J.prototype, \"screenSizePerspectiveEnabled\", void 0), J = e([m(\"esri.layers.SceneLayer\")], J);\nconst X = {\n  \"mesh-pyramids\": \"mesh-pyramids\",\n  meshpyramids: \"mesh-pyramids\",\n  \"features-meshes\": \"mesh-pyramids\",\n  points: \"points\",\n  \"features-points\": \"points\",\n  lines: \"lines\",\n  \"features-lines\": \"lines\",\n  polygons: \"polygons\",\n  \"features-polygons\": \"polygons\"\n},\n      Y = {\n  \"mesh-pyramids\": \"mesh\",\n  points: \"point\",\n  lines: \"polyline\",\n  polygons: \"polygon\"\n};\nvar ee = J;\nexport default ee;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/layers/SceneLayer.js"],"names":["_","e","t","webSceneRendererTypes","r","s","o","i","isSome","a","isNone","n","MultiOriginJSONMixin","p","throwIfAbortError","l","isAbortError","d","join","y","whenValidOnce","u","property","c","getProperties","f","reader","h","subclass","m","g","APIKeyMixin","v","ArcGISService","b","OperationalLayer","I","PortalLayer","j","ScaleRangeLayer","w","SceneService","L","zeroCapabilities","S","elevationInfo","F","labelsVisible","O","legendEnabled","T","popupEnabled","screenSizePerspectiveEnabled","E","P","x","FetchAssociatedFeatureLayer","A","defineFieldProperties","D","U","fixRendererFields","R","I3SNodePageDefinition","q","I3SMaterialDefinition","Q","I3STextureSetDefinition","N","I3SGeometryDefinition","k","C","G","V","K","loadStyleRenderer","M","$","createPopupTemplate","W","transparencyToOpacity","z","Z","B","getLogger","H","J","constructor","featureReduction","rangeInfos","operationalLayerType","type","fields","floorInfo","outFields","nodePages","materialDefinitions","textureSetDefinitions","geometryDefinitions","serviceUpdateTimeStamp","definitionExpression","path","labelingInfo","cachedDrawingInfo","color","popupTemplate","objectIdField","globalIdField","_fieldUsageInfo","normalizeCtorArgs","url","getField","fieldsIndex","get","getFieldDomain","getFeatureType","feature","domains","domain","associatedLayer","types","typeIdField","formTemplate","readNodePages","layerType","pointNodePages","fromJSON","_set","loaded","_validateElevationInfo","geometryType","Y","profile","renderer","readCachedDrawingInfo","capabilities","query","editing","supportsGlobalId","supportsRollbackOnFailure","supportsUploadWithItemId","supportsReturnServiceEditsInSourceSpatialReference","data","supportsZ","supportsM","isVersioned","supportsAttachment","operations","supportsEditing","supportsUpdate","supportsQuery","supportsQueryAttachments","supportsChangeTracking","supportsGeometryUpdate","supportsAdd","supportsDelete","editingEnabled","_isOverridden","_get","userHasEditingPrivileges","_override","_clearOverride","defaultPopupTemplate","attributeStorageInfo","readObjectIdField","some","name","readGlobalIdField","displayField","readProfile","store","X","error","layer","load","signal","loadFromPortal","supportedTypes","catch","then","_fetchService","Promise","all","_fetchIndexAndUpdateExtent","_setAssociatedFeatureLayer","_applyAssociatedLayerOverrides","_populateFieldUsageInfo","origin","finishLoadEditablePortalLayer","addResolvingPromise","resolve","createQuery","returnGeometry","returnZ","where","sqlFormat","queryExtent","_getAssociatedLayerForQuery","queryFeatureCount","queryFeatures","features","sourceLayer","queryObjectIds","queryAttachments","getFieldUsageInfo","supportsLabelingInfo","supportsRenderer","supportsPopupTemplate","supportsLayerQuery","_loadAssociatedLayerForQuery","hasCachedStatistics","statisticsInfo","queryCachedStatistics","parsedUrl","href","token","apiKey","responseType","saveAs","_debouncedSaveOperations","getTypeKeywords","_getTypeKeywords","portalItemLayerType","save","applyEdits","source","on","validateLayer","indexOf","isNaN","version","major","minor","serviceVersion","versionString","supportedVersions","isGeographic","normalReferenceFrame","spatialReference","push","_applyAssociatedLayerFieldsOverrides","_applyAssociatedLayerPopupOverrides","clone","editable","nullable","length","slice","originIdOf","setAtOrigin","portalItem","fetch","_logWarningOnPopupEnabled","title","warn","info","mode","featureExpressionInfo","expression","key","base","typeMap","selection","json","origins","write","prototype","read","readOnly","service","target","String","enabled","allowNull","Number","default","opacity","layerDefinition","drawingInfo","transparency","value","Boolean","meshpyramids","points","lines","polygons","ee"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import t from\"../PopupTemplate.js\";import\"../renderers/ClassBreaksRenderer.js\";import\"../renderers/DictionaryRenderer.js\";import\"../renderers/DotDensityRenderer.js\";import\"../renderers/HeatmapRenderer.js\";import\"../renderers/Renderer.js\";import\"../renderers/SimpleRenderer.js\";import\"../renderers/UniqueValueRenderer.js\";import\"../renderers/support/jsonUtils.js\";import{webSceneRendererTypes as r}from\"../renderers/support/types.js\";import s from\"../request.js\";import o from\"../core/Error.js\";import i from\"../core/Logger.js\";import{isSome as a,isNone as n}from\"../core/maybe.js\";import{MultiOriginJSONMixin as p}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as l,isAbortError as d}from\"../core/promiseUtils.js\";import{join as y}from\"../core/urlUtils.js\";import{whenValidOnce as u}from\"../core/watchUtils.js\";import{property as c}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import{getProperties as f}from\"../core/accessorSupport/utils.js\";import\"../core/accessorSupport/ensureType.js\";import{reader as h}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as m}from\"../core/accessorSupport/decorators/subclass.js\";import g from\"./Layer.js\";import{APIKeyMixin as v}from\"./mixins/APIKeyMixin.js\";import{ArcGISService as b}from\"./mixins/ArcGISService.js\";import{OperationalLayer as I}from\"./mixins/OperationalLayer.js\";import{PortalLayer as j}from\"./mixins/PortalLayer.js\";import{ScaleRangeLayer as w}from\"./mixins/ScaleRangeLayer.js\";import{SceneService as L}from\"./mixins/SceneService.js\";import{zeroCapabilities as S}from\"./support/capabilities.js\";import{elevationInfo as F,labelsVisible as O,legendEnabled as T,popupEnabled as _,screenSizePerspectiveEnabled as E}from\"./support/commonProperties.js\";import P from\"./support/FeatureReduction.js\";import x from\"./support/FeatureReductionSelection.js\";import{FetchAssociatedFeatureLayer as A}from\"./support/FetchAssociatedFeatureLayer.js\";import{defineFieldProperties as D}from\"./support/fieldProperties.js\";import U from\"./support/FieldsIndex.js\";import{fixRendererFields as R}from\"./support/fieldUtils.js\";import{I3SNodePageDefinition as q,I3SMaterialDefinition as Q,I3STextureSetDefinition as N,I3SGeometryDefinition as k}from\"./support/I3SLayerDefinitions.js\";import C from\"./support/LabelClass.js\";import{reader as G}from\"./support/labelingInfo.js\";import V from\"./support/LayerFloorInfo.js\";import K from\"./support/RangeInfo.js\";import{loadStyleRenderer as M}from\"../renderers/support/styleUtils.js\";import $ from\"../rest/support/Query.js\";import{createPopupTemplate as W}from\"../support/popupUtils.js\";import{transparencyToOpacity as z}from\"../webdoc/support/opacityUtils.js\";const Z=[\"3DObject\",\"Point\"],B=i.getLogger(\"esri.layers.SceneLayer\"),H=D();let J=class extends(L(b(I(j(w(p(v(g)))))))){constructor(...e){super(...e),this.featureReduction=null,this.rangeInfos=null,this.operationalLayerType=\"ArcGISSceneServiceLayer\",this.type=\"scene\",this.fields=null,this.floorInfo=null,this.outFields=null,this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.definitionExpression=null,this.path=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.cachedDrawingInfo={color:!1},this.popupEnabled=!0,this.popupTemplate=null,this.objectIdField=null,this.globalIdField=null,this._fieldUsageInfo={},this.screenSizePerspectiveEnabled=!0}normalizeCtorArgs(e,t){return\"string\"==typeof e?{url:e,...t}:e}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){var r,s,o,i;const a=null==(r=this.getFeatureType(null==t?void 0:t.feature))||null==(s=r.domains)?void 0:s[e];return a&&\"inherited\"!==a.type?a:null!=(o=null==(i=this.getField(e))?void 0:i.domain)?o:null}getFeatureType(e){return e&&a(this.associatedLayer)?this.associatedLayer.getFeatureType(e):null}get types(){return a(this.associatedLayer)?this.associatedLayer.types:[]}get typeIdField(){return a(this.associatedLayer)?this.associatedLayer.typeIdField:null}get formTemplate(){return a(this.associatedLayer)?this.associatedLayer.formTemplate:null}get fieldsIndex(){return new U(this.fields)}readNodePages(e,t,r){return\"Point\"===t.layerType&&(e=t.pointNodePages),null==e||\"object\"!=typeof e?null:q.fromJSON(e,r)}set elevationInfo(e){this._set(\"elevationInfo\",e),this.loaded&&this._validateElevationInfo()}get geometryType(){return Y[this.profile]||\"mesh\"}set renderer(e){R(e,this.fieldsIndex),this._set(\"renderer\",e)}readCachedDrawingInfo(e){return null!=e&&\"object\"==typeof e||(e={}),null==e.color&&(e.color=!1),e}get capabilities(){const e=a(this.associatedLayer)&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:S,{query:t,editing:{supportsGlobalId:r,supportsRollbackOnFailure:s,supportsUploadWithItemId:o,supportsReturnServiceEditsInSourceSpatialReference:i},data:{supportsZ:n,supportsM:p,isVersioned:l,supportsAttachment:d},operations:{supportsEditing:y,supportsUpdate:u,supportsQuery:c,supportsQueryAttachments:f}}=e,h=e.operations.supportsChangeTracking;return{query:t,editing:{supportsGlobalId:r,supportsReturnServiceEditsInSourceSpatialReference:i,supportsRollbackOnFailure:s,supportsGeometryUpdate:!1,supportsUploadWithItemId:o},data:{supportsAttachment:d,supportsZ:n,supportsM:p,isVersioned:l},operations:{supportsQuery:c,supportsQueryAttachments:f,supportsEditing:y&&h,supportsAdd:!1,supportsDelete:!1,supportsUpdate:u&&h}}}get editingEnabled(){return this._isOverridden(\"editingEnabled\")?this._get(\"editingEnabled\"):this.userHasEditingPrivileges}set editingEnabled(e){null!=e?this._override(\"editingEnabled\",e):this._clearOverride(\"editingEnabled\")}get defaultPopupTemplate(){return a(this.associatedLayer)||this.attributeStorageInfo?this.createPopupTemplate():null}readObjectIdField(e,t){return!e&&t.fields&&t.fields.some((t=>(\"esriFieldTypeOID\"===t.type&&(e=t.name),!!e))),e||void 0}readGlobalIdField(e,t){return!e&&t.fields&&t.fields.some((t=>(\"esriFieldTypeGlobalID\"===t.type&&(e=t.name),!!e))),e||void 0}get displayField(){return a(this.associatedLayer)?this.associatedLayer.displayField:null}readProfile(e,t){const r=t.store.profile;return null!=r&&X[r]?X[r]:(B.error(\"Unknown or missing profile\",{profile:r,layer:this}),\"mesh-pyramids\")}load(e){const t=a(e)?e.signal:null,r=this.loadFromPortal({supportedTypes:[\"Scene Service\"]},e).catch(l).then((()=>this._fetchService(t))).then((()=>Promise.all([this._fetchIndexAndUpdateExtent(this.nodePages,t),this._setAssociatedFeatureLayer(t)]))).then((()=>this._validateElevationInfo())).then((()=>this._applyAssociatedLayerOverrides())).then((()=>this._populateFieldUsageInfo())).then((()=>M(this,{origin:\"service\"},t))).then((()=>R(this.renderer,this.fieldsIndex))).then((()=>this.finishLoadEditablePortalLayer(e)));return this.addResolvingPromise(r),Promise.resolve(this)}createQuery(){const e=new $;return\"mesh\"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||\"1=1\",e.sqlFormat=\"standard\",e}queryExtent(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryExtent(e||this.createQuery(),t)))}queryFeatureCount(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryFeatureCount(e||this.createQuery(),t)))}queryFeatures(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryFeatures(e||this.createQuery(),t))).then((e=>{if(null!=e&&e.features)for(const t of e.features)t.layer=this,t.sourceLayer=this;return e}))}queryObjectIds(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryObjectIds(e||this.createQuery(),t)))}queryAttachments(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryAttachments(e,t)))}getFieldUsageInfo(e){const t={supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1};return this.loaded?this._fieldUsageInfo[e]||t:(B.error(\"#getFieldUsageInfo()\",\"Unavailable until layer is loaded\"),t)}createPopupTemplate(e){return W(this,e)}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return a(e)&&e.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}async _loadAssociatedLayerForQuery(){if(await this.load(),n(this.associatedLayer))throw new o(\"scenelayer:query-not-available\",\"SceneLayer queries are not available without an associated feature layer\",{layer:this});try{await this.associatedLayer.load()}catch(e){throw new o(\"scenelayer:query-not-available\",\"SceneLayer associated feature layer could not be loaded\",{layer:this,error:e})}return this.associatedLayer}hasCachedStatistics(e){return null!=this.statisticsInfo&&this.statisticsInfo.some((t=>t.name===e))}async queryCachedStatistics(e,t){if(await this.load(t),!this.statisticsInfo)throw new o(\"scenelayer:no-cached-statistics\",\"Cached statistics are not available for this layer\");const r=this.fieldsIndex.get(e);if(!r)throw new o(\"scenelayer:field-unexisting\",`Field '${e}' does not exist on the layer`);for(const o of this.statisticsInfo)if(o.name===r.name){const e=y(this.parsedUrl.path,o.href);return s(e,{query:{f:\"json\",token:this.apiKey},responseType:\"json\",signal:t?t.signal:null}).then((e=>e.data))}throw new o(\"scenelayer:no-cached-statistics\",\"Cached statistics for this attribute are not available\")}async saveAs(e,t){return this._debouncedSaveOperations(1,{...t,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:\"scene\"},e)}async save(){const e={getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:\"scene\"};return this._debouncedSaveOperations(0,e)}async applyEdits(e,t){const r=await import(\"./graphics/editingSupport.js\");if(await this.load(),n(this.associatedLayer))throw new o(`${this.type}-layer:not-editable`,\"Service is not editable\");return await this.associatedLayer.load(),r.applyEdits(this,this.associatedLayer.source,e,t)}on(e,t){return super.on(e,t)}validateLayer(e){if(e.layerType&&-1===Z.indexOf(e.layerType))throw new o(\"scenelayer:layer-type-not-supported\",\"SceneLayer does not support this layer type\",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new o(\"layer:service-version-not-supported\",\"Service version is not supported.\",{serviceVersion:this.version.versionString,supportedVersions:\"1.x\"});if(this.version.major>1)throw new o(\"layer:service-version-too-new\",\"Service version is too new.\",{serviceVersion:this.version.versionString,supportedVersions:\"1.x\"});function t(e,t){let r=!1,s=!1;if(null==e)r=!0,s=!0;else{const o=t&&t.isGeographic;switch(e){case\"east-north-up\":case\"earth-centered\":r=!0,s=o;break;case\"vertex-reference-frame\":r=!0,s=!o;break;default:r=!1}}if(!r)throw new o(\"scenelayer:unsupported-normal-reference-frame\",\"Normal reference frame is invalid.\");if(!s)throw new o(\"scenelayer:incompatible-normal-reference-frame\",\"Normal reference frame is incompatible with layer spatial reference.\")}t(this.normalReferenceFrame,this.spatialReference)}_getTypeKeywords(){const e=[];if(\"points\"===this.profile)e.push(\"Point\");else{if(\"mesh-pyramids\"!==this.profile)throw new o(\"scenelayer:unknown-profile\",\"SceneLayer:save() encountered an unknown SceneLayer profile: \"+this.profile);e.push(\"3DObject\")}return e}_populateFieldUsageInfo(){if(this._fieldUsageInfo={},this.fields)for(const e of this.fields){const t=!(!this.attributeStorageInfo||!this.attributeStorageInfo.some((t=>t.name===e.name))),r=!!(a(this.associatedLayer)&&this.associatedLayer.fields&&this.associatedLayer.fields.some((t=>t&&e.name===t.name))),s={supportsLabelingInfo:t,supportsRenderer:t,supportsPopupTemplate:t||r,supportsLayerQuery:r};this._fieldUsageInfo[e.name]=s}}_applyAssociatedLayerOverrides(){this._applyAssociatedLayerFieldsOverrides(),this._applyAssociatedLayerPopupOverrides()}_applyAssociatedLayerFieldsOverrides(){if(n(this.associatedLayer)||!this.associatedLayer.fields)return;let e=null;for(const t of this.associatedLayer.fields){const r=this.getField(t.name);r?(!r.domain&&t.domain&&(r.domain=t.domain.clone()),r.editable=t.editable,r.nullable=t.nullable,r.length=t.length):(e||(e=this.fields?this.fields.slice():[]),e.push(t.clone()))}e&&this._set(\"fields\",e)}_applyAssociatedLayerPopupOverrides(){if(n(this.associatedLayer))return;const e=[\"popupTemplate\",\"popupEnabled\"],t=f(this);for(let r=0;r<e.length;r++){const s=e[r],o=this.originIdOf(s),i=this.associatedLayer.originIdOf(s);o<i&&(2===i||3===i)&&t.setAtOrigin(s,this.associatedLayer[s],i)}}async _setAssociatedFeatureLayer(e){if(-1===[\"mesh-pyramids\",\"points\"].indexOf(this.profile))return;const t=new A(this.parsedUrl,this.portalItem,this.apiKey,e);try{this.associatedLayer=await t.fetch()}catch(r){d(r)||this._logWarningOnPopupEnabled()}}_logWarningOnPopupEnabled(){u(this,[\"popupTemplate\",\"popupEnabled\"],(()=>this.popupEnabled&&null!=this.popupTemplate)).then((()=>()=>{const e=`this SceneLayer: ${this.title}`;null==this.attributeStorageInfo?B.warn(`Associated FeatureLayer could not be loaded and no binary attributes found. Popups will not work on ${e}`):B.info(`Associated FeatureLayer could not be loaded. Falling back to binary attributes for Popups on ${e}`)}))}_validateElevationInfo(){const e=this.elevationInfo;e&&(\"mesh-pyramids\"===this.profile&&\"absolute-height\"!==e.mode&&B.warn(\".elevationInfo=\",\"Mesh scene layers only support absolute-height elevation mode\"),e.featureExpressionInfo&&\"0\"!==e.featureExpressionInfo.expression&&B.warn(\".elevationInfo=\",\"Scene layers do not support featureExpressionInfo\"))}};e([c({types:{key:\"type\",base:P,typeMap:{selection:x}},json:{origins:{\"web-scene\":{name:\"layerDefinition.featureReduction\",write:!0},\"portal-item\":{name:\"layerDefinition.featureReduction\",write:!0}}}})],J.prototype,\"featureReduction\",void 0),e([c({type:[K],json:{read:!1,origins:{\"web-scene\":{name:\"layerDefinition.rangeInfos\",write:!0},\"portal-item\":{name:\"layerDefinition.rangeInfos\",write:!0}}}})],J.prototype,\"rangeInfos\",void 0),e([c({json:{read:!1}})],J.prototype,\"associatedLayer\",void 0),e([c({type:[\"show\",\"hide\"]})],J.prototype,\"listMode\",void 0),e([c({type:[\"ArcGISSceneServiceLayer\"]})],J.prototype,\"operationalLayerType\",void 0),e([c({json:{read:!1},readOnly:!0})],J.prototype,\"type\",void 0),e([c({...H.fields,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],J.prototype,\"fields\",void 0),e([c()],J.prototype,\"types\",null),e([c()],J.prototype,\"typeIdField\",null),e([c()],J.prototype,\"formTemplate\",null),e([c({readOnly:!0})],J.prototype,\"fieldsIndex\",null),e([c({type:V,json:{read:{source:\"layerDefinition.floorInfo\"},write:{target:\"layerDefinition.floorInfo\"}}})],J.prototype,\"floorInfo\",void 0),e([c(H.outFields)],J.prototype,\"outFields\",void 0),e([c({type:q,readOnly:!0,json:{read:!1}})],J.prototype,\"nodePages\",void 0),e([h(\"service\",\"nodePages\",[\"nodePages\",\"pointNodePages\"])],J.prototype,\"readNodePages\",null),e([c({type:[Q],readOnly:!0})],J.prototype,\"materialDefinitions\",void 0),e([c({type:[N],readOnly:!0})],J.prototype,\"textureSetDefinitions\",void 0),e([c({type:[k],readOnly:!0})],J.prototype,\"geometryDefinitions\",void 0),e([c({readOnly:!0})],J.prototype,\"serviceUpdateTimeStamp\",void 0),e([c({readOnly:!0})],J.prototype,\"attributeStorageInfo\",void 0),e([c({readOnly:!0})],J.prototype,\"statisticsInfo\",void 0),e([c({type:String,json:{origins:{service:{read:!1,write:!1}},name:\"layerDefinition.definitionExpression\",write:{enabled:!0,allowNull:!0}}})],J.prototype,\"definitionExpression\",void 0),e([c({type:String,json:{origins:{\"web-scene\":{read:!0,write:!0}},read:!1}})],J.prototype,\"path\",void 0),e([c(F)],J.prototype,\"elevationInfo\",null),e([c({type:String})],J.prototype,\"geometryType\",null),e([c(O)],J.prototype,\"labelsVisible\",void 0),e([c({type:[C],json:{origins:{service:{name:\"drawingInfo.labelingInfo\",read:{reader:G},write:!1}},name:\"layerDefinition.drawingInfo.labelingInfo\",read:{reader:G},write:!0}})],J.prototype,\"labelingInfo\",void 0),e([c(T)],J.prototype,\"legendEnabled\",void 0),e([c({type:Number,json:{origins:{\"web-document\":{default:1,write:{enabled:!0,target:{opacity:{type:Number},\"layerDefinition.drawingInfo.transparency\":{type:Number}}},read:{source:[\"opacity\",\"layerDefinition.drawingInfo.transparency\"],reader(e,t){var r,s;if(\"number\"==typeof e&&e>=0&&e<=1)return e;const o=null==(r=t.layerDefinition)||null==(s=r.drawingInfo)?void 0:s.transparency;return void 0!==o?z(o):void 0}}},\"portal-item\":{write:!0},service:{read:!1}}}})],J.prototype,\"opacity\",void 0),e([c({types:r,json:{origins:{service:{read:{source:\"drawingInfo.renderer\"}}},name:\"layerDefinition.drawingInfo.renderer\",write:!0},value:null})],J.prototype,\"renderer\",null),e([c({json:{read:!1}})],J.prototype,\"cachedDrawingInfo\",void 0),e([h(\"service\",\"cachedDrawingInfo\")],J.prototype,\"readCachedDrawingInfo\",null),e([c({readOnly:!0,json:{read:!1}})],J.prototype,\"capabilities\",null),e([c({type:Boolean,json:{read:!1}})],J.prototype,\"editingEnabled\",null),e([c(_)],J.prototype,\"popupEnabled\",void 0),e([c({type:t,json:{name:\"popupInfo\",write:!0}})],J.prototype,\"popupTemplate\",void 0),e([c({readOnly:!0,json:{read:!1}})],J.prototype,\"defaultPopupTemplate\",null),e([c({type:String,json:{read:!1}})],J.prototype,\"objectIdField\",void 0),e([h(\"service\",\"objectIdField\",[\"objectIdField\",\"fields\"])],J.prototype,\"readObjectIdField\",null),e([c({type:String,json:{read:!1}})],J.prototype,\"globalIdField\",void 0),e([h(\"service\",\"globalIdField\",[\"globalIdField\",\"fields\"])],J.prototype,\"readGlobalIdField\",null),e([c({readOnly:!0,type:String,json:{read:!1}})],J.prototype,\"displayField\",null),e([c({type:String,json:{read:!1}})],J.prototype,\"profile\",void 0),e([h(\"service\",\"profile\",[\"store.profile\"])],J.prototype,\"readProfile\",null),e([c({readOnly:!0,type:String,json:{origins:{service:{read:{source:\"store.normalReferenceFrame\"}}},read:!1}})],J.prototype,\"normalReferenceFrame\",void 0),e([c(E)],J.prototype,\"screenSizePerspectiveEnabled\",void 0),J=e([m(\"esri.layers.SceneLayer\")],J);const X={\"mesh-pyramids\":\"mesh-pyramids\",meshpyramids:\"mesh-pyramids\",\"features-meshes\":\"mesh-pyramids\",points:\"points\",\"features-points\":\"points\",lines:\"lines\",\"features-lines\":\"lines\",polygons:\"polygons\",\"features-polygons\":\"polygons\"},Y={\"mesh-pyramids\":\"mesh\",points:\"point\",lines:\"polyline\",polygons:\"polygon\"};var ee=J;export default ee;\n"]},"metadata":{},"sourceType":"module"}