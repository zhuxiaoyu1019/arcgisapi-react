{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../../core/maybe.js\";\nimport t from \"../PixelBlock.js\";\n\nconst i = 180 / Math.PI,\n      n = function (e) {\n  return e && \"esri.layers.support.PixelBlock\" === e.declaredClass && e.pixels && e.pixels.length > 0;\n},\n      r = new Map();\n\nfunction o(e, t) {\n  return r.get(e) / r.get(t) || 1;\n}\n\nfunction a(e) {\n  return (450 - e) % 360;\n}\n\nfunction h(e, t = \"geographic\") {\n  const [n, r] = e,\n        o = Math.sqrt(n * n + r * r);\n  let h = Math.atan2(r, n) * i;\n  return h = (360 + h) % 360, \"geographic\" === t && (h = a(h)), [o, h];\n}\n\nfunction s(e, t = \"geographic\") {\n  let n = e[1];\n  \"geographic\" === t && (n = a(n)), n %= 360;\n  const r = e[0];\n  return [r * Math.cos(n / i), r * Math.sin(n / i)];\n}\n\nfunction l(e, i, r = \"geographic\", o = 1) {\n  if (!n(e)) return e;\n  const {\n    pixels: a,\n    width: l,\n    height: c\n  } = e,\n        p = l * c,\n        u = a[0],\n        x = a[1],\n        m = t.createEmptyBand(e.pixelType, p),\n        f = t.createEmptyBand(e.pixelType, p);\n  let d = 0;\n\n  for (let t = 0; t < c; t++) for (let e = 0; e < l; e++) \"vector-uv\" === i ? ([m[d], f[d]] = h([u[d], x[d]], r), m[d] *= o) : ([m[d], f[d]] = s([u[d], x[d]], r), m[d] *= o, f[d] *= o), d++;\n\n  const g = new t({\n    pixelType: e.pixelType,\n    width: e.width,\n    height: e.height,\n    mask: e.mask,\n    validPixelCount: e.validPixelCount,\n    maskIsAlpha: e.maskIsAlpha,\n    pixels: [m, f]\n  });\n  return g.updateStatistics(), g;\n}\n\nfunction c(e, t, i = 1) {\n  if (1 === i || !n(e)) return e;\n  const r = e.clone(),\n        {\n    pixels: o,\n    width: a,\n    height: h\n  } = r,\n        s = o[0],\n        l = o[1];\n  let c = 0;\n\n  for (let n = 0; n < h; n++) for (let e = 0; e < a; e++) \"vector-uv\" === t ? (s[c] *= i, l[c] *= i) : s[c] *= i, c++;\n\n  return r.updateStatistics(), r;\n}\n\nfunction p(t, i, n, r, o) {\n  if (!e(o) || !o.spatialReference.equals(t.spatialReference)) return {\n    extent: t,\n    width: i,\n    height: n,\n    resolution: t.width / i\n  };\n  const a = o.xmin,\n        h = o.ymax;\n  r = Math.max(r || 0, 30);\n  const s = Math.ceil(i * (1 / r)),\n        l = Math.ceil(n * (1 / r)),\n        c = ((t.xmax - t.xmin) / s + (t.ymax - t.ymin) / l) / 2;\n  return t.xmin = a + Math.floor((t.xmin - a) / c) * c, t.xmax = a + Math.ceil((t.xmax - a) / c) * c, t.ymin = h + Math.floor((t.ymin - h) / c) * c, t.ymax = h + Math.ceil((t.ymax - h) / c) * c, {\n    extent: t,\n    width: Math.round(t.width / c),\n    height: Math.round(t.height / c),\n    resolution: c\n  };\n}\n\nr.set(\"meter-per-second\", 1), r.set(\"kilometer-per-hour\", .277778), r.set(\"knots\", .514444), r.set(\"feet-per-second\", .3048), r.set(\"mile-per-hour\", .44704);\nexport { l as convertVectorFieldData, c as convertVectorFieldUnit, o as getUnitConversionFactor, n as isValidPixelBlock, p as snapImageToSymbolTile };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/layers/support/rasterFunctions/vectorFieldUtils.js"],"names":["isSome","e","t","i","Math","PI","n","declaredClass","pixels","length","r","Map","o","get","a","h","sqrt","atan2","s","cos","sin","l","width","height","c","p","u","x","m","createEmptyBand","pixelType","f","d","g","mask","validPixelCount","maskIsAlpha","updateStatistics","clone","spatialReference","equals","extent","resolution","xmin","ymax","max","ceil","xmax","ymin","floor","round","set","convertVectorFieldData","convertVectorFieldUnit","getUnitConversionFactor","isValidPixelBlock","snapImageToSymbolTile"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import t from\"../PixelBlock.js\";const i=180/Math.PI,n=function(e){return e&&\"esri.layers.support.PixelBlock\"===e.declaredClass&&e.pixels&&e.pixels.length>0},r=new Map;function o(e,t){return r.get(e)/r.get(t)||1}function a(e){return(450-e)%360}function h(e,t=\"geographic\"){const[n,r]=e,o=Math.sqrt(n*n+r*r);let h=Math.atan2(r,n)*i;return h=(360+h)%360,\"geographic\"===t&&(h=a(h)),[o,h]}function s(e,t=\"geographic\"){let n=e[1];\"geographic\"===t&&(n=a(n)),n%=360;const r=e[0];return[r*Math.cos(n/i),r*Math.sin(n/i)]}function l(e,i,r=\"geographic\",o=1){if(!n(e))return e;const{pixels:a,width:l,height:c}=e,p=l*c,u=a[0],x=a[1],m=t.createEmptyBand(e.pixelType,p),f=t.createEmptyBand(e.pixelType,p);let d=0;for(let t=0;t<c;t++)for(let e=0;e<l;e++)\"vector-uv\"===i?([m[d],f[d]]=h([u[d],x[d]],r),m[d]*=o):([m[d],f[d]]=s([u[d],x[d]],r),m[d]*=o,f[d]*=o),d++;const g=new t({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[m,f]});return g.updateStatistics(),g}function c(e,t,i=1){if(1===i||!n(e))return e;const r=e.clone(),{pixels:o,width:a,height:h}=r,s=o[0],l=o[1];let c=0;for(let n=0;n<h;n++)for(let e=0;e<a;e++)\"vector-uv\"===t?(s[c]*=i,l[c]*=i):s[c]*=i,c++;return r.updateStatistics(),r}function p(t,i,n,r,o){if(!e(o)||!o.spatialReference.equals(t.spatialReference))return{extent:t,width:i,height:n,resolution:t.width/i};const a=o.xmin,h=o.ymax;r=Math.max(r||0,30);const s=Math.ceil(i*(1/r)),l=Math.ceil(n*(1/r)),c=((t.xmax-t.xmin)/s+(t.ymax-t.ymin)/l)/2;return t.xmin=a+Math.floor((t.xmin-a)/c)*c,t.xmax=a+Math.ceil((t.xmax-a)/c)*c,t.ymin=h+Math.floor((t.ymin-h)/c)*c,t.ymax=h+Math.ceil((t.ymax-h)/c)*c,{extent:t,width:Math.round(t.width/c),height:Math.round(t.height/c),resolution:c}}r.set(\"meter-per-second\",1),r.set(\"kilometer-per-hour\",.277778),r.set(\"knots\",.514444),r.set(\"feet-per-second\",.3048),r.set(\"mile-per-hour\",.44704);export{l as convertVectorFieldData,c as convertVectorFieldUnit,o as getUnitConversionFactor,n as isValidPixelBlock,p as snapImageToSymbolTile};\n"]},"metadata":{},"sourceType":"module"}