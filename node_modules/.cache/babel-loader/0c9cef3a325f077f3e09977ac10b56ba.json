{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../../core/clock.js\";\nimport { someMap as t } from \"../../../core/MapUtils.js\";\nimport { InputHandler as i } from \"../InputHandler.js\";\nimport { manhattanDistance as o } from \"./support.js\";\nconst l = {\n  maximumDoubleClickDelay: 250,\n  maximumDoubleClickDistance: 10,\n  maximumDoubleTouchDelay: 350,\n  maximumDoubleTouchDistance: 35\n};\n\nclass s extends i {\n  constructor(t = l.maximumDoubleClickDelay, i = l.maximumDoubleClickDistance, o = l.maximumDoubleTouchDelay, s = l.maximumDoubleTouchDistance, u = e) {\n    super(!1), this.maximumDoubleClickDelay = t, this.maximumDoubleClickDistance = i, this.maximumDoubleTouchDelay = o, this.maximumDoubleTouchDistance = s, this._clock = u, this._pointerState = new Map(), this._click = this.registerOutgoing(\"click\"), this._doubleClick = this.registerOutgoing(\"double-click\"), this.registerIncoming(\"immediate-click\", this._handleImmediateClick.bind(this)), this.registerIncoming(\"pointer-drag\", this._handlePointerDrag.bind(this)), this.registerIncoming(\"drag\", this._handleDrag.bind(this));\n  }\n\n  onUninstall() {\n    this._pointerState.forEach(e => {\n      null != e.doubleClickTimeout && (e.doubleClickTimeout.remove(), e.doubleClickTimeout = null);\n    });\n  }\n\n  get hasPendingInputs() {\n    return t(this._pointerState, e => null != e.doubleClickTimeout);\n  }\n\n  _pointerId(e) {\n    const t = e.native;\n    return \"mouse\" === t.pointerType ? `${t.pointerId}:${t.button}` : `${t.pointerType}`;\n  }\n\n  _handleImmediateClick(e) {\n    const t = e.data,\n          i = this._pointerId(t),\n          l = this._pointerState.get(i);\n\n    if (l) {\n      const s = \"touch\" === t.native.pointerType ? this.maximumDoubleTouchDistance : this.maximumDoubleClickDistance;\n      o(l.event.data, t) > s ? (this._clearDoubleClickTimeout(i, !0), this._startClick(e)) : (this._clearDoubleClickTimeout(i, !1), this._doubleClick.emit(l.event.data, void 0, l.event.modifiers));\n    } else this._startClick(e);\n  }\n\n  _startClick(e) {\n    const t = this._pointerId(e.data),\n          i = \"touch\" === e.data.native.pointerType ? this.maximumDoubleTouchDelay : this.maximumDoubleClickDelay;\n\n    this._pointerState.set(t, {\n      event: e,\n      doubleClickTimeout: this._clock.setTimeout(() => this._doubleClickTimeoutExceeded(t), i)\n    }), this.refreshHasPendingInputs();\n  }\n\n  _handlePointerDrag(e) {\n    const t = this._pointerId(e.data.currentEvent);\n\n    this._clearDoubleClickTimeout(t, !0);\n  }\n\n  _handleDrag(e) {\n    const t = this._pointerId(e.data.pointer);\n\n    this._clearDoubleClickTimeout(t, !0);\n  }\n\n  _clearDoubleClickTimeout(e, t) {\n    const i = this._pointerState.get(e);\n\n    i && (i.doubleClickTimeout.remove(), i.doubleClickTimeout = null, t && this._doubleClickTimeoutExceeded(e), this._pointerState.delete(e), this.refreshHasPendingInputs());\n  }\n\n  _doubleClickTimeoutExceeded(e) {\n    const t = this._pointerState.get(e);\n\n    this._click.emit(t.event.data, void 0, t.event.modifiers), t.doubleClickTimeout = null, this._pointerState.delete(e), this.refreshHasPendingInputs();\n  }\n\n}\n\nexport { l as DefaultParameters, s as SingleAndDoubleClick };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/input/recognizers/SingleAndDoubleClick.js"],"names":["e","someMap","t","InputHandler","i","manhattanDistance","o","l","maximumDoubleClickDelay","maximumDoubleClickDistance","maximumDoubleTouchDelay","maximumDoubleTouchDistance","s","constructor","u","_clock","_pointerState","Map","_click","registerOutgoing","_doubleClick","registerIncoming","_handleImmediateClick","bind","_handlePointerDrag","_handleDrag","onUninstall","forEach","doubleClickTimeout","remove","hasPendingInputs","_pointerId","native","pointerType","pointerId","button","data","get","event","_clearDoubleClickTimeout","_startClick","emit","modifiers","set","setTimeout","_doubleClickTimeoutExceeded","refreshHasPendingInputs","currentEvent","pointer","delete","DefaultParameters","SingleAndDoubleClick"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/clock.js\";import{someMap as t}from\"../../../core/MapUtils.js\";import{InputHandler as i}from\"../InputHandler.js\";import{manhattanDistance as o}from\"./support.js\";const l={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};class s extends i{constructor(t=l.maximumDoubleClickDelay,i=l.maximumDoubleClickDistance,o=l.maximumDoubleTouchDelay,s=l.maximumDoubleTouchDistance,u=e){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=i,this.maximumDoubleTouchDelay=o,this.maximumDoubleTouchDistance=s,this._clock=u,this._pointerState=new Map,this._click=this.registerOutgoing(\"click\"),this._doubleClick=this.registerOutgoing(\"double-click\"),this.registerIncoming(\"immediate-click\",this._handleImmediateClick.bind(this)),this.registerIncoming(\"pointer-drag\",this._handlePointerDrag.bind(this)),this.registerIncoming(\"drag\",this._handleDrag.bind(this))}onUninstall(){this._pointerState.forEach((e=>{null!=e.doubleClickTimeout&&(e.doubleClickTimeout.remove(),e.doubleClickTimeout=null)}))}get hasPendingInputs(){return t(this._pointerState,(e=>null!=e.doubleClickTimeout))}_pointerId(e){const t=e.native;return\"mouse\"===t.pointerType?`${t.pointerId}:${t.button}`:`${t.pointerType}`}_handleImmediateClick(e){const t=e.data,i=this._pointerId(t),l=this._pointerState.get(i);if(l){const s=\"touch\"===t.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;o(l.event.data,t)>s?(this._clearDoubleClickTimeout(i,!0),this._startClick(e)):(this._clearDoubleClickTimeout(i,!1),this._doubleClick.emit(l.event.data,void 0,l.event.modifiers))}else this._startClick(e)}_startClick(e){const t=this._pointerId(e.data),i=\"touch\"===e.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;this._pointerState.set(t,{event:e,doubleClickTimeout:this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(t)),i)}),this.refreshHasPendingInputs()}_handlePointerDrag(e){const t=this._pointerId(e.data.currentEvent);this._clearDoubleClickTimeout(t,!0)}_handleDrag(e){const t=this._pointerId(e.data.pointer);this._clearDoubleClickTimeout(t,!0)}_clearDoubleClickTimeout(e,t){const i=this._pointerState.get(e);i&&(i.doubleClickTimeout.remove(),i.doubleClickTimeout=null,t&&this._doubleClickTimeoutExceeded(e),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimeout=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}}export{l as DefaultParameters,s as SingleAndDoubleClick};\n"]},"metadata":{},"sourceType":"module"}