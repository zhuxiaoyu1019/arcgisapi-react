{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../chunks/tslib.es6.js\";\nimport s from \"./Accessor.js\";\nimport e from \"./Logger.js\";\nimport { runTracked as a } from \"./accessorSupport/tracking.js\";\nimport { subclass as r } from \"./accessorSupport/decorators/subclass.js\";\nimport { SimpleTrackingTarget as n } from \"./accessorSupport/tracking/SimpleTrackingTarget.js\";\n\nconst c = s => {\n  let a = class extends s {\n    constructor() {\n      super(...arguments), this.asyncUpdateState = new Map();\n    }\n\n    autoUpdateAsync(t, s) {\n      return o(s => this.updateAsync(t, s), s);\n    }\n\n    async updateAsync(t, s) {\n      if (!this.startAsyncUpdate(t)) {\n        try {\n          const e = await s();\n\n          this._set(t, e);\n        } catch (a) {\n          e.getLogger(this.declaredClass).warn(`Async update of \"${t}\" failed. Async update functions should not throw exceptions.`);\n        }\n\n        this.endAsyncUpdate(t) && this.updateAsync(t, s);\n      }\n    }\n\n    startAsyncUpdate(t) {\n      var s;\n      const e = null != (s = this.asyncUpdateState.get(t)) ? s : 0;\n      return 1 & e ? (this.asyncUpdateState.set(t, 2 | e), !0) : (this.asyncUpdateState.set(t, 1 | e), !1);\n    }\n\n    endAsyncUpdate(t) {\n      var s;\n      const e = -2 & (null != (s = this.asyncUpdateState.get(t)) ? s : 0);\n      return 2 & e ? (this.asyncUpdateState.set(t, -3 & e), !0) : (this.asyncUpdateState.set(t, e), !1);\n    }\n\n  };\n  return a = t([r(\"esri.core.AsyncUpdate\")], a), a;\n};\n\nfunction o(t, s) {\n  const e = () => {\n    o && !p && t(r);\n  },\n        r = () => {\n    if (!o || p) return s();\n    o.clear(), p = !0;\n    const t = a(o, s);\n    return p = !1, t;\n  },\n        c = () => {\n    o && (o.destroy(), o = null);\n  };\n\n  let o = new n(e),\n      p = !1;\n  return t(r), {\n    remove: c\n  };\n}\n\nlet p = class extends c(s) {};\np = t([r(\"esri.core.AsyncUpdate\")], p);\nexport { p as AsyncUpdate, c as AsyncUpdateMixin };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/core/AsyncUpdate.js"],"names":["_","t","s","e","runTracked","a","subclass","r","SimpleTrackingTarget","n","c","constructor","arguments","asyncUpdateState","Map","autoUpdateAsync","o","updateAsync","startAsyncUpdate","_set","getLogger","declaredClass","warn","endAsyncUpdate","get","set","p","clear","destroy","remove","AsyncUpdate","AsyncUpdateMixin"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../chunks/tslib.es6.js\";import s from\"./Accessor.js\";import e from\"./Logger.js\";import{runTracked as a}from\"./accessorSupport/tracking.js\";import{subclass as r}from\"./accessorSupport/decorators/subclass.js\";import{SimpleTrackingTarget as n}from\"./accessorSupport/tracking/SimpleTrackingTarget.js\";const c=s=>{let a=class extends s{constructor(){super(...arguments),this.asyncUpdateState=new Map}autoUpdateAsync(t,s){return o((s=>this.updateAsync(t,s)),s)}async updateAsync(t,s){if(!this.startAsyncUpdate(t)){try{const e=await s();this._set(t,e)}catch(a){e.getLogger(this.declaredClass).warn(`Async update of \"${t}\" failed. Async update functions should not throw exceptions.`)}this.endAsyncUpdate(t)&&this.updateAsync(t,s)}}startAsyncUpdate(t){var s;const e=null!=(s=this.asyncUpdateState.get(t))?s:0;return 1&e?(this.asyncUpdateState.set(t,2|e),!0):(this.asyncUpdateState.set(t,1|e),!1)}endAsyncUpdate(t){var s;const e=-2&(null!=(s=this.asyncUpdateState.get(t))?s:0);return 2&e?(this.asyncUpdateState.set(t,-3&e),!0):(this.asyncUpdateState.set(t,e),!1)}};return a=t([r(\"esri.core.AsyncUpdate\")],a),a};function o(t,s){const e=()=>{o&&!p&&t(r)},r=()=>{if(!o||p)return s();o.clear(),p=!0;const t=a(o,s);return p=!1,t},c=()=>{o&&(o.destroy(),o=null)};let o=new n(e),p=!1;return t(r),{remove:c}}let p=class extends(c(s)){};p=t([r(\"esri.core.AsyncUpdate\")],p);export{p as AsyncUpdate,c as AsyncUpdateMixin};\n"]},"metadata":{},"sourceType":"module"}