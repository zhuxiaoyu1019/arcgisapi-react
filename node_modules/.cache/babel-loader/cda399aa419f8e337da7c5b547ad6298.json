{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../../../core/maybe.js\";\nimport { i as n, g as r, r as t, f as o, b as i } from \"../../../../chunks/vec3.js\";\nimport { c as s } from \"../../../../chunks/vec3f64.js\";\nimport { wrap as c } from \"../../../../geometry/support/ray.js\";\nimport { i as a, k as f } from \"../../../../chunks/sphere.js\";\nimport { defaultApplyOptions as m, interactionDirectionTowardsConstraintMinimization as u, adjustRangeForInteraction as p } from \"./common.js\";\n\nfunction d(e, n, r = m) {\n  if (!e.state.isLocal) return 0;\n  const t = e.state.constraints.distance;\n  if (!e.pointsOfInterest.surfaceOrigin.renderLocation || t === 1 / 0) return 0;\n  x.min = 0, x.max = t, O(e, r, x);\n  const o = g(e, n),\n        i = x.max - o;\n  return i >= -1e-6 ? 0 : i;\n}\n\nfunction y(n, t, s = m) {\n  const p = d(n, t, s);\n  if (0 === p) return !1;\n  const y = n.pointsOfInterest.surfaceOrigin,\n        O = g(n, t) + p,\n        x = r(l, t.eye),\n        C = u(t, s.interactionDirection, j(n, t, h), L);\n  if (!a(f(y.renderLocation, O), c(t.eye, C), k)) return !1;\n  t.eye = k;\n  const b = o(I, t.eye, x);\n  t.center = i(k, t.center, b);\n  const v = n.renderCoordsHelper.getAltitude(t.center),\n        H = n.renderCoordsHelper.intersectInfiniteManifold(t.ray, v, k);\n  return e(H) && (t.center = H), !0;\n}\n\nfunction O(e, n, r) {\n  const t = n.interactionType;\n  if (0 === t) return;\n  const {\n    min: o,\n    max: i\n  } = r,\n        {\n    interactionStartCamera: s,\n    interactionFactor: c\n  } = n,\n        a = 1 === t || 4 === t,\n        f = d(e, s),\n        m = 0 === f ? 0 : g(e, s);\n  r.min = o, r.max = i;\n  p(f, m, a, c, .05 * m, r);\n}\n\nfunction g(e, r) {\n  const t = e.pointsOfInterest.surfaceOrigin;\n  return n(r.eye, t.renderLocation);\n}\n\nfunction j(e, n, r) {\n  const o = e.pointsOfInterest.surfaceOrigin;\n  return t(r, n.eye, o.renderLocation);\n}\n\nconst x = {\n  min: 0,\n  max: 0\n},\n      l = s(),\n      I = s(),\n      L = s(),\n      h = s(),\n      k = s();\nexport { y as applyDistanceConstraint, d as getDistanceConstraintError };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/camera/constraintUtils/distance.js"],"names":["isSome","e","i","n","g","r","t","f","o","b","c","s","wrap","a","k","defaultApplyOptions","m","interactionDirectionTowardsConstraintMinimization","u","adjustRangeForInteraction","p","d","state","isLocal","constraints","distance","pointsOfInterest","surfaceOrigin","renderLocation","x","min","max","O","y","l","eye","C","interactionDirection","j","h","L","I","center","v","renderCoordsHelper","getAltitude","H","intersectInfiniteManifold","ray","interactionType","interactionStartCamera","interactionFactor","applyDistanceConstraint","getDistanceConstraintError"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../../core/maybe.js\";import{i as n,g as r,r as t,f as o,b as i}from\"../../../../chunks/vec3.js\";import{c as s}from\"../../../../chunks/vec3f64.js\";import{wrap as c}from\"../../../../geometry/support/ray.js\";import{i as a,k as f}from\"../../../../chunks/sphere.js\";import{defaultApplyOptions as m,interactionDirectionTowardsConstraintMinimization as u,adjustRangeForInteraction as p}from\"./common.js\";function d(e,n,r=m){if(!e.state.isLocal)return 0;const t=e.state.constraints.distance;if(!e.pointsOfInterest.surfaceOrigin.renderLocation||t===1/0)return 0;x.min=0,x.max=t,O(e,r,x);const o=g(e,n),i=x.max-o;return i>=-1e-6?0:i}function y(n,t,s=m){const p=d(n,t,s);if(0===p)return!1;const y=n.pointsOfInterest.surfaceOrigin,O=g(n,t)+p,x=r(l,t.eye),C=u(t,s.interactionDirection,j(n,t,h),L);if(!a(f(y.renderLocation,O),c(t.eye,C),k))return!1;t.eye=k;const b=o(I,t.eye,x);t.center=i(k,t.center,b);const v=n.renderCoordsHelper.getAltitude(t.center),H=n.renderCoordsHelper.intersectInfiniteManifold(t.ray,v,k);return e(H)&&(t.center=H),!0}function O(e,n,r){const t=n.interactionType;if(0===t)return;const{min:o,max:i}=r,{interactionStartCamera:s,interactionFactor:c}=n,a=1===t||4===t,f=d(e,s),m=0===f?0:g(e,s);r.min=o,r.max=i;p(f,m,a,c,.05*m,r)}function g(e,r){const t=e.pointsOfInterest.surfaceOrigin;return n(r.eye,t.renderLocation)}function j(e,n,r){const o=e.pointsOfInterest.surfaceOrigin;return t(r,n.eye,o.renderLocation)}const x={min:0,max:0},l=s(),I=s(),L=s(),h=s(),k=s();export{y as applyDistanceConstraint,d as getDistanceConstraintError};\n"]},"metadata":{},"sourceType":"module"}