{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { validateLanguage as n, findScriptDependencies as e, checkScript as r, findFieldLiterals as o, validateScript as t, referencesMember as i, referencesFunction as c } from \"./treeAnalysis.js\";\nimport { parse as l } from \"./lib/esprima.js\";\n\nfunction s(r, o = []) {\n  const t = l(\"function _() { \" + r + \"\\n}\");\n  if (null === t.body || void 0 === t.body) throw new Error(\"No formula provided.\");\n  if (0 === t.body.length) throw new Error(\"No formula provided.\");\n  if (0 === t.body.length) throw new Error(\"No formula provided.\");\n  if (\"BlockStatement\" !== t.body[0].body.type) throw new Error(\"Invalid formula content.\");\n  const i = n(t);\n  if (\"\" !== i) throw new Error(i);\n  return e(t, o), t;\n}\n\nfunction u(n, e, o, t, i) {\n  const c = [],\n        s = \"function _() { \\n\".length - 1,\n        u = \"function _() { \\n\" + n + \"\\n}\";\n\n  try {\n    const n = l(u, {\n      tolerant: !0,\n      loc: !0,\n      range: !0\n    }),\n          a = n.errors;\n    if (a.length > 0) for (let e = 0; e < a.length; e++) c.push({\n      line: a[e].lineNumber - 2,\n      character: a[e].column,\n      reason: a[e].description\n    });\n    const f = r(n, e, o, t, i);\n\n    for (let e = 0; e < f.length; e++) f[e].line = f[e].line - 2, f[e].range && (f[e].range = [f[e][0] - s, f[e][1] - s]), f[e].loc && (f[e].loc.start.line = f[e].loc.start.line - 2, f[e].loc.end.line = f[e].loc.end.line - 2), c.push(f[e]);\n  } catch (a) {\n    try {\n      if (\"Unexpected token }\" === a.description) {\n        const n = u.split(\"\\n\").length;\n        a.lineNumber === n ? (a.index = u.length - 1, c.push({\n          line: a.lineNumber - 4,\n          character: a.column,\n          reason: \"Unexpected end of script\"\n        })) : (a.index = u.length - 1, c.push({\n          line: a.lineNumber - 2,\n          character: a.column,\n          reason: \"Unexpected end of script\"\n        }));\n      } else c.push({\n        line: a.lineNumber - 2,\n        character: a.column,\n        reason: a.description\n      });\n    } catch (f) {}\n  }\n\n  return c;\n}\n\nfunction a(n, e) {\n  return o(n);\n}\n\nfunction f(n, e, r) {\n  return t(n, e, r);\n}\n\nfunction d(n, e) {\n  return i(n, e);\n}\n\nfunction h(n, e) {\n  return c(n, e);\n}\n\nexport { a as extractFieldLiterals, s as parseScript, h as referencesFunction, d as referencesMember, u as scriptCheck, f as validateScript };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/arcade/parser.js"],"names":["validateLanguage","n","findScriptDependencies","e","checkScript","r","findFieldLiterals","o","validateScript","t","referencesMember","i","referencesFunction","c","parse","l","s","body","Error","length","type","u","tolerant","loc","range","a","errors","push","line","lineNumber","character","column","reason","description","f","start","end","split","index","d","h","extractFieldLiterals","parseScript","scriptCheck"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{validateLanguage as n,findScriptDependencies as e,checkScript as r,findFieldLiterals as o,validateScript as t,referencesMember as i,referencesFunction as c}from\"./treeAnalysis.js\";import{parse as l}from\"./lib/esprima.js\";function s(r,o=[]){const t=l(\"function _() { \"+r+\"\\n}\");if(null===t.body||void 0===t.body)throw new Error(\"No formula provided.\");if(0===t.body.length)throw new Error(\"No formula provided.\");if(0===t.body.length)throw new Error(\"No formula provided.\");if(\"BlockStatement\"!==t.body[0].body.type)throw new Error(\"Invalid formula content.\");const i=n(t);if(\"\"!==i)throw new Error(i);return e(t,o),t}function u(n,e,o,t,i){const c=[],s=\"function _() { \\n\".length-1,u=\"function _() { \\n\"+n+\"\\n}\";try{const n=l(u,{tolerant:!0,loc:!0,range:!0}),a=n.errors;if(a.length>0)for(let e=0;e<a.length;e++)c.push({line:a[e].lineNumber-2,character:a[e].column,reason:a[e].description});const f=r(n,e,o,t,i);for(let e=0;e<f.length;e++)f[e].line=f[e].line-2,f[e].range&&(f[e].range=[f[e][0]-s,f[e][1]-s]),f[e].loc&&(f[e].loc.start.line=f[e].loc.start.line-2,f[e].loc.end.line=f[e].loc.end.line-2),c.push(f[e])}catch(a){try{if(\"Unexpected token }\"===a.description){const n=u.split(\"\\n\").length;a.lineNumber===n?(a.index=u.length-1,c.push({line:a.lineNumber-4,character:a.column,reason:\"Unexpected end of script\"})):(a.index=u.length-1,c.push({line:a.lineNumber-2,character:a.column,reason:\"Unexpected end of script\"}))}else c.push({line:a.lineNumber-2,character:a.column,reason:a.description})}catch(f){}}return c}function a(n,e){return o(n)}function f(n,e,r){return t(n,e,r)}function d(n,e){return i(n,e)}function h(n,e){return c(n,e)}export{a as extractFieldLiterals,s as parseScript,h as referencesFunction,d as referencesMember,u as scriptCheck,f as validateScript};\n"]},"metadata":{},"sourceType":"module"}