{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { getId as t } from \"./CIMCursor.js\";\nimport { CurveHelper as s, PIXEL_TOLERANCE as e } from \"./CurveHelper.js\";\nconst i = 1e-7;\n\nclass n {\n  constructor() {\n    this._values = [], this.extPtGap = 0, this.ctrlPtGap = 0, this._length = 0, this._currentValue = 0;\n  }\n\n  isEmpty() {\n    return 0 === this._values.length;\n  }\n\n  size() {\n    return this._values.length;\n  }\n\n  init(t, s, e = !0) {\n    if (this._setEmpty(), !t || 0 === t.length) return !1;\n\n    for (let n = 0; n < t.length; n++) {\n      let s = Math.abs(t[n]);\n      e && s < i && (s = i), this._values.push(s), this._length += s;\n    }\n\n    return s && 1 & t.length && (this._length *= 2), 0 !== this._length && (this.ctrlPtGap = this.extPtGap = 0, this._currentValue = -1, !0);\n  }\n\n  scale(t) {\n    const s = this._values ? this._values.length : 0;\n\n    for (let e = 0; e < s; ++e) this._values[e] *= t;\n\n    this._length *= t, this.extPtGap *= t, this.ctrlPtGap *= t;\n  }\n\n  addValue(t) {\n    this._length += t, this._values.push(t);\n  }\n\n  firstValue() {\n    return this._values[0];\n  }\n\n  lastValue() {\n    return this._values[this._values.length - 1];\n  }\n\n  nextValue() {\n    return this._currentValue++, this._currentValue === this._values.length && (this._currentValue = 0), this._values[this._currentValue];\n  }\n\n  reset() {\n    this._currentValue = -1;\n  }\n\n  length() {\n    return this._length;\n  }\n\n  _setEmpty() {\n    this.extPtGap = this.ctrlPtGap = this._length = 0, this._currentValue = -1, this._values.length = 0;\n  }\n\n}\n\nclass h {\n  constructor() {\n    this.reset();\n  }\n\n  reset() {\n    this.segment = -1, this.segmentLength = 0, this.abscissa = 0, this.isPathEnd = !1, this.isPartEnd = !1;\n  }\n\n  isValid() {\n    return -1 !== this.segment;\n  }\n\n  copyTo(t) {\n    t.segment = this.segment, t.segmentLength = this.segmentLength, t.abscissa = this.abscissa, t.isPathEnd = this.isPathEnd, t.isPartEnd = this.isPartEnd;\n  }\n\n}\n\nclass r extends s {\n  constructor(t = 0, s = !1) {\n    super(t, s), this._tolerance = e, this._currentPosition = new h();\n  }\n\n  updateTolerance(t) {\n    this._tolerance = e * t;\n  }\n\n  init(t, s, e = !0) {\n    return e ? (this._patternLength = s.length(), this._partExtPtGap = s.extPtGap, this._partCtrlPtGap = s.ctrlPtGap) : (this._patternLength = 0, this._partExtPtGap = 0, this._partCtrlPtGap = 0), this._currentPosition.reset(), this._partSegCount = 0, this._path = t, this._seg = -1, this.setPosAtNextPart();\n  }\n\n  curPositionIsValid() {\n    return this._currentPosition.isValid();\n  }\n\n  nextPosition(t, s = 0) {\n    const e = new h();\n    return !!this._nextPosition(t, e, null, s) && (e.copyTo(this._currentPosition), !0);\n  }\n\n  curPointAndAngle(t) {\n    t.pt = this._getPoint(this._currentPosition);\n\n    const [s, e] = this._getAngle(this._currentPosition);\n\n    t.ca = s, t.sa = e;\n  }\n\n  nextPointAndAngle(t, s, e = 0) {\n    const i = new h();\n    if (!this._nextPosition(t, i, null, e)) return !1;\n    i.copyTo(this._currentPosition), s.pt = this._getPoint(i);\n\n    const [n, r] = this._getAngle(i);\n\n    return s.ca = n, s.sa = r, !0;\n  }\n\n  nextCurve(t) {\n    if (0 === t) return null;\n    const s = [],\n          e = new h();\n    return this._nextPosition(t, e, s, 1) ? (e.copyTo(this._currentPosition), s) : null;\n  }\n\n  isPathEnd() {\n    return this._currentPosition.isPathEnd;\n  }\n\n  getPathEnd() {\n    if (-1 === this._currentPosition.segment) throw new Error(\"missing segment\");\n    return this._path[this._currentPosition.segment + 1];\n  }\n\n  _nextPosition(t, s, e, i) {\n    if (this._currentPosition.isPathEnd) return !1;\n    let n = this._currentPosition.abscissa;\n\n    for (this._currentPosition.segmentLength > 0 && (n /= this._currentPosition.segmentLength), this._currentPosition.copyTo(s); s.abscissa + t * this._partLengthRatio > s.segmentLength + this._tolerance;) {\n      if (e) {\n        if (0 === e.length) if (0 === n) {\n          const t = this._path[s.segment];\n          e.push([t[0], t[1]]);\n        } else e.push(this.getSegCoord2D(this._path, s.segment, n));\n        const t = this._path[s.segment + 1];\n        e.push([t[0], t[1]]);\n      }\n\n      if (n = 0, t -= (s.segmentLength - s.abscissa) / this._partLengthRatio, this._partSegCount) s.segment = this.nextSegment(), s.segmentLength = this.calculateSegLength(this._path, s.segment), s.abscissa = 0, this._partSegCount--;else {\n        if (!this.setPosAtNextPart()) return 0 !== i && (s.segmentLength = this.calculateSegLength(this._path, s.segment), s.isPartEnd = !0, 1 === i ? (s.abscissa = s.segmentLength, s.isPathEnd = !0) : s.abscissa = s.segmentLength + t, !0);\n\n        this._currentPosition.copyTo(s);\n      }\n    }\n\n    if (s.abscissa += t * this._partLengthRatio, e) {\n      if (0 === e.length) if (0 === n) {\n        const t = this._path[s.segment];\n        e.push([t[0], t[1]]);\n      } else e.push(this.getSegCoord2D(this._path, s.segment, n));\n      const t = s.abscissa / s.segmentLength;\n\n      if (1 === t) {\n        const t = this._path[s.segment + 1];\n        e.push([t[0], t[1]]);\n      } else e.push(this.getSegCoord2D(this._path, s.segment, t));\n    }\n\n    return this._partSegCount || Math.abs(s.abscissa - s.segmentLength) < this._tolerance && (s.isPathEnd = this._partIsLast, s.isPartEnd = !0), !0;\n  }\n\n  _getPoint(t) {\n    if (-1 === t.segment) throw new Error(\"missing segment\");\n    const s = t.segmentLength <= 0 ? 0 : t.abscissa / t.segmentLength;\n    return this.getSegCoord2D(this._path, t.segment, s);\n  }\n\n  _getAngle(t) {\n    if (-1 === t.segment) throw new Error(\"missing segment\");\n    const s = t.segmentLength <= 0 ? 0 : t.abscissa / t.segmentLength;\n    return this.getSegAngleCS(this._path, t.segment, s);\n  }\n\n  setPosAtNextPart() {\n    for (; this._partSegCount;) this.hasNextSegment() && this.nextSegment(), this._partSegCount--;\n\n    if (!this.hasNextSegment()) return !1;\n\n    for (this._partLength = 0, this._partIsLast = !0, this._partSegCount = 0; this.hasNextSegment();) if (this._partLength += this.calculateSegLength(this._path, this.nextSegment()), this._partSegCount++, 1 === t(this._path[this.getEndPointIndex()])) {\n      this._partIsLast = !this.hasNextSegment();\n      break;\n    }\n\n    let s = this._partSegCount;\n\n    for (; s;) this.previousSegment(), --s;\n\n    this._currentPosition.segment = this.nextSegment(), this._currentPosition.segmentLength = this.calculateSegLength(this._path, this._currentPosition.segment), this._currentPosition.abscissa = 0, this._currentPosition.isPathEnd = this._currentPosition.isPartEnd = !1, --this._partSegCount;\n    const e = this.getStartPointIndex();\n    this._ctrlPtBegin = 1 === t(this._path[e]);\n    let i = e + this._partSegCount + 1;\n\n    if (i >= this._path.length && (i = 0), this._ctrlPtEnd = 1 === t(this._path[i]), this._patternLength > 0) {\n      const t = this._ctrlPtBegin ? this._partCtrlPtGap : this._partExtPtGap,\n            s = this._ctrlPtEnd ? this._partCtrlPtGap : this._partExtPtGap;\n      let e = Math.round((this._partLength - (t + s)) / this._patternLength);\n      e <= 0 && (e = t + s > 0 ? 0 : 1), this._partLengthRatio = this._partLength / (t + s + e * this._patternLength), this._partLengthRatio < .01 && (this._partLengthRatio = 1);\n    } else this._partLengthRatio = 1;\n\n    return !0;\n  }\n\n  hasNextSegment() {\n    return this._seg < this._path.length - 2;\n  }\n\n  previousSegment() {\n    return --this._seg;\n  }\n\n  nextSegment() {\n    return ++this._seg;\n  }\n\n  getStartPointIndex() {\n    return this._seg;\n  }\n\n  getEndPointIndex() {\n    return this._seg + 1;\n  }\n\n}\n\nexport { n as DashPattern, r as GeometryWalker };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/symbols/cim/GeometryWalker.js"],"names":["getId","t","CurveHelper","s","PIXEL_TOLERANCE","e","i","n","constructor","_values","extPtGap","ctrlPtGap","_length","_currentValue","isEmpty","length","size","init","_setEmpty","Math","abs","push","scale","addValue","firstValue","lastValue","nextValue","reset","h","segment","segmentLength","abscissa","isPathEnd","isPartEnd","isValid","copyTo","r","_tolerance","_currentPosition","updateTolerance","_patternLength","_partExtPtGap","_partCtrlPtGap","_partSegCount","_path","_seg","setPosAtNextPart","curPositionIsValid","nextPosition","_nextPosition","curPointAndAngle","pt","_getPoint","_getAngle","ca","sa","nextPointAndAngle","nextCurve","getPathEnd","Error","_partLengthRatio","getSegCoord2D","nextSegment","calculateSegLength","_partIsLast","getSegAngleCS","hasNextSegment","_partLength","getEndPointIndex","previousSegment","getStartPointIndex","_ctrlPtBegin","_ctrlPtEnd","round","DashPattern","GeometryWalker"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{getId as t}from\"./CIMCursor.js\";import{CurveHelper as s,PIXEL_TOLERANCE as e}from\"./CurveHelper.js\";const i=1e-7;class n{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return 0===this._values.length}size(){return this._values.length}init(t,s,e=!0){if(this._setEmpty(),!t||0===t.length)return!1;for(let n=0;n<t.length;n++){let s=Math.abs(t[n]);e&&s<i&&(s=i),this._values.push(s),this._length+=s}return s&&1&t.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(t){const s=this._values?this._values.length:0;for(let e=0;e<s;++e)this._values[e]*=t;this._length*=t,this.extPtGap*=t,this.ctrlPtGap*=t}addValue(t){this._length+=t,this._values.push(t)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}class h{constructor(){this.reset()}reset(){this.segment=-1,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return-1!==this.segment}copyTo(t){t.segment=this.segment,t.segmentLength=this.segmentLength,t.abscissa=this.abscissa,t.isPathEnd=this.isPathEnd,t.isPartEnd=this.isPartEnd}}class r extends s{constructor(t=0,s=!1){super(t,s),this._tolerance=e,this._currentPosition=new h}updateTolerance(t){this._tolerance=e*t}init(t,s,e=!0){return e?(this._patternLength=s.length(),this._partExtPtGap=s.extPtGap,this._partCtrlPtGap=s.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._path=t,this._seg=-1,this.setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(t,s=0){const e=new h;return!!this._nextPosition(t,e,null,s)&&(e.copyTo(this._currentPosition),!0)}curPointAndAngle(t){t.pt=this._getPoint(this._currentPosition);const[s,e]=this._getAngle(this._currentPosition);t.ca=s,t.sa=e}nextPointAndAngle(t,s,e=0){const i=new h;if(!this._nextPosition(t,i,null,e))return!1;i.copyTo(this._currentPosition),s.pt=this._getPoint(i);const[n,r]=this._getAngle(i);return s.ca=n,s.sa=r,!0}nextCurve(t){if(0===t)return null;const s=[],e=new h;return this._nextPosition(t,e,s,1)?(e.copyTo(this._currentPosition),s):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){if(-1===this._currentPosition.segment)throw new Error(\"missing segment\");return this._path[this._currentPosition.segment+1]}_nextPosition(t,s,e,i){if(this._currentPosition.isPathEnd)return!1;let n=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(n/=this._currentPosition.segmentLength),this._currentPosition.copyTo(s);s.abscissa+t*this._partLengthRatio>s.segmentLength+this._tolerance;){if(e){if(0===e.length)if(0===n){const t=this._path[s.segment];e.push([t[0],t[1]])}else e.push(this.getSegCoord2D(this._path,s.segment,n));const t=this._path[s.segment+1];e.push([t[0],t[1]])}if(n=0,t-=(s.segmentLength-s.abscissa)/this._partLengthRatio,this._partSegCount)s.segment=this.nextSegment(),s.segmentLength=this.calculateSegLength(this._path,s.segment),s.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart())return 0!==i&&(s.segmentLength=this.calculateSegLength(this._path,s.segment),s.isPartEnd=!0,1===i?(s.abscissa=s.segmentLength,s.isPathEnd=!0):s.abscissa=s.segmentLength+t,!0);this._currentPosition.copyTo(s)}}if(s.abscissa+=t*this._partLengthRatio,e){if(0===e.length)if(0===n){const t=this._path[s.segment];e.push([t[0],t[1]])}else e.push(this.getSegCoord2D(this._path,s.segment,n));const t=s.abscissa/s.segmentLength;if(1===t){const t=this._path[s.segment+1];e.push([t[0],t[1]])}else e.push(this.getSegCoord2D(this._path,s.segment,t))}return this._partSegCount||Math.abs(s.abscissa-s.segmentLength)<this._tolerance&&(s.isPathEnd=this._partIsLast,s.isPartEnd=!0),!0}_getPoint(t){if(-1===t.segment)throw new Error(\"missing segment\");const s=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegCoord2D(this._path,t.segment,s)}_getAngle(t){if(-1===t.segment)throw new Error(\"missing segment\");const s=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegAngleCS(this._path,t.segment,s)}setPosAtNextPart(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this.nextSegment()),this._partSegCount++,1===t(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}let s=this._partSegCount;for(;s;)this.previousSegment(),--s;this._currentPosition.segment=this.nextSegment(),this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const e=this.getStartPointIndex();this._ctrlPtBegin=1===t(this._path[e]);let i=e+this._partSegCount+1;if(i>=this._path.length&&(i=0),this._ctrlPtEnd=1===t(this._path[i]),this._patternLength>0){const t=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,s=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let e=Math.round((this._partLength-(t+s))/this._patternLength);e<=0&&(e=t+s>0?0:1),this._partLengthRatio=this._partLength/(t+s+e*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}hasNextSegment(){return this._seg<this._path.length-2}previousSegment(){return--this._seg}nextSegment(){return++this._seg}getStartPointIndex(){return this._seg}getEndPointIndex(){return this._seg+1}}export{n as DashPattern,r as GeometryWalker};\n"]},"metadata":{},"sourceType":"module"}