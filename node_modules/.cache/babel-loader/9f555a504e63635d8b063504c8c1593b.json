{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport \"../intl.js\";\nimport { eventKey as t } from \"../core/events.js\";\nimport s from \"../core/Handles.js\";\nimport { createAbortController as i } from \"../core/promiseUtils.js\";\nimport { escapeRegExpString as r } from \"../core/string.js\";\nimport { watch as n, on as o, init as a } from \"../core/watchUtils.js\";\nimport { aliasOf as u } from \"../core/accessorSupport/decorators/aliasOf.js\";\nimport \"../core/has.js\";\nimport \"../core/accessorSupport/ensureType.js\";\nimport \"../core/Logger.js\";\nimport { property as l } from \"../core/accessorSupport/decorators/property.js\";\nimport { subclass as c } from \"../core/accessorSupport/decorators/subclass.js\";\nimport d from \"./Widget.js\";\nimport h from \"./Search/SearchResultRenderer.js\";\nimport g from \"./Search/SearchViewModel.js\";\nimport { storeNode as p, keepMenuItemWithinView as _, isActivationKey as m } from \"./support/widgetUtils.js\";\nimport { messageBundle as v } from \"./support/decorators/messageBundle.js\";\nimport { vmEvent as M } from \"./support/decorators/vmEvent.js\";\nimport { tsx as I } from \"./support/jsxFactory.js\";\nimport { substitute as S } from \"../intl/substitute.js\";\nconst w = {\n  base: \"esri-search esri-widget\",\n  loader: \"esri-widget__loader\",\n  loaderText: \"esri-widget__loader-text\",\n  loaderAnimation: \"esri-widget__loader-animation\",\n  esriInput: \"esri-input\",\n  hasMultipleSources: \"esri-search--multiple-sources\",\n  isLoading: \"esri-search--loading\",\n  isSearching: \"esri-search--searching\",\n  showSuggestions: \"esri-search--show-suggestions\",\n  showSources: \"esri-search--sources\",\n  showWarning: \"esri-search--warning\",\n  container: \"esri-search__container\",\n  input: \"esri-search__input\",\n  inputContainer: \"esri-search__input-container\",\n  form: \"esri-search__form\",\n  submitButton: \"esri-search__submit-button\",\n  sourcesButton: \"esri-search__sources-button\",\n  clearButton: \"esri-search__clear-button\",\n  sourceName: \"esri-search__source-name\",\n  suggestionsMenu: \"esri-search__suggestions-menu\",\n  suggestionList: \"esri-search__suggestions-list\",\n  suggestionListCurrentLocation: \"esri-search__suggestions-list--current-location\",\n  sourcesMenu: \"esri-search__sources-menu\",\n  source: \"esri-search__source\",\n  warningMenu: \"esri-search__warning-menu\",\n  warningMenuBody: \"esri-search__warning-body\",\n  warningMenuHeader: \"esri-search__warning-header\",\n  warningMenuText: \"esri-search__warning-text\",\n  noValueText: \"esri-search__no-value-text\",\n  esriWidgetDisabled: \"esri-widget--disabled\",\n  button: \"esri-widget--button\",\n  fallbackText: \"esri-icon-font-fallback-text\",\n  header: \"esri-widget__heading\",\n  locate: \"esri-icon-locate-circled\",\n  menu: \"esri-menu\",\n  menuList: \"esri-menu__list\",\n  menuItem: \"esri-menu__list-item\",\n  menuItemActive: \"esri-menu__list-item--active\",\n  menuItemFocus: \"esri-menu__list-item--focus\",\n  menuHeader: \"esri-menu__header\",\n  loadingIcon: \"esri-icon-loading-indicator esri-rotating\",\n  searchIcon: \"esri-icon-search\",\n  dropdownIcon: \"esri-icon-down-arrow esri-search__sources-button--down\",\n  dropupIcon: \"esri-icon-up-arrow esri-search__sources-button--up\",\n  clearIcon: \"esri-icon-close\",\n  noticeIcon: \"esri-icon-notice-triangle\",\n  widgetIcon: \"esri-icon-search\",\n  disabled: \"esri-disabled\"\n},\n      b = /<[a-z/][\\s\\S]*>/i;\nlet y = class extends d {\n  constructor(e, t) {\n    super(e, t), this._activeMenuItemIndex = -1, this._handles = new s(), this._inputNode = null, this._menuItemCount = 0, this._sourceMenuButtonNode = null, this._sourceListNode = null, this._suggestionListNode = null, this._searchResultRenderer = new h(), this._locateFailed = null, this._container = null, this.activeMenu = \"none\", this.activeSource = null, this.activeSourceIndex = null, this.allPlaceholder = null, this.allSources = null, this.autoNavigate = null, this.autoSelect = null, this.defaultSources = null, this.disabled = !1, this.goToOverride = null, this.iconClass = w.widgetIcon, this.includeDefaultSources = null, this.label = void 0, this.locationEnabled = null, this.maxResults = null, this.maxSuggestions = null, this.messages = null, this.messagesCommon = null, this.minSuggestCharacters = null, this.popupEnabled = null, this.popupTemplate = null, this.portal = null, this.resultGraphic = null, this.resultGraphicEnabled = null, this.results = null, this.searchAllEnabled = null, this.searchTerm = null, this.selectedResult = null, this.sources = null, this.suggestions = null, this.suggestionsEnabled = null, this.view = null, this.viewModel = new g(), this._clearActiveMenu = () => {\n      this.activeMenu = \"none\";\n    }, this._removeActiveMenu = e => {\n      var t;\n      const s = e.relatedTarget;\n      s && null != (t = this._container) && t.contains(s) || this._clearActiveMenu();\n    }, this.own(n(this, \"searchTerm\", e => {\n      (e && \"warning\" === this.activeMenu || !e && !this.get(\"viewModel.selectedSuggestion.location\")) && this._clearActiveMenu();\n    }), o(this, \"viewModel.allSources\", \"change\", () => this._watchSourceChanges()), a(this, \"activeMenu\", () => this._resetActiveMenuItemIndex()), a(this, \"viewModel.defaultPopupTemplate\", e => {\n      e && (e.content = this._renderSearchResultsContent.bind(this));\n    }));\n  }\n\n  destroy() {\n    this._handles.destroy(), this._handles = null, this._cancelSuggest(), this._cancelSearch(), this._searchResultRenderer && (this._searchResultRenderer.viewModel = null, this._searchResultRenderer.destroy(), this._searchResultRenderer = null);\n  }\n\n  get displayedSearchTerm() {\n    return `${this.viewModel.searchTerm}`.trim();\n  }\n\n  get inputId() {\n    return this._buildId(\"input\");\n  }\n\n  get suggestionsMenuId() {\n    return this._buildId(\"suggest-menu\");\n  }\n\n  get sourceMenuId() {\n    return this._buildId(\"source-menu\");\n  }\n\n  get sourceMenuButtonId() {\n    return this._buildId(\"source-menu-button\");\n  }\n\n  clear() {}\n\n  focus() {\n    var e;\n    null == (e = this._inputNode) || e.focus(), this.emit(\"search-focus\");\n  }\n\n  blur() {\n    var e;\n    null == (e = this._inputNode) || e.blur(), this.emit(\"search-blur\");\n  }\n\n  search(e) {\n    this._clearActiveMenu(), this._cancelSuggest(), this._cancelSearch();\n    const t = i(),\n          {\n      signal: s\n    } = t;\n    return this._searchController = t, this.viewModel.search(e, {\n      signal: s\n    }).catch(e => {\n      if (this._searchController === t) return this._clearActiveMenu(), this._searchController = null, e;\n    }).then(e => {\n      if (this._searchController === t) return this.activeMenu = e.numResults ? \"none\" : \"warning\", this._searchController = null, e;\n    });\n  }\n\n  suggest(e) {\n    this._cancelSuggest();\n\n    const t = i(),\n          {\n      signal: s\n    } = t;\n    return this._suggestController = t, this.viewModel.suggest(e, null, {\n      signal: s\n    }).then(e => {\n      if (this._suggestController === t) return this._suggestController = null, e.numResults && this._openSuggestionMenu(), this._scrollToTopSuggestion(), e;\n    }).catch(() => {\n      if (this._suggestController === t) return this._suggestController = null, null;\n    });\n  }\n\n  render() {\n    const {\n      state: e\n    } = this.viewModel,\n          t = {\n      [w.disabled]: \"disabled\" === e,\n      [w.esriWidgetDisabled]: this.disabled\n    };\n    return I(\"div\", {\n      class: this.classes(w.base, t)\n    }, \"loading\" === e ? this.renderLoader() : this.renderContainer());\n  }\n\n  renderSubmitButton() {\n    const {\n      messages: e\n    } = this;\n    return I(\"button\", {\n      \"aria-label\": e.searchButtonTitle,\n      bind: this,\n      class: this.classes(w.submitButton, w.button),\n      key: \"esri-search__submit-button\",\n      onclick: this._handleSearchButtonClick,\n      title: e.searchButtonTitle\n    }, I(\"span\", {\n      \"aria-hidden\": \"true\",\n      class: w.searchIcon\n    }));\n  }\n\n  renderWarningMenu() {\n    return I(\"div\", {\n      key: \"esri-search__error-menu\",\n      class: this.classes(w.menu, w.warningMenu)\n    }, I(\"div\", {\n      class: w.warningMenuBody\n    }, this.renderWarning()));\n  }\n\n  renderSourceMenuButton() {\n    const {\n      messages: e,\n      activeMenu: t,\n      sourceMenuId: s,\n      sourceMenuButtonId: i\n    } = this,\n          {\n      activeSourceIndex: r,\n      allSources: n\n    } = this.viewModel;\n    return n.length > 1 ? I(\"button\", {\n      id: i,\n      key: \"esri-search__source-menu-button\",\n      bind: this,\n      \"aria-label\": e.searchIn,\n      title: e.searchIn,\n      \"aria-haspopup\": \"true\",\n      \"aria-expanded\": (\"source\" === t).toString(),\n      \"aria-controls\": s,\n      class: this.classes(w.sourcesButton, w.button),\n      onclick: this._handleSourcesMenuToggleClick,\n      onfocus: this._clearActiveMenu,\n      afterCreate: p,\n      \"data-node-ref\": \"_sourceMenuButtonNode\"\n    }, I(\"span\", {\n      \"aria-hidden\": \"true\",\n      class: w.dropdownIcon\n    }), I(\"span\", {\n      \"aria-hidden\": \"true\",\n      class: w.dropupIcon\n    }), I(\"span\", {\n      class: w.sourceName\n    }, this._getSourceName(r))) : null;\n  }\n\n  renderSourcesList() {\n    const {\n      allSources: e,\n      searchAllEnabled: t\n    } = this.viewModel,\n          {\n      _activeMenuItemIndex: s,\n      activeMenu: i,\n      sourceMenuId: r,\n      sourceMenuButtonId: n\n    } = this,\n          o = \"source\" === i && s > -1 ? this._buildId(\"source-item\", s) : null;\n    return e.length > 1 ? I(\"ul\", {\n      \"aria-activedescendant\": o,\n      \"aria-labelledby\": n,\n      id: r,\n      role: \"menu\",\n      bind: this,\n      afterCreate: p,\n      onkeydown: this._handleSourceMenuKeydown,\n      onkeyup: this._handleSourceMenuKeyup,\n      \"data-node-ref\": \"_sourceListNode\",\n      class: w.menuList,\n      tabIndex: -1\n    }, t ? this.renderSource(g.ALL_INDEX) : null, e.map((e, t) => this.renderSource(t)).toArray()) : null;\n  }\n\n  renderSourcesMenu() {\n    const {\n      allSources: e\n    } = this.viewModel;\n    return e.length > 1 ? I(\"div\", {\n      key: \"esri-search__source-menu\",\n      class: this.classes(w.menu, w.sourcesMenu)\n    }, this.renderSourcesList()) : null;\n  }\n\n  renderLoader() {\n    const {\n      messages: e,\n      messagesCommon: t\n    } = this;\n    return I(\"div\", {\n      class: w.loader,\n      key: \"base-loader\"\n    }, I(\"span\", {\n      \"aria-hidden\": \"true\",\n      class: w.loaderAnimation\n    }), I(\"span\", {\n      class: w.fallbackText\n    }, e.searchButtonTitle), I(\"span\", {\n      class: w.loaderText\n    }, t.loading));\n  }\n\n  renderContainer() {\n    const {\n      allSources: e,\n      state: t\n    } = this.viewModel,\n          {\n      activeMenu: s\n    } = this,\n          i = {\n      [w.hasMultipleSources]: e.length > 1,\n      [w.isLoading]: \"loading\" === t,\n      [w.isSearching]: \"searching\" === t,\n      [w.showWarning]: \"warning\" === s,\n      [w.showSources]: \"source\" === s,\n      [w.showSuggestions]: \"suggestion\" === s\n    };\n    return I(\"div\", {\n      tabIndex: -1,\n      afterCreate: e => {\n        this._container = e, e.addEventListener(\"focusout\", this._removeActiveMenu);\n      },\n      afterRemoved: e => {\n        e.removeEventListener(\"focusout\", this._removeActiveMenu);\n      },\n      class: this.classes(i, w.container),\n      key: \"base-container\"\n    }, this.renderSourceMenuButton(), this.renderSourcesMenu(), this.renderInputContainer(), this.renderSubmitButton(), this.renderWarningMenu());\n  }\n\n  renderClearButton() {\n    return this.searchTerm ? I(\"button\", {\n      bind: this,\n      class: this.classes(w.clearButton, w.button),\n      key: \"esri-search__clear-button\",\n      onclick: this._handleClearButtonClick,\n      onfocus: this._clearActiveMenu,\n      title: this.messages.clearButtonTitle\n    }, I(\"span\", {\n      \"aria-hidden\": \"true\",\n      class: w.clearIcon\n    })) : null;\n  }\n\n  renderLocationGroup() {\n    const {\n      messages: e,\n      locationEnabled: t,\n      displayedSearchTerm: s\n    } = this,\n          i = t && !s,\n          r = \"suggestion\" === this.activeMenu && 0 === this._activeMenuItemIndex;\n    return i ? I(\"ul\", {\n      role: \"group\",\n      key: \"esri-search__suggestion-list-current-location\",\n      class: this.classes(w.menuList, w.suggestionList, w.suggestionListCurrentLocation)\n    }, I(\"li\", {\n      bind: this,\n      \"data-current-location-item\": !0,\n      onclick: this._handleUseCurrentLocationClick,\n      id: this._buildId(\"suggestion-item\", 0),\n      \"aria-selected\": (\"suggestion\" === this.activeMenu && 0 === this._activeMenuItemIndex).toString(),\n      role: \"option\",\n      class: this.classes(w.menuItem, r ? w.menuItemFocus : null)\n    }, I(\"span\", {\n      \"aria-hidden\": \"true\",\n      class: w.locate\n    }), \" \", e.useCurrentLocation)) : null;\n  }\n\n  renderInput() {\n    const {\n      activeMenu: e,\n      locationEnabled: t,\n      displayedSearchTerm: s,\n      messages: i,\n      suggestionsMenuId: r,\n      inputId: n,\n      _activeMenuItemIndex: o\n    } = this,\n          {\n      maxInputLength: a,\n      placeholder: u,\n      searchTerm: l,\n      suggestionCount: c\n    } = this.viewModel,\n          d = !(!(t && !s) && !c),\n          h = \"suggestion\" === e && o > -1 ? this._buildId(\"suggestion-item\", o) : null;\n    return I(\"input\", {\n      \"aria-activedescendant\": h,\n      \"aria-autocomplete\": \"list\",\n      \"aria-expanded\": (d && \"suggestion\" === e).toString(),\n      \"aria-controls\": d ? r : null,\n      \"aria-haspopup\": \"listbox\",\n      \"aria-label\": i.searchButtonTitle,\n      bind: this,\n      placeholder: u,\n      maxlength: a,\n      autocomplete: \"off\",\n      type: \"text\",\n      class: this.classes(w.esriInput, w.input),\n      value: l,\n      id: n,\n      role: \"combobox\",\n      onkeyup: this._handleInputKeyup,\n      onclick: this._openSuggestionMenu,\n      oninput: this._handleInputPaste,\n      onpaste: this._handleInputPaste,\n      afterCreate: p,\n      \"data-node-ref\": \"_inputNode\",\n      onfocus: this.focus,\n      onblur: this.blur,\n      title: l ? \"\" : u\n    });\n  }\n\n  renderForm() {\n    return I(\"form\", {\n      key: \"esri-search__form\",\n      bind: this,\n      class: w.form,\n      onsubmit: this._formSubmit,\n      role: \"search\"\n    }, this.renderInput());\n  }\n\n  renderSuggestList(e) {\n    const {\n      sourceIndex: t\n    } = e,\n          s = e.results.length,\n          i = e.results;\n    return s ? I(\"ul\", {\n      role: \"group\",\n      key: `esri-search__suggestion-list-${t}`,\n      class: this.classes(w.menuList, w.suggestionList)\n    }, i.map(e => this.renderSuggestion(e, this._menuItemCount++))) : null;\n  }\n\n  renderSuggestionsGroup() {\n    const {\n      suggestions: e\n    } = this.viewModel;\n    return e ? e.map(e => [this.renderSuggestionHeader(e), this.renderSuggestList(e)]) : null;\n  }\n\n  renderSuggestionsMenu() {\n    const {\n      displayedSearchTerm: e,\n      locationEnabled: t,\n      suggestionsMenuId: s,\n      inputId: i\n    } = this,\n          {\n      suggestionCount: r\n    } = this.viewModel,\n          n = t && !e || r;\n    return this._menuItemCount = 0, n ? I(\"div\", {\n      id: s,\n      key: \"esri-search__suggestions-menu\",\n      class: this.classes(w.menu, w.suggestionsMenu),\n      role: \"listbox\",\n      \"aria-labelledby\": i,\n      bind: this,\n      afterCreate: p,\n      \"data-node-ref\": \"_suggestionListNode\"\n    }, this.renderLocationGroup(), this.renderSuggestionsGroup()) : null;\n  }\n\n  renderInputContainer() {\n    return I(\"div\", {\n      key: \"esri-search__input-container\",\n      class: w.inputContainer\n    }, this.renderForm(), this.renderSuggestionsMenu(), this.renderClearButton());\n  }\n\n  renderSuggestionHeader(e) {\n    const {\n      allSources: t,\n      activeSourceIndex: s\n    } = this.viewModel,\n          {\n      sourceIndex: i\n    } = e,\n          r = e.results.length,\n          n = t.length > 1 && s === g.ALL_INDEX;\n    return r && n ? I(\"div\", {\n      key: `esri-search__suggestion-header-${i}`,\n      class: w.menuHeader\n    }, this._getSourceName(i)) : null;\n  }\n\n  renderSuggestion(e, t) {\n    const {\n      _activeMenuItemIndex: s,\n      messages: i\n    } = this,\n          {\n      searchTerm: r\n    } = this.viewModel;\n\n    if (r) {\n      const {\n        text: n\n      } = e,\n            o = n || i.untitledResult,\n            a = b.test(o),\n            u = [];\n      if (a) u.push(I(\"div\", {\n        innerHTML: o\n      }));else {\n        const e = this._splitResult(o, r),\n              t = r.toLowerCase();\n\n        e.forEach((e, s) => {\n          e && e.length && (e.toLowerCase() === t ? u.push(I(\"strong\", {\n            key: s\n          }, e)) : u.push(e));\n        });\n      }\n      const l = \"suggestion\" === this.activeMenu && s === t;\n      return I(\"li\", {\n        bind: this,\n        id: this._buildId(\"suggestion-item\", t),\n        \"aria-selected\": (\"suggestion\" === this.activeMenu && this._activeMenuItemIndex === t).toString(),\n        onclick: this._handleSuggestionClick,\n        key: `esri-search__suggestion_${t}`,\n        \"data-suggestion\": e,\n        role: \"option\",\n        class: this.classes(w.menuItem, l ? w.menuItemFocus : null)\n      }, u);\n    }\n  }\n\n  renderSource(e) {\n    const {\n      activeSourceIndex: t,\n      searchAllEnabled: s\n    } = this.viewModel,\n          i = {\n      [w.menuItemActive]: e === t,\n      [w.menuItemFocus]: \"source\" === this.activeMenu && e === (s ? this._activeMenuItemIndex - 1 : this._activeMenuItemIndex)\n    },\n          r = s ? e + 1 : e;\n    return I(\"li\", {\n      bind: this,\n      key: `esri-search__source-${e}`,\n      id: this._buildId(\"source-item\", r),\n      \"aria-checked\": (e === t).toString(),\n      onclick: this._handleSourceClick,\n      \"data-source-index\": e,\n      role: \"menuitemradio\",\n      class: this.classes(w.source, w.menuItem, i)\n    }, this._getSourceName(e));\n  }\n\n  renderNoResultsWarning(e) {\n    const {\n      messages: t\n    } = this,\n          s = e ? S(t.noResultsFoundForValue, {\n      value: `\"${e}\"`\n    }) : t.noResultsFound;\n    return I(\"div\", {\n      key: \"esri-search__no_results\"\n    }, I(\"div\", {\n      class: w.warningMenuHeader\n    }, t.noResults), I(\"div\", {\n      class: w.warningMenuText\n    }, s));\n  }\n\n  renderEmptySearchWarning() {\n    const {\n      messages: e\n    } = this;\n    return I(\"div\", {\n      key: \"esri-search__empty-search\"\n    }, I(\"span\", {\n      \"aria-hidden\": \"true\",\n      class: w.noticeIcon\n    }), I(\"span\", {\n      class: w.noValueText\n    }, e.emptyValue));\n  }\n\n  renderLocateWarning() {\n    const {\n      messages: e\n    } = this;\n    return I(\"div\", {\n      key: \"esri-search__locate-error\"\n    }, I(\"span\", {\n      \"aria-hidden\": \"true\",\n      class: w.noticeIcon\n    }), I(\"span\", {\n      class: w.noValueText\n    }, e.locateError));\n  }\n\n  renderWarning() {\n    var e;\n    const {\n      displayedSearchTerm: t,\n      _locateFailed: s\n    } = this,\n          {\n      viewModel: i\n    } = this;\n    return s ? this.renderLocateWarning() : null != (e = i.selectedSuggestion) && e.location || t ? this.renderNoResultsWarning(t) : this.renderEmptySearchWarning();\n  }\n\n  _resetActiveMenuItemIndex() {\n    this._activeMenuItemIndex = -1;\n  }\n\n  _buildId(e, t) {\n    return `${this.id}-${e}${void 0 === t ? \"\" : `-${t}`}`;\n  }\n\n  _watchSourceChanges() {\n    const {\n      _handles: e,\n      viewModel: {\n        allSources: t\n      }\n    } = this,\n          s = \"sources\";\n    e.remove(s), t.forEach(t => e.add(n(t, \"name\", () => this.scheduleRender()), s));\n  }\n\n  _handleSourcesMenuToggleClick() {\n    const e = \"source\" === this.activeMenu;\n    var t;\n    (this.activeMenu = e ? \"none\" : \"source\", this.renderNow(), \"source\" === this.activeMenu) && (null == (t = this._sourceListNode) || t.focus());\n  }\n\n  _handleClearButtonClick() {\n    this.viewModel.clear(), this._focus();\n  }\n\n  _handleSearchButtonClick() {\n    this.search();\n  }\n\n  _handleSuggestionClick(e) {\n    const t = e.currentTarget[\"data-suggestion\"];\n    t && (this._focus(), this.search(t));\n  }\n\n  _handleUseCurrentLocationClick() {\n    this._useCurrentLocation();\n  }\n\n  _useCurrentLocation() {\n    this._focus(\"none\"), this._cancelSuggest(), this._cancelSearch();\n    const e = i(),\n          {\n      signal: t\n    } = e;\n    this._searchController = e, this.viewModel.searchNearby({\n      signal: t\n    }).catch(() => {\n      this._locateFailed = !0, this.activeMenu = \"warning\";\n    }).then(() => {\n      this._searchController = null;\n    });\n  }\n\n  _handleSourceClick(e) {\n    this._setSourceFromMenuItem(e.currentTarget);\n  }\n\n  _setSourceFromMenuItem(e) {\n    var t;\n    if (!e) return;\n    const s = e[\"data-source-index\"];\n    this.viewModel.activeSourceIndex = s, this._clearActiveMenu(), null == (t = this._sourceMenuButtonNode) || t.focus();\n  }\n\n  _cancelSuggest() {\n    this._suggestController && (this._suggestController.abort(), this._suggestController = null);\n  }\n\n  _cancelSearch() {\n    this._searchController && (this._searchController.abort(), this._searchController = null), this._locateFailed = !1;\n  }\n\n  _handleInputKeyup(e) {\n    var s;\n    const i = t(e);\n    if (e.ctrlKey || e.metaKey || \"Copy\" === i || \"ArrowLeft\" === i || \"ArrowRight\" === i || \"Shift\" === i) return;\n    if (\"Tab\" === i || \"Escape\" === i || e.shiftKey && \"Tab\" === i) return this._cancelSuggest(), void (\"Escape\" === i && this._clearActiveMenu());\n    const r = \"Home\" === i || \"End\" === i || \"ArrowUp\" === i || \"ArrowDown\" === i;\n    if (\"Enter\" === i && this._activeMenuItemIndex < 0) return void this._cancelSuggest();\n    const n = null == (s = this._suggestionListNode) ? void 0 : s.getElementsByTagName(\"li\");\n\n    if (null != n && n.length) {\n      if (\"suggestion\" !== this.activeMenu && this._openSuggestionMenu(), r) return e.preventDefault(), this._cancelSuggest(), void this.handleItemNavigation(i, n, this._suggestionListNode);\n      const t = n[this._activeMenuItemIndex];\n\n      if (\"Enter\" === i && t) {\n        const e = t[\"data-suggestion\"];\n        return void (e ? (this._focus(), this.search(e)) : t[\"data-current-location-item\"] && this._useCurrentLocation());\n      }\n    }\n\n    this.viewModel.searchTerm && this.suggest();\n  }\n\n  handleItemNavigation(e, t, s) {\n    const i = this._activeMenuItemIndex;\n    \"Home\" === e && (this._activeMenuItemIndex = 0), \"End\" === e && (this._activeMenuItemIndex = t.length - 1), \"ArrowUp\" === e && (this._activeMenuItemIndex = this._activeMenuItemIndex <= 0 ? t.length - 1 : this._activeMenuItemIndex - 1), \"ArrowDown\" === e && (this._activeMenuItemIndex = this._activeMenuItemIndex === t.length - 1 ? 0 : this._activeMenuItemIndex + 1), i !== this._activeMenuItemIndex && _(t[this._activeMenuItemIndex], s);\n  }\n\n  _scrollToTopSuggestion() {\n    this._suggestionListNode && (this._suggestionListNode.scrollTop = 0);\n  }\n\n  _openSuggestionMenu() {\n    this.activeMenu = \"suggestion\";\n  }\n\n  _handleInputPaste(e) {\n    const t = e.target;\n    this.viewModel.searchTerm !== t.value && (this.viewModel.searchTerm = t.value), this.viewModel.searchTerm && this.suggest();\n  }\n\n  _handleSourceMenuKeydown(e) {\n    const s = t(e);\n\n    if (m(s)) {\n      e.preventDefault();\n\n      const t = this._sourceListNode.getElementsByTagName(\"li\")[this._activeMenuItemIndex];\n\n      this._setSourceFromMenuItem(t);\n    } else \"ArrowUp\" !== s && \"ArrowDown\" !== s && \"End\" !== s && \"Home\" !== s || e.preventDefault();\n  }\n\n  _handleSourceMenuKeyup(e) {\n    var s;\n    const i = t(e),\n          r = \"ArrowUp\" === i || \"ArrowDown\" === i || \"End\" === i || \"Home\" === i;\n    var n;\n    if (r && e.preventDefault(), \"Escape\" === i) return this._clearActiveMenu(), void (null == (n = this._sourceMenuButtonNode) || n.focus());\n    const o = null == (s = this._sourceListNode) ? void 0 : s.getElementsByTagName(\"li\");\n    return o && 0 !== o.length && r ? (\"source\" !== this.activeMenu && (this.activeMenu = \"source\"), void this.handleItemNavigation(i, o, this._sourceListNode.parentElement)) : void 0;\n  }\n\n  _focus(e) {\n    this.focus(), e && (this.activeMenu = e);\n  }\n\n  _formSubmit(e) {\n    e.preventDefault(), -1 === this._activeMenuItemIndex && this.search();\n  }\n\n  _getSourceName(e) {\n    const {\n      messages: t\n    } = this,\n          s = this.viewModel,\n          {\n      allSources: i\n    } = s,\n          r = i.getItemAt(e);\n    return e === g.ALL_INDEX ? t.all : r && r.name || t.untitledSource;\n  }\n\n  _splitResult(e, t) {\n    const s = r(t);\n    return e.replace(new RegExp(`(^|)(${s})(|$)`, \"ig\"), \"$1|$2|$3\").split(\"|\");\n  }\n\n  _renderSearchResultsContent() {\n    return this._searchResultRenderer.showMoreResultsOpen = !1, this._searchResultRenderer.viewModel = this.viewModel, this._searchResultRenderer;\n  }\n\n};\ne([l()], y.prototype, \"_activeMenuItemIndex\", void 0), e([l()], y.prototype, \"displayedSearchTerm\", null), e([l({\n  readOnly: !0\n})], y.prototype, \"inputId\", null), e([l({\n  readOnly: !0\n})], y.prototype, \"suggestionsMenuId\", null), e([l({\n  readOnly: !0\n})], y.prototype, \"sourceMenuId\", null), e([l({\n  readOnly: !0\n})], y.prototype, \"sourceMenuButtonId\", null), e([l()], y.prototype, \"activeMenu\", void 0), e([u(\"viewModel.activeSource\")], y.prototype, \"activeSource\", void 0), e([u(\"viewModel.activeSourceIndex\")], y.prototype, \"activeSourceIndex\", void 0), e([u(\"viewModel.allPlaceholder\")], y.prototype, \"allPlaceholder\", void 0), e([u(\"viewModel.allSources\")], y.prototype, \"allSources\", void 0), e([u(\"viewModel.autoNavigate\")], y.prototype, \"autoNavigate\", void 0), e([u(\"viewModel.autoSelect\")], y.prototype, \"autoSelect\", void 0), e([u(\"viewModel.defaultSources\")], y.prototype, \"defaultSources\", void 0), e([l()], y.prototype, \"disabled\", void 0), e([u(\"viewModel.goToOverride\")], y.prototype, \"goToOverride\", void 0), e([l()], y.prototype, \"iconClass\", void 0), e([u(\"viewModel.includeDefaultSources\")], y.prototype, \"includeDefaultSources\", void 0), e([l({\n  aliasOf: {\n    source: \"messages.widgetLabel\",\n    overridable: !0\n  }\n})], y.prototype, \"label\", void 0), e([u(\"viewModel.locationEnabled\")], y.prototype, \"locationEnabled\", void 0), e([u(\"viewModel.maxResults\")], y.prototype, \"maxResults\", void 0), e([u(\"viewModel.maxSuggestions\")], y.prototype, \"maxSuggestions\", void 0), e([l(), v(\"esri/widgets/Search/t9n/Search\")], y.prototype, \"messages\", void 0), e([l(), v(\"esri/t9n/common\")], y.prototype, \"messagesCommon\", void 0), e([u(\"viewModel.minSuggestCharacters\")], y.prototype, \"minSuggestCharacters\", void 0), e([u(\"viewModel.popupEnabled\")], y.prototype, \"popupEnabled\", void 0), e([u(\"viewModel.popupTemplate\")], y.prototype, \"popupTemplate\", void 0), e([u(\"viewModel.portal\")], y.prototype, \"portal\", void 0), e([u(\"viewModel.resultGraphic\")], y.prototype, \"resultGraphic\", void 0), e([u(\"viewModel.resultGraphicEnabled\")], y.prototype, \"resultGraphicEnabled\", void 0), e([u(\"viewModel.results\")], y.prototype, \"results\", void 0), e([u(\"viewModel.searchAllEnabled\")], y.prototype, \"searchAllEnabled\", void 0), e([u(\"viewModel.searchTerm\")], y.prototype, \"searchTerm\", void 0), e([u(\"viewModel.selectedResult\")], y.prototype, \"selectedResult\", void 0), e([u(\"viewModel.sources\")], y.prototype, \"sources\", void 0), e([u(\"viewModel.suggestions\")], y.prototype, \"suggestions\", void 0), e([u(\"viewModel.suggestionsEnabled\")], y.prototype, \"suggestionsEnabled\", void 0), e([u(\"viewModel.view\")], y.prototype, \"view\", void 0), e([M([\"search-complete\", \"search-clear\", \"search-start\", \"select-result\", \"suggest-start\", \"suggest-complete\"]), l({\n  type: g\n})], y.prototype, \"viewModel\", void 0), e([u(\"viewModel.clear\")], y.prototype, \"clear\", null), y = e([c(\"esri.widgets.Search\")], y);\nvar f = y;\nexport default f;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/widgets/Search.js"],"names":["_","e","eventKey","t","s","createAbortController","i","escapeRegExpString","r","watch","n","on","o","init","a","aliasOf","u","property","l","subclass","c","d","h","g","storeNode","p","keepMenuItemWithinView","isActivationKey","m","messageBundle","v","vmEvent","M","tsx","I","substitute","S","w","base","loader","loaderText","loaderAnimation","esriInput","hasMultipleSources","isLoading","isSearching","showSuggestions","showSources","showWarning","container","input","inputContainer","form","submitButton","sourcesButton","clearButton","sourceName","suggestionsMenu","suggestionList","suggestionListCurrentLocation","sourcesMenu","source","warningMenu","warningMenuBody","warningMenuHeader","warningMenuText","noValueText","esriWidgetDisabled","button","fallbackText","header","locate","menu","menuList","menuItem","menuItemActive","menuItemFocus","menuHeader","loadingIcon","searchIcon","dropdownIcon","dropupIcon","clearIcon","noticeIcon","widgetIcon","disabled","b","y","constructor","_activeMenuItemIndex","_handles","_inputNode","_menuItemCount","_sourceMenuButtonNode","_sourceListNode","_suggestionListNode","_searchResultRenderer","_locateFailed","_container","activeMenu","activeSource","activeSourceIndex","allPlaceholder","allSources","autoNavigate","autoSelect","defaultSources","goToOverride","iconClass","includeDefaultSources","label","locationEnabled","maxResults","maxSuggestions","messages","messagesCommon","minSuggestCharacters","popupEnabled","popupTemplate","portal","resultGraphic","resultGraphicEnabled","results","searchAllEnabled","searchTerm","selectedResult","sources","suggestions","suggestionsEnabled","view","viewModel","_clearActiveMenu","_removeActiveMenu","relatedTarget","contains","own","get","_watchSourceChanges","_resetActiveMenuItemIndex","content","_renderSearchResultsContent","bind","destroy","_cancelSuggest","_cancelSearch","displayedSearchTerm","trim","inputId","_buildId","suggestionsMenuId","sourceMenuId","sourceMenuButtonId","clear","focus","emit","blur","search","signal","_searchController","catch","then","numResults","suggest","_suggestController","_openSuggestionMenu","_scrollToTopSuggestion","render","state","class","classes","renderLoader","renderContainer","renderSubmitButton","searchButtonTitle","key","onclick","_handleSearchButtonClick","title","renderWarningMenu","renderWarning","renderSourceMenuButton","length","id","searchIn","toString","_handleSourcesMenuToggleClick","onfocus","afterCreate","_getSourceName","renderSourcesList","role","onkeydown","_handleSourceMenuKeydown","onkeyup","_handleSourceMenuKeyup","tabIndex","renderSource","ALL_INDEX","map","toArray","renderSourcesMenu","loading","addEventListener","afterRemoved","removeEventListener","renderInputContainer","renderClearButton","_handleClearButtonClick","clearButtonTitle","renderLocationGroup","_handleUseCurrentLocationClick","useCurrentLocation","renderInput","maxInputLength","placeholder","suggestionCount","maxlength","autocomplete","type","value","_handleInputKeyup","oninput","_handleInputPaste","onpaste","onblur","renderForm","onsubmit","_formSubmit","renderSuggestList","sourceIndex","renderSuggestion","renderSuggestionsGroup","renderSuggestionHeader","renderSuggestionsMenu","text","untitledResult","test","push","innerHTML","_splitResult","toLowerCase","forEach","_handleSuggestionClick","_handleSourceClick","renderNoResultsWarning","noResultsFoundForValue","noResultsFound","noResults","renderEmptySearchWarning","emptyValue","renderLocateWarning","locateError","selectedSuggestion","location","remove","add","scheduleRender","renderNow","_focus","currentTarget","_useCurrentLocation","searchNearby","_setSourceFromMenuItem","abort","ctrlKey","metaKey","shiftKey","getElementsByTagName","preventDefault","handleItemNavigation","scrollTop","target","parentElement","getItemAt","all","name","untitledSource","replace","RegExp","split","showMoreResultsOpen","prototype","readOnly","overridable","f"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../intl.js\";import{eventKey as t}from\"../core/events.js\";import s from\"../core/Handles.js\";import{createAbortController as i}from\"../core/promiseUtils.js\";import{escapeRegExpString as r}from\"../core/string.js\";import{watch as n,on as o,init as a}from\"../core/watchUtils.js\";import{aliasOf as u}from\"../core/accessorSupport/decorators/aliasOf.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{property as l}from\"../core/accessorSupport/decorators/property.js\";import{subclass as c}from\"../core/accessorSupport/decorators/subclass.js\";import d from\"./Widget.js\";import h from\"./Search/SearchResultRenderer.js\";import g from\"./Search/SearchViewModel.js\";import{storeNode as p,keepMenuItemWithinView as _,isActivationKey as m}from\"./support/widgetUtils.js\";import{messageBundle as v}from\"./support/decorators/messageBundle.js\";import{vmEvent as M}from\"./support/decorators/vmEvent.js\";import{tsx as I}from\"./support/jsxFactory.js\";import{substitute as S}from\"../intl/substitute.js\";const w={base:\"esri-search esri-widget\",loader:\"esri-widget__loader\",loaderText:\"esri-widget__loader-text\",loaderAnimation:\"esri-widget__loader-animation\",esriInput:\"esri-input\",hasMultipleSources:\"esri-search--multiple-sources\",isLoading:\"esri-search--loading\",isSearching:\"esri-search--searching\",showSuggestions:\"esri-search--show-suggestions\",showSources:\"esri-search--sources\",showWarning:\"esri-search--warning\",container:\"esri-search__container\",input:\"esri-search__input\",inputContainer:\"esri-search__input-container\",form:\"esri-search__form\",submitButton:\"esri-search__submit-button\",sourcesButton:\"esri-search__sources-button\",clearButton:\"esri-search__clear-button\",sourceName:\"esri-search__source-name\",suggestionsMenu:\"esri-search__suggestions-menu\",suggestionList:\"esri-search__suggestions-list\",suggestionListCurrentLocation:\"esri-search__suggestions-list--current-location\",sourcesMenu:\"esri-search__sources-menu\",source:\"esri-search__source\",warningMenu:\"esri-search__warning-menu\",warningMenuBody:\"esri-search__warning-body\",warningMenuHeader:\"esri-search__warning-header\",warningMenuText:\"esri-search__warning-text\",noValueText:\"esri-search__no-value-text\",esriWidgetDisabled:\"esri-widget--disabled\",button:\"esri-widget--button\",fallbackText:\"esri-icon-font-fallback-text\",header:\"esri-widget__heading\",locate:\"esri-icon-locate-circled\",menu:\"esri-menu\",menuList:\"esri-menu__list\",menuItem:\"esri-menu__list-item\",menuItemActive:\"esri-menu__list-item--active\",menuItemFocus:\"esri-menu__list-item--focus\",menuHeader:\"esri-menu__header\",loadingIcon:\"esri-icon-loading-indicator esri-rotating\",searchIcon:\"esri-icon-search\",dropdownIcon:\"esri-icon-down-arrow esri-search__sources-button--down\",dropupIcon:\"esri-icon-up-arrow esri-search__sources-button--up\",clearIcon:\"esri-icon-close\",noticeIcon:\"esri-icon-notice-triangle\",widgetIcon:\"esri-icon-search\",disabled:\"esri-disabled\"},b=/<[a-z/][\\s\\S]*>/i;let y=class extends d{constructor(e,t){super(e,t),this._activeMenuItemIndex=-1,this._handles=new s,this._inputNode=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new h,this._locateFailed=null,this._container=null,this.activeMenu=\"none\",this.activeSource=null,this.activeSourceIndex=null,this.allPlaceholder=null,this.allSources=null,this.autoNavigate=null,this.autoSelect=null,this.defaultSources=null,this.disabled=!1,this.goToOverride=null,this.iconClass=w.widgetIcon,this.includeDefaultSources=null,this.label=void 0,this.locationEnabled=null,this.maxResults=null,this.maxSuggestions=null,this.messages=null,this.messagesCommon=null,this.minSuggestCharacters=null,this.popupEnabled=null,this.popupTemplate=null,this.portal=null,this.resultGraphic=null,this.resultGraphicEnabled=null,this.results=null,this.searchAllEnabled=null,this.searchTerm=null,this.selectedResult=null,this.sources=null,this.suggestions=null,this.suggestionsEnabled=null,this.view=null,this.viewModel=new g,this._clearActiveMenu=()=>{this.activeMenu=\"none\"},this._removeActiveMenu=e=>{var t;const s=e.relatedTarget;s&&null!=(t=this._container)&&t.contains(s)||this._clearActiveMenu()},this.own(n(this,\"searchTerm\",(e=>{(e&&\"warning\"===this.activeMenu||!e&&!this.get(\"viewModel.selectedSuggestion.location\"))&&this._clearActiveMenu()})),o(this,\"viewModel.allSources\",\"change\",(()=>this._watchSourceChanges())),a(this,\"activeMenu\",(()=>this._resetActiveMenuItemIndex())),a(this,\"viewModel.defaultPopupTemplate\",(e=>{e&&(e.content=this._renderSearchResultsContent.bind(this))})))}destroy(){this._handles.destroy(),this._handles=null,this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer&&(this._searchResultRenderer.viewModel=null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null)}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId(\"input\")}get suggestionsMenuId(){return this._buildId(\"suggest-menu\")}get sourceMenuId(){return this._buildId(\"source-menu\")}get sourceMenuButtonId(){return this._buildId(\"source-menu-button\")}clear(){}focus(){var e;null==(e=this._inputNode)||e.focus(),this.emit(\"search-focus\")}blur(){var e;null==(e=this._inputNode)||e.blur(),this.emit(\"search-blur\")}search(e){this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();const t=i(),{signal:s}=t;return this._searchController=t,this.viewModel.search(e,{signal:s}).catch((e=>{if(this._searchController===t)return this._clearActiveMenu(),this._searchController=null,e})).then((e=>{if(this._searchController===t)return this.activeMenu=e.numResults?\"none\":\"warning\",this._searchController=null,e}))}suggest(e){this._cancelSuggest();const t=i(),{signal:s}=t;return this._suggestController=t,this.viewModel.suggest(e,null,{signal:s}).then((e=>{if(this._suggestController===t)return this._suggestController=null,e.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),e})).catch((()=>{if(this._suggestController===t)return this._suggestController=null,null}))}render(){const{state:e}=this.viewModel,t={[w.disabled]:\"disabled\"===e,[w.esriWidgetDisabled]:this.disabled};return I(\"div\",{class:this.classes(w.base,t)},\"loading\"===e?this.renderLoader():this.renderContainer())}renderSubmitButton(){const{messages:e}=this;return I(\"button\",{\"aria-label\":e.searchButtonTitle,bind:this,class:this.classes(w.submitButton,w.button),key:\"esri-search__submit-button\",onclick:this._handleSearchButtonClick,title:e.searchButtonTitle},I(\"span\",{\"aria-hidden\":\"true\",class:w.searchIcon}))}renderWarningMenu(){return I(\"div\",{key:\"esri-search__error-menu\",class:this.classes(w.menu,w.warningMenu)},I(\"div\",{class:w.warningMenuBody},this.renderWarning()))}renderSourceMenuButton(){const{messages:e,activeMenu:t,sourceMenuId:s,sourceMenuButtonId:i}=this,{activeSourceIndex:r,allSources:n}=this.viewModel;return n.length>1?I(\"button\",{id:i,key:\"esri-search__source-menu-button\",bind:this,\"aria-label\":e.searchIn,title:e.searchIn,\"aria-haspopup\":\"true\",\"aria-expanded\":(\"source\"===t).toString(),\"aria-controls\":s,class:this.classes(w.sourcesButton,w.button),onclick:this._handleSourcesMenuToggleClick,onfocus:this._clearActiveMenu,afterCreate:p,\"data-node-ref\":\"_sourceMenuButtonNode\"},I(\"span\",{\"aria-hidden\":\"true\",class:w.dropdownIcon}),I(\"span\",{\"aria-hidden\":\"true\",class:w.dropupIcon}),I(\"span\",{class:w.sourceName},this._getSourceName(r))):null}renderSourcesList(){const{allSources:e,searchAllEnabled:t}=this.viewModel,{_activeMenuItemIndex:s,activeMenu:i,sourceMenuId:r,sourceMenuButtonId:n}=this,o=\"source\"===i&&s>-1?this._buildId(\"source-item\",s):null;return e.length>1?I(\"ul\",{\"aria-activedescendant\":o,\"aria-labelledby\":n,id:r,role:\"menu\",bind:this,afterCreate:p,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,\"data-node-ref\":\"_sourceListNode\",class:w.menuList,tabIndex:-1},t?this.renderSource(g.ALL_INDEX):null,e.map(((e,t)=>this.renderSource(t))).toArray()):null}renderSourcesMenu(){const{allSources:e}=this.viewModel;return e.length>1?I(\"div\",{key:\"esri-search__source-menu\",class:this.classes(w.menu,w.sourcesMenu)},this.renderSourcesList()):null}renderLoader(){const{messages:e,messagesCommon:t}=this;return I(\"div\",{class:w.loader,key:\"base-loader\"},I(\"span\",{\"aria-hidden\":\"true\",class:w.loaderAnimation}),I(\"span\",{class:w.fallbackText},e.searchButtonTitle),I(\"span\",{class:w.loaderText},t.loading))}renderContainer(){const{allSources:e,state:t}=this.viewModel,{activeMenu:s}=this,i={[w.hasMultipleSources]:e.length>1,[w.isLoading]:\"loading\"===t,[w.isSearching]:\"searching\"===t,[w.showWarning]:\"warning\"===s,[w.showSources]:\"source\"===s,[w.showSuggestions]:\"suggestion\"===s};return I(\"div\",{tabIndex:-1,afterCreate:e=>{this._container=e,e.addEventListener(\"focusout\",this._removeActiveMenu)},afterRemoved:e=>{e.removeEventListener(\"focusout\",this._removeActiveMenu)},class:this.classes(i,w.container),key:\"base-container\"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),this.renderSubmitButton(),this.renderWarningMenu())}renderClearButton(){return this.searchTerm?I(\"button\",{bind:this,class:this.classes(w.clearButton,w.button),key:\"esri-search__clear-button\",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle},I(\"span\",{\"aria-hidden\":\"true\",class:w.clearIcon})):null}renderLocationGroup(){const{messages:e,locationEnabled:t,displayedSearchTerm:s}=this,i=t&&!s,r=\"suggestion\"===this.activeMenu&&0===this._activeMenuItemIndex;return i?I(\"ul\",{role:\"group\",key:\"esri-search__suggestion-list-current-location\",class:this.classes(w.menuList,w.suggestionList,w.suggestionListCurrentLocation)},I(\"li\",{bind:this,\"data-current-location-item\":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId(\"suggestion-item\",0),\"aria-selected\":(\"suggestion\"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),role:\"option\",class:this.classes(w.menuItem,r?w.menuItemFocus:null)},I(\"span\",{\"aria-hidden\":\"true\",class:w.locate}),\" \",e.useCurrentLocation)):null}renderInput(){const{activeMenu:e,locationEnabled:t,displayedSearchTerm:s,messages:i,suggestionsMenuId:r,inputId:n,_activeMenuItemIndex:o}=this,{maxInputLength:a,placeholder:u,searchTerm:l,suggestionCount:c}=this.viewModel,d=!(!(t&&!s)&&!c),h=\"suggestion\"===e&&o>-1?this._buildId(\"suggestion-item\",o):null;return I(\"input\",{\"aria-activedescendant\":h,\"aria-autocomplete\":\"list\",\"aria-expanded\":(d&&\"suggestion\"===e).toString(),\"aria-controls\":d?r:null,\"aria-haspopup\":\"listbox\",\"aria-label\":i.searchButtonTitle,bind:this,placeholder:u,maxlength:a,autocomplete:\"off\",type:\"text\",class:this.classes(w.esriInput,w.input),value:l,id:n,role:\"combobox\",onkeyup:this._handleInputKeyup,onclick:this._openSuggestionMenu,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:p,\"data-node-ref\":\"_inputNode\",onfocus:this.focus,onblur:this.blur,title:l?\"\":u})}renderForm(){return I(\"form\",{key:\"esri-search__form\",bind:this,class:w.form,onsubmit:this._formSubmit,role:\"search\"},this.renderInput())}renderSuggestList(e){const{sourceIndex:t}=e,s=e.results.length,i=e.results;return s?I(\"ul\",{role:\"group\",key:`esri-search__suggestion-list-${t}`,class:this.classes(w.menuList,w.suggestionList)},i.map((e=>this.renderSuggestion(e,this._menuItemCount++)))):null}renderSuggestionsGroup(){const{suggestions:e}=this.viewModel;return e?e.map((e=>[this.renderSuggestionHeader(e),this.renderSuggestList(e)])):null}renderSuggestionsMenu(){const{displayedSearchTerm:e,locationEnabled:t,suggestionsMenuId:s,inputId:i}=this,{suggestionCount:r}=this.viewModel,n=t&&!e||r;return this._menuItemCount=0,n?I(\"div\",{id:s,key:\"esri-search__suggestions-menu\",class:this.classes(w.menu,w.suggestionsMenu),role:\"listbox\",\"aria-labelledby\":i,bind:this,afterCreate:p,\"data-node-ref\":\"_suggestionListNode\"},this.renderLocationGroup(),this.renderSuggestionsGroup()):null}renderInputContainer(){return I(\"div\",{key:\"esri-search__input-container\",class:w.inputContainer},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())}renderSuggestionHeader(e){const{allSources:t,activeSourceIndex:s}=this.viewModel,{sourceIndex:i}=e,r=e.results.length,n=t.length>1&&s===g.ALL_INDEX;return r&&n?I(\"div\",{key:`esri-search__suggestion-header-${i}`,class:w.menuHeader},this._getSourceName(i)):null}renderSuggestion(e,t){const{_activeMenuItemIndex:s,messages:i}=this,{searchTerm:r}=this.viewModel;if(r){const{text:n}=e,o=n||i.untitledResult,a=b.test(o),u=[];if(a)u.push(I(\"div\",{innerHTML:o}));else{const e=this._splitResult(o,r),t=r.toLowerCase();e.forEach(((e,s)=>{e&&e.length&&(e.toLowerCase()===t?u.push(I(\"strong\",{key:s},e)):u.push(e))}))}const l=\"suggestion\"===this.activeMenu&&s===t;return I(\"li\",{bind:this,id:this._buildId(\"suggestion-item\",t),\"aria-selected\":(\"suggestion\"===this.activeMenu&&this._activeMenuItemIndex===t).toString(),onclick:this._handleSuggestionClick,key:`esri-search__suggestion_${t}`,\"data-suggestion\":e,role:\"option\",class:this.classes(w.menuItem,l?w.menuItemFocus:null)},u)}}renderSource(e){const{activeSourceIndex:t,searchAllEnabled:s}=this.viewModel,i={[w.menuItemActive]:e===t,[w.menuItemFocus]:\"source\"===this.activeMenu&&e===(s?this._activeMenuItemIndex-1:this._activeMenuItemIndex)},r=s?e+1:e;return I(\"li\",{bind:this,key:`esri-search__source-${e}`,id:this._buildId(\"source-item\",r),\"aria-checked\":(e===t).toString(),onclick:this._handleSourceClick,\"data-source-index\":e,role:\"menuitemradio\",class:this.classes(w.source,w.menuItem,i)},this._getSourceName(e))}renderNoResultsWarning(e){const{messages:t}=this,s=e?S(t.noResultsFoundForValue,{value:`\"${e}\"`}):t.noResultsFound;return I(\"div\",{key:\"esri-search__no_results\"},I(\"div\",{class:w.warningMenuHeader},t.noResults),I(\"div\",{class:w.warningMenuText},s))}renderEmptySearchWarning(){const{messages:e}=this;return I(\"div\",{key:\"esri-search__empty-search\"},I(\"span\",{\"aria-hidden\":\"true\",class:w.noticeIcon}),I(\"span\",{class:w.noValueText},e.emptyValue))}renderLocateWarning(){const{messages:e}=this;return I(\"div\",{key:\"esri-search__locate-error\"},I(\"span\",{\"aria-hidden\":\"true\",class:w.noticeIcon}),I(\"span\",{class:w.noValueText},e.locateError))}renderWarning(){var e;const{displayedSearchTerm:t,_locateFailed:s}=this,{viewModel:i}=this;return s?this.renderLocateWarning():null!=(e=i.selectedSuggestion)&&e.location||t?this.renderNoResultsWarning(t):this.renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(e,t){return`${this.id}-${e}${void 0===t?\"\":`-${t}`}`}_watchSourceChanges(){const{_handles:e,viewModel:{allSources:t}}=this,s=\"sources\";e.remove(s),t.forEach((t=>e.add(n(t,\"name\",(()=>this.scheduleRender())),s)))}_handleSourcesMenuToggleClick(){const e=\"source\"===this.activeMenu;var t;(this.activeMenu=e?\"none\":\"source\",this.renderNow(),\"source\"===this.activeMenu)&&(null==(t=this._sourceListNode)||t.focus())}_handleClearButtonClick(){this.viewModel.clear(),this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(e){const t=e.currentTarget[\"data-suggestion\"];t&&(this._focus(),this.search(t))}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus(\"none\"),this._cancelSuggest(),this._cancelSearch();const e=i(),{signal:t}=e;this._searchController=e,this.viewModel.searchNearby({signal:t}).catch((()=>{this._locateFailed=!0,this.activeMenu=\"warning\"})).then((()=>{this._searchController=null}))}_handleSourceClick(e){this._setSourceFromMenuItem(e.currentTarget)}_setSourceFromMenuItem(e){var t;if(!e)return;const s=e[\"data-source-index\"];this.viewModel.activeSourceIndex=s,this._clearActiveMenu(),null==(t=this._sourceMenuButtonNode)||t.focus()}_cancelSuggest(){this._suggestController&&(this._suggestController.abort(),this._suggestController=null)}_cancelSearch(){this._searchController&&(this._searchController.abort(),this._searchController=null),this._locateFailed=!1}_handleInputKeyup(e){var s;const i=t(e);if(e.ctrlKey||e.metaKey||\"Copy\"===i||\"ArrowLeft\"===i||\"ArrowRight\"===i||\"Shift\"===i)return;if(\"Tab\"===i||\"Escape\"===i||e.shiftKey&&\"Tab\"===i)return this._cancelSuggest(),void(\"Escape\"===i&&this._clearActiveMenu());const r=\"Home\"===i||\"End\"===i||\"ArrowUp\"===i||\"ArrowDown\"===i;if(\"Enter\"===i&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const n=null==(s=this._suggestionListNode)?void 0:s.getElementsByTagName(\"li\");if(null!=n&&n.length){if(\"suggestion\"!==this.activeMenu&&this._openSuggestionMenu(),r)return e.preventDefault(),this._cancelSuggest(),void this.handleItemNavigation(i,n,this._suggestionListNode);const t=n[this._activeMenuItemIndex];if(\"Enter\"===i&&t){const e=t[\"data-suggestion\"];return void(e?(this._focus(),this.search(e)):t[\"data-current-location-item\"]&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}handleItemNavigation(e,t,s){const i=this._activeMenuItemIndex;\"Home\"===e&&(this._activeMenuItemIndex=0),\"End\"===e&&(this._activeMenuItemIndex=t.length-1),\"ArrowUp\"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?t.length-1:this._activeMenuItemIndex-1),\"ArrowDown\"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex===t.length-1?0:this._activeMenuItemIndex+1),i!==this._activeMenuItemIndex&&_(t[this._activeMenuItemIndex],s)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu=\"suggestion\"}_handleInputPaste(e){const t=e.target;this.viewModel.searchTerm!==t.value&&(this.viewModel.searchTerm=t.value),this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(e){const s=t(e);if(m(s)){e.preventDefault();const t=this._sourceListNode.getElementsByTagName(\"li\")[this._activeMenuItemIndex];this._setSourceFromMenuItem(t)}else\"ArrowUp\"!==s&&\"ArrowDown\"!==s&&\"End\"!==s&&\"Home\"!==s||e.preventDefault()}_handleSourceMenuKeyup(e){var s;const i=t(e),r=\"ArrowUp\"===i||\"ArrowDown\"===i||\"End\"===i||\"Home\"===i;var n;if(r&&e.preventDefault(),\"Escape\"===i)return this._clearActiveMenu(),void(null==(n=this._sourceMenuButtonNode)||n.focus());const o=null==(s=this._sourceListNode)?void 0:s.getElementsByTagName(\"li\");return o&&0!==o.length&&r?(\"source\"!==this.activeMenu&&(this.activeMenu=\"source\"),void this.handleItemNavigation(i,o,this._sourceListNode.parentElement)):void 0}_focus(e){this.focus(),e&&(this.activeMenu=e)}_formSubmit(e){e.preventDefault(),-1===this._activeMenuItemIndex&&this.search()}_getSourceName(e){const{messages:t}=this,s=this.viewModel,{allSources:i}=s,r=i.getItemAt(e);return e===g.ALL_INDEX?t.all:r&&r.name||t.untitledSource}_splitResult(e,t){const s=r(t);return e.replace(new RegExp(`(^|)(${s})(|$)`,\"ig\"),\"$1|$2|$3\").split(\"|\")}_renderSearchResultsContent(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}};e([l()],y.prototype,\"_activeMenuItemIndex\",void 0),e([l()],y.prototype,\"displayedSearchTerm\",null),e([l({readOnly:!0})],y.prototype,\"inputId\",null),e([l({readOnly:!0})],y.prototype,\"suggestionsMenuId\",null),e([l({readOnly:!0})],y.prototype,\"sourceMenuId\",null),e([l({readOnly:!0})],y.prototype,\"sourceMenuButtonId\",null),e([l()],y.prototype,\"activeMenu\",void 0),e([u(\"viewModel.activeSource\")],y.prototype,\"activeSource\",void 0),e([u(\"viewModel.activeSourceIndex\")],y.prototype,\"activeSourceIndex\",void 0),e([u(\"viewModel.allPlaceholder\")],y.prototype,\"allPlaceholder\",void 0),e([u(\"viewModel.allSources\")],y.prototype,\"allSources\",void 0),e([u(\"viewModel.autoNavigate\")],y.prototype,\"autoNavigate\",void 0),e([u(\"viewModel.autoSelect\")],y.prototype,\"autoSelect\",void 0),e([u(\"viewModel.defaultSources\")],y.prototype,\"defaultSources\",void 0),e([l()],y.prototype,\"disabled\",void 0),e([u(\"viewModel.goToOverride\")],y.prototype,\"goToOverride\",void 0),e([l()],y.prototype,\"iconClass\",void 0),e([u(\"viewModel.includeDefaultSources\")],y.prototype,\"includeDefaultSources\",void 0),e([l({aliasOf:{source:\"messages.widgetLabel\",overridable:!0}})],y.prototype,\"label\",void 0),e([u(\"viewModel.locationEnabled\")],y.prototype,\"locationEnabled\",void 0),e([u(\"viewModel.maxResults\")],y.prototype,\"maxResults\",void 0),e([u(\"viewModel.maxSuggestions\")],y.prototype,\"maxSuggestions\",void 0),e([l(),v(\"esri/widgets/Search/t9n/Search\")],y.prototype,\"messages\",void 0),e([l(),v(\"esri/t9n/common\")],y.prototype,\"messagesCommon\",void 0),e([u(\"viewModel.minSuggestCharacters\")],y.prototype,\"minSuggestCharacters\",void 0),e([u(\"viewModel.popupEnabled\")],y.prototype,\"popupEnabled\",void 0),e([u(\"viewModel.popupTemplate\")],y.prototype,\"popupTemplate\",void 0),e([u(\"viewModel.portal\")],y.prototype,\"portal\",void 0),e([u(\"viewModel.resultGraphic\")],y.prototype,\"resultGraphic\",void 0),e([u(\"viewModel.resultGraphicEnabled\")],y.prototype,\"resultGraphicEnabled\",void 0),e([u(\"viewModel.results\")],y.prototype,\"results\",void 0),e([u(\"viewModel.searchAllEnabled\")],y.prototype,\"searchAllEnabled\",void 0),e([u(\"viewModel.searchTerm\")],y.prototype,\"searchTerm\",void 0),e([u(\"viewModel.selectedResult\")],y.prototype,\"selectedResult\",void 0),e([u(\"viewModel.sources\")],y.prototype,\"sources\",void 0),e([u(\"viewModel.suggestions\")],y.prototype,\"suggestions\",void 0),e([u(\"viewModel.suggestionsEnabled\")],y.prototype,\"suggestionsEnabled\",void 0),e([u(\"viewModel.view\")],y.prototype,\"view\",void 0),e([M([\"search-complete\",\"search-clear\",\"search-start\",\"select-result\",\"suggest-start\",\"suggest-complete\"]),l({type:g})],y.prototype,\"viewModel\",void 0),e([u(\"viewModel.clear\")],y.prototype,\"clear\",null),y=e([c(\"esri.widgets.Search\")],y);var f=y;export default f;\n"]},"metadata":{},"sourceType":"module"}