{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isNone as t } from \"../../../../core/maybe.js\";\nimport { BoundingInfo as e } from \"./BoundingInfo.js\";\nimport { ContentObject as i } from \"./ContentObject.js\";\nimport { generateDefaultIndexArray as n, computeAttachmentOriginTriangles as s, computeAttachmentOriginPoints as r } from \"./geometryDataUtils.js\";\nimport { assert as o } from \"./Util.js\";\n\nclass u extends i {\n  constructor(t, e = [], i = 0, s = -1) {\n    super(), this._primitiveType = i, this.edgeIndicesLength = s, this.type = 2, this._vertexAttributes = new Map(), this._indices = new Map(), this._boundingInfo = null;\n\n    for (const [n, r] of t) r && this._vertexAttributes.set(n, { ...r\n    });\n\n    if (null == e || 0 === e.length) {\n      const t = h(this._vertexAttributes),\n            e = n(t);\n      this.edgeIndicesLength = this.edgeIndicesLength < 0 ? t : this.edgeIndicesLength;\n\n      for (const i of this._vertexAttributes.keys()) this._indices.set(i, e);\n    } else for (const [n, r] of e) r && (this._indices.set(n, g(r)), \"position\" === n && (this.edgeIndicesLength = this.edgeIndicesLength < 0 ? this._indices.get(n).length : this.edgeIndicesLength));\n  }\n\n  get vertexAttributes() {\n    return this._vertexAttributes;\n  }\n\n  getMutableAttribute(t) {\n    const e = this._vertexAttributes.get(t);\n\n    return e && !e.exclusive && (e.data = Array.from(e.data), e.exclusive = !0), e;\n  }\n\n  get indices() {\n    return this._indices;\n  }\n\n  get indexCount() {\n    const t = this._indices.values().next().value;\n\n    return t ? t.length : 0;\n  }\n\n  get primitiveType() {\n    return this._primitiveType;\n  }\n\n  get faceCount() {\n    return this.indexCount / 3;\n  }\n\n  get boundingInfo() {\n    return t(this._boundingInfo) && (this._boundingInfo = this._calculateBoundingInfo()), this._boundingInfo;\n  }\n\n  computeAttachmentOrigin(t) {\n    return 0 === this.primitiveType ? this.computeAttachmentOriginTriangles(t) : this.computeAttachmentOriginPoints(t);\n  }\n\n  computeAttachmentOriginTriangles(t) {\n    const e = this.indices.get(\"position\"),\n          i = this.vertexAttributes.get(\"position\");\n    return s(i, e, t);\n  }\n\n  computeAttachmentOriginPoints(t) {\n    const e = this.indices.get(\"position\"),\n          i = this.vertexAttributes.get(\"position\");\n    return r(i, e, t);\n  }\n\n  invalidateBoundingInfo() {\n    this._boundingInfo = null;\n  }\n\n  _calculateBoundingInfo() {\n    const t = this.indices.get(\"position\");\n    if (0 === t.length) return null;\n    const i = 0 === this.primitiveType ? 3 : 1;\n    o(t.length % i == 0, \"Indexing error: \" + t.length + \" not divisible by \" + i);\n    const s = n(t.length / i),\n          r = this.vertexAttributes.get(\"position\");\n    return new e(s, i, t, r);\n  }\n\n}\n\nfunction h(t) {\n  const e = t.values().next().value;\n  return null == e ? 0 : e.data.length / e.size;\n}\n\nfunction g(t) {\n  if (t.BYTES_PER_ELEMENT === Uint16Array.BYTES_PER_ELEMENT) return t;\n\n  for (const e of t) if (e >= 65536) return t;\n\n  return new Uint16Array(t);\n}\n\nexport { u as Geometry };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/webgl-engine/lib/Geometry.js"],"names":["isNone","t","BoundingInfo","e","ContentObject","i","generateDefaultIndexArray","n","computeAttachmentOriginTriangles","s","computeAttachmentOriginPoints","r","assert","o","u","constructor","_primitiveType","edgeIndicesLength","type","_vertexAttributes","Map","_indices","_boundingInfo","set","length","h","keys","g","get","vertexAttributes","getMutableAttribute","exclusive","data","Array","from","indices","indexCount","values","next","value","primitiveType","faceCount","boundingInfo","_calculateBoundingInfo","computeAttachmentOrigin","invalidateBoundingInfo","size","BYTES_PER_ELEMENT","Uint16Array","Geometry"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isNone as t}from\"../../../../core/maybe.js\";import{BoundingInfo as e}from\"./BoundingInfo.js\";import{ContentObject as i}from\"./ContentObject.js\";import{generateDefaultIndexArray as n,computeAttachmentOriginTriangles as s,computeAttachmentOriginPoints as r}from\"./geometryDataUtils.js\";import{assert as o}from\"./Util.js\";class u extends i{constructor(t,e=[],i=0,s=-1){super(),this._primitiveType=i,this.edgeIndicesLength=s,this.type=2,this._vertexAttributes=new Map,this._indices=new Map,this._boundingInfo=null;for(const[n,r]of t)r&&this._vertexAttributes.set(n,{...r});if(null==e||0===e.length){const t=h(this._vertexAttributes),e=n(t);this.edgeIndicesLength=this.edgeIndicesLength<0?t:this.edgeIndicesLength;for(const i of this._vertexAttributes.keys())this._indices.set(i,e)}else for(const[n,r]of e)r&&(this._indices.set(n,g(r)),\"position\"===n&&(this.edgeIndicesLength=this.edgeIndicesLength<0?this._indices.get(n).length:this.edgeIndicesLength))}get vertexAttributes(){return this._vertexAttributes}getMutableAttribute(t){const e=this._vertexAttributes.get(t);return e&&!e.exclusive&&(e.data=Array.from(e.data),e.exclusive=!0),e}get indices(){return this._indices}get indexCount(){const t=this._indices.values().next().value;return t?t.length:0}get primitiveType(){return this._primitiveType}get faceCount(){return this.indexCount/3}get boundingInfo(){return t(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(t){return 0===this.primitiveType?this.computeAttachmentOriginTriangles(t):this.computeAttachmentOriginPoints(t)}computeAttachmentOriginTriangles(t){const e=this.indices.get(\"position\"),i=this.vertexAttributes.get(\"position\");return s(i,e,t)}computeAttachmentOriginPoints(t){const e=this.indices.get(\"position\"),i=this.vertexAttributes.get(\"position\");return r(i,e,t)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const t=this.indices.get(\"position\");if(0===t.length)return null;const i=0===this.primitiveType?3:1;o(t.length%i==0,\"Indexing error: \"+t.length+\" not divisible by \"+i);const s=n(t.length/i),r=this.vertexAttributes.get(\"position\");return new e(s,i,t,r)}}function h(t){const e=t.values().next().value;return null==e?0:e.data.length/e.size}function g(t){if(t.BYTES_PER_ELEMENT===Uint16Array.BYTES_PER_ELEMENT)return t;for(const e of t)if(e>=65536)return t;return new Uint16Array(t)}export{u as Geometry};\n"]},"metadata":{},"sourceType":"module"}