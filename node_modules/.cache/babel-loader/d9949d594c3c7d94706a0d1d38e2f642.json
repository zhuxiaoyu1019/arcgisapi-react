{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../Color.js\";\nimport { isSymbol3D as t, isSymbol2D as r } from \"../../symbols.js\";\nimport { forEach as o } from \"../../core/asyncUtils.js\";\nimport n from \"../../core/has.js\";\nimport { isSome as i, isNone as l, unwrap as s, get as c } from \"../../core/maybe.js\";\nimport { px2pt as u } from \"../../core/screenUtils.js\";\nimport { O as a } from \"../../chunks/vec3f64.js\";\nimport { getStroke as f } from \"./gfxUtils.js\";\nimport m from \"./Symbol3DMaterial.js\";\nconst y = /\\/resource\\/(.*?)\\.svg$/,\n      p = new e(\"white\");\n\nfunction h(e) {\n  const t = e.symbolLayers && e.symbolLayers.length;\n  if (!t) return;\n  const r = e.symbolLayers.getItemAt(t - 1);\n  return \"outline\" in r ? c(r, \"outline\", \"size\") : void 0;\n}\n\nfunction b(e) {\n  if (!e) return 0;\n\n  if (t(e)) {\n    const t = h(e);\n    return i(t) ? t : 0;\n  }\n\n  const r = f(e);\n  return r && u(r.width) || 0;\n}\n\nfunction w(e) {\n  if (l(e) || !(\"symbolLayers\" in e) || l(e.symbolLayers)) return !1;\n\n  switch (e.type) {\n    case \"point-3d\":\n      return e.symbolLayers.some(e => \"object\" === e.type);\n\n    case \"line-3d\":\n      return e.symbolLayers.some(e => \"path\" === e.type);\n\n    case \"polygon-3d\":\n      return e.symbolLayers.some(e => \"object\" === e.type || \"extrude\" === e.type);\n\n    default:\n      return !1;\n  }\n}\n\nfunction d(e, t) {\n  const r = t.resource.href;\n  return !n(\"esri-canvas-svg-support\") && e.styleOrigin && y.test(r) ? r.replace(y, \"/resource/png/$1.png\") : r;\n}\n\nfunction g(o, n) {\n  if (!o) return null;\n  let i = null;\n  return t(o) ? i = j(o) : r(o) && (i = o.color ? new e(o.color) : null), i ? k(i, n) : null;\n}\n\nfunction j(t) {\n  const r = t.symbolLayers;\n  if (!r) return null;\n  let o = null;\n  return r.forEach(e => {\n    \"object\" === e.type && null != e.resource.href || (o = \"water\" === e.type ? s(e.color) : i(e.material) ? s(e.material.color) : null);\n  }), o ? new e(o) : null;\n}\n\nfunction k(t, r) {\n  if (null == r) return t;\n  const o = t.toRgba();\n  return o[3] = o[3] * r, new e(o);\n}\n\nfunction L(e, t, r) {\n  const o = e.symbolLayers;\n  if (!o) return;\n\n  const n = e => {\n    const o = i(e) ? e : null;\n    return k(t = t || o || null != r && p, r);\n  };\n\n  o.forEach(e => {\n    if (\"object\" !== e.type || null == e.resource.href || t) if (\"water\" === e.type) e.color = n(e.color);else {\n      const t = i(e.material) ? e.material.color : null,\n            o = n(t);\n      l(e.material) ? e.material = new m({\n        color: o\n      }) : e.material.color = o, null != r && \"outline\" in e && i(e.outline) && i(e.outline.color) && (e.outline.color = k(e.outline.color, r));\n    }\n  });\n}\n\nfunction z(e, t, r) {\n  (t = t || e.color) && (e.color = k(t, r)), null != r && \"outline\" in e && e.outline && e.outline.color && (e.outline.color = k(e.outline.color, r));\n}\n\nfunction v(o, n, i) {\n  o && (n || null != i) && (n && (n = new e(n)), t(o) ? L(o, n, i) : r(o) && z(o, n, i));\n}\n\nasync function x(e, t) {\n  const r = e.symbolLayers;\n  r && (await o(r, async e => S(e, t)));\n}\n\nasync function S(e, t) {\n  switch (e.type) {\n    case \"extrude\":\n      O(e, t);\n      break;\n\n    case \"icon\":\n    case \"line\":\n    case \"text\":\n      U(e, t);\n      break;\n\n    case \"path\":\n      $(e, t);\n      break;\n\n    case \"object\":\n      await R(e, t);\n  }\n}\n\nfunction U(e, t) {\n  const r = E(t);\n  i(r) && (e.size = r);\n}\n\nfunction E(e) {\n  for (const t of e) if (\"number\" == typeof t) return t;\n\n  return null;\n}\n\nfunction O(e, t) {\n  e.size = \"number\" == typeof t[2] ? t[2] : 0;\n}\n\nasync function R(e, t) {\n  const {\n    resourceSize: r,\n    symbolSize: o\n  } = await C(e),\n        n = A(t, r, o);\n  e.width = D(t[0], o[0], r[0], n), e.depth = D(t[1], o[1], r[1], n), e.height = D(t[2], o[2], r[2], n);\n}\n\nfunction $(e, t) {\n  const r = A(t, a, [e.width, void 0, e.height]);\n  e.width = D(t[0], e.width, 1, r), e.height = D(t[2], e.height, 1, r);\n}\n\nfunction A(e, t, r) {\n  for (let o = 0; o < 3; o++) {\n    const n = e[o];\n\n    switch (n) {\n      case \"symbol-value\":\n        return null != r[o] ? r[o] / t[o] : 1;\n\n      case \"proportional\":\n        break;\n\n      default:\n        if (n && t[o]) return n / t[o];\n    }\n  }\n\n  return 1;\n}\n\nasync function C(e) {\n  const t = await import(\"./symbolLayerUtils.js\"),\n        r = await t.computeObjectLayerResourceSize(e, 10),\n        {\n    width: o,\n    height: n,\n    depth: i\n  } = e,\n        l = [o, i, n];\n  let s = 1;\n\n  for (let c = 0; c < 3; c++) if (null != l[c]) {\n    s = l[c] / r[c];\n    break;\n  }\n\n  for (let c = 0; c < 3; c++) null == l[c] && (l[c] = r[c] * s);\n\n  return {\n    resourceSize: r,\n    symbolSize: l\n  };\n}\n\nfunction D(e, t, r, o) {\n  switch (e) {\n    case \"proportional\":\n      return r * o;\n\n    case \"symbol-value\":\n      return null != t ? t : r;\n\n    default:\n      return e;\n  }\n}\n\nfunction I(e, t) {\n  const r = E(t);\n  if (!l(r)) switch (e.type) {\n    case \"simple-marker\":\n      e.size = r;\n      break;\n\n    case \"picture-marker\":\n      {\n        const t = e.width / e.height;\n        t > 1 ? (e.width = r, e.height = r * t) : (e.width = r * t, e.height = r);\n        break;\n      }\n\n    case \"simple-line\":\n      e.width = r;\n      break;\n\n    case \"text\":\n      e.font.size = r;\n  }\n}\n\nasync function M(e, o) {\n  if (e && o) return t(e) ? x(e, o) : void (r(e) && I(e, o));\n}\n\nfunction q(e, o, n) {\n  if (e && null != o) if (t(e)) {\n    const t = e.symbolLayers;\n    t && t.forEach(e => {\n      if (e && \"object\" === e.type) switch (n) {\n        case \"tilt\":\n          e.tilt = o;\n          break;\n\n        case \"roll\":\n          e.roll = o;\n          break;\n\n        default:\n          e.heading = o;\n      }\n    });\n  } else r(e) && (\"simple-marker\" !== e.type && \"picture-marker\" !== e.type && \"text\" !== e.type || (e.angle = o));\n}\n\nexport { v as applyColorToSymbol, k as applyOpacityToColor, q as applyRotationToSymbol, M as applySizesToSymbol, g as getColorFromSymbol, d as getIconHref, b as getSymbolOutlineSize, w as isVolumetricSymbol };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/symbols/support/utils.js"],"names":["e","isSymbol3D","t","isSymbol2D","r","forEach","o","n","isSome","i","isNone","l","unwrap","s","get","c","px2pt","u","O","a","getStroke","f","m","y","p","h","symbolLayers","length","getItemAt","b","width","w","type","some","d","resource","href","styleOrigin","test","replace","g","j","color","k","material","toRgba","L","outline","z","v","x","S","U","$","R","E","size","resourceSize","symbolSize","C","A","D","depth","height","computeObjectLayerResourceSize","I","font","M","q","tilt","roll","heading","angle","applyColorToSymbol","applyOpacityToColor","applyRotationToSymbol","applySizesToSymbol","getColorFromSymbol","getIconHref","getSymbolOutlineSize","isVolumetricSymbol"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../Color.js\";import{isSymbol3D as t,isSymbol2D as r}from\"../../symbols.js\";import{forEach as o}from\"../../core/asyncUtils.js\";import n from\"../../core/has.js\";import{isSome as i,isNone as l,unwrap as s,get as c}from\"../../core/maybe.js\";import{px2pt as u}from\"../../core/screenUtils.js\";import{O as a}from\"../../chunks/vec3f64.js\";import{getStroke as f}from\"./gfxUtils.js\";import m from\"./Symbol3DMaterial.js\";const y=/\\/resource\\/(.*?)\\.svg$/,p=new e(\"white\");function h(e){const t=e.symbolLayers&&e.symbolLayers.length;if(!t)return;const r=e.symbolLayers.getItemAt(t-1);return\"outline\"in r?c(r,\"outline\",\"size\"):void 0}function b(e){if(!e)return 0;if(t(e)){const t=h(e);return i(t)?t:0}const r=f(e);return r&&u(r.width)||0}function w(e){if(l(e)||!(\"symbolLayers\"in e)||l(e.symbolLayers))return!1;switch(e.type){case\"point-3d\":return e.symbolLayers.some((e=>\"object\"===e.type));case\"line-3d\":return e.symbolLayers.some((e=>\"path\"===e.type));case\"polygon-3d\":return e.symbolLayers.some((e=>\"object\"===e.type||\"extrude\"===e.type));default:return!1}}function d(e,t){const r=t.resource.href;return!n(\"esri-canvas-svg-support\")&&e.styleOrigin&&y.test(r)?r.replace(y,\"/resource/png/$1.png\"):r}function g(o,n){if(!o)return null;let i=null;return t(o)?i=j(o):r(o)&&(i=o.color?new e(o.color):null),i?k(i,n):null}function j(t){const r=t.symbolLayers;if(!r)return null;let o=null;return r.forEach((e=>{\"object\"===e.type&&null!=e.resource.href||(o=\"water\"===e.type?s(e.color):i(e.material)?s(e.material.color):null)})),o?new e(o):null}function k(t,r){if(null==r)return t;const o=t.toRgba();return o[3]=o[3]*r,new e(o)}function L(e,t,r){const o=e.symbolLayers;if(!o)return;const n=e=>{const o=i(e)?e:null;return k(t=t||o||null!=r&&p,r)};o.forEach((e=>{if(\"object\"!==e.type||null==e.resource.href||t)if(\"water\"===e.type)e.color=n(e.color);else{const t=i(e.material)?e.material.color:null,o=n(t);l(e.material)?e.material=new m({color:o}):e.material.color=o,null!=r&&\"outline\"in e&&i(e.outline)&&i(e.outline.color)&&(e.outline.color=k(e.outline.color,r))}}))}function z(e,t,r){(t=t||e.color)&&(e.color=k(t,r)),null!=r&&\"outline\"in e&&e.outline&&e.outline.color&&(e.outline.color=k(e.outline.color,r))}function v(o,n,i){o&&(n||null!=i)&&(n&&(n=new e(n)),t(o)?L(o,n,i):r(o)&&z(o,n,i))}async function x(e,t){const r=e.symbolLayers;r&&await o(r,(async e=>S(e,t)))}async function S(e,t){switch(e.type){case\"extrude\":O(e,t);break;case\"icon\":case\"line\":case\"text\":U(e,t);break;case\"path\":$(e,t);break;case\"object\":await R(e,t)}}function U(e,t){const r=E(t);i(r)&&(e.size=r)}function E(e){for(const t of e)if(\"number\"==typeof t)return t;return null}function O(e,t){e.size=\"number\"==typeof t[2]?t[2]:0}async function R(e,t){const{resourceSize:r,symbolSize:o}=await C(e),n=A(t,r,o);e.width=D(t[0],o[0],r[0],n),e.depth=D(t[1],o[1],r[1],n),e.height=D(t[2],o[2],r[2],n)}function $(e,t){const r=A(t,a,[e.width,void 0,e.height]);e.width=D(t[0],e.width,1,r),e.height=D(t[2],e.height,1,r)}function A(e,t,r){for(let o=0;o<3;o++){const n=e[o];switch(n){case\"symbol-value\":return null!=r[o]?r[o]/t[o]:1;case\"proportional\":break;default:if(n&&t[o])return n/t[o]}}return 1}async function C(e){const t=await import(\"./symbolLayerUtils.js\"),r=await t.computeObjectLayerResourceSize(e,10),{width:o,height:n,depth:i}=e,l=[o,i,n];let s=1;for(let c=0;c<3;c++)if(null!=l[c]){s=l[c]/r[c];break}for(let c=0;c<3;c++)null==l[c]&&(l[c]=r[c]*s);return{resourceSize:r,symbolSize:l}}function D(e,t,r,o){switch(e){case\"proportional\":return r*o;case\"symbol-value\":return null!=t?t:r;default:return e}}function I(e,t){const r=E(t);if(!l(r))switch(e.type){case\"simple-marker\":e.size=r;break;case\"picture-marker\":{const t=e.width/e.height;t>1?(e.width=r,e.height=r*t):(e.width=r*t,e.height=r);break}case\"simple-line\":e.width=r;break;case\"text\":e.font.size=r}}async function M(e,o){if(e&&o)return t(e)?x(e,o):void(r(e)&&I(e,o))}function q(e,o,n){if(e&&null!=o)if(t(e)){const t=e.symbolLayers;t&&t.forEach((e=>{if(e&&\"object\"===e.type)switch(n){case\"tilt\":e.tilt=o;break;case\"roll\":e.roll=o;break;default:e.heading=o}}))}else r(e)&&(\"simple-marker\"!==e.type&&\"picture-marker\"!==e.type&&\"text\"!==e.type||(e.angle=o))}export{v as applyColorToSymbol,k as applyOpacityToColor,q as applyRotationToSymbol,M as applySizesToSymbol,g as getColorFromSymbol,d as getIconHref,b as getSymbolOutlineSize,w as isVolumetricSymbol};\n"]},"metadata":{},"sourceType":"module"}