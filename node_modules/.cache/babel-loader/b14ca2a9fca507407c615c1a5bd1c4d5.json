{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../ArrayPool.js\";\nimport { equals as t } from \"../lang.js\";\nimport { ReentrantObjectPool as o } from \"../ReentrantObjectPool.js\";\nimport { schedule as r } from \"../scheduling.js\";\nimport { someSet as l } from \"../SetUtils.js\";\nimport { valueOf as n } from \"./get.js\";\nimport { reactionAsync as s, reaction as i } from \"./trackingUtils.js\";\nimport { pathToStringOrArray as u, parse as a, once as c } from \"./utils.js\";\n\nclass d {\n  constructor() {\n    this.uid = 0, this.target = null, this.path = null, this.oldValue = null, this.callback = null, this.getValue = null, this.removed = !1, this.propertyPath = null;\n  }\n\n  acquire(e, t, o, r, l) {\n    this.target = e, this.path = t, this.oldValue = o, this.callback = r, this.getValue = l, this.propertyPath = u(t), this.uid = ++d.uid, this.removed = !1;\n  }\n\n  release() {\n    this.target = this.path = this.propertyPath = this.callback = this.oldValue = null, this.uid = ++d.uid, this.removed = !0;\n  }\n\n}\n\nd.pool = new o(d), d.uid = 0;\nconst h = new e(),\n      f = new Set();\nlet m;\n\nfunction p(e) {\n  f.delete(e), f.add(e), m || (m = r(V));\n}\n\nfunction g(e) {\n  if (e.removed) return;\n  const {\n    callback: t,\n    path: o,\n    oldValue: r,\n    target: l\n  } = e,\n        n = e.getValue();\n  v(r, n) && (e.oldValue = n, t.call(l, n, r, o, l));\n}\n\nfunction v(e, o) {\n  return !t(e, o);\n}\n\nfunction _(e) {\n  const t = Array.from(f);\n\n  for (let o = 0; o < t.length; o++) {\n    const r = t[o];\n    r.target === e && (g(r), f.delete(r));\n  }\n}\n\nfunction j(e) {\n  for (const t of f.values()) t.target === e && (t.removed = !0);\n}\n\nfunction V() {\n  let e = 10;\n\n  for (; m && e--;) {\n    m = null;\n    const e = y(),\n          t = h.acquire();\n\n    for (const o of e) {\n      const e = o.uid;\n      g(o), e === o.uid && o.removed && t.push(o);\n    }\n\n    for (const o of f) o.removed && (t.push(o), f.delete(o));\n\n    for (let o = 0; o < t.length; o++) d.pool.release(t[o]);\n\n    h.release(t), h.release(e), b.forEach(e => e());\n  }\n}\n\nfunction y() {\n  const e = h.acquire();\n  e.length = f.size;\n  let t = 0;\n\n  for (const o of f) e[t] = o, ++t;\n\n  return f.clear(), e;\n}\n\nconst b = new Set();\n\nfunction k(e) {\n  return b.add(e), {\n    remove() {\n      b.delete(e);\n    }\n\n  };\n}\n\nfunction P(e, t, o) {\n  let r = a(e, t, o, (e, t, o) => {\n    let l,\n        i,\n        u = s(() => n(e, t), (n, s) => {\n      e.__accessor__.destroyed || l && l.uid !== i ? r.remove() : (l || (l = d.pool.acquire(e, t, n, o, s), i = l.uid), p(l));\n    });\n    return {\n      remove: c(function () {\n        u.remove(), l && (l.uid !== i || l.removed || (l.removed = !0, p(l)), l = null), r = u = null;\n      })\n    };\n  });\n  return r;\n}\n\nfunction q(e, t, o) {\n  const r = a(e, t, o, (e, t, o) => {\n    let l = !1;\n    return i(() => n(e, t), (n, s) => {\n      e.__accessor__.destroyed ? r.remove() : l || (l = !0, v(s, n) && o.call(e, n, s, t, e), l = !1);\n    });\n  });\n  return r;\n}\n\nfunction w(e, t, o, r = !1) {\n  return !e.__accessor__ || e.__accessor__.destroyed ? {\n    remove() {}\n\n  } : r ? q(e, t, o) : P(e, t, o);\n}\n\nfunction S(e) {\n  return l(f, t => t.oldValue === e);\n}\n\nexport default w;\nexport { k as afterDispatch, V as dispatch, _ as dispatchTarget, S as isValueInUse, j as removeTarget, w as watch };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/core/accessorSupport/watch.js"],"names":["e","equals","t","ReentrantObjectPool","o","schedule","r","someSet","l","valueOf","n","reactionAsync","s","reaction","i","pathToStringOrArray","u","parse","a","once","c","d","constructor","uid","target","path","oldValue","callback","getValue","removed","propertyPath","acquire","release","pool","h","f","Set","m","p","delete","add","V","g","v","call","_","Array","from","length","j","values","y","push","b","forEach","size","clear","k","remove","P","__accessor__","destroyed","q","w","S","afterDispatch","dispatch","dispatchTarget","isValueInUse","removeTarget","watch"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAa,iBAAb;AAA+B,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,YAAvB;AAAoC,SAAOC,mBAAmB,IAAIC,CAA9B,QAAoC,2BAApC;AAAgE,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,kBAAzB;AAA4C,SAAOC,OAAO,IAAIC,CAAlB,QAAwB,gBAAxB;AAAyC,SAAOC,OAAO,IAAIC,CAAlB,QAAwB,UAAxB;AAAmC,SAAOC,aAAa,IAAIC,CAAxB,EAA0BC,QAAQ,IAAIC,CAAtC,QAA4C,oBAA5C;AAAiE,SAAOC,mBAAmB,IAAIC,CAA9B,EAAgCC,KAAK,IAAIC,CAAzC,EAA2CC,IAAI,IAAIC,CAAnD,QAAyD,YAAzD;;AAAsE,MAAMC,CAAN,CAAO;AAACC,EAAAA,WAAW,GAAE;AAAC,SAAKC,GAAL,GAAS,CAAT,EAAW,KAAKC,MAAL,GAAY,IAAvB,EAA4B,KAAKC,IAAL,GAAU,IAAtC,EAA2C,KAAKC,QAAL,GAAc,IAAzD,EAA8D,KAAKC,QAAL,GAAc,IAA5E,EAAiF,KAAKC,QAAL,GAAc,IAA/F,EAAoG,KAAKC,OAAL,GAAa,CAAC,CAAlH,EAAoH,KAAKC,YAAL,GAAkB,IAAtI;AAA2I;;AAAAC,EAAAA,OAAO,CAAC/B,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAOE,CAAP,EAASE,CAAT,EAAW;AAAC,SAAKgB,MAAL,GAAYxB,CAAZ,EAAc,KAAKyB,IAAL,GAAUvB,CAAxB,EAA0B,KAAKwB,QAAL,GAActB,CAAxC,EAA0C,KAAKuB,QAAL,GAAcrB,CAAxD,EAA0D,KAAKsB,QAAL,GAAcpB,CAAxE,EAA0E,KAAKsB,YAAL,GAAkBd,CAAC,CAACd,CAAD,CAA7F,EAAiG,KAAKqB,GAAL,GAAS,EAAEF,CAAC,CAACE,GAA9G,EAAkH,KAAKM,OAAL,GAAa,CAAC,CAAhI;AAAkI;;AAAAG,EAAAA,OAAO,GAAE;AAAC,SAAKR,MAAL,GAAY,KAAKC,IAAL,GAAU,KAAKK,YAAL,GAAkB,KAAKH,QAAL,GAAc,KAAKD,QAAL,GAAc,IAApE,EAAyE,KAAKH,GAAL,GAAS,EAAEF,CAAC,CAACE,GAAtF,EAA0F,KAAKM,OAAL,GAAa,CAAC,CAAxG;AAA0G;;AAAna;;AAAoaR,CAAC,CAACY,IAAF,GAAO,IAAI7B,CAAJ,CAAMiB,CAAN,CAAP,EAAgBA,CAAC,CAACE,GAAF,GAAM,CAAtB;AAAwB,MAAMW,CAAC,GAAC,IAAIlC,CAAJ,EAAR;AAAA,MAAcmC,CAAC,GAAC,IAAIC,GAAJ,EAAhB;AAAwB,IAAIC,CAAJ;;AAAM,SAASC,CAAT,CAAWtC,CAAX,EAAa;AAACmC,EAAAA,CAAC,CAACI,MAAF,CAASvC,CAAT,GAAYmC,CAAC,CAACK,GAAF,CAAMxC,CAAN,CAAZ,EAAqBqC,CAAC,KAAGA,CAAC,GAAC/B,CAAC,CAACmC,CAAD,CAAN,CAAtB;AAAiC;;AAAA,SAASC,CAAT,CAAW1C,CAAX,EAAa;AAAC,MAAGA,CAAC,CAAC6B,OAAL,EAAa;AAAO,QAAK;AAACF,IAAAA,QAAQ,EAACzB,CAAV;AAAYuB,IAAAA,IAAI,EAACrB,CAAjB;AAAmBsB,IAAAA,QAAQ,EAACpB,CAA5B;AAA8BkB,IAAAA,MAAM,EAAChB;AAArC,MAAwCR,CAA7C;AAAA,QAA+CU,CAAC,GAACV,CAAC,CAAC4B,QAAF,EAAjD;AAA8De,EAAAA,CAAC,CAACrC,CAAD,EAAGI,CAAH,CAAD,KAASV,CAAC,CAAC0B,QAAF,GAAWhB,CAAX,EAAaR,CAAC,CAAC0C,IAAF,CAAOpC,CAAP,EAASE,CAAT,EAAWJ,CAAX,EAAaF,CAAb,EAAeI,CAAf,CAAtB;AAAyC;;AAAA,SAASmC,CAAT,CAAW3C,CAAX,EAAaI,CAAb,EAAe;AAAC,SAAM,CAACF,CAAC,CAACF,CAAD,EAAGI,CAAH,CAAR;AAAc;;AAAA,SAASyC,CAAT,CAAW7C,CAAX,EAAa;AAAC,QAAME,CAAC,GAAC4C,KAAK,CAACC,IAAN,CAAWZ,CAAX,CAAR;;AAAsB,OAAI,IAAI/B,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACF,CAAC,CAAC8C,MAAhB,EAAuB5C,CAAC,EAAxB,EAA2B;AAAC,UAAME,CAAC,GAACJ,CAAC,CAACE,CAAD,CAAT;AAAaE,IAAAA,CAAC,CAACkB,MAAF,KAAWxB,CAAX,KAAe0C,CAAC,CAACpC,CAAD,CAAD,EAAK6B,CAAC,CAACI,MAAF,CAASjC,CAAT,CAApB;AAAiC;AAAC;;AAAA,SAAS2C,CAAT,CAAWjD,CAAX,EAAa;AAAC,OAAI,MAAME,CAAV,IAAeiC,CAAC,CAACe,MAAF,EAAf,EAA0BhD,CAAC,CAACsB,MAAF,KAAWxB,CAAX,KAAeE,CAAC,CAAC2B,OAAF,GAAU,CAAC,CAA1B;AAA6B;;AAAA,SAASY,CAAT,GAAY;AAAC,MAAIzC,CAAC,GAAC,EAAN;;AAAS,SAAKqC,CAAC,IAAErC,CAAC,EAAT,GAAa;AAACqC,IAAAA,CAAC,GAAC,IAAF;AAAO,UAAMrC,CAAC,GAACmD,CAAC,EAAT;AAAA,UAAYjD,CAAC,GAACgC,CAAC,CAACH,OAAF,EAAd;;AAA0B,SAAI,MAAM3B,CAAV,IAAeJ,CAAf,EAAiB;AAAC,YAAMA,CAAC,GAACI,CAAC,CAACmB,GAAV;AAAcmB,MAAAA,CAAC,CAACtC,CAAD,CAAD,EAAKJ,CAAC,KAAGI,CAAC,CAACmB,GAAN,IAAWnB,CAAC,CAACyB,OAAb,IAAsB3B,CAAC,CAACkD,IAAF,CAAOhD,CAAP,CAA3B;AAAqC;;AAAA,SAAI,MAAMA,CAAV,IAAe+B,CAAf,EAAiB/B,CAAC,CAACyB,OAAF,KAAY3B,CAAC,CAACkD,IAAF,CAAOhD,CAAP,GAAU+B,CAAC,CAACI,MAAF,CAASnC,CAAT,CAAtB;;AAAmC,SAAI,IAAIA,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACF,CAAC,CAAC8C,MAAhB,EAAuB5C,CAAC,EAAxB,EAA2BiB,CAAC,CAACY,IAAF,CAAOD,OAAP,CAAe9B,CAAC,CAACE,CAAD,CAAhB;;AAAqB8B,IAAAA,CAAC,CAACF,OAAF,CAAU9B,CAAV,GAAagC,CAAC,CAACF,OAAF,CAAUhC,CAAV,CAAb,EAA0BqD,CAAC,CAACC,OAAF,CAAWtD,CAAC,IAAEA,CAAC,EAAf,CAA1B;AAA8C;AAAC;;AAAA,SAASmD,CAAT,GAAY;AAAC,QAAMnD,CAAC,GAACkC,CAAC,CAACH,OAAF,EAAR;AAAoB/B,EAAAA,CAAC,CAACgD,MAAF,GAASb,CAAC,CAACoB,IAAX;AAAgB,MAAIrD,CAAC,GAAC,CAAN;;AAAQ,OAAI,MAAME,CAAV,IAAe+B,CAAf,EAAiBnC,CAAC,CAACE,CAAD,CAAD,GAAKE,CAAL,EAAO,EAAEF,CAAT;;AAAW,SAAOiC,CAAC,CAACqB,KAAF,IAAUxD,CAAjB;AAAmB;;AAAA,MAAMqD,CAAC,GAAC,IAAIjB,GAAJ,EAAR;;AAAgB,SAASqB,CAAT,CAAWzD,CAAX,EAAa;AAAC,SAAOqD,CAAC,CAACb,GAAF,CAAMxC,CAAN,GAAS;AAAC0D,IAAAA,MAAM,GAAE;AAACL,MAAAA,CAAC,CAACd,MAAF,CAASvC,CAAT;AAAY;;AAAtB,GAAhB;AAAwC;;AAAA,SAAS2D,CAAT,CAAW3D,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiB;AAAC,MAAIE,CAAC,GAACY,CAAC,CAAClB,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAQ,CAACJ,CAAD,EAAGE,CAAH,EAAKE,CAAL,KAAS;AAAC,QAAII,CAAJ;AAAA,QAAMM,CAAN;AAAA,QAAQE,CAAC,GAACJ,CAAC,CAAE,MAAIF,CAAC,CAACV,CAAD,EAAGE,CAAH,CAAP,EAAe,CAACQ,CAAD,EAAGE,CAAH,KAAO;AAACZ,MAAAA,CAAC,CAAC4D,YAAF,CAAeC,SAAf,IAA0BrD,CAAC,IAAEA,CAAC,CAACe,GAAF,KAAQT,CAArC,GAAuCR,CAAC,CAACoD,MAAF,EAAvC,IAAmDlD,CAAC,KAAGA,CAAC,GAACa,CAAC,CAACY,IAAF,CAAOF,OAAP,CAAe/B,CAAf,EAAiBE,CAAjB,EAAmBQ,CAAnB,EAAqBN,CAArB,EAAuBQ,CAAvB,CAAF,EAA4BE,CAAC,GAACN,CAAC,CAACe,GAAnC,CAAD,EAAyCe,CAAC,CAAC9B,CAAD,CAA7F;AAAkG,KAAzH,CAAX;AAAuI,WAAM;AAACkD,MAAAA,MAAM,EAACtC,CAAC,CAAE,YAAU;AAACJ,QAAAA,CAAC,CAAC0C,MAAF,IAAWlD,CAAC,KAAGA,CAAC,CAACe,GAAF,KAAQT,CAAR,IAAWN,CAAC,CAACqB,OAAb,KAAuBrB,CAAC,CAACqB,OAAF,GAAU,CAAC,CAAX,EAAaS,CAAC,CAAC9B,CAAD,CAArC,GAA0CA,CAAC,GAAC,IAA/C,CAAZ,EAAiEF,CAAC,GAACU,CAAC,GAAC,IAArE;AAA0E,OAAvF;AAAT,KAAN;AAA0G,GAAnQ,CAAP;AAA6Q,SAAOV,CAAP;AAAS;;AAAA,SAASwD,CAAT,CAAW9D,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiB;AAAC,QAAME,CAAC,GAACY,CAAC,CAAClB,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAQ,CAACJ,CAAD,EAAGE,CAAH,EAAKE,CAAL,KAAS;AAAC,QAAII,CAAC,GAAC,CAAC,CAAP;AAAS,WAAOM,CAAC,CAAE,MAAIJ,CAAC,CAACV,CAAD,EAAGE,CAAH,CAAP,EAAe,CAACQ,CAAD,EAAGE,CAAH,KAAO;AAACZ,MAAAA,CAAC,CAAC4D,YAAF,CAAeC,SAAf,GAAyBvD,CAAC,CAACoD,MAAF,EAAzB,GAAoClD,CAAC,KAAGA,CAAC,GAAC,CAAC,CAAH,EAAKmC,CAAC,CAAC/B,CAAD,EAAGF,CAAH,CAAD,IAAQN,CAAC,CAACwC,IAAF,CAAO5C,CAAP,EAASU,CAAT,EAAWE,CAAX,EAAaV,CAAb,EAAeF,CAAf,CAAb,EAA+BQ,CAAC,GAAC,CAAC,CAArC,CAArC;AAA6E,KAApG,CAAR;AAA+G,GAA1I,CAAT;AAAsJ,SAAOF,CAAP;AAAS;;AAAA,SAASyD,CAAT,CAAW/D,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiBE,CAAC,GAAC,CAAC,CAApB,EAAsB;AAAC,SAAM,CAACN,CAAC,CAAC4D,YAAH,IAAiB5D,CAAC,CAAC4D,YAAF,CAAeC,SAAhC,GAA0C;AAACH,IAAAA,MAAM,GAAE,CAAE;;AAAX,GAA1C,GAAuDpD,CAAC,GAACwD,CAAC,CAAC9D,CAAD,EAAGE,CAAH,EAAKE,CAAL,CAAF,GAAUuD,CAAC,CAAC3D,CAAD,EAAGE,CAAH,EAAKE,CAAL,CAAzE;AAAiF;;AAAA,SAAS4D,CAAT,CAAWhE,CAAX,EAAa;AAAC,SAAOQ,CAAC,CAAC2B,CAAD,EAAIjC,CAAC,IAAEA,CAAC,CAACwB,QAAF,KAAa1B,CAApB,CAAR;AAAgC;;AAAA,eAAe+D,CAAf;AAAiB,SAAON,CAAC,IAAIQ,aAAZ,EAA0BxB,CAAC,IAAIyB,QAA/B,EAAwCrB,CAAC,IAAIsB,cAA7C,EAA4DH,CAAC,IAAII,YAAjE,EAA8EnB,CAAC,IAAIoB,YAAnF,EAAgGN,CAAC,IAAIO,KAArG","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../ArrayPool.js\";import{equals as t}from\"../lang.js\";import{ReentrantObjectPool as o}from\"../ReentrantObjectPool.js\";import{schedule as r}from\"../scheduling.js\";import{someSet as l}from\"../SetUtils.js\";import{valueOf as n}from\"./get.js\";import{reactionAsync as s,reaction as i}from\"./trackingUtils.js\";import{pathToStringOrArray as u,parse as a,once as c}from\"./utils.js\";class d{constructor(){this.uid=0,this.target=null,this.path=null,this.oldValue=null,this.callback=null,this.getValue=null,this.removed=!1,this.propertyPath=null}acquire(e,t,o,r,l){this.target=e,this.path=t,this.oldValue=o,this.callback=r,this.getValue=l,this.propertyPath=u(t),this.uid=++d.uid,this.removed=!1}release(){this.target=this.path=this.propertyPath=this.callback=this.oldValue=null,this.uid=++d.uid,this.removed=!0}}d.pool=new o(d),d.uid=0;const h=new e,f=new Set;let m;function p(e){f.delete(e),f.add(e),m||(m=r(V))}function g(e){if(e.removed)return;const{callback:t,path:o,oldValue:r,target:l}=e,n=e.getValue();v(r,n)&&(e.oldValue=n,t.call(l,n,r,o,l))}function v(e,o){return!t(e,o)}function _(e){const t=Array.from(f);for(let o=0;o<t.length;o++){const r=t[o];r.target===e&&(g(r),f.delete(r))}}function j(e){for(const t of f.values())t.target===e&&(t.removed=!0)}function V(){let e=10;for(;m&&e--;){m=null;const e=y(),t=h.acquire();for(const o of e){const e=o.uid;g(o),e===o.uid&&o.removed&&t.push(o)}for(const o of f)o.removed&&(t.push(o),f.delete(o));for(let o=0;o<t.length;o++)d.pool.release(t[o]);h.release(t),h.release(e),b.forEach((e=>e()))}}function y(){const e=h.acquire();e.length=f.size;let t=0;for(const o of f)e[t]=o,++t;return f.clear(),e}const b=new Set;function k(e){return b.add(e),{remove(){b.delete(e)}}}function P(e,t,o){let r=a(e,t,o,((e,t,o)=>{let l,i,u=s((()=>n(e,t)),((n,s)=>{e.__accessor__.destroyed||l&&l.uid!==i?r.remove():(l||(l=d.pool.acquire(e,t,n,o,s),i=l.uid),p(l))}));return{remove:c((function(){u.remove(),l&&(l.uid!==i||l.removed||(l.removed=!0,p(l)),l=null),r=u=null}))}}));return r}function q(e,t,o){const r=a(e,t,o,((e,t,o)=>{let l=!1;return i((()=>n(e,t)),((n,s)=>{e.__accessor__.destroyed?r.remove():l||(l=!0,v(s,n)&&o.call(e,n,s,t,e),l=!1)}))}));return r}function w(e,t,o,r=!1){return!e.__accessor__||e.__accessor__.destroyed?{remove(){}}:r?q(e,t,o):P(e,t,o)}function S(e){return l(f,(t=>t.oldValue===e))}export default w;export{k as afterDispatch,V as dispatch,_ as dispatchTarget,S as isValueInUse,j as removeTarget,w as watch};\n"]},"metadata":{},"sourceType":"module"}