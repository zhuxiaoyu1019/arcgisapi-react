{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { id as t } from \"../../kernel.js\";\nimport e from \"../../request.js\";\nimport { toHSV as i, toRGB as n } from \"../../core/colorUtils.js\";\nimport r from \"../../core/Error.js\";\nimport o from \"../../core/has.js\";\nimport \"../../libs/maquette/projection.js\";\nimport { createProjector as a } from \"../../libs/maquette/projector.js\";\nimport { renderSVG as c } from \"./svgUtils.js\";\nconst s = a();\n\nfunction h(t, e, i) {\n  const n = Math.ceil(e[0]),\n        r = Math.ceil(e[1]);\n  if (!t.some(t => !!t.length)) return null;\n  const o = i && i.node || document.createElement(\"div\");\n  return null != i.opacity && (o.style.opacity = i.opacity.toString()), s.append(o, c.bind(null, t, n, r, i)), o;\n}\n\nfunction l(t, e) {\n  t = Math.ceil(t), e = Math.ceil(e);\n  const i = document.createElement(\"canvas\");\n  i.width = t, i.height = e, i.style.width = t + \"px\", i.style.height = e + \"px\";\n  const n = i.getContext(\"2d\");\n  return n.clearRect(0, 0, t, e), n;\n}\n\nfunction m(t, i, n) {\n  return t ? e(t, {\n    responseType: \"image\"\n  }).then(t => {\n    const e = t.data,\n          r = e.width,\n          o = e.height,\n          a = r / o;\n    let c = i;\n\n    if (n) {\n      const t = Math.max(r, o);\n      c = Math.min(c, t);\n    }\n\n    return {\n      image: e,\n      width: a <= 1 ? Math.ceil(c * a) : c,\n      height: a <= 1 ? c : Math.ceil(c / a)\n    };\n  }) : Promise.reject(new r(\"renderUtils: imageDataSize\", \"href not provided.\"));\n}\n\nfunction g(t, e) {\n  return !(!t || \"ignore\" === e) && (\"multiply\" !== e || 255 !== t.r || 255 !== t.g || 255 !== t.b || 1 !== t.a);\n}\n\nfunction u(t, e, r, o, a) {\n  switch (a) {\n    case \"multiply\":\n      t[e + 0] *= r[0], t[e + 1] *= r[1], t[e + 2] *= r[2], t[e + 3] *= r[3];\n      break;\n\n    default:\n      {\n        const a = i({\n          r: t[e + 0],\n          g: t[e + 1],\n          b: t[e + 2]\n        });\n        a.h = o.h, a.s = o.s, a.v = a.v / 100 * o.v;\n        const c = n(a);\n        t[e + 0] = c.r, t[e + 1] = c.g, t[e + 2] = c.b, t[e + 3] *= r[3];\n        break;\n      }\n  }\n}\n\nfunction d(e, n, r, a, c) {\n  return m(e, n, c).then(c => {\n    const s = c.width ? c.width : n,\n          h = c.height ? c.height : n;\n\n    if (c.image && g(r, a)) {\n      let t = c.image.width,\n          n = c.image.height;\n      o(\"edge\") && /\\.svg$/i.test(e) && (t -= 1, n -= 1);\n      const m = l(s, h);\n      m.drawImage(c.image, 0, 0, t, n, 0, 0, s, h);\n      const g = m.getImageData(0, 0, s, h),\n            d = [r.r / 255, r.g / 255, r.b / 255, r.a],\n            p = i(r);\n\n      for (let e = 0; e < g.data.length; e += 4) u(g.data, e, d, p, a);\n\n      m.putImageData(g, 0, 0), e = m.canvas.toDataURL(\"image/png\");\n    } else {\n      const i = t && t.findCredential(e);\n\n      if (i && i.token) {\n        const t = -1 === e.indexOf(\"?\") ? \"?\" : \"&\";\n        e = `${e}${t}token=${i.token}`;\n      }\n    }\n\n    return {\n      url: e,\n      width: s,\n      height: h\n    };\n  }).catch(function () {\n    return {\n      url: e,\n      width: n,\n      height: n\n    };\n  });\n}\n\nexport { h as renderSymbol, d as tintImageWithColor };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/symbols/support/renderUtils.js"],"names":["id","t","e","toHSV","i","toRGB","n","r","o","createProjector","a","renderSVG","c","s","h","Math","ceil","some","length","node","document","createElement","opacity","style","toString","append","bind","l","width","height","getContext","clearRect","m","responseType","then","data","max","min","image","Promise","reject","g","b","u","v","d","test","drawImage","getImageData","p","putImageData","canvas","toDataURL","findCredential","token","indexOf","url","catch","renderSymbol","tintImageWithColor"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{id as t}from\"../../kernel.js\";import e from\"../../request.js\";import{toHSV as i,toRGB as n}from\"../../core/colorUtils.js\";import r from\"../../core/Error.js\";import o from\"../../core/has.js\";import\"../../libs/maquette/projection.js\";import{createProjector as a}from\"../../libs/maquette/projector.js\";import{renderSVG as c}from\"./svgUtils.js\";const s=a();function h(t,e,i){const n=Math.ceil(e[0]),r=Math.ceil(e[1]);if(!t.some((t=>!!t.length)))return null;const o=i&&i.node||document.createElement(\"div\");return null!=i.opacity&&(o.style.opacity=i.opacity.toString()),s.append(o,c.bind(null,t,n,r,i)),o}function l(t,e){t=Math.ceil(t),e=Math.ceil(e);const i=document.createElement(\"canvas\");i.width=t,i.height=e,i.style.width=t+\"px\",i.style.height=e+\"px\";const n=i.getContext(\"2d\");return n.clearRect(0,0,t,e),n}function m(t,i,n){return t?e(t,{responseType:\"image\"}).then((t=>{const e=t.data,r=e.width,o=e.height,a=r/o;let c=i;if(n){const t=Math.max(r,o);c=Math.min(c,t)}return{image:e,width:a<=1?Math.ceil(c*a):c,height:a<=1?c:Math.ceil(c/a)}})):Promise.reject(new r(\"renderUtils: imageDataSize\",\"href not provided.\"))}function g(t,e){return!(!t||\"ignore\"===e)&&(\"multiply\"!==e||255!==t.r||255!==t.g||255!==t.b||1!==t.a)}function u(t,e,r,o,a){switch(a){case\"multiply\":t[e+0]*=r[0],t[e+1]*=r[1],t[e+2]*=r[2],t[e+3]*=r[3];break;default:{const a=i({r:t[e+0],g:t[e+1],b:t[e+2]});a.h=o.h,a.s=o.s,a.v=a.v/100*o.v;const c=n(a);t[e+0]=c.r,t[e+1]=c.g,t[e+2]=c.b,t[e+3]*=r[3];break}}}function d(e,n,r,a,c){return m(e,n,c).then((c=>{const s=c.width?c.width:n,h=c.height?c.height:n;if(c.image&&g(r,a)){let t=c.image.width,n=c.image.height;o(\"edge\")&&/\\.svg$/i.test(e)&&(t-=1,n-=1);const m=l(s,h);m.drawImage(c.image,0,0,t,n,0,0,s,h);const g=m.getImageData(0,0,s,h),d=[r.r/255,r.g/255,r.b/255,r.a],p=i(r);for(let e=0;e<g.data.length;e+=4)u(g.data,e,d,p,a);m.putImageData(g,0,0),e=m.canvas.toDataURL(\"image/png\")}else{const i=t&&t.findCredential(e);if(i&&i.token){const t=-1===e.indexOf(\"?\")?\"?\":\"&\";e=`${e}${t}token=${i.token}`}}return{url:e,width:s,height:h}})).catch((function(){return{url:e,width:n,height:n}}))}export{h as renderSymbol,d as tintImageWithColor};\n"]},"metadata":{},"sourceType":"module"}