{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Accessor.js\";\nimport r from \"../../../core/Evented.js\";\nimport { isSome as o } from \"../../../core/maybe.js\";\nimport { property as a } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/Logger.js\";\nimport { subclass as i } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { afterDispatch as s } from \"../../../core/accessorSupport/watch.js\";\nimport { f as n } from \"../../../chunks/vec3f64.js\";\nimport { getReferenceEllipsoid as l } from \"../../../geometry/projectionEllipsoid.js\";\nimport p from \"../../ViewAnimation.js\";\nimport c from \"./Constraints.js\";\nimport { AnimationController as m } from \"./controllers/AnimationController.js\";\nimport { State as h } from \"./controllers/CameraController.js\";\nimport { PropertiesPool as d } from \"../support/PropertiesPool.js\";\nimport u from \"../webgl-engine/lib/Camera.js\";\nlet g = class extends t {\n  constructor() {\n    super(...arguments), this._propertiesPool = new d({\n      camera: u\n    }, this), this._lastSeenCameraProjectionValues = new u(), this.events = new r(), this.viewingMode = 1, this._cameraChanged = !1, this.updateQueue = new Array(), this.processingUpdates = !1;\n  }\n\n  init(e, t) {\n    this._set(\"viewingMode\", e), this._set(\"spatialReference\", t), this._set(\"constraints\", new c({\n      mode: this.viewingMode\n    }));\n  }\n\n  exit() {\n    this.cameraController = null, this._propertiesPool.destroy(), this._propertiesPool = new d({\n      camera: u\n    }, this);\n  }\n\n  createInitialCamera() {\n    if (1 === this.viewingMode) {\n      const e = l(this.spatialReference).radius;\n      this.camera = new u(n(4 * e, 0, 0), n(e, 0, 0), n(0, 0, 1));\n    } else this.camera = new u(n(0, 0, 100), n(0, 0, 0), n(0, 1, 0));\n  }\n\n  get animation() {\n    return this.cameraController instanceof m && o(this.cameraController.viewAnimation) ? this.cameraController.viewAnimation : null;\n  }\n\n  get camera() {\n    return this._get(\"camera\");\n  }\n\n  set camera(e) {\n    e !== y && y.copyFrom(e), y.computeUp(this.viewingMode), f.camera = y, this.events.emit(\"before-camera-change\", f);\n\n    const t = this._get(\"camera\");\n\n    if (this.cameraProjectionChanged(this._lastSeenCameraProjectionValues, y) && (this._lastSeenCameraProjectionValues.copyFrom(y), w.camera = this._lastSeenCameraProjectionValues, this.events.emit(\"camera-projection-changed\", w)), (!t || !t.equals(y)) && (this._set(\"camera\", this._propertiesPool.get(\"camera\").copyFrom(y)), this._cameraChanged = !t || !t.almostEquals(y), this._cameraChanged)) {\n      const e = s(() => {\n        this._cameraChanged = !1, e.remove();\n      });\n    }\n  }\n\n  get contentCamera() {\n    return o(this._contentCamera) ? this._contentCamera : this.camera;\n  }\n\n  set contentCamera(e) {\n    this._contentCamera = o(e) ? e.clone() : null;\n  }\n\n  get fixedContentCamera() {\n    return !!o(this._contentCamera);\n  }\n\n  get isGlobal() {\n    return 1 === this.viewingMode;\n  }\n\n  get isLocal() {\n    return 2 === this.viewingMode;\n  }\n\n  get navigating() {\n    return !(!this.cameraController || !this.cameraController.isInteractive);\n  }\n\n  get stationary() {\n    return !this._cameraChanged && !this.navigating;\n  }\n\n  get cameraController() {\n    return this._get(\"cameraController\");\n  }\n\n  set cameraController(e) {\n    this.stopActiveCameraController() ? (e && (e.watch(\"state\", t => {\n      t !== h.Finished && t !== h.Stopped || (this._set(\"cameraController\", null), this.updateCamera(t => e.onControllerEnd(t)));\n    }, !0), e.onControllerStart(this.camera)), this._set(\"cameraController\", e)) : e && (e.state = h.Rejected);\n  }\n\n  switchCameraController(e) {\n    return this.cameraController = e, e.state !== h.Rejected;\n  }\n\n  stopActiveCameraController() {\n    return !(this.cameraController && !this.cameraController.stopController());\n  }\n\n  updateCamera(e) {\n    this.updateQueue.push(e), this.processUpdateQueue();\n  }\n\n  processUpdateQueue() {\n    if (0 === this.updateQueue.length || this.processingUpdates) return;\n    this.processingUpdates = !0;\n    const e = this.updateQueue.shift();\n    y.copyFrom(this._get(\"camera\")), e(y), this.camera = y, this.processingUpdates = !1, this.processUpdateQueue();\n  }\n\n  cameraProjectionChanged(e, t) {\n    return e.fov !== t.fov || e.fullViewport[0] !== t.fullViewport[0] || e.fullViewport[1] !== t.fullViewport[1] || e.fullViewport[2] !== t.fullViewport[2] || e.fullViewport[3] !== t.fullViewport[3] || e.padding[0] !== t.padding[0] || e.padding[1] !== t.padding[1] || e.padding[2] !== t.padding[2] || e.padding[3] !== t.padding[3];\n  }\n\n};\ne([a({\n  readOnly: !0,\n  type: p\n})], g.prototype, \"animation\", null), e([a({\n  type: u\n})], g.prototype, \"camera\", null), e([a({})], g.prototype, \"_contentCamera\", void 0), e([a({\n  type: u\n})], g.prototype, \"contentCamera\", null), e([a({\n  readOnly: !0\n})], g.prototype, \"fixedContentCamera\", null), e([a({\n  readOnly: !0\n})], g.prototype, \"constraints\", void 0), e([a({\n  readOnly: !0\n})], g.prototype, \"events\", void 0), e([a({\n  readOnly: !0\n})], g.prototype, \"isGlobal\", null), e([a({\n  readOnly: !0\n})], g.prototype, \"isLocal\", null), e([a({\n  readOnly: !0\n})], g.prototype, \"viewingMode\", void 0), e([a({\n  readOnly: !0\n})], g.prototype, \"spatialReference\", void 0), e([a({\n  readOnly: !0\n})], g.prototype, \"navigating\", null), e([a({\n  readOnly: !0\n})], g.prototype, \"stationary\", null), e([a()], g.prototype, \"_cameraChanged\", void 0), e([a()], g.prototype, \"cameraController\", null), g = e([i(\"esri.views.3d.state.ViewState\")], g);\nvar C = g;\nconst y = new u(),\n      f = {\n  camera: null\n},\n      w = {\n  camera: null\n};\nexport default C;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/state/ViewState.js"],"names":["_","e","t","r","isSome","o","property","a","subclass","i","afterDispatch","s","f","n","getReferenceEllipsoid","l","p","c","AnimationController","m","State","h","PropertiesPool","d","u","g","constructor","arguments","_propertiesPool","camera","_lastSeenCameraProjectionValues","events","viewingMode","_cameraChanged","updateQueue","Array","processingUpdates","init","_set","mode","exit","cameraController","destroy","createInitialCamera","spatialReference","radius","animation","viewAnimation","_get","y","copyFrom","computeUp","emit","cameraProjectionChanged","w","equals","get","almostEquals","remove","contentCamera","_contentCamera","clone","fixedContentCamera","isGlobal","isLocal","navigating","isInteractive","stationary","stopActiveCameraController","watch","Finished","Stopped","updateCamera","onControllerEnd","onControllerStart","state","Rejected","switchCameraController","stopController","push","processUpdateQueue","length","shift","fov","fullViewport","padding","readOnly","type","prototype","C"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Accessor.js\";import r from\"../../../core/Evented.js\";import{isSome as o}from\"../../../core/maybe.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import{afterDispatch as s}from\"../../../core/accessorSupport/watch.js\";import{f as n}from\"../../../chunks/vec3f64.js\";import{getReferenceEllipsoid as l}from\"../../../geometry/projectionEllipsoid.js\";import p from\"../../ViewAnimation.js\";import c from\"./Constraints.js\";import{AnimationController as m}from\"./controllers/AnimationController.js\";import{State as h}from\"./controllers/CameraController.js\";import{PropertiesPool as d}from\"../support/PropertiesPool.js\";import u from\"../webgl-engine/lib/Camera.js\";let g=class extends t{constructor(){super(...arguments),this._propertiesPool=new d({camera:u},this),this._lastSeenCameraProjectionValues=new u,this.events=new r,this.viewingMode=1,this._cameraChanged=!1,this.updateQueue=new Array,this.processingUpdates=!1}init(e,t){this._set(\"viewingMode\",e),this._set(\"spatialReference\",t),this._set(\"constraints\",new c({mode:this.viewingMode}))}exit(){this.cameraController=null,this._propertiesPool.destroy(),this._propertiesPool=new d({camera:u},this)}createInitialCamera(){if(1===this.viewingMode){const e=l(this.spatialReference).radius;this.camera=new u(n(4*e,0,0),n(e,0,0),n(0,0,1))}else this.camera=new u(n(0,0,100),n(0,0,0),n(0,1,0))}get animation(){return this.cameraController instanceof m&&o(this.cameraController.viewAnimation)?this.cameraController.viewAnimation:null}get camera(){return this._get(\"camera\")}set camera(e){e!==y&&y.copyFrom(e),y.computeUp(this.viewingMode),f.camera=y,this.events.emit(\"before-camera-change\",f);const t=this._get(\"camera\");if(this.cameraProjectionChanged(this._lastSeenCameraProjectionValues,y)&&(this._lastSeenCameraProjectionValues.copyFrom(y),w.camera=this._lastSeenCameraProjectionValues,this.events.emit(\"camera-projection-changed\",w)),(!t||!t.equals(y))&&(this._set(\"camera\",this._propertiesPool.get(\"camera\").copyFrom(y)),this._cameraChanged=!t||!t.almostEquals(y),this._cameraChanged)){const e=s((()=>{this._cameraChanged=!1,e.remove()}))}}get contentCamera(){return o(this._contentCamera)?this._contentCamera:this.camera}set contentCamera(e){this._contentCamera=o(e)?e.clone():null}get fixedContentCamera(){return!!o(this._contentCamera)}get isGlobal(){return 1===this.viewingMode}get isLocal(){return 2===this.viewingMode}get navigating(){return!(!this.cameraController||!this.cameraController.isInteractive)}get stationary(){return!this._cameraChanged&&!this.navigating}get cameraController(){return this._get(\"cameraController\")}set cameraController(e){this.stopActiveCameraController()?(e&&(e.watch(\"state\",(t=>{t!==h.Finished&&t!==h.Stopped||(this._set(\"cameraController\",null),this.updateCamera((t=>e.onControllerEnd(t))))}),!0),e.onControllerStart(this.camera)),this._set(\"cameraController\",e)):e&&(e.state=h.Rejected)}switchCameraController(e){return this.cameraController=e,e.state!==h.Rejected}stopActiveCameraController(){return!(this.cameraController&&!this.cameraController.stopController())}updateCamera(e){this.updateQueue.push(e),this.processUpdateQueue()}processUpdateQueue(){if(0===this.updateQueue.length||this.processingUpdates)return;this.processingUpdates=!0;const e=this.updateQueue.shift();y.copyFrom(this._get(\"camera\")),e(y),this.camera=y,this.processingUpdates=!1,this.processUpdateQueue()}cameraProjectionChanged(e,t){return e.fov!==t.fov||(e.fullViewport[0]!==t.fullViewport[0]||e.fullViewport[1]!==t.fullViewport[1]||e.fullViewport[2]!==t.fullViewport[2]||e.fullViewport[3]!==t.fullViewport[3]||(e.padding[0]!==t.padding[0]||e.padding[1]!==t.padding[1]||e.padding[2]!==t.padding[2]||e.padding[3]!==t.padding[3]))}};e([a({readOnly:!0,type:p})],g.prototype,\"animation\",null),e([a({type:u})],g.prototype,\"camera\",null),e([a({})],g.prototype,\"_contentCamera\",void 0),e([a({type:u})],g.prototype,\"contentCamera\",null),e([a({readOnly:!0})],g.prototype,\"fixedContentCamera\",null),e([a({readOnly:!0})],g.prototype,\"constraints\",void 0),e([a({readOnly:!0})],g.prototype,\"events\",void 0),e([a({readOnly:!0})],g.prototype,\"isGlobal\",null),e([a({readOnly:!0})],g.prototype,\"isLocal\",null),e([a({readOnly:!0})],g.prototype,\"viewingMode\",void 0),e([a({readOnly:!0})],g.prototype,\"spatialReference\",void 0),e([a({readOnly:!0})],g.prototype,\"navigating\",null),e([a({readOnly:!0})],g.prototype,\"stationary\",null),e([a()],g.prototype,\"_cameraChanged\",void 0),e([a()],g.prototype,\"cameraController\",null),g=e([i(\"esri.views.3d.state.ViewState\")],g);var C=g;const y=new u,f={camera:null},w={camera:null};export default C;\n"]},"metadata":{},"sourceType":"module"}