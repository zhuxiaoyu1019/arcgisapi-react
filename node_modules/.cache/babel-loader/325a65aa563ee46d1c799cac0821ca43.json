{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport \"../../../../geometry.js\";\nimport \"../../../../renderers/ClassBreaksRenderer.js\";\nimport \"../../../../renderers/DictionaryRenderer.js\";\nimport \"../../../../renderers/DotDensityRenderer.js\";\nimport \"../../../../renderers/HeatmapRenderer.js\";\nimport \"../../../../renderers/Renderer.js\";\nimport \"../../../../renderers/SimpleRenderer.js\";\nimport t from \"../../../../renderers/UniqueValueRenderer.js\";\nimport \"../../../../renderers/support/jsonUtils.js\";\nimport \"../../../../symbols.js\";\nimport i from \"../../../../core/Accessor.js\";\nimport \"../../../../core/has.js\";\nimport r from \"../../../../core/Error.js\";\nimport s from \"../../../../core/Handles.js\";\nimport a from \"../../../../core/Logger.js\";\nimport { someMap as n, findInMap as o } from \"../../../../core/MapUtils.js\";\nimport { isFinite as l } from \"../../../../core/mathUtils.js\";\nimport { isSome as h, unwrapOr as d, isNone as p, destroyMaybe as c, removeMaybe as y, get as m, unwrap as g } from \"../../../../core/maybe.js\";\nimport u from \"../../../../core/PooledArray.js\";\nimport { createAbortController as b, throwIfAborted as f, eachAlways as v, createDeferred as C, isAbortError as S } from \"../../../../core/promiseUtils.js\";\nimport { schedule as w } from \"../../../../core/scheduling.js\";\nimport { when as G, whenFalse as x, init as P, whenOnce as _, on as R } from \"../../../../core/watchUtils.js\";\nimport { property as D } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as I } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { diff as E, isEmpty as U } from \"../../../../core/accessorSupport/diffUtils.js\";\nimport { s as O, b as j, a as L } from \"../../../../chunks/vec3.js\";\nimport { c as V } from \"../../../../chunks/vec3f64.js\";\nimport { projectVectorToVector as A, projectXYZToVector as F, canProjectWithoutEngine as k, projectBuffer as T } from \"../../../../geometry/projection.js\";\nimport { create as M, center as W, fromRect as z, equals as B } from \"../../../../geometry/support/aaBoundingBox.js\";\nimport { create as q } from \"../../../../geometry/support/aaBoundingRect.js\";\nimport N from \"../../../../layers/Layer.js\";\nimport { getObjectId as H, computeAABB as $, hasGeometry as Z } from \"../../../../layers/graphics/dehydratedFeatures.js\";\nimport { hydrateGraphic as Q } from \"../../../../layers/graphics/hydratedFeatures.js\";\nimport { isSupportedRenderer3D as J, validateTo3D as K } from \"../../../../renderers/support/rendererConversion.js\";\nimport { loadArcade as X } from \"../../../../support/arcadeOnDemand.js\";\nimport { getDefaultSymbol3D as Y } from \"../../../../symbols/support/defaults3D.js\";\nimport { to3D as ee } from \"../../../../symbols/support/symbolConversion.js\";\nimport { ViewElevationProvider as te } from \"./ElevationQuery.js\";\nimport { extractExpressionInfo as ie, createContext as re } from \"./featureExpressionInfoUtils.js\";\nimport se from \"./Graphics3DFeatureStore.js\";\nimport ae from \"./Graphics3DGraphic.js\";\nimport ne from \"./Graphics3DGraphicCreationContext.js\";\nimport { Graphics3DSymbolCreationContext as oe } from \"./Graphics3DSymbolCreationContext.js\";\nimport { make as le } from \"./Graphics3DSymbolFactory.js\";\nimport he from \"./Graphics3DWebStyleSymbol.js\";\nimport { GraphicStateTracking as de } from \"./GraphicStateTracking.js\";\nimport { computeCentroid as pe } from \"./graphicUtils.js\";\nimport { SpatialIndex2D as ce } from \"./SpatialIndex2D.js\";\nimport { averageSymbolComplexities as ye, defaultSymbolComplexity as me } from \"./symbolComplexity.js\";\nimport { StageLayerElevationProvider as ge } from \"../support/StageLayerElevationProvider.js\";\nimport { toBoundingRect as ue } from \"../../support/extentUtils.js\";\nimport { PropertiesPool as be } from \"../../support/PropertiesPool.js\";\nimport { GridLocalOriginFactory as fe } from \"../../webgl-engine/lib/GridLocalOriginFactory.js\";\nimport { WebGLLayer as ve } from \"../../webgl-engine/lib/WebGLLayer.js\";\nimport { ImmediateTask as Ce, noBudget as Se, TaskPriority as we } from \"../../../support/Scheduler.js\";\nimport Ge from \"../../../../geometry/Extent.js\";\nimport xe from \"../../../../geometry/Point.js\";\nimport Pe from \"../../../../symbols/LabelSymbol3D.js\";\nimport _e from \"../../../../symbols/TextSymbol.js\";\nimport Re from \"../../../../symbols/WebStyleSymbol.js\";\nvar De;\nconst Ie = V(),\n      Ee = M(),\n      Ue = a.getLogger(\"esri.views.3d.layers.graphics.Graphics3DCore\");\nlet Oe = De = class extends i {\n  constructor(e) {\n    super(e), this.propertiesPool = new be({\n      computedExtent: Ge\n    }, this), this.computedExtent = null, this.currentRenderer = null, this.rendererHasGeometryOperations = !1, this.graphicStateTracking = null, this.symbolCreationContext = new oe((e, t) => this._frameTask.schedule(e, t)), this.graphics3DGraphics = new Map(), this.stageLayer = null, this.stage = null, this.graphicsDrapedUids = new Set(), this.graphicsBySymbol = new Map(), this.symbolConversionCache = new Map(), this.symbols = new Map(), this.graphicsWithoutSymbol = new Map(), this.graphicsWaitingForSymbol = new Set(), this._handles = new s(), this._frameTask = Ce, this.suspendSymbolCleanup = !1, this._spatialReference = null, this.arcadeOnDemand = null, this.rendererChangeAbortController = null, this.elevationInfoChangeAbortController = null, this.setupAbortController = null, this.elevationAlignment = null, this.scaleVisibility = null, this.filterVisibility = null, this._spatialIndex = null, this.extentPadding = 0, this._updatingPendingLoadedGraphicsChange = null, this.featureStore = null, this.deconflictor = null, this.labeler = null, this.objectStates = null, this.viewElevationProvider = null, this.stageLayerElevationProvider = null, this.sharedSymbolResourcesOwnerHandle = null, this.whenGraphics3DGraphicRequests = {}, this.pendingUpdates = new Map(), this.numberOfGraphics = 0, this.numberOfGraphicsProvidingElevation = 0, this.pendingAdds = 0, this.pendingRemoves = 0, this.pendingUpdatesPool = new u({\n      allocator: e => e || new je(),\n      deallocator: e => (e.clear(), e)\n    }), this.symbolWarningLogged = !1, this.geometryWarningLogged = !1, this.objectIdInvisibleSet = new Set(), this._whenSymbolRemoved = new u(), this.preferredUpdatePolicy = 1, this.forcedUpdatePolicy = null, this.elevationFeatureExpressionEnabled = !0, this.owner = null, this.layer = null, this.graphicSymbolSupported = !0, this.getRenderingInfoWithoutRenderer = !1, this.hasZ = null, this.hasM = null, this._usedMemory = 0, this._visible = void 0, this._startCreateGraphics = !1;\n  }\n\n  get spatialIndex() {\n    return this._spatialIndex || (this._spatialIndex = new ce({\n      objectIdField: this.owner.layer && this.owner.layer.objectIdField,\n      spatialReference: this._spatialReference,\n      hasZ: this.hasZ,\n      hasM: this.hasM\n    }), this._spatialIndex.setup(Array.from(this.graphics3DGraphics.values()))), this._spatialIndex.update(), this._spatialIndex;\n  }\n\n  get effectiveUpdatePolicy() {\n    return h(this.currentRenderer) && \"dictionary\" === this.currentRenderer.type ? 0 : d(this.forcedUpdatePolicy, this.preferredUpdatePolicy);\n  }\n\n  get updating() {\n    var e, t;\n    return !!(this.graphicsWaitingForSymbol.size > 0 || this.running || null != (e = this.elevationAlignment) && e.updating || h(this.scaleVisibility) && this.scaleVisibility.updating || null != (t = this.filterVisibility) && t.updating || this.rendererChangeAbortController || this.elevationInfoChangeAbortController || this._updatingPendingLoadedGraphicsChange || this._frameTask.updating);\n  }\n\n  get running() {\n    var e;\n    return this.pendingUpdates.size > 0 || !(null == (e = this._spatialIndex) || !e.updating);\n  }\n\n  get suspendedOrOutsideOfView() {\n    var e;\n    return this.owner.suspended || (null == (e = this.owner.suspendInfo) ? void 0 : e.outsideOfView);\n  }\n\n  get updatingRemaining() {\n    var e, t;\n    return this.updating ? this.pendingUpdates.size + .1 * ((null == (e = this._spatialIndex) ? void 0 : e.updatingRemaining) || 0) + .1 * ((null == (t = this.elevationAlignment) ? void 0 : t.updatingRemaining) || 0) : 0;\n  }\n\n  get displayFeatureLimit() {\n    const e = this.owner && this.owner.view && this.owner.view.qualitySettings,\n          t = e ? e.graphics3D.minTotalNumberOfFeatures : 0,\n          i = e ? e.graphics3D.maxTotalNumberOfFeatures : 0,\n          r = e ? e.graphics3D.maxTotalNumberOfPrimitives : 0,\n          s = this.averageSymbolComplexity,\n          a = Math.max(1, h(s) ? s.primitivesPerFeature : 1),\n          n = h(s) && s.drawCallsPerFeature > 0 ? i / s.drawCallsPerFeature * .3 : i,\n          o = Math.ceil(r / a),\n          l = Math.max(t, Math.min(i, o, n)),\n          d = this._get(\"displayFeatureLimit\");\n\n    return d && d.minimumTotalNumberOfFeatures === t && d.maximumTotalNumberOfFeatures === i && d.maximumTotalNumberOfPrimitives === r && d.averageSymbolComplexity === s && d.maximumNumberOfFeatures === l ? d : {\n      minimumTotalNumberOfFeatures: t,\n      maximumTotalNumberOfFeatures: i,\n      maximumTotalNumberOfPrimitives: r,\n      averageSymbolComplexity: s,\n      maximumNumberOfFeatures: l\n    };\n  }\n\n  get averageSymbolComplexity() {\n    const e = ye(this.symbolComplexities),\n          t = this._get(\"averageSymbolComplexity\");\n\n    return 0 === e.numComplexities || h(t) && (e.estimated && (t.primitivesPerFeature >= e.primitivesPerFeature || t.primitivesPerCoordinate >= e.primitivesPerCoordinate || t.drawCallsPerFeature >= e.drawCallsPerFeature) || t.primitivesPerFeature === e.primitivesPerFeature && t.primitivesPerCoordinate === e.primitivesPerCoordinate && t.drawCallsPerFeature === e.drawCallsPerFeature) ? t : e;\n  }\n\n  get spatialReference() {\n    return this._spatialReference;\n  }\n\n  get usedMemory() {\n    const e = h(this.averageSymbolComplexity) && this.labelsEnabled ? this.averageSymbolComplexity.memory.bytesPerFeatureLabel * this.numberOfGraphics : 0;\n    return this._usedMemory + e;\n  }\n\n  get usedMemoryPerGraphic() {\n    if (this._usedMemory && this.numberOfGraphics) return Math.abs(this.pendingAdds - this.pendingRemoves) / this.numberOfGraphics > 30 ? 0 : this._usedMemory / this.numberOfGraphics;\n\n    if (h(this.averageSymbolComplexity)) {\n      const e = this.labelsEnabled ? this.averageSymbolComplexity.memory.bytesPerFeatureLabel : 0;\n      return this.averageSymbolComplexity.memory.bytesPerFeature + e;\n    }\n\n    return 0;\n  }\n\n  get unprocessedMemoryEstimate() {\n    return Math.max(0, (this.pendingAdds - this.pendingRemoves) * this.usedMemoryPerGraphic);\n  }\n\n  get symbolComplexities() {\n    return this.currentRenderer ? this.getSymbolComplexitiesUsedOrRenderer(this.currentRenderer) : this.getSymbolComplexitiesUsed();\n  }\n\n  getConvertedSymbol(e) {\n    if (\"web-style\" === e.type) return e.clone();\n    const t = this.symbolConversionCache.get(e.id);\n    if (void 0 !== t) return t;\n    const i = ee(e, !0, !1, this.hasLabelingContext(e)),\n          r = i.symbol || null;\n    return r || i.error && Ue.error(i.error.message), this.symbolConversionCache.set(e.id, r), r;\n  }\n\n  getSymbolComplexitiesUsedOrRenderer(e) {\n    if (p(e)) return [];\n    const t = e.getSymbols(),\n          i = \"backgroundFillSymbol\" in e && e.backgroundFillSymbol;\n    if (!(i || t && t.length)) return [];\n    const r = [],\n          s = this.getSymbolComplexityUsedOrRenderer(i);\n    h(s) && r.push(s);\n\n    for (const a of t) {\n      const e = this.getSymbolComplexityUsedOrRenderer(a);\n      h(e) && r.push(e);\n    }\n\n    return r;\n  }\n\n  getSymbolComplexityUsedOrRenderer(e) {\n    if (p(e)) return null;\n    const t = this.symbols.get(e.id);\n    if (h(t)) return t.complexity;\n    const i = this.getConvertedSymbol(e);\n    return i ? me(i) : null;\n  }\n\n  getSymbolComplexitiesUsed() {\n    const e = [];\n    return this.symbols.forEach(t => {\n      h(t) && e.push(t.complexity);\n    }), e;\n  }\n\n  initialize() {\n    this._spatialReference = this.owner.view.spatialReference, this._set(\"featureStore\", new se({\n      objectIdField: this.owner.layer && this.owner.layer.objectIdField,\n      hasZ: this.hasZ,\n      hasM: this.hasM,\n      spatialReference: this._spatialReference,\n      getSpatialIndex: () => this.spatialIndex,\n      forAllGraphics: e => this.graphics3DGraphics.forEach(e)\n    }));\n  }\n\n  async setup(e) {\n    this.setupAbortController = b();\n    const t = this.setupAbortController.signal;\n    this._set(\"elevationAlignment\", e.elevationAlignment), this._set(\"scaleVisibility\", e.scaleVisibility), this._set(\"filterVisibility\", e.filterVisibility), this._set(\"deconflictor\", e.deconflictor), this._set(\"labeler\", e.labeler), this._set(\"objectStates\", e.objectStates);\n    const i = this.owner.view;\n    this.viewElevationProvider = new te(this._spatialReference, i), this.initializeStage(i, this.layer.uid), this.symbolCreationContext.sharedResources = i.sharedSymbolResources, this.sharedSymbolResourcesOwnerHandle = i.sharedSymbolResources.addGraphicsOwner(this.owner), h(this.currentRenderer) && (this.symbolCreationContext.renderer = this.currentRenderer), this.symbolCreationContext.stage = this.stage, this.symbolCreationContext.streamDataRequester = i.sharedSymbolResources.streamDataRequester, this.symbolCreationContext.renderCoordsHelper = i.renderCoordsHelper, this.symbolCreationContext.layer = this.layer, this.symbolCreationContext.layerView = this.owner, this.symbolCreationContext.localOriginFactory = new fe(i.renderSpatialReference), this.symbolCreationContext.elevationProvider = i.elevationProvider, this.symbolCreationContext.notifyGraphicGeometryChanged = e => this.notifyGraphicGeometryChanged(e), this.symbolCreationContext.notifyGraphicVisibilityChanged = e => this.notifyGraphicVisibilityChanged(e);\n    const r = ie(this.layer.elevationInfo, this.elevationFeatureExpressionEnabled);\n    this.symbolCreationContext.featureExpressionInfoContext = await re(r, this._spatialReference, Ue), f(t), this.symbolCreationContext.screenSizePerspectiveEnabled = i.screenSizePerspectiveEnabled && this.layer.screenSizePerspectiveEnabled, this.symbolCreationContext.slicePlaneEnabled = !!this.owner.slicePlaneEnabled, this.symbolCreationContext.physicalBasedRenderingEnabled = !!this.owner.view.qualitySettings.physicallyBasedRenderingEnabled;\n    const s = \"layer\" in this.owner ? [\"layer.screenSizePerspectiveEnabled,view.screenSizePerspectiveEnabled\"] : \"view.screenSizePerspectiveEnabled\";\n    this._handles.add([this.watch(\"suspendedOrOutsideOfView\", () => this._frameTask.reschedule(() => this.updateLayerVisibility())), this.owner.watch(s, () => {\n      const e = i.screenSizePerspectiveEnabled && this.layer.screenSizePerspectiveEnabled;\n      e !== this.symbolCreationContext.screenSizePerspectiveEnabled && (this.symbolCreationContext.screenSizePerspectiveEnabled = e, this.recreateAllGraphics());\n    }), this.owner.watch(\"slicePlaneEnabled\", e => this.slicePlaneEnabledChange(!!e)), this.owner.view.watch(\"pixelRatio\", () => this.pixelRatioChange()), this.owner.view.watch(\"qualitySettings.physicallyBasedRenderingEnabled\", e => this.physicalBasedRenderingChange(e)), G(i.basemapTerrain, \"tilingScheme\", e => {\n      e.spatialReference.equals(this.symbolCreationContext.overlaySR) || (this.symbolCreationContext.overlaySR = i.basemapTerrain.spatialReference), this._handles.has(\"loaded-graphics\") ? this.recreateAllGraphics() : this._handles.add([R(this.owner, \"loadedGraphics\", \"change\", e => this.graphicsCollectionChanged(e), () => this.recreateAllGraphics()), R(this.owner, \"loadedGraphics\", \"after-changes\", () => this._signalUpdatingDuringAsyncLoadedGraphicsChange(), () => this._signalUpdatingDuringAsyncLoadedGraphicsChange())], \"loaded-graphics\");\n    }), x(this, \"asyncUpdates\", () => this.runTask(Se), !0), P(this, \"effectiveUpdatePolicy\", e => {\n      h(this.stageLayer) && (this.stageLayer.updatePolicy = e), this.symbolCreationContext.isAsync = 0 === this.effectiveUpdatePolicy, 1 === e && this.runTask(Se);\n    }, !0)]), this._frameTask = i.resourceController.scheduler.registerTask(we.GRAPHICS_CORE, this), this.owner.layer && \"featureReduction\" in this.owner.layer && this._handles.add(this.owner.watch(\"layer.featureReduction\", () => this.deconflictor.featureReductionChange())), this.notifyChange(\"averageSymbolComplexity\");\n\n    try {\n      await this.rendererChange(this.layer.renderer);\n    } catch {}\n\n    f(t), this.setupAbortController = null;\n  }\n\n  abortSetup() {\n    this.setupAbortController && (this.setupAbortController.abort(), this.setupAbortController = null);\n  }\n\n  destroy() {\n    this.abortSetup(), this.abortRendererChange(), this.abortElevationInfoChange(), this.owner.view.deconflictor.removeGraphicsOwner(this), this.owner.view.labeler.removeGraphicsOwner(this), this._updatingPendingLoadedGraphicsChange && (this._updatingPendingLoadedGraphicsChange.remove(), this._updatingPendingLoadedGraphicsChange = null), this.clear(), h(this.graphicStateTracking) && (this.graphicStateTracking.destroy(), this.graphicStateTracking = null), this.stage && (this.stage.remove(this.stageLayer), this.stageLayer = null, this.stage = null), this._handles = c(this._handles), this._frameTask.remove(), this._frameTask = Ce, this._spatialReference = null, this._set(\"owner\", null);\n\n    for (const e in this.whenGraphics3DGraphicRequests) this.whenGraphics3DGraphicRequests[e].reject(new r(\"graphic:layer-destroyed\", \"Layer has been destroyed\"));\n\n    this.whenGraphics3DGraphicRequests = null, this.sharedSymbolResourcesOwnerHandle = y(this.sharedSymbolResourcesOwnerHandle), this.propertiesPool = c(this.propertiesPool), this.pendingUpdatesPool = null, this.symbolConversionCache.clear(), this.objectIdInvisibleSet.clear(), this._spatialIndex = c(this._spatialIndex), this.featureStore && (this.featureStore.destroy(), this._set(\"featureStore\", null));\n  }\n\n  clear() {\n    var e;\n    this.objectStates && this.objectStates.allGraphicsDeleted(), h(this.graphicStateTracking) && this.graphicStateTracking.allGraphicsDeleted(), this.graphics3DGraphics.forEach(e => e.destroy()), null == (e = this._spatialIndex) || e.clear(), this.graphics3DGraphics.clear(), this.numberOfGraphics = 0, this._usedMemory = 0, this.updateLayerVisibility(), this.symbols.forEach(e => {\n      h(e) && e.destroy();\n    }), this.symbols.clear(), this.graphicsBySymbol.clear(), this.graphicsWithoutSymbol.clear(), this.graphicsWaitingForSymbol.clear(), this.pendingUpdates.clear(), this.pendingUpdatesPool.clear(), this.pendingAdds = 0, this.pendingRemoves = 0, this.notifyChange(\"updating\"), this.notifyChange(\"running\"), this.notifyChange(\"updatingRemaining\"), this.featureStore.events.emit(\"changed\");\n  }\n\n  initializeStage(e, t) {\n    this.stage = e._stage, this.stageLayer = new ve({\n      isPickable: !this.suspendedOrOutsideOfView,\n      updatePolicy: this.effectiveUpdatePolicy\n    }, t), this.stage.add(this.stageLayer);\n    const i = this.stageLayer.events;\n    i.on(\"objectTransformation\", e => this.notifyGraphicGeometryChanged(e.metadata.graphicUid)), i.on(\"visibilityChanged\", e => this.notifyGraphicVisibilityChanged(e.metadata.graphicUid)), i.on(\"objectGeometryAdded\", e => this.notifyGraphicGeometryChanged(e.object.metadata.graphicUid)), i.on(\"objectGeometryRemoved\", e => this.notifyGraphicGeometryChanged(e.object.metadata.graphicUid)), i.on(\"vertexAttrsUpdated\", e => this.notifyGraphicGeometryChanged(e.object.metadata.graphicUid));\n  }\n\n  notifyGraphicGeometryChanged(e) {\n    if (p(this.graphicStateTracking)) return;\n    const t = this.graphics3DGraphics.get(e);\n    t && this.graphicStateTracking.updateGraphicGeometry(t);\n  }\n\n  notifyGraphicVisibilityChanged(e) {\n    if (p(this.graphicStateTracking)) return;\n    const t = this.graphics3DGraphics.get(e);\n    t && this.graphicStateTracking.updateGraphicVisibility(t);\n  }\n\n  updateLayerVisibility() {\n    const e = this.displayFeatureLimit.maximumNumberOfFeatures,\n          t = this.numberOfGraphics > e * Le,\n          i = !this.suspendedOrOutsideOfView && !t;\n    i !== this._visible && (this._visible = i, i ? (this.stageLayer.isPickable = !0, this.updateAllGraphicsVisibility()) : (this.stageLayer.isPickable = !1, this.hideAllGraphics()), this.updateStageLayerVisibility());\n  }\n\n  updateStageLayerVisibility() {\n    this.stageLayer.isVisible = this._visible && (null == this.layer.opacity || this.layer.opacity > 0);\n  }\n\n  getGraphics3DGraphicById(e) {\n    return this.graphics3DGraphics.get(e);\n  }\n\n  getGraphics3DGraphicByObjectId(e) {\n    var t;\n    return null != (t = this.owner.layer) && t.objectIdField ? this._findGraphics3DGraphicByObjectId(e) : null;\n  }\n\n  _getGraphicObjectID(e, t = this.owner.layer && this.owner.layer.objectIdField) {\n    return H(e, t);\n  }\n\n  get graphics3DGraphicsByObjectID() {\n    const e = this.owner.layer && this.owner.layer.objectIdField;\n    if (!e) return null;\n    const t = new Map();\n    return this.graphics3DGraphics.forEach(i => {\n      if (!i) return;\n\n      const r = i.graphic,\n            s = this._getGraphicObjectID(r, e);\n\n      h(s) && t.set(s, i);\n    }), t;\n  }\n\n  get labelsEnabled() {\n    return !(!this.labeler || !this.labeler.layerLabelsEnabled());\n  }\n\n  async updateLabelingInfo(e) {\n    const t = this.deconflictor && this.deconflictor.labelingInfoChange(e),\n          i = this.labeler && this.labeler.labelingInfoChange(e);\n    await v([t, i]);\n  }\n\n  updateVisibilityInfo() {\n    this.deconflictor && this.deconflictor.labelingInfoChange(), this.labeler && this.labeler.visibilityInfoChange();\n  }\n\n  get symbolUpdateType() {\n    if (this.pendingUpdates.size > 0) return \"unknown\";\n    let e = 0,\n        t = 0;\n    return n(this.symbols, (i, r) => {\n      if (h(i)) {\n        const s = i.getFastUpdateStatus();\n        if (s.loading > 0) return !0;\n        this.graphicsBySymbol.has(r) && (t += s.fast, e += s.slow);\n      }\n\n      return !1;\n    }) ? \"unknown\" : t >= 0 && 0 === e ? \"fast\" : e >= 0 && 0 === t ? \"slow\" : \"mixed\";\n  }\n\n  runTask(e) {\n    this._frameTask.processQueue(e), this._applyPendingUpdates(e), this.notifyChange(\"running\"), this.running || this.notifyChange(\"updating\"), this.notifyChange(\"updatingRemaining\");\n  }\n\n  setObjectIdVisibility(e, t) {\n    t ? this.objectIdInvisibleSet.delete(e) : this.objectIdInvisibleSet.add(e);\n\n    const i = this._findGraphics3DGraphicByObjectId(e);\n\n    h(i) && this._updateUserVisibility(i);\n  }\n\n  _findGraphics3DGraphicByObjectId(e) {\n    return o(this.graphics3DGraphics, t => this._getGraphicObjectID(t.graphic) === e);\n  }\n\n  _updateUserVisibility(e) {\n    if (p(e)) return !1;\n\n    const t = e.graphic,\n          i = this._getGraphicObjectID(t),\n          r = t.visible && !this.owner.suspended && (p(i) || !this.objectIdInvisibleSet.has(i));\n\n    return e.setVisibilityFlag(0, r, 0);\n  }\n\n  whenGraphics3DGraphic(e) {\n    const t = this.graphics3DGraphics.get(e.uid);\n    if (t) return Promise.resolve(t);\n    const i = this.whenGraphics3DGraphicRequests[e.uid];\n    if (i) return i.promise;\n    const r = C();\n    return this.whenGraphics3DGraphicRequests[e.uid] = r, r.promise;\n  }\n\n  async boundsForGraphics3DGraphic(e, t) {\n    const i = this._spatialReference,\n          r = this.owner.view.renderSpatialReference,\n          s = this.owner.view.basemapTerrain.spatialReference,\n          a = (e, t, s) => T(e, r, t, e, i, t, s),\n          n = (e, t, r) => T(e, s, t, e, i, t, r),\n          o = this.viewElevationProvider ? {\n      service: this.viewElevationProvider,\n      useViewElevation: h(t) && t.useViewElevation,\n      minDemResolution: h(t) && t.minDemResolution,\n      minDemResolutionForPoints: this.owner.view.resolution\n    } : null,\n          l = await e.getProjectedBoundingBox(a, n, o, m(t, \"signal\"));\n\n    if (!l) return null;\n    const p = l.boundingBox;\n\n    if (l.requiresDrapedElevation) {\n      const e = this.symbolCreationContext.elevationProvider;\n\n      if (e) {\n        W(p, Ie);\n        const t = d(e.getElevation(Ie[0], Ie[1], 0, i, \"ground\"), 0);\n        p[2] = Math.min(p[2], t), p[5] = Math.max(p[5], t);\n      }\n    }\n\n    return {\n      boundingBox: p,\n      screenSpaceObjects: l.screenSpaceObjects\n    };\n  }\n\n  whenGraphicBounds(e, t) {\n    return _(this.owner, \"loadedGraphics\").then(() => {\n      const t = this.owner.layer && this.owner.layer.objectIdField,\n            i = this.owner.loadedGraphics.find(i => i === e || t && i.attributes && e.attributes && i.attributes[t] === e.attributes[t]);\n      if (i) return this.whenGraphics3DGraphic(i);\n      throw new r(\"internal:graphic-not-part-of-view\", \"Graphic is not part of this view\");\n    }).then(e => this.boundsForGraphics3DGraphic(e, t));\n  }\n\n  computeAttachmentOrigin(e, t) {\n    const i = this.graphics3DGraphics.get(e.uid);\n    if (!i) return null;\n    const r = i.computeAttachmentOrigin();\n    if (0 === r.render.num && 0 === r.draped.num) return null;\n    O(Ve, 0, 0, 0);\n    let s = 0;\n\n    if (r.render.num > 0) {\n      if (!A(r.render.origin, this.symbolCreationContext.renderCoordsHelper.spatialReference, Ae, t)) return null;\n      j(Ve, Ve, Ae), s++;\n    }\n\n    if (r.draped.num > 0) {\n      const [e, i] = r.draped.origin,\n            a = d(this.viewElevationProvider.getElevation(e, i, \"ground\"), 0);\n      if (O(Ae, e, i, a), !A(Ae, this.viewElevationProvider.spatialReference, Ae, t)) return null;\n      j(Ve, Ve, Ae), s++;\n    }\n\n    return s > 1 && L(Ve, Ve, 1 / s), new xe({\n      x: Ve[0],\n      y: Ve[1],\n      z: Ve[2],\n      spatialReference: t\n    });\n  }\n\n  getSymbolLayerSize(e, t) {\n    const i = this.symbols.get(e.id);\n    if (p(i)) throw new r(\"internal:symbol-not-part-of-view\", \"Symbol is not part of this view\");\n    const s = e.symbolLayers.indexOf(t);\n    if (-1 === s) throw new r(\"internal:missing-symbol-layer\", \"Symbol layer is not in symbol\");\n    const a = i.getSymbolLayerSize(s);\n    if (null == a) throw new r(\"internal:missing-size\", \"Symbol layer has no valid size\");\n    return a;\n  }\n\n  graphicsCollectionChanged(e) {\n    this._startCreateGraphics && (this.add(e.added), this.remove(e.removed));\n  }\n\n  graphicUpdateHandler(e) {\n    const t = e.graphic.uid,\n          i = this.graphics3DGraphics.get(t),\n          r = this.graphicsWithoutSymbol.get(t);\n    if (i || r) switch (e.property) {\n      case \"visible\":\n        this.graphicUpdateVisibleHandler(i);\n        break;\n\n      case \"geometry\":\n        this.graphicUpdateGeometryHandler(i, e);\n        break;\n\n      case \"symbol\":\n        this.graphicUpdateSymbolHandler(i, e);\n    }\n  }\n\n  graphicUpdateGeometryHandler(e, t) {\n    const i = t.graphic.geometry;\n    if (p(i)) return void this.recreateGraphic(t.graphic);\n\n    if (p(e)) {\n      const e = t.graphic.symbol && t.graphic.symbol.id;\n\n      if (e) {\n        const t = this.symbols.get(e);\n        if (h(t) && 0 === t.loadStatus) return;\n      }\n\n      return void this.recreateGraphic(t.graphic);\n    }\n\n    const r = e.graphics3DSymbol;\n    !p(t.newValue) && r.updateGeometry(e, t.newValue) || this.recreateGraphic(e.graphic), this.expandComputedExtent(i);\n  }\n\n  graphicUpdateSymbolHandler(e, t) {\n    const i = t.graphic,\n          r = h(e) ? e.graphics3DSymbol : h(t.oldValue) ? this.symbols.get(t.oldValue.id) : null;\n    if (p(r) || p(t.newValue)) return void this.recreateGraphic(i);\n    const s = r.symbol,\n          a = this.getConvertedSymbol(t.newValue);\n    if (a.type !== s.type || \"web-style\" === a.type || \"web-style\" === s.type) return void this.recreateGraphic(i);\n    const n = this.graphicsBySymbol.get(s.id);\n    if (n && 1 !== n.size) return void this.recreateGraphic(i);\n    const o = E(s, a);\n    if (p(o)) return void this.updateSymbolMapping(s.id, a);\n    const l = {\n      diff: o,\n      graphics3DGraphicPatches: [],\n      symbolStatePatches: []\n    };\n    if (r.prepareSymbolPatch(l), !U(l.diff)) return void this.recreateGraphic(i);\n\n    const d = this._getRenderingInfo(i);\n\n    if (p(d)) return void this.recreateGraphic(i);\n    const c = r.extentPadding;\n\n    for (const h of l.symbolStatePatches) h();\n\n    if (c !== r.extentPadding && this.recomputeExtentPadding(), h(e)) for (const h of l.graphics3DGraphicPatches) h(e, d);\n    this.updateSymbolMapping(s.id, a);\n  }\n\n  graphicUpdateVisibleHandler(e) {\n    this._updateUserVisibility(e) && (this.labeler && this.owner.view.labeler.setDirty(), this.owner.view.deconflictor.setDirty());\n  }\n\n  recreateGraphics(e) {\n    this.suspendSymbolCleanup = !0, this.remove(e), this.add(e), this.suspendSymbolCleanup = !1, 1 === this.effectiveUpdatePolicy && this._cleanupSymbols();\n  }\n\n  recreateGraphic(e) {\n    this.recreateGraphics([e]);\n  }\n\n  _beginGraphicUpdate(e) {\n    this.graphicsWaitingForSymbol.add(e.uid), 1 === this.graphicsWaitingForSymbol.size && this.notifyChange(\"updating\");\n  }\n\n  _endGraphicUpdate(e) {\n    e && (this.graphicsWaitingForSymbol.delete(e.uid), 0 === this.graphicsWaitingForSymbol.size && (this._cleanupSymbols(), this.notifyChange(\"updating\")));\n  }\n\n  recomputeExtentPadding() {\n    let e = 0;\n    this.symbols.forEach(t => {\n      h(t) && (e = Math.max(e, t.extentPadding));\n    }), this._set(\"extentPadding\", e);\n  }\n\n  expandComputedExtent(e) {\n    const t = Ee,\n          i = e.spatialReference;\n    $(e, t);\n    const r = this._spatialReference,\n          s = De.tmpVec;\n    if (i.equals(r) || F(t[0], t[1], 0, i, s, r) && (t[0] = s[0], t[1] = s[1], F(t[3], t[4], 0, i, s, r), t[3] = s[0], t[4] = s[1]), !(l(t[0]) && l(t[3]) && l(t[1]) && l(t[4]))) return;\n    const a = this.computedExtent;\n    let n = null;\n    const o = l(t[2]) && l(t[5]),\n          h = o && (!a || null == a.zmin || t[2] < a.zmin),\n          d = o && (!a || null == a.zmax || t[5] > a.zmax);\n\n    if (a) {\n      (t[0] < a.xmin || t[1] < a.ymin || t[3] > a.xmax || t[4] > a.ymax || h || d) && (n = this.propertiesPool.get(\"computedExtent\"), n.xmin = Math.min(t[0], a.xmin), n.ymin = Math.min(t[1], a.ymin), n.xmax = Math.max(t[3], a.xmax), n.ymax = Math.max(t[4], a.ymax), n.spatialReference = r);\n    } else n = this.propertiesPool.get(\"computedExtent\"), n.xmin = t[0], n.ymin = t[1], n.xmax = t[3], n.ymax = t[4], n.spatialReference = r;\n\n    n && (h && (n.zmin = t[2]), d && (n.zmax = t[5]), this._set(\"computedExtent\", n));\n  }\n\n  abortElevationInfoChange() {\n    this.elevationInfoChangeAbortController && (this.elevationInfoChangeAbortController.abort(), this.elevationInfoChangeAbortController = null);\n  }\n\n  async elevationInfoChange() {\n    this.abortElevationInfoChange();\n    const e = b();\n    this.elevationInfoChangeAbortController = e;\n    const t = ie(this.layer.elevationInfo, this.elevationFeatureExpressionEnabled);\n    this.symbolCreationContext.featureExpressionInfoContext = await re(t, this._spatialReference, Ue), f(e), this.elevationInfoChangeAbortController = null, this.labeler && this.labeler.elevationInfoChange(), this.forEachGraphics3DSymbol((e, t, i) => {\n      e.globalPropertyChanged(\"elevationInfo\", t) ? t.forEach(e => {\n        const t = e.graphic,\n              i = e.labelGraphics;\n\n        for (const r of i) {\n          r.graphics3DSymbolLayer.updateGraphicElevationContext(t, r);\n        }\n      }) : this._recreateSymbol(i);\n    }), this.updateStageLayerElevationProvider(), this.elevationAlignment && this.elevationAlignment.elevationInfoChange();\n  }\n\n  updateStageLayerElevationProvider() {\n    this.stageLayerElevationProvider ? (this.layer.elevationInfo && \"relative-to-scene\" === this.layer.elevationInfo.mode || 0 === this.numberOfGraphicsProvidingElevation) && (this.owner.view.elevationProvider.unregister(this.stageLayerElevationProvider), this.stageLayerElevationProvider.dispose(), this.stageLayerElevationProvider = null) : (!this.layer.elevationInfo || this.layer.elevationInfo && \"relative-to-scene\" !== this.layer.elevationInfo.mode) && this.numberOfGraphicsProvidingElevation > 0 && (this.stageLayerElevationProvider = new ge({\n      layer: this.layer,\n      stageLayer: this.stageLayer,\n      view: this.owner.view\n    }), this.owner.view.elevationProvider.register(\"scene\", this.stageLayerElevationProvider));\n  }\n\n  clearSymbolsAndGraphics() {\n    this.clear(), this.filterVisibility && this.filterVisibility.clear(), this.labeler && this.labeler.reset(), this.deconflictor && this.deconflictor.clear(), this.elevationAlignment && this.elevationAlignment.clear(), this.stageLayer && this.stageLayer.invalidateSpatialQueryAccelerator(), this.stageLayerElevationProvider && (this.owner.view.elevationProvider.unregister(this.stageLayerElevationProvider), this.stageLayerElevationProvider.dispose(), this.stageLayerElevationProvider = null);\n  }\n\n  startCreateGraphics() {\n    this._startCreateGraphics = !0, this.recreateAllGraphics();\n  }\n\n  recreateAllGraphics() {\n    this._startCreateGraphics && (this.clearSymbolsAndGraphics(), this._set(\"computedExtent\", null), this.symbolCreationContext.screenSizePerspectiveEnabled = this.owner.view.screenSizePerspectiveEnabled && this.layer.screenSizePerspectiveEnabled, this.symbolCreationContext.slicePlaneEnabled = !!this.owner.slicePlaneEnabled, this.owner.loadedGraphics && this.owner.loadedGraphics.length && this.owner.view.basemapTerrain.tilingScheme && this.add(this.owner.loadedGraphics.toArray()));\n  }\n\n  _recreateSymbol(e) {\n    const t = this.graphicsBySymbol.get(e),\n          i = [];\n    t && (t.forEach((e, t) => {\n      var r;\n      const s = e.usedMemory;\n      this._conditionalRemove(e, t), null == (r = this._spatialIndex) || r.remove(e), i.push(e.graphic), e.destroy(), this.removeGraphics3DGraphic(t, s), this.updateLayerVisibility(), this.featureStore.events.emit(\"changed\");\n    }), this.graphicsBySymbol.set(e, new Map()));\n    const r = this.symbols.get(e);\n    h(r) && r.destroy(), this.symbols.delete(e), this.add(i);\n  }\n\n  _conditionalRemove(e, t) {\n    e.isDraped && this.graphicsDrapedUids.delete(t), this.objectStates && this.objectStates.removeGraphic(e), this.labeler && this.labeler.removeGraphic(e), this.deconflictor && this.deconflictor.removeGraphic(e), h(this.graphicStateTracking) && this.graphicStateTracking.removeGraphic(e);\n  }\n\n  add(e) {\n    e && 0 !== e.length && (this.owner.view.basemapTerrain && this.owner.view.basemapTerrain.tilingScheme ? (0 === this._updatePolicyForGraphics(e) ? this._addDelayed(e) : this._addImmediate(e), this.notifyChange(\"updating\")) : Ue.error(\"#add()\", \"Cannot add graphics before terrain surface has been initialized\"));\n  }\n\n  _updatePolicyForGraphics(e) {\n    if (1 === this.effectiveUpdatePolicy && (\"mesh\" === this.layer.geometryType || null == this.layer.geometryType)) for (const t of e) if (h(t.geometry) && \"mesh\" === t.geometry.type && !t.geometry.loaded) return 0;\n    return this.effectiveUpdatePolicy;\n  }\n\n  _addImmediate(e) {\n    this.geometryWarningLogged = !1, this.symbolWarningLogged = !1;\n\n    for (const t of e) this._addGraphic(t, this._getRenderingInfo(t, Ue), 1);\n\n    this._cleanupSymbols(), this.labeler && (this.owner.view.labeler.setDirty(), this._cleanupSymbols()), this.owner.view.deconflictor.setDirty();\n  }\n\n  _addDelayed(e) {\n    for (const t of e) {\n      const e = t.uid;\n      let i = this.pendingUpdates.get(e);\n      i ? i.add ? 0 !== i.state && i.abortController.abort() : this.pendingAdds++ : (i = this.pendingUpdatesPool.pushNew(), this.pendingAdds++, this.pendingUpdates.set(e, i)), i.add = t;\n    }\n\n    this.notifyChange(\"running\"), this.notifyChange(\"updatingRemaining\");\n  }\n\n  remove(e) {\n    0 === this.effectiveUpdatePolicy ? this._removeDelayed(e) : this._removeImmediate(e), this.notifyChange(\"updating\");\n  }\n\n  _removeImmediate(e) {\n    for (const t of e) this._removeGraphic(t);\n\n    this._cleanupSymbols(), this.labeler && this.owner.view.labeler.setDirty(), this.owner.view.deconflictor.setDirty();\n  }\n\n  _removeDelayed(e) {\n    for (const t of e) {\n      const e = t.uid,\n            i = this.pendingUpdates.get(e);\n      if (i) i.add && (i.remove ? i.add = null : this.pendingUpdates.delete(e), 1 === i.state && i.abortController.abort(), this.pendingAdds--);else {\n        const i = this.pendingUpdatesPool.pushNew();\n        i.remove = t, this.pendingUpdates.set(e, i), this.pendingRemoves++;\n      }\n    }\n\n    0 === this.pendingUpdates.size && this._finishPendingUpdates(), this.notifyChange(\"running\"), this.notifyChange(\"updatingRemaining\");\n  }\n\n  _finishPendingUpdates() {\n    this.pendingUpdatesPool.clear(), this._cleanupSymbols(), (this.pendingAdds || this.pendingRemoves) && Ue.warn(\"pendingAdds/Removes in inconsistent state!\"), this.pendingAdds = 0, this.pendingRemoves = 0;\n  }\n\n  _applyPendingUpdates(e) {\n    var t;\n    if (this.geometryWarningLogged = !1, this.symbolWarningLogged = !1, 0 === this.pendingUpdates.size && null != (t = this._spatialIndex) && t.updating) this._spatialIndex.update();else {\n      for (const [t, i] of this.pendingUpdates) {\n        if (e.done) break;\n        i.add && 0 === i.state && this._processPendingUpdateNew(i);\n        let r = this.effectiveUpdatePolicy;\n        if (!i.remove || i.add && 2 !== i.state || (this.pendingRemoves--, e.madeProgress(), this._removeGraphic(i.remove), i.remove = null, r = 1), i.add) switch (i.state) {\n          case 2:\n            this._addGraphic(i.add, i.renderingInfo, r), i.add = null, this.pendingAdds--, e.madeProgress();\n            break;\n\n          case 3:\n            i.add = null, this.pendingAdds--;\n        }\n        null == i.remove && null == i.add && this.pendingUpdates.delete(t);\n      }\n\n      0 === this.pendingUpdates.size && (this._finishPendingUpdates(), this.notifyChange(\"running\"));\n    }\n  }\n\n  _processPendingUpdateNew(e) {\n    if (!e.add) return void (e.state = 2);\n    const t = e.add.geometry;\n    h(t) && \"mesh\" === t.type && !t.loaded ? this._processPendingUpdateNewMesh(e, t) : this._processPendingUpdateNewRenderingInfo(e);\n  }\n\n  _processPendingUpdateNewMesh(e, t) {\n    e.state = 1, e.abortController = b();\n    const i = e.abortController.signal;\n    t.load({\n      signal: i\n    }).then(() => {\n      e.abortController = null, this._processPendingUpdateNewRenderingInfo(e);\n    }, t => this._processPendingUpdateNewError(e, t));\n  }\n\n  _processPendingUpdateNewError(e, t) {\n    e.abortController = null, S(t) ? e.state = 0 : e.state = 3;\n  }\n\n  _processPendingUpdateNewRenderingInfo(e) {\n    if (p(this.layer.renderer) || \"dictionary\" !== this.layer.renderer.type) return e.renderingInfo = this._getRenderingInfo(e.add, Ue), void (e.state = 2);\n    e.state = 1, e.abortController = b(), this._getRenderingInfoAsync(e.add, {\n      signal: e.abortController.signal\n    }).then(t => {\n      p(t) || p(t.symbol) ? (Ue && !this.symbolWarningLogged && (this.symbolWarningLogged = !0, Ue.warn(`Graphic in layer ${this.layer.id} has no symbol and will not render`)), e.renderingInfo = null) : e.renderingInfo = t, e.state = 2;\n    }, t => {\n      e.abortController = null, S(t) ? e.state = 0 : e.state = 3;\n    });\n  }\n\n  _addGraphic(e, t, i) {\n    if (this.graphicsWithoutSymbol.set(e.uid, e), p(t) || p(t.symbol) || !Z(e)) return;\n    const r = t.symbol,\n          s = this.getOrCreateGraphics3DSymbol(r, t.renderer);\n    if (p(s)) return;\n    this.expandComputedExtent(e.geometry), this._beginGraphicUpdate(e);\n    const a = new ne(e, t, this.layer);\n    let n = !1;\n\n    const o = e => {\n      e === s.symbol.id && (n = !0);\n    };\n\n    this._whenSymbolRemoved.push(o);\n\n    const l = () => {\n      if (!this.destroyed) {\n        if (this._whenSymbolRemoved.removeUnordered(o), !(n || s.destroyed || this.graphicSymbolSupported && e.symbol && e.symbol.id !== s.symbol.id)) {\n          if (this.graphicsWaitingForSymbol.has(e.uid)) {\n            const e = this.createGraphics3DGraphic(s, a);\n            this._spatialIndex && h(e) && this._spatialIndex.add(e);\n          }\n\n          this._endGraphicUpdate(e);\n        }\n\n        --s.referenced, this.featureStore.events.emit(\"changed\"), this.labeler && this.owner.view.labeler.setDirty();\n      }\n    },\n          d = t => {\n      this.destroyed || (this._whenSymbolRemoved.removeUnordered(o), n || (S(t) ? this.add([e]) : s.destroyed || this._endGraphicUpdate(e)));\n    };\n\n    0 === i ? s.load(() => this._frameTask.schedule(l), e => this._frameTask.schedule(() => d(e))) : s.load(l, d);\n  }\n\n  _removeGraphic(e) {\n    const t = e.uid,\n          i = this.graphics3DGraphics.get(t);\n\n    if (i) {\n      var r;\n      i.graphics3DSymbol.onRemoveGraphic(i);\n      const e = i.usedMemory,\n            s = i.isElevationSource;\n      this._conditionalRemove(i, t), null == (r = this._spatialIndex) || r.remove(i);\n      const a = i.graphics3DSymbol.symbol.id;\n      this.graphicsBySymbol.get(a).delete(t), this.graphicsWithoutSymbol.delete(t), this.removeGraphics3DGraphic(t, e, s), i.destroy(), this.featureStore.events.emit(\"changed\");\n    } else this.graphicsWithoutSymbol.delete(t), this.graphicsWaitingForSymbol.delete(t), 0 === this.graphicsWaitingForSymbol.size && (this._cleanupSymbols(), this.notifyChange(\"updating\"));\n  }\n\n  hasLabelingContext(e) {\n    if (e instanceof Pe || e instanceof _e) {\n      const t = this.symbolCreationContext.layer;\n      return !!t.labelingInfo && t.labelingInfo.some(t => t.symbol === e);\n    }\n\n    return !1;\n  }\n\n  hasValidSymbolCreationContext(e) {\n    return !(e instanceof Pe && !this.hasLabelingContext(e)) || (Ue.error(\"LabelSymbol3D is only valid as part of a LabelClass. Using LabelSymbol3D as a renderer symbol is not supported.\"), !1);\n  }\n\n  _getRenderingInfo(e, t) {\n    const i = e.geometry;\n    if (p(i)) return t && !this.geometryWarningLogged && (this.geometryWarningLogged = !0, t.warn(`Graphic in layer ${this.layer.id} has no geometry and will not render`)), null;\n    if (!k(i.spatialReference, this._spatialReference)) return t && !this.geometryWarningLogged && (this.geometryWarningLogged = !0, t.warn(`Graphic in layer ${this.layer.id} has incompatible spatial reference and will not render`)), null;\n    if (!this.graphicSymbolSupported && h(e.symbol)) return t && !this.symbolWarningLogged && (this.symbolWarningLogged = !0, t.warn(`Graphic in layer ${this.layer.id} is not allowed to have a symbol, use a renderer instead`)), null;\n    const r = this.rendererHasGeometryOperations ? Q(e, this.layer) : e;\n    let s;\n    if (this.owner.getRenderingInfo && (this.getRenderingInfoWithoutRenderer || h(this.currentRenderer))) s = this.owner.getRenderingInfo(r, this.currentRenderer, g(this.arcadeOnDemand));else {\n      s = {\n        symbol: r.symbol || Y(r.geometry)\n      };\n    }\n    return p(s) || p(s.symbol) ? (t && !this.symbolWarningLogged && (this.symbolWarningLogged = !0, t.warn(`Graphic in layer ${this.layer.id} has no symbol and will not render`)), null) : s;\n  }\n\n  _getRenderingInfoAsync(e, t) {\n    const i = e.geometry;\n    if (p(i)) return Ue && !this.geometryWarningLogged && (this.geometryWarningLogged = !0, Ue.warn(`Graphic in layer ${this.layer.id} has no geometry and will not render`)), null;\n    if (!this.graphicSymbolSupported && h(e.symbol)) return Ue && !this.symbolWarningLogged && (this.symbolWarningLogged = !0, Ue.warn(`Graphic in layer ${this.layer.id} is not allowed to have a symbol, use a renderer instead`)), null;\n    const r = this.rendererHasGeometryOperations ? Q(e, this.layer) : e;\n    return this.owner.getRenderingInfoAsync(r, g(this.currentRenderer), g(this.arcadeOnDemand), t);\n  }\n\n  createGraphics3DSymbol(e, t) {\n    if (!this.hasValidSymbolCreationContext(e)) return null;\n    const i = this.getConvertedSymbol(e);\n    if (!i) return null;\n    let r;\n\n    if (h(t) && \"backgroundFillSymbol\" in t && t.backgroundFillSymbol) {\n      const e = ee(t.backgroundFillSymbol, !1, !0);\n      e.symbol && \"web-style\" !== e.symbol.type && (r = e.symbol.symbolLayers);\n    }\n\n    const s = le(i, this.symbolCreationContext, r);\n    return s.load(() => {\n      const e = s.extentPadding;\n      e > this.extentPadding && this._set(\"extentPadding\", e), this.notifyChange(\"averageSymbolComplexity\");\n    }, () => {}), s;\n  }\n\n  getOrCreateGraphics3DSymbol(e, t) {\n    let i = this.symbols.get(e.id);\n    return void 0 === i && (i = e instanceof Re ? new he(e, e => this._frameTask.schedule(e), e => this.createGraphics3DSymbol(e, t)) : this.createGraphics3DSymbol(e, t), this.symbols.set(e.id, i)), h(i) && ++i.referenced, i;\n  }\n\n  trackGraphicState(e) {\n    return p(this.graphicStateTracking) && (this.graphicStateTracking = new de(this)), this.graphicStateTracking.add(e);\n  }\n\n  addGraphics3DGraphic(e) {\n    this._usedMemory += e.usedMemory, this.graphics3DGraphics.set(e.graphic.uid, e), this.numberOfGraphics++, e.isElevationSource && (this.numberOfGraphicsProvidingElevation++, this.updateStageLayerElevationProvider()), this.updateLayerVisibility();\n  }\n\n  removeGraphics3DGraphic(e, t, i = !1) {\n    this._usedMemory -= t, this.graphics3DGraphics.delete(e), this.numberOfGraphics--, i && (this.numberOfGraphicsProvidingElevation--, this.updateStageLayerElevationProvider()), this.updateLayerVisibility();\n  }\n\n  createGraphics3DGraphic(e, t) {\n    const i = t.graphic;\n    if (this.graphicsWithoutSymbol.delete(i.uid), !this.symbols.has(e.symbol.id)) return this.add([i]), null;\n    if (this.graphics3DGraphics.has(i.uid)) return null;\n    const r = e.createGraphics3DGraphic(t);\n    if (p(r)) return null;\n    this.addGraphics3DGraphic(r);\n    const s = e.symbol.id;\n    this.graphicsBySymbol.has(s) || this.graphicsBySymbol.set(s, new Map()), this.graphicsBySymbol.get(s).set(i.uid, r);\n    r.isDraped && this.graphicsDrapedUids.add(i.uid), r.centroid = null, h(i.geometry) && \"point\" !== i.geometry.type && r instanceof ae && (r.centroid = pe(i.geometry, this._spatialReference)), this._updateUserVisibility(r), h(this.scaleVisibility) && this.scaleVisibility.updateVisibility(r), this.filterVisibility && this.filterVisibility.updateVisibility(r), this.deconflictor && this.deconflictor.addGraphic(r), this.labeler && this.labeler.addGraphic(r), this.objectStates && this.objectStates.addGraphic(r), this.deconflictor && this.owner.view.deconflictor.setInitialIconVisibilityFlag(this, r), r.initialize(this.stage, this.stageLayer, this.owner), h(this.graphicStateTracking) && this.graphicStateTracking.addGraphic(r);\n    const a = this.whenGraphics3DGraphicRequests[i.uid];\n    return a && (delete this.whenGraphics3DGraphicRequests[i.uid], a.resolve(r)), r;\n  }\n\n  abortRendererChange() {\n    this.rendererChangeAbortController && (this.rendererChangeAbortController.abort(), this.rendererChangeAbortController = null);\n  }\n\n  async rendererChange(e) {\n    if (this.abortRendererChange(), e !== this.currentRenderer) if (this.validateRenderer(e), p(e) && this.currentRendererChange(null, !1), J(e)) {\n      if (h(e) && e.arcadeRequired) {\n        const t = b();\n        this.rendererChangeAbortController = t;\n        const {\n          arcadeUtils: i\n        } = await this.ensureArcade();\n        f(t), i.hasGeometryOperations(e) && (await i.enableGeometryOperations(), f(t)), 0 === this.effectiveUpdatePolicy ? await this._frameTask.schedule(() => this.currentRendererChange(e, !0), t.signal) : this.currentRendererChange(e, !0), this.rendererChangeAbortController = null;\n      } else if (0 === this.effectiveUpdatePolicy) {\n        const t = b();\n        this.rendererChangeAbortController = t, await this._frameTask.schedule(() => this.currentRendererChange(e, !1), t.signal), this.rendererChangeAbortController = null;\n      } else this.currentRendererChange(e, !1);\n    } else this.currentRendererChange(e, !1);\n  }\n\n  async ensureArcade() {\n    return p(this.arcadeOnDemand) ? (this.arcadeOnDemand = await X(), this.arcadeOnDemand) : this.arcadeOnDemand;\n  }\n\n  currentRendererChange(e, t) {\n    this.currentRenderer = e, this.rendererHasGeometryOperations = t, this.symbolCreationContext.arcade = g(this.arcadeOnDemand);\n    const i = this.symbolCreationContext.renderer;\n    if (e === i) return;\n    if (this.symbolConversionCache.clear(), p(e)) return this.symbolCreationContext.renderer = null, void this.recreateAllGraphics();\n    const r = E(i, e);\n    this.updateUnchangedSymbolMappings(r, e, i), this.symbolCreationContext.renderer = e, p(r) || (\"complete\" === r.type ? this.recreateAllGraphics() : \"partial\" === r.type && (this.applyRendererDiff(r, e, i) ? this.volatileGraphicsUpdated() : this.recreateAllGraphics()), this.notifyChange(\"averageSymbolComplexity\"));\n  }\n\n  diffHasSymbolChange(e) {\n    for (const t in e.diff) switch (t) {\n      case \"visualVariables\":\n      case \"defaultSymbol\":\n      case \"uniqueValueInfos\":\n        break;\n\n      case \"authoringInfo\":\n      case \"fieldDelimiter\":\n        delete e.diff[t];\n        break;\n\n      default:\n        return !0;\n    }\n\n    return !1;\n  }\n\n  applySymbolSetDiff(e, t, i) {\n    e = e || [], t = t || [];\n    const r = [];\n\n    for (const s of t) {\n      const t = this.graphicsBySymbol.get(s.id);\n      t && t.forEach((a, n) => {\n        const o = a.graphic,\n              l = this.layer instanceof N ? this.layer : null,\n              h = g(this.arcadeOnDemand);\n        if (s === i.defaultSymbol && i.getSymbol(Q(o, l), {\n          arcade: h\n        }) === i.defaultSymbol) return;\n        const d = a.usedMemory;\n        e.length || i.defaultSymbol ? r.push(o) : this.graphicsWithoutSymbol.set(n, o);\n        const p = this.graphics3DGraphics.get(n);\n        this._conditionalRemove(p, n), a.destroy(), t.delete(n), this.removeGraphics3DGraphic(n, d), this.updateLayerVisibility();\n      }), this._whenSymbolRemoved.forAll(e => e(s.id));\n    }\n\n    (e.length || r.length) && (this.graphicsWithoutSymbol.forEach(e => r.push(e)), this.graphicsWithoutSymbol.clear(), this.add(r)), this._cleanupSymbols(), this.labeler && this.owner.view.labeler.setDirty(), this.owner.view.deconflictor.setDirty();\n  }\n\n  applyUniqueValueRendererDiff(e, t, i) {\n    const r = e.diff.defaultSymbol,\n          s = e.diff.uniqueValueInfos;\n\n    if (r || s) {\n      const a = s ? s.added.map(e => e.symbol) : [],\n            n = s ? s.removed.map(e => e.symbol) : [];\n      if (s) for (let e = 0; e < s.changed.length; e++) a.push(s.changed[e].newValue.symbol), n.push(s.changed[e].oldValue.symbol);\n      return r ? (i.defaultSymbol && n.push(i.defaultSymbol), t.defaultSymbol && a.push(t.defaultSymbol)) : i.defaultSymbol && a.length && n.push(t.defaultSymbol), this.applySymbolSetDiff(a, n, t), delete e.diff.defaultSymbol, delete e.diff.uniqueValueInfos, !0;\n    }\n\n    return !1;\n  }\n\n  calculateUnchangedSymbolMapping(e, i, r) {\n    const s = e => h(e) ? e.id : null;\n\n    if (i instanceof t && r instanceof t && (p(e) || \"partial\" === e.type)) {\n      const t = e && e.diff,\n            a = t && t.defaultSymbol,\n            n = t && t.uniqueValueInfos;\n      let o;\n      return o = n ? n.unchanged.map(e => ({\n        oldId: s(e.oldValue.symbol),\n        newId: s(e.newValue.symbol)\n      })) : r.uniqueValueInfos.map((e, t) => ({\n        oldId: s(e.symbol),\n        newId: s(i.uniqueValueInfos[t].symbol)\n      })), !a && r.defaultSymbol && o.push({\n        oldId: s(r.defaultSymbol),\n        newId: s(i.defaultSymbol)\n      }), o;\n    }\n\n    return [];\n  }\n\n  updateSymbolMapping(e, t) {\n    const i = t ? \"string\" == typeof t ? t : t.id : null,\n          r = \"string\" == typeof t ? null : t;\n    if (!e || e === i) return;\n    const s = this.graphicsBySymbol.get(e);\n    this.graphicsBySymbol.delete(e), void 0 !== s && this.graphicsBySymbol.set(i, s);\n    const a = this.symbols.get(e);\n    void 0 !== a && (this.symbols.delete(e), this.symbols.set(i, a), h(a) && (h(r) ? a.symbol = r : a.symbol.id = i));\n  }\n\n  updateUnchangedSymbolMappings(e, t, i) {\n    const r = this.calculateUnchangedSymbolMapping(e, t, i);\n\n    for (const {\n      oldId: s,\n      newId: a\n    } of r) this.updateSymbolMapping(s, a);\n  }\n\n  applyRendererDiff(e, i, r) {\n    if (this.diffHasSymbolChange(e)) return !1;\n    if (i instanceof t && r instanceof t && this.applyUniqueValueRendererDiff(e, i, r) && 0 === Object.keys(e.diff).length) return !0;\n\n    for (const [t] of this.graphicsBySymbol) {\n      const r = this.symbols.get(t);\n      if (h(r) && !r.applyRendererDiff(e, i)) return !1;\n    }\n\n    return !0;\n  }\n\n  opacityChange() {\n    this.forEachGraphics3DSymbol((e, t) => e.globalPropertyChanged(\"opacity\", t)), this.updateStageLayerVisibility();\n  }\n\n  slicePlaneEnabledChange(e) {\n    e !== this.symbolCreationContext.slicePlaneEnabled && (this.symbolCreationContext.slicePlaneEnabled = e, this.stageLayer.isSliceable = e, this.forEachGraphics3DSymbol((e, t) => e.globalPropertyChanged(\"slicePlaneEnabled\", t)), this.deconflictor && this.deconflictor.slicePlaneEnabledChange(), this.labeler && this.labeler.slicePlaneEnabledChange());\n  }\n\n  physicalBasedRenderingChange(e) {\n    e !== this.symbolCreationContext.physicalBasedRenderingEnabled && (this.symbolCreationContext.physicalBasedRenderingEnabled = e, this.forEachGraphics3DSymbol((e, t, i) => {\n      e.globalPropertyChanged(\"physicalBasedRenderingEnabled\", t) || this._recreateSymbol(i);\n    }));\n  }\n\n  pixelRatioChange() {\n    this.forEachGraphics3DSymbol((e, t, i) => {\n      e.globalPropertyChanged(\"pixelRatio\", t) || this._recreateSymbol(i);\n    });\n  }\n\n  _signalUpdatingDuringAsyncLoadedGraphicsChange() {\n    this._updatingPendingLoadedGraphicsChange && this._updatingPendingLoadedGraphicsChange.remove(), this._updatingPendingLoadedGraphicsChange = w(() => {\n      this._updatingPendingLoadedGraphicsChange = null;\n    });\n  }\n\n  setClippingExtent(e, t) {\n    const i = this.symbolCreationContext.clippingExtent,\n          r = q();\n    return ue(e, r, t) ? this.symbolCreationContext.clippingExtent = z(M(), r) : this.symbolCreationContext.clippingExtent = null, !B(this.symbolCreationContext.clippingExtent, i);\n  }\n\n  modifyGraphics3DGraphicVisibilities(e) {\n    let t = !1;\n    this.graphics3DGraphics.forEach(i => {\n      e(i) && (t = !0);\n    }), t && (this.labeler && this.owner.view.labeler.setDirty(), this.owner.view.deconflictor.setDirty());\n  }\n\n  forEachGraphics3DSymbol(e) {\n    for (const [t, i] of this.symbols) {\n      if (p(i)) return;\n      e(i, this.graphicsBySymbol.get(t) || Fe, t);\n    }\n  }\n\n  updateAllGraphicsVisibility() {\n    this.filterVisibility && (this.filterVisibility.dirty = !0), this.modifyGraphics3DGraphicVisibilities(e => {\n      const t = this._updateUserVisibility(e),\n            i = h(this.scaleVisibility) && this.scaleVisibility.updateVisibility(e);\n\n      return t || i;\n    });\n  }\n\n  hideAllGraphics() {\n    this.modifyGraphics3DGraphicVisibilities(e => e.setVisibilityFlag(0, !1, 0));\n  }\n\n  validateRenderer(e) {\n    const t = K(e);\n\n    if (t) {\n      const e = `Renderer for layer '${this.layer.title ? `${this.layer.title}, ` : \"\"}, id:${this.layer.id}' is not supported in a SceneView`;\n      Ue.warn(e, t.message);\n    }\n  }\n\n  volatileGraphicsUpdated() {\n    this.labeler && this.labeler.reset(), this.stageLayer.shaderTransformationChanged(), this.notifyChange(\"updating\");\n  }\n\n  _cleanupSymbols() {\n    if (this.graphicsWaitingForSymbol.size > 0 || this.suspendSymbolCleanup) return;\n    let e = !1;\n    this.symbols.forEach((t, i) => {\n      if (p(t) || t.referenced > 0) return;\n      const r = this.graphicsBySymbol.get(i);\n      r && 0 !== r.size || (this.graphicsBySymbol.delete(i), this.symbols.delete(i), t && t.destroy(), e = !0);\n    }), e && (this.recomputeExtentPadding(), this.notifyChange(\"averageSymbolComplexity\"));\n  }\n\n  snapshotInternals() {\n    return {\n      graphics: [...this.graphics3DGraphics.keys()].sort(),\n      symbols: [...this.symbols.keys()].sort(),\n      graphicsBySymbol: [...this.graphicsBySymbol.keys()].sort().map(e => ({\n        symbolId: e,\n        graphics: [...this.graphicsBySymbol.get(e).keys()].sort()\n      })),\n      graphicsWithoutSymbol: [...this.graphicsWithoutSymbol.keys()].sort(),\n      graphicsDrapedUids: [...this.graphicsDrapedUids].sort(),\n      pendingUpdates: this.pendingUpdates\n    };\n  }\n\n  get test() {\n    return {\n      symbols: this.symbols,\n      filterVisibility: this.filterVisibility,\n      numPending: this.pendingUpdates.size,\n      forceUpdatePolicy: e => {\n        this.forcedUpdatePolicy = e;\n      }\n    };\n  }\n\n  get performanceInfo() {\n    return {\n      visible: this.graphics3DGraphics.size,\n      missing: this.graphicsWithoutSymbol.size,\n      pending: this.pendingUpdates.size\n    };\n  }\n\n};\nOe.tmpVec = V(), e([D({\n  readOnly: !0\n})], Oe.prototype, \"computedExtent\", void 0), e([D()], Oe.prototype, \"currentRenderer\", void 0), e([D()], Oe.prototype, \"rendererHasGeometryOperations\", void 0), e([D()], Oe.prototype, \"_frameTask\", void 0), e([D()], Oe.prototype, \"rendererChangeAbortController\", void 0), e([D()], Oe.prototype, \"elevationInfoChangeAbortController\", void 0), e([D()], Oe.prototype, \"setupAbortController\", void 0), e([D({\n  readOnly: !0\n})], Oe.prototype, \"elevationAlignment\", void 0), e([D({\n  readOnly: !0\n})], Oe.prototype, \"scaleVisibility\", void 0), e([D({\n  readOnly: !0\n})], Oe.prototype, \"filterVisibility\", void 0), e([D()], Oe.prototype, \"_spatialIndex\", void 0), e([D({\n  readOnly: !0\n})], Oe.prototype, \"extentPadding\", void 0), e([D()], Oe.prototype, \"_updatingPendingLoadedGraphicsChange\", void 0), e([D({\n  readOnly: !0\n})], Oe.prototype, \"featureStore\", void 0), e([D({\n  readOnly: !0\n})], Oe.prototype, \"deconflictor\", void 0), e([D({\n  readOnly: !0\n})], Oe.prototype, \"labeler\", void 0), e([D({\n  readOnly: !0\n})], Oe.prototype, \"objectStates\", void 0), e([D()], Oe.prototype, \"preferredUpdatePolicy\", void 0), e([D()], Oe.prototype, \"forcedUpdatePolicy\", void 0), e([D({\n  readOnly: !0\n})], Oe.prototype, \"effectiveUpdatePolicy\", null), e([D({\n  constructOnly: !0\n})], Oe.prototype, \"elevationFeatureExpressionEnabled\", void 0), e([D({\n  constructOnly: !0\n})], Oe.prototype, \"owner\", void 0), e([D({\n  constructOnly: !0\n})], Oe.prototype, \"layer\", void 0), e([D({\n  constructOnly: !0\n})], Oe.prototype, \"graphicSymbolSupported\", void 0), e([D({\n  constructOnly: !0\n})], Oe.prototype, \"getRenderingInfoWithoutRenderer\", void 0), e([D({\n  readOnly: !0\n})], Oe.prototype, \"updating\", null), e([D({\n  readOnly: !0\n})], Oe.prototype, \"running\", null), e([D({\n  readOnly: !0\n})], Oe.prototype, \"suspendedOrOutsideOfView\", null), e([D({\n  readOnly: !0,\n  dependsOn: []\n})], Oe.prototype, \"updatingRemaining\", null), e([D({\n  readOnly: !0,\n  dependsOn: [\"owner.view.qualitySettings.graphics3D.maxTotalNumberOfPrimitives\", \"owner.view.qualitySettings.graphics3D.maxTotalNumberOfFeatures\", \"averageSymbolComplexity\"]\n})], Oe.prototype, \"displayFeatureLimit\", null), e([D({\n  readOnly: !0,\n  dependsOn: []\n})], Oe.prototype, \"averageSymbolComplexity\", null), e([D({\n  constructOnly: !0\n})], Oe.prototype, \"hasZ\", void 0), e([D({\n  constructOnly: !0\n})], Oe.prototype, \"hasM\", void 0), Oe = De = e([I(\"esri.views.3d.layers.graphics.Graphics3DCore\")], Oe);\n\nclass je {\n  constructor() {\n    this.add = null, this.renderingInfo = null, this.state = 0, this.remove = null;\n  }\n\n  clear() {\n    this.add = null, this.renderingInfo = null, this.state = 0, this.abortController = null, this.remove = null;\n  }\n\n}\n\nconst Le = 10,\n      Ve = V(),\n      Ae = V(),\n      Fe = new Map();\nexport { Oe as Graphics3DCore };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DCore.js"],"names":["_","e","t","i","r","s","a","someMap","n","findInMap","o","isFinite","l","isSome","h","unwrapOr","d","isNone","p","destroyMaybe","c","removeMaybe","y","get","m","unwrap","g","u","createAbortController","b","throwIfAborted","f","eachAlways","v","createDeferred","C","isAbortError","S","schedule","w","when","G","whenFalse","x","init","P","whenOnce","on","R","property","D","subclass","I","diff","E","isEmpty","U","O","j","L","V","projectVectorToVector","A","projectXYZToVector","F","canProjectWithoutEngine","k","projectBuffer","T","create","M","center","W","fromRect","z","equals","B","q","N","getObjectId","H","computeAABB","$","hasGeometry","Z","hydrateGraphic","Q","isSupportedRenderer3D","J","validateTo3D","K","loadArcade","X","getDefaultSymbol3D","Y","to3D","ee","ViewElevationProvider","te","extractExpressionInfo","ie","createContext","re","se","ae","ne","Graphics3DSymbolCreationContext","oe","make","le","he","GraphicStateTracking","de","computeCentroid","pe","SpatialIndex2D","ce","averageSymbolComplexities","ye","defaultSymbolComplexity","me","StageLayerElevationProvider","ge","toBoundingRect","ue","PropertiesPool","be","GridLocalOriginFactory","fe","WebGLLayer","ve","ImmediateTask","Ce","noBudget","Se","TaskPriority","we","Ge","xe","Pe","_e","Re","De","Ie","Ee","Ue","getLogger","Oe","constructor","propertiesPool","computedExtent","currentRenderer","rendererHasGeometryOperations","graphicStateTracking","symbolCreationContext","_frameTask","graphics3DGraphics","Map","stageLayer","stage","graphicsDrapedUids","Set","graphicsBySymbol","symbolConversionCache","symbols","graphicsWithoutSymbol","graphicsWaitingForSymbol","_handles","suspendSymbolCleanup","_spatialReference","arcadeOnDemand","rendererChangeAbortController","elevationInfoChangeAbortController","setupAbortController","elevationAlignment","scaleVisibility","filterVisibility","_spatialIndex","extentPadding","_updatingPendingLoadedGraphicsChange","featureStore","deconflictor","labeler","objectStates","viewElevationProvider","stageLayerElevationProvider","sharedSymbolResourcesOwnerHandle","whenGraphics3DGraphicRequests","pendingUpdates","numberOfGraphics","numberOfGraphicsProvidingElevation","pendingAdds","pendingRemoves","pendingUpdatesPool","allocator","je","deallocator","clear","symbolWarningLogged","geometryWarningLogged","objectIdInvisibleSet","_whenSymbolRemoved","preferredUpdatePolicy","forcedUpdatePolicy","elevationFeatureExpressionEnabled","owner","layer","graphicSymbolSupported","getRenderingInfoWithoutRenderer","hasZ","hasM","_usedMemory","_visible","_startCreateGraphics","spatialIndex","objectIdField","spatialReference","setup","Array","from","values","update","effectiveUpdatePolicy","type","updating","size","running","suspendedOrOutsideOfView","suspended","suspendInfo","outsideOfView","updatingRemaining","displayFeatureLimit","view","qualitySettings","graphics3D","minTotalNumberOfFeatures","maxTotalNumberOfFeatures","maxTotalNumberOfPrimitives","averageSymbolComplexity","Math","max","primitivesPerFeature","drawCallsPerFeature","ceil","min","_get","minimumTotalNumberOfFeatures","maximumTotalNumberOfFeatures","maximumTotalNumberOfPrimitives","maximumNumberOfFeatures","symbolComplexities","numComplexities","estimated","primitivesPerCoordinate","usedMemory","labelsEnabled","memory","bytesPerFeatureLabel","usedMemoryPerGraphic","abs","bytesPerFeature","unprocessedMemoryEstimate","getSymbolComplexitiesUsedOrRenderer","getSymbolComplexitiesUsed","getConvertedSymbol","clone","id","hasLabelingContext","symbol","error","message","set","getSymbols","backgroundFillSymbol","length","getSymbolComplexityUsedOrRenderer","push","complexity","forEach","initialize","_set","getSpatialIndex","forAllGraphics","signal","initializeStage","uid","sharedResources","sharedSymbolResources","addGraphicsOwner","renderer","streamDataRequester","renderCoordsHelper","layerView","localOriginFactory","renderSpatialReference","elevationProvider","notifyGraphicGeometryChanged","notifyGraphicVisibilityChanged","elevationInfo","featureExpressionInfoContext","screenSizePerspectiveEnabled","slicePlaneEnabled","physicalBasedRenderingEnabled","physicallyBasedRenderingEnabled","add","watch","reschedule","updateLayerVisibility","recreateAllGraphics","slicePlaneEnabledChange","pixelRatioChange","physicalBasedRenderingChange","basemapTerrain","overlaySR","has","graphicsCollectionChanged","_signalUpdatingDuringAsyncLoadedGraphicsChange","runTask","updatePolicy","isAsync","resourceController","scheduler","registerTask","GRAPHICS_CORE","featureReductionChange","notifyChange","rendererChange","abortSetup","abort","destroy","abortRendererChange","abortElevationInfoChange","removeGraphicsOwner","remove","reject","allGraphicsDeleted","events","emit","_stage","isPickable","metadata","graphicUid","object","updateGraphicGeometry","updateGraphicVisibility","Le","updateAllGraphicsVisibility","hideAllGraphics","updateStageLayerVisibility","isVisible","opacity","getGraphics3DGraphicById","getGraphics3DGraphicByObjectId","_findGraphics3DGraphicByObjectId","_getGraphicObjectID","graphics3DGraphicsByObjectID","graphic","layerLabelsEnabled","updateLabelingInfo","labelingInfoChange","updateVisibilityInfo","visibilityInfoChange","symbolUpdateType","getFastUpdateStatus","loading","fast","slow","processQueue","_applyPendingUpdates","setObjectIdVisibility","delete","_updateUserVisibility","visible","setVisibilityFlag","whenGraphics3DGraphic","Promise","resolve","promise","boundsForGraphics3DGraphic","service","useViewElevation","minDemResolution","minDemResolutionForPoints","resolution","getProjectedBoundingBox","boundingBox","requiresDrapedElevation","getElevation","screenSpaceObjects","whenGraphicBounds","then","loadedGraphics","find","attributes","computeAttachmentOrigin","render","num","draped","Ve","origin","Ae","getSymbolLayerSize","symbolLayers","indexOf","added","removed","graphicUpdateHandler","graphicUpdateVisibleHandler","graphicUpdateGeometryHandler","graphicUpdateSymbolHandler","geometry","recreateGraphic","loadStatus","graphics3DSymbol","newValue","updateGeometry","expandComputedExtent","oldValue","updateSymbolMapping","graphics3DGraphicPatches","symbolStatePatches","prepareSymbolPatch","_getRenderingInfo","recomputeExtentPadding","setDirty","recreateGraphics","_cleanupSymbols","_beginGraphicUpdate","_endGraphicUpdate","tmpVec","zmin","zmax","xmin","ymin","xmax","ymax","elevationInfoChange","forEachGraphics3DSymbol","globalPropertyChanged","labelGraphics","graphics3DSymbolLayer","updateGraphicElevationContext","_recreateSymbol","updateStageLayerElevationProvider","mode","unregister","dispose","register","clearSymbolsAndGraphics","reset","invalidateSpatialQueryAccelerator","startCreateGraphics","tilingScheme","toArray","_conditionalRemove","removeGraphics3DGraphic","isDraped","removeGraphic","_updatePolicyForGraphics","_addDelayed","_addImmediate","geometryType","loaded","_addGraphic","state","abortController","pushNew","_removeDelayed","_removeImmediate","_removeGraphic","_finishPendingUpdates","warn","done","_processPendingUpdateNew","madeProgress","renderingInfo","_processPendingUpdateNewMesh","_processPendingUpdateNewRenderingInfo","load","_processPendingUpdateNewError","_getRenderingInfoAsync","getOrCreateGraphics3DSymbol","destroyed","removeUnordered","createGraphics3DGraphic","referenced","onRemoveGraphic","isElevationSource","labelingInfo","some","hasValidSymbolCreationContext","getRenderingInfo","getRenderingInfoAsync","createGraphics3DSymbol","trackGraphicState","addGraphics3DGraphic","centroid","updateVisibility","addGraphic","setInitialIconVisibilityFlag","validateRenderer","currentRendererChange","arcadeRequired","arcadeUtils","ensureArcade","hasGeometryOperations","enableGeometryOperations","arcade","updateUnchangedSymbolMappings","applyRendererDiff","volatileGraphicsUpdated","diffHasSymbolChange","applySymbolSetDiff","defaultSymbol","getSymbol","forAll","applyUniqueValueRendererDiff","uniqueValueInfos","map","changed","calculateUnchangedSymbolMapping","unchanged","oldId","newId","Object","keys","opacityChange","isSliceable","setClippingExtent","clippingExtent","modifyGraphics3DGraphicVisibilities","Fe","dirty","title","shaderTransformationChanged","snapshotInternals","graphics","sort","symbolId","test","numPending","forceUpdatePolicy","performanceInfo","missing","pending","readOnly","prototype","constructOnly","dependsOn","Graphics3DCore"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import\"../../../../geometry.js\";import\"../../../../renderers/ClassBreaksRenderer.js\";import\"../../../../renderers/DictionaryRenderer.js\";import\"../../../../renderers/DotDensityRenderer.js\";import\"../../../../renderers/HeatmapRenderer.js\";import\"../../../../renderers/Renderer.js\";import\"../../../../renderers/SimpleRenderer.js\";import t from\"../../../../renderers/UniqueValueRenderer.js\";import\"../../../../renderers/support/jsonUtils.js\";import\"../../../../symbols.js\";import i from\"../../../../core/Accessor.js\";import\"../../../../core/has.js\";import r from\"../../../../core/Error.js\";import s from\"../../../../core/Handles.js\";import a from\"../../../../core/Logger.js\";import{someMap as n,findInMap as o}from\"../../../../core/MapUtils.js\";import{isFinite as l}from\"../../../../core/mathUtils.js\";import{isSome as h,unwrapOr as d,isNone as p,destroyMaybe as c,removeMaybe as y,get as m,unwrap as g}from\"../../../../core/maybe.js\";import u from\"../../../../core/PooledArray.js\";import{createAbortController as b,throwIfAborted as f,eachAlways as v,createDeferred as C,isAbortError as S}from\"../../../../core/promiseUtils.js\";import{schedule as w}from\"../../../../core/scheduling.js\";import{when as G,whenFalse as x,init as P,whenOnce as _,on as R}from\"../../../../core/watchUtils.js\";import{property as D}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as I}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{diff as E,isEmpty as U}from\"../../../../core/accessorSupport/diffUtils.js\";import{s as O,b as j,a as L}from\"../../../../chunks/vec3.js\";import{c as V}from\"../../../../chunks/vec3f64.js\";import{projectVectorToVector as A,projectXYZToVector as F,canProjectWithoutEngine as k,projectBuffer as T}from\"../../../../geometry/projection.js\";import{create as M,center as W,fromRect as z,equals as B}from\"../../../../geometry/support/aaBoundingBox.js\";import{create as q}from\"../../../../geometry/support/aaBoundingRect.js\";import N from\"../../../../layers/Layer.js\";import{getObjectId as H,computeAABB as $,hasGeometry as Z}from\"../../../../layers/graphics/dehydratedFeatures.js\";import{hydrateGraphic as Q}from\"../../../../layers/graphics/hydratedFeatures.js\";import{isSupportedRenderer3D as J,validateTo3D as K}from\"../../../../renderers/support/rendererConversion.js\";import{loadArcade as X}from\"../../../../support/arcadeOnDemand.js\";import{getDefaultSymbol3D as Y}from\"../../../../symbols/support/defaults3D.js\";import{to3D as ee}from\"../../../../symbols/support/symbolConversion.js\";import{ViewElevationProvider as te}from\"./ElevationQuery.js\";import{extractExpressionInfo as ie,createContext as re}from\"./featureExpressionInfoUtils.js\";import se from\"./Graphics3DFeatureStore.js\";import ae from\"./Graphics3DGraphic.js\";import ne from\"./Graphics3DGraphicCreationContext.js\";import{Graphics3DSymbolCreationContext as oe}from\"./Graphics3DSymbolCreationContext.js\";import{make as le}from\"./Graphics3DSymbolFactory.js\";import he from\"./Graphics3DWebStyleSymbol.js\";import{GraphicStateTracking as de}from\"./GraphicStateTracking.js\";import{computeCentroid as pe}from\"./graphicUtils.js\";import{SpatialIndex2D as ce}from\"./SpatialIndex2D.js\";import{averageSymbolComplexities as ye,defaultSymbolComplexity as me}from\"./symbolComplexity.js\";import{StageLayerElevationProvider as ge}from\"../support/StageLayerElevationProvider.js\";import{toBoundingRect as ue}from\"../../support/extentUtils.js\";import{PropertiesPool as be}from\"../../support/PropertiesPool.js\";import{GridLocalOriginFactory as fe}from\"../../webgl-engine/lib/GridLocalOriginFactory.js\";import{WebGLLayer as ve}from\"../../webgl-engine/lib/WebGLLayer.js\";import{ImmediateTask as Ce,noBudget as Se,TaskPriority as we}from\"../../../support/Scheduler.js\";import Ge from\"../../../../geometry/Extent.js\";import xe from\"../../../../geometry/Point.js\";import Pe from\"../../../../symbols/LabelSymbol3D.js\";import _e from\"../../../../symbols/TextSymbol.js\";import Re from\"../../../../symbols/WebStyleSymbol.js\";var De;const Ie=V(),Ee=M(),Ue=a.getLogger(\"esri.views.3d.layers.graphics.Graphics3DCore\");let Oe=De=class extends i{constructor(e){super(e),this.propertiesPool=new be({computedExtent:Ge},this),this.computedExtent=null,this.currentRenderer=null,this.rendererHasGeometryOperations=!1,this.graphicStateTracking=null,this.symbolCreationContext=new oe(((e,t)=>this._frameTask.schedule(e,t))),this.graphics3DGraphics=new Map,this.stageLayer=null,this.stage=null,this.graphicsDrapedUids=new Set,this.graphicsBySymbol=new Map,this.symbolConversionCache=new Map,this.symbols=new Map,this.graphicsWithoutSymbol=new Map,this.graphicsWaitingForSymbol=new Set,this._handles=new s,this._frameTask=Ce,this.suspendSymbolCleanup=!1,this._spatialReference=null,this.arcadeOnDemand=null,this.rendererChangeAbortController=null,this.elevationInfoChangeAbortController=null,this.setupAbortController=null,this.elevationAlignment=null,this.scaleVisibility=null,this.filterVisibility=null,this._spatialIndex=null,this.extentPadding=0,this._updatingPendingLoadedGraphicsChange=null,this.featureStore=null,this.deconflictor=null,this.labeler=null,this.objectStates=null,this.viewElevationProvider=null,this.stageLayerElevationProvider=null,this.sharedSymbolResourcesOwnerHandle=null,this.whenGraphics3DGraphicRequests={},this.pendingUpdates=new Map,this.numberOfGraphics=0,this.numberOfGraphicsProvidingElevation=0,this.pendingAdds=0,this.pendingRemoves=0,this.pendingUpdatesPool=new u({allocator:e=>e||new je,deallocator:e=>(e.clear(),e)}),this.symbolWarningLogged=!1,this.geometryWarningLogged=!1,this.objectIdInvisibleSet=new Set,this._whenSymbolRemoved=new u,this.preferredUpdatePolicy=1,this.forcedUpdatePolicy=null,this.elevationFeatureExpressionEnabled=!0,this.owner=null,this.layer=null,this.graphicSymbolSupported=!0,this.getRenderingInfoWithoutRenderer=!1,this.hasZ=null,this.hasM=null,this._usedMemory=0,this._visible=void 0,this._startCreateGraphics=!1}get spatialIndex(){return this._spatialIndex||(this._spatialIndex=new ce({objectIdField:this.owner.layer&&this.owner.layer.objectIdField,spatialReference:this._spatialReference,hasZ:this.hasZ,hasM:this.hasM}),this._spatialIndex.setup(Array.from(this.graphics3DGraphics.values()))),this._spatialIndex.update(),this._spatialIndex}get effectiveUpdatePolicy(){return h(this.currentRenderer)&&\"dictionary\"===this.currentRenderer.type?0:d(this.forcedUpdatePolicy,this.preferredUpdatePolicy)}get updating(){var e,t;return!!(this.graphicsWaitingForSymbol.size>0||this.running||null!=(e=this.elevationAlignment)&&e.updating||h(this.scaleVisibility)&&this.scaleVisibility.updating||null!=(t=this.filterVisibility)&&t.updating||this.rendererChangeAbortController||this.elevationInfoChangeAbortController||this._updatingPendingLoadedGraphicsChange||this._frameTask.updating)}get running(){var e;return this.pendingUpdates.size>0||!(null==(e=this._spatialIndex)||!e.updating)}get suspendedOrOutsideOfView(){var e;return this.owner.suspended||(null==(e=this.owner.suspendInfo)?void 0:e.outsideOfView)}get updatingRemaining(){var e,t;return this.updating?this.pendingUpdates.size+.1*((null==(e=this._spatialIndex)?void 0:e.updatingRemaining)||0)+.1*((null==(t=this.elevationAlignment)?void 0:t.updatingRemaining)||0):0}get displayFeatureLimit(){const e=this.owner&&this.owner.view&&this.owner.view.qualitySettings,t=e?e.graphics3D.minTotalNumberOfFeatures:0,i=e?e.graphics3D.maxTotalNumberOfFeatures:0,r=e?e.graphics3D.maxTotalNumberOfPrimitives:0,s=this.averageSymbolComplexity,a=Math.max(1,h(s)?s.primitivesPerFeature:1),n=h(s)&&s.drawCallsPerFeature>0?i/s.drawCallsPerFeature*.3:i,o=Math.ceil(r/a),l=Math.max(t,Math.min(i,o,n)),d=this._get(\"displayFeatureLimit\");return d&&d.minimumTotalNumberOfFeatures===t&&d.maximumTotalNumberOfFeatures===i&&d.maximumTotalNumberOfPrimitives===r&&d.averageSymbolComplexity===s&&d.maximumNumberOfFeatures===l?d:{minimumTotalNumberOfFeatures:t,maximumTotalNumberOfFeatures:i,maximumTotalNumberOfPrimitives:r,averageSymbolComplexity:s,maximumNumberOfFeatures:l}}get averageSymbolComplexity(){const e=ye(this.symbolComplexities),t=this._get(\"averageSymbolComplexity\");return 0===e.numComplexities||h(t)&&(e.estimated&&(t.primitivesPerFeature>=e.primitivesPerFeature||t.primitivesPerCoordinate>=e.primitivesPerCoordinate||t.drawCallsPerFeature>=e.drawCallsPerFeature)||t.primitivesPerFeature===e.primitivesPerFeature&&t.primitivesPerCoordinate===e.primitivesPerCoordinate&&t.drawCallsPerFeature===e.drawCallsPerFeature)?t:e}get spatialReference(){return this._spatialReference}get usedMemory(){const e=h(this.averageSymbolComplexity)&&this.labelsEnabled?this.averageSymbolComplexity.memory.bytesPerFeatureLabel*this.numberOfGraphics:0;return this._usedMemory+e}get usedMemoryPerGraphic(){if(this._usedMemory&&this.numberOfGraphics)return Math.abs(this.pendingAdds-this.pendingRemoves)/this.numberOfGraphics>30?0:this._usedMemory/this.numberOfGraphics;if(h(this.averageSymbolComplexity)){const e=this.labelsEnabled?this.averageSymbolComplexity.memory.bytesPerFeatureLabel:0;return this.averageSymbolComplexity.memory.bytesPerFeature+e}return 0}get unprocessedMemoryEstimate(){return Math.max(0,(this.pendingAdds-this.pendingRemoves)*this.usedMemoryPerGraphic)}get symbolComplexities(){return this.currentRenderer?this.getSymbolComplexitiesUsedOrRenderer(this.currentRenderer):this.getSymbolComplexitiesUsed()}getConvertedSymbol(e){if(\"web-style\"===e.type)return e.clone();const t=this.symbolConversionCache.get(e.id);if(void 0!==t)return t;const i=ee(e,!0,!1,this.hasLabelingContext(e)),r=i.symbol||null;return r||i.error&&Ue.error(i.error.message),this.symbolConversionCache.set(e.id,r),r}getSymbolComplexitiesUsedOrRenderer(e){if(p(e))return[];const t=e.getSymbols(),i=\"backgroundFillSymbol\"in e&&e.backgroundFillSymbol;if(!(i||t&&t.length))return[];const r=[],s=this.getSymbolComplexityUsedOrRenderer(i);h(s)&&r.push(s);for(const a of t){const e=this.getSymbolComplexityUsedOrRenderer(a);h(e)&&r.push(e)}return r}getSymbolComplexityUsedOrRenderer(e){if(p(e))return null;const t=this.symbols.get(e.id);if(h(t))return t.complexity;const i=this.getConvertedSymbol(e);return i?me(i):null}getSymbolComplexitiesUsed(){const e=[];return this.symbols.forEach((t=>{h(t)&&e.push(t.complexity)})),e}initialize(){this._spatialReference=this.owner.view.spatialReference,this._set(\"featureStore\",new se({objectIdField:this.owner.layer&&this.owner.layer.objectIdField,hasZ:this.hasZ,hasM:this.hasM,spatialReference:this._spatialReference,getSpatialIndex:()=>this.spatialIndex,forAllGraphics:e=>this.graphics3DGraphics.forEach(e)}))}async setup(e){this.setupAbortController=b();const t=this.setupAbortController.signal;this._set(\"elevationAlignment\",e.elevationAlignment),this._set(\"scaleVisibility\",e.scaleVisibility),this._set(\"filterVisibility\",e.filterVisibility),this._set(\"deconflictor\",e.deconflictor),this._set(\"labeler\",e.labeler),this._set(\"objectStates\",e.objectStates);const i=this.owner.view;this.viewElevationProvider=new te(this._spatialReference,i),this.initializeStage(i,this.layer.uid),this.symbolCreationContext.sharedResources=i.sharedSymbolResources,this.sharedSymbolResourcesOwnerHandle=i.sharedSymbolResources.addGraphicsOwner(this.owner),h(this.currentRenderer)&&(this.symbolCreationContext.renderer=this.currentRenderer),this.symbolCreationContext.stage=this.stage,this.symbolCreationContext.streamDataRequester=i.sharedSymbolResources.streamDataRequester,this.symbolCreationContext.renderCoordsHelper=i.renderCoordsHelper,this.symbolCreationContext.layer=this.layer,this.symbolCreationContext.layerView=this.owner,this.symbolCreationContext.localOriginFactory=new fe(i.renderSpatialReference),this.symbolCreationContext.elevationProvider=i.elevationProvider,this.symbolCreationContext.notifyGraphicGeometryChanged=e=>this.notifyGraphicGeometryChanged(e),this.symbolCreationContext.notifyGraphicVisibilityChanged=e=>this.notifyGraphicVisibilityChanged(e);const r=ie(this.layer.elevationInfo,this.elevationFeatureExpressionEnabled);this.symbolCreationContext.featureExpressionInfoContext=await re(r,this._spatialReference,Ue),f(t),this.symbolCreationContext.screenSizePerspectiveEnabled=i.screenSizePerspectiveEnabled&&this.layer.screenSizePerspectiveEnabled,this.symbolCreationContext.slicePlaneEnabled=!!this.owner.slicePlaneEnabled,this.symbolCreationContext.physicalBasedRenderingEnabled=!!this.owner.view.qualitySettings.physicallyBasedRenderingEnabled;const s=\"layer\"in this.owner?[\"layer.screenSizePerspectiveEnabled,view.screenSizePerspectiveEnabled\"]:\"view.screenSizePerspectiveEnabled\";this._handles.add([this.watch(\"suspendedOrOutsideOfView\",(()=>this._frameTask.reschedule((()=>this.updateLayerVisibility())))),this.owner.watch(s,(()=>{const e=i.screenSizePerspectiveEnabled&&this.layer.screenSizePerspectiveEnabled;e!==this.symbolCreationContext.screenSizePerspectiveEnabled&&(this.symbolCreationContext.screenSizePerspectiveEnabled=e,this.recreateAllGraphics())})),this.owner.watch(\"slicePlaneEnabled\",(e=>this.slicePlaneEnabledChange(!!e))),this.owner.view.watch(\"pixelRatio\",(()=>this.pixelRatioChange())),this.owner.view.watch(\"qualitySettings.physicallyBasedRenderingEnabled\",(e=>this.physicalBasedRenderingChange(e))),G(i.basemapTerrain,\"tilingScheme\",(e=>{e.spatialReference.equals(this.symbolCreationContext.overlaySR)||(this.symbolCreationContext.overlaySR=i.basemapTerrain.spatialReference),this._handles.has(\"loaded-graphics\")?this.recreateAllGraphics():this._handles.add([R(this.owner,\"loadedGraphics\",\"change\",(e=>this.graphicsCollectionChanged(e)),(()=>this.recreateAllGraphics())),R(this.owner,\"loadedGraphics\",\"after-changes\",(()=>this._signalUpdatingDuringAsyncLoadedGraphicsChange()),(()=>this._signalUpdatingDuringAsyncLoadedGraphicsChange()))],\"loaded-graphics\")})),x(this,\"asyncUpdates\",(()=>this.runTask(Se)),!0),P(this,\"effectiveUpdatePolicy\",(e=>{h(this.stageLayer)&&(this.stageLayer.updatePolicy=e),this.symbolCreationContext.isAsync=0===this.effectiveUpdatePolicy,1===e&&this.runTask(Se)}),!0)]),this._frameTask=i.resourceController.scheduler.registerTask(we.GRAPHICS_CORE,this),this.owner.layer&&\"featureReduction\"in this.owner.layer&&this._handles.add(this.owner.watch(\"layer.featureReduction\",(()=>this.deconflictor.featureReductionChange()))),this.notifyChange(\"averageSymbolComplexity\");try{await this.rendererChange(this.layer.renderer)}catch{}f(t),this.setupAbortController=null}abortSetup(){this.setupAbortController&&(this.setupAbortController.abort(),this.setupAbortController=null)}destroy(){this.abortSetup(),this.abortRendererChange(),this.abortElevationInfoChange(),this.owner.view.deconflictor.removeGraphicsOwner(this),this.owner.view.labeler.removeGraphicsOwner(this),this._updatingPendingLoadedGraphicsChange&&(this._updatingPendingLoadedGraphicsChange.remove(),this._updatingPendingLoadedGraphicsChange=null),this.clear(),h(this.graphicStateTracking)&&(this.graphicStateTracking.destroy(),this.graphicStateTracking=null),this.stage&&(this.stage.remove(this.stageLayer),this.stageLayer=null,this.stage=null),this._handles=c(this._handles),this._frameTask.remove(),this._frameTask=Ce,this._spatialReference=null,this._set(\"owner\",null);for(const e in this.whenGraphics3DGraphicRequests)this.whenGraphics3DGraphicRequests[e].reject(new r(\"graphic:layer-destroyed\",\"Layer has been destroyed\"));this.whenGraphics3DGraphicRequests=null,this.sharedSymbolResourcesOwnerHandle=y(this.sharedSymbolResourcesOwnerHandle),this.propertiesPool=c(this.propertiesPool),this.pendingUpdatesPool=null,this.symbolConversionCache.clear(),this.objectIdInvisibleSet.clear(),this._spatialIndex=c(this._spatialIndex),this.featureStore&&(this.featureStore.destroy(),this._set(\"featureStore\",null))}clear(){var e;this.objectStates&&this.objectStates.allGraphicsDeleted(),h(this.graphicStateTracking)&&this.graphicStateTracking.allGraphicsDeleted(),this.graphics3DGraphics.forEach((e=>e.destroy())),null==(e=this._spatialIndex)||e.clear(),this.graphics3DGraphics.clear(),this.numberOfGraphics=0,this._usedMemory=0,this.updateLayerVisibility(),this.symbols.forEach((e=>{h(e)&&e.destroy()})),this.symbols.clear(),this.graphicsBySymbol.clear(),this.graphicsWithoutSymbol.clear(),this.graphicsWaitingForSymbol.clear(),this.pendingUpdates.clear(),this.pendingUpdatesPool.clear(),this.pendingAdds=0,this.pendingRemoves=0,this.notifyChange(\"updating\"),this.notifyChange(\"running\"),this.notifyChange(\"updatingRemaining\"),this.featureStore.events.emit(\"changed\")}initializeStage(e,t){this.stage=e._stage,this.stageLayer=new ve({isPickable:!this.suspendedOrOutsideOfView,updatePolicy:this.effectiveUpdatePolicy},t),this.stage.add(this.stageLayer);const i=this.stageLayer.events;i.on(\"objectTransformation\",(e=>this.notifyGraphicGeometryChanged(e.metadata.graphicUid))),i.on(\"visibilityChanged\",(e=>this.notifyGraphicVisibilityChanged(e.metadata.graphicUid))),i.on(\"objectGeometryAdded\",(e=>this.notifyGraphicGeometryChanged(e.object.metadata.graphicUid))),i.on(\"objectGeometryRemoved\",(e=>this.notifyGraphicGeometryChanged(e.object.metadata.graphicUid))),i.on(\"vertexAttrsUpdated\",(e=>this.notifyGraphicGeometryChanged(e.object.metadata.graphicUid)))}notifyGraphicGeometryChanged(e){if(p(this.graphicStateTracking))return;const t=this.graphics3DGraphics.get(e);t&&this.graphicStateTracking.updateGraphicGeometry(t)}notifyGraphicVisibilityChanged(e){if(p(this.graphicStateTracking))return;const t=this.graphics3DGraphics.get(e);t&&this.graphicStateTracking.updateGraphicVisibility(t)}updateLayerVisibility(){const e=this.displayFeatureLimit.maximumNumberOfFeatures,t=this.numberOfGraphics>e*Le,i=!this.suspendedOrOutsideOfView&&!t;i!==this._visible&&(this._visible=i,i?(this.stageLayer.isPickable=!0,this.updateAllGraphicsVisibility()):(this.stageLayer.isPickable=!1,this.hideAllGraphics()),this.updateStageLayerVisibility())}updateStageLayerVisibility(){this.stageLayer.isVisible=this._visible&&(null==this.layer.opacity||this.layer.opacity>0)}getGraphics3DGraphicById(e){return this.graphics3DGraphics.get(e)}getGraphics3DGraphicByObjectId(e){var t;return null!=(t=this.owner.layer)&&t.objectIdField?this._findGraphics3DGraphicByObjectId(e):null}_getGraphicObjectID(e,t=this.owner.layer&&this.owner.layer.objectIdField){return H(e,t)}get graphics3DGraphicsByObjectID(){const e=this.owner.layer&&this.owner.layer.objectIdField;if(!e)return null;const t=new Map;return this.graphics3DGraphics.forEach((i=>{if(!i)return;const r=i.graphic,s=this._getGraphicObjectID(r,e);h(s)&&t.set(s,i)})),t}get labelsEnabled(){return!(!this.labeler||!this.labeler.layerLabelsEnabled())}async updateLabelingInfo(e){const t=this.deconflictor&&this.deconflictor.labelingInfoChange(e),i=this.labeler&&this.labeler.labelingInfoChange(e);await v([t,i])}updateVisibilityInfo(){this.deconflictor&&this.deconflictor.labelingInfoChange(),this.labeler&&this.labeler.visibilityInfoChange()}get symbolUpdateType(){if(this.pendingUpdates.size>0)return\"unknown\";let e=0,t=0;return n(this.symbols,((i,r)=>{if(h(i)){const s=i.getFastUpdateStatus();if(s.loading>0)return!0;this.graphicsBySymbol.has(r)&&(t+=s.fast,e+=s.slow)}return!1}))?\"unknown\":t>=0&&0===e?\"fast\":e>=0&&0===t?\"slow\":\"mixed\"}runTask(e){this._frameTask.processQueue(e),this._applyPendingUpdates(e),this.notifyChange(\"running\"),this.running||this.notifyChange(\"updating\"),this.notifyChange(\"updatingRemaining\")}setObjectIdVisibility(e,t){t?this.objectIdInvisibleSet.delete(e):this.objectIdInvisibleSet.add(e);const i=this._findGraphics3DGraphicByObjectId(e);h(i)&&this._updateUserVisibility(i)}_findGraphics3DGraphicByObjectId(e){return o(this.graphics3DGraphics,(t=>this._getGraphicObjectID(t.graphic)===e))}_updateUserVisibility(e){if(p(e))return!1;const t=e.graphic,i=this._getGraphicObjectID(t),r=t.visible&&!this.owner.suspended&&(p(i)||!this.objectIdInvisibleSet.has(i));return e.setVisibilityFlag(0,r,0)}whenGraphics3DGraphic(e){const t=this.graphics3DGraphics.get(e.uid);if(t)return Promise.resolve(t);const i=this.whenGraphics3DGraphicRequests[e.uid];if(i)return i.promise;const r=C();return this.whenGraphics3DGraphicRequests[e.uid]=r,r.promise}async boundsForGraphics3DGraphic(e,t){const i=this._spatialReference,r=this.owner.view.renderSpatialReference,s=this.owner.view.basemapTerrain.spatialReference,a=(e,t,s)=>T(e,r,t,e,i,t,s),n=(e,t,r)=>T(e,s,t,e,i,t,r),o=this.viewElevationProvider?{service:this.viewElevationProvider,useViewElevation:h(t)&&t.useViewElevation,minDemResolution:h(t)&&t.minDemResolution,minDemResolutionForPoints:this.owner.view.resolution}:null,l=await e.getProjectedBoundingBox(a,n,o,m(t,\"signal\"));if(!l)return null;const p=l.boundingBox;if(l.requiresDrapedElevation){const e=this.symbolCreationContext.elevationProvider;if(e){W(p,Ie);const t=d(e.getElevation(Ie[0],Ie[1],0,i,\"ground\"),0);p[2]=Math.min(p[2],t),p[5]=Math.max(p[5],t)}}return{boundingBox:p,screenSpaceObjects:l.screenSpaceObjects}}whenGraphicBounds(e,t){return _(this.owner,\"loadedGraphics\").then((()=>{const t=this.owner.layer&&this.owner.layer.objectIdField,i=this.owner.loadedGraphics.find((i=>i===e||t&&i.attributes&&e.attributes&&i.attributes[t]===e.attributes[t]));if(i)return this.whenGraphics3DGraphic(i);throw new r(\"internal:graphic-not-part-of-view\",\"Graphic is not part of this view\")})).then((e=>this.boundsForGraphics3DGraphic(e,t)))}computeAttachmentOrigin(e,t){const i=this.graphics3DGraphics.get(e.uid);if(!i)return null;const r=i.computeAttachmentOrigin();if(0===r.render.num&&0===r.draped.num)return null;O(Ve,0,0,0);let s=0;if(r.render.num>0){if(!A(r.render.origin,this.symbolCreationContext.renderCoordsHelper.spatialReference,Ae,t))return null;j(Ve,Ve,Ae),s++}if(r.draped.num>0){const[e,i]=r.draped.origin,a=d(this.viewElevationProvider.getElevation(e,i,\"ground\"),0);if(O(Ae,e,i,a),!A(Ae,this.viewElevationProvider.spatialReference,Ae,t))return null;j(Ve,Ve,Ae),s++}return s>1&&L(Ve,Ve,1/s),new xe({x:Ve[0],y:Ve[1],z:Ve[2],spatialReference:t})}getSymbolLayerSize(e,t){const i=this.symbols.get(e.id);if(p(i))throw new r(\"internal:symbol-not-part-of-view\",\"Symbol is not part of this view\");const s=e.symbolLayers.indexOf(t);if(-1===s)throw new r(\"internal:missing-symbol-layer\",\"Symbol layer is not in symbol\");const a=i.getSymbolLayerSize(s);if(null==a)throw new r(\"internal:missing-size\",\"Symbol layer has no valid size\");return a}graphicsCollectionChanged(e){this._startCreateGraphics&&(this.add(e.added),this.remove(e.removed))}graphicUpdateHandler(e){const t=e.graphic.uid,i=this.graphics3DGraphics.get(t),r=this.graphicsWithoutSymbol.get(t);if(i||r)switch(e.property){case\"visible\":this.graphicUpdateVisibleHandler(i);break;case\"geometry\":this.graphicUpdateGeometryHandler(i,e);break;case\"symbol\":this.graphicUpdateSymbolHandler(i,e)}}graphicUpdateGeometryHandler(e,t){const i=t.graphic.geometry;if(p(i))return void this.recreateGraphic(t.graphic);if(p(e)){const e=t.graphic.symbol&&t.graphic.symbol.id;if(e){const t=this.symbols.get(e);if(h(t)&&0===t.loadStatus)return}return void this.recreateGraphic(t.graphic)}const r=e.graphics3DSymbol;!p(t.newValue)&&r.updateGeometry(e,t.newValue)||this.recreateGraphic(e.graphic),this.expandComputedExtent(i)}graphicUpdateSymbolHandler(e,t){const i=t.graphic,r=h(e)?e.graphics3DSymbol:h(t.oldValue)?this.symbols.get(t.oldValue.id):null;if(p(r)||p(t.newValue))return void this.recreateGraphic(i);const s=r.symbol,a=this.getConvertedSymbol(t.newValue);if(a.type!==s.type||\"web-style\"===a.type||\"web-style\"===s.type)return void this.recreateGraphic(i);const n=this.graphicsBySymbol.get(s.id);if(n&&1!==n.size)return void this.recreateGraphic(i);const o=E(s,a);if(p(o))return void this.updateSymbolMapping(s.id,a);const l={diff:o,graphics3DGraphicPatches:[],symbolStatePatches:[]};if(r.prepareSymbolPatch(l),!U(l.diff))return void this.recreateGraphic(i);const d=this._getRenderingInfo(i);if(p(d))return void this.recreateGraphic(i);const c=r.extentPadding;for(const h of l.symbolStatePatches)h();if(c!==r.extentPadding&&this.recomputeExtentPadding(),h(e))for(const h of l.graphics3DGraphicPatches)h(e,d);this.updateSymbolMapping(s.id,a)}graphicUpdateVisibleHandler(e){this._updateUserVisibility(e)&&(this.labeler&&this.owner.view.labeler.setDirty(),this.owner.view.deconflictor.setDirty())}recreateGraphics(e){this.suspendSymbolCleanup=!0,this.remove(e),this.add(e),this.suspendSymbolCleanup=!1,1===this.effectiveUpdatePolicy&&this._cleanupSymbols()}recreateGraphic(e){this.recreateGraphics([e])}_beginGraphicUpdate(e){this.graphicsWaitingForSymbol.add(e.uid),1===this.graphicsWaitingForSymbol.size&&this.notifyChange(\"updating\")}_endGraphicUpdate(e){e&&(this.graphicsWaitingForSymbol.delete(e.uid),0===this.graphicsWaitingForSymbol.size&&(this._cleanupSymbols(),this.notifyChange(\"updating\")))}recomputeExtentPadding(){let e=0;this.symbols.forEach((t=>{h(t)&&(e=Math.max(e,t.extentPadding))})),this._set(\"extentPadding\",e)}expandComputedExtent(e){const t=Ee,i=e.spatialReference;$(e,t);const r=this._spatialReference,s=De.tmpVec;if(i.equals(r)||F(t[0],t[1],0,i,s,r)&&(t[0]=s[0],t[1]=s[1],F(t[3],t[4],0,i,s,r),t[3]=s[0],t[4]=s[1]),!(l(t[0])&&l(t[3])&&l(t[1])&&l(t[4])))return;const a=this.computedExtent;let n=null;const o=l(t[2])&&l(t[5]),h=o&&(!a||null==a.zmin||t[2]<a.zmin),d=o&&(!a||null==a.zmax||t[5]>a.zmax);if(a){(t[0]<a.xmin||t[1]<a.ymin||t[3]>a.xmax||t[4]>a.ymax||h||d)&&(n=this.propertiesPool.get(\"computedExtent\"),n.xmin=Math.min(t[0],a.xmin),n.ymin=Math.min(t[1],a.ymin),n.xmax=Math.max(t[3],a.xmax),n.ymax=Math.max(t[4],a.ymax),n.spatialReference=r)}else n=this.propertiesPool.get(\"computedExtent\"),n.xmin=t[0],n.ymin=t[1],n.xmax=t[3],n.ymax=t[4],n.spatialReference=r;n&&(h&&(n.zmin=t[2]),d&&(n.zmax=t[5]),this._set(\"computedExtent\",n))}abortElevationInfoChange(){this.elevationInfoChangeAbortController&&(this.elevationInfoChangeAbortController.abort(),this.elevationInfoChangeAbortController=null)}async elevationInfoChange(){this.abortElevationInfoChange();const e=b();this.elevationInfoChangeAbortController=e;const t=ie(this.layer.elevationInfo,this.elevationFeatureExpressionEnabled);this.symbolCreationContext.featureExpressionInfoContext=await re(t,this._spatialReference,Ue),f(e),this.elevationInfoChangeAbortController=null,this.labeler&&this.labeler.elevationInfoChange(),this.forEachGraphics3DSymbol(((e,t,i)=>{e.globalPropertyChanged(\"elevationInfo\",t)?t.forEach((e=>{const t=e.graphic,i=e.labelGraphics;for(const r of i){r.graphics3DSymbolLayer.updateGraphicElevationContext(t,r)}})):this._recreateSymbol(i)})),this.updateStageLayerElevationProvider(),this.elevationAlignment&&this.elevationAlignment.elevationInfoChange()}updateStageLayerElevationProvider(){this.stageLayerElevationProvider?(this.layer.elevationInfo&&\"relative-to-scene\"===this.layer.elevationInfo.mode||0===this.numberOfGraphicsProvidingElevation)&&(this.owner.view.elevationProvider.unregister(this.stageLayerElevationProvider),this.stageLayerElevationProvider.dispose(),this.stageLayerElevationProvider=null):(!this.layer.elevationInfo||this.layer.elevationInfo&&\"relative-to-scene\"!==this.layer.elevationInfo.mode)&&this.numberOfGraphicsProvidingElevation>0&&(this.stageLayerElevationProvider=new ge({layer:this.layer,stageLayer:this.stageLayer,view:this.owner.view}),this.owner.view.elevationProvider.register(\"scene\",this.stageLayerElevationProvider))}clearSymbolsAndGraphics(){this.clear(),this.filterVisibility&&this.filterVisibility.clear(),this.labeler&&this.labeler.reset(),this.deconflictor&&this.deconflictor.clear(),this.elevationAlignment&&this.elevationAlignment.clear(),this.stageLayer&&this.stageLayer.invalidateSpatialQueryAccelerator(),this.stageLayerElevationProvider&&(this.owner.view.elevationProvider.unregister(this.stageLayerElevationProvider),this.stageLayerElevationProvider.dispose(),this.stageLayerElevationProvider=null)}startCreateGraphics(){this._startCreateGraphics=!0,this.recreateAllGraphics()}recreateAllGraphics(){this._startCreateGraphics&&(this.clearSymbolsAndGraphics(),this._set(\"computedExtent\",null),this.symbolCreationContext.screenSizePerspectiveEnabled=this.owner.view.screenSizePerspectiveEnabled&&this.layer.screenSizePerspectiveEnabled,this.symbolCreationContext.slicePlaneEnabled=!!this.owner.slicePlaneEnabled,this.owner.loadedGraphics&&this.owner.loadedGraphics.length&&this.owner.view.basemapTerrain.tilingScheme&&this.add(this.owner.loadedGraphics.toArray()))}_recreateSymbol(e){const t=this.graphicsBySymbol.get(e),i=[];t&&(t.forEach(((e,t)=>{var r;const s=e.usedMemory;this._conditionalRemove(e,t),null==(r=this._spatialIndex)||r.remove(e),i.push(e.graphic),e.destroy(),this.removeGraphics3DGraphic(t,s),this.updateLayerVisibility(),this.featureStore.events.emit(\"changed\")})),this.graphicsBySymbol.set(e,new Map));const r=this.symbols.get(e);h(r)&&r.destroy(),this.symbols.delete(e),this.add(i)}_conditionalRemove(e,t){e.isDraped&&this.graphicsDrapedUids.delete(t),this.objectStates&&this.objectStates.removeGraphic(e),this.labeler&&this.labeler.removeGraphic(e),this.deconflictor&&this.deconflictor.removeGraphic(e),h(this.graphicStateTracking)&&this.graphicStateTracking.removeGraphic(e)}add(e){e&&0!==e.length&&(this.owner.view.basemapTerrain&&this.owner.view.basemapTerrain.tilingScheme?(0===this._updatePolicyForGraphics(e)?this._addDelayed(e):this._addImmediate(e),this.notifyChange(\"updating\")):Ue.error(\"#add()\",\"Cannot add graphics before terrain surface has been initialized\"))}_updatePolicyForGraphics(e){if(1===this.effectiveUpdatePolicy&&(\"mesh\"===this.layer.geometryType||null==this.layer.geometryType))for(const t of e)if(h(t.geometry)&&\"mesh\"===t.geometry.type&&!t.geometry.loaded)return 0;return this.effectiveUpdatePolicy}_addImmediate(e){this.geometryWarningLogged=!1,this.symbolWarningLogged=!1;for(const t of e)this._addGraphic(t,this._getRenderingInfo(t,Ue),1);this._cleanupSymbols(),this.labeler&&(this.owner.view.labeler.setDirty(),this._cleanupSymbols()),this.owner.view.deconflictor.setDirty()}_addDelayed(e){for(const t of e){const e=t.uid;let i=this.pendingUpdates.get(e);i?i.add?0!==i.state&&i.abortController.abort():this.pendingAdds++:(i=this.pendingUpdatesPool.pushNew(),this.pendingAdds++,this.pendingUpdates.set(e,i)),i.add=t}this.notifyChange(\"running\"),this.notifyChange(\"updatingRemaining\")}remove(e){0===this.effectiveUpdatePolicy?this._removeDelayed(e):this._removeImmediate(e),this.notifyChange(\"updating\")}_removeImmediate(e){for(const t of e)this._removeGraphic(t);this._cleanupSymbols(),this.labeler&&this.owner.view.labeler.setDirty(),this.owner.view.deconflictor.setDirty()}_removeDelayed(e){for(const t of e){const e=t.uid,i=this.pendingUpdates.get(e);if(i)i.add&&(i.remove?i.add=null:this.pendingUpdates.delete(e),1===i.state&&i.abortController.abort(),this.pendingAdds--);else{const i=this.pendingUpdatesPool.pushNew();i.remove=t,this.pendingUpdates.set(e,i),this.pendingRemoves++}}0===this.pendingUpdates.size&&this._finishPendingUpdates(),this.notifyChange(\"running\"),this.notifyChange(\"updatingRemaining\")}_finishPendingUpdates(){this.pendingUpdatesPool.clear(),this._cleanupSymbols(),(this.pendingAdds||this.pendingRemoves)&&Ue.warn(\"pendingAdds/Removes in inconsistent state!\"),this.pendingAdds=0,this.pendingRemoves=0}_applyPendingUpdates(e){var t;if(this.geometryWarningLogged=!1,this.symbolWarningLogged=!1,0===this.pendingUpdates.size&&null!=(t=this._spatialIndex)&&t.updating)this._spatialIndex.update();else{for(const[t,i]of this.pendingUpdates){if(e.done)break;i.add&&0===i.state&&this._processPendingUpdateNew(i);let r=this.effectiveUpdatePolicy;if(!i.remove||i.add&&2!==i.state||(this.pendingRemoves--,e.madeProgress(),this._removeGraphic(i.remove),i.remove=null,r=1),i.add)switch(i.state){case 2:this._addGraphic(i.add,i.renderingInfo,r),i.add=null,this.pendingAdds--,e.madeProgress();break;case 3:i.add=null,this.pendingAdds--}null==i.remove&&null==i.add&&this.pendingUpdates.delete(t)}0===this.pendingUpdates.size&&(this._finishPendingUpdates(),this.notifyChange(\"running\"))}}_processPendingUpdateNew(e){if(!e.add)return void(e.state=2);const t=e.add.geometry;h(t)&&\"mesh\"===t.type&&!t.loaded?this._processPendingUpdateNewMesh(e,t):this._processPendingUpdateNewRenderingInfo(e)}_processPendingUpdateNewMesh(e,t){e.state=1,e.abortController=b();const i=e.abortController.signal;t.load({signal:i}).then((()=>{e.abortController=null,this._processPendingUpdateNewRenderingInfo(e)}),(t=>this._processPendingUpdateNewError(e,t)))}_processPendingUpdateNewError(e,t){e.abortController=null,S(t)?e.state=0:e.state=3}_processPendingUpdateNewRenderingInfo(e){if(p(this.layer.renderer)||\"dictionary\"!==this.layer.renderer.type)return e.renderingInfo=this._getRenderingInfo(e.add,Ue),void(e.state=2);e.state=1,e.abortController=b(),this._getRenderingInfoAsync(e.add,{signal:e.abortController.signal}).then((t=>{p(t)||p(t.symbol)?(Ue&&!this.symbolWarningLogged&&(this.symbolWarningLogged=!0,Ue.warn(`Graphic in layer ${this.layer.id} has no symbol and will not render`)),e.renderingInfo=null):e.renderingInfo=t,e.state=2}),(t=>{e.abortController=null,S(t)?e.state=0:e.state=3}))}_addGraphic(e,t,i){if(this.graphicsWithoutSymbol.set(e.uid,e),p(t)||p(t.symbol)||!Z(e))return;const r=t.symbol,s=this.getOrCreateGraphics3DSymbol(r,t.renderer);if(p(s))return;this.expandComputedExtent(e.geometry),this._beginGraphicUpdate(e);const a=new ne(e,t,this.layer);let n=!1;const o=e=>{e===s.symbol.id&&(n=!0)};this._whenSymbolRemoved.push(o);const l=()=>{if(!this.destroyed){if(this._whenSymbolRemoved.removeUnordered(o),!(n||s.destroyed||this.graphicSymbolSupported&&e.symbol&&e.symbol.id!==s.symbol.id)){if(this.graphicsWaitingForSymbol.has(e.uid)){const e=this.createGraphics3DGraphic(s,a);this._spatialIndex&&h(e)&&this._spatialIndex.add(e)}this._endGraphicUpdate(e)}--s.referenced,this.featureStore.events.emit(\"changed\"),this.labeler&&this.owner.view.labeler.setDirty()}},d=t=>{this.destroyed||(this._whenSymbolRemoved.removeUnordered(o),n||(S(t)?this.add([e]):s.destroyed||this._endGraphicUpdate(e)))};0===i?s.load((()=>this._frameTask.schedule(l)),(e=>this._frameTask.schedule((()=>d(e))))):s.load(l,d)}_removeGraphic(e){const t=e.uid,i=this.graphics3DGraphics.get(t);if(i){var r;i.graphics3DSymbol.onRemoveGraphic(i);const e=i.usedMemory,s=i.isElevationSource;this._conditionalRemove(i,t),null==(r=this._spatialIndex)||r.remove(i);const a=i.graphics3DSymbol.symbol.id;this.graphicsBySymbol.get(a).delete(t),this.graphicsWithoutSymbol.delete(t),this.removeGraphics3DGraphic(t,e,s),i.destroy(),this.featureStore.events.emit(\"changed\")}else this.graphicsWithoutSymbol.delete(t),this.graphicsWaitingForSymbol.delete(t),0===this.graphicsWaitingForSymbol.size&&(this._cleanupSymbols(),this.notifyChange(\"updating\"))}hasLabelingContext(e){if(e instanceof Pe||e instanceof _e){const t=this.symbolCreationContext.layer;return!!t.labelingInfo&&t.labelingInfo.some((t=>t.symbol===e))}return!1}hasValidSymbolCreationContext(e){return!(e instanceof Pe&&!this.hasLabelingContext(e))||(Ue.error(\"LabelSymbol3D is only valid as part of a LabelClass. Using LabelSymbol3D as a renderer symbol is not supported.\"),!1)}_getRenderingInfo(e,t){const i=e.geometry;if(p(i))return t&&!this.geometryWarningLogged&&(this.geometryWarningLogged=!0,t.warn(`Graphic in layer ${this.layer.id} has no geometry and will not render`)),null;if(!k(i.spatialReference,this._spatialReference))return t&&!this.geometryWarningLogged&&(this.geometryWarningLogged=!0,t.warn(`Graphic in layer ${this.layer.id} has incompatible spatial reference and will not render`)),null;if(!this.graphicSymbolSupported&&h(e.symbol))return t&&!this.symbolWarningLogged&&(this.symbolWarningLogged=!0,t.warn(`Graphic in layer ${this.layer.id} is not allowed to have a symbol, use a renderer instead`)),null;const r=this.rendererHasGeometryOperations?Q(e,this.layer):e;let s;if(this.owner.getRenderingInfo&&(this.getRenderingInfoWithoutRenderer||h(this.currentRenderer)))s=this.owner.getRenderingInfo(r,this.currentRenderer,g(this.arcadeOnDemand));else{s={symbol:r.symbol||Y(r.geometry)}}return p(s)||p(s.symbol)?(t&&!this.symbolWarningLogged&&(this.symbolWarningLogged=!0,t.warn(`Graphic in layer ${this.layer.id} has no symbol and will not render`)),null):s}_getRenderingInfoAsync(e,t){const i=e.geometry;if(p(i))return Ue&&!this.geometryWarningLogged&&(this.geometryWarningLogged=!0,Ue.warn(`Graphic in layer ${this.layer.id} has no geometry and will not render`)),null;if(!this.graphicSymbolSupported&&h(e.symbol))return Ue&&!this.symbolWarningLogged&&(this.symbolWarningLogged=!0,Ue.warn(`Graphic in layer ${this.layer.id} is not allowed to have a symbol, use a renderer instead`)),null;const r=this.rendererHasGeometryOperations?Q(e,this.layer):e;return this.owner.getRenderingInfoAsync(r,g(this.currentRenderer),g(this.arcadeOnDemand),t)}createGraphics3DSymbol(e,t){if(!this.hasValidSymbolCreationContext(e))return null;const i=this.getConvertedSymbol(e);if(!i)return null;let r;if(h(t)&&\"backgroundFillSymbol\"in t&&t.backgroundFillSymbol){const e=ee(t.backgroundFillSymbol,!1,!0);e.symbol&&\"web-style\"!==e.symbol.type&&(r=e.symbol.symbolLayers)}const s=le(i,this.symbolCreationContext,r);return s.load((()=>{const e=s.extentPadding;e>this.extentPadding&&this._set(\"extentPadding\",e),this.notifyChange(\"averageSymbolComplexity\")}),(()=>{})),s}getOrCreateGraphics3DSymbol(e,t){let i=this.symbols.get(e.id);return void 0===i&&(i=e instanceof Re?new he(e,(e=>this._frameTask.schedule(e)),(e=>this.createGraphics3DSymbol(e,t))):this.createGraphics3DSymbol(e,t),this.symbols.set(e.id,i)),h(i)&&++i.referenced,i}trackGraphicState(e){return p(this.graphicStateTracking)&&(this.graphicStateTracking=new de(this)),this.graphicStateTracking.add(e)}addGraphics3DGraphic(e){this._usedMemory+=e.usedMemory,this.graphics3DGraphics.set(e.graphic.uid,e),this.numberOfGraphics++,e.isElevationSource&&(this.numberOfGraphicsProvidingElevation++,this.updateStageLayerElevationProvider()),this.updateLayerVisibility()}removeGraphics3DGraphic(e,t,i=!1){this._usedMemory-=t,this.graphics3DGraphics.delete(e),this.numberOfGraphics--,i&&(this.numberOfGraphicsProvidingElevation--,this.updateStageLayerElevationProvider()),this.updateLayerVisibility()}createGraphics3DGraphic(e,t){const i=t.graphic;if(this.graphicsWithoutSymbol.delete(i.uid),!this.symbols.has(e.symbol.id))return this.add([i]),null;if(this.graphics3DGraphics.has(i.uid))return null;const r=e.createGraphics3DGraphic(t);if(p(r))return null;this.addGraphics3DGraphic(r);const s=e.symbol.id;this.graphicsBySymbol.has(s)||this.graphicsBySymbol.set(s,new Map),this.graphicsBySymbol.get(s).set(i.uid,r);r.isDraped&&this.graphicsDrapedUids.add(i.uid),r.centroid=null,h(i.geometry)&&\"point\"!==i.geometry.type&&r instanceof ae&&(r.centroid=pe(i.geometry,this._spatialReference)),this._updateUserVisibility(r),h(this.scaleVisibility)&&this.scaleVisibility.updateVisibility(r),this.filterVisibility&&this.filterVisibility.updateVisibility(r),this.deconflictor&&this.deconflictor.addGraphic(r),this.labeler&&this.labeler.addGraphic(r),this.objectStates&&this.objectStates.addGraphic(r),this.deconflictor&&this.owner.view.deconflictor.setInitialIconVisibilityFlag(this,r),r.initialize(this.stage,this.stageLayer,this.owner),h(this.graphicStateTracking)&&this.graphicStateTracking.addGraphic(r);const a=this.whenGraphics3DGraphicRequests[i.uid];return a&&(delete this.whenGraphics3DGraphicRequests[i.uid],a.resolve(r)),r}abortRendererChange(){this.rendererChangeAbortController&&(this.rendererChangeAbortController.abort(),this.rendererChangeAbortController=null)}async rendererChange(e){if(this.abortRendererChange(),e!==this.currentRenderer)if(this.validateRenderer(e),p(e)&&this.currentRendererChange(null,!1),J(e))if(h(e)&&e.arcadeRequired){const t=b();this.rendererChangeAbortController=t;const{arcadeUtils:i}=await this.ensureArcade();f(t),i.hasGeometryOperations(e)&&(await i.enableGeometryOperations(),f(t)),0===this.effectiveUpdatePolicy?await this._frameTask.schedule((()=>this.currentRendererChange(e,!0)),t.signal):this.currentRendererChange(e,!0),this.rendererChangeAbortController=null}else if(0===this.effectiveUpdatePolicy){const t=b();this.rendererChangeAbortController=t,await this._frameTask.schedule((()=>this.currentRendererChange(e,!1)),t.signal),this.rendererChangeAbortController=null}else this.currentRendererChange(e,!1);else this.currentRendererChange(e,!1)}async ensureArcade(){return p(this.arcadeOnDemand)?(this.arcadeOnDemand=await X(),this.arcadeOnDemand):this.arcadeOnDemand}currentRendererChange(e,t){this.currentRenderer=e,this.rendererHasGeometryOperations=t,this.symbolCreationContext.arcade=g(this.arcadeOnDemand);const i=this.symbolCreationContext.renderer;if(e===i)return;if(this.symbolConversionCache.clear(),p(e))return this.symbolCreationContext.renderer=null,void this.recreateAllGraphics();const r=E(i,e);this.updateUnchangedSymbolMappings(r,e,i),this.symbolCreationContext.renderer=e,p(r)||(\"complete\"===r.type?this.recreateAllGraphics():\"partial\"===r.type&&(this.applyRendererDiff(r,e,i)?this.volatileGraphicsUpdated():this.recreateAllGraphics()),this.notifyChange(\"averageSymbolComplexity\"))}diffHasSymbolChange(e){for(const t in e.diff)switch(t){case\"visualVariables\":case\"defaultSymbol\":case\"uniqueValueInfos\":break;case\"authoringInfo\":case\"fieldDelimiter\":delete e.diff[t];break;default:return!0}return!1}applySymbolSetDiff(e,t,i){e=e||[],t=t||[];const r=[];for(const s of t){const t=this.graphicsBySymbol.get(s.id);t&&t.forEach(((a,n)=>{const o=a.graphic,l=this.layer instanceof N?this.layer:null,h=g(this.arcadeOnDemand);if(s===i.defaultSymbol&&i.getSymbol(Q(o,l),{arcade:h})===i.defaultSymbol)return;const d=a.usedMemory;e.length||i.defaultSymbol?r.push(o):this.graphicsWithoutSymbol.set(n,o);const p=this.graphics3DGraphics.get(n);this._conditionalRemove(p,n),a.destroy(),t.delete(n),this.removeGraphics3DGraphic(n,d),this.updateLayerVisibility()})),this._whenSymbolRemoved.forAll((e=>e(s.id)))}(e.length||r.length)&&(this.graphicsWithoutSymbol.forEach((e=>r.push(e))),this.graphicsWithoutSymbol.clear(),this.add(r)),this._cleanupSymbols(),this.labeler&&this.owner.view.labeler.setDirty(),this.owner.view.deconflictor.setDirty()}applyUniqueValueRendererDiff(e,t,i){const r=e.diff.defaultSymbol,s=e.diff.uniqueValueInfos;if(r||s){const a=s?s.added.map((e=>e.symbol)):[],n=s?s.removed.map((e=>e.symbol)):[];if(s)for(let e=0;e<s.changed.length;e++)a.push(s.changed[e].newValue.symbol),n.push(s.changed[e].oldValue.symbol);return r?(i.defaultSymbol&&n.push(i.defaultSymbol),t.defaultSymbol&&a.push(t.defaultSymbol)):i.defaultSymbol&&a.length&&n.push(t.defaultSymbol),this.applySymbolSetDiff(a,n,t),delete e.diff.defaultSymbol,delete e.diff.uniqueValueInfos,!0}return!1}calculateUnchangedSymbolMapping(e,i,r){const s=e=>h(e)?e.id:null;if(i instanceof t&&r instanceof t&&(p(e)||\"partial\"===e.type)){const t=e&&e.diff,a=t&&t.defaultSymbol,n=t&&t.uniqueValueInfos;let o;return o=n?n.unchanged.map((e=>({oldId:s(e.oldValue.symbol),newId:s(e.newValue.symbol)}))):r.uniqueValueInfos.map(((e,t)=>({oldId:s(e.symbol),newId:s(i.uniqueValueInfos[t].symbol)}))),!a&&r.defaultSymbol&&o.push({oldId:s(r.defaultSymbol),newId:s(i.defaultSymbol)}),o}return[]}updateSymbolMapping(e,t){const i=t?\"string\"==typeof t?t:t.id:null,r=\"string\"==typeof t?null:t;if(!e||e===i)return;const s=this.graphicsBySymbol.get(e);this.graphicsBySymbol.delete(e),void 0!==s&&this.graphicsBySymbol.set(i,s);const a=this.symbols.get(e);void 0!==a&&(this.symbols.delete(e),this.symbols.set(i,a),h(a)&&(h(r)?a.symbol=r:a.symbol.id=i))}updateUnchangedSymbolMappings(e,t,i){const r=this.calculateUnchangedSymbolMapping(e,t,i);for(const{oldId:s,newId:a}of r)this.updateSymbolMapping(s,a)}applyRendererDiff(e,i,r){if(this.diffHasSymbolChange(e))return!1;if(i instanceof t&&r instanceof t&&this.applyUniqueValueRendererDiff(e,i,r)&&0===Object.keys(e.diff).length)return!0;for(const[t]of this.graphicsBySymbol){const r=this.symbols.get(t);if(h(r)&&!r.applyRendererDiff(e,i))return!1}return!0}opacityChange(){this.forEachGraphics3DSymbol(((e,t)=>e.globalPropertyChanged(\"opacity\",t))),this.updateStageLayerVisibility()}slicePlaneEnabledChange(e){e!==this.symbolCreationContext.slicePlaneEnabled&&(this.symbolCreationContext.slicePlaneEnabled=e,this.stageLayer.isSliceable=e,this.forEachGraphics3DSymbol(((e,t)=>e.globalPropertyChanged(\"slicePlaneEnabled\",t))),this.deconflictor&&this.deconflictor.slicePlaneEnabledChange(),this.labeler&&this.labeler.slicePlaneEnabledChange())}physicalBasedRenderingChange(e){e!==this.symbolCreationContext.physicalBasedRenderingEnabled&&(this.symbolCreationContext.physicalBasedRenderingEnabled=e,this.forEachGraphics3DSymbol(((e,t,i)=>{e.globalPropertyChanged(\"physicalBasedRenderingEnabled\",t)||this._recreateSymbol(i)})))}pixelRatioChange(){this.forEachGraphics3DSymbol(((e,t,i)=>{e.globalPropertyChanged(\"pixelRatio\",t)||this._recreateSymbol(i)}))}_signalUpdatingDuringAsyncLoadedGraphicsChange(){this._updatingPendingLoadedGraphicsChange&&this._updatingPendingLoadedGraphicsChange.remove(),this._updatingPendingLoadedGraphicsChange=w((()=>{this._updatingPendingLoadedGraphicsChange=null}))}setClippingExtent(e,t){const i=this.symbolCreationContext.clippingExtent,r=q();return ue(e,r,t)?this.symbolCreationContext.clippingExtent=z(M(),r):this.symbolCreationContext.clippingExtent=null,!B(this.symbolCreationContext.clippingExtent,i)}modifyGraphics3DGraphicVisibilities(e){let t=!1;this.graphics3DGraphics.forEach((i=>{e(i)&&(t=!0)})),t&&(this.labeler&&this.owner.view.labeler.setDirty(),this.owner.view.deconflictor.setDirty())}forEachGraphics3DSymbol(e){for(const[t,i]of this.symbols){if(p(i))return;e(i,this.graphicsBySymbol.get(t)||Fe,t)}}updateAllGraphicsVisibility(){this.filterVisibility&&(this.filterVisibility.dirty=!0),this.modifyGraphics3DGraphicVisibilities((e=>{const t=this._updateUserVisibility(e),i=h(this.scaleVisibility)&&this.scaleVisibility.updateVisibility(e);return t||i}))}hideAllGraphics(){this.modifyGraphics3DGraphicVisibilities((e=>e.setVisibilityFlag(0,!1,0)))}validateRenderer(e){const t=K(e);if(t){const e=`Renderer for layer '${this.layer.title?`${this.layer.title}, `:\"\"}, id:${this.layer.id}' is not supported in a SceneView`;Ue.warn(e,t.message)}}volatileGraphicsUpdated(){this.labeler&&this.labeler.reset(),this.stageLayer.shaderTransformationChanged(),this.notifyChange(\"updating\")}_cleanupSymbols(){if(this.graphicsWaitingForSymbol.size>0||this.suspendSymbolCleanup)return;let e=!1;this.symbols.forEach(((t,i)=>{if(p(t)||t.referenced>0)return;const r=this.graphicsBySymbol.get(i);r&&0!==r.size||(this.graphicsBySymbol.delete(i),this.symbols.delete(i),t&&t.destroy(),e=!0)})),e&&(this.recomputeExtentPadding(),this.notifyChange(\"averageSymbolComplexity\"))}snapshotInternals(){return{graphics:[...this.graphics3DGraphics.keys()].sort(),symbols:[...this.symbols.keys()].sort(),graphicsBySymbol:[...this.graphicsBySymbol.keys()].sort().map((e=>({symbolId:e,graphics:[...this.graphicsBySymbol.get(e).keys()].sort()}))),graphicsWithoutSymbol:[...this.graphicsWithoutSymbol.keys()].sort(),graphicsDrapedUids:[...this.graphicsDrapedUids].sort(),pendingUpdates:this.pendingUpdates}}get test(){return{symbols:this.symbols,filterVisibility:this.filterVisibility,numPending:this.pendingUpdates.size,forceUpdatePolicy:e=>{this.forcedUpdatePolicy=e}}}get performanceInfo(){return{visible:this.graphics3DGraphics.size,missing:this.graphicsWithoutSymbol.size,pending:this.pendingUpdates.size}}};Oe.tmpVec=V(),e([D({readOnly:!0})],Oe.prototype,\"computedExtent\",void 0),e([D()],Oe.prototype,\"currentRenderer\",void 0),e([D()],Oe.prototype,\"rendererHasGeometryOperations\",void 0),e([D()],Oe.prototype,\"_frameTask\",void 0),e([D()],Oe.prototype,\"rendererChangeAbortController\",void 0),e([D()],Oe.prototype,\"elevationInfoChangeAbortController\",void 0),e([D()],Oe.prototype,\"setupAbortController\",void 0),e([D({readOnly:!0})],Oe.prototype,\"elevationAlignment\",void 0),e([D({readOnly:!0})],Oe.prototype,\"scaleVisibility\",void 0),e([D({readOnly:!0})],Oe.prototype,\"filterVisibility\",void 0),e([D()],Oe.prototype,\"_spatialIndex\",void 0),e([D({readOnly:!0})],Oe.prototype,\"extentPadding\",void 0),e([D()],Oe.prototype,\"_updatingPendingLoadedGraphicsChange\",void 0),e([D({readOnly:!0})],Oe.prototype,\"featureStore\",void 0),e([D({readOnly:!0})],Oe.prototype,\"deconflictor\",void 0),e([D({readOnly:!0})],Oe.prototype,\"labeler\",void 0),e([D({readOnly:!0})],Oe.prototype,\"objectStates\",void 0),e([D()],Oe.prototype,\"preferredUpdatePolicy\",void 0),e([D()],Oe.prototype,\"forcedUpdatePolicy\",void 0),e([D({readOnly:!0})],Oe.prototype,\"effectiveUpdatePolicy\",null),e([D({constructOnly:!0})],Oe.prototype,\"elevationFeatureExpressionEnabled\",void 0),e([D({constructOnly:!0})],Oe.prototype,\"owner\",void 0),e([D({constructOnly:!0})],Oe.prototype,\"layer\",void 0),e([D({constructOnly:!0})],Oe.prototype,\"graphicSymbolSupported\",void 0),e([D({constructOnly:!0})],Oe.prototype,\"getRenderingInfoWithoutRenderer\",void 0),e([D({readOnly:!0})],Oe.prototype,\"updating\",null),e([D({readOnly:!0})],Oe.prototype,\"running\",null),e([D({readOnly:!0})],Oe.prototype,\"suspendedOrOutsideOfView\",null),e([D({readOnly:!0,dependsOn:[]})],Oe.prototype,\"updatingRemaining\",null),e([D({readOnly:!0,dependsOn:[\"owner.view.qualitySettings.graphics3D.maxTotalNumberOfPrimitives\",\"owner.view.qualitySettings.graphics3D.maxTotalNumberOfFeatures\",\"averageSymbolComplexity\"]})],Oe.prototype,\"displayFeatureLimit\",null),e([D({readOnly:!0,dependsOn:[]})],Oe.prototype,\"averageSymbolComplexity\",null),e([D({constructOnly:!0})],Oe.prototype,\"hasZ\",void 0),e([D({constructOnly:!0})],Oe.prototype,\"hasM\",void 0),Oe=De=e([I(\"esri.views.3d.layers.graphics.Graphics3DCore\")],Oe);class je{constructor(){this.add=null,this.renderingInfo=null,this.state=0,this.remove=null}clear(){this.add=null,this.renderingInfo=null,this.state=0,this.abortController=null,this.remove=null}}const Le=10,Ve=V(),Ae=V(),Fe=new Map;export{Oe as Graphics3DCore};\n"]},"metadata":{},"sourceType":"module"}