{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport { disposeMaybe as t, destroyMaybe as i } from \"../../../core/maybe.js\";\nimport { createAbortController as r, isAborted as l } from \"../../../core/promiseUtils.js\";\nimport { whenTrueOnce as s } from \"../../../core/watchUtils.js\";\nimport { property as o } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/Logger.js\";\nimport { subclass as a } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport n from \"../../2d/engine/vectorTiles/SchemaHelper.js\";\nimport h from \"../../2d/engine/vectorTiles/TileHandler3D.js\";\nimport p from \"../../2d/engine/vectorTiles/VTLPainter3D.js\";\nimport c from \"../../2d/engine/vectorTiles/style/StyleRepository.js\";\nimport { LayerView3D as m } from \"./LayerView3D.js\";\nimport { TiledLayerView3D as d } from \"./TiledLayerView3D.js\";\nimport { test as y } from \"../terrain/terrainUtils.js\";\nimport f from \"../../layers/LayerView.js\";\nlet g = class extends d(m(f)) {\n  constructor(e) {\n    super(e), this.type = \"vector-tile-3d\";\n  }\n\n  initialize() {\n    const e = y.force512VTL ? this.layer.tileInfo : this.layer.compatibleTileInfo256,\n          t = this._getTileInfoSupportError(e, this.layer.fullExtent);\n\n    if (t) return void this.addResolvingPromise(Promise.reject(t));\n    const {\n      basemapTerrain: i,\n      spatialReference: o,\n      pixelRatio: a\n    } = this.view,\n          m = s(this.view, \"basemapTerrain.tilingSchemeLocked\").then(() => {\n      const e = i.tilingScheme,\n            t = e.pixelSize;\n      let r;\n      this.schemaHelper = new n(t, o.isGeographic), r = 256 === t ? this.layer.compatibleTileInfo256 : this.view.spatialReference.isGeographic ? this.layer.compatibleTileInfo512 : this.layer.tileInfo;\n\n      const l = this._getTileInfoCompatibilityError(r, e);\n\n      if (l) throw l;\n\n      this._set(\"tileInfo\", r);\n    });\n    this._tileHandlerController = r();\n    const d = this.view.resourceController;\n    this._memCache = d.memoryController.getMemCache(this.layer.uid, e => e.release());\n\n    const {\n      style: f,\n      spriteUrl: g,\n      glyphsUrl: u\n    } = this.layer.currentStyleInfo,\n          _ = new c(f, {\n      spriteUrl: g,\n      glyphsUrl: u\n    }),\n          H = i.mapTileRequester;\n\n    this._tileHandler = new h(this.layer, _, a, this._memCache, H);\n\n    const v = this._tileHandlerController.signal,\n          C = e => d.schedule(e),\n          T = this._tileHandler.start({\n      signal: v,\n      schedule: C\n    }),\n          w = this._tileHandler.spriteMosaic;\n\n    w.then(e => {\n      !l(v) && this._tileHandler && (this.painter = new p(e, this._tileHandler.glyphMosaic));\n    }), T.then(() => this._tileHandlerController = null);\n\n    const j = () => {\n      this._tileHandlerController && this._tileHandlerController.abort(), this._tileHandlerController = r(), this._memCache.clear();\n      const {\n        style: e,\n        spriteUrl: t,\n        glyphsUrl: i\n      } = this.layer.currentStyleInfo,\n            l = new c(e, {\n        spriteUrl: t,\n        glyphsUrl: i\n      }),\n            s = new h(this.layer, l, a, this._memCache, H),\n            o = s.start({\n        signal: this._tileHandlerController.signal,\n        schedule: C\n      }),\n            n = s.spriteMosaic;\n      o.then(() => this._tileHandlerController = null), this.updatingHandles.addPromise(Promise.all([o, n]).then(([, e]) => {\n        const t = this._tileHandler,\n              i = this.painter;\n        this.painter = new p(e, s.glyphMosaic), this._tileHandler = s, this.emit(\"data-changed\"), t.destroy(), i && i.dispose();\n      }));\n    };\n\n    this.updatingHandles.add(this, \"layer.currentStyleInfo\", j), this.updatingHandles.add(this, \"view.pixelRatio\", j);\n    const I = Promise.all([m, T, w]);\n    this.addResolvingPromise(I);\n  }\n\n  destroy() {\n    this.painter = t(this.painter), this._tileHandlerController && (this._tileHandlerController.abort(), this._tileHandlerController = null), i(this._tileHandler), this._memCache = i(this._memCache), this._tileHandler = null;\n  }\n\n  get dataLevelRange() {\n    const e = this.tileInfo.lods,\n          t = e[0].scale,\n          i = e[e.length - 1].scale,\n          r = this.levelRangeFromScaleRange(t, i);\n    return 1 === r.minLevel && 256 === this.tileInfo.size[0] && (r.minLevel = 0), r;\n  }\n\n  async fetchTile(e, t, i, r) {\n    return this._tileHandler.getVectorTile(e, t, i, r);\n  }\n\n};\ne([o({\n  aliasOf: \"layer.fullExtent\"\n})], g.prototype, \"fullExtent\", void 0), e([o()], g.prototype, \"layer\", void 0), e([o()], g.prototype, \"tileInfo\", void 0), e([o()], g.prototype, \"dataLevelRange\", null), e([o()], g.prototype, \"updatingProgressValue\", void 0), g = e([a(\"esri.views.3d.layers.VectorTileLayerView3D\")], g);\nvar u = g;\nexport default u;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/layers/VectorTileLayerView3D.js"],"names":["_","e","disposeMaybe","t","destroyMaybe","i","createAbortController","r","isAborted","l","whenTrueOnce","s","property","o","subclass","a","n","h","p","c","LayerView3D","m","TiledLayerView3D","d","test","y","f","g","constructor","type","initialize","force512VTL","layer","tileInfo","compatibleTileInfo256","_getTileInfoSupportError","fullExtent","addResolvingPromise","Promise","reject","basemapTerrain","spatialReference","pixelRatio","view","then","tilingScheme","pixelSize","schemaHelper","isGeographic","compatibleTileInfo512","_getTileInfoCompatibilityError","_set","_tileHandlerController","resourceController","_memCache","memoryController","getMemCache","uid","release","style","spriteUrl","glyphsUrl","u","currentStyleInfo","H","mapTileRequester","_tileHandler","v","signal","C","schedule","T","start","w","spriteMosaic","painter","glyphMosaic","j","abort","clear","updatingHandles","addPromise","all","emit","destroy","dispose","add","I","dataLevelRange","lods","scale","length","levelRangeFromScaleRange","minLevel","size","fetchTile","getVectorTile","aliasOf","prototype"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{disposeMaybe as t,destroyMaybe as i}from\"../../../core/maybe.js\";import{createAbortController as r,isAborted as l}from\"../../../core/promiseUtils.js\";import{whenTrueOnce as s}from\"../../../core/watchUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../2d/engine/vectorTiles/SchemaHelper.js\";import h from\"../../2d/engine/vectorTiles/TileHandler3D.js\";import p from\"../../2d/engine/vectorTiles/VTLPainter3D.js\";import c from\"../../2d/engine/vectorTiles/style/StyleRepository.js\";import{LayerView3D as m}from\"./LayerView3D.js\";import{TiledLayerView3D as d}from\"./TiledLayerView3D.js\";import{test as y}from\"../terrain/terrainUtils.js\";import f from\"../../layers/LayerView.js\";let g=class extends(d(m(f))){constructor(e){super(e),this.type=\"vector-tile-3d\"}initialize(){const e=y.force512VTL?this.layer.tileInfo:this.layer.compatibleTileInfo256,t=this._getTileInfoSupportError(e,this.layer.fullExtent);if(t)return void this.addResolvingPromise(Promise.reject(t));const{basemapTerrain:i,spatialReference:o,pixelRatio:a}=this.view,m=s(this.view,\"basemapTerrain.tilingSchemeLocked\").then((()=>{const e=i.tilingScheme,t=e.pixelSize;let r;this.schemaHelper=new n(t,o.isGeographic),r=256===t?this.layer.compatibleTileInfo256:this.view.spatialReference.isGeographic?this.layer.compatibleTileInfo512:this.layer.tileInfo;const l=this._getTileInfoCompatibilityError(r,e);if(l)throw l;this._set(\"tileInfo\",r)}));this._tileHandlerController=r();const d=this.view.resourceController;this._memCache=d.memoryController.getMemCache(this.layer.uid,(e=>e.release()));const{style:f,spriteUrl:g,glyphsUrl:u}=this.layer.currentStyleInfo,_=new c(f,{spriteUrl:g,glyphsUrl:u}),H=i.mapTileRequester;this._tileHandler=new h(this.layer,_,a,this._memCache,H);const v=this._tileHandlerController.signal,C=e=>d.schedule(e),T=this._tileHandler.start({signal:v,schedule:C}),w=this._tileHandler.spriteMosaic;w.then((e=>{!l(v)&&this._tileHandler&&(this.painter=new p(e,this._tileHandler.glyphMosaic))})),T.then((()=>this._tileHandlerController=null));const j=()=>{this._tileHandlerController&&this._tileHandlerController.abort(),this._tileHandlerController=r(),this._memCache.clear();const{style:e,spriteUrl:t,glyphsUrl:i}=this.layer.currentStyleInfo,l=new c(e,{spriteUrl:t,glyphsUrl:i}),s=new h(this.layer,l,a,this._memCache,H),o=s.start({signal:this._tileHandlerController.signal,schedule:C}),n=s.spriteMosaic;o.then((()=>this._tileHandlerController=null)),this.updatingHandles.addPromise(Promise.all([o,n]).then((([,e])=>{const t=this._tileHandler,i=this.painter;this.painter=new p(e,s.glyphMosaic),this._tileHandler=s,this.emit(\"data-changed\"),t.destroy(),i&&i.dispose()})))};this.updatingHandles.add(this,\"layer.currentStyleInfo\",j),this.updatingHandles.add(this,\"view.pixelRatio\",j);const I=Promise.all([m,T,w]);this.addResolvingPromise(I)}destroy(){this.painter=t(this.painter),this._tileHandlerController&&(this._tileHandlerController.abort(),this._tileHandlerController=null),i(this._tileHandler),this._memCache=i(this._memCache),this._tileHandler=null}get dataLevelRange(){const e=this.tileInfo.lods,t=e[0].scale,i=e[e.length-1].scale,r=this.levelRangeFromScaleRange(t,i);return 1===r.minLevel&&256===this.tileInfo.size[0]&&(r.minLevel=0),r}async fetchTile(e,t,i,r){return this._tileHandler.getVectorTile(e,t,i,r)}};e([o({aliasOf:\"layer.fullExtent\"})],g.prototype,\"fullExtent\",void 0),e([o()],g.prototype,\"layer\",void 0),e([o()],g.prototype,\"tileInfo\",void 0),e([o()],g.prototype,\"dataLevelRange\",null),e([o()],g.prototype,\"updatingProgressValue\",void 0),g=e([a(\"esri.views.3d.layers.VectorTileLayerView3D\")],g);var u=g;export default u;\n"]},"metadata":{},"sourceType":"module"}