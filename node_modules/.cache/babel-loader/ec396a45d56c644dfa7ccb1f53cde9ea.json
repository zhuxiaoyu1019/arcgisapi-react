{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { glLayout as e } from \"../../../support/buffer/glUtil.js\";\nimport { Default3D as t } from \"../DefaultVertexAttributeLocations.js\";\nimport { IntersectorResult as r } from \"../intersectorUtils.js\";\nimport { acquireMaterials as s, releaseMaterials as i } from \"../../materials/renderers/utils.js\";\nimport o from \"../../../../webgl/BufferObject.js\";\nimport n from \"../../../../webgl/VertexArrayObject.js\";\n\nclass a {\n  constructor(r, i) {\n    const a = r.renderContext.rctx,\n          l = i.geometry,\n          m = i.material;\n    this.materialRep = r.materialRep, m.setParameterValues({\n      instancedDoublePrecision: !0\n    });\n    const u = m.createBufferWriter(),\n          d = u.vertexBufferLayout,\n          f = u.elementCount(l),\n          c = u.allocate(f);\n    u.write({}, l, c, 0), this.geometry = l, this.material = m, this.glMaterials = s(m, this.materialRep), this.vertexBufferLayout = d, this.vbo = o.createVertex(a, 35044, c.buffer), this.vao = new n(a, t, {\n      geometry: e(d)\n    }, {\n      geometry: this.vbo\n    }), this.vertexCount = f;\n  }\n\n  destroy() {\n    i(this.material, this.materialRep), this.vbo.dispose(), this.vao.dispose();\n  }\n\n  get boundingInfo() {\n    return this.geometry.boundingInfo;\n  }\n\n  get triangleCount() {\n    return this.vertexCount / 3;\n  }\n\n  intersect(e, t, s, i, o, n) {\n    const a = this.geometry.id,\n          l = o.toString();\n    this.material.intersect(this.geometry, null, e.transform.transform, e, s, i, (s, i, m, u) => {\n      if (s >= 0) {\n        if (null != t && !t(e.rayBeginPoint, e.rayEndPoint, s)) return;\n        const d = {\n          type: \"external\",\n          metadata: {\n            layerUid: n.layerUid,\n            graphicUid: n.graphicUid(o)\n          }\n        };\n\n        if ((null == e.results.min.drapedLayerOrder || u >= e.results.min.drapedLayerOrder) && (null == e.results.min.dist || s < e.results.min.dist) && (e.results.min.set(d, l, s, i, e.transform.transform, u, null, a, m), e.results.min.intersector = \"LodRenderer\"), 0 !== e.options.store && (null == e.results.max.drapedLayerOrder || u >= e.results.max.drapedLayerOrder) && (null == e.results.max.dist || s > e.results.max.dist) && (e.results.max.set(d, l, s, i, e.transform.transform, u, null, a, m), e.results.min.intersector = \"LodRenderer\"), 2 === e.options.store) {\n          const t = new r(e.results.min.ray);\n          t.set(d, l, s, i, e.transform.transform, u, null, a, m), t.intersector = \"LodRenderer\", e.results.all.push(t);\n        }\n      }\n    });\n  }\n\n}\n\nexport { a as LodComponentData };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/LodComponentData.js"],"names":["glLayout","e","Default3D","t","IntersectorResult","r","acquireMaterials","s","releaseMaterials","i","o","n","a","constructor","renderContext","rctx","l","geometry","m","material","materialRep","setParameterValues","instancedDoublePrecision","u","createBufferWriter","d","vertexBufferLayout","f","elementCount","c","allocate","write","glMaterials","vbo","createVertex","buffer","vao","vertexCount","destroy","dispose","boundingInfo","triangleCount","intersect","id","toString","transform","rayBeginPoint","rayEndPoint","type","metadata","layerUid","graphicUid","results","min","drapedLayerOrder","dist","set","intersector","options","store","max","ray","all","push","LodComponentData"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glLayout as e}from\"../../../support/buffer/glUtil.js\";import{Default3D as t}from\"../DefaultVertexAttributeLocations.js\";import{IntersectorResult as r}from\"../intersectorUtils.js\";import{acquireMaterials as s,releaseMaterials as i}from\"../../materials/renderers/utils.js\";import o from\"../../../../webgl/BufferObject.js\";import n from\"../../../../webgl/VertexArrayObject.js\";class a{constructor(r,i){const a=r.renderContext.rctx,l=i.geometry,m=i.material;this.materialRep=r.materialRep,m.setParameterValues({instancedDoublePrecision:!0});const u=m.createBufferWriter(),d=u.vertexBufferLayout,f=u.elementCount(l),c=u.allocate(f);u.write({},l,c,0),this.geometry=l,this.material=m,this.glMaterials=s(m,this.materialRep),this.vertexBufferLayout=d,this.vbo=o.createVertex(a,35044,c.buffer),this.vao=new n(a,t,{geometry:e(d)},{geometry:this.vbo}),this.vertexCount=f}destroy(){i(this.material,this.materialRep),this.vbo.dispose(),this.vao.dispose()}get boundingInfo(){return this.geometry.boundingInfo}get triangleCount(){return this.vertexCount/3}intersect(e,t,s,i,o,n){const a=this.geometry.id,l=o.toString();this.material.intersect(this.geometry,null,e.transform.transform,e,s,i,((s,i,m,u)=>{if(s>=0){if(null!=t&&!t(e.rayBeginPoint,e.rayEndPoint,s))return;const d={type:\"external\",metadata:{layerUid:n.layerUid,graphicUid:n.graphicUid(o)}};if((null==e.results.min.drapedLayerOrder||u>=e.results.min.drapedLayerOrder)&&(null==e.results.min.dist||s<e.results.min.dist)&&(e.results.min.set(d,l,s,i,e.transform.transform,u,null,a,m),e.results.min.intersector=\"LodRenderer\"),0!==e.options.store&&(null==e.results.max.drapedLayerOrder||u>=e.results.max.drapedLayerOrder)&&(null==e.results.max.dist||s>e.results.max.dist)&&(e.results.max.set(d,l,s,i,e.transform.transform,u,null,a,m),e.results.min.intersector=\"LodRenderer\"),2===e.options.store){const t=new r(e.results.min.ray);t.set(d,l,s,i,e.transform.transform,u,null,a,m),t.intersector=\"LodRenderer\",e.results.all.push(t)}}}))}}export{a as LodComponentData};\n"]},"metadata":{},"sourceType":"module"}