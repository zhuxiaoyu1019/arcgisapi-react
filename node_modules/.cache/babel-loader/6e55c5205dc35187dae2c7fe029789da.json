{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { clamp as e, sign as t } from \"../../../../core/mathUtils.js\";\nimport { isSome as i } from \"../../../../core/maybe.js\";\nimport { createRenderScreenPointArray3 as s } from \"../../../../core/screenUtils.js\";\nimport { f as r } from \"../../../../chunks/mat3.js\";\nimport { c as n } from \"../../../../chunks/mat3f64.js\";\nimport { a } from \"../../../../chunks/mat4.js\";\nimport { c as o } from \"../../../../chunks/mat4f64.js\";\nimport { c } from \"../../../../chunks/vec2.js\";\nimport { a as l, f as u } from \"../../../../chunks/vec2f64.js\";\nimport { s as f, m as p, n as h, f as m, a as d, g, l as v, i as x, t as b, d as S, b as A } from \"../../../../chunks/vec3.js\";\nimport { c as q, f as O } from \"../../../../chunks/vec3f64.js\";\nimport { isMat4 as P } from \"../../../../core/libs/gl-matrix-2/types/mat4.js\";\nimport { create as y } from \"../../../../geometry/support/aaBoundingRect.js\";\nimport { newLayout as z } from \"../../support/buffer/InterleavedLayout.js\";\nimport { computeAttachmentOriginPoints as C } from \"../lib/geometryDataUtils.js\";\nimport T from \"../lib/GLMaterialTexture.js\";\nimport { Material as _, materialParametersDefaults as w } from \"../lib/Material.js\";\nimport { applyScaleFactor as j, applyPrecomputedScaleFactor as D, precomputeScaleFactor as M } from \"../lib/screenSizePerspectiveUtils.js\";\nimport { assert as E } from \"../lib/Util.js\";\nimport { writePosition as V, writeNormal as G, writeColor as I, writeBufferVec4 as R } from \"./internal/bufferWriterUtils.js\";\nimport { verticalOffsetAtDistance as U } from \"./internal/MaterialUtil.js\";\nimport { isInstanceHidden as B } from \"./renderers/utils.js\";\nimport { c as H } from \"../../../../chunks/HUDMaterial.glsl.js\";\nimport { HUDMaterialTechniqueConfiguration as k, HUDMaterialTechnique as F } from \"../shaders/HUDMaterialTechnique.js\";\n\nclass W extends _ {\n  constructor(e) {\n    super(e, me), this.techniqueConfig = new k();\n  }\n\n  getTechniqueConfig(e, t) {\n    return this.techniqueConfig.output = e, this.techniqueConfig.slicePlaneEnabled = this.params.slicePlaneEnabled, this.techniqueConfig.verticalOffset = !!this.params.verticalOffset, this.techniqueConfig.screenSizePerspective = !!this.params.screenSizePerspective, this.techniqueConfig.screenCenterOffsetUnitsEnabled = \"screen\" === this.params.centerOffsetUnits ? 1 : 0, this.techniqueConfig.polygonOffsetEnabled = this.params.polygonOffset, this.techniqueConfig.isDraped = this.params.isDraped, this.techniqueConfig.occlusionTestEnabled = this.params.occlusionTest, this.techniqueConfig.pixelSnappingEnabled = this.params.pixelSnappingEnabled, this.techniqueConfig.sdf = this.params.textureIsSignedDistanceField, this.techniqueConfig.vvSize = !!this.params.vvSizeEnabled, this.techniqueConfig.vvColor = !!this.params.vvColorEnabled, 0 === e && (this.techniqueConfig.debugDrawBorder = !!this.params.debugDrawBorder), 4 === e && (this.techniqueConfig.binaryHighlightOcclusion = this.params.binaryHighlightOcclusion), this.techniqueConfig.depthEnabled = this.params.depthEnabled, this.techniqueConfig.transparencyPassType = t ? t.transparencyPassType : 3, this.techniqueConfig.multipassGeometryEnabled = !!t && t.multipassGeometryEnabled, this.techniqueConfig.multipassTerrainEnabled = !!t && t.multipassTerrainEnabled, this.techniqueConfig.cullAboveGround = !!t && t.cullAboveGround, this.techniqueConfig;\n  }\n\n  intersect(e, t, i, s, r, n, a, o, c) {\n    c ? this.intersectDrapedHudGeometry(e, n, a, o) : this.intersectHudGeometry(e, t, i, s, a, o);\n  }\n\n  intersectDrapedHudGeometry(e, t, s, r) {\n    const n = e.vertexAttributes.get(\"position\"),\n          a = e.vertexAttributes.get(\"size\"),\n          o = this.params,\n          c = H(o);\n    let l = 1,\n        u = 1;\n\n    if (i(r)) {\n      const e = r(le);\n      l = e[0], u = e[5];\n    }\n\n    l *= e.screenToWorldRatio, u *= e.screenToWorldRatio;\n    const f = fe * e.screenToWorldRatio;\n\n    for (let i = 0; i < n.data.length / n.size; i++) {\n      const r = i * n.size,\n            p = n.data[r],\n            h = n.data[r + 1],\n            m = i * a.size;\n      let d;\n      pe[0] = a.data[m] * l, pe[1] = a.data[m + 1] * u, o.textureIsSignedDistanceField && (d = o.outlineSize * e.screenToWorldRatio / 2), X(t, p, h, pe, f, d, o, c) && s();\n    }\n  }\n\n  intersectHudGeometry(e, t, s, n, o, c) {\n    if (!n.options.selectionMode || !n.options.hud) return;\n    if (B(t)) return;\n    const l = this.params;\n    let u = 1,\n        b = 1;\n\n    if (r(re, s), i(c)) {\n      const e = c(le);\n      u = e[0], b = e[5], Q(re);\n    }\n\n    const S = e.vertexAttributes.get(\"position\"),\n          A = e.vertexAttributes.get(\"size\"),\n          O = e.vertexAttributes.get(\"normal\"),\n          P = e.vertexAttributes.get(\"auxpos1\");\n    E(S.size >= 3);\n    const y = n.point,\n          z = n.camera,\n          C = H(l);\n    u *= z.pixelRatio, b *= z.pixelRatio;\n    const T = \"screen\" === this.params.centerOffsetUnits;\n\n    for (let i = 0; i < S.data.length / S.size; i++) {\n      const e = i * S.size;\n      f($, S.data[e], S.data[e + 1], S.data[e + 2]), p($, $, s);\n      const t = i * A.size;\n      pe[0] = A.data[t] * u, pe[1] = A.data[t + 1] * b, p($, $, z.viewMatrix);\n      const r = i * P.size;\n\n      if (f(oe, P.data[r + 0], P.data[r + 1], P.data[r + 2]), !T && ($[0] += oe[0], $[1] += oe[1], 0 !== oe[2])) {\n        const e = oe[2];\n        h(oe, $), m($, $, d(oe, oe, e));\n      }\n\n      const c = i * O.size;\n\n      if (f(ee, O.data[c], O.data[c + 1], O.data[c + 2]), this.normalAndViewAngle(ee, re, z, ce), this.applyVerticalOffsetTransformationView($, ce, z, Y), z.applyProjection($, te), te[0] > -1) {\n        let e = Math.floor(te[0]) + this.params.screenOffset[0],\n            t = Math.floor(te[1]) + this.params.screenOffset[1];\n        T && (e += oe[0], 0 !== oe[1] && (t += j(oe[1], Y.factorAlignment))), D(pe, Y.factor, pe);\n        const i = ue * z.pixelRatio;\n        let s;\n\n        if (l.textureIsSignedDistanceField && (s = l.outlineSize * z.pixelRatio / 2), X(y, e, t, pe, i, s, l, C)) {\n          const e = n.ray;\n\n          if (p(se, $, a(ae, z.viewMatrix)), te[0] = y[0], te[1] = y[1], z.unprojectFromRenderScreen(te, $)) {\n            const t = q();\n            g(t, e.direction);\n            const i = 1 / v(t);\n            d(t, t, i);\n            o(x(e.origin, $) * i, t, -1, 1, !0, se);\n          }\n        }\n      }\n    }\n  }\n\n  computeAttachmentOrigin(e, t) {\n    const i = e.vertexAttributes;\n    if (!i) return !1;\n    const s = i.get(\"position\"),\n          r = e.indices.get(\"position\");\n    return C(s, r, t);\n  }\n\n  createBufferWriter() {\n    return new ge(this);\n  }\n\n  normalAndViewAngle(e, t, i, s) {\n    return P(t) && (t = r(ne, t)), b(s.normal, e, t), p(s.normal, s.normal, i.viewInverseTransposeMatrix), s.cosAngle = S(ie, he), s;\n  }\n\n  updateScaleInfo(e, t, i) {\n    const s = this.params;\n    s.screenSizePerspective ? M(i, t, s.screenSizePerspective, e.factor) : (e.factor.scale = 1, e.factor.factor = 0, e.factor.minPixelSize = 0, e.factor.paddingPixels = 0), s.screenSizePerspectiveAlignment ? M(i, t, s.screenSizePerspectiveAlignment, e.factorAlignment) : (e.factorAlignment.factor = e.factor.factor, e.factorAlignment.scale = e.factor.scale, e.factorAlignment.minPixelSize = e.factor.minPixelSize, e.factorAlignment.paddingPixels = e.factor.paddingPixels);\n  }\n\n  applyShaderOffsetsView(e, t, i, s, r, n, a) {\n    const o = this.normalAndViewAngle(t, i, r, ce);\n    return this.applyVerticalGroundOffsetView(e, o, r, a), this.applyVerticalOffsetTransformationView(a, o, r, n), this.applyPolygonOffsetView(a, o, s[3], r, a), this.applyCenterOffsetView(a, s, a), a;\n  }\n\n  applyShaderOffsetsNDC(e, t, s, r, n) {\n    return this.applyCenterOffsetNDC(e, t, s, r), i(n) && g(n, r), this.applyPolygonOffsetNDC(r, t, s, r), r;\n  }\n\n  applyPolygonOffsetView(i, s, r, n, a) {\n    const o = n.aboveGround ? 1 : -1;\n    let c = t(r);\n    0 === c && (c = o);\n    const l = o * c;\n    if (this.params.shaderPolygonOffset <= 0) return g(a, i);\n    const u = e(Math.abs(s.cosAngle), .01, 1),\n          f = 1 - Math.sqrt(1 - u * u) / u / n.viewport[2];\n    return d(a, i, l > 0 ? f : 1 / f), a;\n  }\n\n  applyVerticalGroundOffsetView(e, t, i, s) {\n    const r = v(e),\n          n = i.aboveGround ? 1 : -1,\n          a = .5 * i.computeRenderPixelSizeAtDist(r),\n          o = d($, t.normal, n * a);\n    return A(s, e, o), s;\n  }\n\n  applyVerticalOffsetTransformationView(e, t, i, s) {\n    const r = this.params;\n\n    if (!r.verticalOffset || !r.verticalOffset.screenLength) {\n      if (r.screenSizePerspective || r.screenSizePerspectiveAlignment) {\n        const i = v(e);\n        this.updateScaleInfo(s, i, t.cosAngle);\n      } else s.factor.scale = 1, s.factorAlignment.scale = 1;\n\n      return e;\n    }\n\n    const n = v(e),\n          a = r.screenSizePerspectiveAlignment || r.screenSizePerspective,\n          o = U(i, n, r.verticalOffset, t.cosAngle, a);\n    return this.updateScaleInfo(s, n, t.cosAngle), d(t.normal, t.normal, o), A(e, e, t.normal);\n  }\n\n  applyCenterOffsetView(e, t, i) {\n    const s = \"screen\" !== this.params.centerOffsetUnits;\n    return i !== e && g(i, e), s && (i[0] += t[0], i[1] += t[1], t[2] && (h(ee, i), A(i, i, d(ee, ee, t[2])))), i;\n  }\n\n  applyCenterOffsetNDC(e, t, i, s) {\n    const r = \"screen\" !== this.params.centerOffsetUnits;\n    return s !== e && g(s, e), r || (s[0] += t[0] / i.fullWidth * 2, s[1] += t[1] / i.fullHeight * 2), s;\n  }\n\n  applyPolygonOffsetNDC(e, i, s, r) {\n    const n = this.params.shaderPolygonOffset;\n\n    if (e !== r && g(r, e), n) {\n      const e = s.aboveGround ? 1 : -1,\n            a = e * t(i[3]);\n      r[2] -= (a || e) * n;\n    }\n\n    return r;\n  }\n\n  getGLMaterial(e) {\n    return 0 === e.output || 7 === e.output ? new N(e) : 4 === e.output ? new J(e) : void 0;\n  }\n\n  calculateRelativeScreenBounds(e, t, i = y()) {\n    return K(this.params, e, t, i), i[2] = i[0] + e[0], i[3] = i[1] + e[1], i;\n  }\n\n}\n\nclass L extends T {\n  constructor(e) {\n    super({ ...e,\n      ...e.material.params\n    }), this.updateParameters();\n  }\n\n  beginSlot(e) {\n    return e === (this._material.params.drawInSecondSlot ? 19 : 18);\n  }\n\n  updateParameters(e) {\n    this.updateTexture(this._material.params.textureId), this.selectProgram(e);\n  }\n\n  selectProgram(e) {\n    this._technique = this._techniqueRep.releaseAndAcquire(F, this._material.getTechniqueConfig(this._output, e), this._technique);\n  }\n\n  ensureParameters(e) {\n    this.updateParameters(e);\n  }\n\n  bind(e) {\n    this.bindTextures(this._technique.program), this.bindTextureScale(this._technique.program), this._technique.bindPass(this._material.params, e);\n  }\n\n}\n\nclass N extends L {\n  constructor(e) {\n    super(e), this._isOcclusionSlot = !1;\n  }\n\n  beginSlot(e) {\n    const t = this._material.params.drawInSecondSlot ? 19 : 18;\n    return this._material.params.occlusionTest ? (this._isOcclusionSlot = 12 === e, 12 === e || e === t) : (this._isOcclusionSlot = !1, e === t);\n  }\n\n  get technique() {\n    return this._isOcclusionSlot ? this._occlusionTechnique : this._technique;\n  }\n\n  selectProgram(e) {\n    this._technique = this._techniqueRep.releaseAndAcquire(F, this._material.getTechniqueConfig(this._output, e), this._technique), this._occlusionTechnique = this._techniqueRep.releaseAndAcquire(F, this._material.getTechniqueConfig(6, e), this._occlusionTechnique);\n  }\n\n  bind(e) {\n    const t = this.technique;\n    this._isOcclusionSlot || (this.bindTextures(t.program), this.bindTextureScale(t.program)), t.bindPass(this._material.params, e);\n  }\n\n}\n\nclass J extends L {\n  constructor(e) {\n    super({ ...e,\n      output: 4\n    });\n  }\n\n}\n\nfunction K(e, t, i, s = Z) {\n  return c(s, e.anchorPos), s[0] *= -t[0], s[1] *= -t[1], s[0] += e.screenOffset[0] * i, s[1] += e.screenOffset[1] * i, s;\n}\n\nfunction Q(e) {\n  const t = e[0],\n        i = e[1],\n        s = e[2],\n        r = e[3],\n        n = e[4],\n        a = e[5],\n        o = e[6],\n        c = e[7],\n        l = e[8],\n        u = 1 / Math.sqrt(t * t + i * i + s * s),\n        f = 1 / Math.sqrt(r * r + n * n + a * a),\n        p = 1 / Math.sqrt(o * o + c * c + l * l);\n  return e[0] = t * u, e[1] = i * u, e[2] = s * u, e[3] = r * f, e[4] = n * f, e[5] = a * f, e[6] = o * p, e[7] = c * p, e[8] = l * p, e;\n}\n\nfunction X(e, t, i, s, r, n, a, o) {\n  let c = t - r - (o[0] > 0 ? s[0] * o[0] : 0),\n      l = c + s[0] + 2 * r,\n      u = i - r - (o[1] > 0 ? s[1] * o[1] : 0),\n      f = u + s[1] + 2 * r;\n\n  if (a.textureIsSignedDistanceField) {\n    const e = a.distanceFieldBoundingBox;\n    c += s[0] * e[0], u += s[1] * e[1], l -= s[0] * (1 - e[2]), f -= s[1] * (1 - e[3]), c -= n, l += n, u -= n, f += n;\n  }\n\n  return e[0] > c && e[0] < l && e[1] > u && e[1] < f;\n}\n\nconst Y = {\n  factor: {\n    scale: 0,\n    factor: 0,\n    minPixelSize: 0,\n    paddingPixels: 0\n  },\n  factorAlignment: {\n    scale: 0,\n    factor: 0,\n    minPixelSize: 0,\n    paddingPixels: 0\n  }\n},\n      Z = l(),\n      $ = q(),\n      ee = q(),\n      te = s(),\n      ie = q(),\n      se = q(),\n      re = n(),\n      ne = n(),\n      ae = o(),\n      oe = q(),\n      ce = {\n  normal: ie,\n  cosAngle: 0\n},\n      le = o(),\n      ue = 1,\n      fe = 2,\n      pe = [0, 0],\n      he = O(0, 0, 1),\n      me = {\n  texCoordScale: [1, 1],\n  occlusionTest: !0,\n  binaryHighlightOcclusion: !0,\n  drawInSecondSlot: !1,\n  color: [1, 1, 1, 1],\n  outlineColor: [1, 1, 1, 1],\n  outlineSize: 0,\n  textureIsSignedDistanceField: !1,\n  distanceFieldBoundingBox: null,\n  vvSizeEnabled: !1,\n  vvSizeMinSize: [1, 1, 1],\n  vvSizeMaxSize: [100, 100, 100],\n  vvSizeOffset: [0, 0, 0],\n  vvSizeFactor: [1, 1, 1],\n  vvColorEnabled: !1,\n  vvColorValues: [0, 0, 0, 0, 0, 0, 0, 0],\n  vvColorColors: [1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0],\n  screenOffset: [0, 0],\n  verticalOffset: null,\n  screenSizePerspective: null,\n  screenSizePerspectiveAlignment: null,\n  slicePlaneEnabled: !1,\n  anchorPos: u(.5, .5),\n  shaderPolygonOffset: 1e-5,\n  polygonOffset: !1,\n  textureId: null,\n  centerOffsetUnits: \"world\",\n  depthEnabled: !0,\n  pixelSnappingEnabled: !0,\n  debugDrawBorder: !1,\n  isDraped: !1,\n  ...w\n},\n      de = z().vec3f(\"position\").vec3f(\"normal\").vec2f(\"uv0\").vec4u8(\"color\").vec2f(\"size\").vec4f(\"auxpos1\").vec4f(\"auxpos2\");\n\nclass ge {\n  constructor(e) {\n    this.material = e, this.vertexBufferLayout = de;\n  }\n\n  allocate(e) {\n    return this.vertexBufferLayout.createBuffer(e);\n  }\n\n  elementCount(e) {\n    return 6 * e.indices.get(\"position\").length;\n  }\n\n  write(e, t, i, s) {\n    V(t.indices.get(\"position\"), t.vertexAttributes.get(\"position\").data, e.transformation, i.position, s, 6), G(t.indices.get(\"normal\"), t.vertexAttributes.get(\"normal\").data, e.invTranspTransformation, i.normal, s, 6);\n    {\n      const e = t.vertexAttributes.get(\"uv0\").data;\n      let r, n, a, o;\n\n      if (null == e || e.length < 4) {\n        const e = this.material.params;\n        r = 0, n = 0, a = e.texCoordScale[0], o = e.texCoordScale[1];\n      } else r = e[0], n = e[1], a = e[2], o = e[3];\n\n      a = Math.min(1.99999, a + 1), o = Math.min(1.99999, o + 1);\n      const c = t.indices.get(\"position\").length,\n            l = i.uv0;\n      let u = s;\n\n      for (let t = 0; t < c; ++t) l.set(u, 0, r), l.set(u, 1, n), u += 1, l.set(u, 0, a), l.set(u, 1, n), u += 1, l.set(u, 0, a), l.set(u, 1, o), u += 1, l.set(u, 0, a), l.set(u, 1, o), u += 1, l.set(u, 0, r), l.set(u, 1, o), u += 1, l.set(u, 0, r), l.set(u, 1, n), u += 1;\n    }\n    I(t.indices.get(\"color\"), t.vertexAttributes.get(\"color\").data, 4, i.color, s, 6);\n    {\n      const e = t.indices.get(\"size\"),\n            r = t.vertexAttributes.get(\"size\").data,\n            n = e.length,\n            a = i.size;\n      let o = s;\n\n      for (let t = 0; t < n; ++t) {\n        const i = r[2 * e[t]],\n              s = r[2 * e[t] + 1];\n\n        for (let e = 0; e < 6; ++e) a.set(o, 0, i), a.set(o, 1, s), o += 1;\n      }\n    }\n    t.indices.get(\"auxpos1\") && t.vertexAttributes.get(\"auxpos1\") && R(t.indices.get(\"auxpos1\"), t.vertexAttributes.get(\"auxpos1\").data, i.auxpos1, s, 6), t.indices.get(\"auxpos2\") && t.vertexAttributes.get(\"auxpos2\") && R(t.indices.get(\"auxpos2\"), t.vertexAttributes.get(\"auxpos2\").data, i.auxpos2, s, 6);\n  }\n\n}\n\nexport { W as HUDMaterial };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/webgl-engine/materials/HUDMaterial.js"],"names":["clamp","e","sign","t","isSome","i","createRenderScreenPointArray3","s","f","r","c","n","a","o","l","u","m","p","h","d","g","v","x","b","S","A","q","O","isMat4","P","create","y","newLayout","z","computeAttachmentOriginPoints","C","T","Material","_","materialParametersDefaults","w","applyScaleFactor","j","applyPrecomputedScaleFactor","D","precomputeScaleFactor","M","assert","E","writePosition","V","writeNormal","G","writeColor","I","writeBufferVec4","R","verticalOffsetAtDistance","U","isInstanceHidden","B","H","HUDMaterialTechniqueConfiguration","k","HUDMaterialTechnique","F","W","constructor","me","techniqueConfig","getTechniqueConfig","output","slicePlaneEnabled","params","verticalOffset","screenSizePerspective","screenCenterOffsetUnitsEnabled","centerOffsetUnits","polygonOffsetEnabled","polygonOffset","isDraped","occlusionTestEnabled","occlusionTest","pixelSnappingEnabled","sdf","textureIsSignedDistanceField","vvSize","vvSizeEnabled","vvColor","vvColorEnabled","debugDrawBorder","binaryHighlightOcclusion","depthEnabled","transparencyPassType","multipassGeometryEnabled","multipassTerrainEnabled","cullAboveGround","intersect","intersectDrapedHudGeometry","intersectHudGeometry","vertexAttributes","get","le","screenToWorldRatio","fe","data","length","size","pe","outlineSize","X","options","selectionMode","hud","re","Q","point","camera","pixelRatio","$","viewMatrix","oe","ee","normalAndViewAngle","ce","applyVerticalOffsetTransformationView","Y","applyProjection","te","Math","floor","screenOffset","factorAlignment","factor","ue","ray","se","ae","unprojectFromRenderScreen","direction","origin","computeAttachmentOrigin","indices","createBufferWriter","ge","ne","normal","viewInverseTransposeMatrix","cosAngle","ie","he","updateScaleInfo","scale","minPixelSize","paddingPixels","screenSizePerspectiveAlignment","applyShaderOffsetsView","applyVerticalGroundOffsetView","applyPolygonOffsetView","applyCenterOffsetView","applyShaderOffsetsNDC","applyCenterOffsetNDC","applyPolygonOffsetNDC","aboveGround","shaderPolygonOffset","abs","sqrt","viewport","computeRenderPixelSizeAtDist","screenLength","fullWidth","fullHeight","getGLMaterial","N","J","calculateRelativeScreenBounds","K","L","material","updateParameters","beginSlot","_material","drawInSecondSlot","updateTexture","textureId","selectProgram","_technique","_techniqueRep","releaseAndAcquire","_output","ensureParameters","bind","bindTextures","program","bindTextureScale","bindPass","_isOcclusionSlot","technique","_occlusionTechnique","Z","anchorPos","distanceFieldBoundingBox","texCoordScale","color","outlineColor","vvSizeMinSize","vvSizeMaxSize","vvSizeOffset","vvSizeFactor","vvColorValues","vvColorColors","de","vec3f","vec2f","vec4u8","vec4f","vertexBufferLayout","allocate","createBuffer","elementCount","write","transformation","position","invTranspTransformation","min","uv0","set","auxpos1","auxpos2","HUDMaterial"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{clamp as e,sign as t}from\"../../../../core/mathUtils.js\";import{isSome as i}from\"../../../../core/maybe.js\";import{createRenderScreenPointArray3 as s}from\"../../../../core/screenUtils.js\";import{f as r}from\"../../../../chunks/mat3.js\";import{c as n}from\"../../../../chunks/mat3f64.js\";import{a}from\"../../../../chunks/mat4.js\";import{c as o}from\"../../../../chunks/mat4f64.js\";import{c}from\"../../../../chunks/vec2.js\";import{a as l,f as u}from\"../../../../chunks/vec2f64.js\";import{s as f,m as p,n as h,f as m,a as d,g,l as v,i as x,t as b,d as S,b as A}from\"../../../../chunks/vec3.js\";import{c as q,f as O}from\"../../../../chunks/vec3f64.js\";import{isMat4 as P}from\"../../../../core/libs/gl-matrix-2/types/mat4.js\";import{create as y}from\"../../../../geometry/support/aaBoundingRect.js\";import{newLayout as z}from\"../../support/buffer/InterleavedLayout.js\";import{computeAttachmentOriginPoints as C}from\"../lib/geometryDataUtils.js\";import T from\"../lib/GLMaterialTexture.js\";import{Material as _,materialParametersDefaults as w}from\"../lib/Material.js\";import{applyScaleFactor as j,applyPrecomputedScaleFactor as D,precomputeScaleFactor as M}from\"../lib/screenSizePerspectiveUtils.js\";import{assert as E}from\"../lib/Util.js\";import{writePosition as V,writeNormal as G,writeColor as I,writeBufferVec4 as R}from\"./internal/bufferWriterUtils.js\";import{verticalOffsetAtDistance as U}from\"./internal/MaterialUtil.js\";import{isInstanceHidden as B}from\"./renderers/utils.js\";import{c as H}from\"../../../../chunks/HUDMaterial.glsl.js\";import{HUDMaterialTechniqueConfiguration as k,HUDMaterialTechnique as F}from\"../shaders/HUDMaterialTechnique.js\";class W extends _{constructor(e){super(e,me),this.techniqueConfig=new k}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.verticalOffset=!!this.params.verticalOffset,this.techniqueConfig.screenSizePerspective=!!this.params.screenSizePerspective,this.techniqueConfig.screenCenterOffsetUnitsEnabled=\"screen\"===this.params.centerOffsetUnits?1:0,this.techniqueConfig.polygonOffsetEnabled=this.params.polygonOffset,this.techniqueConfig.isDraped=this.params.isDraped,this.techniqueConfig.occlusionTestEnabled=this.params.occlusionTest,this.techniqueConfig.pixelSnappingEnabled=this.params.pixelSnappingEnabled,this.techniqueConfig.sdf=this.params.textureIsSignedDistanceField,this.techniqueConfig.vvSize=!!this.params.vvSizeEnabled,this.techniqueConfig.vvColor=!!this.params.vvColorEnabled,0===e&&(this.techniqueConfig.debugDrawBorder=!!this.params.debugDrawBorder),4===e&&(this.techniqueConfig.binaryHighlightOcclusion=this.params.binaryHighlightOcclusion),this.techniqueConfig.depthEnabled=this.params.depthEnabled,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassGeometryEnabled=!!t&&t.multipassGeometryEnabled,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}intersect(e,t,i,s,r,n,a,o,c){c?this.intersectDrapedHudGeometry(e,n,a,o):this.intersectHudGeometry(e,t,i,s,a,o)}intersectDrapedHudGeometry(e,t,s,r){const n=e.vertexAttributes.get(\"position\"),a=e.vertexAttributes.get(\"size\"),o=this.params,c=H(o);let l=1,u=1;if(i(r)){const e=r(le);l=e[0],u=e[5]}l*=e.screenToWorldRatio,u*=e.screenToWorldRatio;const f=fe*e.screenToWorldRatio;for(let i=0;i<n.data.length/n.size;i++){const r=i*n.size,p=n.data[r],h=n.data[r+1],m=i*a.size;let d;pe[0]=a.data[m]*l,pe[1]=a.data[m+1]*u,o.textureIsSignedDistanceField&&(d=o.outlineSize*e.screenToWorldRatio/2),X(t,p,h,pe,f,d,o,c)&&s()}}intersectHudGeometry(e,t,s,n,o,c){if(!n.options.selectionMode||!n.options.hud)return;if(B(t))return;const l=this.params;let u=1,b=1;if(r(re,s),i(c)){const e=c(le);u=e[0],b=e[5],Q(re)}const S=e.vertexAttributes.get(\"position\"),A=e.vertexAttributes.get(\"size\"),O=e.vertexAttributes.get(\"normal\"),P=e.vertexAttributes.get(\"auxpos1\");E(S.size>=3);const y=n.point,z=n.camera,C=H(l);u*=z.pixelRatio,b*=z.pixelRatio;const T=\"screen\"===this.params.centerOffsetUnits;for(let i=0;i<S.data.length/S.size;i++){const e=i*S.size;f($,S.data[e],S.data[e+1],S.data[e+2]),p($,$,s);const t=i*A.size;pe[0]=A.data[t]*u,pe[1]=A.data[t+1]*b,p($,$,z.viewMatrix);const r=i*P.size;if(f(oe,P.data[r+0],P.data[r+1],P.data[r+2]),!T&&($[0]+=oe[0],$[1]+=oe[1],0!==oe[2])){const e=oe[2];h(oe,$),m($,$,d(oe,oe,e))}const c=i*O.size;if(f(ee,O.data[c],O.data[c+1],O.data[c+2]),this.normalAndViewAngle(ee,re,z,ce),this.applyVerticalOffsetTransformationView($,ce,z,Y),z.applyProjection($,te),te[0]>-1){let e=Math.floor(te[0])+this.params.screenOffset[0],t=Math.floor(te[1])+this.params.screenOffset[1];T&&(e+=oe[0],0!==oe[1]&&(t+=j(oe[1],Y.factorAlignment))),D(pe,Y.factor,pe);const i=ue*z.pixelRatio;let s;if(l.textureIsSignedDistanceField&&(s=l.outlineSize*z.pixelRatio/2),X(y,e,t,pe,i,s,l,C)){const e=n.ray;if(p(se,$,a(ae,z.viewMatrix)),te[0]=y[0],te[1]=y[1],z.unprojectFromRenderScreen(te,$)){const t=q();g(t,e.direction);const i=1/v(t);d(t,t,i);o(x(e.origin,$)*i,t,-1,1,!0,se)}}}}}computeAttachmentOrigin(e,t){const i=e.vertexAttributes;if(!i)return!1;const s=i.get(\"position\"),r=e.indices.get(\"position\");return C(s,r,t)}createBufferWriter(){return new ge(this)}normalAndViewAngle(e,t,i,s){return P(t)&&(t=r(ne,t)),b(s.normal,e,t),p(s.normal,s.normal,i.viewInverseTransposeMatrix),s.cosAngle=S(ie,he),s}updateScaleInfo(e,t,i){const s=this.params;s.screenSizePerspective?M(i,t,s.screenSizePerspective,e.factor):(e.factor.scale=1,e.factor.factor=0,e.factor.minPixelSize=0,e.factor.paddingPixels=0),s.screenSizePerspectiveAlignment?M(i,t,s.screenSizePerspectiveAlignment,e.factorAlignment):(e.factorAlignment.factor=e.factor.factor,e.factorAlignment.scale=e.factor.scale,e.factorAlignment.minPixelSize=e.factor.minPixelSize,e.factorAlignment.paddingPixels=e.factor.paddingPixels)}applyShaderOffsetsView(e,t,i,s,r,n,a){const o=this.normalAndViewAngle(t,i,r,ce);return this.applyVerticalGroundOffsetView(e,o,r,a),this.applyVerticalOffsetTransformationView(a,o,r,n),this.applyPolygonOffsetView(a,o,s[3],r,a),this.applyCenterOffsetView(a,s,a),a}applyShaderOffsetsNDC(e,t,s,r,n){return this.applyCenterOffsetNDC(e,t,s,r),i(n)&&g(n,r),this.applyPolygonOffsetNDC(r,t,s,r),r}applyPolygonOffsetView(i,s,r,n,a){const o=n.aboveGround?1:-1;let c=t(r);0===c&&(c=o);const l=o*c;if(this.params.shaderPolygonOffset<=0)return g(a,i);const u=e(Math.abs(s.cosAngle),.01,1),f=1-Math.sqrt(1-u*u)/u/n.viewport[2];return d(a,i,l>0?f:1/f),a}applyVerticalGroundOffsetView(e,t,i,s){const r=v(e),n=i.aboveGround?1:-1,a=.5*i.computeRenderPixelSizeAtDist(r),o=d($,t.normal,n*a);return A(s,e,o),s}applyVerticalOffsetTransformationView(e,t,i,s){const r=this.params;if(!r.verticalOffset||!r.verticalOffset.screenLength){if(r.screenSizePerspective||r.screenSizePerspectiveAlignment){const i=v(e);this.updateScaleInfo(s,i,t.cosAngle)}else s.factor.scale=1,s.factorAlignment.scale=1;return e}const n=v(e),a=r.screenSizePerspectiveAlignment||r.screenSizePerspective,o=U(i,n,r.verticalOffset,t.cosAngle,a);return this.updateScaleInfo(s,n,t.cosAngle),d(t.normal,t.normal,o),A(e,e,t.normal)}applyCenterOffsetView(e,t,i){const s=\"screen\"!==this.params.centerOffsetUnits;return i!==e&&g(i,e),s&&(i[0]+=t[0],i[1]+=t[1],t[2]&&(h(ee,i),A(i,i,d(ee,ee,t[2])))),i}applyCenterOffsetNDC(e,t,i,s){const r=\"screen\"!==this.params.centerOffsetUnits;return s!==e&&g(s,e),r||(s[0]+=t[0]/i.fullWidth*2,s[1]+=t[1]/i.fullHeight*2),s}applyPolygonOffsetNDC(e,i,s,r){const n=this.params.shaderPolygonOffset;if(e!==r&&g(r,e),n){const e=s.aboveGround?1:-1,a=e*t(i[3]);r[2]-=(a||e)*n}return r}getGLMaterial(e){return 0===e.output||7===e.output?new N(e):4===e.output?new J(e):void 0}calculateRelativeScreenBounds(e,t,i=y()){return K(this.params,e,t,i),i[2]=i[0]+e[0],i[3]=i[1]+e[1],i}}class L extends T{constructor(e){super({...e,...e.material.params}),this.updateParameters()}beginSlot(e){return e===(this._material.params.drawInSecondSlot?19:18)}updateParameters(e){this.updateTexture(this._material.params.textureId),this.selectProgram(e)}selectProgram(e){this._technique=this._techniqueRep.releaseAndAcquire(F,this._material.getTechniqueConfig(this._output,e),this._technique)}ensureParameters(e){this.updateParameters(e)}bind(e){this.bindTextures(this._technique.program),this.bindTextureScale(this._technique.program),this._technique.bindPass(this._material.params,e)}}class N extends L{constructor(e){super(e),this._isOcclusionSlot=!1}beginSlot(e){const t=this._material.params.drawInSecondSlot?19:18;return this._material.params.occlusionTest?(this._isOcclusionSlot=12===e,12===e||e===t):(this._isOcclusionSlot=!1,e===t)}get technique(){return this._isOcclusionSlot?this._occlusionTechnique:this._technique}selectProgram(e){this._technique=this._techniqueRep.releaseAndAcquire(F,this._material.getTechniqueConfig(this._output,e),this._technique),this._occlusionTechnique=this._techniqueRep.releaseAndAcquire(F,this._material.getTechniqueConfig(6,e),this._occlusionTechnique)}bind(e){const t=this.technique;this._isOcclusionSlot||(this.bindTextures(t.program),this.bindTextureScale(t.program)),t.bindPass(this._material.params,e)}}class J extends L{constructor(e){super({...e,output:4})}}function K(e,t,i,s=Z){return c(s,e.anchorPos),s[0]*=-t[0],s[1]*=-t[1],s[0]+=e.screenOffset[0]*i,s[1]+=e.screenOffset[1]*i,s}function Q(e){const t=e[0],i=e[1],s=e[2],r=e[3],n=e[4],a=e[5],o=e[6],c=e[7],l=e[8],u=1/Math.sqrt(t*t+i*i+s*s),f=1/Math.sqrt(r*r+n*n+a*a),p=1/Math.sqrt(o*o+c*c+l*l);return e[0]=t*u,e[1]=i*u,e[2]=s*u,e[3]=r*f,e[4]=n*f,e[5]=a*f,e[6]=o*p,e[7]=c*p,e[8]=l*p,e}function X(e,t,i,s,r,n,a,o){let c=t-r-(o[0]>0?s[0]*o[0]:0),l=c+s[0]+2*r,u=i-r-(o[1]>0?s[1]*o[1]:0),f=u+s[1]+2*r;if(a.textureIsSignedDistanceField){const e=a.distanceFieldBoundingBox;c+=s[0]*e[0],u+=s[1]*e[1],l-=s[0]*(1-e[2]),f-=s[1]*(1-e[3]),c-=n,l+=n,u-=n,f+=n}return e[0]>c&&e[0]<l&&e[1]>u&&e[1]<f}const Y={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}},Z=l(),$=q(),ee=q(),te=s(),ie=q(),se=q(),re=n(),ne=n(),ae=o(),oe=q(),ce={normal:ie,cosAngle:0},le=o(),ue=1,fe=2,pe=[0,0],he=O(0,0,1),me={texCoordScale:[1,1],occlusionTest:!0,binaryHighlightOcclusion:!0,drawInSecondSlot:!1,color:[1,1,1,1],outlineColor:[1,1,1,1],outlineSize:0,textureIsSignedDistanceField:!1,distanceFieldBoundingBox:null,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],screenOffset:[0,0],verticalOffset:null,screenSizePerspective:null,screenSizePerspectiveAlignment:null,slicePlaneEnabled:!1,anchorPos:u(.5,.5),shaderPolygonOffset:1e-5,polygonOffset:!1,textureId:null,centerOffsetUnits:\"world\",depthEnabled:!0,pixelSnappingEnabled:!0,debugDrawBorder:!1,isDraped:!1,...w},de=z().vec3f(\"position\").vec3f(\"normal\").vec2f(\"uv0\").vec4u8(\"color\").vec2f(\"size\").vec4f(\"auxpos1\").vec4f(\"auxpos2\");class ge{constructor(e){this.material=e,this.vertexBufferLayout=de}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 6*e.indices.get(\"position\").length}write(e,t,i,s){V(t.indices.get(\"position\"),t.vertexAttributes.get(\"position\").data,e.transformation,i.position,s,6),G(t.indices.get(\"normal\"),t.vertexAttributes.get(\"normal\").data,e.invTranspTransformation,i.normal,s,6);{const e=t.vertexAttributes.get(\"uv0\").data;let r,n,a,o;if(null==e||e.length<4){const e=this.material.params;r=0,n=0,a=e.texCoordScale[0],o=e.texCoordScale[1]}else r=e[0],n=e[1],a=e[2],o=e[3];a=Math.min(1.99999,a+1),o=Math.min(1.99999,o+1);const c=t.indices.get(\"position\").length,l=i.uv0;let u=s;for(let t=0;t<c;++t)l.set(u,0,r),l.set(u,1,n),u+=1,l.set(u,0,a),l.set(u,1,n),u+=1,l.set(u,0,a),l.set(u,1,o),u+=1,l.set(u,0,a),l.set(u,1,o),u+=1,l.set(u,0,r),l.set(u,1,o),u+=1,l.set(u,0,r),l.set(u,1,n),u+=1}I(t.indices.get(\"color\"),t.vertexAttributes.get(\"color\").data,4,i.color,s,6);{const e=t.indices.get(\"size\"),r=t.vertexAttributes.get(\"size\").data,n=e.length,a=i.size;let o=s;for(let t=0;t<n;++t){const i=r[2*e[t]],s=r[2*e[t]+1];for(let e=0;e<6;++e)a.set(o,0,i),a.set(o,1,s),o+=1}}t.indices.get(\"auxpos1\")&&t.vertexAttributes.get(\"auxpos1\")&&R(t.indices.get(\"auxpos1\"),t.vertexAttributes.get(\"auxpos1\").data,i.auxpos1,s,6),t.indices.get(\"auxpos2\")&&t.vertexAttributes.get(\"auxpos2\")&&R(t.indices.get(\"auxpos2\"),t.vertexAttributes.get(\"auxpos2\").data,i.auxpos2,s,6)}}export{W as HUDMaterial};\n"]},"metadata":{},"sourceType":"module"}