{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { lerp as t, clamp as e } from \"../../../core/mathUtils.js\";\nimport { i, b as n, j as o, r as a } from \"../../../chunks/mat4.js\";\nimport { c as l } from \"../../../chunks/mat4f64.js\";\nimport { s, e as u, m as r } from \"../../../chunks/vec3.js\";\nimport { f as c, c as f } from \"../../../chunks/vec3f64.js\";\nimport { S as m } from \"../../../chunks/SunCalc.js\";\nconst d = {\n  local: {\n    altitude: 1500,\n    ambientAtNight: .1,\n    ambientAtNoon: .45,\n    ambientAtTwilight: .2,\n    diffuseAtNoon: .65,\n    diffuseAtTwilight: .7\n  },\n  global: {\n    altitude: 8e5,\n    ambient: .015,\n    diffuse: .75\n  },\n  planarDirection: {\n    localAltitude: 1e4,\n    globalAltitude: 1e6,\n    globalAngles: {\n      azimuth: 1.3 * Math.PI,\n      altitude: .6 * Math.PI\n    }\n  }\n};\n\nfunction g(i, n) {\n  const o = n[2],\n        a = O;\n  s(a.ambient.color, 1, 1, 1), a.ambient.intensity = d.global.ambient, s(a.diffuse.color, 1, 1, 1), a.diffuse.intensity = d.global.diffuse;\n  let l = (Math.abs(o) - d.local.altitude) / (d.global.altitude - d.local.altitude);\n  l = e(l, 0, 1), a.globalFactor = l;\n  const r = m.getTimes(i, n[1], n[0]);\n\n  if (l < 1) {\n    const e = y(i, r);\n    u(a.ambient.color, e.ambient.color, a.ambient.color, l), a.ambient.intensity = t(e.ambient.intensity, a.ambient.intensity, l), u(a.diffuse.color, e.diffuse.color, a.diffuse.color, l), a.diffuse.intensity = t(e.diffuse.intensity, a.diffuse.intensity, l);\n  }\n\n  return a.noonFactor = T(i, r), a;\n}\n\nfunction b(t, l, u, c) {\n  c || (c = f());\n  const g = N,\n        b = i(p);\n  if (\"global\" === u) m.getPosition(t, 0, 0, g), s(c, 0, 0, -1), n(b, b, -g.azimuth), o(b, b, -g.altitude), r(c, c, b);else {\n    const i = d.planarDirection,\n          o = i.globalAngles,\n          u = l[2];\n    let f = (Math.abs(u) - i.localAltitude) / (i.globalAltitude - i.localAltitude);\n    f = e(f, 0, 1), f < 1 ? (m.getPosition(t, l[1], l[0], g), g.azimuth = (1 - f) * g.azimuth + f * o.azimuth, g.altitude = (1 - f) * g.altitude + f * o.altitude) : (g.azimuth = o.azimuth, g.altitude = o.altitude), s(c, 0, -1, 0), a(b, b, -g.azimuth), n(b, b, -g.altitude), r(c, c, b);\n  }\n  return c;\n}\n\nfunction h(t, e) {\n  if (\"global\" === e) return !0;\n  {\n    const e = d.planarDirection,\n          i = t[2];\n    return Math.abs(i) < e.localAltitude;\n  }\n}\n\nfunction A(t, e, i, n, o) {\n  const a = o.length;\n  if (a < 1) return o;\n  const l = t.getTime(),\n        s = (e.getTime() - l) / a;\n\n  for (let u = 0; u < a; ++u) E.setTime(l + s * u), b(E, i, n, o[u]);\n\n  return o;\n}\n\nconst p = l(),\n      N = {\n  azimuth: 0,\n  altitude: 0\n},\n      O = {\n  ambient: {\n    color: f(),\n    intensity: 0\n  },\n  diffuse: {\n    color: f(),\n    intensity: 0,\n    directionToLightSource: f()\n  },\n  globalFactor: 0,\n  noonFactor: 0\n};\n\nfunction T(t, i) {\n  const n = t.valueOf();\n  let o, a;\n  i.polarException === m.POLAR_EXCEPTION.MIDNIGHT_SUN ? (o = n - 60 * (t.getHours() + 48) * 60 * 1e3 - 60 * t.getMinutes() * 1e3, a = o + 432e6) : i.polarException === m.POLAR_EXCEPTION.POLAR_NIGHT ? (o = n - 2, a = n - 1) : (o = i.sunrise.valueOf(), a = i.sunset.valueOf());\n  const l = o + (a - o) / 2;\n  return 1 - e(Math.abs(n - l) / 432e5, 0, 1);\n}\n\nfunction y(t, e) {\n  const i = t.valueOf();\n  let n, o;\n  e.polarException === m.POLAR_EXCEPTION.MIDNIGHT_SUN ? (n = i - 60 * (t.getHours() + 48) * 60 * 1e3 - 60 * t.getMinutes() * 1e3, o = n + 432e6) : e.polarException === m.POLAR_EXCEPTION.POLAR_NIGHT ? (n = i - 2, o = i - 1) : (n = e.sunrise.valueOf(), o = e.sunset.valueOf());\n  const a = o - n,\n        l = n + a / 2,\n        s = a / 4,\n        u = l - s,\n        r = l + s,\n        f = .06 * a,\n        g = n - f / 2,\n        b = n + f / 2,\n        h = o - f / 2,\n        A = o + f / 2,\n        p = d.local,\n        N = [.01, p.ambientAtNight],\n        O = [.8, .8, 1],\n        T = [.01, .01, .01],\n        y = [p.diffuseAtTwilight, p.ambientAtTwilight],\n        E = [1, .75, .75],\n        I = [.8, .8, 1],\n        M = [.9 * p.diffuseAtNoon, p.ambientAtNoon],\n        z = [1, .98, .98],\n        v = [.98, .98, 1],\n        _ = [p.diffuseAtNoon, p.ambientAtNoon],\n        j = [1, 1, 1],\n        D = [1, 1, 1],\n        L = M,\n        H = z,\n        R = v,\n        k = y,\n        w = E,\n        x = I;\n  let C,\n      S,\n      F = [0, 0],\n      G = [0, 0, 0],\n      X = [0, 0, 0];\n  return i < g || i > A ? (F = N, G = T, X = O, S = \"night\") : i < b ? (C = b - g, F = P(i - g, C, N, y), G = P(i - g, C, T, E), X = P(i - g, C, O, I), S = \"sun rising\") : i < u ? (C = u - b, F = P(i - b, C, y, M), G = P(i - b, C, E, z), X = P(i - b, C, I, v), S = \"early morning\") : i < l ? (C = l - u, F = P(i - u, C, M, _), G = P(i - u, C, z, j), X = P(i - u, C, v, D), S = \"late morning\") : i < r ? (C = r - l, F = P(i - l, C, _, L), G = P(i - l, C, j, H), X = P(i - l, C, D, R), S = \"early afternoon\") : i < h ? (C = h - r, F = P(i - r, C, L, k), G = P(i - r, C, H, w), X = P(i - r, C, R, x), S = \"late afternoon\") : i < A && (C = A - h, F = P(i - h, C, k, N), G = P(i - h, C, w, T), X = P(i - h, C, x, O), S = \"sun setting\"), {\n    diffuse: {\n      intensity: F[0],\n      color: c(G[0], G[1], G[2])\n    },\n    ambient: {\n      intensity: F[1],\n      color: c(X[0], X[1], X[2])\n    },\n    timeOfDay: S\n  };\n}\n\nfunction P(t, e, i, n) {\n  const o = [];\n\n  for (let a = 0; a < i.length; a++) o[a] = (n[a] - i[a]) * t / e + i[a];\n\n  return o;\n}\n\nconst E = new Date(0);\nexport { g as computeColorAndIntensity, b as computeDirection, A as computeDirectionsOverTime, h as computeShadowsEnabled, d as settings };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/support/sunUtils.js"],"names":["lerp","t","clamp","e","i","b","n","j","o","r","a","c","l","s","u","m","f","S","d","local","altitude","ambientAtNight","ambientAtNoon","ambientAtTwilight","diffuseAtNoon","diffuseAtTwilight","global","ambient","diffuse","planarDirection","localAltitude","globalAltitude","globalAngles","azimuth","Math","PI","g","O","color","intensity","abs","globalFactor","getTimes","y","noonFactor","T","N","p","getPosition","h","A","length","getTime","E","setTime","directionToLightSource","valueOf","polarException","POLAR_EXCEPTION","MIDNIGHT_SUN","getHours","getMinutes","POLAR_NIGHT","sunrise","sunset","I","M","z","v","_","D","L","H","R","k","w","x","C","F","G","X","P","timeOfDay","Date","computeColorAndIntensity","computeDirection","computeDirectionsOverTime","computeShadowsEnabled","settings"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{lerp as t,clamp as e}from\"../../../core/mathUtils.js\";import{i,b as n,j as o,r as a}from\"../../../chunks/mat4.js\";import{c as l}from\"../../../chunks/mat4f64.js\";import{s,e as u,m as r}from\"../../../chunks/vec3.js\";import{f as c,c as f}from\"../../../chunks/vec3f64.js\";import{S as m}from\"../../../chunks/SunCalc.js\";const d={local:{altitude:1500,ambientAtNight:.1,ambientAtNoon:.45,ambientAtTwilight:.2,diffuseAtNoon:.65,diffuseAtTwilight:.7},global:{altitude:8e5,ambient:.015,diffuse:.75},planarDirection:{localAltitude:1e4,globalAltitude:1e6,globalAngles:{azimuth:1.3*Math.PI,altitude:.6*Math.PI}}};function g(i,n){const o=n[2],a=O;s(a.ambient.color,1,1,1),a.ambient.intensity=d.global.ambient,s(a.diffuse.color,1,1,1),a.diffuse.intensity=d.global.diffuse;let l=(Math.abs(o)-d.local.altitude)/(d.global.altitude-d.local.altitude);l=e(l,0,1),a.globalFactor=l;const r=m.getTimes(i,n[1],n[0]);if(l<1){const e=y(i,r);u(a.ambient.color,e.ambient.color,a.ambient.color,l),a.ambient.intensity=t(e.ambient.intensity,a.ambient.intensity,l),u(a.diffuse.color,e.diffuse.color,a.diffuse.color,l),a.diffuse.intensity=t(e.diffuse.intensity,a.diffuse.intensity,l)}return a.noonFactor=T(i,r),a}function b(t,l,u,c){c||(c=f());const g=N,b=i(p);if(\"global\"===u)m.getPosition(t,0,0,g),s(c,0,0,-1),n(b,b,-g.azimuth),o(b,b,-g.altitude),r(c,c,b);else{const i=d.planarDirection,o=i.globalAngles,u=l[2];let f=(Math.abs(u)-i.localAltitude)/(i.globalAltitude-i.localAltitude);f=e(f,0,1),f<1?(m.getPosition(t,l[1],l[0],g),g.azimuth=(1-f)*g.azimuth+f*o.azimuth,g.altitude=(1-f)*g.altitude+f*o.altitude):(g.azimuth=o.azimuth,g.altitude=o.altitude),s(c,0,-1,0),a(b,b,-g.azimuth),n(b,b,-g.altitude),r(c,c,b)}return c}function h(t,e){if(\"global\"===e)return!0;{const e=d.planarDirection,i=t[2];return Math.abs(i)<e.localAltitude}}function A(t,e,i,n,o){const a=o.length;if(a<1)return o;const l=t.getTime(),s=(e.getTime()-l)/a;for(let u=0;u<a;++u)E.setTime(l+s*u),b(E,i,n,o[u]);return o}const p=l(),N={azimuth:0,altitude:0},O={ambient:{color:f(),intensity:0},diffuse:{color:f(),intensity:0,directionToLightSource:f()},globalFactor:0,noonFactor:0};function T(t,i){const n=t.valueOf();let o,a;i.polarException===m.POLAR_EXCEPTION.MIDNIGHT_SUN?(o=n-60*(t.getHours()+48)*60*1e3-60*t.getMinutes()*1e3,a=o+432e6):i.polarException===m.POLAR_EXCEPTION.POLAR_NIGHT?(o=n-2,a=n-1):(o=i.sunrise.valueOf(),a=i.sunset.valueOf());const l=o+(a-o)/2;return 1-e(Math.abs(n-l)/432e5,0,1)}function y(t,e){const i=t.valueOf();let n,o;e.polarException===m.POLAR_EXCEPTION.MIDNIGHT_SUN?(n=i-60*(t.getHours()+48)*60*1e3-60*t.getMinutes()*1e3,o=n+432e6):e.polarException===m.POLAR_EXCEPTION.POLAR_NIGHT?(n=i-2,o=i-1):(n=e.sunrise.valueOf(),o=e.sunset.valueOf());const a=o-n,l=n+a/2,s=a/4,u=l-s,r=l+s,f=.06*a,g=n-f/2,b=n+f/2,h=o-f/2,A=o+f/2,p=d.local,N=[.01,p.ambientAtNight],O=[.8,.8,1],T=[.01,.01,.01],y=[p.diffuseAtTwilight,p.ambientAtTwilight],E=[1,.75,.75],I=[.8,.8,1],M=[.9*p.diffuseAtNoon,p.ambientAtNoon],z=[1,.98,.98],v=[.98,.98,1],_=[p.diffuseAtNoon,p.ambientAtNoon],j=[1,1,1],D=[1,1,1],L=M,H=z,R=v,k=y,w=E,x=I;let C,S,F=[0,0],G=[0,0,0],X=[0,0,0];return i<g||i>A?(F=N,G=T,X=O,S=\"night\"):i<b?(C=b-g,F=P(i-g,C,N,y),G=P(i-g,C,T,E),X=P(i-g,C,O,I),S=\"sun rising\"):i<u?(C=u-b,F=P(i-b,C,y,M),G=P(i-b,C,E,z),X=P(i-b,C,I,v),S=\"early morning\"):i<l?(C=l-u,F=P(i-u,C,M,_),G=P(i-u,C,z,j),X=P(i-u,C,v,D),S=\"late morning\"):i<r?(C=r-l,F=P(i-l,C,_,L),G=P(i-l,C,j,H),X=P(i-l,C,D,R),S=\"early afternoon\"):i<h?(C=h-r,F=P(i-r,C,L,k),G=P(i-r,C,H,w),X=P(i-r,C,R,x),S=\"late afternoon\"):i<A&&(C=A-h,F=P(i-h,C,k,N),G=P(i-h,C,w,T),X=P(i-h,C,x,O),S=\"sun setting\"),{diffuse:{intensity:F[0],color:c(G[0],G[1],G[2])},ambient:{intensity:F[1],color:c(X[0],X[1],X[2])},timeOfDay:S}}function P(t,e,i,n){const o=[];for(let a=0;a<i.length;a++)o[a]=(n[a]-i[a])*t/e+i[a];return o}const E=new Date(0);export{g as computeColorAndIntensity,b as computeDirection,A as computeDirectionsOverTime,h as computeShadowsEnabled,d as settings};\n"]},"metadata":{},"sourceType":"module"}