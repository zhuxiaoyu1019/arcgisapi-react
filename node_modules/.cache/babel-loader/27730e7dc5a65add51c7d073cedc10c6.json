{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { PathTransformationCursor as e, getCoord2D as t } from \"../CIMCursor.js\";\nimport { CurveHelper as s } from \"../CurveHelper.js\";\n\nclass i {\n  static local() {\n    return null === i.instance && (i.instance = new i()), i.instance;\n  }\n\n  execute(e, t, s) {\n    return new n(e, t, s);\n  }\n\n}\n\ni.instance = null;\n\nclass n extends e {\n  constructor(e, t, i) {\n    super(e, !1, !0), this._curveHelper = new s(), this._angleToLine = void 0 === t.angleToLine || t.angleToLine, this._offset = void 0 !== t.offset ? t.offset * i : 0, this._type = t.extremityPlacement, this._position = void 0 !== t.offsetAlongLine ? t.offsetAlongLine * i : 0, this._beginProcessed = !1;\n  }\n\n  processPath(e) {\n    let t;\n\n    switch (this._type) {\n      case \"Both\":\n      default:\n        this._beginProcessed ? (t = this._atExtremities(e, this._position, !1), this._beginProcessed = !1, this.iteratePath = !1) : (t = this._atExtremities(e, this._position, !0), this._beginProcessed = !0, this.iteratePath = !0);\n        break;\n\n      case \"JustBegin\":\n        t = this._atExtremities(e, this._position, !0);\n        break;\n\n      case \"JustEnd\":\n        t = this._atExtremities(e, this._position, !1);\n        break;\n\n      case \"None\":\n    }\n\n    return t;\n  }\n\n  _atExtremities(e, s, i) {\n    const n = e.length;\n    if (n < 2) return null;\n    const r = i ? 1 : n - 2,\n          o = i ? n : -1,\n          a = i ? 1 : -1;\n    let l,\n        h = 0,\n        c = i ? e[0] : e[n - 1];\n\n    for (let _ = r; _ !== o; _ += a) {\n      l = c, c = e[_];\n\n      const i = this._curveHelper.calculateLength(l, c);\n\n      if (h + i > s) {\n        const e = (s - h) / i,\n              [n, r] = this._curveHelper.getAngleCS(l, c, e),\n              o = t(l, c, e);\n\n        return this.internalPlacement.setTranslate(o[0] - this._offset * r, o[1] + this._offset * n), this._angleToLine && this.internalPlacement.setRotateCS(-n, -r), this.internalPlacement;\n      }\n\n      h += i;\n    }\n\n    return null;\n  }\n\n}\n\nexport { i as PlacementAtExtremities };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/symbols/cim/placements/PlacementAtExtremities.js"],"names":["PathTransformationCursor","e","getCoord2D","t","CurveHelper","s","i","local","instance","execute","n","constructor","_curveHelper","_angleToLine","angleToLine","_offset","offset","_type","extremityPlacement","_position","offsetAlongLine","_beginProcessed","processPath","_atExtremities","iteratePath","length","r","o","a","l","h","c","_","calculateLength","getAngleCS","internalPlacement","setTranslate","setRotateCS","PlacementAtExtremities"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,wBAAwB,IAAIC,CAAnC,EAAqCC,UAAU,IAAIC,CAAnD,QAAyD,iBAAzD;AAA2E,SAAOC,WAAW,IAAIC,CAAtB,QAA4B,mBAA5B;;AAAgD,MAAMC,CAAN,CAAO;AAAa,SAALC,KAAK,GAAE;AAAC,WAAO,SAAOD,CAAC,CAACE,QAAT,KAAoBF,CAAC,CAACE,QAAF,GAAW,IAAIF,CAAJ,EAA/B,GAAsCA,CAAC,CAACE,QAA/C;AAAwD;;AAAAC,EAAAA,OAAO,CAACR,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAO;AAAC,WAAO,IAAIK,CAAJ,CAAMT,CAAN,EAAQE,CAAR,EAAUE,CAAV,CAAP;AAAoB;;AAA3G;;AAA4GC,CAAC,CAACE,QAAF,GAAW,IAAX;;AAAgB,MAAME,CAAN,SAAgBT,CAAhB,CAAiB;AAACU,EAAAA,WAAW,CAACV,CAAD,EAAGE,CAAH,EAAKG,CAAL,EAAO;AAAC,UAAML,CAAN,EAAQ,CAAC,CAAT,EAAW,CAAC,CAAZ,GAAe,KAAKW,YAAL,GAAkB,IAAIP,CAAJ,EAAjC,EAAuC,KAAKQ,YAAL,GAAkB,KAAK,CAAL,KAASV,CAAC,CAACW,WAAX,IAAwBX,CAAC,CAACW,WAAnF,EAA+F,KAAKC,OAAL,GAAa,KAAK,CAAL,KAASZ,CAAC,CAACa,MAAX,GAAkBb,CAAC,CAACa,MAAF,GAASV,CAA3B,GAA6B,CAAzI,EAA2I,KAAKW,KAAL,GAAWd,CAAC,CAACe,kBAAxJ,EAA2K,KAAKC,SAAL,GAAe,KAAK,CAAL,KAAShB,CAAC,CAACiB,eAAX,GAA2BjB,CAAC,CAACiB,eAAF,GAAkBd,CAA7C,GAA+C,CAAzO,EAA2O,KAAKe,eAAL,GAAqB,CAAC,CAAjQ;AAAmQ;;AAAAC,EAAAA,WAAW,CAACrB,CAAD,EAAG;AAAC,QAAIE,CAAJ;;AAAM,YAAO,KAAKc,KAAZ;AAAmB,WAAI,MAAJ;AAAW;AAAQ,aAAKI,eAAL,IAAsBlB,CAAC,GAAC,KAAKoB,cAAL,CAAoBtB,CAApB,EAAsB,KAAKkB,SAA3B,EAAqC,CAAC,CAAtC,CAAF,EAA2C,KAAKE,eAAL,GAAqB,CAAC,CAAjE,EAAmE,KAAKG,WAAL,GAAiB,CAAC,CAA3G,KAA+GrB,CAAC,GAAC,KAAKoB,cAAL,CAAoBtB,CAApB,EAAsB,KAAKkB,SAA3B,EAAqC,CAAC,CAAtC,CAAF,EAA2C,KAAKE,eAAL,GAAqB,CAAC,CAAjE,EAAmE,KAAKG,WAAL,GAAiB,CAAC,CAApM;AAAuM;;AAAM,WAAI,WAAJ;AAAgBrB,QAAAA,CAAC,GAAC,KAAKoB,cAAL,CAAoBtB,CAApB,EAAsB,KAAKkB,SAA3B,EAAqC,CAAC,CAAtC,CAAF;AAA2C;;AAAM,WAAI,SAAJ;AAAchB,QAAAA,CAAC,GAAC,KAAKoB,cAAL,CAAoBtB,CAApB,EAAsB,KAAKkB,SAA3B,EAAqC,CAAC,CAAtC,CAAF;AAA2C;;AAAM,WAAI,MAAJ;AAAnX;;AAA+X,WAAOhB,CAAP;AAAS;;AAAAoB,EAAAA,cAAc,CAACtB,CAAD,EAAGI,CAAH,EAAKC,CAAL,EAAO;AAAC,UAAMI,CAAC,GAACT,CAAC,CAACwB,MAAV;AAAiB,QAAGf,CAAC,GAAC,CAAL,EAAO,OAAO,IAAP;AAAY,UAAMgB,CAAC,GAACpB,CAAC,GAAC,CAAD,GAAGI,CAAC,GAAC,CAAd;AAAA,UAAgBiB,CAAC,GAACrB,CAAC,GAACI,CAAD,GAAG,CAAC,CAAvB;AAAA,UAAyBkB,CAAC,GAACtB,CAAC,GAAC,CAAD,GAAG,CAAC,CAAhC;AAAkC,QAAIuB,CAAJ;AAAA,QAAMC,CAAC,GAAC,CAAR;AAAA,QAAUC,CAAC,GAACzB,CAAC,GAACL,CAAC,CAAC,CAAD,CAAF,GAAMA,CAAC,CAACS,CAAC,GAAC,CAAH,CAApB;;AAA0B,SAAI,IAAIsB,CAAC,GAACN,CAAV,EAAYM,CAAC,KAAGL,CAAhB,EAAkBK,CAAC,IAAEJ,CAArB,EAAuB;AAACC,MAAAA,CAAC,GAACE,CAAF,EAAIA,CAAC,GAAC9B,CAAC,CAAC+B,CAAD,CAAP;;AAAW,YAAM1B,CAAC,GAAC,KAAKM,YAAL,CAAkBqB,eAAlB,CAAkCJ,CAAlC,EAAoCE,CAApC,CAAR;;AAA+C,UAAGD,CAAC,GAACxB,CAAF,GAAID,CAAP,EAAS;AAAC,cAAMJ,CAAC,GAAC,CAACI,CAAC,GAACyB,CAAH,IAAMxB,CAAd;AAAA,cAAgB,CAACI,CAAD,EAAGgB,CAAH,IAAM,KAAKd,YAAL,CAAkBsB,UAAlB,CAA6BL,CAA7B,EAA+BE,CAA/B,EAAiC9B,CAAjC,CAAtB;AAAA,cAA0D0B,CAAC,GAACxB,CAAC,CAAC0B,CAAD,EAAGE,CAAH,EAAK9B,CAAL,CAA7D;;AAAqE,eAAO,KAAKkC,iBAAL,CAAuBC,YAAvB,CAAoCT,CAAC,CAAC,CAAD,CAAD,GAAK,KAAKZ,OAAL,GAAaW,CAAtD,EAAwDC,CAAC,CAAC,CAAD,CAAD,GAAK,KAAKZ,OAAL,GAAaL,CAA1E,GAA6E,KAAKG,YAAL,IAAmB,KAAKsB,iBAAL,CAAuBE,WAAvB,CAAmC,CAAC3B,CAApC,EAAsC,CAACgB,CAAvC,CAAhG,EAA0I,KAAKS,iBAAtJ;AAAwK;;AAAAL,MAAAA,CAAC,IAAExB,CAAH;AAAK;;AAAA,WAAO,IAAP;AAAY;;AAApoC;;AAAqoC,SAAOA,CAAC,IAAIgC,sBAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{PathTransformationCursor as e,getCoord2D as t}from\"../CIMCursor.js\";import{CurveHelper as s}from\"../CurveHelper.js\";class i{static local(){return null===i.instance&&(i.instance=new i),i.instance}execute(e,t,s){return new n(e,t,s)}}i.instance=null;class n extends e{constructor(e,t,i){super(e,!1,!0),this._curveHelper=new s,this._angleToLine=void 0===t.angleToLine||t.angleToLine,this._offset=void 0!==t.offset?t.offset*i:0,this._type=t.extremityPlacement,this._position=void 0!==t.offsetAlongLine?t.offsetAlongLine*i:0,this._beginProcessed=!1}processPath(e){let t;switch(this._type){case\"Both\":default:this._beginProcessed?(t=this._atExtremities(e,this._position,!1),this._beginProcessed=!1,this.iteratePath=!1):(t=this._atExtremities(e,this._position,!0),this._beginProcessed=!0,this.iteratePath=!0);break;case\"JustBegin\":t=this._atExtremities(e,this._position,!0);break;case\"JustEnd\":t=this._atExtremities(e,this._position,!1);break;case\"None\":}return t}_atExtremities(e,s,i){const n=e.length;if(n<2)return null;const r=i?1:n-2,o=i?n:-1,a=i?1:-1;let l,h=0,c=i?e[0]:e[n-1];for(let _=r;_!==o;_+=a){l=c,c=e[_];const i=this._curveHelper.calculateLength(l,c);if(h+i>s){const e=(s-h)/i,[n,r]=this._curveHelper.getAngleCS(l,c,e),o=t(l,c,e);return this.internalPlacement.setTranslate(o[0]-this._offset*r,o[1]+this._offset*n),this._angleToLine&&this.internalPlacement.setRotateCS(-n,-r),this.internalPlacement}h+=i}return null}}export{i as PlacementAtExtremities};\n"]},"metadata":{},"sourceType":"module"}