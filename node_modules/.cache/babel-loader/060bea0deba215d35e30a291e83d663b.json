{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../core/maybe.js\";\nimport { urlToObject as r, removeTrailingSlash as t, removeQueryParameters as n, join as s, Url as i, makeAbsolute as o } from \"../../core/urlUtils.js\";\nimport { w as l } from \"../../chunks/persistableUrlUtils.js\";\nconst u = [\"MapServer\", \"ImageServer\", \"FeatureServer\", \"SceneServer\", \"StreamServer\", \"VectorTileServer\"],\n      a = new RegExp(`^((?:https?:)?\\\\/\\\\/\\\\S+?\\\\/rest\\\\/services\\\\/(.+?)\\\\/(${u.join(\"|\")}))(?:\\\\/(?:layers\\\\/)?(\\\\d+))?`, \"i\"),\n      c = new RegExp(`^((?:https?:)?\\\\/\\\\/\\\\S+?\\\\/([^\\\\/\\\\n]+)\\\\/(${u.join(\"|\")}))(?:\\\\/(?:layers\\\\/)?(\\\\d+))?`, \"i\"),\n      f = /(.*?)\\/(?:layers\\/)?(\\d+)\\/?$/i;\n\nfunction p(e) {\n  return !!a.test(e);\n}\n\nfunction d(e) {\n  const t = r(e),\n        n = t.path.match(a) || t.path.match(c);\n  if (!n) return null;\n  const [, s, i, o, l] = n,\n        u = i.indexOf(\"/\");\n  return {\n    title: v(-1 !== u ? i.slice(u + 1) : i),\n    serverType: o,\n    sublayer: null != l && \"\" !== l ? parseInt(l, 10) : null,\n    url: {\n      path: s\n    }\n  };\n}\n\nfunction m(e) {\n  const t = r(e).path.match(f);\n  return t ? {\n    serviceUrl: t[1],\n    sublayerId: Number(t[2])\n  } : null;\n}\n\nfunction v(e) {\n  return (e = e.replace(/\\s*[/_]+\\s*/g, \" \"))[0].toUpperCase() + e.slice(1);\n}\n\nfunction h(r, t) {\n  const n = [];\n\n  if (r) {\n    const t = d(r);\n    e(t) && t.title && n.push(t.title);\n  }\n\n  if (t) {\n    const e = v(t);\n    n.push(e);\n  }\n\n  if (2 === n.length) {\n    if (-1 !== n[0].toLowerCase().indexOf(n[1].toLowerCase())) return n[0];\n    if (-1 !== n[1].toLowerCase().indexOf(n[0].toLowerCase())) return n[1];\n  }\n\n  return n.join(\" - \");\n}\n\nfunction w(e) {\n  if (!e) return !1;\n  const r = \".arcgis.com/\",\n        t = \"//services\",\n        n = \"//tiles\",\n        s = \"//features\",\n        i = -1 !== (e = e.toLowerCase()).indexOf(r),\n        o = -1 !== e.indexOf(t) || -1 !== e.indexOf(n) || -1 !== e.indexOf(s);\n  return i && o;\n}\n\nfunction y(e, r) {\n  return r && e && -1 !== e.toLowerCase().indexOf(r.toLowerCase());\n}\n\nfunction x(e, r) {\n  return e ? t(n(e, r)) : e;\n}\n\nfunction g(s) {\n  let {\n    url: i\n  } = s;\n  if (!i) return {\n    url: i\n  };\n  i = n(i, s.logger);\n  const o = r(i),\n        l = d(o.path);\n  let u;\n  if (e(l)) null != l.sublayer && null == s.layer.layerId && (u = l.sublayer), i = l.url.path;else if (s.nonStandardUrlAllowed) {\n    const r = m(o.path);\n    e(r) && (i = r.serviceUrl, u = r.sublayerId);\n  }\n  return {\n    url: t(i),\n    layerId: u\n  };\n}\n\nfunction O(e, r, t, n, i) {\n  l(r, n, \"url\", i), n.url && null != e.layerId && (n.url = s(n.url, t, e.layerId.toString()));\n}\n\nfunction S(e) {\n  if (!e) return !1;\n  const r = e.toLowerCase(),\n        t = -1 !== r.indexOf(\"/services/\"),\n        n = -1 !== r.indexOf(\"/mapserver/wmsserver\"),\n        s = -1 !== r.indexOf(\"/imageserver/wmsserver\"),\n        i = -1 !== r.indexOf(\"/wmsserver\");\n  return t && (n || s || i);\n}\n\nfunction C(e) {\n  if (!e) return !1;\n  const r = new i(o(e)).authority.toLowerCase();\n  return \"server.arcgisonline.com\" === r || \"services.arcgisonline.com\" === r;\n}\n\nexport { v as cleanTitle, p as isArcGISUrl, w as isHostedAgolService, y as isHostedSecuredProxyService, C as isServerOrServicesAGOLUrl, S as isWmsServer, d as parse, m as parseNonStandardSublayerUrl, x as sanitizeUrl, g as sanitizeUrlWithLayerId, u as serverTypes, h as titleFromUrlAndName, O as writeUrlWithLayerId };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js"],"names":["isSome","e","urlToObject","r","removeTrailingSlash","t","removeQueryParameters","n","join","s","Url","i","makeAbsolute","o","w","l","u","a","RegExp","c","f","p","test","d","path","match","indexOf","title","v","slice","serverType","sublayer","parseInt","url","m","serviceUrl","sublayerId","Number","replace","toUpperCase","h","push","length","toLowerCase","y","x","g","logger","layer","layerId","nonStandardUrlAllowed","O","toString","S","C","authority","cleanTitle","isArcGISUrl","isHostedAgolService","isHostedSecuredProxyService","isServerOrServicesAGOLUrl","isWmsServer","parse","parseNonStandardSublayerUrl","sanitizeUrl","sanitizeUrlWithLayerId","serverTypes","titleFromUrlAndName","writeUrlWithLayerId"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../core/maybe.js\";import{urlToObject as r,removeTrailingSlash as t,removeQueryParameters as n,join as s,Url as i,makeAbsolute as o}from\"../../core/urlUtils.js\";import{w as l}from\"../../chunks/persistableUrlUtils.js\";const u=[\"MapServer\",\"ImageServer\",\"FeatureServer\",\"SceneServer\",\"StreamServer\",\"VectorTileServer\"],a=new RegExp(`^((?:https?:)?\\\\/\\\\/\\\\S+?\\\\/rest\\\\/services\\\\/(.+?)\\\\/(${u.join(\"|\")}))(?:\\\\/(?:layers\\\\/)?(\\\\d+))?`,\"i\"),c=new RegExp(`^((?:https?:)?\\\\/\\\\/\\\\S+?\\\\/([^\\\\/\\\\n]+)\\\\/(${u.join(\"|\")}))(?:\\\\/(?:layers\\\\/)?(\\\\d+))?`,\"i\"),f=/(.*?)\\/(?:layers\\/)?(\\d+)\\/?$/i;function p(e){return!!a.test(e)}function d(e){const t=r(e),n=t.path.match(a)||t.path.match(c);if(!n)return null;const[,s,i,o,l]=n,u=i.indexOf(\"/\");return{title:v(-1!==u?i.slice(u+1):i),serverType:o,sublayer:null!=l&&\"\"!==l?parseInt(l,10):null,url:{path:s}}}function m(e){const t=r(e).path.match(f);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function v(e){return(e=e.replace(/\\s*[/_]+\\s*/g,\" \"))[0].toUpperCase()+e.slice(1)}function h(r,t){const n=[];if(r){const t=d(r);e(t)&&t.title&&n.push(t.title)}if(t){const e=v(t);n.push(e)}if(2===n.length){if(-1!==n[0].toLowerCase().indexOf(n[1].toLowerCase()))return n[0];if(-1!==n[1].toLowerCase().indexOf(n[0].toLowerCase()))return n[1]}return n.join(\" - \")}function w(e){if(!e)return!1;const r=\".arcgis.com/\",t=\"//services\",n=\"//tiles\",s=\"//features\",i=-1!==(e=e.toLowerCase()).indexOf(r),o=-1!==e.indexOf(t)||-1!==e.indexOf(n)||-1!==e.indexOf(s);return i&&o}function y(e,r){return r&&e&&-1!==e.toLowerCase().indexOf(r.toLowerCase())}function x(e,r){return e?t(n(e,r)):e}function g(s){let{url:i}=s;if(!i)return{url:i};i=n(i,s.logger);const o=r(i),l=d(o.path);let u;if(e(l))null!=l.sublayer&&null==s.layer.layerId&&(u=l.sublayer),i=l.url.path;else if(s.nonStandardUrlAllowed){const r=m(o.path);e(r)&&(i=r.serviceUrl,u=r.sublayerId)}return{url:t(i),layerId:u}}function O(e,r,t,n,i){l(r,n,\"url\",i),n.url&&null!=e.layerId&&(n.url=s(n.url,t,e.layerId.toString()))}function S(e){if(!e)return!1;const r=e.toLowerCase(),t=-1!==r.indexOf(\"/services/\"),n=-1!==r.indexOf(\"/mapserver/wmsserver\"),s=-1!==r.indexOf(\"/imageserver/wmsserver\"),i=-1!==r.indexOf(\"/wmsserver\");return t&&(n||s||i)}function C(e){if(!e)return!1;const r=new i(o(e)).authority.toLowerCase();return\"server.arcgisonline.com\"===r||\"services.arcgisonline.com\"===r}export{v as cleanTitle,p as isArcGISUrl,w as isHostedAgolService,y as isHostedSecuredProxyService,C as isServerOrServicesAGOLUrl,S as isWmsServer,d as parse,m as parseNonStandardSublayerUrl,x as sanitizeUrl,g as sanitizeUrlWithLayerId,u as serverTypes,h as titleFromUrlAndName,O as writeUrlWithLayerId};\n"]},"metadata":{},"sourceType":"module"}