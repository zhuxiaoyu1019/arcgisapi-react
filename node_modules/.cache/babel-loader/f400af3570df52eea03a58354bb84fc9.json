{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as r } from \"../../../../chunks/tslib.es6.js\";\nimport { bindSliceUniformsWithOrigin as t } from \"../core/shaderLibrary/Slice.glsl.js\";\nimport { bindOutputHighlight as e } from \"../core/shaderLibrary/output/OutputHighlight.glsl.js\";\nimport { bindMultipassTerrainTexture as i } from \"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";\nimport { bindReadShadowMapUniforms as o } from \"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";\nimport { bindSSRUniforms as s } from \"../core/shaderLibrary/shading/ScreenSpaceReflections.glsl.js\";\nimport { bindWaterDistortionUniforms as a } from \"../core/shaderLibrary/shading/WaterDistortion.glsl.js\";\nimport { bindProjectionMatrix as n, bindView as p, bindCameraPosition as u } from \"../core/shaderLibrary/util/View.glsl.js\";\nimport { ReloadableShaderModule as h } from \"../core/shaderTechnique/ReloadableShaderModule.js\";\nimport { ShaderTechnique as l } from \"../core/shaderTechnique/ShaderTechnique.js\";\nimport { ShaderTechniqueConfiguration as d, parameter as c } from \"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";\nimport { Default3D as m } from \"../lib/DefaultVertexAttributeLocations.js\";\nimport { blendingDefault as g, OITBlending as f, OITDepthTest as b, OITDepthWrite as y, getOITPolygonOffset as v } from \"../lib/OrderIndependentTransparency.js\";\nimport { Program as T } from \"../lib/Program.js\";\nimport { W as S } from \"../../../../chunks/WaterSurface.glsl.js\";\nimport { makePipelineState as w, defaultDepthWriteParams as j, defaultColorWriteParams as x } from \"../../../webgl/renderState.js\";\n\nclass P extends l {\n  constructor(r, t, e) {\n    super(r, t, e), this._textureRepository = r.waterTextureRepository;\n  }\n\n  initializeProgram(r) {\n    const t = P.shader.get(),\n          e = this.configuration,\n          i = t.build({\n      OITEnabled: 0 === e.transparencyPassType,\n      output: e.output,\n      viewingMode: r.viewingMode,\n      slicePlaneEnabled: e.slicePlaneEnabled,\n      sliceHighlightDisabled: !1,\n      sliceEnabledForVertexPrograms: !1,\n      receiveShadows: e.receiveShadows,\n      pbrMode: 3,\n      useCustomDTRExponentForWater: !0,\n      ssrEnabled: e.useSSR,\n      highStepCount: !0,\n      multipassTerrainEnabled: e.multipassTerrainEnabled,\n      cullAboveGround: e.cullAboveGround\n    });\n    return new T(r.rctx, i, m);\n  }\n\n  ensureResource(r) {\n    return this._textureRepository.ready || this._textureRepository.updating || this._textureRepository.loadTextures(r), this._textureRepository.ready ? 2 : 1;\n  }\n\n  bindPass(r, t) {\n    n(this.program, t.camera.projectionMatrix), t.multipassTerrainEnabled && (this.program.setUniform2fv(\"cameraNearFar\", t.camera.nearFar), this.program.setUniform2fv(\"inverseViewport\", t.inverseViewport), i(this.program, t)), 0 === this.configuration.output && (t.lighting.setUniforms(this.program, !1), s(this.program, t)), 0 !== this.configuration.output && 2 !== this.configuration.output || (a(this.program, r), this._textureRepository.bind(this.program)), this.program.setUniform4fv(\"waterColor\", r.color), 4 === this.configuration.output && e(this.program, t);\n  }\n\n  bindDraw(r) {\n    p(this.program, r), this.program.rebindTextures(), 0 !== this.configuration.output && 7 !== this.configuration.output || u(this.program, r.origin, r.camera.viewInverseTransposeMatrix), 0 === this.configuration.output && o(this.program, r), 0 !== this.configuration.output && 7 !== this.configuration.output && 4 !== this.configuration.output || t(this.program, this.configuration, r);\n  }\n\n  setPipelineState(r) {\n    const t = this.configuration,\n          e = 3 === r,\n          i = 2 === r;\n    return w({\n      blending: 2 !== t.output && 4 !== t.output && t.transparent ? e ? g : f(r) : null,\n      depthTest: {\n        func: b(r)\n      },\n      depthWrite: e ? t.writeDepth && j : y(r),\n      colorWrite: x,\n      polygonOffset: e || i ? null : v(t.enableOffset)\n    });\n  }\n\n  initializePipeline() {\n    return this.setPipelineState(this.configuration.transparencyPassType);\n  }\n\n}\n\nP.shader = new h(S, () => import(\"../shaders/WaterSurface.glsl.js\"));\n\nclass R extends d {\n  constructor() {\n    super(...arguments), this.output = 0, this.receiveShadows = !1, this.slicePlaneEnabled = !1, this.transparent = !1, this.enableOffset = !0, this.writeDepth = !1, this.useSSR = !1, this.isDraped = !1, this.transparencyPassType = 3, this.multipassTerrainEnabled = !1, this.cullAboveGround = !1;\n  }\n\n}\n\nr([c({\n  count: 8\n})], R.prototype, \"output\", void 0), r([c()], R.prototype, \"receiveShadows\", void 0), r([c()], R.prototype, \"slicePlaneEnabled\", void 0), r([c()], R.prototype, \"transparent\", void 0), r([c()], R.prototype, \"enableOffset\", void 0), r([c()], R.prototype, \"writeDepth\", void 0), r([c()], R.prototype, \"useSSR\", void 0), r([c()], R.prototype, \"isDraped\", void 0), r([c({\n  count: 4\n})], R.prototype, \"transparencyPassType\", void 0), r([c()], R.prototype, \"multipassTerrainEnabled\", void 0), r([c()], R.prototype, \"cullAboveGround\", void 0);\nexport { P as WaterTechnique, R as WaterTechniqueConfiguration };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/webgl-engine/materials/WaterTechnique.js"],"names":["_","r","bindSliceUniformsWithOrigin","t","bindOutputHighlight","e","bindMultipassTerrainTexture","i","bindReadShadowMapUniforms","o","bindSSRUniforms","s","bindWaterDistortionUniforms","a","bindProjectionMatrix","n","bindView","p","bindCameraPosition","u","ReloadableShaderModule","h","ShaderTechnique","l","ShaderTechniqueConfiguration","d","parameter","c","Default3D","m","blendingDefault","g","OITBlending","f","OITDepthTest","b","OITDepthWrite","y","getOITPolygonOffset","v","Program","T","W","S","makePipelineState","w","defaultDepthWriteParams","j","defaultColorWriteParams","x","P","constructor","_textureRepository","waterTextureRepository","initializeProgram","shader","get","configuration","build","OITEnabled","transparencyPassType","output","viewingMode","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","receiveShadows","pbrMode","useCustomDTRExponentForWater","ssrEnabled","useSSR","highStepCount","multipassTerrainEnabled","cullAboveGround","rctx","ensureResource","ready","updating","loadTextures","bindPass","program","camera","projectionMatrix","setUniform2fv","nearFar","inverseViewport","lighting","setUniforms","bind","setUniform4fv","color","bindDraw","rebindTextures","origin","viewInverseTransposeMatrix","setPipelineState","blending","transparent","depthTest","func","depthWrite","writeDepth","colorWrite","polygonOffset","enableOffset","initializePipeline","R","arguments","isDraped","count","prototype","WaterTechnique","WaterTechniqueConfiguration"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../../chunks/tslib.es6.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindOutputHighlight as e}from\"../core/shaderLibrary/output/OutputHighlight.glsl.js\";import{bindMultipassTerrainTexture as i}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindReadShadowMapUniforms as o}from\"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{bindSSRUniforms as s}from\"../core/shaderLibrary/shading/ScreenSpaceReflections.glsl.js\";import{bindWaterDistortionUniforms as a}from\"../core/shaderLibrary/shading/WaterDistortion.glsl.js\";import{bindProjectionMatrix as n,bindView as p,bindCameraPosition as u}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as h}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as l}from\"../core/shaderTechnique/ShaderTechnique.js\";import{ShaderTechniqueConfiguration as d,parameter as c}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as m}from\"../lib/DefaultVertexAttributeLocations.js\";import{blendingDefault as g,OITBlending as f,OITDepthTest as b,OITDepthWrite as y,getOITPolygonOffset as v}from\"../lib/OrderIndependentTransparency.js\";import{Program as T}from\"../lib/Program.js\";import{W as S}from\"../../../../chunks/WaterSurface.glsl.js\";import{makePipelineState as w,defaultDepthWriteParams as j,defaultColorWriteParams as x}from\"../../../webgl/renderState.js\";class P extends l{constructor(r,t,e){super(r,t,e),this._textureRepository=r.waterTextureRepository}initializeProgram(r){const t=P.shader.get(),e=this.configuration,i=t.build({OITEnabled:0===e.transparencyPassType,output:e.output,viewingMode:r.viewingMode,slicePlaneEnabled:e.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,receiveShadows:e.receiveShadows,pbrMode:3,useCustomDTRExponentForWater:!0,ssrEnabled:e.useSSR,highStepCount:!0,multipassTerrainEnabled:e.multipassTerrainEnabled,cullAboveGround:e.cullAboveGround});return new T(r.rctx,i,m)}ensureResource(r){return this._textureRepository.ready||this._textureRepository.updating||this._textureRepository.loadTextures(r),this._textureRepository.ready?2:1}bindPass(r,t){n(this.program,t.camera.projectionMatrix),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",t.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),i(this.program,t)),0===this.configuration.output&&(t.lighting.setUniforms(this.program,!1),s(this.program,t)),0!==this.configuration.output&&2!==this.configuration.output||(a(this.program,r),this._textureRepository.bind(this.program)),this.program.setUniform4fv(\"waterColor\",r.color),4===this.configuration.output&&e(this.program,t)}bindDraw(r){p(this.program,r),this.program.rebindTextures(),0!==this.configuration.output&&7!==this.configuration.output||u(this.program,r.origin,r.camera.viewInverseTransposeMatrix),0===this.configuration.output&&o(this.program,r),0!==this.configuration.output&&7!==this.configuration.output&&4!==this.configuration.output||t(this.program,this.configuration,r)}setPipelineState(r){const t=this.configuration,e=3===r,i=2===r;return w({blending:2!==t.output&&4!==t.output&&t.transparent?e?g:f(r):null,depthTest:{func:b(r)},depthWrite:e?t.writeDepth&&j:y(r),colorWrite:x,polygonOffset:e||i?null:v(t.enableOffset)})}initializePipeline(){return this.setPipelineState(this.configuration.transparencyPassType)}}P.shader=new h(S,(()=>import(\"../shaders/WaterSurface.glsl.js\")));class R extends d{constructor(){super(...arguments),this.output=0,this.receiveShadows=!1,this.slicePlaneEnabled=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!1,this.useSSR=!1,this.isDraped=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}r([c({count:8})],R.prototype,\"output\",void 0),r([c()],R.prototype,\"receiveShadows\",void 0),r([c()],R.prototype,\"slicePlaneEnabled\",void 0),r([c()],R.prototype,\"transparent\",void 0),r([c()],R.prototype,\"enableOffset\",void 0),r([c()],R.prototype,\"writeDepth\",void 0),r([c()],R.prototype,\"useSSR\",void 0),r([c()],R.prototype,\"isDraped\",void 0),r([c({count:4})],R.prototype,\"transparencyPassType\",void 0),r([c()],R.prototype,\"multipassTerrainEnabled\",void 0),r([c()],R.prototype,\"cullAboveGround\",void 0);export{P as WaterTechnique,R as WaterTechniqueConfiguration};\n"]},"metadata":{},"sourceType":"module"}