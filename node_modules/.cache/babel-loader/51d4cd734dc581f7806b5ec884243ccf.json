{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../../../core/maybe.js\";\nimport { I as t } from \"../../../../chunks/mat4f64.js\";\nimport { c as r } from \"../../../../chunks/vec3f64.js\";\nimport { projectPointToVector as o } from \"../../../../geometry/projection.js\";\nimport { containsPoint as n } from \"../../../../geometry/support/aaBoundingBox.js\";\nimport { getPointOnPath as i, getPathLength as s } from \"../../../../geometry/support/coordsUtils.js\";\nimport { makeDehydratedPoint as a } from \"../../../../layers/graphics/dehydratedFeatures.js\";\nimport { applyElevationAlignmentForHUD as c, applyPerVertexElevationAlignment as l } from \"./elevationAlignmentUtils.js\";\nimport { computeCentroid as p } from \"./graphicUtils.js\";\nimport { Object3D as m } from \"../../webgl-engine/lib/Object3D.js\";\nconst u = r();\n\nfunction f(r, i, s, a, l, p, f, g, d, h) {\n  const j = s ? s.length : 0,\n        y = r.clippingExtent;\n  if (o(i, u, r.elevationProvider.spatialReference), e(y) && !n(y, u)) return null;\n  const v = r.renderCoordsHelper.spatialReference;\n  o(i, u, v);\n  const w = r.localOriginFactory.getOrigin(u),\n        b = new m({\n    castShadow: !1,\n    metadata: {\n      layerUid: g,\n      graphicUid: d,\n      usesVerticalDistanceToGround: !0\n    }\n  });\n\n  for (let e = 0; e < j; e++) {\n    const r = l ? l[e] : t;\n    b.addGeometry(s[e], a[e], r, p, w, h);\n  }\n\n  return {\n    object: b,\n    sampledElevation: c(b, i, r.elevationProvider, r.renderCoordsHelper, f)\n  };\n}\n\nfunction g(e, t, r) {\n  const n = e.elevationContext,\n        i = r.spatialReference;\n  o(t, u, i), n.centerPointInElevationSR = a(u[0], u[1], t.hasZ ? u[2] : 0, i);\n}\n\nfunction d(e) {\n  switch (e.type) {\n    case \"point\":\n      return e;\n\n    case \"polygon\":\n    case \"extent\":\n      return p(e);\n\n    case \"polyline\":\n      {\n        const t = e.paths[0];\n        if (!t || 0 === t.length) return null;\n        const r = i(t, s(t) / 2);\n        return a(r[0], r[1], r[2], e.spatialReference);\n      }\n\n    case \"mesh\":\n      return e.origin;\n  }\n\n  return null;\n}\n\nfunction h(e, t, r, o, n) {\n  const i = new Float64Array(3 * e.length),\n        s = new Float64Array(i.length);\n  e.forEach((e, t) => {\n    i[3 * t + 0] = e[0], i[3 * t + 1] = e[1], i[3 * t + 2] = e.length > 2 ? e[2] : 0;\n  });\n  const a = l(i, t, 0, s, 0, i, 0, i.length / 3, r, o, n),\n        c = null != a;\n  return {\n    numVertices: e.length,\n    position: i,\n    mapPosition: s,\n    projectionSuccess: c,\n    sampledElevation: a\n  };\n}\n\nexport { f as createStageObjectForHUD, g as extendPointGraphicElevationContext, h as geometryToRenderInfo, d as placePointOnGeometry };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/layers/graphics/pointUtils.js"],"names":["isSome","e","I","t","c","r","projectPointToVector","o","containsPoint","n","getPointOnPath","i","getPathLength","s","makeDehydratedPoint","a","applyElevationAlignmentForHUD","applyPerVertexElevationAlignment","l","computeCentroid","p","Object3D","m","u","f","g","d","h","j","length","y","clippingExtent","elevationProvider","spatialReference","v","renderCoordsHelper","w","localOriginFactory","getOrigin","b","castShadow","metadata","layerUid","graphicUid","usesVerticalDistanceToGround","addGeometry","object","sampledElevation","elevationContext","centerPointInElevationSR","hasZ","type","paths","origin","Float64Array","forEach","numVertices","position","mapPosition","projectionSuccess","createStageObjectForHUD","extendPointGraphicElevationContext","geometryToRenderInfo","placePointOnGeometry"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../../core/maybe.js\";import{I as t}from\"../../../../chunks/mat4f64.js\";import{c as r}from\"../../../../chunks/vec3f64.js\";import{projectPointToVector as o}from\"../../../../geometry/projection.js\";import{containsPoint as n}from\"../../../../geometry/support/aaBoundingBox.js\";import{getPointOnPath as i,getPathLength as s}from\"../../../../geometry/support/coordsUtils.js\";import{makeDehydratedPoint as a}from\"../../../../layers/graphics/dehydratedFeatures.js\";import{applyElevationAlignmentForHUD as c,applyPerVertexElevationAlignment as l}from\"./elevationAlignmentUtils.js\";import{computeCentroid as p}from\"./graphicUtils.js\";import{Object3D as m}from\"../../webgl-engine/lib/Object3D.js\";const u=r();function f(r,i,s,a,l,p,f,g,d,h){const j=s?s.length:0,y=r.clippingExtent;if(o(i,u,r.elevationProvider.spatialReference),e(y)&&!n(y,u))return null;const v=r.renderCoordsHelper.spatialReference;o(i,u,v);const w=r.localOriginFactory.getOrigin(u),b=new m({castShadow:!1,metadata:{layerUid:g,graphicUid:d,usesVerticalDistanceToGround:!0}});for(let e=0;e<j;e++){const r=l?l[e]:t;b.addGeometry(s[e],a[e],r,p,w,h)}return{object:b,sampledElevation:c(b,i,r.elevationProvider,r.renderCoordsHelper,f)}}function g(e,t,r){const n=e.elevationContext,i=r.spatialReference;o(t,u,i),n.centerPointInElevationSR=a(u[0],u[1],t.hasZ?u[2]:0,i)}function d(e){switch(e.type){case\"point\":return e;case\"polygon\":case\"extent\":return p(e);case\"polyline\":{const t=e.paths[0];if(!t||0===t.length)return null;const r=i(t,s(t)/2);return a(r[0],r[1],r[2],e.spatialReference)}case\"mesh\":return e.origin}return null}function h(e,t,r,o,n){const i=new Float64Array(3*e.length),s=new Float64Array(i.length);e.forEach(((e,t)=>{i[3*t+0]=e[0],i[3*t+1]=e[1],i[3*t+2]=e.length>2?e[2]:0}));const a=l(i,t,0,s,0,i,0,i.length/3,r,o,n),c=null!=a;return{numVertices:e.length,position:i,mapPosition:s,projectionSuccess:c,sampledElevation:a}}export{f as createStageObjectForHUD,g as extendPointGraphicElevationContext,h as geometryToRenderInfo,d as placePointOnGeometry};\n"]},"metadata":{},"sourceType":"module"}