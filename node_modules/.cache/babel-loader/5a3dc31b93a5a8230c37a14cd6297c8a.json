{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from \"../../../core/Error.js\";\nimport e from \"../PixelBlock.js\";\nimport i from \"./ImageCanvasDecoder.js\";\nimport a from \"./JpgPlus.js\";\nimport { L as r, d as s, a as n } from \"../../../chunks/TiffDecoder.js\";\nimport { d as o } from \"../../../chunks/LercCodec.js\";\nimport { Z as h } from \"../../../chunks/Zlib.js\";\nimport d from \"./Raw.js\";\nimport { isPlatformLittleEndian as l } from \"./utils.js\";\n\nvar c = function (t) {\n  var e, i, a, r, s, n;\n\n  function o(t) {\n    var e, i, a, r, s, n, o, h, d, l, c, p, f;\n\n    for (this.data = t, this.pos = 8, this.palette = [], this.imgData = [], this.transparency = {}, this.animation = null, this.text = {}, s = null;;) {\n      switch (e = this.readUInt32(), h = function () {\n        var t, e;\n\n        for (e = [], t = 0; t < 4; ++t) e.push(String.fromCharCode(this.data[this.pos++]));\n\n        return e;\n      }.call(this).join(\"\")) {\n        case \"IHDR\":\n          this.width = this.readUInt32(), this.height = this.readUInt32(), this.bits = this.data[this.pos++], this.colorType = this.data[this.pos++], this.compressionMethod = this.data[this.pos++], this.filterMethod = this.data[this.pos++], this.interlaceMethod = this.data[this.pos++];\n          break;\n\n        case \"acTL\":\n          this.animation = {\n            numFrames: this.readUInt32(),\n            numPlays: this.readUInt32() || 1 / 0,\n            frames: []\n          };\n          break;\n\n        case \"PLTE\":\n          this.palette = this.read(e);\n          break;\n\n        case \"fcTL\":\n          s && this.animation.frames.push(s), this.pos += 4, s = {\n            width: this.readUInt32(),\n            height: this.readUInt32(),\n            xOffset: this.readUInt32(),\n            yOffset: this.readUInt32()\n          }, r = this.readUInt16(), a = this.readUInt16() || 100, s.delay = 1e3 * r / a, s.disposeOp = this.data[this.pos++], s.blendOp = this.data[this.pos++], s.data = [];\n          break;\n\n        case \"IDAT\":\n        case \"fdAT\":\n          for (\"fdAT\" === h && (this.pos += 4, e -= 4), t = (null != s ? s.data : void 0) || this.imgData, c = 0; 0 <= e ? c < e : c > e; 0 <= e ? ++c : --c) t.push(this.data[this.pos++]);\n\n          break;\n\n        case \"tRNS\":\n          switch (this.transparency = {}, this.colorType) {\n            case 3:\n              if (this.transparency.indexed = this.read(e), (d = 255 - this.transparency.indexed.length) > 0) for (p = 0; 0 <= d ? p < d : p > d; 0 <= d ? ++p : --p) this.transparency.indexed.push(255);\n              break;\n\n            case 0:\n              this.transparency.grayscale = this.read(e)[0];\n              break;\n\n            case 2:\n              this.transparency.rgb = this.read(e);\n          }\n\n          break;\n\n        case \"tEXt\":\n          n = (l = this.read(e)).indexOf(0), o = String.fromCharCode.apply(String, l.slice(0, n)), this.text[o] = String.fromCharCode.apply(String, l.slice(n + 1));\n          break;\n\n        case \"IEND\":\n          return s && this.animation.frames.push(s), this.colors = function () {\n            switch (this.colorType) {\n              case 0:\n              case 3:\n              case 4:\n                return 1;\n\n              case 2:\n              case 6:\n                return 3;\n            }\n          }.call(this), this.hasAlphaChannel = 4 === (f = this.colorType) || 6 === f, i = this.colors + (this.hasAlphaChannel ? 1 : 0), this.pixelBitlength = this.bits * i, this.colorSpace = function () {\n            switch (this.colors) {\n              case 1:\n                return \"DeviceGray\";\n\n              case 3:\n                return \"DeviceRGB\";\n            }\n          }.call(this), void (this.imgData = new Uint8Array(this.imgData));\n\n        default:\n          this.pos += e;\n      }\n\n      if (this.pos += 4, this.pos > this.data.length) throw new Error(\"Incomplete or corrupt PNG file\");\n    }\n  }\n\n  return o.load = function (t, e, i) {\n    var a;\n    return \"function\" == typeof e && (i = e), (a = new XMLHttpRequest()).open(\"GET\", t, !0), a.responseType = \"arraybuffer\", a.onload = function () {\n      var t;\n      return t = new o(new Uint8Array(a.response || a.mozResponseArrayBuffer)), \"function\" == typeof (null != e ? e.getContext : void 0) && t.render(e), \"function\" == typeof i ? i(t) : void 0;\n    }, a.send(null);\n  }, i = 1, a = 2, e = 0, o.prototype.read = function (t) {\n    var e, i;\n\n    for (i = [], e = 0; 0 <= t ? e < t : e > t; 0 <= t ? ++e : --e) i.push(this.data[this.pos++]);\n\n    return i;\n  }, o.prototype.readUInt32 = function () {\n    return this.data[this.pos++] << 24 | this.data[this.pos++] << 16 | this.data[this.pos++] << 8 | this.data[this.pos++];\n  }, o.prototype.readUInt16 = function () {\n    return this.data[this.pos++] << 8 | this.data[this.pos++];\n  }, o.prototype.decodePixels = function (t) {\n    var e, i, a, r, s, n, o, d, l, c, p, f, u, m, g, w, y, x, k, b, C, D, I;\n    if (null == t && (t = this.imgData), 0 === t.length) return new Uint8Array(0);\n\n    for (t = (t = new h(t)).getBytes(), w = (f = this.pixelBitlength / 8) * this.width, u = new Uint8Array(w * this.height), n = t.length, g = 0, m = 0, i = 0; m < n;) {\n      switch (t[m++]) {\n        case 0:\n          for (r = k = 0; k < w; r = k += 1) u[i++] = t[m++];\n\n          break;\n\n        case 1:\n          for (r = b = 0; b < w; r = b += 1) e = t[m++], s = r < f ? 0 : u[i - f], u[i++] = (e + s) % 256;\n\n          break;\n\n        case 2:\n          for (r = C = 0; C < w; r = C += 1) e = t[m++], a = (r - r % f) / f, y = g && u[(g - 1) * w + a * f + r % f], u[i++] = (y + e) % 256;\n\n          break;\n\n        case 3:\n          for (r = D = 0; D < w; r = D += 1) e = t[m++], a = (r - r % f) / f, s = r < f ? 0 : u[i - f], y = g && u[(g - 1) * w + a * f + r % f], u[i++] = (e + Math.floor((s + y) / 2)) % 256;\n\n          break;\n\n        case 4:\n          for (r = I = 0; I < w; r = I += 1) e = t[m++], a = (r - r % f) / f, s = r < f ? 0 : u[i - f], 0 === g ? y = x = 0 : (y = u[(g - 1) * w + a * f + r % f], x = a && u[(g - 1) * w + (a - 1) * f + r % f]), o = s + y - x, d = Math.abs(o - s), c = Math.abs(o - y), p = Math.abs(o - x), l = d <= c && d <= p ? s : c <= p ? y : x, u[i++] = (e + l) % 256;\n\n          break;\n\n        default:\n          throw new Error(\"Invalid filter algorithm: \" + t[m - 1]);\n      }\n\n      g++;\n    }\n\n    return u;\n  }, o.prototype.decodePalette = function () {\n    var t, e, i, a, r, s, n, o, h;\n\n    for (i = this.palette, s = this.transparency.indexed || [], r = new Uint8Array((s.length || 0) + i.length), a = 0, i.length, t = 0, e = n = 0, o = i.length; n < o; e = n += 3) r[a++] = i[e], r[a++] = i[e + 1], r[a++] = i[e + 2], r[a++] = null != (h = s[t++]) ? h : 255;\n\n    return r;\n  }, o.prototype.copyToImageData = function (t, e) {\n    var i, a, r, s, n, o, h, d, l, c, p;\n    if (a = this.colors, l = null, i = this.hasAlphaChannel, this.palette.length && (l = null != (p = this._decodedPalette) ? p : this._decodedPalette = this.decodePalette(), a = 4, i = !0), d = (r = t.data || t).length, n = l || e, s = o = 0, 1 === a) for (; s < d;) h = l ? 4 * e[s / 4] : o, c = n[h++], r[s++] = c, r[s++] = c, r[s++] = c, r[s++] = i ? n[h++] : this.transparency.grayscale && this.transparency.grayscale === c ? 0 : 255, o = h;else for (; s < d;) h = l ? 4 * e[s / 4] : o, r[s++] = n[h++], r[s++] = n[h++], r[s++] = n[h++], r[s++] = i ? n[h++] : this.transparency.rgb && this.transparency.rgb[1] === n[h - 3] && this.transparency.rgb[3] === n[h - 2] && this.transparency.rgb[5] === n[h - 1] ? 0 : 255, o = h;\n  }, o.prototype.decode = function () {\n    var t;\n    return t = new Uint8Array(this.width * this.height * 4), this.copyToImageData(t, this.decodePixels()), t;\n  }, s = t.document && t.document.createElement(\"canvas\"), n = s && s.getContext(\"2d\"), r = function (t) {\n    var e;\n    return n.width = t.width, n.height = t.height, n.clearRect(0, 0, t.width, t.height), n.putImageData(t, 0, 0), (e = new Image()).src = s.toDataURL(), e;\n  }, o.prototype.decodeFrames = function (t) {\n    var e, i, a, s, n, o, h, d;\n\n    if (this.animation) {\n      for (d = [], i = n = 0, o = (h = this.animation.frames).length; n < o; i = ++n) e = h[i], a = t.createImageData(e.width, e.height), s = this.decodePixels(new Uint8Array(e.data)), this.copyToImageData(a, s), e.imageData = a, d.push(e.image = r(a));\n\n      return d;\n    }\n  }, o.prototype.renderFrame = function (t, r) {\n    var s, n, o;\n    return s = (n = this.animation.frames)[r], o = n[r - 1], 0 === r && t.clearRect(0, 0, this.width, this.height), (null != o ? o.disposeOp : void 0) === i ? t.clearRect(o.xOffset, o.yOffset, o.width, o.height) : (null != o ? o.disposeOp : void 0) === a && t.putImageData(o.imageData, o.xOffset, o.yOffset), s.blendOp === e && t.clearRect(s.xOffset, s.yOffset, s.width, s.height), t.drawImage(s.image, s.xOffset, s.yOffset);\n  }, o.prototype.animate = function (t) {\n    var e,\n        i,\n        a,\n        r,\n        s,\n        n,\n        o = this;\n    return i = 0, n = this.animation, r = n.numFrames, a = n.frames, s = n.numPlays, (e = function () {\n      var n, h;\n      if (n = i++ % r, h = a[n], o.renderFrame(t, n), r > 1 && i / r < s) return o.animation._timeout = setTimeout(e, h.delay);\n    })();\n  }, o.prototype.stopAnimation = function () {\n    var t;\n    return clearTimeout(null != (t = this.animation) ? t._timeout : void 0);\n  }, o.prototype.render = function (t) {\n    var e, i;\n    return t._png && t._png.stopAnimation(), t._png = this, t.width = this.width, t.height = this.height, e = t.getContext(\"2d\"), this.animation ? (this.decodeFrames(e), this.animate(e)) : (i = e.createImageData(this.width, this.height), this.copyToImageData(i, this.decodePixels()), e.putImageData(i, 0, 0));\n  }, o;\n}(self);\n\nconst p = new Set([\"jpg\", \"png\", \"bmp\", \"gif\"]);\n\nfunction f(i, a) {\n  if (!l) throw new t(\"rasterCoded:decode\", \"lerc decoder is not supported on big endian platform\");\n  const {\n    width: r,\n    height: s,\n    pixelType: n\n  } = a,\n        h = D(n),\n        d = h.pixelTypeCtor,\n        c = null == a.noDataValue ? h.noDataValue : a.noDataValue;\n  let p,\n      f,\n      u = 0,\n      m = 0;\n  const g = i.byteLength - 10;\n\n  for (; m < g;) {\n    const a = o(i, {\n      inputOffset: m,\n      encodedMaskData: p,\n      returnMask: 0 === u,\n      returnEncodedMask: 0 === u,\n      returnFileInfo: !0,\n      pixelType: d,\n      noDataValue: c\n    });\n    if (r && s && (a.width !== r || a.height !== s)) throw new t(\"rasterCoded:decode\", \"lerc decoded result has width or height different from specified in options\");\n\n    if (m = a.fileInfo.eofOffset, 0 === u && (p = a.encodedMaskData, f = new e({\n      width: a.width,\n      height: a.height,\n      pixels: [],\n      pixelType: n,\n      mask: a.maskData,\n      statistics: []\n    })), u++, f.addData({\n      pixels: a.pixelData,\n      statistics: {\n        minValue: a.minValue,\n        maxValue: a.maxValue,\n        noDataValue: a.noDataValue\n      }\n    }), g - m > 10) {\n      const t = String.fromCharCode.apply(null, new Uint8Array(i, m, 10));\n      m += t.indexOf(\"CntZ\") > -1 ? t.indexOf(\"CntZ\") : 0;\n    }\n  }\n\n  return f;\n}\n\nfunction u(i, a) {\n  if (!l) throw new t(\"rasterCoded:decode\", \"lerc decoder is not supported on big endian platform\");\n  let s,\n      n,\n      o,\n      h = 0,\n      d = a.offset || 0,\n      c = 0;\n  const p = a.eof || i.byteLength - 10,\n        f = [],\n        {\n    width: u,\n    height: m\n  } = a;\n  let g = 0;\n\n  for (; d < p;) {\n    var w;\n    if (n = r.decode(i, {\n      inputOffset: d,\n      maskData: s,\n      returnFileInfo: !0\n    }), u && m && (n.width !== u || n.height !== m)) throw new t(\"rasterCoded:decode\", \"lerc2 decoded result has width or height different from what's specified in options\");\n\n    if (d = n.fileInfo.eofOffset, s = n.maskData, 0 === h && (c = n.fileInfo.numValidPixel, o = new e({\n      width: n.width,\n      height: n.height,\n      pixels: [],\n      pixelType: n.fileInfo.pixelType,\n      mask: s,\n      statistics: []\n    })), n.fileInfo.mask && n.fileInfo.mask.numBytes > 0 && g++, s && f.push(s), n.dimCount > 1 && (null == (w = n.pixelData) ? void 0 : w.length) === n.width * n.height * n.dimCount) {\n      var y, x, k, b;\n      n.pixelData = n.pixelData.slice(-n.width * n.height);\n      const t = null == (y = n.dimStats) || null == (x = y.minValues) ? void 0 : x[n.dimCount - 1],\n            e = null == (k = n.dimStats) || null == (b = k.maxValues) ? void 0 : b[n.dimCount - 1];\n      null != t && null != e && (n.minValue = t, n.maxValue = e);\n    }\n\n    if (h++, o.addData({\n      pixels: n.pixelData,\n      statistics: {\n        minValue: n.minValue,\n        maxValue: n.maxValue\n      }\n    }), p - d > 10) {\n      const t = String.fromCharCode.apply(null, new Uint8Array(i, d, 10));\n      d += t.indexOf(\"Lerc\") > -1 ? t.indexOf(\"Lerc\") : 0;\n    }\n  }\n\n  let C = 0,\n      D = 0,\n      I = 0;\n\n  if (g > 1) {\n    for (I = o.width * o.height, s = new Uint8Array(I), s.set(f[0]), C = 1; C < f.length; C++) {\n      const t = f[C];\n\n      for (D = 0; D < I; D++) s[D] = s[D] & t[D];\n    }\n\n    for (c = 0, D = 0; D < I; D++) c += s[D];\n\n    o.mask = s;\n  }\n\n  return o.validPixelCount = c, o;\n}\n\nfunction m(t, i) {\n  const a = n(t, i.pyramidLevel || 0),\n        r = new e({\n    width: a.width,\n    height: a.height,\n    pixels: a.pixels,\n    pixelType: a.pixelType.toLowerCase(),\n    mask: a.mask,\n    statistics: null\n  });\n  return r.updateStatistics(), r;\n}\n\nfunction g(t, i) {\n  const a = s(t, i.customOptions),\n        r = new e({\n    width: a.width,\n    height: a.height,\n    pixels: a.pixels,\n    pixelType: a.pixelType.toLowerCase(),\n    mask: a.mask,\n    statistics: null\n  });\n  return r.updateStatistics(), r;\n}\n\nfunction w(t, i, a) {\n  const {\n    pixelTypeCtor: r\n  } = D(i.pixelType),\n        s = (0, d.decode)(t, {\n    width: i.width,\n    height: i.height,\n    pixelType: r,\n    format: a\n  }),\n        n = new e({\n    width: i.width,\n    height: i.height,\n    pixels: s.pixels,\n    pixelType: i.pixelType,\n    mask: s.mask,\n    statistics: null\n  });\n  return n.updateStatistics(), n;\n}\n\nfunction y(t) {\n  const i = a.decode(t),\n        r = new e({\n    width: i.width,\n    height: i.height,\n    pixels: i.pixels,\n    pixelType: \"U8\",\n    mask: i.mask,\n    statistics: null\n  });\n  return r.updateStatistics(), r;\n}\n\nfunction x(t, i) {\n  const a = new Uint8Array(t),\n        r = new c(a),\n        {\n    width: s,\n    height: n\n  } = i,\n        o = s * n,\n        h = r.decode();\n  let d,\n      l = 0,\n      p = 0;\n  const f = new Uint8Array(o);\n\n  for (l = 0; l < o; l++) f[l] = h[4 * l + 3];\n\n  const u = new e({\n    width: s,\n    height: n,\n    pixels: [],\n    pixelType: \"U8\",\n    mask: f,\n    statistics: []\n  });\n\n  for (l = 0; l < 3; l++) {\n    for (d = new Uint8Array(o), p = 0; p < o; p++) d[p] = h[4 * p + l];\n\n    u.addData({\n      pixels: d\n    });\n  }\n\n  return u.updateStatistics(), u;\n}\n\nasync function k(t, a, r, s) {\n  const n = new i(),\n        o = {\n    applyJpegMask: !1,\n    format: a,\n    ...r\n  },\n        h = await n.decode(t, o, s),\n        d = new e(h);\n  return d.updateStatistics(), d;\n}\n\nfunction b(e) {\n  if (null == e) throw new t(\"rasterCodec:decode\", \"parameter encodeddata is required.\");\n  const i = new Uint8Array(e, 0, 10);\n  let a = \"\";\n  return 255 === i[0] && 216 === i[1] ? a = \"jpg\" : 137 === i[0] && 80 === i[1] && 78 === i[2] && 71 === i[3] ? a = \"png\" : 67 === i[0] && 110 === i[1] && 116 === i[2] && 90 === i[3] && 73 === i[4] && 109 === i[5] && 97 === i[6] && 103 === i[7] && 101 === i[8] && 32 === i[9] ? a = \"lerc\" : 76 === i[0] && 101 === i[1] && 114 === i[2] && 99 === i[3] && 50 === i[4] && 32 === i[5] ? a = \"lerc2\" : 73 === i[0] && 73 === i[1] && 42 === i[2] && 0 === i[3] || 77 === i[0] && 77 === i[1] && 0 === i[2] && 42 === i[3] || 73 === i[0] && 73 === i[1] && 43 === i[2] && 0 === i[3] || 77 === i[0] && 77 === i[1] && 0 === i[2] && 43 === i[3] ? a = \"tiff\" : 71 === i[0] && 73 === i[1] && 70 === i[2] ? a = \"gif\" : 66 === i[0] && 77 === i[1] ? a = \"bmp\" : String.fromCharCode.apply(null, i).toLowerCase().indexOf(\"error\") > -1 && (a = \"error\"), a;\n}\n\nfunction C(e) {\n  let i = null;\n\n  switch (e) {\n    case \"lerc\":\n      i = f;\n      break;\n\n    case \"lerc2\":\n      i = u;\n      break;\n\n    case \"jpg\":\n      i = y;\n      break;\n\n    case \"png\":\n      i = x;\n      break;\n\n    case \"bsq\":\n    case \"bip\":\n      i = (t, i) => w(t, i, e);\n\n      break;\n\n    case \"tiff\":\n      i = m;\n      break;\n\n    case \"error\":\n      i = () => {\n        throw new t(\"rasterCodec:decode\", \"input data contains error\");\n      };\n\n      break;\n\n    default:\n      i = () => {\n        throw new t(\"rasterCodec:decode\", \"unsupported raster format\");\n      };\n\n  }\n\n  return i;\n}\n\nfunction D(t) {\n  let e = null,\n      i = null;\n\n  switch (t ? t.toLowerCase() : \"f32\") {\n    case \"u1\":\n    case \"u2\":\n    case \"u4\":\n    case \"u8\":\n      i = 255, e = Uint8Array;\n      break;\n\n    case \"u16\":\n      i = i || 65535, e = Uint16Array;\n      break;\n\n    case \"u32\":\n      i = i || 2 ** 32 - 1, e = Uint32Array;\n      break;\n\n    case \"s8\":\n      i = i || -128, e = Int8Array;\n      break;\n\n    case \"s16\":\n      i = i || -32768, e = Int16Array;\n      break;\n\n    case \"s32\":\n      i = i || 0 - 2 ** 31, e = Int32Array;\n      break;\n\n    default:\n      e = Float32Array;\n  }\n\n  return {\n    pixelTypeCtor: e,\n    noDataValue: i\n  };\n}\n\nfunction I(t, i = 1) {\n  if (!t) return;\n  const {\n    pixels: a,\n    width: r,\n    height: s,\n    mask: n\n  } = t;\n  if (!a || 0 === a.length) return;\n  const o = a.length,\n        h = r - 1,\n        d = s - 1,\n        l = [];\n  let c, p, f, u, m, g, w;\n  const y = e.getPixelArrayConstructor(t.pixelType);\n\n  if (0 === i) {\n    for (c = 0; c < o; c++) {\n      for (m = a[c], g = new y(h * d), p = 0; p < d; p++) for (u = p * r, f = 0; f < h; f++) g[p * h + f] = m[u + f];\n\n      l.push(g);\n    }\n\n    if (n) for (w = new Uint8Array(h * d), p = 0; p < d; p++) for (u = p * r, f = 0; f < h; f++) w[p * h + f] = n[u + f];\n  } else {\n    for (c = 0; c < o; c++) {\n      for (m = a[c], g = new y(h * d), p = 0; p < d; p++) for (u = p * r, f = 0; f < h; f++) g[p * h + f] = (m[u + f] + m[u + f + 1] + m[u + r + f] + m[u + r + f + 1]) / 4;\n\n      l.push(g);\n    }\n\n    if (n) for (w = new Uint8Array(h * d), p = 0; p < d; p++) for (u = p * r, f = 0; f < h; f++) w[p * h + f] = Math.min.apply(null, [n[u + f], n[u + f + 1], n[u + r + f], n[u + r + f + 1]]);\n  }\n\n  t.width = h, t.height = d, t.mask = w, t.pixels = l;\n}\n\nfunction v(t) {\n  let e = b(t);\n  return \"lerc2\" === e ? e = \"lerc\" : \"error\" === e && (e = \"\"), e;\n}\n\nasync function T(e, i = {}, a) {\n  if (null == e) throw new t(\"rasterCodec:decode\", \"missing encodeddata parameter.\");\n  let r,\n      s,\n      n = i.format && i.format.toLowerCase();\n  if (!(\"bsq\" !== n && \"bip\" !== n || null != i.width && null != i.height)) throw new t(\"rasterCodec:decode\", \"requires width and height in options parameter.\");\n  return \"tiff\" === n && i.customOptions ? g(e, i) : ((!n || \"bsq\" !== n && \"bip\" !== n) && (n = b(e)), i.useCanvas && p.has(n) ? s = await k(e, n, i, a) : (r = C(n), i.isPoint && ((i = { ...i\n  }).width++, i.height++), s = r(e, i), i.isPoint && I(s)), s);\n}\n\nexport { T as decode, u as decodeLerc2, v as getFormat };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/layers/support/rasterFormats/RasterCodec.js"],"names":["t","e","i","a","L","r","d","s","n","o","Z","h","isPlatformLittleEndian","l","c","p","f","data","pos","palette","imgData","transparency","animation","text","readUInt32","push","String","fromCharCode","call","join","width","height","bits","colorType","compressionMethod","filterMethod","interlaceMethod","numFrames","numPlays","frames","read","xOffset","yOffset","readUInt16","delay","disposeOp","blendOp","indexed","length","grayscale","rgb","indexOf","apply","slice","colors","hasAlphaChannel","pixelBitlength","colorSpace","Uint8Array","Error","load","XMLHttpRequest","open","responseType","onload","response","mozResponseArrayBuffer","getContext","render","send","prototype","decodePixels","u","m","g","w","y","x","k","b","C","D","I","getBytes","Math","floor","abs","decodePalette","copyToImageData","_decodedPalette","decode","document","createElement","clearRect","putImageData","Image","src","toDataURL","decodeFrames","createImageData","imageData","image","renderFrame","drawImage","animate","_timeout","setTimeout","stopAnimation","clearTimeout","_png","self","Set","pixelType","pixelTypeCtor","noDataValue","byteLength","inputOffset","encodedMaskData","returnMask","returnEncodedMask","returnFileInfo","fileInfo","eofOffset","pixels","mask","maskData","statistics","addData","pixelData","minValue","maxValue","offset","eof","numValidPixel","numBytes","dimCount","dimStats","minValues","maxValues","set","validPixelCount","pyramidLevel","toLowerCase","updateStatistics","customOptions","format","applyJpegMask","Uint16Array","Uint32Array","Int8Array","Int16Array","Int32Array","Float32Array","getPixelArrayConstructor","min","v","T","useCanvas","has","isPoint","decodeLerc2","getFormat"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from\"../../../core/Error.js\";import e from\"../PixelBlock.js\";import i from\"./ImageCanvasDecoder.js\";import a from\"./JpgPlus.js\";import{L as r,d as s,a as n}from\"../../../chunks/TiffDecoder.js\";import{d as o}from\"../../../chunks/LercCodec.js\";import{Z as h}from\"../../../chunks/Zlib.js\";import d from\"./Raw.js\";import{isPlatformLittleEndian as l}from\"./utils.js\";var c=function(t){var e,i,a,r,s,n;function o(t){var e,i,a,r,s,n,o,h,d,l,c,p,f;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},s=null;;){switch(e=this.readUInt32(),h=function(){var t,e;for(e=[],t=0;t<4;++t)e.push(String.fromCharCode(this.data[this.pos++]));return e}.call(this).join(\"\")){case\"IHDR\":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case\"acTL\":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case\"PLTE\":this.palette=this.read(e);break;case\"fcTL\":s&&this.animation.frames.push(s),this.pos+=4,s={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},r=this.readUInt16(),a=this.readUInt16()||100,s.delay=1e3*r/a,s.disposeOp=this.data[this.pos++],s.blendOp=this.data[this.pos++],s.data=[];break;case\"IDAT\":case\"fdAT\":for(\"fdAT\"===h&&(this.pos+=4,e-=4),t=(null!=s?s.data:void 0)||this.imgData,c=0;0<=e?c<e:c>e;0<=e?++c:--c)t.push(this.data[this.pos++]);break;case\"tRNS\":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(e),(d=255-this.transparency.indexed.length)>0)for(p=0;0<=d?p<d:p>d;0<=d?++p:--p)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case\"tEXt\":n=(l=this.read(e)).indexOf(0),o=String.fromCharCode.apply(String,l.slice(0,n)),this.text[o]=String.fromCharCode.apply(String,l.slice(n+1));break;case\"IEND\":return s&&this.animation.frames.push(s),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(f=this.colorType)||6===f,i=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*i,this.colorSpace=function(){switch(this.colors){case 1:return\"DeviceGray\";case 3:return\"DeviceRGB\"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error(\"Incomplete or corrupt PNG file\")}}return o.load=function(t,e,i){var a;return\"function\"==typeof e&&(i=e),(a=new XMLHttpRequest).open(\"GET\",t,!0),a.responseType=\"arraybuffer\",a.onload=function(){var t;return t=new o(new Uint8Array(a.response||a.mozResponseArrayBuffer)),\"function\"==typeof(null!=e?e.getContext:void 0)&&t.render(e),\"function\"==typeof i?i(t):void 0},a.send(null)},i=1,a=2,e=0,o.prototype.read=function(t){var e,i;for(i=[],e=0;0<=t?e<t:e>t;0<=t?++e:--e)i.push(this.data[this.pos++]);return i},o.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},o.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},o.prototype.decodePixels=function(t){var e,i,a,r,s,n,o,d,l,c,p,f,u,m,g,w,y,x,k,b,C,D,I;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);for(t=(t=new h(t)).getBytes(),w=(f=this.pixelBitlength/8)*this.width,u=new Uint8Array(w*this.height),n=t.length,g=0,m=0,i=0;m<n;){switch(t[m++]){case 0:for(r=k=0;k<w;r=k+=1)u[i++]=t[m++];break;case 1:for(r=b=0;b<w;r=b+=1)e=t[m++],s=r<f?0:u[i-f],u[i++]=(e+s)%256;break;case 2:for(r=C=0;C<w;r=C+=1)e=t[m++],a=(r-r%f)/f,y=g&&u[(g-1)*w+a*f+r%f],u[i++]=(y+e)%256;break;case 3:for(r=D=0;D<w;r=D+=1)e=t[m++],a=(r-r%f)/f,s=r<f?0:u[i-f],y=g&&u[(g-1)*w+a*f+r%f],u[i++]=(e+Math.floor((s+y)/2))%256;break;case 4:for(r=I=0;I<w;r=I+=1)e=t[m++],a=(r-r%f)/f,s=r<f?0:u[i-f],0===g?y=x=0:(y=u[(g-1)*w+a*f+r%f],x=a&&u[(g-1)*w+(a-1)*f+r%f]),o=s+y-x,d=Math.abs(o-s),c=Math.abs(o-y),p=Math.abs(o-x),l=d<=c&&d<=p?s:c<=p?y:x,u[i++]=(e+l)%256;break;default:throw new Error(\"Invalid filter algorithm: \"+t[m-1])}g++}return u},o.prototype.decodePalette=function(){var t,e,i,a,r,s,n,o,h;for(i=this.palette,s=this.transparency.indexed||[],r=new Uint8Array((s.length||0)+i.length),a=0,i.length,t=0,e=n=0,o=i.length;n<o;e=n+=3)r[a++]=i[e],r[a++]=i[e+1],r[a++]=i[e+2],r[a++]=null!=(h=s[t++])?h:255;return r},o.prototype.copyToImageData=function(t,e){var i,a,r,s,n,o,h,d,l,c,p;if(a=this.colors,l=null,i=this.hasAlphaChannel,this.palette.length&&(l=null!=(p=this._decodedPalette)?p:this._decodedPalette=this.decodePalette(),a=4,i=!0),d=(r=t.data||t).length,n=l||e,s=o=0,1===a)for(;s<d;)h=l?4*e[s/4]:o,c=n[h++],r[s++]=c,r[s++]=c,r[s++]=c,r[s++]=i?n[h++]:this.transparency.grayscale&&this.transparency.grayscale===c?0:255,o=h;else for(;s<d;)h=l?4*e[s/4]:o,r[s++]=n[h++],r[s++]=n[h++],r[s++]=n[h++],r[s++]=i?n[h++]:this.transparency.rgb&&this.transparency.rgb[1]===n[h-3]&&this.transparency.rgb[3]===n[h-2]&&this.transparency.rgb[5]===n[h-1]?0:255,o=h},o.prototype.decode=function(){var t;return t=new Uint8Array(this.width*this.height*4),this.copyToImageData(t,this.decodePixels()),t},s=t.document&&t.document.createElement(\"canvas\"),n=s&&s.getContext(\"2d\"),r=function(t){var e;return n.width=t.width,n.height=t.height,n.clearRect(0,0,t.width,t.height),n.putImageData(t,0,0),(e=new Image).src=s.toDataURL(),e},o.prototype.decodeFrames=function(t){var e,i,a,s,n,o,h,d;if(this.animation){for(d=[],i=n=0,o=(h=this.animation.frames).length;n<o;i=++n)e=h[i],a=t.createImageData(e.width,e.height),s=this.decodePixels(new Uint8Array(e.data)),this.copyToImageData(a,s),e.imageData=a,d.push(e.image=r(a));return d}},o.prototype.renderFrame=function(t,r){var s,n,o;return s=(n=this.animation.frames)[r],o=n[r-1],0===r&&t.clearRect(0,0,this.width,this.height),(null!=o?o.disposeOp:void 0)===i?t.clearRect(o.xOffset,o.yOffset,o.width,o.height):(null!=o?o.disposeOp:void 0)===a&&t.putImageData(o.imageData,o.xOffset,o.yOffset),s.blendOp===e&&t.clearRect(s.xOffset,s.yOffset,s.width,s.height),t.drawImage(s.image,s.xOffset,s.yOffset)},o.prototype.animate=function(t){var e,i,a,r,s,n,o=this;return i=0,n=this.animation,r=n.numFrames,a=n.frames,s=n.numPlays,(e=function(){var n,h;if(n=i++%r,h=a[n],o.renderFrame(t,n),r>1&&i/r<s)return o.animation._timeout=setTimeout(e,h.delay)})()},o.prototype.stopAnimation=function(){var t;return clearTimeout(null!=(t=this.animation)?t._timeout:void 0)},o.prototype.render=function(t){var e,i;return t._png&&t._png.stopAnimation(),t._png=this,t.width=this.width,t.height=this.height,e=t.getContext(\"2d\"),this.animation?(this.decodeFrames(e),this.animate(e)):(i=e.createImageData(this.width,this.height),this.copyToImageData(i,this.decodePixels()),e.putImageData(i,0,0))},o}(self);const p=new Set([\"jpg\",\"png\",\"bmp\",\"gif\"]);function f(i,a){if(!l)throw new t(\"rasterCoded:decode\",\"lerc decoder is not supported on big endian platform\");const{width:r,height:s,pixelType:n}=a,h=D(n),d=h.pixelTypeCtor,c=null==a.noDataValue?h.noDataValue:a.noDataValue;let p,f,u=0,m=0;const g=i.byteLength-10;for(;m<g;){const a=o(i,{inputOffset:m,encodedMaskData:p,returnMask:0===u,returnEncodedMask:0===u,returnFileInfo:!0,pixelType:d,noDataValue:c});if(r&&s&&(a.width!==r||a.height!==s))throw new t(\"rasterCoded:decode\",\"lerc decoded result has width or height different from specified in options\");if(m=a.fileInfo.eofOffset,0===u&&(p=a.encodedMaskData,f=new e({width:a.width,height:a.height,pixels:[],pixelType:n,mask:a.maskData,statistics:[]})),u++,f.addData({pixels:a.pixelData,statistics:{minValue:a.minValue,maxValue:a.maxValue,noDataValue:a.noDataValue}}),g-m>10){const t=String.fromCharCode.apply(null,new Uint8Array(i,m,10));m+=t.indexOf(\"CntZ\")>-1?t.indexOf(\"CntZ\"):0}}return f}function u(i,a){if(!l)throw new t(\"rasterCoded:decode\",\"lerc decoder is not supported on big endian platform\");let s,n,o,h=0,d=a.offset||0,c=0;const p=a.eof||i.byteLength-10,f=[],{width:u,height:m}=a;let g=0;for(;d<p;){var w;if(n=r.decode(i,{inputOffset:d,maskData:s,returnFileInfo:!0}),u&&m&&(n.width!==u||n.height!==m))throw new t(\"rasterCoded:decode\",\"lerc2 decoded result has width or height different from what's specified in options\");if(d=n.fileInfo.eofOffset,s=n.maskData,0===h&&(c=n.fileInfo.numValidPixel,o=new e({width:n.width,height:n.height,pixels:[],pixelType:n.fileInfo.pixelType,mask:s,statistics:[]})),n.fileInfo.mask&&n.fileInfo.mask.numBytes>0&&g++,s&&f.push(s),n.dimCount>1&&(null==(w=n.pixelData)?void 0:w.length)===n.width*n.height*n.dimCount){var y,x,k,b;n.pixelData=n.pixelData.slice(-n.width*n.height);const t=null==(y=n.dimStats)||null==(x=y.minValues)?void 0:x[n.dimCount-1],e=null==(k=n.dimStats)||null==(b=k.maxValues)?void 0:b[n.dimCount-1];null!=t&&null!=e&&(n.minValue=t,n.maxValue=e)}if(h++,o.addData({pixels:n.pixelData,statistics:{minValue:n.minValue,maxValue:n.maxValue}}),p-d>10){const t=String.fromCharCode.apply(null,new Uint8Array(i,d,10));d+=t.indexOf(\"Lerc\")>-1?t.indexOf(\"Lerc\"):0}}let C=0,D=0,I=0;if(g>1){for(I=o.width*o.height,s=new Uint8Array(I),s.set(f[0]),C=1;C<f.length;C++){const t=f[C];for(D=0;D<I;D++)s[D]=s[D]&t[D]}for(c=0,D=0;D<I;D++)c+=s[D];o.mask=s}return o.validPixelCount=c,o}function m(t,i){const a=n(t,i.pyramidLevel||0),r=new e({width:a.width,height:a.height,pixels:a.pixels,pixelType:a.pixelType.toLowerCase(),mask:a.mask,statistics:null});return r.updateStatistics(),r}function g(t,i){const a=s(t,i.customOptions),r=new e({width:a.width,height:a.height,pixels:a.pixels,pixelType:a.pixelType.toLowerCase(),mask:a.mask,statistics:null});return r.updateStatistics(),r}function w(t,i,a){const{pixelTypeCtor:r}=D(i.pixelType),s=(0,d.decode)(t,{width:i.width,height:i.height,pixelType:r,format:a}),n=new e({width:i.width,height:i.height,pixels:s.pixels,pixelType:i.pixelType,mask:s.mask,statistics:null});return n.updateStatistics(),n}function y(t){const i=a.decode(t),r=new e({width:i.width,height:i.height,pixels:i.pixels,pixelType:\"U8\",mask:i.mask,statistics:null});return r.updateStatistics(),r}function x(t,i){const a=new Uint8Array(t),r=new c(a),{width:s,height:n}=i,o=s*n,h=r.decode();let d,l=0,p=0;const f=new Uint8Array(o);for(l=0;l<o;l++)f[l]=h[4*l+3];const u=new e({width:s,height:n,pixels:[],pixelType:\"U8\",mask:f,statistics:[]});for(l=0;l<3;l++){for(d=new Uint8Array(o),p=0;p<o;p++)d[p]=h[4*p+l];u.addData({pixels:d})}return u.updateStatistics(),u}async function k(t,a,r,s){const n=new i,o={applyJpegMask:!1,format:a,...r},h=await n.decode(t,o,s),d=new e(h);return d.updateStatistics(),d}function b(e){if(null==e)throw new t(\"rasterCodec:decode\",\"parameter encodeddata is required.\");const i=new Uint8Array(e,0,10);let a=\"\";return 255===i[0]&&216===i[1]?a=\"jpg\":137===i[0]&&80===i[1]&&78===i[2]&&71===i[3]?a=\"png\":67===i[0]&&110===i[1]&&116===i[2]&&90===i[3]&&73===i[4]&&109===i[5]&&97===i[6]&&103===i[7]&&101===i[8]&&32===i[9]?a=\"lerc\":76===i[0]&&101===i[1]&&114===i[2]&&99===i[3]&&50===i[4]&&32===i[5]?a=\"lerc2\":73===i[0]&&73===i[1]&&42===i[2]&&0===i[3]||77===i[0]&&77===i[1]&&0===i[2]&&42===i[3]||73===i[0]&&73===i[1]&&43===i[2]&&0===i[3]||77===i[0]&&77===i[1]&&0===i[2]&&43===i[3]?a=\"tiff\":71===i[0]&&73===i[1]&&70===i[2]?a=\"gif\":66===i[0]&&77===i[1]?a=\"bmp\":String.fromCharCode.apply(null,i).toLowerCase().indexOf(\"error\")>-1&&(a=\"error\"),a}function C(e){let i=null;switch(e){case\"lerc\":i=f;break;case\"lerc2\":i=u;break;case\"jpg\":i=y;break;case\"png\":i=x;break;case\"bsq\":case\"bip\":i=(t,i)=>w(t,i,e);break;case\"tiff\":i=m;break;case\"error\":i=()=>{throw new t(\"rasterCodec:decode\",\"input data contains error\")};break;default:i=()=>{throw new t(\"rasterCodec:decode\",\"unsupported raster format\")}}return i}function D(t){let e=null,i=null;switch(t?t.toLowerCase():\"f32\"){case\"u1\":case\"u2\":case\"u4\":case\"u8\":i=255,e=Uint8Array;break;case\"u16\":i=i||65535,e=Uint16Array;break;case\"u32\":i=i||2**32-1,e=Uint32Array;break;case\"s8\":i=i||-128,e=Int8Array;break;case\"s16\":i=i||-32768,e=Int16Array;break;case\"s32\":i=i||0-2**31,e=Int32Array;break;default:e=Float32Array}return{pixelTypeCtor:e,noDataValue:i}}function I(t,i=1){if(!t)return;const{pixels:a,width:r,height:s,mask:n}=t;if(!a||0===a.length)return;const o=a.length,h=r-1,d=s-1,l=[];let c,p,f,u,m,g,w;const y=e.getPixelArrayConstructor(t.pixelType);if(0===i){for(c=0;c<o;c++){for(m=a[c],g=new y(h*d),p=0;p<d;p++)for(u=p*r,f=0;f<h;f++)g[p*h+f]=m[u+f];l.push(g)}if(n)for(w=new Uint8Array(h*d),p=0;p<d;p++)for(u=p*r,f=0;f<h;f++)w[p*h+f]=n[u+f]}else{for(c=0;c<o;c++){for(m=a[c],g=new y(h*d),p=0;p<d;p++)for(u=p*r,f=0;f<h;f++)g[p*h+f]=(m[u+f]+m[u+f+1]+m[u+r+f]+m[u+r+f+1])/4;l.push(g)}if(n)for(w=new Uint8Array(h*d),p=0;p<d;p++)for(u=p*r,f=0;f<h;f++)w[p*h+f]=Math.min.apply(null,[n[u+f],n[u+f+1],n[u+r+f],n[u+r+f+1]])}t.width=h,t.height=d,t.mask=w,t.pixels=l}function v(t){let e=b(t);return\"lerc2\"===e?e=\"lerc\":\"error\"===e&&(e=\"\"),e}async function T(e,i={},a){if(null==e)throw new t(\"rasterCodec:decode\",\"missing encodeddata parameter.\");let r,s,n=i.format&&i.format.toLowerCase();if(!(\"bsq\"!==n&&\"bip\"!==n||null!=i.width&&null!=i.height))throw new t(\"rasterCodec:decode\",\"requires width and height in options parameter.\");return\"tiff\"===n&&i.customOptions?g(e,i):((!n||\"bsq\"!==n&&\"bip\"!==n)&&(n=b(e)),i.useCanvas&&p.has(n)?s=await k(e,n,i,a):(r=C(n),i.isPoint&&((i={...i}).width++,i.height++),s=r(e,i),i.isPoint&&I(s)),s)}export{T as decode,u as decodeLerc2,v as getFormat};\n"]},"metadata":{},"sourceType":"module"}