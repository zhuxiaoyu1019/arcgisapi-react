{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from \"../../core/has.js\";\nimport { isNone as e, isSome as i } from \"../../core/maybe.js\";\nimport { BASE_TEXTURE_UNIT as s } from \"./enums.js\";\nimport { InstanceCounter as a } from \"./InstanceCounter.js\";\nimport { StateTracker as n } from \"./renderState.js\";\nimport l from \"./Texture.js\";\nimport r from \"./capabilities/isWebGL2Context.js\";\nimport { loadCapabilities as h } from \"./capabilities/load.js\";\n\nclass c {\n  constructor(t, e = {}) {\n    this.gl = t, this.instanceCounter = new a(), this._blendEnabled = !1, this._blendColorState = {\n      r: 0,\n      g: 0,\n      b: 0,\n      a: 0\n    }, this._blendFunctionState = {\n      srcRGB: 1,\n      dstRGB: 0,\n      srcAlpha: 1,\n      dstAlpha: 0\n    }, this._blendEquationState = {\n      mode: 32774,\n      modeAlpha: 32774\n    }, this._colorMaskState = {\n      r: !0,\n      g: !0,\n      b: !0,\n      a: !0\n    }, this._polygonCullingEnabled = !1, this._cullFace = 1029, this._frontFace = 2305, this._scissorTestEnabled = !1, this._scissorRect = {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    }, this._depthTestEnabled = !1, this._depthFunction = 513, this._clearDepth = 1, this._depthWriteEnabled = !0, this._depthRange = {\n      zNear: 0,\n      zFar: 1\n    }, this._viewport = null, this._stencilTestEnabled = !1, this._polygonOffsetFillEnabled = !1, this._polygonOffset = [0, 0], this._stencilFunction = {\n      face: 1032,\n      func: 519,\n      ref: 0,\n      mask: 1\n    }, this._clearStencil = 0, this._stencilWriteMask = 1, this._stencilOperation = {\n      face: 1032,\n      fail: 7680,\n      zFail: 7680,\n      zPass: 7680\n    }, this._clearColor = {\n      r: 0,\n      g: 0,\n      b: 0,\n      a: 0\n    }, this._activeShaderProgram = null, this._activeVertexBuffer = null, this._activeIndexBuffer = null, this._activeFramebuffer = null, this._activeRenderbuffer = null, this._activeTextureUnit = 0, this._textureUnitMap = new Array(), this._numOfDrawCalls = 0, this._numOfTriangles = 0, this.webglVersion = r(t) ? \"webgl2\" : \"webgl\", t instanceof WebGLRenderingContext && this.gl.getExtension(\"OES_element_index_uint\"), this._capabilities = h(t, e), this._parameters = this._loadParameters(e);\n    const i = this.gl.getParameter(this.gl.VIEWPORT);\n    this._viewport = {\n      x: i[0],\n      y: i[1],\n      width: i[2],\n      height: i[3]\n    }, this._stateTracker = new n({\n      setBlending: t => {\n        if (t) {\n          this.setBlendingEnabled(!0), this.setBlendEquationSeparate(t.opRgb, t.opAlpha), this.setBlendFunctionSeparate(t.srcRgb, t.dstRgb, t.srcAlpha, t.dstAlpha);\n          const e = t.color;\n          this.setBlendColor(e.r, e.g, e.b, e.a);\n        } else this.setBlendingEnabled(!1);\n      },\n      setCulling: t => {\n        t ? (this.setFaceCullingEnabled(!0), this.setCullFace(t.face), this.setFrontFace(t.mode)) : this.setFaceCullingEnabled(!1);\n      },\n      setPolygonOffset: t => {\n        t ? (this.setPolygonOffsetFillEnabled(!0), this.setPolygonOffset(t.factor, t.units)) : this.setPolygonOffsetFillEnabled(!1);\n      },\n      setDepthTest: t => {\n        t ? (this.setDepthTestEnabled(!0), this.setDepthFunction(t.func)) : this.setDepthTestEnabled(!1);\n      },\n      setStencilTest: t => {\n        if (t) {\n          this.setStencilTestEnabled(!0);\n          const e = t.function;\n          this.setStencilFunction(e.func, e.ref, e.mask);\n          const i = t.operation;\n          this.setStencilOp(i.fail, i.zFail, i.zPass);\n        } else this.setStencilTestEnabled(!1);\n      },\n      setDepthWrite: t => {\n        t ? (this.setDepthWriteEnabled(!0), this.setDepthRange(t.zNear, t.zFar)) : this.setDepthWriteEnabled(!1);\n      },\n      setColorWrite: t => {\n        t ? this.setColorMask(t.r, t.g, t.b, t.a) : this.setColorMask(!1, !1, !1, !1);\n      },\n      setStencilWrite: t => {\n        t ? this.setStencilWriteMask(t.mask) : this.setStencilWriteMask(0);\n      }\n    }), this.enforceState();\n  }\n\n  get contextAttributes() {\n    return this.gl.getContextAttributes();\n  }\n\n  get parameters() {\n    return this._parameters;\n  }\n\n  dispose() {\n    this.bindVAO(null), this.unbindBuffer(34962), this.unbindBuffer(34963), this._textureUnitMap.length = 0, d() && this.instanceCounter.printResourceCount();\n  }\n\n  setPipelineState(t) {\n    this._stateTracker.setPipeline(t);\n  }\n\n  setBlendingEnabled(t) {\n    this._blendEnabled !== t && (!0 === t ? this.gl.enable(this.gl.BLEND) : this.gl.disable(this.gl.BLEND), this._blendEnabled = t, this._stateTracker.invalidateBlending());\n  }\n\n  externalTextureUnitUpdate(t, e) {\n    for (let i = 0; i < t.length; ++i) this._textureUnitMap[t[i]] = null;\n\n    e >= 0 && (this._activeTextureUnit = e);\n  }\n\n  externalVertexArrayObjectUpdate() {\n    const t = this.capabilities.vao;\n    t && (t.bindVertexArray(null), this._activeVertexArrayObject = null), this._activeVertexBuffer = null, this._activeIndexBuffer = null;\n  }\n\n  externalVertexBufferUpdate() {\n    this._activeVertexBuffer = null;\n  }\n\n  externalIndexBufferUpdate() {\n    this._activeIndexBuffer = null;\n  }\n\n  setBlendColor(t, e, i, s) {\n    t === this._blendColorState.r && e === this._blendColorState.g && i === this._blendColorState.b && s === this._blendColorState.a || (this.gl.blendColor(t, e, i, s), this._blendColorState.r = t, this._blendColorState.g = e, this._blendColorState.b = i, this._blendColorState.a = s, this._stateTracker.invalidateBlending());\n  }\n\n  setBlendFunction(t, e) {\n    t === this._blendFunctionState.srcRGB && e === this._blendFunctionState.dstRGB || (this.gl.blendFunc(t, e), this._blendFunctionState.srcRGB = t, this._blendFunctionState.srcAlpha = t, this._blendFunctionState.dstRGB = e, this._blendFunctionState.dstAlpha = e, this._stateTracker.invalidateBlending());\n  }\n\n  setBlendFunctionSeparate(t, e, i, s) {\n    this._blendFunctionState.srcRGB === t && this._blendFunctionState.srcAlpha === i && this._blendFunctionState.dstRGB === e && this._blendFunctionState.dstAlpha === s || (this.gl.blendFuncSeparate(t, e, i, s), this._blendFunctionState.srcRGB = t, this._blendFunctionState.srcAlpha = i, this._blendFunctionState.dstRGB = e, this._blendFunctionState.dstAlpha = s, this._stateTracker.invalidateBlending());\n  }\n\n  setBlendEquation(t) {\n    this._blendEquationState.mode !== t && (this.gl.blendEquation(t), this._blendEquationState.mode = t, this._blendEquationState.modeAlpha = t, this._stateTracker.invalidateBlending());\n  }\n\n  setBlendEquationSeparate(t, e) {\n    this._blendEquationState.mode === t && this._blendEquationState.modeAlpha === e || (this.gl.blendEquationSeparate(t, e), this._blendEquationState.mode = t, this._blendEquationState.modeAlpha = e, this._stateTracker.invalidateBlending());\n  }\n\n  setColorMask(t, e, i, s) {\n    this._colorMaskState.r === t && this._colorMaskState.g === e && this._colorMaskState.b === i && this._colorMaskState.a === s || (this.gl.colorMask(t, e, i, s), this._colorMaskState.r = t, this._colorMaskState.g = e, this._colorMaskState.b = i, this._colorMaskState.a = s, this._stateTracker.invalidateColorWrite());\n  }\n\n  setClearColor(t, e, i, s) {\n    this._clearColor.r === t && this._clearColor.g === e && this._clearColor.b === i && this._clearColor.a === s || (this.gl.clearColor(t, e, i, s), this._clearColor.r = t, this._clearColor.g = e, this._clearColor.b = i, this._clearColor.a = s);\n  }\n\n  setFaceCullingEnabled(t) {\n    this._polygonCullingEnabled !== t && (!0 === t ? this.gl.enable(this.gl.CULL_FACE) : this.gl.disable(this.gl.CULL_FACE), this._polygonCullingEnabled = t, this._stateTracker.invalidateCulling());\n  }\n\n  setPolygonOffsetFillEnabled(t) {\n    this._polygonOffsetFillEnabled !== t && (!0 === t ? this.gl.enable(this.gl.POLYGON_OFFSET_FILL) : this.gl.disable(this.gl.POLYGON_OFFSET_FILL), this._polygonOffsetFillEnabled = t, this._stateTracker.invalidatePolygonOffset());\n  }\n\n  setPolygonOffset(t, e) {\n    this._polygonOffset[0] === t && this._polygonOffset[1] === e || (this._polygonOffset[0] = t, this._polygonOffset[1] = e, this.gl.polygonOffset(t, e), this._stateTracker.invalidatePolygonOffset());\n  }\n\n  setCullFace(t) {\n    this._cullFace !== t && (this.gl.cullFace(t), this._cullFace = t, this._stateTracker.invalidateCulling());\n  }\n\n  setFrontFace(t) {\n    this._frontFace !== t && (this.gl.frontFace(t), this._frontFace = t, this._stateTracker.invalidateCulling());\n  }\n\n  setScissorTestEnabled(t) {\n    this._scissorTestEnabled !== t && (!0 === t ? this.gl.enable(this.gl.SCISSOR_TEST) : this.gl.disable(this.gl.SCISSOR_TEST), this._scissorTestEnabled = t);\n  }\n\n  setScissorRect(t, e, i, s) {\n    this._scissorRect.x === t && this._scissorRect.y === e && this._scissorRect.width === i && this._scissorRect.height === s || (this.gl.scissor(t, e, i, s), this._scissorRect.x = t, this._scissorRect.y = e, this._scissorRect.width = i, this._scissorRect.height = s);\n  }\n\n  setDepthTestEnabled(t) {\n    this._depthTestEnabled !== t && (!0 === t ? this.gl.enable(this.gl.DEPTH_TEST) : this.gl.disable(this.gl.DEPTH_TEST), this._depthTestEnabled = t, this._stateTracker.invalidateDepthTest());\n  }\n\n  setClearDepth(t) {\n    this._clearDepth !== t && (this.gl.clearDepth(t), this._clearDepth = t);\n  }\n\n  setDepthFunction(t) {\n    this._depthFunction !== t && (this.gl.depthFunc(t), this._depthFunction = t, this._stateTracker.invalidateDepthTest());\n  }\n\n  setDepthWriteEnabled(t) {\n    this._depthWriteEnabled !== t && (this.gl.depthMask(t), this._depthWriteEnabled = t, this._stateTracker.invalidateDepthWrite());\n  }\n\n  setDepthRange(t, e) {\n    this._depthRange.zNear === t && this._depthRange.zFar === e || (this.gl.depthRange(t, e), this._depthRange.zNear = t, this._depthRange.zFar = e, this._stateTracker.invalidateDepthWrite());\n  }\n\n  setStencilTestEnabled(t) {\n    this._stencilTestEnabled !== t && (!0 === t ? this.gl.enable(this.gl.STENCIL_TEST) : this.gl.disable(this.gl.STENCIL_TEST), this._stencilTestEnabled = t, this._stateTracker.invalidateStencilTest());\n  }\n\n  setClearStencil(t) {\n    t !== this._clearStencil && (this.gl.clearStencil(t), this._clearStencil = t);\n  }\n\n  setStencilFunction(t, e, i) {\n    this._stencilFunction.func === t && this._stencilFunction.ref === e && this._stencilFunction.mask === i || (this.gl.stencilFunc(t, e, i), this._stencilFunction.face = 1032, this._stencilFunction.func = t, this._stencilFunction.ref = e, this._stencilFunction.mask = i, this._stateTracker.invalidateStencilTest());\n  }\n\n  setStencilFunctionSeparate(t, e, i, s) {\n    this._stencilFunction.face === t && this._stencilFunction.func === e && this._stencilFunction.ref === i && this._stencilFunction.mask === s || (this.gl.stencilFuncSeparate(t, e, i, s), this._stencilFunction.face = t, this._stencilFunction.func = e, this._stencilFunction.ref = i, this._stencilFunction.mask = s, this._stateTracker.invalidateStencilTest());\n  }\n\n  setStencilWriteMask(t) {\n    this._stencilWriteMask !== t && (this.gl.stencilMask(t), this._stencilWriteMask = t, this._stateTracker.invalidateStencilWrite());\n  }\n\n  setStencilOp(t, e, i) {\n    this._stencilOperation.fail === t && this._stencilOperation.zFail === e && this._stencilOperation.zPass === i || (this.gl.stencilOp(t, e, i), this._stencilOperation.face = 1032, this._stencilOperation.fail = t, this._stencilOperation.zFail = e, this._stencilOperation.zPass = i, this._stateTracker.invalidateStencilTest());\n  }\n\n  setStencilOpSeparate(t, e, i, s) {\n    this._stencilOperation.face === t && this._stencilOperation.fail === e && this._stencilOperation.zFail === i && this._stencilOperation.zPass === s || (this.gl.stencilOpSeparate(t, e, i, s), this._stencilOperation.face = t, this._stencilOperation.face = t, this._stencilOperation.fail = e, this._stencilOperation.zFail = i, this._stencilOperation.zPass = s, this._stateTracker.invalidateStencilTest());\n  }\n\n  setActiveTexture(t, e = !1) {\n    const i = this._activeTextureUnit;\n    return t >= 0 && (e || t !== this._activeTextureUnit) && (this.gl.activeTexture(s + t), this._activeTextureUnit = t), i;\n  }\n\n  clear(t) {\n    t && this.gl.clear(t);\n  }\n\n  clearSafe(t, e = 255) {\n    t && (16384 & t && this.setColorMask(!0, !0, !0, !0), 256 & t && this.setDepthWriteEnabled(!0), 1024 & t && this.setStencilWriteMask(e), this.gl.clear(t));\n  }\n\n  drawArrays(t, e, i) {\n    d() && (this._numOfDrawCalls++, this._numOfTriangles += _(t, i)), this.gl.drawArrays(t, e, i);\n  }\n\n  drawElements(t, e, i, s) {\n    d() && (this._numOfDrawCalls++, this._numOfTriangles += _(t, e)), this.gl.drawElements(t, e, i, s);\n  }\n\n  logIno() {\n    d() && console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`);\n  }\n\n  get capabilities() {\n    return this._capabilities;\n  }\n\n  setViewport(t, e, i, s) {\n    i = Math.max(Math.round(i), 1), s = Math.max(Math.round(s), 1);\n    const a = this._viewport;\n    a.x === t && a.y === e && a.width === i && a.height === s || (a.x = t, a.y = e, a.width = i, a.height = s, this.gl.viewport(t, e, i, s));\n  }\n\n  getViewport() {\n    return {\n      x: this._viewport.x,\n      y: this._viewport.y,\n      width: this._viewport.width,\n      height: this._viewport.height\n    };\n  }\n\n  useProgram(t) {\n    var e, i;\n    if (!t) return null == (i = this._activeShaderProgram) || i.stop(), this._activeShaderProgram = null, void this.gl.useProgram(null);\n    this._activeShaderProgram !== t && (null == (e = this._activeShaderProgram) || e.stop(), this._activeShaderProgram = t, this.gl.useProgram(t.glName));\n  }\n\n  bindTexture(t, s, a = !1) {\n    (s >= this.parameters.maxTextureImageUnits || s < 0) && console.error(\"Input texture unit is out of range of available units!\");\n    const n = this._textureUnitMap[s];\n    return this.setActiveTexture(s, a), e(t) || null == t.glName ? (i(n) && this.gl.bindTexture(n.descriptor.target, null), this._textureUnitMap[s] = null, n) : a || n !== t ? (this.gl.bindTexture(t.descriptor.target, t.glName), t.applyChanges(), this._textureUnitMap[s] = t, n) : (t.applyChanges(), n);\n  }\n\n  unbindTextureAllUnits(t) {\n    for (let e = 0; e < this.parameters.maxTextureImageUnits; e++) this._textureUnitMap[e] === t && (this.bindTexture(null, e), this._textureUnitMap[e] = null);\n  }\n\n  bindFramebuffer(t, i = !1) {\n    if (e(t)) return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, null), void (this._activeFramebuffer = null);\n    (i || this._activeFramebuffer !== t) && (t.initializeAndBind(), this._activeFramebuffer = t);\n  }\n\n  bindBuffer(t) {\n    t && (34962 === t.bufferType ? this._activeVertexBuffer = o(this.gl, t, t.bufferType, this._activeVertexBuffer) : this._activeIndexBuffer = o(this.gl, t, t.bufferType, this._activeIndexBuffer));\n  }\n\n  bindRenderbuffer(t) {\n    const e = this.gl;\n    t || (e.bindRenderbuffer(e.RENDERBUFFER, null), this._activeRenderbuffer = null), this._activeRenderbuffer !== t && (e.bindRenderbuffer(e.RENDERBUFFER, t.glName), this._activeRenderbuffer = t);\n  }\n\n  unbindBuffer(t) {\n    34962 === t ? this._activeVertexBuffer = o(this.gl, null, t, this._activeVertexBuffer) : this._activeIndexBuffer = o(this.gl, null, t, this._activeIndexBuffer);\n  }\n\n  bindVAO(t = null) {\n    e(t) ? this._activeVertexArrayObject && (this._activeVertexArrayObject.unbind(), this._activeVertexArrayObject = null) : this._activeVertexArrayObject !== t && (t.bind(), this._activeVertexArrayObject = t);\n  }\n\n  getBoundFramebufferObject() {\n    return this._activeFramebuffer;\n  }\n\n  getBoundVAO() {\n    return this._activeVertexArrayObject;\n  }\n\n  resetState() {\n    this.useProgram(null), this.bindVAO(null), this.bindFramebuffer(null), this.unbindBuffer(34962), this.unbindBuffer(34963);\n\n    for (let t = 0; t < this.parameters.maxTextureImageUnits; ++t) this.bindTexture(null, t);\n\n    this.setBlendingEnabled(!1), this.setBlendFunction(1, 0), this.setBlendEquation(32774), this.setBlendColor(0, 0, 0, 0), this.setFaceCullingEnabled(!1), this.setCullFace(1029), this.setFrontFace(2305), this.setPolygonOffsetFillEnabled(!1), this.setPolygonOffset(0, 0), this.setScissorTestEnabled(!1), this.setScissorRect(0, 0, this.gl.canvas.width, this.gl.canvas.height), this.setDepthTestEnabled(!1), this.setDepthFunction(513), this.setDepthRange(0, 1), this.setStencilTestEnabled(!1), this.setStencilFunction(519, 0, 0), this.setStencilOp(7680, 7680, 7680), this.setClearColor(0, 0, 0, 0), this.setClearDepth(1), this.setClearStencil(0), this.setColorMask(!0, !0, !0, !0), this.setStencilWriteMask(4294967295), this.setDepthWriteEnabled(!0), this.setViewport(0, 0, this.gl.canvas.width, this.gl.canvas.height);\n  }\n\n  enforceState() {\n    const t = this.gl,\n          e = this.capabilities.vao;\n    e && e.bindVertexArray(null);\n\n    for (let i = 0; i < this.parameters.maxVertexAttributes; i++) t.disableVertexAttribArray(i);\n\n    if (this._activeVertexBuffer ? t.bindBuffer(this._activeVertexBuffer.bufferType, this._activeVertexBuffer.glName) : t.bindBuffer(34962, null), this._activeIndexBuffer ? t.bindBuffer(this._activeIndexBuffer.bufferType, this._activeIndexBuffer.glName) : t.bindBuffer(34963, null), e && this._activeVertexArrayObject) {\n      const t = this._activeVertexArrayObject;\n      this._activeVertexArrayObject && (this._activeVertexArrayObject.unbind(), this._activeVertexArrayObject = null), this.bindVAO(t);\n    }\n\n    t.bindFramebuffer(t.FRAMEBUFFER, this._activeFramebuffer ? this._activeFramebuffer.glName : null), t.useProgram(this._activeShaderProgram ? this._activeShaderProgram.glName : null), t.blendColor(this._blendColorState.r, this._blendColorState.g, this._blendColorState.b, this._blendColorState.a), t.bindRenderbuffer(t.RENDERBUFFER, this._activeRenderbuffer ? this._activeRenderbuffer.glName : null), !0 === this._blendEnabled ? t.enable(this.gl.BLEND) : t.disable(this.gl.BLEND), t.blendEquationSeparate(this._blendEquationState.mode, this._blendEquationState.modeAlpha), t.blendFuncSeparate(this._blendFunctionState.srcRGB, this._blendFunctionState.dstRGB, this._blendFunctionState.srcAlpha, this._blendFunctionState.dstAlpha), t.clearColor(this._clearColor.r, this._clearColor.g, this._clearColor.b, this._clearColor.a), t.clearDepth(this._clearDepth), t.clearStencil(this._clearStencil), t.colorMask(this._colorMaskState.r, this._colorMaskState.g, this._colorMaskState.b, this._colorMaskState.a), t.cullFace(this._cullFace), t.depthFunc(this._depthFunction), t.depthRange(this._depthRange.zNear, this._depthRange.zFar), !0 === this._depthTestEnabled ? t.enable(t.DEPTH_TEST) : t.disable(t.DEPTH_TEST), t.depthMask(this._depthWriteEnabled), t.frontFace(this._frontFace), t.lineWidth(1), !0 === this._polygonCullingEnabled ? t.enable(t.CULL_FACE) : t.disable(t.CULL_FACE), t.polygonOffset(this._polygonOffset[0], this._polygonOffset[1]), !0 === this._polygonOffsetFillEnabled ? t.enable(t.POLYGON_OFFSET_FILL) : t.disable(t.POLYGON_OFFSET_FILL), t.scissor(this._scissorRect.x, this._scissorRect.y, this._scissorRect.width, this._scissorRect.height), !0 === this._scissorTestEnabled ? t.enable(t.SCISSOR_TEST) : t.disable(t.SCISSOR_TEST), t.stencilFunc(this._stencilFunction.func, this._stencilFunction.ref, this._stencilFunction.mask), t.stencilOpSeparate(this._stencilOperation.face, this._stencilOperation.fail, this._stencilOperation.zFail, this._stencilOperation.zPass), !0 === this._stencilTestEnabled ? t.enable(t.STENCIL_TEST) : t.disable(t.STENCIL_TEST), t.stencilMask(this._stencilWriteMask);\n\n    for (let a = 0; a < this.parameters.maxTextureImageUnits; a++) {\n      t.activeTexture(s + a), t.bindTexture(3553, null), r(t) && t.bindTexture(32879, null);\n      const e = this._textureUnitMap[a];\n      i(e) && t.bindTexture(e.descriptor.target, e.glName);\n    }\n\n    t.activeTexture(s + this._activeTextureUnit), t.viewport(this._viewport.x, this._viewport.y, this._viewport.width, this._viewport.height), d() && (this._numOfDrawCalls = 0, this._numOfTriangles = 0);\n  }\n\n  _loadParameters(t) {\n    var e;\n    const i = this.capabilities.textureFilterAnisotropic,\n          s = null != (e = t.maxAnisotropy) ? e : 1 / 0,\n          a = {\n      versionString: this.gl.getParameter(this.gl.VERSION),\n      maxVertexTextureImageUnits: this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),\n      maxVertexAttributes: this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),\n      maxMaxAnisotropy: i ? Math.min(this.gl.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY), s) : 1,\n      maxTextureImageUnits: this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),\n      maxTextureSize: this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)\n    };\n    return l.TEXTURE_UNIT_FOR_UPDATES = a.maxTextureImageUnits - 1, a;\n  }\n\n}\n\nfunction o(t, e, i, s) {\n  return e ? s !== e && t.bindBuffer(i, e.glName) : t.bindBuffer(i, null), e;\n}\n\nfunction _(t, e) {\n  switch (t) {\n    case 0:\n      return 2 * e;\n\n    case 4:\n      return e / 3;\n\n    case 5:\n    case 6:\n      return e - 2;\n\n    default:\n      return 0;\n  }\n}\n\nconst u = !!t(\"enable-feature:webgl-debug\");\n\nfunction d() {\n  return u;\n}\n\nfunction b() {\n  return u;\n}\n\nexport default c;\nexport { d as webglDebugEnabled, b as webglValidateShadersEnabled };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/webgl/RenderingContext.js"],"names":["t","isNone","e","isSome","i","BASE_TEXTURE_UNIT","s","InstanceCounter","a","StateTracker","n","l","r","loadCapabilities","h","c","constructor","gl","instanceCounter","_blendEnabled","_blendColorState","g","b","_blendFunctionState","srcRGB","dstRGB","srcAlpha","dstAlpha","_blendEquationState","mode","modeAlpha","_colorMaskState","_polygonCullingEnabled","_cullFace","_frontFace","_scissorTestEnabled","_scissorRect","x","y","width","height","_depthTestEnabled","_depthFunction","_clearDepth","_depthWriteEnabled","_depthRange","zNear","zFar","_viewport","_stencilTestEnabled","_polygonOffsetFillEnabled","_polygonOffset","_stencilFunction","face","func","ref","mask","_clearStencil","_stencilWriteMask","_stencilOperation","fail","zFail","zPass","_clearColor","_activeShaderProgram","_activeVertexBuffer","_activeIndexBuffer","_activeFramebuffer","_activeRenderbuffer","_activeTextureUnit","_textureUnitMap","Array","_numOfDrawCalls","_numOfTriangles","webglVersion","WebGLRenderingContext","getExtension","_capabilities","_parameters","_loadParameters","getParameter","VIEWPORT","_stateTracker","setBlending","setBlendingEnabled","setBlendEquationSeparate","opRgb","opAlpha","setBlendFunctionSeparate","srcRgb","dstRgb","color","setBlendColor","setCulling","setFaceCullingEnabled","setCullFace","setFrontFace","setPolygonOffset","setPolygonOffsetFillEnabled","factor","units","setDepthTest","setDepthTestEnabled","setDepthFunction","setStencilTest","setStencilTestEnabled","function","setStencilFunction","operation","setStencilOp","setDepthWrite","setDepthWriteEnabled","setDepthRange","setColorWrite","setColorMask","setStencilWrite","setStencilWriteMask","enforceState","contextAttributes","getContextAttributes","parameters","dispose","bindVAO","unbindBuffer","length","d","printResourceCount","setPipelineState","setPipeline","enable","BLEND","disable","invalidateBlending","externalTextureUnitUpdate","externalVertexArrayObjectUpdate","capabilities","vao","bindVertexArray","_activeVertexArrayObject","externalVertexBufferUpdate","externalIndexBufferUpdate","blendColor","setBlendFunction","blendFunc","blendFuncSeparate","setBlendEquation","blendEquation","blendEquationSeparate","colorMask","invalidateColorWrite","setClearColor","clearColor","CULL_FACE","invalidateCulling","POLYGON_OFFSET_FILL","invalidatePolygonOffset","polygonOffset","cullFace","frontFace","setScissorTestEnabled","SCISSOR_TEST","setScissorRect","scissor","DEPTH_TEST","invalidateDepthTest","setClearDepth","clearDepth","depthFunc","depthMask","invalidateDepthWrite","depthRange","STENCIL_TEST","invalidateStencilTest","setClearStencil","clearStencil","stencilFunc","setStencilFunctionSeparate","stencilFuncSeparate","stencilMask","invalidateStencilWrite","stencilOp","setStencilOpSeparate","stencilOpSeparate","setActiveTexture","activeTexture","clear","clearSafe","drawArrays","_","drawElements","logIno","console","log","setViewport","Math","max","round","viewport","getViewport","useProgram","stop","glName","bindTexture","maxTextureImageUnits","error","descriptor","target","applyChanges","unbindTextureAllUnits","bindFramebuffer","FRAMEBUFFER","initializeAndBind","bindBuffer","bufferType","o","bindRenderbuffer","RENDERBUFFER","unbind","bind","getBoundFramebufferObject","getBoundVAO","resetState","canvas","maxVertexAttributes","disableVertexAttribArray","lineWidth","textureFilterAnisotropic","maxAnisotropy","versionString","VERSION","maxVertexTextureImageUnits","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_VERTEX_ATTRIBS","maxMaxAnisotropy","min","MAX_TEXTURE_MAX_ANISOTROPY","MAX_TEXTURE_IMAGE_UNITS","maxTextureSize","MAX_TEXTURE_SIZE","TEXTURE_UNIT_FOR_UPDATES","u","webglDebugEnabled","webglValidateShadersEnabled"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from\"../../core/has.js\";import{isNone as e,isSome as i}from\"../../core/maybe.js\";import{BASE_TEXTURE_UNIT as s}from\"./enums.js\";import{InstanceCounter as a}from\"./InstanceCounter.js\";import{StateTracker as n}from\"./renderState.js\";import l from\"./Texture.js\";import r from\"./capabilities/isWebGL2Context.js\";import{loadCapabilities as h}from\"./capabilities/load.js\";class c{constructor(t,e={}){this.gl=t,this.instanceCounter=new a,this._blendEnabled=!1,this._blendColorState={r:0,g:0,b:0,a:0},this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0},this._blendEquationState={mode:32774,modeAlpha:32774},this._colorMaskState={r:!0,g:!0,b:!0,a:!0},this._polygonCullingEnabled=!1,this._cullFace=1029,this._frontFace=2305,this._scissorTestEnabled=!1,this._scissorRect={x:0,y:0,width:0,height:0},this._depthTestEnabled=!1,this._depthFunction=513,this._clearDepth=1,this._depthWriteEnabled=!0,this._depthRange={zNear:0,zFar:1},this._viewport=null,this._stencilTestEnabled=!1,this._polygonOffsetFillEnabled=!1,this._polygonOffset=[0,0],this._stencilFunction={face:1032,func:519,ref:0,mask:1},this._clearStencil=0,this._stencilWriteMask=1,this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680},this._clearColor={r:0,g:0,b:0,a:0},this._activeShaderProgram=null,this._activeVertexBuffer=null,this._activeIndexBuffer=null,this._activeFramebuffer=null,this._activeRenderbuffer=null,this._activeTextureUnit=0,this._textureUnitMap=new Array,this._numOfDrawCalls=0,this._numOfTriangles=0,this.webglVersion=r(t)?\"webgl2\":\"webgl\",t instanceof WebGLRenderingContext&&this.gl.getExtension(\"OES_element_index_uint\"),this._capabilities=h(t,e),this._parameters=this._loadParameters(e);const i=this.gl.getParameter(this.gl.VIEWPORT);this._viewport={x:i[0],y:i[1],width:i[2],height:i[3]},this._stateTracker=new n({setBlending:t=>{if(t){this.setBlendingEnabled(!0),this.setBlendEquationSeparate(t.opRgb,t.opAlpha),this.setBlendFunctionSeparate(t.srcRgb,t.dstRgb,t.srcAlpha,t.dstAlpha);const e=t.color;this.setBlendColor(e.r,e.g,e.b,e.a)}else this.setBlendingEnabled(!1)},setCulling:t=>{t?(this.setFaceCullingEnabled(!0),this.setCullFace(t.face),this.setFrontFace(t.mode)):this.setFaceCullingEnabled(!1)},setPolygonOffset:t=>{t?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(t.factor,t.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:t=>{t?(this.setDepthTestEnabled(!0),this.setDepthFunction(t.func)):this.setDepthTestEnabled(!1)},setStencilTest:t=>{if(t){this.setStencilTestEnabled(!0);const e=t.function;this.setStencilFunction(e.func,e.ref,e.mask);const i=t.operation;this.setStencilOp(i.fail,i.zFail,i.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:t=>{t?(this.setDepthWriteEnabled(!0),this.setDepthRange(t.zNear,t.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:t=>{t?this.setColorMask(t.r,t.g,t.b,t.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:t=>{t?this.setStencilWriteMask(t.mask):this.setStencilWriteMask(0)}}),this.enforceState()}get contextAttributes(){return this.gl.getContextAttributes()}get parameters(){return this._parameters}dispose(){this.bindVAO(null),this.unbindBuffer(34962),this.unbindBuffer(34963),this._textureUnitMap.length=0,d()&&this.instanceCounter.printResourceCount()}setPipelineState(t){this._stateTracker.setPipeline(t)}setBlendingEnabled(t){this._blendEnabled!==t&&(!0===t?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=t,this._stateTracker.invalidateBlending())}externalTextureUnitUpdate(t,e){for(let i=0;i<t.length;++i)this._textureUnitMap[t[i]]=null;e>=0&&(this._activeTextureUnit=e)}externalVertexArrayObjectUpdate(){const t=this.capabilities.vao;t&&(t.bindVertexArray(null),this._activeVertexArrayObject=null),this._activeVertexBuffer=null,this._activeIndexBuffer=null}externalVertexBufferUpdate(){this._activeVertexBuffer=null}externalIndexBufferUpdate(){this._activeIndexBuffer=null}setBlendColor(t,e,i,s){t===this._blendColorState.r&&e===this._blendColorState.g&&i===this._blendColorState.b&&s===this._blendColorState.a||(this.gl.blendColor(t,e,i,s),this._blendColorState.r=t,this._blendColorState.g=e,this._blendColorState.b=i,this._blendColorState.a=s,this._stateTracker.invalidateBlending())}setBlendFunction(t,e){t===this._blendFunctionState.srcRGB&&e===this._blendFunctionState.dstRGB||(this.gl.blendFunc(t,e),this._blendFunctionState.srcRGB=t,this._blendFunctionState.srcAlpha=t,this._blendFunctionState.dstRGB=e,this._blendFunctionState.dstAlpha=e,this._stateTracker.invalidateBlending())}setBlendFunctionSeparate(t,e,i,s){this._blendFunctionState.srcRGB===t&&this._blendFunctionState.srcAlpha===i&&this._blendFunctionState.dstRGB===e&&this._blendFunctionState.dstAlpha===s||(this.gl.blendFuncSeparate(t,e,i,s),this._blendFunctionState.srcRGB=t,this._blendFunctionState.srcAlpha=i,this._blendFunctionState.dstRGB=e,this._blendFunctionState.dstAlpha=s,this._stateTracker.invalidateBlending())}setBlendEquation(t){this._blendEquationState.mode!==t&&(this.gl.blendEquation(t),this._blendEquationState.mode=t,this._blendEquationState.modeAlpha=t,this._stateTracker.invalidateBlending())}setBlendEquationSeparate(t,e){this._blendEquationState.mode===t&&this._blendEquationState.modeAlpha===e||(this.gl.blendEquationSeparate(t,e),this._blendEquationState.mode=t,this._blendEquationState.modeAlpha=e,this._stateTracker.invalidateBlending())}setColorMask(t,e,i,s){this._colorMaskState.r===t&&this._colorMaskState.g===e&&this._colorMaskState.b===i&&this._colorMaskState.a===s||(this.gl.colorMask(t,e,i,s),this._colorMaskState.r=t,this._colorMaskState.g=e,this._colorMaskState.b=i,this._colorMaskState.a=s,this._stateTracker.invalidateColorWrite())}setClearColor(t,e,i,s){this._clearColor.r===t&&this._clearColor.g===e&&this._clearColor.b===i&&this._clearColor.a===s||(this.gl.clearColor(t,e,i,s),this._clearColor.r=t,this._clearColor.g=e,this._clearColor.b=i,this._clearColor.a=s)}setFaceCullingEnabled(t){this._polygonCullingEnabled!==t&&(!0===t?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=t,this._stateTracker.invalidateCulling())}setPolygonOffsetFillEnabled(t){this._polygonOffsetFillEnabled!==t&&(!0===t?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=t,this._stateTracker.invalidatePolygonOffset())}setPolygonOffset(t,e){this._polygonOffset[0]===t&&this._polygonOffset[1]===e||(this._polygonOffset[0]=t,this._polygonOffset[1]=e,this.gl.polygonOffset(t,e),this._stateTracker.invalidatePolygonOffset())}setCullFace(t){this._cullFace!==t&&(this.gl.cullFace(t),this._cullFace=t,this._stateTracker.invalidateCulling())}setFrontFace(t){this._frontFace!==t&&(this.gl.frontFace(t),this._frontFace=t,this._stateTracker.invalidateCulling())}setScissorTestEnabled(t){this._scissorTestEnabled!==t&&(!0===t?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=t)}setScissorRect(t,e,i,s){this._scissorRect.x===t&&this._scissorRect.y===e&&this._scissorRect.width===i&&this._scissorRect.height===s||(this.gl.scissor(t,e,i,s),this._scissorRect.x=t,this._scissorRect.y=e,this._scissorRect.width=i,this._scissorRect.height=s)}setDepthTestEnabled(t){this._depthTestEnabled!==t&&(!0===t?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=t,this._stateTracker.invalidateDepthTest())}setClearDepth(t){this._clearDepth!==t&&(this.gl.clearDepth(t),this._clearDepth=t)}setDepthFunction(t){this._depthFunction!==t&&(this.gl.depthFunc(t),this._depthFunction=t,this._stateTracker.invalidateDepthTest())}setDepthWriteEnabled(t){this._depthWriteEnabled!==t&&(this.gl.depthMask(t),this._depthWriteEnabled=t,this._stateTracker.invalidateDepthWrite())}setDepthRange(t,e){this._depthRange.zNear===t&&this._depthRange.zFar===e||(this.gl.depthRange(t,e),this._depthRange.zNear=t,this._depthRange.zFar=e,this._stateTracker.invalidateDepthWrite())}setStencilTestEnabled(t){this._stencilTestEnabled!==t&&(!0===t?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=t,this._stateTracker.invalidateStencilTest())}setClearStencil(t){t!==this._clearStencil&&(this.gl.clearStencil(t),this._clearStencil=t)}setStencilFunction(t,e,i){this._stencilFunction.func===t&&this._stencilFunction.ref===e&&this._stencilFunction.mask===i||(this.gl.stencilFunc(t,e,i),this._stencilFunction.face=1032,this._stencilFunction.func=t,this._stencilFunction.ref=e,this._stencilFunction.mask=i,this._stateTracker.invalidateStencilTest())}setStencilFunctionSeparate(t,e,i,s){this._stencilFunction.face===t&&this._stencilFunction.func===e&&this._stencilFunction.ref===i&&this._stencilFunction.mask===s||(this.gl.stencilFuncSeparate(t,e,i,s),this._stencilFunction.face=t,this._stencilFunction.func=e,this._stencilFunction.ref=i,this._stencilFunction.mask=s,this._stateTracker.invalidateStencilTest())}setStencilWriteMask(t){this._stencilWriteMask!==t&&(this.gl.stencilMask(t),this._stencilWriteMask=t,this._stateTracker.invalidateStencilWrite())}setStencilOp(t,e,i){this._stencilOperation.fail===t&&this._stencilOperation.zFail===e&&this._stencilOperation.zPass===i||(this.gl.stencilOp(t,e,i),this._stencilOperation.face=1032,this._stencilOperation.fail=t,this._stencilOperation.zFail=e,this._stencilOperation.zPass=i,this._stateTracker.invalidateStencilTest())}setStencilOpSeparate(t,e,i,s){this._stencilOperation.face===t&&this._stencilOperation.fail===e&&this._stencilOperation.zFail===i&&this._stencilOperation.zPass===s||(this.gl.stencilOpSeparate(t,e,i,s),this._stencilOperation.face=t,this._stencilOperation.face=t,this._stencilOperation.fail=e,this._stencilOperation.zFail=i,this._stencilOperation.zPass=s,this._stateTracker.invalidateStencilTest())}setActiveTexture(t,e=!1){const i=this._activeTextureUnit;return t>=0&&(e||t!==this._activeTextureUnit)&&(this.gl.activeTexture(s+t),this._activeTextureUnit=t),i}clear(t){t&&this.gl.clear(t)}clearSafe(t,e=255){t&&(16384&t&&this.setColorMask(!0,!0,!0,!0),256&t&&this.setDepthWriteEnabled(!0),1024&t&&this.setStencilWriteMask(e),this.gl.clear(t))}drawArrays(t,e,i){d()&&(this._numOfDrawCalls++,this._numOfTriangles+=_(t,i)),this.gl.drawArrays(t,e,i)}drawElements(t,e,i,s){d()&&(this._numOfDrawCalls++,this._numOfTriangles+=_(t,e)),this.gl.drawElements(t,e,i,s)}logIno(){d()&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)}get capabilities(){return this._capabilities}setViewport(t,e,i,s){i=Math.max(Math.round(i),1),s=Math.max(Math.round(s),1);const a=this._viewport;a.x===t&&a.y===e&&a.width===i&&a.height===s||(a.x=t,a.y=e,a.width=i,a.height=s,this.gl.viewport(t,e,i,s))}getViewport(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}}useProgram(t){var e,i;if(!t)return null==(i=this._activeShaderProgram)||i.stop(),this._activeShaderProgram=null,void this.gl.useProgram(null);this._activeShaderProgram!==t&&(null==(e=this._activeShaderProgram)||e.stop(),this._activeShaderProgram=t,this.gl.useProgram(t.glName))}bindTexture(t,s,a=!1){(s>=this.parameters.maxTextureImageUnits||s<0)&&console.error(\"Input texture unit is out of range of available units!\");const n=this._textureUnitMap[s];return this.setActiveTexture(s,a),e(t)||null==t.glName?(i(n)&&this.gl.bindTexture(n.descriptor.target,null),this._textureUnitMap[s]=null,n):a||n!==t?(this.gl.bindTexture(t.descriptor.target,t.glName),t.applyChanges(),this._textureUnitMap[s]=t,n):(t.applyChanges(),n)}unbindTextureAllUnits(t){for(let e=0;e<this.parameters.maxTextureImageUnits;e++)this._textureUnitMap[e]===t&&(this.bindTexture(null,e),this._textureUnitMap[e]=null)}bindFramebuffer(t,i=!1){if(e(t))return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),void(this._activeFramebuffer=null);(i||this._activeFramebuffer!==t)&&(t.initializeAndBind(),this._activeFramebuffer=t)}bindBuffer(t){t&&(34962===t.bufferType?this._activeVertexBuffer=o(this.gl,t,t.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=o(this.gl,t,t.bufferType,this._activeIndexBuffer))}bindRenderbuffer(t){const e=this.gl;t||(e.bindRenderbuffer(e.RENDERBUFFER,null),this._activeRenderbuffer=null),this._activeRenderbuffer!==t&&(e.bindRenderbuffer(e.RENDERBUFFER,t.glName),this._activeRenderbuffer=t)}unbindBuffer(t){34962===t?this._activeVertexBuffer=o(this.gl,null,t,this._activeVertexBuffer):this._activeIndexBuffer=o(this.gl,null,t,this._activeIndexBuffer)}bindVAO(t=null){e(t)?this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null):this._activeVertexArrayObject!==t&&(t.bind(),this._activeVertexArrayObject=t)}getBoundFramebufferObject(){return this._activeFramebuffer}getBoundVAO(){return this._activeVertexArrayObject}resetState(){this.useProgram(null),this.bindVAO(null),this.bindFramebuffer(null),this.unbindBuffer(34962),this.unbindBuffer(34963);for(let t=0;t<this.parameters.maxTextureImageUnits;++t)this.bindTexture(null,t);this.setBlendingEnabled(!1),this.setBlendFunction(1,0),this.setBlendEquation(32774),this.setBlendColor(0,0,0,0),this.setFaceCullingEnabled(!1),this.setCullFace(1029),this.setFrontFace(2305),this.setPolygonOffsetFillEnabled(!1),this.setPolygonOffset(0,0),this.setScissorTestEnabled(!1),this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height),this.setDepthTestEnabled(!1),this.setDepthFunction(513),this.setDepthRange(0,1),this.setStencilTestEnabled(!1),this.setStencilFunction(519,0,0),this.setStencilOp(7680,7680,7680),this.setClearColor(0,0,0,0),this.setClearDepth(1),this.setClearStencil(0),this.setColorMask(!0,!0,!0,!0),this.setStencilWriteMask(4294967295),this.setDepthWriteEnabled(!0),this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}enforceState(){const t=this.gl,e=this.capabilities.vao;e&&e.bindVertexArray(null);for(let i=0;i<this.parameters.maxVertexAttributes;i++)t.disableVertexAttribArray(i);if(this._activeVertexBuffer?t.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):t.bindBuffer(34962,null),this._activeIndexBuffer?t.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):t.bindBuffer(34963,null),e&&this._activeVertexArrayObject){const t=this._activeVertexArrayObject;this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null),this.bindVAO(t)}t.bindFramebuffer(t.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null),t.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null),t.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a),t.bindRenderbuffer(t.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null),!0===this._blendEnabled?t.enable(this.gl.BLEND):t.disable(this.gl.BLEND),t.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha),t.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha),t.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),t.clearDepth(this._clearDepth),t.clearStencil(this._clearStencil),t.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a),t.cullFace(this._cullFace),t.depthFunc(this._depthFunction),t.depthRange(this._depthRange.zNear,this._depthRange.zFar),!0===this._depthTestEnabled?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),t.depthMask(this._depthWriteEnabled),t.frontFace(this._frontFace),t.lineWidth(1),!0===this._polygonCullingEnabled?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),t.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]),!0===this._polygonOffsetFillEnabled?t.enable(t.POLYGON_OFFSET_FILL):t.disable(t.POLYGON_OFFSET_FILL),t.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height),!0===this._scissorTestEnabled?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST),t.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask),t.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass),!0===this._stencilTestEnabled?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),t.stencilMask(this._stencilWriteMask);for(let a=0;a<this.parameters.maxTextureImageUnits;a++){t.activeTexture(s+a),t.bindTexture(3553,null),r(t)&&t.bindTexture(32879,null);const e=this._textureUnitMap[a];i(e)&&t.bindTexture(e.descriptor.target,e.glName)}t.activeTexture(s+this._activeTextureUnit),t.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height),d()&&(this._numOfDrawCalls=0,this._numOfTriangles=0)}_loadParameters(t){var e;const i=this.capabilities.textureFilterAnisotropic,s=null!=(e=t.maxAnisotropy)?e:1/0,a={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:i?Math.min(this.gl.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY),s):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)};return l.TEXTURE_UNIT_FOR_UPDATES=a.maxTextureImageUnits-1,a}}function o(t,e,i,s){return e?s!==e&&t.bindBuffer(i,e.glName):t.bindBuffer(i,null),e}function _(t,e){switch(t){case 0:return 2*e;case 4:return e/3;case 5:case 6:return e-2;default:return 0}}const u=!!t(\"enable-feature:webgl-debug\");function d(){return u}function b(){return u}export default c;export{d as webglDebugEnabled,b as webglValidateShadersEnabled};\n"]},"metadata":{},"sourceType":"module"}