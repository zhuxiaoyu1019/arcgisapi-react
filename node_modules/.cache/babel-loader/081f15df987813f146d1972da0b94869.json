{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { destroyMaybe as e, isSome as r } from \"../../../../core/maybe.js\";\nimport { contextCapabilitiesFromLayer as t } from \"./FeatureTileFetcher3D.js\";\nimport { createFeatureTileQuery3D as i } from \"./featureTileQuery3D.js\";\n\nclass l {\n  constructor(e) {\n    this._memoryCache = null, this._capabilities = null;\n    const r = e.layerView.layer;\n    this.layerView = e.layerView, this.objectIdField = r.objectIdField, this.globalIdField = \"globalIdField\" in r ? r.globalIdField : null, this.returnZ = e.returnZ, this.returnM = e.returnM;\n    const t = this.layerView.view.resourceController;\n    this.query = i(r, e => t.schedule(e)), t && this.memoryCacheEnabled && (this._memoryCache = t.memoryController.getMemCache(r.uid));\n  }\n\n  get memoryCacheEnabled() {\n    switch (this.layerView.layer.source.type) {\n      case \"feature-layer\":\n      case \"ogc-feature\":\n        return !0;\n\n      case \"csv\":\n      case \"geojson\":\n      case \"memory\":\n      case \"wfs\":\n        return !1;\n    }\n  }\n\n  destroy() {\n    this._memoryCache = e(this._memoryCache), this.query.destroy();\n  }\n\n  createQuery() {\n    const e = this.layerView.layer.createQuery();\n    return e.outFields = this.layerView.availableFields, e.returnZ = this.returnZ, e.returnM = this.returnM, e.outSpatialReference = this.tilingScheme.spatialReference, e;\n  }\n\n  get memoryCache() {\n    return this._memoryCache;\n  }\n\n  get viewingMode() {\n    return this.layerView.view.state.viewingMode;\n  }\n\n  get tilingScheme() {\n    return this.layerView.view.featureTiles.tilingScheme;\n  }\n\n  get scheduler() {\n    const e = this.layerView.view.resourceController;\n    return e ? e.scheduler : null;\n  }\n\n  get geometryType() {\n    return this.layerView.layer.geometryType;\n  }\n\n  get fullExtent() {\n    return this.layerView.layer.fullExtent;\n  }\n\n  get tileMaxRecordCount() {\n    return this.layerView.layer.capabilities.query.tileMaxRecordCount;\n  }\n\n  get maxRecordCount() {\n    return this.layerView.layer.capabilities.query.maxRecordCount;\n  }\n\n  get capabilities() {\n    return r(this._capabilities) || (this._capabilities = t(this.layerView.layer)), this._capabilities;\n  }\n\n  logFetchError(e, r) {\n    e.error(\"#fetchTile()\", this.layerView.layer, r && r.message ? r.message : r);\n  }\n\n}\n\nexport { l as FeatureTileFetcher3DLayerViewContext };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/layers/support/FeatureTileFetcher3DLayerViewContext.js"],"names":["destroyMaybe","e","isSome","r","contextCapabilitiesFromLayer","t","createFeatureTileQuery3D","i","l","constructor","_memoryCache","_capabilities","layerView","layer","objectIdField","globalIdField","returnZ","returnM","view","resourceController","query","schedule","memoryCacheEnabled","memoryController","getMemCache","uid","source","type","destroy","createQuery","outFields","availableFields","outSpatialReference","tilingScheme","spatialReference","memoryCache","viewingMode","state","featureTiles","scheduler","geometryType","fullExtent","tileMaxRecordCount","capabilities","maxRecordCount","logFetchError","error","message","FeatureTileFetcher3DLayerViewContext"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{destroyMaybe as e,isSome as r}from\"../../../../core/maybe.js\";import{contextCapabilitiesFromLayer as t}from\"./FeatureTileFetcher3D.js\";import{createFeatureTileQuery3D as i}from\"./featureTileQuery3D.js\";class l{constructor(e){this._memoryCache=null,this._capabilities=null;const r=e.layerView.layer;this.layerView=e.layerView,this.objectIdField=r.objectIdField,this.globalIdField=\"globalIdField\"in r?r.globalIdField:null,this.returnZ=e.returnZ,this.returnM=e.returnM;const t=this.layerView.view.resourceController;this.query=i(r,(e=>t.schedule(e))),t&&this.memoryCacheEnabled&&(this._memoryCache=t.memoryController.getMemCache(r.uid))}get memoryCacheEnabled(){switch(this.layerView.layer.source.type){case\"feature-layer\":case\"ogc-feature\":return!0;case\"csv\":case\"geojson\":case\"memory\":case\"wfs\":return!1}}destroy(){this._memoryCache=e(this._memoryCache),this.query.destroy()}createQuery(){const e=this.layerView.layer.createQuery();return e.outFields=this.layerView.availableFields,e.returnZ=this.returnZ,e.returnM=this.returnM,e.outSpatialReference=this.tilingScheme.spatialReference,e}get memoryCache(){return this._memoryCache}get viewingMode(){return this.layerView.view.state.viewingMode}get tilingScheme(){return this.layerView.view.featureTiles.tilingScheme}get scheduler(){const e=this.layerView.view.resourceController;return e?e.scheduler:null}get geometryType(){return this.layerView.layer.geometryType}get fullExtent(){return this.layerView.layer.fullExtent}get tileMaxRecordCount(){return this.layerView.layer.capabilities.query.tileMaxRecordCount}get maxRecordCount(){return this.layerView.layer.capabilities.query.maxRecordCount}get capabilities(){return r(this._capabilities)||(this._capabilities=t(this.layerView.layer)),this._capabilities}logFetchError(e,r){e.error(\"#fetchTile()\",this.layerView.layer,r&&r.message?r.message:r)}}export{l as FeatureTileFetcher3DLayerViewContext};\n"]},"metadata":{},"sourceType":"module"}