{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isFinite as e } from \"../../../core/mathUtils.js\";\nimport a from \"../../../geometry/SpatialReference.js\";\nimport { isNullCountSupported as i, calculateStringStatistics as t, calculateStatistics as n, processStatsResult as o, getNormalizedValue as l } from \"./utils.js\";\nimport { loadArcade as r } from \"../../../support/arcadeOnDemand.js\";\nlet s = null;\n\nasync function u(e) {\n  const {\n    attribute: a,\n    featuresJSON: l\n  } = e,\n        {\n    normalizationType: r,\n    normalizationField: s,\n    minValue: u,\n    maxValue: c,\n    fieldType: p\n  } = a,\n        f = await m({\n    field: a.field,\n    valueExpression: a.valueExpression,\n    normalizationType: r,\n    normalizationField: s,\n    normalizationTotal: a.normalizationTotal,\n    viewInfoParams: a.viewInfoParams\n  }, l),\n        d = i({\n    normalizationType: r,\n    normalizationField: s,\n    minValue: u,\n    maxValue: c\n  }),\n        v = \"string\" === p ? t({\n    values: f,\n    supportsNullCount: d\n  }) : n({\n    values: f,\n    minValue: u,\n    maxValue: c,\n    useSampleStdDev: !r,\n    supportsNullCount: d\n  });\n  return o(v, \"date\" === p);\n}\n\nasync function m(i, t) {\n  if (!t) return [];\n  const n = i.field,\n        o = i.valueExpression,\n        u = i.normalizationType,\n        m = i.normalizationField,\n        c = i.normalizationTotal,\n        p = [],\n        f = i.viewInfoParams;\n  let d = null,\n      v = null;\n\n  if (o) {\n    if (!s) {\n      const {\n        arcadeUtils: e\n      } = await r();\n      s = e;\n    }\n\n    d = s.createFunction(o), v = f && s.getViewInfo({\n      viewingMode: f.viewingMode,\n      scale: f.scale,\n      spatialReference: new a(f.spatialReference)\n    });\n  }\n\n  return t.forEach(a => {\n    const i = a.attributes;\n    let t;\n\n    if (o) {\n      const e = s.createExecContext(a, v);\n      t = s.executeFunction(d, e);\n    } else i && (t = i[n]);\n\n    if (u && e(t)) {\n      const e = i && parseFloat(i[m]);\n      t = l(t, u, e, c);\n    }\n\n    p.push(t);\n  }), p;\n}\n\nexport { m as getDataValues, u as summaryStatistics };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/smartMapping/statistics/support/statsWorker.js"],"names":["isFinite","e","a","isNullCountSupported","i","calculateStringStatistics","t","calculateStatistics","n","processStatsResult","o","getNormalizedValue","l","loadArcade","r","s","u","attribute","featuresJSON","normalizationType","normalizationField","minValue","maxValue","c","fieldType","p","f","m","field","valueExpression","normalizationTotal","viewInfoParams","d","v","values","supportsNullCount","useSampleStdDev","arcadeUtils","createFunction","getViewInfo","viewingMode","scale","spatialReference","forEach","attributes","createExecContext","executeFunction","parseFloat","push","getDataValues","summaryStatistics"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isFinite as e}from\"../../../core/mathUtils.js\";import a from\"../../../geometry/SpatialReference.js\";import{isNullCountSupported as i,calculateStringStatistics as t,calculateStatistics as n,processStatsResult as o,getNormalizedValue as l}from\"./utils.js\";import{loadArcade as r}from\"../../../support/arcadeOnDemand.js\";let s=null;async function u(e){const{attribute:a,featuresJSON:l}=e,{normalizationType:r,normalizationField:s,minValue:u,maxValue:c,fieldType:p}=a,f=await m({field:a.field,valueExpression:a.valueExpression,normalizationType:r,normalizationField:s,normalizationTotal:a.normalizationTotal,viewInfoParams:a.viewInfoParams},l),d=i({normalizationType:r,normalizationField:s,minValue:u,maxValue:c}),v=\"string\"===p?t({values:f,supportsNullCount:d}):n({values:f,minValue:u,maxValue:c,useSampleStdDev:!r,supportsNullCount:d});return o(v,\"date\"===p)}async function m(i,t){if(!t)return[];const n=i.field,o=i.valueExpression,u=i.normalizationType,m=i.normalizationField,c=i.normalizationTotal,p=[],f=i.viewInfoParams;let d=null,v=null;if(o){if(!s){const{arcadeUtils:e}=await r();s=e}d=s.createFunction(o),v=f&&s.getViewInfo({viewingMode:f.viewingMode,scale:f.scale,spatialReference:new a(f.spatialReference)})}return t.forEach((a=>{const i=a.attributes;let t;if(o){const e=s.createExecContext(a,v);t=s.executeFunction(d,e)}else i&&(t=i[n]);if(u&&e(t)){const e=i&&parseFloat(i[m]);t=l(t,u,e,c)}p.push(t)})),p}export{m as getDataValues,u as summaryStatistics};\n"]},"metadata":{},"sourceType":"module"}