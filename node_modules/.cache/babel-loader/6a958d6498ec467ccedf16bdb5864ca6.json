{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { bindSliceUniformsWithOrigin as r } from \"../core/shaderLibrary/Slice.glsl.js\";\nimport { setVVUniforms as i } from \"../core/shaderLibrary/attributes/PathVertexPosition.glsl.js\";\nimport { VertexNormal as t } from \"../core/shaderLibrary/attributes/VertexNormal.glsl.js\";\nimport { bindMultipassTerrainTexture as o } from \"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";\nimport { bindReadShadowMapView as s } from \"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";\nimport { bindProjectionMatrix as a, bindNearFar as n, bindView as p, bindCameraPosition as l } from \"../core/shaderLibrary/util/View.glsl.js\";\nimport { ReloadableShaderModule as u } from \"../core/shaderTechnique/ReloadableShaderModule.js\";\nimport { ShaderTechnique as d } from \"../core/shaderTechnique/ShaderTechnique.js\";\nimport { ShaderTechniqueConfiguration as c, parameter as h } from \"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";\nimport { blendingDefault as m, OITBlending as v, OITDepthTest as g, OITPolygonOffset as f } from \"../lib/OrderIndependentTransparency.js\";\nimport { Program as b } from \"../lib/Program.js\";\nimport { stencilWriteMaskOn as y, stencilBaseAllZerosParams as S } from \"../lib/StencilUtils.js\";\nimport { P as T } from \"../../../../chunks/Path.glsl.js\";\nimport { makePipelineState as P, frontFaceCullingParams as w, defaultDepthWriteParams as j, defaultColorWriteParams as M } from \"../../../webgl/renderState.js\";\nconst O = new Map([[\"position\", 0], [\"profileRight\", 1], [\"profileUp\", 2], [\"profileVertexAndNormal\", 3], [\"featureValue\", 4]]);\n\nclass E extends d {\n  initializeProgram(e) {\n    const r = E.shader.get(),\n          i = this.configuration,\n          t = r.build({\n      OITEnabled: 0 === i.transparencyPassType,\n      output: i.output,\n      viewingMode: e.viewingMode,\n      slicePlaneEnabled: i.slicePlaneEnabled,\n      sliceHighlightDisabled: !1,\n      sliceEnabledForVertexPrograms: !1,\n      receiveShadows: i.receiveShadows,\n      vvSize: i.vvSize,\n      vvColor: i.vvColor,\n      vvInstancingEnabled: !0,\n      vvOpacity: i.vvOpacity,\n      pbrMode: 0,\n      useCustomDTRExponentForWater: !1,\n      receiveAmbientOcclusion: i.receiveSSAO,\n      doubleSidedMode: i.doubleSidedMode,\n      multipassTerrainEnabled: i.multipassTerrainEnabled,\n      cullAboveGround: i.cullAboveGround\n    });\n    return new b(e.rctx, t, O);\n  }\n\n  bindPass(e, r) {\n    var t, s;\n    a(this.program, r.camera.projectionMatrix), this.program.setUniform3fv(\"size\", e.size), r.multipassTerrainEnabled && (this.program.setUniform2fv(\"cameraNearFar\", r.camera.nearFar), this.program.setUniform2fv(\"inverseViewport\", r.inverseViewport), o(this.program, r)), 0 !== this.configuration.output && 7 !== this.configuration.output || this.program.setUniform1f(\"opacity\", e.opacity), 0 === this.configuration.output ? (r.lighting.setUniforms(this.program, !1), this.program.setUniform3fv(\"ambient\", e.ambient), this.program.setUniform3fv(\"diffuse\", e.diffuse), this.program.setUniform3fv(\"specular\", e.specular), this.program.setUniform1f(\"opacity\", e.opacity)) : 1 !== this.configuration.output && 3 !== this.configuration.output || n(this.program, r.camera.nearFar), i(this.program, e), null == (t = r.shadowMap) || t.bind(this.program), null == (s = r.ssaoHelper) || s.bind(this.program);\n  }\n\n  bindDraw(e) {\n    p(this.program, e), r(this.program, this.configuration, e), this.program.rebindTextures(), 0 !== this.configuration.output && 7 !== this.configuration.output || l(this.program, e.origin, e.camera.viewInverseTransposeMatrix), 0 === this.configuration.output && s(this.program, e), 2 === this.configuration.output && t.bindUniforms(this.program, e.camera.viewInverseTransposeMatrix);\n  }\n\n  setPipelineState(e) {\n    const r = this.configuration,\n          i = 3 === e,\n          t = 2 === e,\n          o = e => !e.slicePlaneEnabled && !(e.transparent || 0 === e.doubleSidedMode);\n\n    return P({\n      blending: 0 !== r.output && 7 !== r.output || !r.transparent ? null : i ? m : v(e),\n      culling: o(r) && w,\n      depthTest: {\n        func: g(e)\n      },\n      depthWrite: i || t ? j : null,\n      colorWrite: M,\n      stencilWrite: r.sceneHasOcludees ? y : null,\n      stencilTest: r.sceneHasOcludees ? S : null,\n      polygonOffset: i || t ? null : f\n    });\n  }\n\n  initializePipeline() {\n    return this.setPipelineState(this.configuration.transparencyPassType);\n  }\n\n}\n\nE.shader = new u(T, () => import(\"../shaders/Path.glsl.js\"));\n\nclass x extends c {\n  constructor() {\n    super(...arguments), this.output = 0, this.doubleSidedMode = 0, this.receiveShadows = !1, this.receiveSSAO = !1, this.vvSize = !1, this.vvColor = !1, this.vvOpacity = !1, this.slicePlaneEnabled = !1, this.transparent = !1, this.sceneHasOcludees = !1, this.transparencyPassType = 3, this.multipassTerrainEnabled = !1, this.cullAboveGround = !1;\n  }\n\n}\n\ne([h({\n  count: 8\n})], x.prototype, \"output\", void 0), e([h({\n  count: 3\n})], x.prototype, \"doubleSidedMode\", void 0), e([h()], x.prototype, \"receiveShadows\", void 0), e([h()], x.prototype, \"receiveSSAO\", void 0), e([h()], x.prototype, \"vvSize\", void 0), e([h()], x.prototype, \"vvColor\", void 0), e([h()], x.prototype, \"vvOpacity\", void 0), e([h()], x.prototype, \"slicePlaneEnabled\", void 0), e([h()], x.prototype, \"transparent\", void 0), e([h()], x.prototype, \"sceneHasOcludees\", void 0), e([h({\n  count: 4\n})], x.prototype, \"transparencyPassType\", void 0), e([h()], x.prototype, \"multipassTerrainEnabled\", void 0), e([h()], x.prototype, \"cullAboveGround\", void 0);\nexport { E as PathTechnique, x as PathTechniqueConfiguration, O as pathVertexAttributeLocations };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/webgl-engine/materials/PathTechnique.js"],"names":["_","e","bindSliceUniformsWithOrigin","r","setVVUniforms","i","VertexNormal","t","bindMultipassTerrainTexture","o","bindReadShadowMapView","s","bindProjectionMatrix","a","bindNearFar","n","bindView","p","bindCameraPosition","l","ReloadableShaderModule","u","ShaderTechnique","d","ShaderTechniqueConfiguration","c","parameter","h","blendingDefault","m","OITBlending","v","OITDepthTest","g","OITPolygonOffset","f","Program","b","stencilWriteMaskOn","y","stencilBaseAllZerosParams","S","P","T","makePipelineState","frontFaceCullingParams","w","defaultDepthWriteParams","j","defaultColorWriteParams","M","O","Map","E","initializeProgram","shader","get","configuration","build","OITEnabled","transparencyPassType","output","viewingMode","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","receiveShadows","vvSize","vvColor","vvInstancingEnabled","vvOpacity","pbrMode","useCustomDTRExponentForWater","receiveAmbientOcclusion","receiveSSAO","doubleSidedMode","multipassTerrainEnabled","cullAboveGround","rctx","bindPass","program","camera","projectionMatrix","setUniform3fv","size","setUniform2fv","nearFar","inverseViewport","setUniform1f","opacity","lighting","setUniforms","ambient","diffuse","specular","shadowMap","bind","ssaoHelper","bindDraw","rebindTextures","origin","viewInverseTransposeMatrix","bindUniforms","setPipelineState","transparent","blending","culling","depthTest","func","depthWrite","colorWrite","stencilWrite","sceneHasOcludees","stencilTest","polygonOffset","initializePipeline","x","constructor","arguments","count","prototype","PathTechnique","PathTechniqueConfiguration","pathVertexAttributeLocations"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{bindSliceUniformsWithOrigin as r}from\"../core/shaderLibrary/Slice.glsl.js\";import{setVVUniforms as i}from\"../core/shaderLibrary/attributes/PathVertexPosition.glsl.js\";import{VertexNormal as t}from\"../core/shaderLibrary/attributes/VertexNormal.glsl.js\";import{bindMultipassTerrainTexture as o}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindReadShadowMapView as s}from\"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{bindProjectionMatrix as a,bindNearFar as n,bindView as p,bindCameraPosition as l}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as u}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as d}from\"../core/shaderTechnique/ShaderTechnique.js\";import{ShaderTechniqueConfiguration as c,parameter as h}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{blendingDefault as m,OITBlending as v,OITDepthTest as g,OITPolygonOffset as f}from\"../lib/OrderIndependentTransparency.js\";import{Program as b}from\"../lib/Program.js\";import{stencilWriteMaskOn as y,stencilBaseAllZerosParams as S}from\"../lib/StencilUtils.js\";import{P as T}from\"../../../../chunks/Path.glsl.js\";import{makePipelineState as P,frontFaceCullingParams as w,defaultDepthWriteParams as j,defaultColorWriteParams as M}from\"../../../webgl/renderState.js\";const O=new Map([[\"position\",0],[\"profileRight\",1],[\"profileUp\",2],[\"profileVertexAndNormal\",3],[\"featureValue\",4]]);class E extends d{initializeProgram(e){const r=E.shader.get(),i=this.configuration,t=r.build({OITEnabled:0===i.transparencyPassType,output:i.output,viewingMode:e.viewingMode,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,receiveShadows:i.receiveShadows,vvSize:i.vvSize,vvColor:i.vvColor,vvInstancingEnabled:!0,vvOpacity:i.vvOpacity,pbrMode:0,useCustomDTRExponentForWater:!1,receiveAmbientOcclusion:i.receiveSSAO,doubleSidedMode:i.doubleSidedMode,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new b(e.rctx,t,O)}bindPass(e,r){var t,s;a(this.program,r.camera.projectionMatrix),this.program.setUniform3fv(\"size\",e.size),r.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",r.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",r.inverseViewport),o(this.program,r)),0!==this.configuration.output&&7!==this.configuration.output||this.program.setUniform1f(\"opacity\",e.opacity),0===this.configuration.output?(r.lighting.setUniforms(this.program,!1),this.program.setUniform3fv(\"ambient\",e.ambient),this.program.setUniform3fv(\"diffuse\",e.diffuse),this.program.setUniform3fv(\"specular\",e.specular),this.program.setUniform1f(\"opacity\",e.opacity)):1!==this.configuration.output&&3!==this.configuration.output||n(this.program,r.camera.nearFar),i(this.program,e),null==(t=r.shadowMap)||t.bind(this.program),null==(s=r.ssaoHelper)||s.bind(this.program)}bindDraw(e){p(this.program,e),r(this.program,this.configuration,e),this.program.rebindTextures(),0!==this.configuration.output&&7!==this.configuration.output||l(this.program,e.origin,e.camera.viewInverseTransposeMatrix),0===this.configuration.output&&s(this.program,e),2===this.configuration.output&&t.bindUniforms(this.program,e.camera.viewInverseTransposeMatrix)}setPipelineState(e){const r=this.configuration,i=3===e,t=2===e,o=e=>!e.slicePlaneEnabled&&!(e.transparent||0===e.doubleSidedMode);return P({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?m:v(e),culling:o(r)&&w,depthTest:{func:g(e)},depthWrite:i||t?j:null,colorWrite:M,stencilWrite:r.sceneHasOcludees?y:null,stencilTest:r.sceneHasOcludees?S:null,polygonOffset:i||t?null:f})}initializePipeline(){return this.setPipelineState(this.configuration.transparencyPassType)}}E.shader=new u(T,(()=>import(\"../shaders/Path.glsl.js\")));class x extends c{constructor(){super(...arguments),this.output=0,this.doubleSidedMode=0,this.receiveShadows=!1,this.receiveSSAO=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.slicePlaneEnabled=!1,this.transparent=!1,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([h({count:8})],x.prototype,\"output\",void 0),e([h({count:3})],x.prototype,\"doubleSidedMode\",void 0),e([h()],x.prototype,\"receiveShadows\",void 0),e([h()],x.prototype,\"receiveSSAO\",void 0),e([h()],x.prototype,\"vvSize\",void 0),e([h()],x.prototype,\"vvColor\",void 0),e([h()],x.prototype,\"vvOpacity\",void 0),e([h()],x.prototype,\"slicePlaneEnabled\",void 0),e([h()],x.prototype,\"transparent\",void 0),e([h()],x.prototype,\"sceneHasOcludees\",void 0),e([h({count:4})],x.prototype,\"transparencyPassType\",void 0),e([h()],x.prototype,\"multipassTerrainEnabled\",void 0),e([h()],x.prototype,\"cullAboveGround\",void 0);export{E as PathTechnique,x as PathTechniqueConfiguration,O as pathVertexAttributeLocations};\n"]},"metadata":{},"sourceType":"module"}