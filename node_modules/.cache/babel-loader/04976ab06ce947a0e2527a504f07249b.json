{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as s } from \"../chunks/tslib.es6.js\";\nimport e from \"./Accessor.js\";\nimport { assumeNonNull as i } from \"./maybe.js\";\nimport { createDeferred as r, createAbortError as t, isAbortError as o } from \"./promiseUtils.js\";\nimport { subclass as l } from \"./accessorSupport/decorators/subclass.js\";\n\nclass h {\n  constructor(s) {\n    this.instance = s, this._resolver = r(), this._status = 0, this._resolvingPromises = [], this._resolver.promise.then(() => {\n      this._status = 1, this._cleanUp();\n    }, () => {\n      this._status = 2, this._cleanUp();\n    });\n  }\n\n  addResolvingPromise(s) {\n    this._resolvingPromises.push(s), this._tryResolve();\n  }\n\n  isResolved() {\n    return 1 === this._status;\n  }\n\n  isRejected() {\n    return 2 === this._status;\n  }\n\n  isFulfilled() {\n    return 0 !== this._status;\n  }\n\n  abort() {\n    this._resolver.reject(t());\n  }\n\n  when(s, e) {\n    return this._resolver.promise.then(s, e);\n  }\n\n  _cleanUp() {\n    this._allPromise = this._resolvingPromises = this._allPromise = null;\n  }\n\n  _tryResolve() {\n    if (this.isFulfilled()) return;\n    const s = r(),\n          e = [...this._resolvingPromises, i(s.promise)],\n          t = this._allPromise = Promise.all(e);\n    t.then(() => {\n      this.isFulfilled() || this._allPromise !== t || this._resolver.resolve(this.instance);\n    }, s => {\n      this.isFulfilled() || this._allPromise !== t || o(s) || this._resolver.reject(s);\n    }), s.resolve();\n  }\n\n}\n\nconst n = e => {\n  let i = class extends e {\n    constructor(...s) {\n      super(...s), this._promiseProps = new h(this), this.addResolvingPromise(Promise.resolve());\n    }\n\n    isResolved() {\n      return this._promiseProps.isResolved();\n    }\n\n    isRejected() {\n      return this._promiseProps.isRejected();\n    }\n\n    isFulfilled() {\n      return this._promiseProps.isFulfilled();\n    }\n\n    when(s, e) {\n      return new Promise((s, e) => {\n        this._promiseProps.when(s, e);\n      }).then(s, e);\n    }\n\n    catch(s) {\n      return this.when(null, s);\n    }\n\n    addResolvingPromise(s) {\n      s && !this._promiseProps.isFulfilled() && this._promiseProps.addResolvingPromise(\"_promiseProps\" in s ? s.when() : s);\n    }\n\n  };\n  return i = s([l(\"esri.core.Promise\")], i), i;\n};\n\nlet m = class extends n(e) {};\nm = s([l(\"esri.core.Promise\")], m);\nexport { m as EsriPromise, n as EsriPromiseMixin };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/core/Promise.js"],"names":["_","s","e","assumeNonNull","i","createDeferred","r","createAbortError","t","isAbortError","o","subclass","l","h","constructor","instance","_resolver","_status","_resolvingPromises","promise","then","_cleanUp","addResolvingPromise","push","_tryResolve","isResolved","isRejected","isFulfilled","abort","reject","when","_allPromise","Promise","all","resolve","n","_promiseProps","catch","m","EsriPromise","EsriPromiseMixin"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,wBAAlB;AAA2C,OAAOC,CAAP,MAAa,eAAb;AAA6B,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,YAA9B;AAA2C,SAAOC,cAAc,IAAIC,CAAzB,EAA2BC,gBAAgB,IAAIC,CAA/C,EAAiDC,YAAY,IAAIC,CAAjE,QAAuE,mBAAvE;AAA2F,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,0CAAzB;;AAAoE,MAAMC,CAAN,CAAO;AAACC,EAAAA,WAAW,CAACb,CAAD,EAAG;AAAC,SAAKc,QAAL,GAAcd,CAAd,EAAgB,KAAKe,SAAL,GAAeV,CAAC,EAAhC,EAAmC,KAAKW,OAAL,GAAa,CAAhD,EAAkD,KAAKC,kBAAL,GAAwB,EAA1E,EAA6E,KAAKF,SAAL,CAAeG,OAAf,CAAuBC,IAAvB,CAA6B,MAAI;AAAC,WAAKH,OAAL,GAAa,CAAb,EAAe,KAAKI,QAAL,EAAf;AAA+B,KAAjE,EAAoE,MAAI;AAAC,WAAKJ,OAAL,GAAa,CAAb,EAAe,KAAKI,QAAL,EAAf;AAA+B,KAAxG,CAA7E;AAAwL;;AAAAC,EAAAA,mBAAmB,CAACrB,CAAD,EAAG;AAAC,SAAKiB,kBAAL,CAAwBK,IAAxB,CAA6BtB,CAA7B,GAAgC,KAAKuB,WAAL,EAAhC;AAAmD;;AAAAC,EAAAA,UAAU,GAAE;AAAC,WAAO,MAAI,KAAKR,OAAhB;AAAwB;;AAAAS,EAAAA,UAAU,GAAE;AAAC,WAAO,MAAI,KAAKT,OAAhB;AAAwB;;AAAAU,EAAAA,WAAW,GAAE;AAAC,WAAO,MAAI,KAAKV,OAAhB;AAAwB;;AAAAW,EAAAA,KAAK,GAAE;AAAC,SAAKZ,SAAL,CAAea,MAAf,CAAsBrB,CAAC,EAAvB;AAA2B;;AAAAsB,EAAAA,IAAI,CAAC7B,CAAD,EAAGC,CAAH,EAAK;AAAC,WAAO,KAAKc,SAAL,CAAeG,OAAf,CAAuBC,IAAvB,CAA4BnB,CAA5B,EAA8BC,CAA9B,CAAP;AAAwC;;AAAAmB,EAAAA,QAAQ,GAAE;AAAC,SAAKU,WAAL,GAAiB,KAAKb,kBAAL,GAAwB,KAAKa,WAAL,GAAiB,IAA1D;AAA+D;;AAAAP,EAAAA,WAAW,GAAE;AAAC,QAAG,KAAKG,WAAL,EAAH,EAAsB;AAAO,UAAM1B,CAAC,GAACK,CAAC,EAAT;AAAA,UAAYJ,CAAC,GAAC,CAAC,GAAG,KAAKgB,kBAAT,EAA4Bd,CAAC,CAACH,CAAC,CAACkB,OAAH,CAA7B,CAAd;AAAA,UAAwDX,CAAC,GAAC,KAAKuB,WAAL,GAAiBC,OAAO,CAACC,GAAR,CAAY/B,CAAZ,CAA3E;AAA0FM,IAAAA,CAAC,CAACY,IAAF,CAAQ,MAAI;AAAC,WAAKO,WAAL,MAAoB,KAAKI,WAAL,KAAmBvB,CAAvC,IAA0C,KAAKQ,SAAL,CAAekB,OAAf,CAAuB,KAAKnB,QAA5B,CAA1C;AAAgF,KAA7F,EAAgGd,CAAC,IAAE;AAAC,WAAK0B,WAAL,MAAoB,KAAKI,WAAL,KAAmBvB,CAAvC,IAA0CE,CAAC,CAACT,CAAD,CAA3C,IAAgD,KAAKe,SAAL,CAAea,MAAf,CAAsB5B,CAAtB,CAAhD;AAAyE,KAA7K,GAAgLA,CAAC,CAACiC,OAAF,EAAhL;AAA4L;;AAAl2B;;AAAm2B,MAAMC,CAAC,GAACjC,CAAC,IAAE;AAAC,MAAIE,CAAC,GAAC,cAAcF,CAAd,CAAe;AAACY,IAAAA,WAAW,CAAC,GAAGb,CAAJ,EAAM;AAAC,YAAM,GAAGA,CAAT,GAAY,KAAKmC,aAAL,GAAmB,IAAIvB,CAAJ,CAAM,IAAN,CAA/B,EAA2C,KAAKS,mBAAL,CAAyBU,OAAO,CAACE,OAAR,EAAzB,CAA3C;AAAuF;;AAAAT,IAAAA,UAAU,GAAE;AAAC,aAAO,KAAKW,aAAL,CAAmBX,UAAnB,EAAP;AAAuC;;AAAAC,IAAAA,UAAU,GAAE;AAAC,aAAO,KAAKU,aAAL,CAAmBV,UAAnB,EAAP;AAAuC;;AAAAC,IAAAA,WAAW,GAAE;AAAC,aAAO,KAAKS,aAAL,CAAmBT,WAAnB,EAAP;AAAwC;;AAAAG,IAAAA,IAAI,CAAC7B,CAAD,EAAGC,CAAH,EAAK;AAAC,aAAO,IAAI8B,OAAJ,CAAa,CAAC/B,CAAD,EAAGC,CAAH,KAAO;AAAC,aAAKkC,aAAL,CAAmBN,IAAnB,CAAwB7B,CAAxB,EAA0BC,CAA1B;AAA6B,OAAlD,EAAqDkB,IAArD,CAA0DnB,CAA1D,EAA4DC,CAA5D,CAAP;AAAsE;;AAAAmC,IAAAA,KAAK,CAACpC,CAAD,EAAG;AAAC,aAAO,KAAK6B,IAAL,CAAU,IAAV,EAAe7B,CAAf,CAAP;AAAyB;;AAAAqB,IAAAA,mBAAmB,CAACrB,CAAD,EAAG;AAACA,MAAAA,CAAC,IAAE,CAAC,KAAKmC,aAAL,CAAmBT,WAAnB,EAAJ,IAAsC,KAAKS,aAAL,CAAmBd,mBAAnB,CAAuC,mBAAkBrB,CAAlB,GAAoBA,CAAC,CAAC6B,IAAF,EAApB,GAA6B7B,CAApE,CAAtC;AAA6G;;AAA9f,GAArB;AAAqhB,SAAOG,CAAC,GAACH,CAAC,CAAC,CAACW,CAAC,CAAC,mBAAD,CAAF,CAAD,EAA0BR,CAA1B,CAAH,EAAgCA,CAAvC;AAAyC,CAA1kB;;AAA2kB,IAAIkC,CAAC,GAAC,cAAcH,CAAC,CAACjC,CAAD,CAAf,CAAmB,EAAzB;AAA4BoC,CAAC,GAACrC,CAAC,CAAC,CAACW,CAAC,CAAC,mBAAD,CAAF,CAAD,EAA0B0B,CAA1B,CAAH;AAAgC,SAAOA,CAAC,IAAIC,WAAZ,EAAwBJ,CAAC,IAAIK,gBAA7B","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../chunks/tslib.es6.js\";import e from\"./Accessor.js\";import{assumeNonNull as i}from\"./maybe.js\";import{createDeferred as r,createAbortError as t,isAbortError as o}from\"./promiseUtils.js\";import{subclass as l}from\"./accessorSupport/decorators/subclass.js\";class h{constructor(s){this.instance=s,this._resolver=r(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=1,this._cleanUp()}),(()=>{this._status=2,this._cleanUp()}))}addResolvingPromise(s){this._resolvingPromises.push(s),this._tryResolve()}isResolved(){return 1===this._status}isRejected(){return 2===this._status}isFulfilled(){return 0!==this._status}abort(){this._resolver.reject(t())}when(s,e){return this._resolver.promise.then(s,e)}_cleanUp(){this._allPromise=this._resolvingPromises=this._allPromise=null}_tryResolve(){if(this.isFulfilled())return;const s=r(),e=[...this._resolvingPromises,i(s.promise)],t=this._allPromise=Promise.all(e);t.then((()=>{this.isFulfilled()||this._allPromise!==t||this._resolver.resolve(this.instance)}),(s=>{this.isFulfilled()||this._allPromise!==t||o(s)||this._resolver.reject(s)})),s.resolve()}}const n=e=>{let i=class extends e{constructor(...s){super(...s),this._promiseProps=new h(this),this.addResolvingPromise(Promise.resolve())}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(s,e){return new Promise(((s,e)=>{this._promiseProps.when(s,e)})).then(s,e)}catch(s){return this.when(null,s)}addResolvingPromise(s){s&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise(\"_promiseProps\"in s?s.when():s)}};return i=s([l(\"esri.core.Promise\")],i),i};let m=class extends(n(e)){};m=s([l(\"esri.core.Promise\")],m);export{m as EsriPromise,n as EsriPromiseMixin};\n"]},"metadata":{},"sourceType":"module"}