{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../PopupTemplate.js\";\nimport { getDisplayFieldName as t } from \"../layers/support/fieldUtils.js\";\nimport i from \"../popup/content/AttachmentsContent.js\";\nimport \"../popup/content/Content.js\";\nimport \"../popup/content/CustomContent.js\";\nimport o from \"../popup/content/FieldsContent.js\";\nimport \"../popup/content/MediaContent.js\";\nimport \"../popup/content/TextContent.js\";\nimport n from \"../popup/FieldInfo.js\";\nimport r from \"../popup/support/FieldInfoFormat.js\";\nconst l = [\"oid\", \"global-id\"],\n      s = [\"oid\", \"global-id\", \"guid\"];\n\nfunction a({\n  displayField: t,\n  editFieldsInfo: i,\n  fields: o,\n  objectIdField: n,\n  title: r\n}, l) {\n  if (!o) return null;\n  const s = b({\n    editFieldsInfo: i,\n    fields: o,\n    objectIdField: n\n  }, l);\n  if (!s.length) return null;\n  const a = j({\n    titleBase: r,\n    fields: o,\n    displayField: t\n  }),\n        d = C();\n  return new e({\n    title: a,\n    content: d,\n    fieldInfos: s\n  });\n}\n\nconst d = [/^fnode_$/i, /^tnode_$/i, /^lpoly_$/i, /^rpoly_$/i, /^poly_$/i, /^subclass$/i, /^subclass_$/i, /^rings_ok$/i, /^rings_nok$/i, /shape/i, /perimeter/i, /objectid/i, /_i$/i],\n      p = (e, {\n  editFieldsInfo: t,\n  objectIdField: i,\n  visibleFieldNames: o\n}) => o ? o.has(e.name) : !f(e.name, t) && (!i || e.name !== i) && !(l.indexOf(e.type) > -1) && !d.some(t => t.test(e.name));\n\nfunction u(e, t) {\n  const i = e;\n  return t && (e = e.filter(e => -1 === t.indexOf(e.type))), e === i && (e = e.slice()), e.sort(c), e;\n}\n\nfunction c(e, t) {\n  return \"oid\" === e.type ? -1 : \"oid\" === t.type ? 1 : y(e) ? -1 : y(t) ? 1 : (e.alias || e.name).toLocaleLowerCase().localeCompare((t.alias || t.name).toLocaleLowerCase());\n}\n\nfunction f(e, t) {\n  if (!e || !t) return !1;\n  const {\n    creationDateField: i,\n    creatorField: o,\n    editDateField: n,\n    editorField: r\n  } = t;\n  return -1 !== [i && i.toLowerCase(), o && o.toLowerCase(), n && n.toLowerCase(), r && r.toLowerCase()].indexOf(e.toLowerCase());\n}\n\nfunction m(e, t) {\n  return e.editable && -1 === s.indexOf(e.type) && !f(e.name, t);\n}\n\nfunction F(e, t) {\n  return new o({\n    fieldInfos: b(e, t).filter(e => e.visible)\n  });\n}\n\nfunction b({\n  editFieldsInfo: e,\n  fields: t,\n  objectIdField: i\n}, o) {\n  return u(t, (null == o ? void 0 : o.ignoreFieldTypes) || g).map(t => new n({\n    fieldName: t.name,\n    isEditable: m(t, e),\n    label: t.alias,\n    format: w(t),\n    visible: p(t, {\n      editFieldsInfo: e,\n      objectIdField: i,\n      visibleFieldNames: null == o ? void 0 : o.visibleFieldNames\n    })\n  }));\n}\n\nfunction w(e) {\n  switch (e.type) {\n    case \"small-integer\":\n    case \"integer\":\n    case \"single\":\n      return new r({\n        digitSeparator: !0,\n        places: 0\n      });\n\n    case \"double\":\n      return new r({\n        digitSeparator: !0,\n        places: 2\n      });\n\n    case \"date\":\n      return new r({\n        dateFormat: \"long-month-day-year\"\n      });\n\n    default:\n      return null;\n  }\n}\n\nfunction C() {\n  return [new o(), new i()];\n}\n\nfunction j(e) {\n  const i = t(e),\n        {\n    titleBase: o\n  } = e;\n  return i ? `${o}: {${i.trim()}}` : o;\n}\n\nfunction y(e) {\n  if (\"name\" === (e.name && e.name.toLowerCase())) return !0;\n  return \"name\" === (e.alias && e.alias.toLowerCase()) || void 0;\n}\n\nconst g = [\"geometry\", \"blob\", \"raster\", \"guid\", \"xml\"];\nexport { b as createFieldInfos, F as createFieldsContent, a as createPopupTemplate };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/support/popupUtils.js"],"names":["e","getDisplayFieldName","t","i","o","n","r","l","s","a","displayField","editFieldsInfo","fields","objectIdField","title","b","length","j","titleBase","d","C","content","fieldInfos","p","visibleFieldNames","has","name","f","indexOf","type","some","test","u","filter","slice","sort","c","y","alias","toLocaleLowerCase","localeCompare","creationDateField","creatorField","editDateField","editorField","toLowerCase","m","editable","F","visible","ignoreFieldTypes","g","map","fieldName","isEditable","label","format","w","digitSeparator","places","dateFormat","trim","createFieldInfos","createFieldsContent","createPopupTemplate"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../PopupTemplate.js\";import{getDisplayFieldName as t}from\"../layers/support/fieldUtils.js\";import i from\"../popup/content/AttachmentsContent.js\";import\"../popup/content/Content.js\";import\"../popup/content/CustomContent.js\";import o from\"../popup/content/FieldsContent.js\";import\"../popup/content/MediaContent.js\";import\"../popup/content/TextContent.js\";import n from\"../popup/FieldInfo.js\";import r from\"../popup/support/FieldInfoFormat.js\";const l=[\"oid\",\"global-id\"],s=[\"oid\",\"global-id\",\"guid\"];function a({displayField:t,editFieldsInfo:i,fields:o,objectIdField:n,title:r},l){if(!o)return null;const s=b({editFieldsInfo:i,fields:o,objectIdField:n},l);if(!s.length)return null;const a=j({titleBase:r,fields:o,displayField:t}),d=C();return new e({title:a,content:d,fieldInfos:s})}const d=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],p=(e,{editFieldsInfo:t,objectIdField:i,visibleFieldNames:o})=>o?o.has(e.name):!f(e.name,t)&&((!i||e.name!==i)&&(!(l.indexOf(e.type)>-1)&&!d.some((t=>t.test(e.name)))));function u(e,t){const i=e;return t&&(e=e.filter((e=>-1===t.indexOf(e.type)))),e===i&&(e=e.slice()),e.sort(c),e}function c(e,t){return\"oid\"===e.type?-1:\"oid\"===t.type?1:y(e)?-1:y(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function f(e,t){if(!e||!t)return!1;const{creationDateField:i,creatorField:o,editDateField:n,editorField:r}=t;return-1!==[i&&i.toLowerCase(),o&&o.toLowerCase(),n&&n.toLowerCase(),r&&r.toLowerCase()].indexOf(e.toLowerCase())}function m(e,t){return e.editable&&-1===s.indexOf(e.type)&&!f(e.name,t)}function F(e,t){return new o({fieldInfos:b(e,t).filter((e=>e.visible))})}function b({editFieldsInfo:e,fields:t,objectIdField:i},o){return u(t,(null==o?void 0:o.ignoreFieldTypes)||g).map((t=>new n({fieldName:t.name,isEditable:m(t,e),label:t.alias,format:w(t),visible:p(t,{editFieldsInfo:e,objectIdField:i,visibleFieldNames:null==o?void 0:o.visibleFieldNames})})))}function w(e){switch(e.type){case\"small-integer\":case\"integer\":case\"single\":return new r({digitSeparator:!0,places:0});case\"double\":return new r({digitSeparator:!0,places:2});case\"date\":return new r({dateFormat:\"long-month-day-year\"});default:return null}}function C(){return[new o,new i]}function j(e){const i=t(e),{titleBase:o}=e;return i?`${o}: {${i.trim()}}`:o}function y(e){if(\"name\"===(e.name&&e.name.toLowerCase()))return!0;return\"name\"===(e.alias&&e.alias.toLowerCase())||void 0}const g=[\"geometry\",\"blob\",\"raster\",\"guid\",\"xml\"];export{b as createFieldInfos,F as createFieldsContent,a as createPopupTemplate};\n"]},"metadata":{},"sourceType":"module"}