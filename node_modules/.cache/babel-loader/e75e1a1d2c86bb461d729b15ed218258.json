{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../../core/Accessor.js\";\nimport i from \"../../../../../core/Handles.js\";\nimport { isNone as s, destroyMaybe as a, isSome as r } from \"../../../../../core/maybe.js\";\nimport { whenOnce as l } from \"../../../../../core/watchUtils.js\";\nimport { property as o } from \"../../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../../core/has.js\";\nimport \"../../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../../core/Logger.js\";\nimport { subclass as n } from \"../../../../../core/accessorSupport/decorators/subclass.js\";\nimport { v as h, m as d } from \"../../../../../chunks/mat4.js\";\nimport { s as p, l as u } from \"../../../../../chunks/vec3.js\";\nimport { sm4d as c, sv3d as m } from \"../../../../../geometry/support/vectorStacks.js\";\nimport { PLANE_OUTLINE_WIDTH as y, PLANE_PREVIEW_OUTLINE_WIDTH as w, PLANE_OUTLINE_COLOR as _, PLANE_BACKGROUND_COLOR as V, GRID_COLOR as g } from \"../../analysisTools/slice/sliceToolConfig.js\";\nimport { createGridVisualElement as v, createOutlineVisualElement as E, calculateBoundedPlaneTranslateRotate as b } from \"../../analysisTools/slice/sliceToolUtils.js\";\nimport { createStipplePatternSimple as f } from \"../../../webgl-engine/materials/lineStippleUtils.js\";\nlet j = class extends t {\n  constructor(e) {\n    super(e), this._handles = new i(), this._gridVisualElement = null, this._outlineVisualElement = null, this.state = \"pending\";\n  }\n\n  get ready() {\n    return \"ready\" === this.state;\n  }\n\n  set showGrid(e) {\n    this._set(\"showGrid\", e), this._updateMaterials();\n  }\n\n  set editable(e) {\n    this._set(\"editable\", e), this._updateMaterials();\n  }\n\n  initialize() {\n    this._initialize();\n  }\n\n  async _initialize() {\n    switch (this.state) {\n      case \"pending\":\n        break;\n\n      case \"destroyed\":\n        return;\n\n      case \"ready\":\n        throw new Error(\"state error\");\n    }\n\n    if (await l(this.view, \"ready\", !0), s(this.layerView.layerViewData)) throw new Error(\"expected internal object to be valid\");\n    this._gridVisualElement = v(this.view), this._outlineVisualElement = E(this.view), this._handles.add([this.analysis.watch(\"opacity\", () => this._updateMaterials(), !0)], \"analysis\"), this._handles.add([this.layerView.watch(\"visible\", () => this._updateMaterials(), !0), this.layerView.layerViewData.watch(\"plane\", () => this._updatePlane(), !0), this.layerView.watch(\"active\", () => this._updateMaterials(), !0)], \"internal\"), this._updatePlane(), this._set(\"state\", \"ready\");\n  }\n\n  destroy() {\n    switch (this.state) {\n      case \"destroyed\":\n      case \"pending\":\n        return;\n    }\n\n    this._handles.destroy(), this._gridVisualElement = a(this._gridVisualElement), this._outlineVisualElement = a(this._outlineVisualElement), this.set(\"view\", null), this._set(\"state\", \"destroyed\");\n  }\n\n  async whenReady() {\n    return await l(this, \"ready\"), this;\n  }\n\n  _update() {\n    switch (this.state) {\n      case \"pending\":\n      case \"destroyed\":\n        return;\n    }\n  }\n\n  _updatePlane() {\n    const e = this.layerView.layerViewData.plane,\n          t = r(e) ? b(e, c.get()) : null;\n\n    if (this._outlineVisualElement.width = y, r(e)) {\n      const i = p(m.get(), u(e.basis1), u(e.basis2), 1),\n            s = h(c.get(), i),\n            a = d(s, t, s);\n      this._outlineVisualElement.transform = a, this._gridVisualElement.transform = a;\n    }\n\n    this._updateMaterials();\n  }\n\n  _updateMaterials() {\n    const e = this.layerView.layerViewData.plane && this.analysis.visible,\n          t = this.layerView.active,\n          i = [_[0], _[1], _[2], _[3]];\n    this._outlineVisualElement.color = i, this._outlineVisualElement.width = this.editable ? y : w, this._outlineVisualElement.stipplePattern = t ? null : f(5);\n    const s = [V[0], V[1], V[2], V[3]],\n          a = !!r(this.layerView.layerViewData) && this.showGrid ? g : [0, 0, 0, 0];\n    this._gridVisualElement.backgroundColor = s, this._gridVisualElement.gridColor = a, this._gridVisualElement.visible = e, this._outlineVisualElement.visible = e;\n  }\n\n};\ne([o({\n  readOnly: !0\n})], j.prototype, \"state\", void 0), e([o()], j.prototype, \"view\", void 0), e([o()], j.prototype, \"analysis\", void 0), e([o()], j.prototype, \"layerView\", void 0), e([o()], j.prototype, \"ready\", null), e([o({\n  value: !1\n})], j.prototype, \"showGrid\", null), e([o({\n  value: !0\n})], j.prototype, \"editable\", null), j = e([n(\"esri.views.3d.interactive.graphics.Slice.SliceView\")], j);\nexport { j as SliceView };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/interactive/graphics/Slice/SliceView.js"],"names":["_","e","t","i","isNone","s","destroyMaybe","a","isSome","r","whenOnce","l","property","o","subclass","n","v","h","m","d","p","u","sm4d","c","sv3d","PLANE_OUTLINE_WIDTH","y","PLANE_PREVIEW_OUTLINE_WIDTH","w","PLANE_OUTLINE_COLOR","PLANE_BACKGROUND_COLOR","V","GRID_COLOR","g","createGridVisualElement","createOutlineVisualElement","E","calculateBoundedPlaneTranslateRotate","b","createStipplePatternSimple","f","j","constructor","_handles","_gridVisualElement","_outlineVisualElement","state","ready","showGrid","_set","_updateMaterials","editable","initialize","_initialize","Error","view","layerView","layerViewData","add","analysis","watch","_updatePlane","destroy","set","whenReady","_update","plane","get","width","basis1","basis2","transform","visible","active","color","stipplePattern","backgroundColor","gridColor","readOnly","prototype","value","SliceView"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import t from\"../../../../../core/Accessor.js\";import i from\"../../../../../core/Handles.js\";import{isNone as s,destroyMaybe as a,isSome as r}from\"../../../../../core/maybe.js\";import{whenOnce as l}from\"../../../../../core/watchUtils.js\";import{property as o}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as n}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{v as h,m as d}from\"../../../../../chunks/mat4.js\";import{s as p,l as u}from\"../../../../../chunks/vec3.js\";import{sm4d as c,sv3d as m}from\"../../../../../geometry/support/vectorStacks.js\";import{PLANE_OUTLINE_WIDTH as y,PLANE_PREVIEW_OUTLINE_WIDTH as w,PLANE_OUTLINE_COLOR as _,PLANE_BACKGROUND_COLOR as V,GRID_COLOR as g}from\"../../analysisTools/slice/sliceToolConfig.js\";import{createGridVisualElement as v,createOutlineVisualElement as E,calculateBoundedPlaneTranslateRotate as b}from\"../../analysisTools/slice/sliceToolUtils.js\";import{createStipplePatternSimple as f}from\"../../../webgl-engine/materials/lineStippleUtils.js\";let j=class extends t{constructor(e){super(e),this._handles=new i,this._gridVisualElement=null,this._outlineVisualElement=null,this.state=\"pending\"}get ready(){return\"ready\"===this.state}set showGrid(e){this._set(\"showGrid\",e),this._updateMaterials()}set editable(e){this._set(\"editable\",e),this._updateMaterials()}initialize(){this._initialize()}async _initialize(){switch(this.state){case\"pending\":break;case\"destroyed\":return;case\"ready\":throw new Error(\"state error\")}if(await l(this.view,\"ready\",!0),s(this.layerView.layerViewData))throw new Error(\"expected internal object to be valid\");this._gridVisualElement=v(this.view),this._outlineVisualElement=E(this.view),this._handles.add([this.analysis.watch(\"opacity\",(()=>this._updateMaterials()),!0)],\"analysis\"),this._handles.add([this.layerView.watch(\"visible\",(()=>this._updateMaterials()),!0),this.layerView.layerViewData.watch(\"plane\",(()=>this._updatePlane()),!0),this.layerView.watch(\"active\",(()=>this._updateMaterials()),!0)],\"internal\"),this._updatePlane(),this._set(\"state\",\"ready\")}destroy(){switch(this.state){case\"destroyed\":case\"pending\":return}this._handles.destroy(),this._gridVisualElement=a(this._gridVisualElement),this._outlineVisualElement=a(this._outlineVisualElement),this.set(\"view\",null),this._set(\"state\",\"destroyed\")}async whenReady(){return await l(this,\"ready\"),this}_update(){switch(this.state){case\"pending\":case\"destroyed\":return}}_updatePlane(){const e=this.layerView.layerViewData.plane,t=r(e)?b(e,c.get()):null;if(this._outlineVisualElement.width=y,r(e)){const i=p(m.get(),u(e.basis1),u(e.basis2),1),s=h(c.get(),i),a=d(s,t,s);this._outlineVisualElement.transform=a,this._gridVisualElement.transform=a}this._updateMaterials()}_updateMaterials(){const e=this.layerView.layerViewData.plane&&this.analysis.visible,t=this.layerView.active,i=[_[0],_[1],_[2],_[3]];this._outlineVisualElement.color=i,this._outlineVisualElement.width=this.editable?y:w,this._outlineVisualElement.stipplePattern=t?null:f(5);const s=[V[0],V[1],V[2],V[3]],a=!!r(this.layerView.layerViewData)&&this.showGrid?g:[0,0,0,0];this._gridVisualElement.backgroundColor=s,this._gridVisualElement.gridColor=a,this._gridVisualElement.visible=e,this._outlineVisualElement.visible=e}};e([o({readOnly:!0})],j.prototype,\"state\",void 0),e([o()],j.prototype,\"view\",void 0),e([o()],j.prototype,\"analysis\",void 0),e([o()],j.prototype,\"layerView\",void 0),e([o()],j.prototype,\"ready\",null),e([o({value:!1})],j.prototype,\"showGrid\",null),e([o({value:!0})],j.prototype,\"editable\",null),j=e([n(\"esri.views.3d.interactive.graphics.Slice.SliceView\")],j);export{j as SliceView};\n"]},"metadata":{},"sourceType":"module"}