{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { destroyMaybe as t, isNone as e, isSome as i } from \"../../../core/maybe.js\";\nimport { f as s } from \"../../../chunks/vec4f64.js\";\n\nclass r {\n  constructor(t) {\n    this._getFadeDuration = t, this._fadeStart = 0, this._delayedTime = 0;\n  }\n\n  clear() {\n    this._current = t(this._current), this._next = t(this._next), this._waiting = t(this._waiting), this._delayed = t(this._delayed);\n  }\n\n  get current() {\n    if (e(this._current)) return null;\n\n    if (!this._isFading) {\n      const t = this._delayed || this._waiting || this._next || this._current;\n      t !== this._current && (this._current = null, this.clear(), this._current = t);\n    }\n\n    let s = 0;\n\n    if (i(this._delayed) && (s = performance.now(), s >= this._delayedTime && (this._push(this._delayed, 0), this._delayed = null)), i(this._next)) {\n      s = s || performance.now();\n      const e = this._fadeDuration;\n      s - this._fadeStart >= e && (t(this._current), this._current = this._next, this._next = this._waiting, this._waiting = null, this._fadeStart = this._alignFadeStart(s));\n    }\n\n    return this._current;\n  }\n\n  get next() {\n    return this._next;\n  }\n\n  get fadeFactor() {\n    if (e(this._next)) return 1;\n    const t = Math.max(0, performance.now() - this._fadeStart),\n          i = this._fadeDuration;\n    return t > i ? 0 : 1 - t / i;\n  }\n\n  get isFading() {\n    return i(this._next) || i(this._delayed);\n  }\n\n  push(e, s, r, a, h = 0) {\n    this._delayed = t(this._delayed);\n\n    const _ = i(e) ? new n(e, s, r, a) : null;\n\n    this._push(_, h);\n  }\n\n  _push(i, s) {\n    if (this._isFading || this.clear(), e(this._current)) return void (this._current = i);\n    const r = performance.now();\n    return 0 !== s ? (this._delayed = i, void (this._delayedTime = r + s)) : e(this._next) ? (this._next = i, void (this._fadeStart = this._alignFadeStart(r))) : void (e(i) || (t(this._waiting), this._waiting = i));\n  }\n\n  get _fadeDuration() {\n    return e(this._waiting) ? this._getFadeDuration() : .5 * this._getFadeDuration();\n  }\n\n  _alignFadeStart(t) {\n    const e = this._getFadeDuration();\n\n    return t + e - t % e;\n  }\n\n  get _isFading() {\n    return this._getFadeDuration() > 0;\n  }\n\n}\n\nclass n {\n  constructor(t, e, i, r) {\n    this.texture = t, t.retain(), this.offsetAndScale = s(e, i, r, r);\n  }\n\n  destroy() {\n    this.texture.release();\n  }\n\n}\n\nexport default r;\nexport { n as TextureReference };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/terrain/TextureFader.js"],"names":["destroyMaybe","t","isNone","e","isSome","i","f","s","r","constructor","_getFadeDuration","_fadeStart","_delayedTime","clear","_current","_next","_waiting","_delayed","current","_isFading","performance","now","_push","_fadeDuration","_alignFadeStart","next","fadeFactor","Math","max","isFading","push","a","h","_","n","texture","retain","offsetAndScale","destroy","release","TextureReference"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{destroyMaybe as t,isNone as e,isSome as i}from\"../../../core/maybe.js\";import{f as s}from\"../../../chunks/vec4f64.js\";class r{constructor(t){this._getFadeDuration=t,this._fadeStart=0,this._delayedTime=0}clear(){this._current=t(this._current),this._next=t(this._next),this._waiting=t(this._waiting),this._delayed=t(this._delayed)}get current(){if(e(this._current))return null;if(!this._isFading){const t=this._delayed||this._waiting||this._next||this._current;t!==this._current&&(this._current=null,this.clear(),this._current=t)}let s=0;if(i(this._delayed)&&(s=performance.now(),s>=this._delayedTime&&(this._push(this._delayed,0),this._delayed=null)),i(this._next)){s=s||performance.now();const e=this._fadeDuration;s-this._fadeStart>=e&&(t(this._current),this._current=this._next,this._next=this._waiting,this._waiting=null,this._fadeStart=this._alignFadeStart(s))}return this._current}get next(){return this._next}get fadeFactor(){if(e(this._next))return 1;const t=Math.max(0,performance.now()-this._fadeStart),i=this._fadeDuration;return t>i?0:1-t/i}get isFading(){return i(this._next)||i(this._delayed)}push(e,s,r,a,h=0){this._delayed=t(this._delayed);const _=i(e)?new n(e,s,r,a):null;this._push(_,h)}_push(i,s){if(this._isFading||this.clear(),e(this._current))return void(this._current=i);const r=performance.now();return 0!==s?(this._delayed=i,void(this._delayedTime=r+s)):e(this._next)?(this._next=i,void(this._fadeStart=this._alignFadeStart(r))):void(e(i)||(t(this._waiting),this._waiting=i))}get _fadeDuration(){return e(this._waiting)?this._getFadeDuration():.5*this._getFadeDuration()}_alignFadeStart(t){const e=this._getFadeDuration();return t+e-t%e}get _isFading(){return this._getFadeDuration()>0}}class n{constructor(t,e,i,r){this.texture=t,t.retain(),this.offsetAndScale=s(e,i,r,r)}destroy(){this.texture.release()}}export default r;export{n as TextureReference};\n"]},"metadata":{},"sourceType":"module"}