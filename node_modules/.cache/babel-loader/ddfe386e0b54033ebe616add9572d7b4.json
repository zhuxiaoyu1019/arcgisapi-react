{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isPromise as e } from \"../../../../core/promiseUtils.js\";\nimport { union as t } from \"./depthRange.js\";\nimport { assert as r } from \"./Util.js\";\n\nclass n {\n  constructor(e) {\n    this.context = e, this.renderPlugins = new Array(), this.slots = [];\n\n    for (let t = 0; t < 23; ++t) this.slots[t] = [];\n  }\n\n  add(t, r, n = null) {\n    const s = r.initializeRenderContext(this.context, n),\n          i = () => {\n      this.renderPlugins.push(r);\n\n      for (let e = 0; e < t.length; ++e) {\n        const n = t[e];\n        this.slots[n].push(r);\n      }\n\n      this.context.requestRender();\n    };\n\n    if (e(s)) return s.then(i);\n    i();\n  }\n\n  remove(e) {\n    const t = this.renderPlugins.length;\n    this.renderPlugins = this.renderPlugins.filter(t => t !== e), r(this.renderPlugins.length < t, \"Removing non-added render plugin\");\n\n    for (let r = 0; r < this.slots.length; ++r) this.slots[r] = this.slots[r].filter(t => t !== e);\n\n    e.uninitializeRenderContext(), this.context.requestRender();\n  }\n\n  prepareRender(e, t) {\n    for (const r of this.renderPlugins) r.prepareRender && r.prepareRender(e, t);\n  }\n\n  render() {\n    const e = this.slots[this.context.renderContext.slot];\n    let t = !1;\n\n    for (const r of e) r.canRender && r.render(this.context.renderContext) && (t = !0);\n\n    return t;\n  }\n\n  queryDepthRange(e) {\n    const r = s;\n    r.near = 1 / 0, r.far = -1 / 0;\n\n    for (const n of this.renderPlugins) if (n.queryDepthRange) {\n      const s = n.queryDepthRange(e);\n      s && t(r, s, r);\n    }\n\n    return r;\n  }\n\n  get needsHighlight() {\n    return this.renderPlugins.some(e => e.needsHighlight);\n  }\n\n  get needsLinearDepth() {\n    return this.renderPlugins.some(e => e.needsLinearDepth);\n  }\n\n  get needsLaserlineWithContrastControl() {\n    const e = this.slots[17];\n    return !!e && e.length > 0;\n  }\n\n  get renderOccludedFlags() {\n    let e = 0;\n    return this.renderPlugins.forEach(t => {\n      t.renderOccludedFlags && (e |= t.renderOccludedFlags);\n    }), e;\n  }\n\n}\n\nconst s = {\n  near: 0,\n  far: 0\n};\nexport { n as RenderPluginManager };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderPluginManager.js"],"names":["isPromise","e","union","t","assert","r","n","constructor","context","renderPlugins","Array","slots","add","s","initializeRenderContext","i","push","length","requestRender","then","remove","filter","uninitializeRenderContext","prepareRender","render","renderContext","slot","canRender","queryDepthRange","near","far","needsHighlight","some","needsLinearDepth","needsLaserlineWithContrastControl","renderOccludedFlags","forEach","RenderPluginManager"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,SAAS,IAAIC,CAApB,QAA0B,kCAA1B;AAA6D,SAAOC,KAAK,IAAIC,CAAhB,QAAsB,iBAAtB;AAAwC,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,WAAvB;;AAAmC,MAAMC,CAAN,CAAO;AAACC,EAAAA,WAAW,CAACN,CAAD,EAAG;AAAC,SAAKO,OAAL,GAAaP,CAAb,EAAe,KAAKQ,aAAL,GAAmB,IAAIC,KAAJ,EAAlC,EAA4C,KAAKC,KAAL,GAAW,EAAvD;;AAA0D,SAAI,IAAIR,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,EAAd,EAAiB,EAAEA,CAAnB,EAAqB,KAAKQ,KAAL,CAAWR,CAAX,IAAc,EAAd;AAAiB;;AAAAS,EAAAA,GAAG,CAACT,CAAD,EAAGE,CAAH,EAAKC,CAAC,GAAC,IAAP,EAAY;AAAC,UAAMO,CAAC,GAACR,CAAC,CAACS,uBAAF,CAA0B,KAAKN,OAA/B,EAAuCF,CAAvC,CAAR;AAAA,UAAkDS,CAAC,GAAC,MAAI;AAAC,WAAKN,aAAL,CAAmBO,IAAnB,CAAwBX,CAAxB;;AAA2B,WAAI,IAAIJ,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACE,CAAC,CAACc,MAAhB,EAAuB,EAAEhB,CAAzB,EAA2B;AAAC,cAAMK,CAAC,GAACH,CAAC,CAACF,CAAD,CAAT;AAAa,aAAKU,KAAL,CAAWL,CAAX,EAAcU,IAAd,CAAmBX,CAAnB;AAAsB;;AAAA,WAAKG,OAAL,CAAaU,aAAb;AAA6B,KAAhL;;AAAiL,QAAGjB,CAAC,CAACY,CAAD,CAAJ,EAAQ,OAAOA,CAAC,CAACM,IAAF,CAAOJ,CAAP,CAAP;AAAiBA,IAAAA,CAAC;AAAG;;AAAAK,EAAAA,MAAM,CAACnB,CAAD,EAAG;AAAC,UAAME,CAAC,GAAC,KAAKM,aAAL,CAAmBQ,MAA3B;AAAkC,SAAKR,aAAL,GAAmB,KAAKA,aAAL,CAAmBY,MAAnB,CAA2BlB,CAAC,IAAEA,CAAC,KAAGF,CAAlC,CAAnB,EAAyDI,CAAC,CAAC,KAAKI,aAAL,CAAmBQ,MAAnB,GAA0Bd,CAA3B,EAA6B,kCAA7B,CAA1D;;AAA2H,SAAI,IAAIE,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,KAAKM,KAAL,CAAWM,MAAzB,EAAgC,EAAEZ,CAAlC,EAAoC,KAAKM,KAAL,CAAWN,CAAX,IAAc,KAAKM,KAAL,CAAWN,CAAX,EAAcgB,MAAd,CAAsBlB,CAAC,IAAEA,CAAC,KAAGF,CAA7B,CAAd;;AAA+CA,IAAAA,CAAC,CAACqB,yBAAF,IAA8B,KAAKd,OAAL,CAAaU,aAAb,EAA9B;AAA2D;;AAAAK,EAAAA,aAAa,CAACtB,CAAD,EAAGE,CAAH,EAAK;AAAC,SAAI,MAAME,CAAV,IAAe,KAAKI,aAApB,EAAkCJ,CAAC,CAACkB,aAAF,IAAiBlB,CAAC,CAACkB,aAAF,CAAgBtB,CAAhB,EAAkBE,CAAlB,CAAjB;AAAsC;;AAAAqB,EAAAA,MAAM,GAAE;AAAC,UAAMvB,CAAC,GAAC,KAAKU,KAAL,CAAW,KAAKH,OAAL,CAAaiB,aAAb,CAA2BC,IAAtC,CAAR;AAAoD,QAAIvB,CAAC,GAAC,CAAC,CAAP;;AAAS,SAAI,MAAME,CAAV,IAAeJ,CAAf,EAAiBI,CAAC,CAACsB,SAAF,IAAatB,CAAC,CAACmB,MAAF,CAAS,KAAKhB,OAAL,CAAaiB,aAAtB,CAAb,KAAoDtB,CAAC,GAAC,CAAC,CAAvD;;AAA0D,WAAOA,CAAP;AAAS;;AAAAyB,EAAAA,eAAe,CAAC3B,CAAD,EAAG;AAAC,UAAMI,CAAC,GAACQ,CAAR;AAAUR,IAAAA,CAAC,CAACwB,IAAF,GAAO,IAAE,CAAT,EAAWxB,CAAC,CAACyB,GAAF,GAAM,CAAC,CAAD,GAAG,CAApB;;AAAsB,SAAI,MAAMxB,CAAV,IAAe,KAAKG,aAApB,EAAkC,IAAGH,CAAC,CAACsB,eAAL,EAAqB;AAAC,YAAMf,CAAC,GAACP,CAAC,CAACsB,eAAF,CAAkB3B,CAAlB,CAAR;AAA6BY,MAAAA,CAAC,IAAEV,CAAC,CAACE,CAAD,EAAGQ,CAAH,EAAKR,CAAL,CAAJ;AAAY;;AAAA,WAAOA,CAAP;AAAS;;AAAkB,MAAd0B,cAAc,GAAE;AAAC,WAAO,KAAKtB,aAAL,CAAmBuB,IAAnB,CAAyB/B,CAAC,IAAEA,CAAC,CAAC8B,cAA9B,CAAP;AAAsD;;AAAoB,MAAhBE,gBAAgB,GAAE;AAAC,WAAO,KAAKxB,aAAL,CAAmBuB,IAAnB,CAAyB/B,CAAC,IAAEA,CAAC,CAACgC,gBAA9B,CAAP;AAAwD;;AAAqC,MAAjCC,iCAAiC,GAAE;AAAC,UAAMjC,CAAC,GAAC,KAAKU,KAAL,CAAW,EAAX,CAAR;AAAuB,WAAM,CAAC,CAACV,CAAF,IAAKA,CAAC,CAACgB,MAAF,GAAS,CAApB;AAAsB;;AAAuB,MAAnBkB,mBAAmB,GAAE;AAAC,QAAIlC,CAAC,GAAC,CAAN;AAAQ,WAAO,KAAKQ,aAAL,CAAmB2B,OAAnB,CAA4BjC,CAAC,IAAE;AAACA,MAAAA,CAAC,CAACgC,mBAAF,KAAwBlC,CAAC,IAAEE,CAAC,CAACgC,mBAA7B;AAAkD,KAAlF,GAAqFlC,CAA5F;AAA8F;;AAAp4C;;AAAq4C,MAAMY,CAAC,GAAC;AAACgB,EAAAA,IAAI,EAAC,CAAN;AAAQC,EAAAA,GAAG,EAAC;AAAZ,CAAR;AAAuB,SAAOxB,CAAC,IAAI+B,mBAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isPromise as e}from\"../../../../core/promiseUtils.js\";import{union as t}from\"./depthRange.js\";import{assert as r}from\"./Util.js\";class n{constructor(e){this.context=e,this.renderPlugins=new Array,this.slots=[];for(let t=0;t<23;++t)this.slots[t]=[]}add(t,r,n=null){const s=r.initializeRenderContext(this.context,n),i=()=>{this.renderPlugins.push(r);for(let e=0;e<t.length;++e){const n=t[e];this.slots[n].push(r)}this.context.requestRender()};if(e(s))return s.then(i);i()}remove(e){const t=this.renderPlugins.length;this.renderPlugins=this.renderPlugins.filter((t=>t!==e)),r(this.renderPlugins.length<t,\"Removing non-added render plugin\");for(let r=0;r<this.slots.length;++r)this.slots[r]=this.slots[r].filter((t=>t!==e));e.uninitializeRenderContext(),this.context.requestRender()}prepareRender(e,t){for(const r of this.renderPlugins)r.prepareRender&&r.prepareRender(e,t)}render(){const e=this.slots[this.context.renderContext.slot];let t=!1;for(const r of e)r.canRender&&r.render(this.context.renderContext)&&(t=!0);return t}queryDepthRange(e){const r=s;r.near=1/0,r.far=-1/0;for(const n of this.renderPlugins)if(n.queryDepthRange){const s=n.queryDepthRange(e);s&&t(r,s,r)}return r}get needsHighlight(){return this.renderPlugins.some((e=>e.needsHighlight))}get needsLinearDepth(){return this.renderPlugins.some((e=>e.needsLinearDepth))}get needsLaserlineWithContrastControl(){const e=this.slots[17];return!!e&&e.length>0}get renderOccludedFlags(){let e=0;return this.renderPlugins.forEach((t=>{t.renderOccludedFlags&&(e|=t.renderOccludedFlags)})),e}}const s={near:0,far:0};export{n as RenderPluginManager};\n"]},"metadata":{},"sourceType":"module"}