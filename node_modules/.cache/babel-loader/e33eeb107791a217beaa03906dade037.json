{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../../../core/Logger.js\";\nimport { hydrateGeometry as t } from \"../../../../layers/graphics/hydratedFeatures.js\";\nimport { loadArcade as r } from \"../../../../support/arcadeOnDemand.js\";\nconst n = e.getLogger(\"esri.views.3d.layers.graphics.featureExpressionInfoUtils\");\n\nfunction c(e) {\n  return {\n    cachedResult: e.cachedResult,\n    arcade: e.arcade ? {\n      func: e.arcade.func,\n      context: e.arcade.modules.arcadeUtils.createExecContext(null, {\n        sr: e.arcade.context.spatialReference\n      }),\n      modules: e.arcade.modules\n    } : null\n  };\n}\n\nfunction o(e) {\n  const t = e && e.expression;\n\n  if (\"string\" == typeof t) {\n    const e = p(t);\n    if (null != e) return {\n      cachedResult: e\n    };\n  }\n\n  return null;\n}\n\nasync function a(e, t, n) {\n  const c = e && e.expression;\n  if (\"string\" != typeof c) return null;\n  const o = p(c);\n  if (null != o) return {\n    cachedResult: o\n  };\n  const a = await r(),\n        u = a.arcadeUtils,\n        s = u.createSyntaxTree(c);\n  return u.dependsOnView(s) ? (null != n && n.error(\"Expressions containing '$view' are not supported on ElevationInfo\"), {\n    cachedResult: 0\n  }) : {\n    arcade: {\n      func: u.createFunction(s),\n      context: u.createExecContext(null, {\n        sr: t\n      }),\n      modules: a\n    }\n  };\n}\n\nfunction u(e, t, r) {\n  return e.arcadeUtils.createFeature(t.attributes, t.geometry, r);\n}\n\nfunction s(e, r) {\n  if (null != e && !f(e)) {\n    if (!r || !e.arcade) return void n.errorOncePerTick(\"Arcade support required but not provided\");\n    const c = r;\n    c._geometry && (c._geometry = t(c._geometry)), e.arcade.modules.arcadeUtils.updateExecContext(e.arcade.context, r);\n  }\n}\n\nfunction l(e) {\n  if (null != e) {\n    if (f(e)) return e.cachedResult;\n    const t = e.arcade;\n    let r = e.arcade.modules.arcadeUtils.executeFunction(t.func, t.context);\n    return \"number\" != typeof r && (e.cachedResult = 0, r = 0), r;\n  }\n\n  return 0;\n}\n\nfunction i(e, t = !1) {\n  let r = e && e.featureExpressionInfo;\n  const n = r && r.expression;\n  return t || \"0\" === n || (r = null), r;\n}\n\nconst d = {\n  cachedResult: 0\n};\n\nfunction f(e) {\n  return null != e.cachedResult;\n}\n\nfunction p(e) {\n  return \"0\" === e ? 0 : null;\n}\n\nexport { c as clone, a as createContext, o as createContextWithoutExpressionSupport, u as createFeature, l as execute, i as extractExpressionInfo, s as setContextFeature, d as zeroContext };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/layers/graphics/featureExpressionInfoUtils.js"],"names":["e","hydrateGeometry","t","loadArcade","r","n","getLogger","c","cachedResult","arcade","func","context","modules","arcadeUtils","createExecContext","sr","spatialReference","o","expression","p","a","u","s","createSyntaxTree","dependsOnView","error","createFunction","createFeature","attributes","geometry","f","errorOncePerTick","_geometry","updateExecContext","l","executeFunction","i","featureExpressionInfo","d","clone","createContext","createContextWithoutExpressionSupport","execute","extractExpressionInfo","setContextFeature","zeroContext"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Logger.js\";import{hydrateGeometry as t}from\"../../../../layers/graphics/hydratedFeatures.js\";import{loadArcade as r}from\"../../../../support/arcadeOnDemand.js\";const n=e.getLogger(\"esri.views.3d.layers.graphics.featureExpressionInfoUtils\");function c(e){return{cachedResult:e.cachedResult,arcade:e.arcade?{func:e.arcade.func,context:e.arcade.modules.arcadeUtils.createExecContext(null,{sr:e.arcade.context.spatialReference}),modules:e.arcade.modules}:null}}function o(e){const t=e&&e.expression;if(\"string\"==typeof t){const e=p(t);if(null!=e)return{cachedResult:e}}return null}async function a(e,t,n){const c=e&&e.expression;if(\"string\"!=typeof c)return null;const o=p(c);if(null!=o)return{cachedResult:o};const a=await r(),u=a.arcadeUtils,s=u.createSyntaxTree(c);return u.dependsOnView(s)?(null!=n&&n.error(\"Expressions containing '$view' are not supported on ElevationInfo\"),{cachedResult:0}):{arcade:{func:u.createFunction(s),context:u.createExecContext(null,{sr:t}),modules:a}}}function u(e,t,r){return e.arcadeUtils.createFeature(t.attributes,t.geometry,r)}function s(e,r){if(null!=e&&!f(e)){if(!r||!e.arcade)return void n.errorOncePerTick(\"Arcade support required but not provided\");const c=r;c._geometry&&(c._geometry=t(c._geometry)),e.arcade.modules.arcadeUtils.updateExecContext(e.arcade.context,r)}}function l(e){if(null!=e){if(f(e))return e.cachedResult;const t=e.arcade;let r=e.arcade.modules.arcadeUtils.executeFunction(t.func,t.context);return\"number\"!=typeof r&&(e.cachedResult=0,r=0),r}return 0}function i(e,t=!1){let r=e&&e.featureExpressionInfo;const n=r&&r.expression;return t||\"0\"===n||(r=null),r}const d={cachedResult:0};function f(e){return null!=e.cachedResult}function p(e){return\"0\"===e?0:null}export{c as clone,a as createContext,o as createContextWithoutExpressionSupport,u as createFeature,l as execute,i as extractExpressionInfo,s as setContextFeature,d as zeroContext};\n"]},"metadata":{},"sourceType":"module"}