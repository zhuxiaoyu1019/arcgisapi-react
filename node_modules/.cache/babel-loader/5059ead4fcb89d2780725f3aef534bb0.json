{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../../chunks/tslib.es6.js\";\nimport { VertexPosition as r } from \"../../core/shaderLibrary/attributes/VertexPosition.glsl.js\";\nimport { ReloadableShaderModule as i } from \"../../core/shaderTechnique/ReloadableShaderModule.js\";\nimport { ShaderTechnique as o } from \"../../core/shaderTechnique/ShaderTechnique.js\";\nimport { parameter as t, ShaderTechniqueConfiguration as a } from \"../../core/shaderTechnique/ShaderTechniqueConfiguration.js\";\nimport { Program as s } from \"../Program.js\";\nimport { EdgeShaderAttributeLocations as l } from \"./bufferLayouts.js\";\nimport { E as n } from \"../../../../../chunks/EdgeShaderProgram.glsl.js\";\nimport { makePipelineState as c, separateBlendingParams as u, defaultColorWriteParams as d, defaultDepthWriteParams as m } from \"../../../../webgl/renderState.js\";\nconst f = -4e-4,\n      p = .5;\n\nclass h extends o {\n  bindPass(e) {\n    const i = this.program,\n          {\n      edgeRenderParameters: o,\n      bindParameters: t\n    } = e;\n    r.bindViewProjTransform(i, o.viewProjectionTransform), i.setUniformMatrix3fv(\"uTransformNormal_ViewFromGlobal\", o.transformNormal_ViewFromGlobal), i.setUniformMatrix4fv(\"uProj\", t.camera.projectionMatrix), i.setUniform2f(\"uDepthBias\", p, f), i.setUniform2f(\"uPixelToNDC\", 2 / t.camera.fullViewport[2], 2 / t.camera.fullViewport[3]), i.setUniform2f(\"uNDCToPixel\", t.camera.fullViewport[2] / 2, t.camera.fullViewport[3] / 2), i.setUniform1f(\"uDistanceFalloffFactor\", o.distanceFalloffFactor), i.setUniform2f(\"uViewportDimInv\", 1 / t.camera.fullViewport[2], 1 / t.camera.fullViewport[3]), i.setUniform1f(\"uPixelRatio\", t.camera.pixelRatio || 1);\n  }\n\n  initializeProgram(e) {\n    const r = h.shader.get(),\n          i = this.configuration,\n          o = r.build({\n      slicePlaneEnabled: i.slicePlaneEnabled,\n      sliceHighlightDisabled: !1,\n      sliceEnabledForVertexPrograms: !1,\n      silhouette: i.silhouette,\n      legacy: i.legacy,\n      antialiasing: i.antialiasing,\n      mode: i.mode,\n      doublePrecisionRequiresObfuscation: i.doublePrecisionRequiresObfuscation,\n      multipassTerrainEnabled: i.multipassTerrainEnabled,\n      cullAboveGround: i.cullAboveGround\n    });\n    return new s(e.rctx, o, l);\n  }\n\n  initializePipeline(e) {\n    const r = e.rctx.capabilities.blendMinMax;\n    return c(r ? {\n      blending: u(1, 1, 0, 1, 32774, r.MAX),\n      depthTest: {\n        func: 515\n      },\n      colorWrite: d\n    } : {\n      depthTest: {\n        func: 515\n      },\n      depthWrite: m,\n      colorWrite: d\n    });\n  }\n\n}\n\nh.shader = new i(n, () => import(\"../../shaders/sources/edgeRenderer/EdgeShaderProgram.glsl.js\")), function (r) {\n  class i extends a {\n    constructor() {\n      super(...arguments), this.slicePlaneEnabled = !1, this.silhouette = !1, this.legacy = !1, this.antialiasing = !1, this.mode = 0, this.doublePrecisionRequiresObfuscation = !1, this.multipassTerrainEnabled = !1, this.cullAboveGround = !1;\n    }\n\n  }\n\n  e([t()], i.prototype, \"slicePlaneEnabled\", void 0), e([t()], i.prototype, \"silhouette\", void 0), e([t()], i.prototype, \"legacy\", void 0), e([t()], i.prototype, \"antialiasing\", void 0), e([t({\n    count: 3\n  })], i.prototype, \"mode\", void 0), e([t()], i.prototype, \"doublePrecisionRequiresObfuscation\", void 0), e([t()], i.prototype, \"multipassTerrainEnabled\", void 0), e([t()], i.prototype, \"cullAboveGround\", void 0), r.Configuration = i;\n}(h || (h = {}));\nexport { h as EdgeShaderTechnique };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/webgl-engine/lib/edgeRendering/EdgeShaderTechnique.js"],"names":["_","e","VertexPosition","r","ReloadableShaderModule","i","ShaderTechnique","o","parameter","t","ShaderTechniqueConfiguration","a","Program","s","EdgeShaderAttributeLocations","l","E","n","makePipelineState","c","separateBlendingParams","u","defaultColorWriteParams","d","defaultDepthWriteParams","m","f","p","h","bindPass","program","edgeRenderParameters","bindParameters","bindViewProjTransform","viewProjectionTransform","setUniformMatrix3fv","transformNormal_ViewFromGlobal","setUniformMatrix4fv","camera","projectionMatrix","setUniform2f","fullViewport","setUniform1f","distanceFalloffFactor","pixelRatio","initializeProgram","shader","get","configuration","build","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","silhouette","legacy","antialiasing","mode","doublePrecisionRequiresObfuscation","multipassTerrainEnabled","cullAboveGround","rctx","initializePipeline","capabilities","blendMinMax","blending","MAX","depthTest","func","colorWrite","depthWrite","constructor","arguments","prototype","count","Configuration","EdgeShaderTechnique"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,oCAAlB;AAAuD,SAAOC,cAAc,IAAIC,CAAzB,QAA+B,4DAA/B;AAA4F,SAAOC,sBAAsB,IAAIC,CAAjC,QAAuC,sDAAvC;AAA8F,SAAOC,eAAe,IAAIC,CAA1B,QAAgC,+CAAhC;AAAgF,SAAOC,SAAS,IAAIC,CAApB,EAAsBC,4BAA4B,IAAIC,CAAtD,QAA4D,4DAA5D;AAAyH,SAAOC,OAAO,IAAIC,CAAlB,QAAwB,eAAxB;AAAwC,SAAOC,4BAA4B,IAAIC,CAAvC,QAA6C,oBAA7C;AAAkE,SAAOC,CAAC,IAAIC,CAAZ,QAAkB,iDAAlB;AAAoE,SAAOC,iBAAiB,IAAIC,CAA5B,EAA8BC,sBAAsB,IAAIC,CAAxD,EAA0DC,uBAAuB,IAAIC,CAArF,EAAuFC,uBAAuB,IAAIC,CAAlH,QAAwH,kCAAxH;AAA2J,MAAMC,CAAC,GAAC,CAAC,IAAT;AAAA,MAAcC,CAAC,GAAC,EAAhB;;AAAmB,MAAMC,CAAN,SAAgBrB,CAAhB,CAAiB;AAACsB,EAAAA,QAAQ,CAAC5B,CAAD,EAAG;AAAC,UAAMI,CAAC,GAAC,KAAKyB,OAAb;AAAA,UAAqB;AAACC,MAAAA,oBAAoB,EAACxB,CAAtB;AAAwByB,MAAAA,cAAc,EAACvB;AAAvC,QAA0CR,CAA/D;AAAiEE,IAAAA,CAAC,CAAC8B,qBAAF,CAAwB5B,CAAxB,EAA0BE,CAAC,CAAC2B,uBAA5B,GAAqD7B,CAAC,CAAC8B,mBAAF,CAAsB,iCAAtB,EAAwD5B,CAAC,CAAC6B,8BAA1D,CAArD,EAA+I/B,CAAC,CAACgC,mBAAF,CAAsB,OAAtB,EAA8B5B,CAAC,CAAC6B,MAAF,CAASC,gBAAvC,CAA/I,EAAwMlC,CAAC,CAACmC,YAAF,CAAe,YAAf,EAA4Bb,CAA5B,EAA8BD,CAA9B,CAAxM,EAAyOrB,CAAC,CAACmC,YAAF,CAAe,aAAf,EAA6B,IAAE/B,CAAC,CAAC6B,MAAF,CAASG,YAAT,CAAsB,CAAtB,CAA/B,EAAwD,IAAEhC,CAAC,CAAC6B,MAAF,CAASG,YAAT,CAAsB,CAAtB,CAA1D,CAAzO,EAA6TpC,CAAC,CAACmC,YAAF,CAAe,aAAf,EAA6B/B,CAAC,CAAC6B,MAAF,CAASG,YAAT,CAAsB,CAAtB,IAAyB,CAAtD,EAAwDhC,CAAC,CAAC6B,MAAF,CAASG,YAAT,CAAsB,CAAtB,IAAyB,CAAjF,CAA7T,EAAiZpC,CAAC,CAACqC,YAAF,CAAe,wBAAf,EAAwCnC,CAAC,CAACoC,qBAA1C,CAAjZ,EAAkdtC,CAAC,CAACmC,YAAF,CAAe,iBAAf,EAAiC,IAAE/B,CAAC,CAAC6B,MAAF,CAASG,YAAT,CAAsB,CAAtB,CAAnC,EAA4D,IAAEhC,CAAC,CAAC6B,MAAF,CAASG,YAAT,CAAsB,CAAtB,CAA9D,CAAld,EAA0iBpC,CAAC,CAACqC,YAAF,CAAe,aAAf,EAA6BjC,CAAC,CAAC6B,MAAF,CAASM,UAAT,IAAqB,CAAlD,CAA1iB;AAA+lB;;AAAAC,EAAAA,iBAAiB,CAAC5C,CAAD,EAAG;AAAC,UAAME,CAAC,GAACyB,CAAC,CAACkB,MAAF,CAASC,GAAT,EAAR;AAAA,UAAuB1C,CAAC,GAAC,KAAK2C,aAA9B;AAAA,UAA4CzC,CAAC,GAACJ,CAAC,CAAC8C,KAAF,CAAQ;AAACC,MAAAA,iBAAiB,EAAC7C,CAAC,CAAC6C,iBAArB;AAAuCC,MAAAA,sBAAsB,EAAC,CAAC,CAA/D;AAAiEC,MAAAA,6BAA6B,EAAC,CAAC,CAAhG;AAAkGC,MAAAA,UAAU,EAAChD,CAAC,CAACgD,UAA/G;AAA0HC,MAAAA,MAAM,EAACjD,CAAC,CAACiD,MAAnI;AAA0IC,MAAAA,YAAY,EAAClD,CAAC,CAACkD,YAAzJ;AAAsKC,MAAAA,IAAI,EAACnD,CAAC,CAACmD,IAA7K;AAAkLC,MAAAA,kCAAkC,EAACpD,CAAC,CAACoD,kCAAvN;AAA0PC,MAAAA,uBAAuB,EAACrD,CAAC,CAACqD,uBAApR;AAA4SC,MAAAA,eAAe,EAACtD,CAAC,CAACsD;AAA9T,KAAR,CAA9C;AAAsY,WAAO,IAAI9C,CAAJ,CAAMZ,CAAC,CAAC2D,IAAR,EAAarD,CAAb,EAAeQ,CAAf,CAAP;AAAyB;;AAAA8C,EAAAA,kBAAkB,CAAC5D,CAAD,EAAG;AAAC,UAAME,CAAC,GAACF,CAAC,CAAC2D,IAAF,CAAOE,YAAP,CAAoBC,WAA5B;AAAwC,WAAO5C,CAAC,CAAChB,CAAC,GAAC;AAAC6D,MAAAA,QAAQ,EAAC3C,CAAC,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,KAAT,EAAelB,CAAC,CAAC8D,GAAjB,CAAX;AAAiCC,MAAAA,SAAS,EAAC;AAACC,QAAAA,IAAI,EAAC;AAAN,OAA3C;AAAsDC,MAAAA,UAAU,EAAC7C;AAAjE,KAAD,GAAqE;AAAC2C,MAAAA,SAAS,EAAC;AAACC,QAAAA,IAAI,EAAC;AAAN,OAAX;AAAsBE,MAAAA,UAAU,EAAC5C,CAAjC;AAAmC2C,MAAAA,UAAU,EAAC7C;AAA9C,KAAvE,CAAR;AAAiI;;AAAhyC;;AAAiyCK,CAAC,CAACkB,MAAF,GAAS,IAAIzC,CAAJ,CAAMY,CAAN,EAAS,MAAI,OAAO,8DAAP,CAAb,CAAT,EAA+F,UAASd,CAAT,EAAW;AAAC,QAAME,CAAN,SAAgBM,CAAhB,CAAiB;AAAC2D,IAAAA,WAAW,GAAE;AAAC,YAAM,GAAGC,SAAT,GAAoB,KAAKrB,iBAAL,GAAuB,CAAC,CAA5C,EAA8C,KAAKG,UAAL,GAAgB,CAAC,CAA/D,EAAiE,KAAKC,MAAL,GAAY,CAAC,CAA9E,EAAgF,KAAKC,YAAL,GAAkB,CAAC,CAAnG,EAAqG,KAAKC,IAAL,GAAU,CAA/G,EAAiH,KAAKC,kCAAL,GAAwC,CAAC,CAA1J,EAA4J,KAAKC,uBAAL,GAA6B,CAAC,CAA1L,EAA4L,KAAKC,eAAL,GAAqB,CAAC,CAAlN;AAAoN;;AAAnO;;AAAoO1D,EAAAA,CAAC,CAAC,CAACQ,CAAC,EAAF,CAAD,EAAOJ,CAAC,CAACmE,SAAT,EAAmB,mBAAnB,EAAuC,KAAK,CAA5C,CAAD,EAAgDvE,CAAC,CAAC,CAACQ,CAAC,EAAF,CAAD,EAAOJ,CAAC,CAACmE,SAAT,EAAmB,YAAnB,EAAgC,KAAK,CAArC,CAAjD,EAAyFvE,CAAC,CAAC,CAACQ,CAAC,EAAF,CAAD,EAAOJ,CAAC,CAACmE,SAAT,EAAmB,QAAnB,EAA4B,KAAK,CAAjC,CAA1F,EAA8HvE,CAAC,CAAC,CAACQ,CAAC,EAAF,CAAD,EAAOJ,CAAC,CAACmE,SAAT,EAAmB,cAAnB,EAAkC,KAAK,CAAvC,CAA/H,EAAyKvE,CAAC,CAAC,CAACQ,CAAC,CAAC;AAACgE,IAAAA,KAAK,EAAC;AAAP,GAAD,CAAF,CAAD,EAAgBpE,CAAC,CAACmE,SAAlB,EAA4B,MAA5B,EAAmC,KAAK,CAAxC,CAA1K,EAAqNvE,CAAC,CAAC,CAACQ,CAAC,EAAF,CAAD,EAAOJ,CAAC,CAACmE,SAAT,EAAmB,oCAAnB,EAAwD,KAAK,CAA7D,CAAtN,EAAsRvE,CAAC,CAAC,CAACQ,CAAC,EAAF,CAAD,EAAOJ,CAAC,CAACmE,SAAT,EAAmB,yBAAnB,EAA6C,KAAK,CAAlD,CAAvR,EAA4UvE,CAAC,CAAC,CAACQ,CAAC,EAAF,CAAD,EAAOJ,CAAC,CAACmE,SAAT,EAAmB,iBAAnB,EAAqC,KAAK,CAA1C,CAA7U,EAA0XrE,CAAC,CAACuE,aAAF,GAAgBrE,CAA1Y;AAA4Y,CAA7oB,CAA8oBuB,CAAC,KAAGA,CAAC,GAAC,EAAL,CAA/oB,CAA/F;AAAwvB,SAAOA,CAAC,IAAI+C,mBAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import{VertexPosition as r}from\"../../core/shaderLibrary/attributes/VertexPosition.glsl.js\";import{ReloadableShaderModule as i}from\"../../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../../core/shaderTechnique/ShaderTechnique.js\";import{parameter as t,ShaderTechniqueConfiguration as a}from\"../../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Program as s}from\"../Program.js\";import{EdgeShaderAttributeLocations as l}from\"./bufferLayouts.js\";import{E as n}from\"../../../../../chunks/EdgeShaderProgram.glsl.js\";import{makePipelineState as c,separateBlendingParams as u,defaultColorWriteParams as d,defaultDepthWriteParams as m}from\"../../../../webgl/renderState.js\";const f=-4e-4,p=.5;class h extends o{bindPass(e){const i=this.program,{edgeRenderParameters:o,bindParameters:t}=e;r.bindViewProjTransform(i,o.viewProjectionTransform),i.setUniformMatrix3fv(\"uTransformNormal_ViewFromGlobal\",o.transformNormal_ViewFromGlobal),i.setUniformMatrix4fv(\"uProj\",t.camera.projectionMatrix),i.setUniform2f(\"uDepthBias\",p,f),i.setUniform2f(\"uPixelToNDC\",2/t.camera.fullViewport[2],2/t.camera.fullViewport[3]),i.setUniform2f(\"uNDCToPixel\",t.camera.fullViewport[2]/2,t.camera.fullViewport[3]/2),i.setUniform1f(\"uDistanceFalloffFactor\",o.distanceFalloffFactor),i.setUniform2f(\"uViewportDimInv\",1/t.camera.fullViewport[2],1/t.camera.fullViewport[3]),i.setUniform1f(\"uPixelRatio\",t.camera.pixelRatio||1)}initializeProgram(e){const r=h.shader.get(),i=this.configuration,o=r.build({slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,silhouette:i.silhouette,legacy:i.legacy,antialiasing:i.antialiasing,mode:i.mode,doublePrecisionRequiresObfuscation:i.doublePrecisionRequiresObfuscation,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new s(e.rctx,o,l)}initializePipeline(e){const r=e.rctx.capabilities.blendMinMax;return c(r?{blending:u(1,1,0,1,32774,r.MAX),depthTest:{func:515},colorWrite:d}:{depthTest:{func:515},depthWrite:m,colorWrite:d})}}h.shader=new i(n,(()=>import(\"../../shaders/sources/edgeRenderer/EdgeShaderProgram.glsl.js\"))),function(r){class i extends a{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.silhouette=!1,this.legacy=!1,this.antialiasing=!1,this.mode=0,this.doublePrecisionRequiresObfuscation=!1,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([t()],i.prototype,\"slicePlaneEnabled\",void 0),e([t()],i.prototype,\"silhouette\",void 0),e([t()],i.prototype,\"legacy\",void 0),e([t()],i.prototype,\"antialiasing\",void 0),e([t({count:3})],i.prototype,\"mode\",void 0),e([t()],i.prototype,\"doublePrecisionRequiresObfuscation\",void 0),e([t()],i.prototype,\"multipassTerrainEnabled\",void 0),e([t()],i.prototype,\"cullAboveGround\",void 0),r.Configuration=i}(h||(h={}));export{h as EdgeShaderTechnique};\n"]},"metadata":{},"sourceType":"module"}