{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isNone as t, unwrap as e } from \"../../../../../../core/maybe.js\";\nimport { dist as s, sub as n, normalize as i } from \"./util.js\";\n\nfunction r(t, e) {\n  return t[e + 1];\n}\n\nfunction h(t) {\n  return t.length - 1;\n}\n\nfunction a(t) {\n  let e = 0;\n\n  for (let s = 0; s < h(t); s++) e += d(t, s);\n\n  return e;\n}\n\nfunction d(t, e, s = 1) {\n  const [n, i] = r(t, e);\n  return Math.sqrt(n * n + i * i) * s;\n}\n\nclass c {\n  constructor(t, e, s, n, i) {\n    this._segments = t, this._index = e, this._distance = s, this._xStart = n, this._yStart = i, this._done = !1;\n  }\n\n  static create(t) {\n    return new c(t, 0, 0, t[0][0], t[0][1]);\n  }\n\n  clone() {\n    return new c(this._segments, this._index, this._distance, this.xStart, this.yStart);\n  }\n\n  equals(t) {\n    return this._index === t._index || t._index === this._index - 1 && (0 === this._distance || 1 === t._distance) || t._index === this._index + 1 && (1 === this._distance || 0 === t._distance);\n  }\n\n  leq(t) {\n    return this._index < t._index || this._index === t._index && this._distance <= t._distance;\n  }\n\n  geq(t) {\n    return this._index > t._index || this._index === t._index && this._distance >= t._distance;\n  }\n\n  get _segment() {\n    return this._segments[this._index + 1];\n  }\n\n  get angle() {\n    const t = this.dy,\n          e = (0 * t + -1 * -this.dx) / (1 * this.length);\n    let s = Math.acos(e);\n    return t > 0 && (s = 2 * Math.PI - s), s;\n  }\n\n  get xStart() {\n    return this._xStart;\n  }\n\n  get yStart() {\n    return this._yStart;\n  }\n\n  get x() {\n    return this.xStart + this.distance * this.dx;\n  }\n\n  get y() {\n    return this.yStart + this.distance * this.dy;\n  }\n\n  get dx() {\n    return this._segment[0];\n  }\n\n  get dy() {\n    return this._segment[1];\n  }\n\n  get xMidpoint() {\n    return this.xStart + .5 * this.dx;\n  }\n\n  get yMidpoint() {\n    return this.yStart + .5 * this.dy;\n  }\n\n  get xEnd() {\n    return this.xStart + this.dx;\n  }\n\n  get yEnd() {\n    return this.yStart + this.dy;\n  }\n\n  get length() {\n    const {\n      dx: t,\n      dy: e\n    } = this;\n    return Math.sqrt(t * t + e * e);\n  }\n\n  get remainingLength() {\n    return this.length * (1 - this._distance);\n  }\n\n  get backwardLength() {\n    return this.length * this._distance;\n  }\n\n  get distance() {\n    return this._distance;\n  }\n\n  get done() {\n    return this._done;\n  }\n\n  hasPrev() {\n    return this._index - 1 >= 0;\n  }\n\n  hasNext() {\n    return this._index + 1 < h(this._segments);\n  }\n\n  next() {\n    return this.hasNext() ? (this._xStart += this.dx, this._yStart += this.dy, this._distance = 0, this._index += 1, this) : null;\n  }\n\n  prev() {\n    return this.hasPrev() ? (this._index -= 1, this._xStart -= this.dx, this._yStart -= this.dy, this._distance = 1, this) : (this._done = !0, null);\n  }\n\n  _seekBackwards(t, e) {\n    const s = this.backwardLength;\n    if (t <= s) return this._distance = (s - t) / this.length, this;\n    let n = this.backwardLength;\n\n    for (; this.prev();) {\n      if (n + this.length > t) return this._seekBackwards(t - n);\n      n += this.length;\n    }\n\n    return this._distance = 0, e ? this : null;\n  }\n\n  seek(t, e = !1) {\n    if (t < 0) return this._seekBackwards(Math.abs(t), e);\n    if (t <= this.remainingLength) return this._distance = (this.backwardLength + t) / this.length, this;\n    let s = this.remainingLength;\n\n    for (; this.next();) {\n      if (s + this.length > t) return this.seek(t - s, e);\n      s += this.length;\n    }\n\n    return this._distance = 1, e ? this : null;\n  }\n\n}\n\nfunction u(t, e, s) {\n  const n = a(t),\n        i = c.create(t),\n        r = n / 2,\n        h = (n - e) / 2,\n        d = Math.floor(h / e),\n        u = r - d * e;\n  i.seek(u);\n\n  for (let a = -d; a <= d; a++) i.x < 512 && i.x >= 0 && i.y < 512 && i.y >= 0 && s(i.clone(), a, r + a * e, n), i.seek(e);\n}\n\nfunction o(t, e, s) {\n  _(s, e, a(t), c.create(t), 0);\n}\n\nfunction _(s, n, i, r, h) {\n  if (i < n) return;\n  const a = r.clone().seek(i / 2);\n  if (t(a)) return;\n  s(a.clone(), i, h), i = (i - n) / 2;\n  const d = e(a.seek(n / 2));\n  _(s, n, i, r, h + 1), _(s, n, i, d, h + 1);\n}\n\nfunction l(t, e) {\n  const s = e;\n\n  for (let n = 0; n < t.length; n++) {\n    let e = t[n];\n    const i = [];\n    i.push(e[0]);\n\n    for (let t = 1; t < e.length; t++) {\n      let [s, n] = i[t - 1];\n      s += e[t][0], n += e[t][1], i.push([s, n]);\n    }\n\n    g(i, s);\n    const r = [];\n    r.push(i[0]);\n\n    for (let t = 1; t < i.length; t++) {\n      const [e, s] = i[t - 1],\n            [n, h] = i[t],\n            a = Math.round(n - e),\n            d = Math.round(h - s);\n      r.push([a, d]);\n    }\n\n    t[n] = r, e = r;\n  }\n\n  return t;\n}\n\nfunction g(t, e) {\n  const r = 1e-6;\n  if (e <= 0) return;\n  const h = t.length;\n  if (h < 3) return;\n  const a = [];\n  let d = 0;\n  a.push(0);\n\n  for (let n = 1; n < h; n++) d += s(t[n], t[n - 1]), a.push(d);\n\n  e = Math.min(e, .2 * d);\n  const c = [];\n  c.push(t[0][0]), c.push(t[0][1]);\n\n  const u = t[h - 1][0],\n        o = t[h - 1][1],\n        _ = n([0, 0], t[0], t[1]);\n\n  i(_), t[0][0] += e * _[0], t[0][1] += e * _[1], n(_, t[h - 1], t[h - 2]), i(_), t[h - 1][0] += e * _[0], t[h - 1][1] += e * _[1];\n\n  for (let s = 1; s < h; s++) a[s] += e;\n\n  a[h - 1] += e;\n  const l = .5 * e;\n\n  for (let s = 1; s < h - 1; s++) {\n    let n = 0,\n        i = 0,\n        d = 0;\n\n    for (let h = s - 1; h >= 0 && !(a[h + 1] < a[s] - l); h--) {\n      const c = l + a[h + 1] - a[s],\n            u = a[h + 1] - a[h],\n            o = a[s] - a[h] < l ? 1 : c / u;\n      if (Math.abs(o) < r) break;\n\n      const _ = o * o,\n            g = o * c - .5 * _ * u,\n            x = o * u / e,\n            f = t[h + 1],\n            y = t[h][0] - f[0],\n            p = t[h][1] - f[1];\n\n      n += x / g * (f[0] * o * c + .5 * _ * (c * y - u * f[0]) - _ * o * u * y / 3), i += x / g * (f[1] * o * c + .5 * _ * (c * p - u * f[1]) - _ * o * u * p / 3), d += x;\n    }\n\n    for (let c = s + 1; c < h && !(a[c - 1] > a[s] + l); c++) {\n      const h = l - a[c - 1] + a[s],\n            u = a[c] - a[c - 1],\n            o = a[c] - a[s] < l ? 1 : h / u;\n      if (Math.abs(o) < r) break;\n\n      const _ = o * o,\n            g = o * h - .5 * _ * u,\n            x = o * u / e,\n            f = t[c - 1],\n            y = t[c][0] - f[0],\n            p = t[c][1] - f[1];\n\n      n += x / g * (f[0] * o * h + .5 * _ * (h * y - u * f[0]) - _ * o * u * y / 3), i += x / g * (f[1] * o * h + .5 * _ * (h * p - u * f[1]) - _ * o * u * p / 3), d += x;\n    }\n\n    c.push(n / d), c.push(i / d);\n  }\n\n  c.push(u), c.push(o);\n\n  for (let s = 0, n = 0; s < h; s++) t[s][0] = c[n++], t[s][1] = c[n++];\n}\n\nexport { c as SegmentCursor, u as pathDivide, a as pathLength, o as pathSubdivide, r as segmentAt, h as segmentCount, d as segmentLength, l as smoothPaths };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/segmentUtils.js"],"names":["isNone","t","unwrap","e","dist","s","sub","n","normalize","i","r","h","length","a","d","Math","sqrt","c","constructor","_segments","_index","_distance","_xStart","_yStart","_done","create","clone","xStart","yStart","equals","leq","geq","_segment","angle","dy","dx","acos","PI","x","distance","y","xMidpoint","yMidpoint","xEnd","yEnd","remainingLength","backwardLength","done","hasPrev","hasNext","next","prev","_seekBackwards","seek","abs","u","floor","o","_","l","push","g","round","min","f","p","SegmentCursor","pathDivide","pathLength","pathSubdivide","segmentAt","segmentCount","segmentLength","smoothPaths"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,MAAM,IAAIC,CAAjB,EAAmBC,MAAM,IAAIC,CAA7B,QAAmC,iCAAnC;AAAqE,SAAOC,IAAI,IAAIC,CAAf,EAAiBC,GAAG,IAAIC,CAAxB,EAA0BC,SAAS,IAAIC,CAAvC,QAA6C,WAA7C;;AAAyD,SAASC,CAAT,CAAWT,CAAX,EAAaE,CAAb,EAAe;AAAC,SAAOF,CAAC,CAACE,CAAC,GAAC,CAAH,CAAR;AAAc;;AAAA,SAASQ,CAAT,CAAWV,CAAX,EAAa;AAAC,SAAOA,CAAC,CAACW,MAAF,GAAS,CAAhB;AAAkB;;AAAA,SAASC,CAAT,CAAWZ,CAAX,EAAa;AAAC,MAAIE,CAAC,GAAC,CAAN;;AAAQ,OAAI,IAAIE,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACM,CAAC,CAACV,CAAD,CAAf,EAAmBI,CAAC,EAApB,EAAuBF,CAAC,IAAEW,CAAC,CAACb,CAAD,EAAGI,CAAH,CAAJ;;AAAU,SAAOF,CAAP;AAAS;;AAAA,SAASW,CAAT,CAAWb,CAAX,EAAaE,CAAb,EAAeE,CAAC,GAAC,CAAjB,EAAmB;AAAC,QAAK,CAACE,CAAD,EAAGE,CAAH,IAAMC,CAAC,CAACT,CAAD,EAAGE,CAAH,CAAZ;AAAkB,SAAOY,IAAI,CAACC,IAAL,CAAUT,CAAC,GAACA,CAAF,GAAIE,CAAC,GAACA,CAAhB,IAAmBJ,CAA1B;AAA4B;;AAAA,MAAMY,CAAN,CAAO;AAACC,EAAAA,WAAW,CAACjB,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAOE,CAAP,EAASE,CAAT,EAAW;AAAC,SAAKU,SAAL,GAAelB,CAAf,EAAiB,KAAKmB,MAAL,GAAYjB,CAA7B,EAA+B,KAAKkB,SAAL,GAAehB,CAA9C,EAAgD,KAAKiB,OAAL,GAAaf,CAA7D,EAA+D,KAAKgB,OAAL,GAAad,CAA5E,EAA8E,KAAKe,KAAL,GAAW,CAAC,CAA1F;AAA4F;;AAAa,SAANC,MAAM,CAACxB,CAAD,EAAG;AAAC,WAAO,IAAIgB,CAAJ,CAAMhB,CAAN,EAAQ,CAAR,EAAU,CAAV,EAAYA,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,CAAZ,EAAoBA,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,CAApB,CAAP;AAAoC;;AAAAyB,EAAAA,KAAK,GAAE;AAAC,WAAO,IAAIT,CAAJ,CAAM,KAAKE,SAAX,EAAqB,KAAKC,MAA1B,EAAiC,KAAKC,SAAtC,EAAgD,KAAKM,MAArD,EAA4D,KAAKC,MAAjE,CAAP;AAAgF;;AAAAC,EAAAA,MAAM,CAAC5B,CAAD,EAAG;AAAC,WAAO,KAAKmB,MAAL,KAAcnB,CAAC,CAACmB,MAAhB,IAAwBnB,CAAC,CAACmB,MAAF,KAAW,KAAKA,MAAL,GAAY,CAAvB,KAA2B,MAAI,KAAKC,SAAT,IAAoB,MAAIpB,CAAC,CAACoB,SAArD,CAAxB,IAAyFpB,CAAC,CAACmB,MAAF,KAAW,KAAKA,MAAL,GAAY,CAAvB,KAA2B,MAAI,KAAKC,SAAT,IAAoB,MAAIpB,CAAC,CAACoB,SAArD,CAAhG;AAAgK;;AAAAS,EAAAA,GAAG,CAAC7B,CAAD,EAAG;AAAC,WAAO,KAAKmB,MAAL,GAAYnB,CAAC,CAACmB,MAAd,IAAsB,KAAKA,MAAL,KAAcnB,CAAC,CAACmB,MAAhB,IAAwB,KAAKC,SAAL,IAAgBpB,CAAC,CAACoB,SAAvE;AAAiF;;AAAAU,EAAAA,GAAG,CAAC9B,CAAD,EAAG;AAAC,WAAO,KAAKmB,MAAL,GAAYnB,CAAC,CAACmB,MAAd,IAAsB,KAAKA,MAAL,KAAcnB,CAAC,CAACmB,MAAhB,IAAwB,KAAKC,SAAL,IAAgBpB,CAAC,CAACoB,SAAvE;AAAiF;;AAAY,MAARW,QAAQ,GAAE;AAAC,WAAO,KAAKb,SAAL,CAAe,KAAKC,MAAL,GAAY,CAA3B,CAAP;AAAqC;;AAAS,MAALa,KAAK,GAAE;AAAC,UAAMhC,CAAC,GAAC,KAAKiC,EAAb;AAAA,UAAgB/B,CAAC,GAAC,CAAC,IAAEF,CAAF,GAAI,CAAC,CAAD,GAAG,CAAC,KAAKkC,EAAd,KAAmB,IAAE,KAAKvB,MAA1B,CAAlB;AAAoD,QAAIP,CAAC,GAACU,IAAI,CAACqB,IAAL,CAAUjC,CAAV,CAAN;AAAmB,WAAOF,CAAC,GAAC,CAAF,KAAMI,CAAC,GAAC,IAAEU,IAAI,CAACsB,EAAP,GAAUhC,CAAlB,GAAqBA,CAA5B;AAA8B;;AAAU,MAANsB,MAAM,GAAE;AAAC,WAAO,KAAKL,OAAZ;AAAoB;;AAAU,MAANM,MAAM,GAAE;AAAC,WAAO,KAAKL,OAAZ;AAAoB;;AAAK,MAADe,CAAC,GAAE;AAAC,WAAO,KAAKX,MAAL,GAAY,KAAKY,QAAL,GAAc,KAAKJ,EAAtC;AAAyC;;AAAK,MAADK,CAAC,GAAE;AAAC,WAAO,KAAKZ,MAAL,GAAY,KAAKW,QAAL,GAAc,KAAKL,EAAtC;AAAyC;;AAAM,MAAFC,EAAE,GAAE;AAAC,WAAO,KAAKH,QAAL,CAAc,CAAd,CAAP;AAAwB;;AAAM,MAAFE,EAAE,GAAE;AAAC,WAAO,KAAKF,QAAL,CAAc,CAAd,CAAP;AAAwB;;AAAa,MAATS,SAAS,GAAE;AAAC,WAAO,KAAKd,MAAL,GAAY,KAAG,KAAKQ,EAA3B;AAA8B;;AAAa,MAATO,SAAS,GAAE;AAAC,WAAO,KAAKd,MAAL,GAAY,KAAG,KAAKM,EAA3B;AAA8B;;AAAQ,MAAJS,IAAI,GAAE;AAAC,WAAO,KAAKhB,MAAL,GAAY,KAAKQ,EAAxB;AAA2B;;AAAQ,MAAJS,IAAI,GAAE;AAAC,WAAO,KAAKhB,MAAL,GAAY,KAAKM,EAAxB;AAA2B;;AAAU,MAANtB,MAAM,GAAE;AAAC,UAAK;AAACuB,MAAAA,EAAE,EAAClC,CAAJ;AAAMiC,MAAAA,EAAE,EAAC/B;AAAT,QAAY,IAAjB;AAAsB,WAAOY,IAAI,CAACC,IAAL,CAAUf,CAAC,GAACA,CAAF,GAAIE,CAAC,GAACA,CAAhB,CAAP;AAA0B;;AAAmB,MAAf0C,eAAe,GAAE;AAAC,WAAO,KAAKjC,MAAL,IAAa,IAAE,KAAKS,SAApB,CAAP;AAAsC;;AAAkB,MAAdyB,cAAc,GAAE;AAAC,WAAO,KAAKlC,MAAL,GAAY,KAAKS,SAAxB;AAAkC;;AAAY,MAARkB,QAAQ,GAAE;AAAC,WAAO,KAAKlB,SAAZ;AAAsB;;AAAQ,MAAJ0B,IAAI,GAAE;AAAC,WAAO,KAAKvB,KAAZ;AAAkB;;AAAAwB,EAAAA,OAAO,GAAE;AAAC,WAAO,KAAK5B,MAAL,GAAY,CAAZ,IAAe,CAAtB;AAAwB;;AAAA6B,EAAAA,OAAO,GAAE;AAAC,WAAO,KAAK7B,MAAL,GAAY,CAAZ,GAAcT,CAAC,CAAC,KAAKQ,SAAN,CAAtB;AAAuC;;AAAA+B,EAAAA,IAAI,GAAE;AAAC,WAAO,KAAKD,OAAL,MAAgB,KAAK3B,OAAL,IAAc,KAAKa,EAAnB,EAAsB,KAAKZ,OAAL,IAAc,KAAKW,EAAzC,EAA4C,KAAKb,SAAL,GAAe,CAA3D,EAA6D,KAAKD,MAAL,IAAa,CAA1E,EAA4E,IAA5F,IAAkG,IAAzG;AAA8G;;AAAA+B,EAAAA,IAAI,GAAE;AAAC,WAAO,KAAKH,OAAL,MAAgB,KAAK5B,MAAL,IAAa,CAAb,EAAe,KAAKE,OAAL,IAAc,KAAKa,EAAlC,EAAqC,KAAKZ,OAAL,IAAc,KAAKW,EAAxD,EAA2D,KAAKb,SAAL,GAAe,CAA1E,EAA4E,IAA5F,KAAmG,KAAKG,KAAL,GAAW,CAAC,CAAZ,EAAc,IAAjH,CAAP;AAA8H;;AAAA4B,EAAAA,cAAc,CAACnD,CAAD,EAAGE,CAAH,EAAK;AAAC,UAAME,CAAC,GAAC,KAAKyC,cAAb;AAA4B,QAAG7C,CAAC,IAAEI,CAAN,EAAQ,OAAO,KAAKgB,SAAL,GAAe,CAAChB,CAAC,GAACJ,CAAH,IAAM,KAAKW,MAA1B,EAAiC,IAAxC;AAA6C,QAAIL,CAAC,GAAC,KAAKuC,cAAX;;AAA0B,WAAK,KAAKK,IAAL,EAAL,GAAkB;AAAC,UAAG5C,CAAC,GAAC,KAAKK,MAAP,GAAcX,CAAjB,EAAmB,OAAO,KAAKmD,cAAL,CAAoBnD,CAAC,GAACM,CAAtB,CAAP;AAAgCA,MAAAA,CAAC,IAAE,KAAKK,MAAR;AAAe;;AAAA,WAAO,KAAKS,SAAL,GAAe,CAAf,EAAiBlB,CAAC,GAAC,IAAD,GAAM,IAA/B;AAAoC;;AAAAkD,EAAAA,IAAI,CAACpD,CAAD,EAAGE,CAAC,GAAC,CAAC,CAAN,EAAQ;AAAC,QAAGF,CAAC,GAAC,CAAL,EAAO,OAAO,KAAKmD,cAAL,CAAoBrC,IAAI,CAACuC,GAAL,CAASrD,CAAT,CAApB,EAAgCE,CAAhC,CAAP;AAA0C,QAAGF,CAAC,IAAE,KAAK4C,eAAX,EAA2B,OAAO,KAAKxB,SAAL,GAAe,CAAC,KAAKyB,cAAL,GAAoB7C,CAArB,IAAwB,KAAKW,MAA5C,EAAmD,IAA1D;AAA+D,QAAIP,CAAC,GAAC,KAAKwC,eAAX;;AAA2B,WAAK,KAAKK,IAAL,EAAL,GAAkB;AAAC,UAAG7C,CAAC,GAAC,KAAKO,MAAP,GAAcX,CAAjB,EAAmB,OAAO,KAAKoD,IAAL,CAAUpD,CAAC,GAACI,CAAZ,EAAcF,CAAd,CAAP;AAAwBE,MAAAA,CAAC,IAAE,KAAKO,MAAR;AAAe;;AAAA,WAAO,KAAKS,SAAL,GAAe,CAAf,EAAiBlB,CAAC,GAAC,IAAD,GAAM,IAA/B;AAAoC;;AAAzuE;;AAA0uE,SAASoD,CAAT,CAAWtD,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiB;AAAC,QAAME,CAAC,GAACM,CAAC,CAACZ,CAAD,CAAT;AAAA,QAAaQ,CAAC,GAACQ,CAAC,CAACQ,MAAF,CAASxB,CAAT,CAAf;AAAA,QAA2BS,CAAC,GAACH,CAAC,GAAC,CAA/B;AAAA,QAAiCI,CAAC,GAAC,CAACJ,CAAC,GAACJ,CAAH,IAAM,CAAzC;AAAA,QAA2CW,CAAC,GAACC,IAAI,CAACyC,KAAL,CAAW7C,CAAC,GAACR,CAAb,CAA7C;AAAA,QAA6DoD,CAAC,GAAC7C,CAAC,GAACI,CAAC,GAACX,CAAnE;AAAqEM,EAAAA,CAAC,CAAC4C,IAAF,CAAOE,CAAP;;AAAU,OAAI,IAAI1C,CAAC,GAAC,CAACC,CAAX,EAAaD,CAAC,IAAEC,CAAhB,EAAkBD,CAAC,EAAnB,EAAsBJ,CAAC,CAAC6B,CAAF,GAAI,GAAJ,IAAS7B,CAAC,CAAC6B,CAAF,IAAK,CAAd,IAAiB7B,CAAC,CAAC+B,CAAF,GAAI,GAArB,IAA0B/B,CAAC,CAAC+B,CAAF,IAAK,CAA/B,IAAkCnC,CAAC,CAACI,CAAC,CAACiB,KAAF,EAAD,EAAWb,CAAX,EAAaH,CAAC,GAACG,CAAC,GAACV,CAAjB,EAAmBI,CAAnB,CAAnC,EAAyDE,CAAC,CAAC4C,IAAF,CAAOlD,CAAP,CAAzD;AAAmE;;AAAA,SAASsD,CAAT,CAAWxD,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiB;AAACqD,EAAAA,CAAC,CAACrD,CAAD,EAAGF,CAAH,EAAKU,CAAC,CAACZ,CAAD,CAAN,EAAUgB,CAAC,CAACQ,MAAF,CAASxB,CAAT,CAAV,EAAsB,CAAtB,CAAD;AAA0B;;AAAA,SAASyD,CAAT,CAAWrD,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiBC,CAAjB,EAAmBC,CAAnB,EAAqB;AAAC,MAAGF,CAAC,GAACF,CAAL,EAAO;AAAO,QAAMM,CAAC,GAACH,CAAC,CAACgB,KAAF,GAAU2B,IAAV,CAAe5C,CAAC,GAAC,CAAjB,CAAR;AAA4B,MAAGR,CAAC,CAACY,CAAD,CAAJ,EAAQ;AAAOR,EAAAA,CAAC,CAACQ,CAAC,CAACa,KAAF,EAAD,EAAWjB,CAAX,EAAaE,CAAb,CAAD,EAAiBF,CAAC,GAAC,CAACA,CAAC,GAACF,CAAH,IAAM,CAAzB;AAA2B,QAAMO,CAAC,GAACX,CAAC,CAACU,CAAC,CAACwC,IAAF,CAAO9C,CAAC,GAAC,CAAT,CAAD,CAAT;AAAuBmD,EAAAA,CAAC,CAACrD,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAOC,CAAP,EAASC,CAAC,GAAC,CAAX,CAAD,EAAe+C,CAAC,CAACrD,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAOK,CAAP,EAASH,CAAC,GAAC,CAAX,CAAhB;AAA8B;;AAAA,SAASgD,CAAT,CAAW1D,CAAX,EAAaE,CAAb,EAAe;AAAC,QAAME,CAAC,GAACF,CAAR;;AAAU,OAAI,IAAII,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACN,CAAC,CAACW,MAAhB,EAAuBL,CAAC,EAAxB,EAA2B;AAAC,QAAIJ,CAAC,GAACF,CAAC,CAACM,CAAD,CAAP;AAAW,UAAME,CAAC,GAAC,EAAR;AAAWA,IAAAA,CAAC,CAACmD,IAAF,CAAOzD,CAAC,CAAC,CAAD,CAAR;;AAAa,SAAI,IAAIF,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACE,CAAC,CAACS,MAAhB,EAAuBX,CAAC,EAAxB,EAA2B;AAAC,UAAG,CAACI,CAAD,EAAGE,CAAH,IAAME,CAAC,CAACR,CAAC,GAAC,CAAH,CAAV;AAAgBI,MAAAA,CAAC,IAAEF,CAAC,CAACF,CAAD,CAAD,CAAK,CAAL,CAAH,EAAWM,CAAC,IAAEJ,CAAC,CAACF,CAAD,CAAD,CAAK,CAAL,CAAd,EAAsBQ,CAAC,CAACmD,IAAF,CAAO,CAACvD,CAAD,EAAGE,CAAH,CAAP,CAAtB;AAAoC;;AAAAsD,IAAAA,CAAC,CAACpD,CAAD,EAAGJ,CAAH,CAAD;AAAO,UAAMK,CAAC,GAAC,EAAR;AAAWA,IAAAA,CAAC,CAACkD,IAAF,CAAOnD,CAAC,CAAC,CAAD,CAAR;;AAAa,SAAI,IAAIR,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACQ,CAAC,CAACG,MAAhB,EAAuBX,CAAC,EAAxB,EAA2B;AAAC,YAAK,CAACE,CAAD,EAAGE,CAAH,IAAMI,CAAC,CAACR,CAAC,GAAC,CAAH,CAAZ;AAAA,YAAkB,CAACM,CAAD,EAAGI,CAAH,IAAMF,CAAC,CAACR,CAAD,CAAzB;AAAA,YAA6BY,CAAC,GAACE,IAAI,CAAC+C,KAAL,CAAWvD,CAAC,GAACJ,CAAb,CAA/B;AAAA,YAA+CW,CAAC,GAACC,IAAI,CAAC+C,KAAL,CAAWnD,CAAC,GAACN,CAAb,CAAjD;AAAiEK,MAAAA,CAAC,CAACkD,IAAF,CAAO,CAAC/C,CAAD,EAAGC,CAAH,CAAP;AAAc;;AAAAb,IAAAA,CAAC,CAACM,CAAD,CAAD,GAAKG,CAAL,EAAOP,CAAC,GAACO,CAAT;AAAW;;AAAA,SAAOT,CAAP;AAAS;;AAAA,SAAS4D,CAAT,CAAW5D,CAAX,EAAaE,CAAb,EAAe;AAAC,QAAMO,CAAC,GAAC,IAAR;AAAa,MAAGP,CAAC,IAAE,CAAN,EAAQ;AAAO,QAAMQ,CAAC,GAACV,CAAC,CAACW,MAAV;AAAiB,MAAGD,CAAC,GAAC,CAAL,EAAO;AAAO,QAAME,CAAC,GAAC,EAAR;AAAW,MAAIC,CAAC,GAAC,CAAN;AAAQD,EAAAA,CAAC,CAAC+C,IAAF,CAAO,CAAP;;AAAU,OAAI,IAAIrD,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACI,CAAd,EAAgBJ,CAAC,EAAjB,EAAoBO,CAAC,IAAET,CAAC,CAACJ,CAAC,CAACM,CAAD,CAAF,EAAMN,CAAC,CAACM,CAAC,GAAC,CAAH,CAAP,CAAJ,EAAkBM,CAAC,CAAC+C,IAAF,CAAO9C,CAAP,CAAlB;;AAA4BX,EAAAA,CAAC,GAACY,IAAI,CAACgD,GAAL,CAAS5D,CAAT,EAAW,KAAGW,CAAd,CAAF;AAAmB,QAAMG,CAAC,GAAC,EAAR;AAAWA,EAAAA,CAAC,CAAC2C,IAAF,CAAO3D,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,CAAP,GAAgBgB,CAAC,CAAC2C,IAAF,CAAO3D,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,CAAP,CAAhB;;AAAgC,QAAMsD,CAAC,GAACtD,CAAC,CAACU,CAAC,GAAC,CAAH,CAAD,CAAO,CAAP,CAAR;AAAA,QAAkB8C,CAAC,GAACxD,CAAC,CAACU,CAAC,GAAC,CAAH,CAAD,CAAO,CAAP,CAApB;AAAA,QAA8B+C,CAAC,GAACnD,CAAC,CAAC,CAAC,CAAD,EAAG,CAAH,CAAD,EAAON,CAAC,CAAC,CAAD,CAAR,EAAYA,CAAC,CAAC,CAAD,CAAb,CAAjC;;AAAmDQ,EAAAA,CAAC,CAACiD,CAAD,CAAD,EAAKzD,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,KAASE,CAAC,GAACuD,CAAC,CAAC,CAAD,CAAjB,EAAqBzD,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,KAASE,CAAC,GAACuD,CAAC,CAAC,CAAD,CAAjC,EAAqCnD,CAAC,CAACmD,CAAD,EAAGzD,CAAC,CAACU,CAAC,GAAC,CAAH,CAAJ,EAAUV,CAAC,CAACU,CAAC,GAAC,CAAH,CAAX,CAAtC,EAAwDF,CAAC,CAACiD,CAAD,CAAzD,EAA6DzD,CAAC,CAACU,CAAC,GAAC,CAAH,CAAD,CAAO,CAAP,KAAWR,CAAC,GAACuD,CAAC,CAAC,CAAD,CAA3E,EAA+EzD,CAAC,CAACU,CAAC,GAAC,CAAH,CAAD,CAAO,CAAP,KAAWR,CAAC,GAACuD,CAAC,CAAC,CAAD,CAA7F;;AAAiG,OAAI,IAAIrD,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACM,CAAd,EAAgBN,CAAC,EAAjB,EAAoBQ,CAAC,CAACR,CAAD,CAAD,IAAMF,CAAN;;AAAQU,EAAAA,CAAC,CAACF,CAAC,GAAC,CAAH,CAAD,IAAQR,CAAR;AAAU,QAAMwD,CAAC,GAAC,KAAGxD,CAAX;;AAAa,OAAI,IAAIE,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACM,CAAC,GAAC,CAAhB,EAAkBN,CAAC,EAAnB,EAAsB;AAAC,QAAIE,CAAC,GAAC,CAAN;AAAA,QAAQE,CAAC,GAAC,CAAV;AAAA,QAAYK,CAAC,GAAC,CAAd;;AAAgB,SAAI,IAAIH,CAAC,GAACN,CAAC,GAAC,CAAZ,EAAcM,CAAC,IAAE,CAAH,IAAM,EAAEE,CAAC,CAACF,CAAC,GAAC,CAAH,CAAD,GAAOE,CAAC,CAACR,CAAD,CAAD,GAAKsD,CAAd,CAApB,EAAqChD,CAAC,EAAtC,EAAyC;AAAC,YAAMM,CAAC,GAAC0C,CAAC,GAAC9C,CAAC,CAACF,CAAC,GAAC,CAAH,CAAH,GAASE,CAAC,CAACR,CAAD,CAAlB;AAAA,YAAsBkD,CAAC,GAAC1C,CAAC,CAACF,CAAC,GAAC,CAAH,CAAD,GAAOE,CAAC,CAACF,CAAD,CAAhC;AAAA,YAAoC8C,CAAC,GAAC5C,CAAC,CAACR,CAAD,CAAD,GAAKQ,CAAC,CAACF,CAAD,CAAN,GAAUgD,CAAV,GAAY,CAAZ,GAAc1C,CAAC,GAACsC,CAAtD;AAAwD,UAAGxC,IAAI,CAACuC,GAAL,CAASG,CAAT,IAAY/C,CAAf,EAAiB;;AAAM,YAAMgD,CAAC,GAACD,CAAC,GAACA,CAAV;AAAA,YAAYI,CAAC,GAACJ,CAAC,GAACxC,CAAF,GAAI,KAAGyC,CAAH,GAAKH,CAAvB;AAAA,YAAyBjB,CAAC,GAACmB,CAAC,GAACF,CAAF,GAAIpD,CAA/B;AAAA,YAAiC6D,CAAC,GAAC/D,CAAC,CAACU,CAAC,GAAC,CAAH,CAApC;AAAA,YAA0C6B,CAAC,GAACvC,CAAC,CAACU,CAAD,CAAD,CAAK,CAAL,IAAQqD,CAAC,CAAC,CAAD,CAArD;AAAA,YAAyDC,CAAC,GAAChE,CAAC,CAACU,CAAD,CAAD,CAAK,CAAL,IAAQqD,CAAC,CAAC,CAAD,CAApE;;AAAwEzD,MAAAA,CAAC,IAAE+B,CAAC,GAACuB,CAAF,IAAKG,CAAC,CAAC,CAAD,CAAD,GAAKP,CAAL,GAAOxC,CAAP,GAAS,KAAGyC,CAAH,IAAMzC,CAAC,GAACuB,CAAF,GAAIe,CAAC,GAACS,CAAC,CAAC,CAAD,CAAb,CAAT,GAA2BN,CAAC,GAACD,CAAF,GAAIF,CAAJ,GAAMf,CAAN,GAAQ,CAAxC,CAAH,EAA8C/B,CAAC,IAAE6B,CAAC,GAACuB,CAAF,IAAKG,CAAC,CAAC,CAAD,CAAD,GAAKP,CAAL,GAAOxC,CAAP,GAAS,KAAGyC,CAAH,IAAMzC,CAAC,GAACgD,CAAF,GAAIV,CAAC,GAACS,CAAC,CAAC,CAAD,CAAb,CAAT,GAA2BN,CAAC,GAACD,CAAF,GAAIF,CAAJ,GAAMU,CAAN,GAAQ,CAAxC,CAAjD,EAA4FnD,CAAC,IAAEwB,CAA/F;AAAiG;;AAAA,SAAI,IAAIrB,CAAC,GAACZ,CAAC,GAAC,CAAZ,EAAcY,CAAC,GAACN,CAAF,IAAK,EAAEE,CAAC,CAACI,CAAC,GAAC,CAAH,CAAD,GAAOJ,CAAC,CAACR,CAAD,CAAD,GAAKsD,CAAd,CAAnB,EAAoC1C,CAAC,EAArC,EAAwC;AAAC,YAAMN,CAAC,GAACgD,CAAC,GAAC9C,CAAC,CAACI,CAAC,GAAC,CAAH,CAAH,GAASJ,CAAC,CAACR,CAAD,CAAlB;AAAA,YAAsBkD,CAAC,GAAC1C,CAAC,CAACI,CAAD,CAAD,GAAKJ,CAAC,CAACI,CAAC,GAAC,CAAH,CAA9B;AAAA,YAAoCwC,CAAC,GAAC5C,CAAC,CAACI,CAAD,CAAD,GAAKJ,CAAC,CAACR,CAAD,CAAN,GAAUsD,CAAV,GAAY,CAAZ,GAAchD,CAAC,GAAC4C,CAAtD;AAAwD,UAAGxC,IAAI,CAACuC,GAAL,CAASG,CAAT,IAAY/C,CAAf,EAAiB;;AAAM,YAAMgD,CAAC,GAACD,CAAC,GAACA,CAAV;AAAA,YAAYI,CAAC,GAACJ,CAAC,GAAC9C,CAAF,GAAI,KAAG+C,CAAH,GAAKH,CAAvB;AAAA,YAAyBjB,CAAC,GAACmB,CAAC,GAACF,CAAF,GAAIpD,CAA/B;AAAA,YAAiC6D,CAAC,GAAC/D,CAAC,CAACgB,CAAC,GAAC,CAAH,CAApC;AAAA,YAA0CuB,CAAC,GAACvC,CAAC,CAACgB,CAAD,CAAD,CAAK,CAAL,IAAQ+C,CAAC,CAAC,CAAD,CAArD;AAAA,YAAyDC,CAAC,GAAChE,CAAC,CAACgB,CAAD,CAAD,CAAK,CAAL,IAAQ+C,CAAC,CAAC,CAAD,CAApE;;AAAwEzD,MAAAA,CAAC,IAAE+B,CAAC,GAACuB,CAAF,IAAKG,CAAC,CAAC,CAAD,CAAD,GAAKP,CAAL,GAAO9C,CAAP,GAAS,KAAG+C,CAAH,IAAM/C,CAAC,GAAC6B,CAAF,GAAIe,CAAC,GAACS,CAAC,CAAC,CAAD,CAAb,CAAT,GAA2BN,CAAC,GAACD,CAAF,GAAIF,CAAJ,GAAMf,CAAN,GAAQ,CAAxC,CAAH,EAA8C/B,CAAC,IAAE6B,CAAC,GAACuB,CAAF,IAAKG,CAAC,CAAC,CAAD,CAAD,GAAKP,CAAL,GAAO9C,CAAP,GAAS,KAAG+C,CAAH,IAAM/C,CAAC,GAACsD,CAAF,GAAIV,CAAC,GAACS,CAAC,CAAC,CAAD,CAAb,CAAT,GAA2BN,CAAC,GAACD,CAAF,GAAIF,CAAJ,GAAMU,CAAN,GAAQ,CAAxC,CAAjD,EAA4FnD,CAAC,IAAEwB,CAA/F;AAAiG;;AAAArB,IAAAA,CAAC,CAAC2C,IAAF,CAAOrD,CAAC,GAACO,CAAT,GAAYG,CAAC,CAAC2C,IAAF,CAAOnD,CAAC,GAACK,CAAT,CAAZ;AAAwB;;AAAAG,EAAAA,CAAC,CAAC2C,IAAF,CAAOL,CAAP,GAAUtC,CAAC,CAAC2C,IAAF,CAAOH,CAAP,CAAV;;AAAoB,OAAI,IAAIpD,CAAC,GAAC,CAAN,EAAQE,CAAC,GAAC,CAAd,EAAgBF,CAAC,GAACM,CAAlB,EAAoBN,CAAC,EAArB,EAAwBJ,CAAC,CAACI,CAAD,CAAD,CAAK,CAAL,IAAQY,CAAC,CAACV,CAAC,EAAF,CAAT,EAAeN,CAAC,CAACI,CAAD,CAAD,CAAK,CAAL,IAAQY,CAAC,CAACV,CAAC,EAAF,CAAxB;AAA8B;;AAAA,SAAOU,CAAC,IAAIiD,aAAZ,EAA0BX,CAAC,IAAIY,UAA/B,EAA0CtD,CAAC,IAAIuD,UAA/C,EAA0DX,CAAC,IAAIY,aAA/D,EAA6E3D,CAAC,IAAI4D,SAAlF,EAA4F3D,CAAC,IAAI4D,YAAjG,EAA8GzD,CAAC,IAAI0D,aAAnH,EAAiIb,CAAC,IAAIc,WAAtI","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isNone as t,unwrap as e}from\"../../../../../../core/maybe.js\";import{dist as s,sub as n,normalize as i}from\"./util.js\";function r(t,e){return t[e+1]}function h(t){return t.length-1}function a(t){let e=0;for(let s=0;s<h(t);s++)e+=d(t,s);return e}function d(t,e,s=1){const[n,i]=r(t,e);return Math.sqrt(n*n+i*i)*s}class c{constructor(t,e,s,n,i){this._segments=t,this._index=e,this._distance=s,this._xStart=n,this._yStart=i,this._done=!1}static create(t){return new c(t,0,0,t[0][0],t[0][1])}clone(){return new c(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(t){return this._index===t._index||t._index===this._index-1&&(0===this._distance||1===t._distance)||t._index===this._index+1&&(1===this._distance||0===t._distance)}leq(t){return this._index<t._index||this._index===t._index&&this._distance<=t._distance}geq(t){return this._index>t._index||this._index===t._index&&this._distance>=t._distance}get _segment(){return this._segments[this._index+1]}get angle(){const t=this.dy,e=(0*t+-1*-this.dx)/(1*this.length);let s=Math.acos(e);return t>0&&(s=2*Math.PI-s),s}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:t,dy:e}=this;return Math.sqrt(t*t+e*e)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<h(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(t,e){const s=this.backwardLength;if(t<=s)return this._distance=(s-t)/this.length,this;let n=this.backwardLength;for(;this.prev();){if(n+this.length>t)return this._seekBackwards(t-n);n+=this.length}return this._distance=0,e?this:null}seek(t,e=!1){if(t<0)return this._seekBackwards(Math.abs(t),e);if(t<=this.remainingLength)return this._distance=(this.backwardLength+t)/this.length,this;let s=this.remainingLength;for(;this.next();){if(s+this.length>t)return this.seek(t-s,e);s+=this.length}return this._distance=1,e?this:null}}function u(t,e,s){const n=a(t),i=c.create(t),r=n/2,h=(n-e)/2,d=Math.floor(h/e),u=r-d*e;i.seek(u);for(let a=-d;a<=d;a++)i.x<512&&i.x>=0&&i.y<512&&i.y>=0&&s(i.clone(),a,r+a*e,n),i.seek(e)}function o(t,e,s){_(s,e,a(t),c.create(t),0)}function _(s,n,i,r,h){if(i<n)return;const a=r.clone().seek(i/2);if(t(a))return;s(a.clone(),i,h),i=(i-n)/2;const d=e(a.seek(n/2));_(s,n,i,r,h+1),_(s,n,i,d,h+1)}function l(t,e){const s=e;for(let n=0;n<t.length;n++){let e=t[n];const i=[];i.push(e[0]);for(let t=1;t<e.length;t++){let[s,n]=i[t-1];s+=e[t][0],n+=e[t][1],i.push([s,n])}g(i,s);const r=[];r.push(i[0]);for(let t=1;t<i.length;t++){const[e,s]=i[t-1],[n,h]=i[t],a=Math.round(n-e),d=Math.round(h-s);r.push([a,d])}t[n]=r,e=r}return t}function g(t,e){const r=1e-6;if(e<=0)return;const h=t.length;if(h<3)return;const a=[];let d=0;a.push(0);for(let n=1;n<h;n++)d+=s(t[n],t[n-1]),a.push(d);e=Math.min(e,.2*d);const c=[];c.push(t[0][0]),c.push(t[0][1]);const u=t[h-1][0],o=t[h-1][1],_=n([0,0],t[0],t[1]);i(_),t[0][0]+=e*_[0],t[0][1]+=e*_[1],n(_,t[h-1],t[h-2]),i(_),t[h-1][0]+=e*_[0],t[h-1][1]+=e*_[1];for(let s=1;s<h;s++)a[s]+=e;a[h-1]+=e;const l=.5*e;for(let s=1;s<h-1;s++){let n=0,i=0,d=0;for(let h=s-1;h>=0&&!(a[h+1]<a[s]-l);h--){const c=l+a[h+1]-a[s],u=a[h+1]-a[h],o=a[s]-a[h]<l?1:c/u;if(Math.abs(o)<r)break;const _=o*o,g=o*c-.5*_*u,x=o*u/e,f=t[h+1],y=t[h][0]-f[0],p=t[h][1]-f[1];n+=x/g*(f[0]*o*c+.5*_*(c*y-u*f[0])-_*o*u*y/3),i+=x/g*(f[1]*o*c+.5*_*(c*p-u*f[1])-_*o*u*p/3),d+=x}for(let c=s+1;c<h&&!(a[c-1]>a[s]+l);c++){const h=l-a[c-1]+a[s],u=a[c]-a[c-1],o=a[c]-a[s]<l?1:h/u;if(Math.abs(o)<r)break;const _=o*o,g=o*h-.5*_*u,x=o*u/e,f=t[c-1],y=t[c][0]-f[0],p=t[c][1]-f[1];n+=x/g*(f[0]*o*h+.5*_*(h*y-u*f[0])-_*o*u*y/3),i+=x/g*(f[1]*o*h+.5*_*(h*p-u*f[1])-_*o*u*p/3),d+=x}c.push(n/d),c.push(i/d)}c.push(u),c.push(o);for(let s=0,n=0;s<h;s++)t[s][0]=c[n++],t[s][1]=c[n++]}export{c as SegmentCursor,u as pathDivide,a as pathLength,o as pathSubdivide,r as segmentAt,h as segmentCount,d as segmentLength,l as smoothPaths};\n"]},"metadata":{},"sourceType":"module"}