{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { clone as s } from \"../../../core/lang.js\";\nimport { isPolygon as t, isPolyline as e, isExtent as i } from \"../../../geometry/support/jsonUtils.js\";\nimport { setId as n } from \"../CIMCursor.js\";\n\nclass o {\n  static local() {\n    return null === o.instance && (o.instance = new o()), o.instance;\n  }\n\n  execute(s, t, e) {\n    return new r(s, t, e);\n  }\n\n}\n\no.instance = null;\n\nclass r {\n  constructor(s, t, e) {\n    this._inputGeometries = s, this._angleTolerance = void 0 !== t.angleTolerance ? t.angleTolerance : 120, this._maxCosAngle = Math.cos((1 - Math.abs(this._angleTolerance) / 180) * Math.PI);\n  }\n\n  next() {\n    let n = this._inputGeometries.next();\n\n    for (; n;) {\n      if (t(n)) {\n        this._isClosed = !0;\n        const t = s(n);\n        return this._processMultipath(t.rings), t;\n      }\n\n      if (e(n)) {\n        this._isClosed = !1;\n        const t = s(n);\n        return this._processMultipath(t.paths), t;\n      }\n\n      if (i(n)) {\n        if (this._maxCosAngle) return n;\n        this._isClosed = !0;\n        const s = [[n.xmin, n.ymin], [n.xmin, n.ymax], [n.xmax, n.ymax], [n.xmax, n.ymin], [n.xmin, n.ymin]];\n        return this._processPath(s), {\n          rings: [s]\n        };\n      }\n\n      n = this._inputGeometries.next();\n    }\n\n    return null;\n  }\n\n  _processMultipath(s) {\n    if (s) for (const t of s) this._processPath(t);\n  }\n\n  _processPath(s) {\n    if (s) {\n      let t,\n          e,\n          i,\n          o,\n          r,\n          l,\n          a = s.length,\n          h = s[0];\n      this._isClosed && ++a;\n\n      for (let c = 1; c < a; ++c) {\n        let m;\n        m = this._isClosed && c === a - 1 ? s[0] : s[c];\n\n        const _ = m[0] - h[0],\n              u = m[1] - h[1],\n              p = Math.sqrt(_ * _ + u * u);\n\n        if (c > 1 && p > 0 && i > 0) {\n          (t * _ + e * u) / p / i <= this._maxCosAngle && n(h, 1);\n        }\n\n        1 === c && (o = _, r = u, l = p), p > 0 && (h = m, t = _, e = u, i = p);\n      }\n\n      if (this._isClosed && i > 0 && l > 0) {\n        (t * o + e * r) / l / i <= this._maxCosAngle && n(s[0], 1);\n      }\n    }\n  }\n\n}\n\nexport { o as EffectAddControlPoints };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/symbols/cim/effects/EffectAddControlPoints.js"],"names":["clone","s","isPolygon","t","isPolyline","e","isExtent","i","setId","n","o","local","instance","execute","r","constructor","_inputGeometries","_angleTolerance","angleTolerance","_maxCosAngle","Math","cos","abs","PI","next","_isClosed","_processMultipath","rings","paths","xmin","ymin","ymax","xmax","_processPath","l","a","length","h","c","m","_","u","p","sqrt","EffectAddControlPoints"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{clone as s}from\"../../../core/lang.js\";import{isPolygon as t,isPolyline as e,isExtent as i}from\"../../../geometry/support/jsonUtils.js\";import{setId as n}from\"../CIMCursor.js\";class o{static local(){return null===o.instance&&(o.instance=new o),o.instance}execute(s,t,e){return new r(s,t,e)}}o.instance=null;class r{constructor(s,t,e){this._inputGeometries=s,this._angleTolerance=void 0!==t.angleTolerance?t.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let n=this._inputGeometries.next();for(;n;){if(t(n)){this._isClosed=!0;const t=s(n);return this._processMultipath(t.rings),t}if(e(n)){this._isClosed=!1;const t=s(n);return this._processMultipath(t.paths),t}if(i(n)){if(this._maxCosAngle)return n;this._isClosed=!0;const s=[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]];return this._processPath(s),{rings:[s]}}n=this._inputGeometries.next()}return null}_processMultipath(s){if(s)for(const t of s)this._processPath(t)}_processPath(s){if(s){let t,e,i,o,r,l,a=s.length,h=s[0];this._isClosed&&++a;for(let c=1;c<a;++c){let m;m=this._isClosed&&c===a-1?s[0]:s[c];const _=m[0]-h[0],u=m[1]-h[1],p=Math.sqrt(_*_+u*u);if(c>1&&p>0&&i>0){(t*_+e*u)/p/i<=this._maxCosAngle&&n(h,1)}1===c&&(o=_,r=u,l=p),p>0&&(h=m,t=_,e=u,i=p)}if(this._isClosed&&i>0&&l>0){(t*o+e*r)/l/i<=this._maxCosAngle&&n(s[0],1)}}}}export{o as EffectAddControlPoints};\n"]},"metadata":{},"sourceType":"module"}