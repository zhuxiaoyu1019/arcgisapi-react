{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport t from \"../Camera.js\";\nimport \"../geometry.js\";\nimport i from \"../Graphic.js\";\nimport r from \"../Ground.js\";\nimport s from \"../Viewpoint.js\";\nimport n from \"../core/Collection.js\";\nimport { byId as a } from \"../core/domUtils.js\";\nimport o from \"../core/Error.js\";\nimport { on as l } from \"../core/events.js\";\nimport { handlesGroup as p, makeHandle as h } from \"../core/handleUtils.js\";\nimport d from \"../core/has.js\";\nimport c from \"../core/Logger.js\";\nimport { isNone as u, isSome as g, unwrapOr as m } from \"../core/maybe.js\";\nimport { createAbortController as f, throwIfAborted as y } from \"../core/promiseUtils.js\";\nimport { setFrameDuration as w } from \"../core/scheduling.js\";\nimport { on as v, whenOnce as _, init as b, whenTrueOnce as R } from \"../core/watchUtils.js\";\nimport { initialize as x } from \"../core/workers/workers.js\";\nimport { screenPointObjectToArray as S, createScreenPoint as M, createScreenPointArray as T } from \"../core/screenUtils.js\";\nimport { property as O } from \"../core/accessorSupport/decorators/property.js\";\nimport { cast as C } from \"../core/accessorSupport/decorators/cast.js\";\nimport { subclass as V } from \"../core/accessorSupport/decorators/subclass.js\";\nimport { ensureType as P } from \"../core/accessorSupport/ensureType.js\";\nimport { c as j } from \"../chunks/vec3f64.js\";\nimport E from \"../geometry/HeightModelInfo.js\";\nimport { projectPointToVector as I, projectVectorToVector as H } from \"../geometry/projection.js\";\nimport { getSphericalPCPF as G } from \"../geometry/projectionEllipsoid.js\";\nimport { toExtent as U } from \"../geometry/support/aaBoundingRect.js\";\nimport { B as L, c as A } from \"../chunks/boundedPlane.js\";\nimport { getResolutionForScale as D } from \"../geometry/support/scaleUtils.js\";\nimport { canProject as F, project as W } from \"../geometry/support/webMercatorUtils.js\";\nimport { isTiledLayer as q } from \"../layers/support/layerUtils.js\";\nimport { BreakpointsOwner as z } from \"./BreakpointsOwner.js\";\nimport { DOMContainer as k } from \"./DOMContainer.js\";\nimport N from \"./GroundView.js\";\nimport { PopupView as B } from \"./PopupView.js\";\nimport $ from \"./View.js\";\nimport Q from \"./ViewAnimation.js\";\nimport { viewingModeFromString as K } from \"./ViewingMode.js\";\nimport { layerView3DImporter as Z } from \"./3d/layerViewModuleImportUtils.js\";\nimport J from \"./3d/constraints/Constraints.js\";\nimport X from \"./3d/environment/SceneViewEnvironment.js\";\nimport Y from \"./3d/environment/SceneViewEnvironmentManager.js\";\nimport ee from \"./3d/input/SceneInputManager.js\";\nimport { GraphicsDeconflictor as te } from \"./3d/layers/graphics/GraphicsDeconflictor.js\";\nimport { Labeler as ie } from \"./3d/layers/graphics/Labeler.js\";\nimport { ObjectResourceCache as re } from \"./3d/layers/graphics/ObjectResourceCache.js\";\nimport se from \"./3d/layers/support/FeatureTileTree3D.js\";\nimport ne from \"./3d/state/ViewState.js\";\nimport ae from \"./3d/state/ViewStateManager.js\";\nimport { SceneIntersectionHelper as oe } from \"./3d/state/helpers/SceneIntersectionHelper.js\";\nimport { CombinedElevationProvider as le } from \"./3d/support/CombinedElevationProvider.js\";\nimport pe from \"./3d/support/debugFlags.js\";\nimport he from \"./3d/support/DisplayQualityProfile.js\";\nimport { getElevationAtPoint as de } from \"./3d/support/ElevationProvider.js\";\nimport ce from \"./3d/support/HighlightOptions.js\";\nimport { MapCoordsHelper as ue } from \"./3d/support/MapCoordsHelper.js\";\nimport { PropertiesPool as ge } from \"./3d/support/PropertiesPool.js\";\nimport me from \"./3d/support/QualitySettings.js\";\nimport { RenderCoordsHelper as fe } from \"./3d/support/RenderCoordsHelper.js\";\nimport { newResourceController as ye } from \"./3d/support/ResourceController.js\";\nimport we from \"./3d/support/SceneViewPerformanceInfo.js\";\nimport { SharedSymbolResources as ve } from \"./3d/support/SharedSymbolResources.js\";\nimport _e from \"./3d/support/pointsOfInterest/PointsOfInterest.js\";\nimport be from \"./3d/terrain/TerrainSurface.js\";\nimport { isSurfaceLayerView as Re, getTiledLayerInfo as xe } from \"./3d/terrain/terrainUtils.js\";\nimport { Stage as Se } from \"./3d/webgl-engine/Stage.js\";\nimport { Intersector as Me } from \"./3d/webgl-engine/lib/Intersector.js\";\nimport { toGraphic as Te, toOwner as Oe } from \"./3d/webgl-engine/lib/intersectorUtilsConversions.js\";\nimport { TERRAIN_ID as Ce } from \"./3d/webgl-engine/lib/verticalOffsetUtils.js\";\nimport { hitTestSelectSameDistance as Ve } from \"./support/hitTestSelectUtils.js\";\nimport { occludeesSupported as Pe } from \"./support/layerViewUtils.js\";\nimport { toRenderSettings as je, screenshotSuperSampleSettings as Ee } from \"./support/screenshotUtils.js\";\nimport { isSupportedScreenPointEvent as Ie, createScreenPointFromSupportedEvent as He } from \"./support/screenUtils.js\";\nimport { isSpatialReferenceSupported as Ge } from \"./support/spatialReferenceSupport.js\";\nimport { check as Ue } from \"./support/WebGLRequirements.js\";\nimport Le from \"./ui/3d/DefaultUI3D.js\";\nimport Ae from \"../webscene/Environment.js\";\nimport De from \"../geometry/Extent.js\";\nimport Fe from \"../geometry/SpatialReference.js\";\nimport We from \"../geometry/Point.js\";\nconst qe = c.getLogger(\"esri.views.SceneView\");\nlet ze = class extends z(k(B($))) {\n  constructor(e) {\n    super(e), this._clippingArea = null, this._userClippingArea = null, this._initialDefaultSpatialReference = null, this._defaults = {}, this._externallySet = {\n      environment: !1\n    }, this._createGraphicsViewController = null, this._resolveWhenReady = [], this.propertiesPool = new ge({\n      slicePlane: L\n    }, this), this._resourceController = ye(this), this._defaultToMapOptions = {\n      include: new Set()\n    }, this._defaultHitTestOptions = {\n      exclude: new Set()\n    }, this.deconflictor = new te({\n      view: this\n    }), this.labeler = new ie({\n      view: this,\n      deconflictor: this.deconflictor.labels\n    }), this.sharedSymbolResources = null, this.basemapTerrain = null, this.elevationProvider = null, this.camera = null, this.canvas = null, this.center = null, this.constraints = new J(), this.environmentManager = new Y(), this.extent = null, this.floors = new n(), this.windowDevicePixelRatio = 1, this.fullOpacity = 1, this.graphicsView = null, this.groundView = null, this.navigating = !1, this.map = null, this.screenSizePerspectiveEnabled = !0, this.state = new ne(), this.scale = null, this.spatialReference = null, this.isHeightModelInfoRequired = !0, this.alphaCompositingEnabled = !1, this.supersampleScreenhotsEnabled = !0, this.type = \"3d\", this.ui = new Le(), this._numUpdating = 0, this._lastUpdateTime = 0, this.updatingProgress = .5, this.viewpoint = null, this.zoom = null, this.highlightOptions = new ce(), x(), e && e.environment || (this._defaults.environment = new X(), this.environment = this._defaults.environment);\n\n    const t = e => {\n      g(e) && 4 === e.type || (this.notifyChange(\"dataExtent\"), this.updatingChanged(), this.map && this.map.allLayers.forEach(async e => {\n        try {\n          await e.when();\n        } catch {}\n\n        this.updatingChanged();\n      }));\n    };\n\n    this.handles.add([v(this, \"map.allLayers\", \"after-changes\", t, t, t, !0), this.allLayerViews.on(\"after-changes\", e => this._updateUpdatingMonitors(e)), this.watch(\"map\", e => {\n      e && e.load && e.load().catch(() => {});\n    })]), this.inputManager = new ee({\n      view: this\n    });\n\n    const i = () => {\n      const e = window.devicePixelRatio;\n      e !== this.windowDevicePixelRatio && (this.windowDevicePixelRatio = e, this.notifyChange(\"pixelRatio\"));\n    };\n\n    this.stateManager = new ae({\n      view: this,\n      updateDevicePixelRatio: i\n    });\n  }\n\n  initialize() {\n    this.groundView = new N({\n      view: this\n    }), this._updateUpdatingMonitors();\n\n    const e = () => this._updateDefaultToMapOptions();\n\n    this.handles.add(v(this, \"map.allLayers\", \"after-changes\", e, e, e)), this.updatingHandles.add(this.qualitySettings, \"memoryLimit\", e => {\n      this.resourceController && (this.resourceController.memoryController.maxMemory = e);\n    }, 2), this.updatingHandles.add(this.qualitySettings, \"additionalCacheMemory\", e => {\n      this.resourceController && (this.resourceController.memoryController.additionalCacheMemory = e);\n    }, 2), this.updatingHandles.add(this.qualitySettings, \"frameRate\", e => w(e > 0 ? 1e3 / Math.ceil(e) : 0), 2), this.updatingHandles.add(pe, \"SCENEVIEW_LOCKING_LOG\", e => this.defaultsFromMap.logDebugInformation = e, 2), this.updatingHandles.add(this, \"map.ground\", e, 3), this.updatingHandles.add(this, \"map.ground.opacity\", () => this._updateDefaultHitTestOptions(), 3), this.handles.add(this.watch(\"spatialReference\", () => this.notifyChange(\"clippingArea\"), !0));\n  }\n\n  destroy() {\n    this.destroyed || (this.invalidate(), this.activeTool = null, this.layerViewManager.clear(), this._exitSurface(), this._disposeGraphicsView(), this.sharedSymbolResources && (this.sharedSymbolResources.destroy(), this.sharedSymbolResources = null), this.labeler.destroy(), this._set(\"labeler\", null), this.deconflictor.destroy(), this._set(\"deconflictor\", null), this._resourceController.destroy(), this._resourceController = null, this.stateManager.destroy(), this._set(\"stateManager\", null), this.inputManager.destroy(), this._set(\"inputManager\", null), this.propertiesPool.destroy(), this.handles.remove(\"updatingMonitors\"), this.environmentManager.destroy(), this._set(\"environmentManager\", null), this.groundView.destroy(), this.groundView = null);\n  }\n\n  get renderSpatialReference() {\n    return this.renderCoordsHelper && this.renderCoordsHelper.spatialReference;\n  }\n\n  get basemapSpatialReference() {\n    return this.basemapTerrain && this.basemapTerrain.spatialReference;\n  }\n\n  installContentCameraReset(e = {\n    sticky: !1\n  }) {\n    return this.stateManager.installContentCameraReset(e);\n  }\n\n  get clippingArea() {\n    if (\"global\" === this.viewingMode) return null;\n    let e = this._userClippingArea || this.get(\"map.clippingArea\");\n    if (!(!!this._userClippingArea || this.get(\"map.clippingEnabled\")) || !e) return this._clippingArea = null, null;\n    if (!(e instanceof De)) return qe.error(\"#clippingArea\", \"only clippingArea geometries of type Extent are supported\"), this._clippingArea;\n\n    if (this.spatialReference) {\n      if (!F(e.spatialReference, this.spatialReference)) return qe.error(\"#clippingArea\", \"setting clippingArea with incompatible SpatialReference\"), this._clippingArea;\n      e = W(e, this.spatialReference);\n    }\n\n    return this._clippingArea && e && this._clippingArea.equals(e) ? this._clippingArea : (this._clippingArea = e, e);\n  }\n\n  set clippingArea(e) {\n    this.ready && \"global\" === this.viewingMode && e ? qe.error(\"#clippingArea=\", \"Clipping area is only supported in local viewingMode\") : (this._userClippingArea = e, this.notifyChange(\"clippingArea\"));\n  }\n\n  get dataExtent() {\n    const e = this.spatialReference || Fe.WGS84;\n    let t,\n        i = this.clippingArea;\n    i && (i = W(i, e));\n\n    const r = r => {\n      let s = W(r, e);\n      s && (i && (s = s.intersection(i), !s) || (g(t) ? t.union(s) : t = s));\n    },\n          s = this.basemapTerrain;\n\n    if (s && s.spatialReference && r(new De({\n      xmin: s.extent[0],\n      ymin: s.extent[1],\n      zmin: 0,\n      xmax: s.extent[2],\n      ymax: s.extent[3],\n      zmax: 0,\n      spatialReference: s.spatialReference\n    })), this.map) {\n      const e = e => {\n        !e.fullExtent || \"graphics\" === e.type && e.internal || r(e.fullExtent);\n      };\n\n      this.map.allLayers.forEach(t => e(t));\n    }\n\n    return u(t) ? new De({\n      xmin: 0,\n      ymin: 0,\n      zmin: 0,\n      xmax: 0,\n      ymax: 0,\n      zmax: 0,\n      spatialReference: e\n    }) : (t.hasZ ? (t.zmin = Math.min(0, t.zmin), t.zmax = Math.max(0, t.zmax)) : (t.zmin = 0, t.zmax = 0), t);\n  }\n\n  set environment(e) {\n    e !== this._defaults.environment && (this._externallySet.environment = !0), this._set(\"environment\", e);\n  }\n\n  castEnvironment(e) {\n    return e ? e instanceof X ? e : e instanceof Ae ? null != this.environment ? this.environment.cloneWithWebsceneEnvironment(e) : X.fromWebsceneEnvironment(e) : P(X, e) : new X();\n  }\n\n  get pixelRatio() {\n    return Math.min(this.windowDevicePixelRatio, this.maximumPixelRatio);\n  }\n\n  set pixelRatio(e) {\n    g(e) ? this._override(\"pixelRatio\", e) : this._clearOverride(\"pixelRatio\");\n  }\n\n  get maximumPixelRatio() {\n    let e = 1 / 0;\n    const {\n      maximumPixelRatio: t,\n      maximumRenderResolution: i\n    } = this.qualitySettings;\n\n    if (null != t && (e = Math.min(e, t)), null != i) {\n      const t = i / Math.max(this.width, this.height);\n      e = Math.min(e, t);\n    }\n\n    return e;\n  }\n\n  set maximumPixelRatio(e) {\n    g(e) ? this._override(\"maximumPixelRatio\", e) : this._clearOverride(\"maximumPixelRatio\");\n  }\n\n  get groundExtent() {\n    const e = this._get(\"basemapTerrain\");\n\n    if (e && e.spatialReference) {\n      const t = e.extent;\n      return new De({\n        xmin: t[0],\n        ymin: t[1],\n        xmax: t[2],\n        ymax: t[3],\n        spatialReference: e.spatialReference\n      });\n    }\n\n    const t = this.spatialReference || Fe.WGS84;\n    return new De({\n      spatialReference: t\n    });\n  }\n\n  get initialExtentRequired() {\n    return this.stateManager && !this.stateManager.hasInitialView;\n  }\n\n  get interacting() {\n    return this.navigating || g(this.activeTool);\n  }\n\n  get stationary() {\n    return !this.animation && !this.resizing && (u(this.state) || this.state.stationary);\n  }\n\n  set qualityProfile(e) {\n    he.isValidProfile(e) && (he.apply(e, this.qualitySettings), this._set(\"qualityProfile\", e));\n  }\n\n  get qualityProfile() {\n    return this._get(\"qualityProfile\") || he.getDefaultProfile();\n  }\n\n  set slicePlane(e) {\n    if (this._stage.renderView.setRenderParameters({\n      slicePlane: e\n    }), u(e)) return void this._set(\"slicePlane\", null);\n    const t = this.propertiesPool.get(\"slicePlane\");\n    A(e, t), this._set(\"slicePlane\", t);\n  }\n\n  get resolution() {\n    return null != this.spatialReference ? D(this.scale, this.spatialReference) : 0;\n  }\n\n  get heightModelInfo() {\n    const e = this.getDefaultHeightModelInfo();\n    return null != e ? E.deriveUnitFromSR(e, this.spatialReference) : null;\n  }\n\n  get updating() {\n    var e, t, i;\n    let r = 0,\n        s = this.layerViewManager.updating,\n        n = s ? this.layerViewManager.updatingRemaining : 0;\n    this.allLayerViews.forEach(e => {\n      if (e.isFulfilled()) {\n        if (e.updating) {\n          if (s = !0, e.suspended || Re(e)) return;\n          ++n, r += \"updatingProgress\" in e ? e.updatingProgress : .5;\n        }\n      } else ++n;\n    });\n\n    for (const a of [this.graphicsView, this.basemapView, this._resourceController, this._stage, this.featureTiles, this.pointsOfInterest, this.environmentManager, this.overlay, this.featureTreeDebugger, this.toolViewManager]) if (g(a) && a.updating) {\n      const e = .1;\n      n += e, r += .5 * e;\n    }\n\n    for (const a of [this.deconflictor, this.labeler, this.basemapTerrain]) g(a) && a.updating && (++n, r += a.updatingProgress);\n\n    if (s = !!(s || n > 0 || this.updatingHandles.updating || !this.ready || !this.stationary || this._createGraphicsViewController || null != (e = this.inputManager) && e.hasPendingInputs || null != (t = this.map) && null != (i = t.allLayers) && i.some(e => !e.isFulfilled())), s ? (this._numUpdating = Math.max(n, this._numUpdating), r += this._numUpdating - n) : this._numUpdating = 0, this._numUpdating > 0 ? r /= this._numUpdating : r = s ? 0 : 1, this._get(\"updatingProgress\") !== r) {\n      const e = this._resourceController.scheduler.now;\n\n      if (r < 1) {\n        const t = Math.min((e - this._lastUpdateTime) / 2e3, 1);\n        r = this.updatingProgress * (1 - t) + r * t;\n      }\n\n      this._set(\"updatingProgress\", r), this._lastUpdateTime = s && r < 1 ? e : 0;\n    }\n\n    return s;\n  }\n\n  get viewingMode() {\n    const e = this.get(\"map.initialViewProperties.viewingMode\");\n    if (e) return e;\n    const t = this.spatialReference;\n    return !t || Ge(t, \"global\") ? \"global\" : \"local\";\n  }\n\n  set viewingMode(e) {\n    if (this.ready) qe.error(\"#viewingMode\", \"viewingMode cannot be set once view is ready\");else {\n      [\"local\", \"global\"].indexOf(e) >= 0 ? this._override(\"viewingMode\", e) : void 0 === e && this._clearOverride(\"viewingMode\");\n    }\n  }\n\n  get resourceController() {\n    return this._resourceController;\n  }\n\n  get performanceInfo() {\n    return new we(this);\n  }\n\n  on(e, t, i, r) {\n    const s = this.viewEvents.on(e, t, i, r);\n    return s || super.on(e, t);\n  }\n\n  hasEventListener(e) {\n    return super.hasEventListener(e) || this.viewEvents.hasHandler(e);\n  }\n\n  toMap(e, t) {\n    if (!this.ready) return qe.error(\"#toMap()\", \"Scene view cannot be used before it is ready\"), null;\n    const i = t ? this.externalToInternalIntersectOptions(t) : this._defaultToMapOptions,\n          r = g(i.graphics) && (g(i.graphics.include) || g(i.graphics.exclude)),\n          s = Ie(e) ? He(this, e) : e,\n          n = S(s);\n    i.enableDraped = i.include && !i.include.has(Ce) || i.exclude && i.exclude.has(Ce);\n    const a = this.sceneIntersectionHelper,\n          o = new Me(this.state.viewingMode);\n\n    if (o.options.selectionMode = !0, o.options.store = r ? 2 : 0, a.intersectIntersectorScreen(n, o, i), r) {\n      for (const e of o.results.all) {\n        const t = Te(e, this);\n        if (u(t)) return this._intersectResultToMapPoint(e);\n        if (this._testGraphicUidFilter(i.graphics, t)) return this._intersectResultToMapPoint(e);\n      }\n\n      return null;\n    }\n\n    return this._intersectResultToMapPoint(o.results.min);\n  }\n\n  toScreen(e) {\n    if (!this.ready) return qe.error(\"#toScreen()\", \"Scene view cannot be used before it is ready\"), null;\n    const t = m(null == e.z && de(this.elevationProvider, e), 0);\n    return I(e, Be, this.renderSpatialReference, t), this.state.camera.projectToScreen(Be, $e), M($e[0], $e[1]);\n  }\n\n  pixelSizeAt(e) {\n    return this.ready ? e ? (I(e, Be, this.renderSpatialReference), this.state.camera.computeScreenPixelSizeAt(Be)) : 0 : (qe.error(\"#pixelSizeAt()\", \"Scene view cannot be used before it is ready\"), null);\n  }\n\n  overlayPixelSizeInMapUnits(e) {\n    const t = this.basemapTerrain.overlayManager;\n    return t ? t.overlayPixelSizeInMapUnits(e) : 1;\n  }\n\n  hitTest(e, t) {\n    if (!this.ready) return qe.error(\"#hitTest()\", \"Scene view cannot be used before it is ready\"), null;\n    const i = Ie(e) ? He(this, e) : e,\n          r = T(i.x, i.y),\n          s = t ? this.externalToInternalIntersectOptions(t) : this._defaultHitTestOptions;\n    s.requiresGroundFeedback = !0, s.enableDraped = !0;\n    const n = new Me(this.state.viewingMode);\n    n.options.selectionMode = !0, n.options.store = 2, this.sceneIntersectionHelper.intersectIntersectorScreen(r, n, s);\n\n    const a = this._intersectResultsToHits(n.results.all, s.graphics),\n          o = n.results.ground,\n          l = Oe(o, this),\n          p = g(l) && \"type\" in l && \"integrated-mesh\" === l.type ? l : null,\n          h = {\n      screenPoint: i,\n      results: a,\n      ground: {\n        mapPoint: this._intersectResultToMapPoint(o),\n        distance: o.hasIntersectionPoint ? o.distanceInRenderSpace : 0,\n        layer: p\n      }\n    };\n\n    return pe.SCENEVIEW_HITTEST_RETURN_INTERSECTOR && (h.intersector = n), Promise.resolve(h);\n  }\n\n  popupHitTest(e) {\n    return Ve(this, e).then(({\n      results: t,\n      ground: i\n    }) => {\n      let r = null;\n      return !(0 === t.length || Math.abs(t[0].distance - i.distance) < 1e-5) || i.layer && \"integrated-mesh\" === i.layer.type || (r = i.mapPoint), {\n        results: t,\n        screenPoint: e,\n        mapPoint: r\n      };\n    });\n  }\n\n  goTo(e, t) {\n    return this.updatingHandles.addPromise(this.stateManager.goTo(e, t));\n  }\n\n  whenLayerView(e) {\n    return super.whenLayerView(e);\n  }\n\n  takeScreenshot(e) {\n    return this.whenReady().then(() => {\n      const t = je(e, this);\n      return t.pixelRatio /= this.pixelRatio, this._stage.renderView.takeScreenshot(Ee(t, this.supersampleScreenhotsEnabled, this.padding));\n    });\n  }\n\n  addUpdatingPromise(e) {\n    return this.updatingHandles.addPromise(e);\n  }\n\n  importLayerView(e) {\n    return Z.importLayerView(e);\n  }\n\n  hasLayerViewModule(e) {\n    return Z.hasLayerViewModule(e);\n  }\n\n  forceDOMReadyCycle() {\n    this.forceReadyCycle();\n  }\n\n  getDefaultSpatialReference() {\n    return this.get(\"map.initialViewProperties.spatialReference\") || this.get(\"defaultsFromMap.spatialReference\") || this.get(\"defaultsFromMap.isSpatialReferenceDone\") && this._initialDefaultSpatialReference || null;\n  }\n\n  async validate() {\n    let e = Ue();\n    if (d(\"safari\") && d(\"safari\") < 9 && (e = new o(\"sceneview:browser-not-supported\", \"This browser is not supported by SceneView (Safari < 9)\", {\n      type: \"safari\",\n      requiredVersion: 9,\n      detectedVersion: d(\"safari\")\n    })), g(e)) throw qe.warn(\"#validate()\", e.message), e;\n  }\n\n  isSpatialReferenceSupported(e, t, i) {\n    const r = e.isGeographic,\n          s = e.isWebMercator,\n          n = Ge(e, \"global\"),\n          a = \"local\" === this.viewingMode,\n          o = !(!this._isOverridden(\"viewingMode\") && !this.get(\"map.initialViewProperties.viewingMode\"));\n\n    if (o) {\n      if (a && r) return i ? i(`Layer ${t.id} is ignored because it is GCS and viewing mode is local`) : qe.warnOnce(\"Geographic coordinate systems are not supported in local viewing mode.\"), !1;\n      if (!a && !n) return i ? i(`Layer ${t.id} is ignored because its spatial reference is not supported in global viewing mode`) : qe.warnOnce(\"Spatial reference defined on view not supported in global viewing mode.\"), !1;\n    } else if (r && !n) return i ? i(`Layer ${t.id} is ignored because its spatial reference is geographic but unsupported`) : qe.warnOnce(\"Spatial reference is geographic but not supported.\"), !1;\n\n    if (t) if (q(t)) {\n      let r;\n\n      if (o) {\n        r = null != xe(t, e, K(this.viewingMode)).tileInfo;\n      } else {\n        let i = xe(t, e, 1);\n        null == i.tileInfo && (i = xe(t, e, 2), null != i.tileInfo && s && !this.ready && (this.viewingMode = \"local\")), r = null != i.tileInfo;\n      }\n\n      if (!r) return i && i(`Layer ${t.id} is ignored because it is tiled but\\n            its tiling scheme is not supported or compatible with the viewing mode`), !1;\n    } else if ((e.isWGS84 || s) && !a) return null == this._initialDefaultSpatialReference && (this._initialDefaultSpatialReference = e), o || this.ready || (this.viewingMode = \"global\", i && i(`Viewing mode locked to global due to reprojectable layer ${t.id}`)), i && i(`Layer ${t.id} is ignored because it supports server-side reprojection`), !1;\n    return !0;\n  }\n\n  whenReady() {\n    return new Promise(e => {\n      this.ready ? e(this) : this._resolveWhenReady.push(e);\n    });\n  }\n\n  computeMapPointFromVec3d(e, t) {\n    let i = this.spatialReference || Fe.WGS84;\n    return H(e, this.renderSpatialReference, e, i) || (i = Fe.WGS84, H(e, this.renderSpatialReference, e, i)), t ? (t.x = e[0], t.y = e[1], t.z = e[2], t.spatialReference = i) : t = new We(e, i), t;\n  }\n\n  trackGraphicState(e) {\n    if (!e.graphic) return qe.error(\"trackGraphicState\", \"GraphicState.graphic must not be null or undefined to start tracking\"), null;\n    const t = this.getViewForGraphic(e.graphic);\n    let i = null,\n        r = !1;\n\n    const s = t => {\n      !r && g(t) && \"graphics3d\" in t && t.graphics3d && t.graphics3d.graphicsCore && (i = t.graphics3d.graphicsCore.trackGraphicState(e));\n    };\n\n    return g(t) ? s(t) : this.whenViewForGraphic(e.graphic, {\n      waitForLayer: !0\n    }).then(e => s(e), () => {}).catch(() => {}), {\n      remove: () => {\n        r = !0, g(i) && (i.remove(), i = null);\n      }\n    };\n  }\n\n  highlight(e) {\n    if (Array.isArray(e)) return p(e.map(e => this.highlight(e)));\n    if (n.isCollection(e)) return p(e.toArray().map(e => this.highlight(e)));\n    const t = this.getViewForGraphic(e);\n    return t && \"highlight\" in t ? t.highlight(e) : h();\n  }\n\n  maskOccludee(e) {\n    if (!e) return qe.error(\"maskOccludee\", \"GraphicState.graphic must not be null or undefined to mask an occludee\"), null;\n    const t = this.getViewForGraphic(e);\n    let i = null,\n        r = !1;\n\n    const s = t => {\n      !r && g(t) && \"graphics3d\" in t && Pe(t) && (i = t.maskOccludee(e));\n    };\n\n    return g(t) ? s(t) : this.whenViewForGraphic(e, {\n      waitForLayer: !0\n    }).then(e => s(e), () => {}).catch(() => {}), {\n      remove: () => {\n        r = !0, g(i) && (i.remove(), i = null);\n      }\n    };\n  }\n\n  getViewForGraphic(e) {\n    return e.layer === this.graphics ? this.graphicsView : e.layer ? this.allLayerViews.find(t => t.layer === e.layer) : null;\n  }\n\n  graphicChanged(e) {\n    g(this.graphicsView) && this.graphicsView.graphicChanged(e);\n  }\n\n  async whenViewForGraphic(e, t) {\n    if (e.layer === this) return await _(this, \"graphicsView\"), this.graphicsView;\n    if (!e.layer || !this.map) throw new o(\"no-view-for-graphic\");\n    return t && t.waitForLayer && !this.map.allLayers.includes(e.layer) ? new Promise((t, i) => {\n      const r = this.map.allLayers.on(\"change\", s => {\n        -1 !== s.added.indexOf(e.layer) && (r.remove(), this.whenLayerView(e.layer).then(t, i));\n      });\n    }) : this.whenLayerView(e.layer);\n  }\n\n  externalToInternalIntersectOptions(e) {\n    const t = this._externalToInternalRenderItems(e.include, 0),\n          i = this._externalToInternalRenderItems(e.exclude, 1);\n\n    return {\n      include: t.layerUids,\n      exclude: i.layerUids,\n      graphics: {\n        include: t.graphicUids,\n        exclude: i.graphicUids\n      }\n    };\n  }\n\n  _intersectResultToMapPoint(e, t) {\n    return e.getIntersectionPoint(Be) ? (t = this.computeMapPointFromVec3d(Be, t), \"TerrainRenderer\" === e.intersector && this.basemapTerrain && (t.z = m(de(this.basemapTerrain, t), 0)), t) : null;\n  }\n\n  _intersectResultsToHits(e, t) {\n    const i = new Array();\n    let r = null;\n\n    for (let s = 0; s < e.length; s++) {\n      const n = e[s],\n            a = Oe(n, this);\n      if (g(a) && (a === this.map.ground || \"type\" in a && \"integrated-mesh\" === a.type)) break;\n      const o = Te(n, this);\n      if (!g(o)) continue;\n\n      if (u(r) && s !== e.length - 1 && (r = new Set()), g(r)) {\n        const e = this._getGraphicFilterUid(o);\n\n        if (r.has(e)) continue;\n        r.add(e);\n      }\n\n      if (!this._testGraphicUidFilter(t, o)) continue;\n\n      const l = this._intersectResultToMapPoint(n),\n            p = n.distanceInRenderSpace;\n\n      i.push({\n        graphic: o,\n        mapPoint: l,\n        distance: p\n      });\n    }\n\n    return i;\n  }\n\n  _getGraphicFilterUid(e) {\n    if (e.layer && \"objectIdField\" in e.layer) {\n      const t = e.attributes[e.layer.objectIdField];\n      if (t) return `o-${e.layer.id}-${t}`;\n    }\n\n    return `u-${e.uid}`;\n  }\n\n  _testGraphicUidFilter(e, t) {\n    const i = this._getGraphicFilterUid(t);\n\n    return u(e) || (u(e.include) || e.include.has(i)) && (u(e.exclude) || !e.exclude.has(i));\n  }\n\n  _externalToInternalRenderItems(e, t, s = {\n    layerUids: null,\n    graphicUids: null\n  }) {\n    return e ? (e instanceof i ? (Ne(s, this._getGraphicFilterUid(e)), 0 === t && (g(this.graphicsView) && e.layer === this ? ke(s, this.graphicsView.graphics3d.layer.id) : e.layer && ke(s, e.layer.uid))) : \"forEach\" in e ? e.forEach(e => {\n      Array.isArray(e) ? this._externalToInternalRenderItems(e, t, s) : n.isCollection(e) ? e === this.graphics && g(this.graphicsView) ? ke(s, this.graphicsView.graphics3d.layer.id) : this._externalToInternalRenderItems(e, t, s) : e instanceof r ? e === this.map.ground && ke(s, Ce) : this._externalToInternalRenderItems(e, t, s);\n    }) : ke(s, e.uid), s) : s;\n  }\n\n  _initBasemapTerrain() {\n    this._set(\"basemapTerrain\", new be({\n      view: this\n    })), this._set(\"elevationProvider\", new le({\n      view: this\n    })), this.elevationProvider.register(\"ground\", this.basemapTerrain);\n  }\n\n  _exitBasemapTerrain() {\n    this.basemapTerrain && (this.elevationProvider.unregister(this.basemapTerrain), this.elevationProvider.destroy(), this._set(\"elevationProvider\", null), this.basemapTerrain.destroy(), this._set(\"basemapTerrain\", null));\n  }\n\n  _initGlobe() {\n    this._initCoordinateSystem(), this.state.createInitialCamera(), this._initBasemapTerrain(), this._set(\"pointsOfInterest\", new _e({\n      view: this\n    })), this._set(\"featureTiles\", new se({\n      renderCoordsHelper: this.renderCoordsHelper,\n      cameraOnSurface: this.pointsOfInterest.contentCameraOnSurface,\n      focus: this.pointsOfInterest.focus,\n      tilingSchemeOwner: this.basemapTerrain,\n      viewState: this.state,\n      scheduler: this._resourceController.scheduler,\n      terrain: this.basemapTerrain\n    }));\n\n    const e = () => {\n      const e = this.basemapTerrain && this.basemapTerrain.extent;\n      if (this.clippingArea || e) {\n        if (e && this.basemapTerrain.spatialReference) {\n          const e = U(this.basemapTerrain.extent, this.basemapTerrain.spatialReference);\n          this.clippingArea ? this.featureTiles.filterExtent = e.intersection(this.clippingArea) : this.featureTiles.filterExtent = e;\n        } else this.featureTiles.filterExtent = this.clippingArea;\n      } else this.featureTiles.filterExtent = null;\n    };\n\n    this.handles.add([this.updatingHandles.add(pe, \"FEATURE_TILE_TREE_SHOW_TILES\", e => {\n      e && this.featureTiles && !this.featureTreeDebugger ? this.updatingHandles.addPromise(import(\"./3d/layers/support/FeatureTileTree3DDebugger.js\")).then(({\n        FeatureTileTree3DDebugger: e\n      }) => {\n        !this.featureTreeDebugger && pe.FEATURE_TILE_TREE_SHOW_TILES && (this.featureTreeDebugger = new e({\n          view: this\n        }));\n      }) : e || !this.featureTreeDebugger || pe.FEATURE_TILE_TREE_SHOW_TILES || (this.featureTreeDebugger.destroy(), this.featureTreeDebugger = null);\n    }, 3), this.updatingHandles.add(this, \"clippingArea\", e, 3), this.updatingHandles.add(this, \"basemapTerrain.extent\", e, 3)], \"feature-tiles\"), this.stateManager.init();\n  }\n\n  _exitGlobe() {\n    this.state && (this.stateManager.deinit(), this.handles.remove(\"render-coords-helper\"), this.handles.remove(\"feature-tiles\"), this.featureTiles.destroy(), this._set(\"featureTiles\", null), this.pointsOfInterest.destroy(), this._set(\"pointsOfInterest\", null), this._exitBasemapTerrain(), this.state.exit(), this._exitCoordinateSystem());\n  }\n\n  _initCoordinateSystem() {\n    if (this.spatialReference) {\n      const e = this.spatialReference;\n      this.mapCoordsHelper && this.mapCoordsHelper.spatialReference.equals(e) || this._set(\"mapCoordsHelper\", new ue(this.map, e));\n      const t = this.state.isGlobal,\n            i = t ? G(e) : e;\n      i !== this.renderSpatialReference && (this._set(\"renderCoordsHelper\", fe.create(this.state.viewingMode, i)), t || this.handles.add(this.watch(\"basemapTerrain.extent\", e => {\n        0 === e[0] && 0 === e[1] && 0 === e[2] && 0 === e[3] || (this.renderCoordsHelper.extent = e);\n      }, !0), \"render-coords-helper\"), this.sceneIntersectionHelper && this.sceneIntersectionHelper.setTolerance(Me.DEFAULT_TOLERANCE / this.renderCoordsHelper.unitInMeters));\n    } else this._set(\"mapCoordsHelper\", null), this._set(\"renderCoordsHelper\", null);\n  }\n\n  _exitCoordinateSystem() {\n    this.mapCoordsHelper && (this.handles.remove(\"render-coords-helper\"), this._set(\"renderCoordsHelper\", null), this._set(\"mapCoordsHelper\", null));\n  }\n\n  updatingChanged() {\n    this.notifyChange(\"updating\");\n  }\n\n  _updateUpdatingMonitors(e = null) {\n    g(e) && 4 === e.type || (this.handles.remove(\"updatingMonitors\"), this.allLayerViews.forEach(e => {\n      e.destroyed || (this.handles.add([e.watch([\"updating\", \"updatingProgress\"], () => this.updatingChanged(), !0)], \"updatingMonitors\"), e.when(() => this.updatingChanged(), () => this.updatingChanged()));\n    }), this.updatingChanged());\n  }\n\n  _renderScreenshotOverlay(e, t) {\n    if (!this.overlay || !this.overlay.hasVisibleItems) return t;\n    const i = e.getContext(\"2d\");\n    return i.putImageData(t, 0, 0), this.overlay.renderCanvas(e), i.getImageData(0, 0, t.width, t.height);\n  }\n\n  _initStage() {\n    const e = {\n      renderContext: this.renderContext,\n      deactivatedWebGLExtensions: this.deactivatedWebGLExtensions,\n      debugWebGLExtensions: this.debugWebGLExtensions,\n      alpha: this.alphaCompositingEnabled,\n      canvas: this.renderCanvas,\n      screenshot: {\n        renderOverlay: (e, t) => this._renderScreenshotOverlay(e, t)\n      }\n    },\n          t = new oe(this.state.viewingMode, {\n      forEachLayer: e => this._stage.layers.forAll(e)\n    }, this);\n\n    this._set(\"sceneIntersectionHelper\", t);\n\n    const i = a(this.surface),\n          {\n      resourceController: r,\n      state: s,\n      renderSpatialReference: n\n    } = this;\n    this._stage = new Se({\n      resourceController: r,\n      container: i,\n      options: e,\n      state: s,\n      sceneIntersectionHelper: t,\n      renderSR: n\n    }), this._lostWebGLContextHandle = l(this._stage.renderView.canvas, \"webglcontextlost\", () => this.fatalError = new o(\"webgl-context-lost\")), this.handles.add([this.updatingHandles.add(this.qualitySettings, \"antialiasingEnabled\", () => {\n      this._stage.renderView.setRenderParameters({\n        antialiasingEnabled: this.qualitySettings.antialiasingEnabled\n      });\n    }, 2), this.updatingHandles.add(this.qualitySettings, \"highQualityTransparency\", () => {\n      this._stage.renderView.setRenderParameters({\n        highQualityTransparency: this.qualitySettings.highQualityTransparency\n      });\n    }, 2), b(this, \"magnifier\", e => this._stage.renderView.magnifier = e, !0)], \"stage\");\n\n    const p = () => {\n      this._stage.renderView.setRenderParameters({\n        defaultHighlightOptions: ce.toEngineOptions(this.highlightOptions)\n      });\n    };\n\n    for (const a of [\"highlightOptions\", \"highlightOptions.color\", \"highlightOptions.haloColor\", \"highlightOptions.haloOpacity\", \"highlightOptions.fillOpacity\", \"highlightOptions.shadowOpacity\", \"highlightOptions.shadowColor\", \"highlightOptions.shadowDifference\"]) this.handles.add(this.updatingHandles.add(this, a, p), \"stage\");\n\n    p(), this.renderCoordsHelper && this.sceneIntersectionHelper.setTolerance(Me.DEFAULT_TOLERANCE / this.renderCoordsHelper.unitInMeters), this._set(\"canvas\", this._stage.renderView.canvas);\n  }\n\n  _exitStage() {\n    this._set(\"sceneIntersectionHelper\", null), this._stage.destroy(), this._stage = null, this._lostWebGLContextHandle.remove(), this._lostWebGLContextHandle = null, this.handles.remove(\"stage\"), this._set(\"canvas\", null);\n  }\n\n  _initSurface(e) {\n    this._exitSurface(), this.state.init(e, this.spatialReference), this._initStage(), this._initGlobe(), this.sharedSymbolResources = new ve({\n      view: this,\n      viewingMode: e,\n      resourceController: this._resourceController,\n      pointsOfInterest: this.pointsOfInterest,\n      viewState: this.state,\n      objectResourceCache: new re()\n    });\n  }\n\n  _exitSurface() {\n    this.sharedSymbolResources && (this.sharedSymbolResources.objectResourceCache.destroy(), this.sharedSymbolResources.destroy(), this.sharedSymbolResources = null, this._exitGlobe(), this._exitStage());\n  }\n\n  _createGraphicsViewIfNeeded() {\n    if (this.graphicsView || this._createGraphicsViewController) return;\n    if (0 === this.graphics.length) return;\n    this.handles.remove(\"graphics-view\"), this._createGraphicsViewController = f();\n\n    const e = () => {\n      this._createGraphicsViewController = null, this.updatingChanged();\n    };\n\n    this._createGraphicsViewAsync(this._createGraphicsViewController.signal).then(e, e), this.updatingChanged();\n  }\n\n  async _createGraphicsViewAsync(e) {\n    const t = (await import(\"./3d/layers/GraphicsView3D.js\")).default;\n    y(e), await R(this.basemapTerrain, \"ready\", e), this._set(\"graphicsView\", new t({\n      view: this\n    }));\n  }\n\n  _disposeGraphicsView() {\n    this._createGraphicsViewController && (this._createGraphicsViewController.abort(), this._createGraphicsViewController = null), this.handles.remove(\"graphics-view\"), g(this.graphicsView) && (this.handles.remove(this.graphicsView.graphics3d.layer.id), this.graphicsView.destroy(), this._set(\"graphicsView\", null));\n  }\n\n  _startup() {\n    const e = K(this.viewingMode);\n\n    if (1 === e && (this._clippingArea = null), this._set(\"ready\", !0), this._initSurface(e), this.handles.add(v(this, \"graphics\", \"after-changes\", () => this._createGraphicsViewIfNeeded()), \"graphics-view\"), this._createGraphicsViewIfNeeded(), !this._externallySet.environment) {\n      const e = this.get(\"map.initialViewProperties.environment\");\n      e && (this.environment = e);\n    }\n\n    this.labeler.setup(), this.environmentManager.connectView(this), this.inputManager.connect();\n    const t = this._resolveWhenReady;\n    this._resolveWhenReady = [], t.forEach(e => e(this));\n  }\n\n  _teardown() {\n    this._initialDefaultSpatialReference = null, this.inputManager.disconnect(), this.environmentManager.disconnectView(), this.labeler.dispose(), this._disposeGraphicsView(), this.handles.remove(\"graphics-view\"), this._exitSurface(), this._set(\"ready\", !1);\n  }\n\n  _updateDefaultToMapOptions() {\n    if (this._defaultToMapOptions.include.clear(), this.map) {\n      this.map.ground && this._defaultToMapOptions.include.add(Ce);\n\n      for (const e of this.map.allLayers.items) \"integrated-mesh\" === e.type && this._defaultToMapOptions.include.add(e.uid);\n    }\n  }\n\n  _updateDefaultHitTestOptions() {\n    if (this._defaultHitTestOptions.exclude.clear(), this.map) {\n      this.map.ground && this.map.ground.opacity < 1 && this._defaultHitTestOptions.exclude.add(Ce);\n\n      for (const e of this.map.allLayers.items) \"integrated-mesh\" === e.type && e.opacity < 1 && this._defaultToMapOptions.exclude.add(e.uid);\n    }\n  }\n\n};\n\nfunction ke(e, t) {\n  e.layerUids || (e.layerUids = new Set()), e.layerUids.add(t);\n}\n\nfunction Ne(e, t) {\n  e.graphicUids || (e.graphicUids = new Set()), e.graphicUids.add(t);\n}\n\ne([O()], ze.prototype, \"_resourceController\", void 0), e([O()], ze.prototype, \"_stage\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"deconflictor\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"labeler\", void 0), e([O({\n  type: Q,\n  readOnly: !0,\n  aliasOf: \"state.animation\"\n})], ze.prototype, \"animation\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"basemapTerrain\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"elevationProvider\", void 0), e([O({\n  type: t,\n  aliasOf: \"stateManager.camera\"\n})], ze.prototype, \"camera\", void 0), e([O({\n  type: t,\n  aliasOf: \"stateManager.contentCamera\"\n})], ze.prototype, \"contentCamera\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"canvas\", void 0), e([O({\n  type: We,\n  aliasOf: \"stateManager.center\"\n})], ze.prototype, \"center\", void 0), e([O({\n  type: De,\n  dependsOn: [\"map.clippingArea?\", \"map.clippingEnabled?\", \"viewingMode\"]\n})], ze.prototype, \"clippingArea\", null), e([O({\n  type: J\n})], ze.prototype, \"constraints\", void 0), e([O({\n  type: De,\n  dependsOn: [\"basemapTerrain.extent\", \"clippingArea\", \"map\"],\n  readOnly: !0\n})], ze.prototype, \"dataExtent\", null), e([O({\n  value: null,\n  type: X\n})], ze.prototype, \"environment\", null), e([C(\"environment\")], ze.prototype, \"castEnvironment\", null), e([O({\n  readOnly: !0\n})], ze.prototype, \"environmentManager\", void 0), e([O({\n  type: De,\n  aliasOf: \"stateManager.extent\"\n})], ze.prototype, \"extent\", void 0), e([O()], ze.prototype, \"floors\", void 0), e([O({\n  readOnly: !0,\n  aliasOf: \"stateManager.screenCenter\"\n})], ze.prototype, \"screenCenter\", void 0), e([O({\n  type: Number\n})], ze.prototype, \"pixelRatio\", null), e([O({\n  type: Number,\n  dependsOn: [\"qualitySettings.maximumPixelRatio\", \"qualitySettings.maximumRenderResolution\", \"size\"]\n})], ze.prototype, \"maximumPixelRatio\", null), e([O({\n  aliasOf: \"stateManager.frustum\"\n})], ze.prototype, \"frustum\", void 0), e([O({\n  type: Number,\n  readOnly: !0\n})], ze.prototype, \"fullOpacity\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"graphicsView\", void 0), e([O({\n  type: De,\n  dependsOn: [\"basemapTerrain.extent\"],\n  readOnly: !0\n})], ze.prototype, \"groundExtent\", null), e([O()], ze.prototype, \"groundView\", void 0), e([O({\n  type: Boolean\n})], ze.prototype, \"initialExtentRequired\", null), e([O({\n  type: Boolean,\n  readOnly: !0\n})], ze.prototype, \"interacting\", null), e([O()], ze.prototype, \"stationary\", null), e([O({\n  aliasOf: \"state.navigating\"\n})], ze.prototype, \"navigating\", void 0), e([O()], ze.prototype, \"map\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"mapCoordsHelper\", void 0), e([O({\n  aliasOf: \"stateManager.padding\"\n})], ze.prototype, \"padding\", void 0), e([O({\n  type: _e,\n  readOnly: !0\n})], ze.prototype, \"pointsOfInterest\", void 0), e([O({\n  type: se,\n  readOnly: !0\n})], ze.prototype, \"featureTiles\", void 0), e([O()], ze.prototype, \"featureTreeDebugger\", void 0), e([O({\n  type: Boolean\n})], ze.prototype, \"screenSizePerspectiveEnabled\", void 0), e([O({\n  constructOnly: !0\n})], ze.prototype, \"deactivatedWebGLExtensions\", void 0), e([O({\n  constructOnly: !0\n})], ze.prototype, \"debugWebGLExtensions\", void 0), e([O({\n  constructOnly: !0\n})], ze.prototype, \"renderCanvas\", void 0), e([O({\n  constructOnly: !0\n})], ze.prototype, \"state\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"inputManager\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"stateManager\", void 0), e([O({\n  type: [\"low\", \"medium\", \"high\"]\n})], ze.prototype, \"qualityProfile\", null), e([O({\n  type: me,\n\n  get() {\n    let e = this._get(\"qualitySettings\");\n\n    return e || (e = new me(), he.apply(this.qualityProfile, e)), e;\n  }\n\n})], ze.prototype, \"qualitySettings\", void 0), e([O()], ze.prototype, \"slicePlane\", null), e([O({\n  dependsOn: [\"viewingMode\"]\n})], ze.prototype, \"preconditionsReady\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"renderCoordsHelper\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"sceneIntersectionHelper\", void 0), e([O({\n  type: Number,\n  dependsOn: [\"scale\", \"spatialReference\"],\n  readOnly: !0\n})], ze.prototype, \"resolution\", null), e([O({\n  type: Number,\n  aliasOf: \"stateManager.scale\"\n})], ze.prototype, \"scale\", void 0), e([O({\n  dependsOn: []\n})], ze.prototype, \"heightModelInfo\", null), e([O({\n  dependsOn: [\"map.initialViewProperties?.spatialReference\", \"defaultsFromMap.isSpatialReferenceDone\"]\n})], ze.prototype, \"spatialReference\", void 0), e([O({\n  type: Boolean,\n  constructOnly: !0\n})], ze.prototype, \"alphaCompositingEnabled\", void 0), e([O({\n  type: Boolean\n})], ze.prototype, \"supersampleScreenhotsEnabled\", void 0), e([O({\n  readOnly: !0\n})], ze.prototype, \"type\", void 0), e([O({\n  type: Le\n})], ze.prototype, \"ui\", void 0), e([O({\n  type: Boolean,\n  readOnly: !0,\n  dependsOn: [\"graphicsView.updating\", \"basemapView.updating\", \"basemapTerrain.updating\", \"layerViewManager.updating\", \"layerViewManager.updatingRemaining\", \"_resourceController.updating\", \"_stage.updating\", \"featureTiles.updating\", \"pointsOfInterest.updating\", \"environmentManager.updating\", \"overlay.updating\", \"updatingHandles.updating\", \"featureTreeDebugger.updating\", \"labeler.updating\", \"deconflictor.updating\", \"ready\", \"stationary\", \"inputManager.hasPendingInputs\", \"toolViewManager.updating\"]\n})], ze.prototype, \"updating\", null), e([O({\n  type: Number,\n  readOnly: !0,\n  dependsOn: [\"updating\"]\n})], ze.prototype, \"updatingProgress\", void 0), e([O({\n  type: [\"global\", \"local\"],\n  dependsOn: [\"map.initialViewProperties?.viewingMode\", \"spatialReference\"]\n})], ze.prototype, \"viewingMode\", null), e([O({\n  type: s,\n  aliasOf: \"stateManager.viewpoint\"\n})], ze.prototype, \"viewpoint\", void 0), e([O({\n  type: Number,\n  aliasOf: \"stateManager.zoom\"\n})], ze.prototype, \"zoom\", void 0), e([O({\n  type: ce\n})], ze.prototype, \"highlightOptions\", void 0), ze = e([V(\"esri.views.SceneView\")], ze);\nconst Be = j(),\n      $e = T();\nvar Qe = ze;\nexport default Qe;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/SceneView.js"],"names":["_","e","t","i","r","s","n","byId","a","o","on","l","handlesGroup","p","makeHandle","h","d","c","isNone","u","isSome","g","unwrapOr","m","createAbortController","f","throwIfAborted","y","setFrameDuration","w","v","whenOnce","init","b","whenTrueOnce","R","initialize","x","screenPointObjectToArray","S","createScreenPoint","M","createScreenPointArray","T","property","O","cast","C","subclass","V","ensureType","P","j","E","projectPointToVector","I","projectVectorToVector","H","getSphericalPCPF","G","toExtent","U","B","L","A","getResolutionForScale","D","canProject","F","project","W","isTiledLayer","q","BreakpointsOwner","z","DOMContainer","k","N","PopupView","$","Q","viewingModeFromString","K","layerView3DImporter","Z","J","X","Y","ee","GraphicsDeconflictor","te","Labeler","ie","ObjectResourceCache","re","se","ne","ae","SceneIntersectionHelper","oe","CombinedElevationProvider","le","pe","he","getElevationAtPoint","de","ce","MapCoordsHelper","ue","PropertiesPool","ge","me","RenderCoordsHelper","fe","newResourceController","ye","we","SharedSymbolResources","ve","_e","be","isSurfaceLayerView","Re","getTiledLayerInfo","xe","Stage","Se","Intersector","Me","toGraphic","Te","toOwner","Oe","TERRAIN_ID","Ce","hitTestSelectSameDistance","Ve","occludeesSupported","Pe","toRenderSettings","je","screenshotSuperSampleSettings","Ee","isSupportedScreenPointEvent","Ie","createScreenPointFromSupportedEvent","He","isSpatialReferenceSupported","Ge","check","Ue","Le","Ae","De","Fe","We","qe","getLogger","ze","constructor","_clippingArea","_userClippingArea","_initialDefaultSpatialReference","_defaults","_externallySet","environment","_createGraphicsViewController","_resolveWhenReady","propertiesPool","slicePlane","_resourceController","_defaultToMapOptions","include","Set","_defaultHitTestOptions","exclude","deconflictor","view","labeler","labels","sharedSymbolResources","basemapTerrain","elevationProvider","camera","canvas","center","constraints","environmentManager","extent","floors","windowDevicePixelRatio","fullOpacity","graphicsView","groundView","navigating","map","screenSizePerspectiveEnabled","state","scale","spatialReference","isHeightModelInfoRequired","alphaCompositingEnabled","supersampleScreenhotsEnabled","type","ui","_numUpdating","_lastUpdateTime","updatingProgress","viewpoint","zoom","highlightOptions","notifyChange","updatingChanged","allLayers","forEach","when","handles","add","allLayerViews","_updateUpdatingMonitors","watch","load","catch","inputManager","window","devicePixelRatio","stateManager","updateDevicePixelRatio","_updateDefaultToMapOptions","updatingHandles","qualitySettings","resourceController","memoryController","maxMemory","additionalCacheMemory","Math","ceil","defaultsFromMap","logDebugInformation","_updateDefaultHitTestOptions","destroy","destroyed","invalidate","activeTool","layerViewManager","clear","_exitSurface","_disposeGraphicsView","_set","remove","renderSpatialReference","renderCoordsHelper","basemapSpatialReference","installContentCameraReset","sticky","clippingArea","viewingMode","get","error","equals","ready","dataExtent","WGS84","intersection","union","xmin","ymin","zmin","xmax","ymax","zmax","fullExtent","internal","hasZ","min","max","castEnvironment","cloneWithWebsceneEnvironment","fromWebsceneEnvironment","pixelRatio","maximumPixelRatio","_override","_clearOverride","maximumRenderResolution","width","height","groundExtent","_get","initialExtentRequired","hasInitialView","interacting","stationary","animation","resizing","qualityProfile","isValidProfile","apply","getDefaultProfile","_stage","renderView","setRenderParameters","resolution","heightModelInfo","getDefaultHeightModelInfo","deriveUnitFromSR","updating","updatingRemaining","isFulfilled","suspended","basemapView","featureTiles","pointsOfInterest","overlay","featureTreeDebugger","toolViewManager","hasPendingInputs","some","scheduler","now","indexOf","performanceInfo","viewEvents","hasEventListener","hasHandler","toMap","externalToInternalIntersectOptions","graphics","enableDraped","has","sceneIntersectionHelper","options","selectionMode","store","intersectIntersectorScreen","results","all","_intersectResultToMapPoint","_testGraphicUidFilter","toScreen","Be","projectToScreen","$e","pixelSizeAt","computeScreenPixelSizeAt","overlayPixelSizeInMapUnits","overlayManager","hitTest","requiresGroundFeedback","_intersectResultsToHits","ground","screenPoint","mapPoint","distance","hasIntersectionPoint","distanceInRenderSpace","layer","SCENEVIEW_HITTEST_RETURN_INTERSECTOR","intersector","Promise","resolve","popupHitTest","then","length","abs","goTo","addPromise","whenLayerView","takeScreenshot","whenReady","padding","addUpdatingPromise","importLayerView","hasLayerViewModule","forceDOMReadyCycle","forceReadyCycle","getDefaultSpatialReference","validate","requiredVersion","detectedVersion","warn","message","isGeographic","isWebMercator","_isOverridden","id","warnOnce","tileInfo","isWGS84","push","computeMapPointFromVec3d","trackGraphicState","graphic","getViewForGraphic","graphics3d","graphicsCore","whenViewForGraphic","waitForLayer","highlight","Array","isArray","isCollection","toArray","maskOccludee","find","graphicChanged","includes","added","_externalToInternalRenderItems","layerUids","graphicUids","getIntersectionPoint","_getGraphicFilterUid","attributes","objectIdField","uid","Ne","ke","_initBasemapTerrain","register","_exitBasemapTerrain","unregister","_initGlobe","_initCoordinateSystem","createInitialCamera","cameraOnSurface","contentCameraOnSurface","focus","tilingSchemeOwner","viewState","terrain","filterExtent","FeatureTileTree3DDebugger","FEATURE_TILE_TREE_SHOW_TILES","_exitGlobe","deinit","exit","_exitCoordinateSystem","mapCoordsHelper","isGlobal","create","setTolerance","DEFAULT_TOLERANCE","unitInMeters","_renderScreenshotOverlay","hasVisibleItems","getContext","putImageData","renderCanvas","getImageData","_initStage","renderContext","deactivatedWebGLExtensions","debugWebGLExtensions","alpha","screenshot","renderOverlay","forEachLayer","layers","forAll","surface","container","renderSR","_lostWebGLContextHandle","fatalError","antialiasingEnabled","highQualityTransparency","magnifier","defaultHighlightOptions","toEngineOptions","_exitStage","_initSurface","objectResourceCache","_createGraphicsViewIfNeeded","_createGraphicsViewAsync","signal","default","abort","_startup","setup","connectView","connect","_teardown","disconnect","disconnectView","dispose","items","opacity","prototype","readOnly","aliasOf","dependsOn","value","Number","Boolean","constructOnly","Qe"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import t from\"../Camera.js\";import\"../geometry.js\";import i from\"../Graphic.js\";import r from\"../Ground.js\";import s from\"../Viewpoint.js\";import n from\"../core/Collection.js\";import{byId as a}from\"../core/domUtils.js\";import o from\"../core/Error.js\";import{on as l}from\"../core/events.js\";import{handlesGroup as p,makeHandle as h}from\"../core/handleUtils.js\";import d from\"../core/has.js\";import c from\"../core/Logger.js\";import{isNone as u,isSome as g,unwrapOr as m}from\"../core/maybe.js\";import{createAbortController as f,throwIfAborted as y}from\"../core/promiseUtils.js\";import{setFrameDuration as w}from\"../core/scheduling.js\";import{on as v,whenOnce as _,init as b,whenTrueOnce as R}from\"../core/watchUtils.js\";import{initialize as x}from\"../core/workers/workers.js\";import{screenPointObjectToArray as S,createScreenPoint as M,createScreenPointArray as T}from\"../core/screenUtils.js\";import{property as O}from\"../core/accessorSupport/decorators/property.js\";import{cast as C}from\"../core/accessorSupport/decorators/cast.js\";import{subclass as V}from\"../core/accessorSupport/decorators/subclass.js\";import{ensureType as P}from\"../core/accessorSupport/ensureType.js\";import{c as j}from\"../chunks/vec3f64.js\";import E from\"../geometry/HeightModelInfo.js\";import{projectPointToVector as I,projectVectorToVector as H}from\"../geometry/projection.js\";import{getSphericalPCPF as G}from\"../geometry/projectionEllipsoid.js\";import{toExtent as U}from\"../geometry/support/aaBoundingRect.js\";import{B as L,c as A}from\"../chunks/boundedPlane.js\";import{getResolutionForScale as D}from\"../geometry/support/scaleUtils.js\";import{canProject as F,project as W}from\"../geometry/support/webMercatorUtils.js\";import{isTiledLayer as q}from\"../layers/support/layerUtils.js\";import{BreakpointsOwner as z}from\"./BreakpointsOwner.js\";import{DOMContainer as k}from\"./DOMContainer.js\";import N from\"./GroundView.js\";import{PopupView as B}from\"./PopupView.js\";import $ from\"./View.js\";import Q from\"./ViewAnimation.js\";import{viewingModeFromString as K}from\"./ViewingMode.js\";import{layerView3DImporter as Z}from\"./3d/layerViewModuleImportUtils.js\";import J from\"./3d/constraints/Constraints.js\";import X from\"./3d/environment/SceneViewEnvironment.js\";import Y from\"./3d/environment/SceneViewEnvironmentManager.js\";import ee from\"./3d/input/SceneInputManager.js\";import{GraphicsDeconflictor as te}from\"./3d/layers/graphics/GraphicsDeconflictor.js\";import{Labeler as ie}from\"./3d/layers/graphics/Labeler.js\";import{ObjectResourceCache as re}from\"./3d/layers/graphics/ObjectResourceCache.js\";import se from\"./3d/layers/support/FeatureTileTree3D.js\";import ne from\"./3d/state/ViewState.js\";import ae from\"./3d/state/ViewStateManager.js\";import{SceneIntersectionHelper as oe}from\"./3d/state/helpers/SceneIntersectionHelper.js\";import{CombinedElevationProvider as le}from\"./3d/support/CombinedElevationProvider.js\";import pe from\"./3d/support/debugFlags.js\";import he from\"./3d/support/DisplayQualityProfile.js\";import{getElevationAtPoint as de}from\"./3d/support/ElevationProvider.js\";import ce from\"./3d/support/HighlightOptions.js\";import{MapCoordsHelper as ue}from\"./3d/support/MapCoordsHelper.js\";import{PropertiesPool as ge}from\"./3d/support/PropertiesPool.js\";import me from\"./3d/support/QualitySettings.js\";import{RenderCoordsHelper as fe}from\"./3d/support/RenderCoordsHelper.js\";import{newResourceController as ye}from\"./3d/support/ResourceController.js\";import we from\"./3d/support/SceneViewPerformanceInfo.js\";import{SharedSymbolResources as ve}from\"./3d/support/SharedSymbolResources.js\";import _e from\"./3d/support/pointsOfInterest/PointsOfInterest.js\";import be from\"./3d/terrain/TerrainSurface.js\";import{isSurfaceLayerView as Re,getTiledLayerInfo as xe}from\"./3d/terrain/terrainUtils.js\";import{Stage as Se}from\"./3d/webgl-engine/Stage.js\";import{Intersector as Me}from\"./3d/webgl-engine/lib/Intersector.js\";import{toGraphic as Te,toOwner as Oe}from\"./3d/webgl-engine/lib/intersectorUtilsConversions.js\";import{TERRAIN_ID as Ce}from\"./3d/webgl-engine/lib/verticalOffsetUtils.js\";import{hitTestSelectSameDistance as Ve}from\"./support/hitTestSelectUtils.js\";import{occludeesSupported as Pe}from\"./support/layerViewUtils.js\";import{toRenderSettings as je,screenshotSuperSampleSettings as Ee}from\"./support/screenshotUtils.js\";import{isSupportedScreenPointEvent as Ie,createScreenPointFromSupportedEvent as He}from\"./support/screenUtils.js\";import{isSpatialReferenceSupported as Ge}from\"./support/spatialReferenceSupport.js\";import{check as Ue}from\"./support/WebGLRequirements.js\";import Le from\"./ui/3d/DefaultUI3D.js\";import Ae from\"../webscene/Environment.js\";import De from\"../geometry/Extent.js\";import Fe from\"../geometry/SpatialReference.js\";import We from\"../geometry/Point.js\";const qe=c.getLogger(\"esri.views.SceneView\");let ze=class extends(z(k(B($)))){constructor(e){super(e),this._clippingArea=null,this._userClippingArea=null,this._initialDefaultSpatialReference=null,this._defaults={},this._externallySet={environment:!1},this._createGraphicsViewController=null,this._resolveWhenReady=[],this.propertiesPool=new ge({slicePlane:L},this),this._resourceController=ye(this),this._defaultToMapOptions={include:new Set},this._defaultHitTestOptions={exclude:new Set},this.deconflictor=new te({view:this}),this.labeler=new ie({view:this,deconflictor:this.deconflictor.labels}),this.sharedSymbolResources=null,this.basemapTerrain=null,this.elevationProvider=null,this.camera=null,this.canvas=null,this.center=null,this.constraints=new J,this.environmentManager=new Y,this.extent=null,this.floors=new n,this.windowDevicePixelRatio=1,this.fullOpacity=1,this.graphicsView=null,this.groundView=null,this.navigating=!1,this.map=null,this.screenSizePerspectiveEnabled=!0,this.state=new ne,this.scale=null,this.spatialReference=null,this.isHeightModelInfoRequired=!0,this.alphaCompositingEnabled=!1,this.supersampleScreenhotsEnabled=!0,this.type=\"3d\",this.ui=new Le,this._numUpdating=0,this._lastUpdateTime=0,this.updatingProgress=.5,this.viewpoint=null,this.zoom=null,this.highlightOptions=new ce,x(),e&&e.environment||(this._defaults.environment=new X,this.environment=this._defaults.environment);const t=e=>{g(e)&&4===e.type||(this.notifyChange(\"dataExtent\"),this.updatingChanged(),this.map&&this.map.allLayers.forEach((async e=>{try{await e.when()}catch{}this.updatingChanged()})))};this.handles.add([v(this,\"map.allLayers\",\"after-changes\",t,t,t,!0),this.allLayerViews.on(\"after-changes\",(e=>this._updateUpdatingMonitors(e))),this.watch(\"map\",(e=>{e&&e.load&&e.load().catch((()=>{}))}))]),this.inputManager=new ee({view:this});const i=()=>{const e=window.devicePixelRatio;e!==this.windowDevicePixelRatio&&(this.windowDevicePixelRatio=e,this.notifyChange(\"pixelRatio\"))};this.stateManager=new ae({view:this,updateDevicePixelRatio:i})}initialize(){this.groundView=new N({view:this}),this._updateUpdatingMonitors();const e=()=>this._updateDefaultToMapOptions();this.handles.add(v(this,\"map.allLayers\",\"after-changes\",e,e,e)),this.updatingHandles.add(this.qualitySettings,\"memoryLimit\",(e=>{this.resourceController&&(this.resourceController.memoryController.maxMemory=e)}),2),this.updatingHandles.add(this.qualitySettings,\"additionalCacheMemory\",(e=>{this.resourceController&&(this.resourceController.memoryController.additionalCacheMemory=e)}),2),this.updatingHandles.add(this.qualitySettings,\"frameRate\",(e=>w(e>0?1e3/Math.ceil(e):0)),2),this.updatingHandles.add(pe,\"SCENEVIEW_LOCKING_LOG\",(e=>this.defaultsFromMap.logDebugInformation=e),2),this.updatingHandles.add(this,\"map.ground\",e,3),this.updatingHandles.add(this,\"map.ground.opacity\",(()=>this._updateDefaultHitTestOptions()),3),this.handles.add(this.watch(\"spatialReference\",(()=>this.notifyChange(\"clippingArea\")),!0))}destroy(){this.destroyed||(this.invalidate(),this.activeTool=null,this.layerViewManager.clear(),this._exitSurface(),this._disposeGraphicsView(),this.sharedSymbolResources&&(this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null),this.labeler.destroy(),this._set(\"labeler\",null),this.deconflictor.destroy(),this._set(\"deconflictor\",null),this._resourceController.destroy(),this._resourceController=null,this.stateManager.destroy(),this._set(\"stateManager\",null),this.inputManager.destroy(),this._set(\"inputManager\",null),this.propertiesPool.destroy(),this.handles.remove(\"updatingMonitors\"),this.environmentManager.destroy(),this._set(\"environmentManager\",null),this.groundView.destroy(),this.groundView=null)}get renderSpatialReference(){return this.renderCoordsHelper&&this.renderCoordsHelper.spatialReference}get basemapSpatialReference(){return this.basemapTerrain&&this.basemapTerrain.spatialReference}installContentCameraReset(e={sticky:!1}){return this.stateManager.installContentCameraReset(e)}get clippingArea(){if(\"global\"===this.viewingMode)return null;let e=this._userClippingArea||this.get(\"map.clippingArea\");if(!(!!this._userClippingArea||this.get(\"map.clippingEnabled\"))||!e)return this._clippingArea=null,null;if(!(e instanceof De))return qe.error(\"#clippingArea\",\"only clippingArea geometries of type Extent are supported\"),this._clippingArea;if(this.spatialReference){if(!F(e.spatialReference,this.spatialReference))return qe.error(\"#clippingArea\",\"setting clippingArea with incompatible SpatialReference\"),this._clippingArea;e=W(e,this.spatialReference)}return this._clippingArea&&e&&this._clippingArea.equals(e)?this._clippingArea:(this._clippingArea=e,e)}set clippingArea(e){this.ready&&\"global\"===this.viewingMode&&e?qe.error(\"#clippingArea=\",\"Clipping area is only supported in local viewingMode\"):(this._userClippingArea=e,this.notifyChange(\"clippingArea\"))}get dataExtent(){const e=this.spatialReference||Fe.WGS84;let t,i=this.clippingArea;i&&(i=W(i,e));const r=r=>{let s=W(r,e);s&&(i&&(s=s.intersection(i),!s)||(g(t)?t.union(s):t=s))},s=this.basemapTerrain;if(s&&s.spatialReference&&r(new De({xmin:s.extent[0],ymin:s.extent[1],zmin:0,xmax:s.extent[2],ymax:s.extent[3],zmax:0,spatialReference:s.spatialReference})),this.map){const e=e=>{!e.fullExtent||\"graphics\"===e.type&&e.internal||r(e.fullExtent)};this.map.allLayers.forEach((t=>e(t)))}return u(t)?new De({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0,spatialReference:e}):(t.hasZ?(t.zmin=Math.min(0,t.zmin),t.zmax=Math.max(0,t.zmax)):(t.zmin=0,t.zmax=0),t)}set environment(e){e!==this._defaults.environment&&(this._externallySet.environment=!0),this._set(\"environment\",e)}castEnvironment(e){return e?e instanceof X?e:e instanceof Ae?null!=this.environment?this.environment.cloneWithWebsceneEnvironment(e):X.fromWebsceneEnvironment(e):P(X,e):new X}get pixelRatio(){return Math.min(this.windowDevicePixelRatio,this.maximumPixelRatio)}set pixelRatio(e){g(e)?this._override(\"pixelRatio\",e):this._clearOverride(\"pixelRatio\")}get maximumPixelRatio(){let e=1/0;const{maximumPixelRatio:t,maximumRenderResolution:i}=this.qualitySettings;if(null!=t&&(e=Math.min(e,t)),null!=i){const t=i/Math.max(this.width,this.height);e=Math.min(e,t)}return e}set maximumPixelRatio(e){g(e)?this._override(\"maximumPixelRatio\",e):this._clearOverride(\"maximumPixelRatio\")}get groundExtent(){const e=this._get(\"basemapTerrain\");if(e&&e.spatialReference){const t=e.extent;return new De({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e.spatialReference})}const t=this.spatialReference||Fe.WGS84;return new De({spatialReference:t})}get initialExtentRequired(){return this.stateManager&&!this.stateManager.hasInitialView}get interacting(){return this.navigating||g(this.activeTool)}get stationary(){return!this.animation&&!this.resizing&&(u(this.state)||this.state.stationary)}set qualityProfile(e){he.isValidProfile(e)&&(he.apply(e,this.qualitySettings),this._set(\"qualityProfile\",e))}get qualityProfile(){return this._get(\"qualityProfile\")||he.getDefaultProfile()}set slicePlane(e){if(this._stage.renderView.setRenderParameters({slicePlane:e}),u(e))return void this._set(\"slicePlane\",null);const t=this.propertiesPool.get(\"slicePlane\");A(e,t),this._set(\"slicePlane\",t)}get resolution(){return null!=this.spatialReference?D(this.scale,this.spatialReference):0}get heightModelInfo(){const e=this.getDefaultHeightModelInfo();return null!=e?E.deriveUnitFromSR(e,this.spatialReference):null}get updating(){var e,t,i;let r=0,s=this.layerViewManager.updating,n=s?this.layerViewManager.updatingRemaining:0;this.allLayerViews.forEach((e=>{if(e.isFulfilled()){if(e.updating){if(s=!0,e.suspended||Re(e))return;++n,r+=\"updatingProgress\"in e?e.updatingProgress:.5}}else++n}));for(const a of[this.graphicsView,this.basemapView,this._resourceController,this._stage,this.featureTiles,this.pointsOfInterest,this.environmentManager,this.overlay,this.featureTreeDebugger,this.toolViewManager])if(g(a)&&a.updating){const e=.1;n+=e,r+=.5*e}for(const a of[this.deconflictor,this.labeler,this.basemapTerrain])g(a)&&a.updating&&(++n,r+=a.updatingProgress);if(s=!!(s||n>0||this.updatingHandles.updating||!this.ready||!this.stationary||this._createGraphicsViewController||null!=(e=this.inputManager)&&e.hasPendingInputs||null!=(t=this.map)&&null!=(i=t.allLayers)&&i.some((e=>!e.isFulfilled()))),s?(this._numUpdating=Math.max(n,this._numUpdating),r+=this._numUpdating-n):this._numUpdating=0,this._numUpdating>0?r/=this._numUpdating:r=s?0:1,this._get(\"updatingProgress\")!==r){const e=this._resourceController.scheduler.now;if(r<1){const t=Math.min((e-this._lastUpdateTime)/2e3,1);r=this.updatingProgress*(1-t)+r*t}this._set(\"updatingProgress\",r),this._lastUpdateTime=s&&r<1?e:0}return s}get viewingMode(){const e=this.get(\"map.initialViewProperties.viewingMode\");if(e)return e;const t=this.spatialReference;return!t||Ge(t,\"global\")?\"global\":\"local\"}set viewingMode(e){if(this.ready)qe.error(\"#viewingMode\",\"viewingMode cannot be set once view is ready\");else{[\"local\",\"global\"].indexOf(e)>=0?this._override(\"viewingMode\",e):void 0===e&&this._clearOverride(\"viewingMode\")}}get resourceController(){return this._resourceController}get performanceInfo(){return new we(this)}on(e,t,i,r){const s=this.viewEvents.on(e,t,i,r);return s||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}toMap(e,t){if(!this.ready)return qe.error(\"#toMap()\",\"Scene view cannot be used before it is ready\"),null;const i=t?this.externalToInternalIntersectOptions(t):this._defaultToMapOptions,r=g(i.graphics)&&(g(i.graphics.include)||g(i.graphics.exclude)),s=Ie(e)?He(this,e):e,n=S(s);i.enableDraped=i.include&&!i.include.has(Ce)||i.exclude&&i.exclude.has(Ce);const a=this.sceneIntersectionHelper,o=new Me(this.state.viewingMode);if(o.options.selectionMode=!0,o.options.store=r?2:0,a.intersectIntersectorScreen(n,o,i),r){for(const e of o.results.all){const t=Te(e,this);if(u(t))return this._intersectResultToMapPoint(e);if(this._testGraphicUidFilter(i.graphics,t))return this._intersectResultToMapPoint(e)}return null}return this._intersectResultToMapPoint(o.results.min)}toScreen(e){if(!this.ready)return qe.error(\"#toScreen()\",\"Scene view cannot be used before it is ready\"),null;const t=m(null==e.z&&de(this.elevationProvider,e),0);return I(e,Be,this.renderSpatialReference,t),this.state.camera.projectToScreen(Be,$e),M($e[0],$e[1])}pixelSizeAt(e){return this.ready?e?(I(e,Be,this.renderSpatialReference),this.state.camera.computeScreenPixelSizeAt(Be)):0:(qe.error(\"#pixelSizeAt()\",\"Scene view cannot be used before it is ready\"),null)}overlayPixelSizeInMapUnits(e){const t=this.basemapTerrain.overlayManager;return t?t.overlayPixelSizeInMapUnits(e):1}hitTest(e,t){if(!this.ready)return qe.error(\"#hitTest()\",\"Scene view cannot be used before it is ready\"),null;const i=Ie(e)?He(this,e):e,r=T(i.x,i.y),s=t?this.externalToInternalIntersectOptions(t):this._defaultHitTestOptions;s.requiresGroundFeedback=!0,s.enableDraped=!0;const n=new Me(this.state.viewingMode);n.options.selectionMode=!0,n.options.store=2,this.sceneIntersectionHelper.intersectIntersectorScreen(r,n,s);const a=this._intersectResultsToHits(n.results.all,s.graphics),o=n.results.ground,l=Oe(o,this),p=g(l)&&\"type\"in l&&\"integrated-mesh\"===l.type?l:null,h={screenPoint:i,results:a,ground:{mapPoint:this._intersectResultToMapPoint(o),distance:o.hasIntersectionPoint?o.distanceInRenderSpace:0,layer:p}};return pe.SCENEVIEW_HITTEST_RETURN_INTERSECTOR&&(h.intersector=n),Promise.resolve(h)}popupHitTest(e){return Ve(this,e).then((({results:t,ground:i})=>{let r=null;return!(0===t.length||Math.abs(t[0].distance-i.distance)<1e-5)||i.layer&&\"integrated-mesh\"===i.layer.type||(r=i.mapPoint),{results:t,screenPoint:e,mapPoint:r}}))}goTo(e,t){return this.updatingHandles.addPromise(this.stateManager.goTo(e,t))}whenLayerView(e){return super.whenLayerView(e)}takeScreenshot(e){return this.whenReady().then((()=>{const t=je(e,this);return t.pixelRatio/=this.pixelRatio,this._stage.renderView.takeScreenshot(Ee(t,this.supersampleScreenhotsEnabled,this.padding))}))}addUpdatingPromise(e){return this.updatingHandles.addPromise(e)}importLayerView(e){return Z.importLayerView(e)}hasLayerViewModule(e){return Z.hasLayerViewModule(e)}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.get(\"map.initialViewProperties.spatialReference\")||this.get(\"defaultsFromMap.spatialReference\")||this.get(\"defaultsFromMap.isSpatialReferenceDone\")&&this._initialDefaultSpatialReference||null}async validate(){let e=Ue();if(d(\"safari\")&&d(\"safari\")<9&&(e=new o(\"sceneview:browser-not-supported\",\"This browser is not supported by SceneView (Safari < 9)\",{type:\"safari\",requiredVersion:9,detectedVersion:d(\"safari\")})),g(e))throw qe.warn(\"#validate()\",e.message),e}isSpatialReferenceSupported(e,t,i){const r=e.isGeographic,s=e.isWebMercator,n=Ge(e,\"global\"),a=\"local\"===this.viewingMode,o=!(!this._isOverridden(\"viewingMode\")&&!this.get(\"map.initialViewProperties.viewingMode\"));if(o){if(a&&r)return i?i(`Layer ${t.id} is ignored because it is GCS and viewing mode is local`):qe.warnOnce(\"Geographic coordinate systems are not supported in local viewing mode.\"),!1;if(!a&&!n)return i?i(`Layer ${t.id} is ignored because its spatial reference is not supported in global viewing mode`):qe.warnOnce(\"Spatial reference defined on view not supported in global viewing mode.\"),!1}else if(r&&!n)return i?i(`Layer ${t.id} is ignored because its spatial reference is geographic but unsupported`):qe.warnOnce(\"Spatial reference is geographic but not supported.\"),!1;if(t)if(q(t)){let r;if(o){r=null!=xe(t,e,K(this.viewingMode)).tileInfo}else{let i=xe(t,e,1);null==i.tileInfo&&(i=xe(t,e,2),null!=i.tileInfo&&s&&!this.ready&&(this.viewingMode=\"local\")),r=null!=i.tileInfo}if(!r)return i&&i(`Layer ${t.id} is ignored because it is tiled but\\n            its tiling scheme is not supported or compatible with the viewing mode`),!1}else if((e.isWGS84||s)&&!a)return null==this._initialDefaultSpatialReference&&(this._initialDefaultSpatialReference=e),o||this.ready||(this.viewingMode=\"global\",i&&i(`Viewing mode locked to global due to reprojectable layer ${t.id}`)),i&&i(`Layer ${t.id} is ignored because it supports server-side reprojection`),!1;return!0}whenReady(){return new Promise((e=>{this.ready?e(this):this._resolveWhenReady.push(e)}))}computeMapPointFromVec3d(e,t){let i=this.spatialReference||Fe.WGS84;return H(e,this.renderSpatialReference,e,i)||(i=Fe.WGS84,H(e,this.renderSpatialReference,e,i)),t?(t.x=e[0],t.y=e[1],t.z=e[2],t.spatialReference=i):t=new We(e,i),t}trackGraphicState(e){if(!e.graphic)return qe.error(\"trackGraphicState\",\"GraphicState.graphic must not be null or undefined to start tracking\"),null;const t=this.getViewForGraphic(e.graphic);let i=null,r=!1;const s=t=>{!r&&g(t)&&\"graphics3d\"in t&&t.graphics3d&&t.graphics3d.graphicsCore&&(i=t.graphics3d.graphicsCore.trackGraphicState(e))};return g(t)?s(t):this.whenViewForGraphic(e.graphic,{waitForLayer:!0}).then((e=>s(e)),(()=>{})).catch((()=>{})),{remove:()=>{r=!0,g(i)&&(i.remove(),i=null)}}}highlight(e){if(Array.isArray(e))return p(e.map((e=>this.highlight(e))));if(n.isCollection(e))return p(e.toArray().map((e=>this.highlight(e))));const t=this.getViewForGraphic(e);return t&&\"highlight\"in t?t.highlight(e):h()}maskOccludee(e){if(!e)return qe.error(\"maskOccludee\",\"GraphicState.graphic must not be null or undefined to mask an occludee\"),null;const t=this.getViewForGraphic(e);let i=null,r=!1;const s=t=>{!r&&g(t)&&\"graphics3d\"in t&&Pe(t)&&(i=t.maskOccludee(e))};return g(t)?s(t):this.whenViewForGraphic(e,{waitForLayer:!0}).then((e=>s(e)),(()=>{})).catch((()=>{})),{remove:()=>{r=!0,g(i)&&(i.remove(),i=null)}}}getViewForGraphic(e){return e.layer===this.graphics?this.graphicsView:e.layer?this.allLayerViews.find((t=>t.layer===e.layer)):null}graphicChanged(e){g(this.graphicsView)&&this.graphicsView.graphicChanged(e)}async whenViewForGraphic(e,t){if(e.layer===this)return await _(this,\"graphicsView\"),this.graphicsView;if(!e.layer||!this.map)throw new o(\"no-view-for-graphic\");return t&&t.waitForLayer&&!this.map.allLayers.includes(e.layer)?new Promise(((t,i)=>{const r=this.map.allLayers.on(\"change\",(s=>{-1!==s.added.indexOf(e.layer)&&(r.remove(),this.whenLayerView(e.layer).then(t,i))}))})):this.whenLayerView(e.layer)}externalToInternalIntersectOptions(e){const t=this._externalToInternalRenderItems(e.include,0),i=this._externalToInternalRenderItems(e.exclude,1);return{include:t.layerUids,exclude:i.layerUids,graphics:{include:t.graphicUids,exclude:i.graphicUids}}}_intersectResultToMapPoint(e,t){return e.getIntersectionPoint(Be)?(t=this.computeMapPointFromVec3d(Be,t),\"TerrainRenderer\"===e.intersector&&this.basemapTerrain&&(t.z=m(de(this.basemapTerrain,t),0)),t):null}_intersectResultsToHits(e,t){const i=new Array;let r=null;for(let s=0;s<e.length;s++){const n=e[s],a=Oe(n,this);if(g(a)&&(a===this.map.ground||\"type\"in a&&\"integrated-mesh\"===a.type))break;const o=Te(n,this);if(!g(o))continue;if(u(r)&&s!==e.length-1&&(r=new Set),g(r)){const e=this._getGraphicFilterUid(o);if(r.has(e))continue;r.add(e)}if(!this._testGraphicUidFilter(t,o))continue;const l=this._intersectResultToMapPoint(n),p=n.distanceInRenderSpace;i.push({graphic:o,mapPoint:l,distance:p})}return i}_getGraphicFilterUid(e){if(e.layer&&\"objectIdField\"in e.layer){const t=e.attributes[e.layer.objectIdField];if(t)return`o-${e.layer.id}-${t}`}return`u-${e.uid}`}_testGraphicUidFilter(e,t){const i=this._getGraphicFilterUid(t);return u(e)||(u(e.include)||e.include.has(i))&&(u(e.exclude)||!e.exclude.has(i))}_externalToInternalRenderItems(e,t,s={layerUids:null,graphicUids:null}){return e?(e instanceof i?(Ne(s,this._getGraphicFilterUid(e)),0===t&&(g(this.graphicsView)&&e.layer===this?ke(s,this.graphicsView.graphics3d.layer.id):e.layer&&ke(s,e.layer.uid))):\"forEach\"in e?e.forEach((e=>{Array.isArray(e)?this._externalToInternalRenderItems(e,t,s):n.isCollection(e)?e===this.graphics&&g(this.graphicsView)?ke(s,this.graphicsView.graphics3d.layer.id):this._externalToInternalRenderItems(e,t,s):e instanceof r?e===this.map.ground&&ke(s,Ce):this._externalToInternalRenderItems(e,t,s)})):ke(s,e.uid),s):s}_initBasemapTerrain(){this._set(\"basemapTerrain\",new be({view:this})),this._set(\"elevationProvider\",new le({view:this})),this.elevationProvider.register(\"ground\",this.basemapTerrain)}_exitBasemapTerrain(){this.basemapTerrain&&(this.elevationProvider.unregister(this.basemapTerrain),this.elevationProvider.destroy(),this._set(\"elevationProvider\",null),this.basemapTerrain.destroy(),this._set(\"basemapTerrain\",null))}_initGlobe(){this._initCoordinateSystem(),this.state.createInitialCamera(),this._initBasemapTerrain(),this._set(\"pointsOfInterest\",new _e({view:this})),this._set(\"featureTiles\",new se({renderCoordsHelper:this.renderCoordsHelper,cameraOnSurface:this.pointsOfInterest.contentCameraOnSurface,focus:this.pointsOfInterest.focus,tilingSchemeOwner:this.basemapTerrain,viewState:this.state,scheduler:this._resourceController.scheduler,terrain:this.basemapTerrain}));const e=()=>{const e=this.basemapTerrain&&this.basemapTerrain.extent;if(this.clippingArea||e)if(e&&this.basemapTerrain.spatialReference){const e=U(this.basemapTerrain.extent,this.basemapTerrain.spatialReference);this.clippingArea?this.featureTiles.filterExtent=e.intersection(this.clippingArea):this.featureTiles.filterExtent=e}else this.featureTiles.filterExtent=this.clippingArea;else this.featureTiles.filterExtent=null};this.handles.add([this.updatingHandles.add(pe,\"FEATURE_TILE_TREE_SHOW_TILES\",(e=>{e&&this.featureTiles&&!this.featureTreeDebugger?this.updatingHandles.addPromise(import(\"./3d/layers/support/FeatureTileTree3DDebugger.js\")).then((({FeatureTileTree3DDebugger:e})=>{!this.featureTreeDebugger&&pe.FEATURE_TILE_TREE_SHOW_TILES&&(this.featureTreeDebugger=new e({view:this}))})):e||!this.featureTreeDebugger||pe.FEATURE_TILE_TREE_SHOW_TILES||(this.featureTreeDebugger.destroy(),this.featureTreeDebugger=null)}),3),this.updatingHandles.add(this,\"clippingArea\",e,3),this.updatingHandles.add(this,\"basemapTerrain.extent\",e,3)],\"feature-tiles\"),this.stateManager.init()}_exitGlobe(){this.state&&(this.stateManager.deinit(),this.handles.remove(\"render-coords-helper\"),this.handles.remove(\"feature-tiles\"),this.featureTiles.destroy(),this._set(\"featureTiles\",null),this.pointsOfInterest.destroy(),this._set(\"pointsOfInterest\",null),this._exitBasemapTerrain(),this.state.exit(),this._exitCoordinateSystem())}_initCoordinateSystem(){if(this.spatialReference){const e=this.spatialReference;this.mapCoordsHelper&&this.mapCoordsHelper.spatialReference.equals(e)||this._set(\"mapCoordsHelper\",new ue(this.map,e));const t=this.state.isGlobal,i=t?G(e):e;i!==this.renderSpatialReference&&(this._set(\"renderCoordsHelper\",fe.create(this.state.viewingMode,i)),t||this.handles.add(this.watch(\"basemapTerrain.extent\",(e=>{0===e[0]&&0===e[1]&&0===e[2]&&0===e[3]||(this.renderCoordsHelper.extent=e)}),!0),\"render-coords-helper\"),this.sceneIntersectionHelper&&this.sceneIntersectionHelper.setTolerance(Me.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters))}else this._set(\"mapCoordsHelper\",null),this._set(\"renderCoordsHelper\",null)}_exitCoordinateSystem(){this.mapCoordsHelper&&(this.handles.remove(\"render-coords-helper\"),this._set(\"renderCoordsHelper\",null),this._set(\"mapCoordsHelper\",null))}updatingChanged(){this.notifyChange(\"updating\")}_updateUpdatingMonitors(e=null){g(e)&&4===e.type||(this.handles.remove(\"updatingMonitors\"),this.allLayerViews.forEach((e=>{e.destroyed||(this.handles.add([e.watch([\"updating\",\"updatingProgress\"],(()=>this.updatingChanged()),!0)],\"updatingMonitors\"),e.when((()=>this.updatingChanged()),(()=>this.updatingChanged())))})),this.updatingChanged())}_renderScreenshotOverlay(e,t){if(!this.overlay||!this.overlay.hasVisibleItems)return t;const i=e.getContext(\"2d\");return i.putImageData(t,0,0),this.overlay.renderCanvas(e),i.getImageData(0,0,t.width,t.height)}_initStage(){const e={renderContext:this.renderContext,deactivatedWebGLExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions,alpha:this.alphaCompositingEnabled,canvas:this.renderCanvas,screenshot:{renderOverlay:(e,t)=>this._renderScreenshotOverlay(e,t)}},t=new oe(this.state.viewingMode,{forEachLayer:e=>this._stage.layers.forAll(e)},this);this._set(\"sceneIntersectionHelper\",t);const i=a(this.surface),{resourceController:r,state:s,renderSpatialReference:n}=this;this._stage=new Se({resourceController:r,container:i,options:e,state:s,sceneIntersectionHelper:t,renderSR:n}),this._lostWebGLContextHandle=l(this._stage.renderView.canvas,\"webglcontextlost\",(()=>this.fatalError=new o(\"webgl-context-lost\"))),this.handles.add([this.updatingHandles.add(this.qualitySettings,\"antialiasingEnabled\",(()=>{this._stage.renderView.setRenderParameters({antialiasingEnabled:this.qualitySettings.antialiasingEnabled})}),2),this.updatingHandles.add(this.qualitySettings,\"highQualityTransparency\",(()=>{this._stage.renderView.setRenderParameters({highQualityTransparency:this.qualitySettings.highQualityTransparency})}),2),b(this,\"magnifier\",(e=>this._stage.renderView.magnifier=e),!0)],\"stage\");const p=()=>{this._stage.renderView.setRenderParameters({defaultHighlightOptions:ce.toEngineOptions(this.highlightOptions)})};for(const a of[\"highlightOptions\",\"highlightOptions.color\",\"highlightOptions.haloColor\",\"highlightOptions.haloOpacity\",\"highlightOptions.fillOpacity\",\"highlightOptions.shadowOpacity\",\"highlightOptions.shadowColor\",\"highlightOptions.shadowDifference\"])this.handles.add(this.updatingHandles.add(this,a,p),\"stage\");p(),this.renderCoordsHelper&&this.sceneIntersectionHelper.setTolerance(Me.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters),this._set(\"canvas\",this._stage.renderView.canvas)}_exitStage(){this._set(\"sceneIntersectionHelper\",null),this._stage.destroy(),this._stage=null,this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null,this.handles.remove(\"stage\"),this._set(\"canvas\",null)}_initSurface(e){this._exitSurface(),this.state.init(e,this.spatialReference),this._initStage(),this._initGlobe(),this.sharedSymbolResources=new ve({view:this,viewingMode:e,resourceController:this._resourceController,pointsOfInterest:this.pointsOfInterest,viewState:this.state,objectResourceCache:new re})}_exitSurface(){this.sharedSymbolResources&&(this.sharedSymbolResources.objectResourceCache.destroy(),this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null,this._exitGlobe(),this._exitStage())}_createGraphicsViewIfNeeded(){if(this.graphicsView||this._createGraphicsViewController)return;if(0===this.graphics.length)return;this.handles.remove(\"graphics-view\"),this._createGraphicsViewController=f();const e=()=>{this._createGraphicsViewController=null,this.updatingChanged()};this._createGraphicsViewAsync(this._createGraphicsViewController.signal).then(e,e),this.updatingChanged()}async _createGraphicsViewAsync(e){const t=(await import(\"./3d/layers/GraphicsView3D.js\")).default;y(e),await R(this.basemapTerrain,\"ready\",e),this._set(\"graphicsView\",new t({view:this}))}_disposeGraphicsView(){this._createGraphicsViewController&&(this._createGraphicsViewController.abort(),this._createGraphicsViewController=null),this.handles.remove(\"graphics-view\"),g(this.graphicsView)&&(this.handles.remove(this.graphicsView.graphics3d.layer.id),this.graphicsView.destroy(),this._set(\"graphicsView\",null))}_startup(){const e=K(this.viewingMode);if(1===e&&(this._clippingArea=null),this._set(\"ready\",!0),this._initSurface(e),this.handles.add(v(this,\"graphics\",\"after-changes\",(()=>this._createGraphicsViewIfNeeded())),\"graphics-view\"),this._createGraphicsViewIfNeeded(),!this._externallySet.environment){const e=this.get(\"map.initialViewProperties.environment\");e&&(this.environment=e)}this.labeler.setup(),this.environmentManager.connectView(this),this.inputManager.connect();const t=this._resolveWhenReady;this._resolveWhenReady=[],t.forEach((e=>e(this)))}_teardown(){this._initialDefaultSpatialReference=null,this.inputManager.disconnect(),this.environmentManager.disconnectView(),this.labeler.dispose(),this._disposeGraphicsView(),this.handles.remove(\"graphics-view\"),this._exitSurface(),this._set(\"ready\",!1)}_updateDefaultToMapOptions(){if(this._defaultToMapOptions.include.clear(),this.map){this.map.ground&&this._defaultToMapOptions.include.add(Ce);for(const e of this.map.allLayers.items)\"integrated-mesh\"===e.type&&this._defaultToMapOptions.include.add(e.uid)}}_updateDefaultHitTestOptions(){if(this._defaultHitTestOptions.exclude.clear(),this.map){this.map.ground&&this.map.ground.opacity<1&&this._defaultHitTestOptions.exclude.add(Ce);for(const e of this.map.allLayers.items)\"integrated-mesh\"===e.type&&e.opacity<1&&this._defaultToMapOptions.exclude.add(e.uid)}}};function ke(e,t){e.layerUids||(e.layerUids=new Set),e.layerUids.add(t)}function Ne(e,t){e.graphicUids||(e.graphicUids=new Set),e.graphicUids.add(t)}e([O()],ze.prototype,\"_resourceController\",void 0),e([O()],ze.prototype,\"_stage\",void 0),e([O({readOnly:!0})],ze.prototype,\"deconflictor\",void 0),e([O({readOnly:!0})],ze.prototype,\"labeler\",void 0),e([O({type:Q,readOnly:!0,aliasOf:\"state.animation\"})],ze.prototype,\"animation\",void 0),e([O({readOnly:!0})],ze.prototype,\"basemapTerrain\",void 0),e([O({readOnly:!0})],ze.prototype,\"elevationProvider\",void 0),e([O({type:t,aliasOf:\"stateManager.camera\"})],ze.prototype,\"camera\",void 0),e([O({type:t,aliasOf:\"stateManager.contentCamera\"})],ze.prototype,\"contentCamera\",void 0),e([O({readOnly:!0})],ze.prototype,\"canvas\",void 0),e([O({type:We,aliasOf:\"stateManager.center\"})],ze.prototype,\"center\",void 0),e([O({type:De,dependsOn:[\"map.clippingArea?\",\"map.clippingEnabled?\",\"viewingMode\"]})],ze.prototype,\"clippingArea\",null),e([O({type:J})],ze.prototype,\"constraints\",void 0),e([O({type:De,dependsOn:[\"basemapTerrain.extent\",\"clippingArea\",\"map\"],readOnly:!0})],ze.prototype,\"dataExtent\",null),e([O({value:null,type:X})],ze.prototype,\"environment\",null),e([C(\"environment\")],ze.prototype,\"castEnvironment\",null),e([O({readOnly:!0})],ze.prototype,\"environmentManager\",void 0),e([O({type:De,aliasOf:\"stateManager.extent\"})],ze.prototype,\"extent\",void 0),e([O()],ze.prototype,\"floors\",void 0),e([O({readOnly:!0,aliasOf:\"stateManager.screenCenter\"})],ze.prototype,\"screenCenter\",void 0),e([O({type:Number})],ze.prototype,\"pixelRatio\",null),e([O({type:Number,dependsOn:[\"qualitySettings.maximumPixelRatio\",\"qualitySettings.maximumRenderResolution\",\"size\"]})],ze.prototype,\"maximumPixelRatio\",null),e([O({aliasOf:\"stateManager.frustum\"})],ze.prototype,\"frustum\",void 0),e([O({type:Number,readOnly:!0})],ze.prototype,\"fullOpacity\",void 0),e([O({readOnly:!0})],ze.prototype,\"graphicsView\",void 0),e([O({type:De,dependsOn:[\"basemapTerrain.extent\"],readOnly:!0})],ze.prototype,\"groundExtent\",null),e([O()],ze.prototype,\"groundView\",void 0),e([O({type:Boolean})],ze.prototype,\"initialExtentRequired\",null),e([O({type:Boolean,readOnly:!0})],ze.prototype,\"interacting\",null),e([O()],ze.prototype,\"stationary\",null),e([O({aliasOf:\"state.navigating\"})],ze.prototype,\"navigating\",void 0),e([O()],ze.prototype,\"map\",void 0),e([O({readOnly:!0})],ze.prototype,\"mapCoordsHelper\",void 0),e([O({aliasOf:\"stateManager.padding\"})],ze.prototype,\"padding\",void 0),e([O({type:_e,readOnly:!0})],ze.prototype,\"pointsOfInterest\",void 0),e([O({type:se,readOnly:!0})],ze.prototype,\"featureTiles\",void 0),e([O()],ze.prototype,\"featureTreeDebugger\",void 0),e([O({type:Boolean})],ze.prototype,\"screenSizePerspectiveEnabled\",void 0),e([O({constructOnly:!0})],ze.prototype,\"deactivatedWebGLExtensions\",void 0),e([O({constructOnly:!0})],ze.prototype,\"debugWebGLExtensions\",void 0),e([O({constructOnly:!0})],ze.prototype,\"renderCanvas\",void 0),e([O({constructOnly:!0})],ze.prototype,\"state\",void 0),e([O({readOnly:!0})],ze.prototype,\"inputManager\",void 0),e([O({readOnly:!0})],ze.prototype,\"stateManager\",void 0),e([O({type:[\"low\",\"medium\",\"high\"]})],ze.prototype,\"qualityProfile\",null),e([O({type:me,get(){let e=this._get(\"qualitySettings\");return e||(e=new me,he.apply(this.qualityProfile,e)),e}})],ze.prototype,\"qualitySettings\",void 0),e([O()],ze.prototype,\"slicePlane\",null),e([O({dependsOn:[\"viewingMode\"]})],ze.prototype,\"preconditionsReady\",void 0),e([O({readOnly:!0})],ze.prototype,\"renderCoordsHelper\",void 0),e([O({readOnly:!0})],ze.prototype,\"sceneIntersectionHelper\",void 0),e([O({type:Number,dependsOn:[\"scale\",\"spatialReference\"],readOnly:!0})],ze.prototype,\"resolution\",null),e([O({type:Number,aliasOf:\"stateManager.scale\"})],ze.prototype,\"scale\",void 0),e([O({dependsOn:[]})],ze.prototype,\"heightModelInfo\",null),e([O({dependsOn:[\"map.initialViewProperties?.spatialReference\",\"defaultsFromMap.isSpatialReferenceDone\"]})],ze.prototype,\"spatialReference\",void 0),e([O({type:Boolean,constructOnly:!0})],ze.prototype,\"alphaCompositingEnabled\",void 0),e([O({type:Boolean})],ze.prototype,\"supersampleScreenhotsEnabled\",void 0),e([O({readOnly:!0})],ze.prototype,\"type\",void 0),e([O({type:Le})],ze.prototype,\"ui\",void 0),e([O({type:Boolean,readOnly:!0,dependsOn:[\"graphicsView.updating\",\"basemapView.updating\",\"basemapTerrain.updating\",\"layerViewManager.updating\",\"layerViewManager.updatingRemaining\",\"_resourceController.updating\",\"_stage.updating\",\"featureTiles.updating\",\"pointsOfInterest.updating\",\"environmentManager.updating\",\"overlay.updating\",\"updatingHandles.updating\",\"featureTreeDebugger.updating\",\"labeler.updating\",\"deconflictor.updating\",\"ready\",\"stationary\",\"inputManager.hasPendingInputs\",\"toolViewManager.updating\"]})],ze.prototype,\"updating\",null),e([O({type:Number,readOnly:!0,dependsOn:[\"updating\"]})],ze.prototype,\"updatingProgress\",void 0),e([O({type:[\"global\",\"local\"],dependsOn:[\"map.initialViewProperties?.viewingMode\",\"spatialReference\"]})],ze.prototype,\"viewingMode\",null),e([O({type:s,aliasOf:\"stateManager.viewpoint\"})],ze.prototype,\"viewpoint\",void 0),e([O({type:Number,aliasOf:\"stateManager.zoom\"})],ze.prototype,\"zoom\",void 0),e([O({type:ce})],ze.prototype,\"highlightOptions\",void 0),ze=e([V(\"esri.views.SceneView\")],ze);const Be=j(),$e=T();var Qe=ze;export default Qe;\n"]},"metadata":{},"sourceType":"module"}