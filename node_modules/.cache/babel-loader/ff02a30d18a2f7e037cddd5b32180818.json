{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport \"../../core/has.js\";\nimport { isSome as e, isNone as t, unwrap as l } from \"../../core/maybe.js\";\nimport { loadArcade as r } from \"../../support/arcadeOnDemand.js\";\nimport { applyColorToSymbol as a, applySizesToSymbol as i, applyRotationToSymbol as n, getColorFromSymbol as o, applyOpacityToColor as s } from \"./utils.js\";\nlet c = null;\n\nfunction u(e, t) {\n  return Math.floor(Math.random() * (t - e + 1) + e);\n}\n\nfunction y(e, t, l) {\n  const {\n    backgroundColor: r,\n    outline: a,\n    dotSize: i\n  } = e,\n        n = l && l.swatchSize || 22,\n        o = .8,\n        s = Math.round(n * n / i ** 2 * o),\n        y = window.devicePixelRatio,\n        p = document.createElement(\"canvas\"),\n        h = n * y;\n  p.width = h, p.height = h, p.style.width = p.width / y + \"px\", p.style.height = p.height / y + \"px\";\n  const b = p.getContext(\"2d\");\n  if (r && (b.fillStyle = r.toCss(!0), b.fillRect(0, 0, h, h), b.fill()), b.fillStyle = t.toCss(!0), c && c.length / 2 === s) for (let u = 0; u < 2 * s; u += 2) {\n    const e = c[u],\n          t = c[u + 1];\n    b.fillRect(e, t, i * y, i * y), b.fill();\n  } else {\n    c = [];\n\n    for (let e = 0; e < 2 * s; e += 2) {\n      const e = u(0, h),\n            t = u(0, h);\n      c.push(e, t), b.fillRect(e, t, i * y, i * y), b.fill();\n    }\n  }\n  a && (a.color && (b.strokeStyle = a.color.toCss(!0)), b.lineWidth = a.width, b.strokeRect(0, 0, h, h));\n  const d = new Image(n, n);\n  return d.src = p.toDataURL(), d;\n}\n\nfunction p(e, t = {}) {\n  const l = 24,\n        r = 75,\n        a = \"horizontal\" === t.align,\n        i = a ? r : l,\n        n = a ? l : r,\n        {\n    width: o = i,\n    height: s = n,\n    gradient: c = !0\n  } = t,\n        u = window.devicePixelRatio,\n        y = o * u,\n        p = s * u,\n        h = document.createElement(\"canvas\");\n  h.width = y, h.height = p, h.style.width = `${o}px`, h.style.height = `${s}px`;\n  const b = h.getContext(\"2d\"),\n        d = a ? y : 0,\n        m = a ? 0 : p;\n\n  if (c) {\n    const t = b.createLinearGradient(0, 0, d, m),\n          l = e.length,\n          r = 1 === l ? 0 : 1 / (l - 1);\n    e.forEach((e, l) => t.addColorStop(l * r, e.toString())), b.fillStyle = t, b.fillRect(0, 0, y, p);\n  } else {\n    const t = a ? y / e.length : y,\n          l = a ? p : p / e.length;\n    let r = 0,\n        i = 0;\n\n    for (const n of e) b.fillStyle = n.toString(), b.fillRect(r, i, t, l), r = a ? r + t : 0, i = a ? 0 : i + l;\n  }\n\n  const f = document.createElement(\"div\");\n  return f.style.width = `${o}px`, f.style.height = `${s}px`, f.appendChild(h), f;\n}\n\nasync function h(e, t) {\n  switch (e.type) {\n    case \"web-style\":\n      {\n        const {\n          previewWebStyleSymbol: l\n        } = await import(\"./previewWebStyleSymbol.js\");\n        return l(e, h, t);\n      }\n\n    case \"label-3d\":\n    case \"line-3d\":\n    case \"mesh-3d\":\n    case \"point-3d\":\n    case \"polygon-3d\":\n      {\n        const {\n          previewSymbol3D: l\n        } = await import(\"./previewSymbol3D.js\");\n        return l(e, t);\n      }\n\n    case \"simple-marker\":\n    case \"simple-line\":\n    case \"simple-fill\":\n    case \"picture-marker\":\n    case \"picture-fill\":\n    case \"text\":\n      {\n        const {\n          previewSymbol2D: l\n        } = await import(\"./previewSymbol2D.js\");\n        return l(e, t);\n      }\n\n    case \"cim\":\n      {\n        const {\n          previewCIMSymbol: l\n        } = await import(\"./previewCIMSymbol.js\");\n        return l(e, t);\n      }\n\n    default:\n      return;\n  }\n}\n\nfunction b(e) {\n  return e && \"opacity\" in e ? e.opacity * b(e.parent) : 1;\n}\n\nasync function d(o, s) {\n  var c, u;\n  if (!o) return;\n  const y = o.sourceLayer,\n        p = null != (c = e(s) && null != (u = s.useSourceLayer) && u ? y : o.layer) ? c : y,\n        h = b(p);\n\n  if (e(o.symbol) && (!e(s) || !0 !== s.ignoreGraphicSymbol)) {\n    const t = \"web-style\" === o.symbol.type ? await o.symbol.fetchSymbol(e(s) ? s.abortOptions : null) : o.symbol.clone();\n    return a(t, null, h), t;\n  }\n\n  const d = e(s) && s.renderer || p && \"renderer\" in p && p.renderer;\n  let m = d && \"getSymbolAsync\" in d ? await d.getSymbolAsync(o, s) : null;\n  if (!m) return;\n  if (m = \"web-style\" === m.type ? await m.fetchSymbol(e(s) ? s.abortOptions : null) : m.clone(), !(\"visualVariables\" in d) || !d.visualVariables || !d.visualVariables.length) return a(m, null, h), m;\n\n  if (\"arcadeRequiredForVisualVariables\" in d && d.arcadeRequiredForVisualVariables && (t(s) || t(s.arcade))) {\n    const e = { ...l(s)\n    };\n    e.arcade = await r(), s = e;\n  }\n\n  const f = await import(\"../../renderers/visualVariables/support/visualVariableUtils.js\"),\n        g = [],\n        w = [],\n        S = [],\n        v = [];\n\n  for (const e of d.visualVariables) switch (e.type) {\n    case \"color\":\n      g.push(e);\n      break;\n\n    case \"opacity\":\n      w.push(e);\n      break;\n\n    case \"rotation\":\n      v.push(e);\n      break;\n\n    case \"size\":\n      e.target || S.push(e);\n  }\n\n  const V = !!g.length && g[g.length - 1],\n        x = V ? f.getColor(V, o, s) : null,\n        R = !!w.length && w[w.length - 1];\n  let C = R ? f.getOpacity(R, o, s) : null;\n\n  if (null != h && (C = null != C ? C * h : h), a(m, x, C), S.length) {\n    const e = f.getAllSizes(S, o, s);\n    await i(m, e);\n  }\n\n  for (const e of v) n(m, f.getRotationAngle(e, o, s), e.axis);\n\n  return m;\n}\n\nasync function m(a, i) {\n  var n;\n  if (!a) return;\n  const c = b(a.layer || a.sourceLayer);\n\n  if (e(a.symbol) && (!e(i) || !0 !== i.ignoreGraphicSymbol)) {\n    const t = \"web-style\" === a.symbol.type ? await a.symbol.fetchSymbol(e(i) ? i.abortOptions : null) : a.symbol.clone();\n    return o(t, c);\n  }\n\n  const u = e(i) && i.renderer || a.get(\"layer.renderer\") || a.get(\"sourceLayer.renderer\");\n  let y = await u.getSymbolAsync(a, i);\n  if (!y) return;\n  y = \"web-style\" === y.type ? await y.fetchSymbol(e(i) ? i.abortOptions : null) : y.clone();\n  const p = o(y, c);\n  if (!(\"visualVariables\" in u) || \"visualVariables\" in u && !u.visualVariables || \"visualVariables\" in u && (null == (n = u.visualVariables) || !n.length)) return p;\n\n  if (u.arcadeRequiredForVisualVariables && (t(i) || t(i.arcade))) {\n    const e = { ...l(i)\n    };\n    e.arcade = await r(), i = e;\n  }\n\n  const h = await import(\"../../renderers/visualVariables/support/visualVariableUtils.js\"),\n        d = [],\n        m = [];\n\n  for (const e of u.visualVariables) switch (e.type) {\n    case \"color\":\n      d.push(e);\n      break;\n\n    case \"opacity\":\n      m.push(e);\n  }\n\n  const f = d.length > 0 ? d[d.length - 1] : null,\n        g = f ? h.getColor(f, a, i) : p,\n        w = m.length > 0 ? m[m.length - 1] : null;\n  let S = w ? h.getOpacity(w, a, i) : null;\n  return null != c && (S = null != S ? S * c : c), g ? s(g, S) : null;\n}\n\nexport { m as getDisplayedColor, d as getDisplayedSymbol, p as renderColorRampPreviewHTML, y as renderDotDensityPreviewHTML, h as renderPreviewHTML };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/symbols/support/symbolUtils.js"],"names":["isSome","e","isNone","t","unwrap","l","loadArcade","r","applyColorToSymbol","a","applySizesToSymbol","i","applyRotationToSymbol","n","getColorFromSymbol","o","applyOpacityToColor","s","c","u","Math","floor","random","y","backgroundColor","outline","dotSize","swatchSize","round","window","devicePixelRatio","p","document","createElement","h","width","height","style","b","getContext","fillStyle","toCss","fillRect","fill","length","push","color","strokeStyle","lineWidth","strokeRect","d","Image","src","toDataURL","align","gradient","m","createLinearGradient","forEach","addColorStop","toString","f","appendChild","type","previewWebStyleSymbol","previewSymbol3D","previewSymbol2D","previewCIMSymbol","opacity","parent","sourceLayer","useSourceLayer","layer","symbol","ignoreGraphicSymbol","fetchSymbol","abortOptions","clone","renderer","getSymbolAsync","visualVariables","arcadeRequiredForVisualVariables","arcade","g","w","S","v","target","V","x","getColor","R","C","getOpacity","getAllSizes","getRotationAngle","axis","get","getDisplayedColor","getDisplayedSymbol","renderColorRampPreviewHTML","renderDotDensityPreviewHTML","renderPreviewHTML"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../core/has.js\";import{isSome as e,isNone as t,unwrap as l}from\"../../core/maybe.js\";import{loadArcade as r}from\"../../support/arcadeOnDemand.js\";import{applyColorToSymbol as a,applySizesToSymbol as i,applyRotationToSymbol as n,getColorFromSymbol as o,applyOpacityToColor as s}from\"./utils.js\";let c=null;function u(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function y(e,t,l){const{backgroundColor:r,outline:a,dotSize:i}=e,n=l&&l.swatchSize||22,o=.8,s=Math.round(n*n/i**2*o),y=window.devicePixelRatio,p=document.createElement(\"canvas\"),h=n*y;p.width=h,p.height=h,p.style.width=p.width/y+\"px\",p.style.height=p.height/y+\"px\";const b=p.getContext(\"2d\");if(r&&(b.fillStyle=r.toCss(!0),b.fillRect(0,0,h,h),b.fill()),b.fillStyle=t.toCss(!0),c&&c.length/2===s)for(let u=0;u<2*s;u+=2){const e=c[u],t=c[u+1];b.fillRect(e,t,i*y,i*y),b.fill()}else{c=[];for(let e=0;e<2*s;e+=2){const e=u(0,h),t=u(0,h);c.push(e,t),b.fillRect(e,t,i*y,i*y),b.fill()}}a&&(a.color&&(b.strokeStyle=a.color.toCss(!0)),b.lineWidth=a.width,b.strokeRect(0,0,h,h));const d=new Image(n,n);return d.src=p.toDataURL(),d}function p(e,t={}){const l=24,r=75,a=\"horizontal\"===t.align,i=a?r:l,n=a?l:r,{width:o=i,height:s=n,gradient:c=!0}=t,u=window.devicePixelRatio,y=o*u,p=s*u,h=document.createElement(\"canvas\");h.width=y,h.height=p,h.style.width=`${o}px`,h.style.height=`${s}px`;const b=h.getContext(\"2d\"),d=a?y:0,m=a?0:p;if(c){const t=b.createLinearGradient(0,0,d,m),l=e.length,r=1===l?0:1/(l-1);e.forEach(((e,l)=>t.addColorStop(l*r,e.toString()))),b.fillStyle=t,b.fillRect(0,0,y,p)}else{const t=a?y/e.length:y,l=a?p:p/e.length;let r=0,i=0;for(const n of e)b.fillStyle=n.toString(),b.fillRect(r,i,t,l),r=a?r+t:0,i=a?0:i+l}const f=document.createElement(\"div\");return f.style.width=`${o}px`,f.style.height=`${s}px`,f.appendChild(h),f}async function h(e,t){switch(e.type){case\"web-style\":{const{previewWebStyleSymbol:l}=await import(\"./previewWebStyleSymbol.js\");return l(e,h,t)}case\"label-3d\":case\"line-3d\":case\"mesh-3d\":case\"point-3d\":case\"polygon-3d\":{const{previewSymbol3D:l}=await import(\"./previewSymbol3D.js\");return l(e,t)}case\"simple-marker\":case\"simple-line\":case\"simple-fill\":case\"picture-marker\":case\"picture-fill\":case\"text\":{const{previewSymbol2D:l}=await import(\"./previewSymbol2D.js\");return l(e,t)}case\"cim\":{const{previewCIMSymbol:l}=await import(\"./previewCIMSymbol.js\");return l(e,t)}default:return}}function b(e){return e&&\"opacity\"in e?e.opacity*b(e.parent):1}async function d(o,s){var c,u;if(!o)return;const y=o.sourceLayer,p=null!=(c=e(s)&&null!=(u=s.useSourceLayer)&&u?y:o.layer)?c:y,h=b(p);if(e(o.symbol)&&(!e(s)||!0!==s.ignoreGraphicSymbol)){const t=\"web-style\"===o.symbol.type?await o.symbol.fetchSymbol(e(s)?s.abortOptions:null):o.symbol.clone();return a(t,null,h),t}const d=e(s)&&s.renderer||p&&\"renderer\"in p&&p.renderer;let m=d&&\"getSymbolAsync\"in d?await d.getSymbolAsync(o,s):null;if(!m)return;if(m=\"web-style\"===m.type?await m.fetchSymbol(e(s)?s.abortOptions:null):m.clone(),!(\"visualVariables\"in d)||!d.visualVariables||!d.visualVariables.length)return a(m,null,h),m;if(\"arcadeRequiredForVisualVariables\"in d&&d.arcadeRequiredForVisualVariables&&(t(s)||t(s.arcade))){const e={...l(s)};e.arcade=await r(),s=e}const f=await import(\"../../renderers/visualVariables/support/visualVariableUtils.js\"),g=[],w=[],S=[],v=[];for(const e of d.visualVariables)switch(e.type){case\"color\":g.push(e);break;case\"opacity\":w.push(e);break;case\"rotation\":v.push(e);break;case\"size\":e.target||S.push(e)}const V=!!g.length&&g[g.length-1],x=V?f.getColor(V,o,s):null,R=!!w.length&&w[w.length-1];let C=R?f.getOpacity(R,o,s):null;if(null!=h&&(C=null!=C?C*h:h),a(m,x,C),S.length){const e=f.getAllSizes(S,o,s);await i(m,e)}for(const e of v)n(m,f.getRotationAngle(e,o,s),e.axis);return m}async function m(a,i){var n;if(!a)return;const c=b(a.layer||a.sourceLayer);if(e(a.symbol)&&(!e(i)||!0!==i.ignoreGraphicSymbol)){const t=\"web-style\"===a.symbol.type?await a.symbol.fetchSymbol(e(i)?i.abortOptions:null):a.symbol.clone();return o(t,c)}const u=e(i)&&i.renderer||a.get(\"layer.renderer\")||a.get(\"sourceLayer.renderer\");let y=await u.getSymbolAsync(a,i);if(!y)return;y=\"web-style\"===y.type?await y.fetchSymbol(e(i)?i.abortOptions:null):y.clone();const p=o(y,c);if(!(\"visualVariables\"in u)||\"visualVariables\"in u&&!u.visualVariables||\"visualVariables\"in u&&(null==(n=u.visualVariables)||!n.length))return p;if(u.arcadeRequiredForVisualVariables&&(t(i)||t(i.arcade))){const e={...l(i)};e.arcade=await r(),i=e}const h=await import(\"../../renderers/visualVariables/support/visualVariableUtils.js\"),d=[],m=[];for(const e of u.visualVariables)switch(e.type){case\"color\":d.push(e);break;case\"opacity\":m.push(e)}const f=d.length>0?d[d.length-1]:null,g=f?h.getColor(f,a,i):p,w=m.length>0?m[m.length-1]:null;let S=w?h.getOpacity(w,a,i):null;return null!=c&&(S=null!=S?S*c:c),g?s(g,S):null}export{m as getDisplayedColor,d as getDisplayedSymbol,p as renderColorRampPreviewHTML,y as renderDotDensityPreviewHTML,h as renderPreviewHTML};\n"]},"metadata":{},"sourceType":"module"}