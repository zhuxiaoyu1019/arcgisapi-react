{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { clamp as t } from \"../../../../core/mathUtils.js\";\nimport { o as n, s as o, g as i } from \"../../../../chunks/vec3.js\";\nimport { c as s } from \"../../../../chunks/vec3f64.js\";\nimport { elementwiseProduct as r, scalarProduct as e, add as c } from \"../lib/LongVectorMath.js\";\nimport { MainLight as f, FillLight as h, AmbientLight as a, SphericalHarmonicsAmbientLight as u } from \"./Lightsources.js\";\n\nfunction g(t) {\n  return (t + 1) * (t + 1);\n}\n\nfunction l(n) {\n  return t(Math.floor(Math.sqrt(n) - 1), 0, 2);\n}\n\nfunction y(t, n, o) {\n  const i = t[0],\n        s = t[1],\n        r = t[2],\n        e = o || [];\n  return e.length = g(n), n >= 0 && (e[0] = .28209479177), n >= 1 && (e[1] = .4886025119 * i, e[2] = .4886025119 * r, e[3] = .4886025119 * s), n >= 2 && (e[4] = 1.09254843059 * i * s, e[5] = 1.09254843059 * s * r, e[6] = .31539156525 * (3 * r * r - 1), e[7] = 1.09254843059 * i * r, e[8] = .54627421529 * (i * i - s * s)), e;\n}\n\nfunction m(t, n) {\n  const o = g(t),\n        i = n || {\n    r: [],\n    g: [],\n    b: []\n  };\n  i.r.length = i.g.length = i.b.length = o;\n\n  for (let s = 0; s < o; s++) i.r[s] = i.g[s] = i.b[s] = 0;\n\n  return i;\n}\n\nfunction p(t, o) {\n  const i = l(o.r.length);\n\n  for (const s of t) n(v, s.direction), y(v, i, P), r(P, w), e(P, s.intensity[0], k), c(o.r, k), e(P, s.intensity[1], k), c(o.g, k), e(P, s.intensity[2], k), c(o.b, k);\n\n  return o;\n}\n\nfunction b(t, n) {\n  y(v, 0, P);\n\n  for (const o of t) n.r[0] += P[0] * w[0] * o.intensity[0] * 4 * Math.PI, n.g[0] += P[0] * w[0] * o.intensity[1] * 4 * Math.PI, n.b[0] += P[0] * w[0] * o.intensity[2] * 4 * Math.PI;\n\n  return n;\n}\n\nfunction M(t, n, s, r) {\n  m(n, r), o(s.intensity, 0, 0, 0);\n  let e = !1;\n  const g = d,\n        l = j,\n        y = I;\n  g.length = 0, l.length = 0, y.length = 0;\n\n  for (const o of t) o instanceof f && !e ? (i(s.direction, o.direction), s.intensity[0] = o.intensity[0], s.intensity[1] = o.intensity[1], s.intensity[2] = o.intensity[2], s.castShadows = o.castShadows, e = !0) : o instanceof f || o instanceof h ? g.push(o) : o instanceof a ? l.push(o) : o instanceof u && y.push(o);\n\n  p(g, r), b(l, r);\n\n  for (const o of y) c(r.r, o.r), c(r.g, o.g), c(r.b, o.b);\n}\n\nconst d = [],\n      j = [],\n      I = [],\n      P = [0],\n      k = [0],\n      v = s(),\n      w = [3.141593, 2.094395, 2.094395, 2.094395, .785398, .785398, .785398, .785398, .785398];\nexport { M as combineLights, y as computeCoefficients, m as initSHCoefficients, g as numberOfCoefficients, l as orderFromNumberOfCoefficients, b as projectAmbientLights, p as projectFillLights };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/webgl-engine/lighting/SphericalHarmonics.js"],"names":["clamp","t","o","n","s","g","i","c","elementwiseProduct","r","scalarProduct","e","add","MainLight","f","FillLight","h","AmbientLight","a","SphericalHarmonicsAmbientLight","u","l","Math","floor","sqrt","y","length","m","b","p","v","direction","P","w","intensity","k","PI","M","d","j","I","castShadows","push","combineLights","computeCoefficients","initSHCoefficients","numberOfCoefficients","orderFromNumberOfCoefficients","projectAmbientLights","projectFillLights"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{clamp as t}from\"../../../../core/mathUtils.js\";import{o as n,s as o,g as i}from\"../../../../chunks/vec3.js\";import{c as s}from\"../../../../chunks/vec3f64.js\";import{elementwiseProduct as r,scalarProduct as e,add as c}from\"../lib/LongVectorMath.js\";import{MainLight as f,FillLight as h,AmbientLight as a,SphericalHarmonicsAmbientLight as u}from\"./Lightsources.js\";function g(t){return(t+1)*(t+1)}function l(n){return t(Math.floor(Math.sqrt(n)-1),0,2)}function y(t,n,o){const i=t[0],s=t[1],r=t[2],e=o||[];return e.length=g(n),n>=0&&(e[0]=.28209479177),n>=1&&(e[1]=.4886025119*i,e[2]=.4886025119*r,e[3]=.4886025119*s),n>=2&&(e[4]=1.09254843059*i*s,e[5]=1.09254843059*s*r,e[6]=.31539156525*(3*r*r-1),e[7]=1.09254843059*i*r,e[8]=.54627421529*(i*i-s*s)),e}function m(t,n){const o=g(t),i=n||{r:[],g:[],b:[]};i.r.length=i.g.length=i.b.length=o;for(let s=0;s<o;s++)i.r[s]=i.g[s]=i.b[s]=0;return i}function p(t,o){const i=l(o.r.length);for(const s of t)n(v,s.direction),y(v,i,P),r(P,w),e(P,s.intensity[0],k),c(o.r,k),e(P,s.intensity[1],k),c(o.g,k),e(P,s.intensity[2],k),c(o.b,k);return o}function b(t,n){y(v,0,P);for(const o of t)n.r[0]+=P[0]*w[0]*o.intensity[0]*4*Math.PI,n.g[0]+=P[0]*w[0]*o.intensity[1]*4*Math.PI,n.b[0]+=P[0]*w[0]*o.intensity[2]*4*Math.PI;return n}function M(t,n,s,r){m(n,r),o(s.intensity,0,0,0);let e=!1;const g=d,l=j,y=I;g.length=0,l.length=0,y.length=0;for(const o of t)o instanceof f&&!e?(i(s.direction,o.direction),s.intensity[0]=o.intensity[0],s.intensity[1]=o.intensity[1],s.intensity[2]=o.intensity[2],s.castShadows=o.castShadows,e=!0):o instanceof f||o instanceof h?g.push(o):o instanceof a?l.push(o):o instanceof u&&y.push(o);p(g,r),b(l,r);for(const o of y)c(r.r,o.r),c(r.g,o.g),c(r.b,o.b)}const d=[],j=[],I=[],P=[0],k=[0],v=s(),w=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,.785398];export{M as combineLights,y as computeCoefficients,m as initSHCoefficients,g as numberOfCoefficients,l as orderFromNumberOfCoefficients,b as projectAmbientLights,p as projectFillLights};\n"]},"metadata":{},"sourceType":"module"}