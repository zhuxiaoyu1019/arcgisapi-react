{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../../chunks/tslib.es6.js\";\nimport e from \"../../../../Graphic.js\";\nimport i from \"../../../../core/Accessor.js\";\nimport { neverReached as s } from \"../../../../core/compilerUtils.js\";\nimport r from \"../../../../core/Handles.js\";\nimport { logOnError as n } from \"../../../../core/promiseUtils.js\";\nimport { init as a } from \"../../../../core/watchUtils.js\";\nimport { property as o } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../core/Logger.js\";\nimport { subclass as l } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { diff as p } from \"../../../../core/accessorSupport/diffUtils.js\";\nimport { canProject as h, project as d } from \"../../../../geometry/support/webMercatorUtils.js\";\nimport c from \"../../../../rest/support/Query.js\";\nimport { SUSPEND_RESUME_EXTENT_OPTIMISM as u } from \"./constants.js\";\nimport { Graphics3DCore as g } from \"./Graphics3DCore.js\";\nimport m from \"./Graphics3DElevationAlignment.js\";\nimport { Graphics3DFilterVisibility as y } from \"./Graphics3DFilterVisibility.js\";\nimport f from \"./Graphics3DFrustumVisibility.js\";\nimport { Graphics3DObjectStates as b } from \"./Graphics3DObjectStates.js\";\nimport w from \"./Graphics3DScaleVisibility.js\";\nimport { enlargeExtent as x } from \"./graphicUtils.js\";\nimport { attributeLookup as E } from \"../support/attributeUtils.js\";\nimport { WatchUpdatingTracking as C } from \"../../../support/WatchUpdatingTracking.js\";\nlet V = class extends i {\n  constructor(t) {\n    super(t), this._handles = new r(), this.watchUpdatingTracking = new C(), this.suspendResumeExtentMode = \"computed\", this.dataExtent = null, this.suspendResumeExtent = null;\n  }\n\n  get suspended() {\n    var t;\n    return null == (t = this.scaleVisibility) ? void 0 : t.suspended;\n  }\n\n  get suspendInfo() {\n    var t, e;\n    const i = {};\n    return null != (t = this.scaleVisibility) && t.suspended && (i.outsideScaleRange = !0), null != (e = this.frustumVisibility) && e.suspended && (i.outsideOfView = !0), i;\n  }\n\n  get updating() {\n    var t, e, i;\n    return !!(null != (t = this.graphicsCore) && t.updating || null != (e = this.frustumVisibility) && e.updating || null != (i = this.watchUpdatingTracking) && i.updating);\n  }\n\n  normalizeCtorArgs(t) {\n    const e = t.frustumVisibilityEnabled ? new f() : null,\n          i = t.scaleVisibilityEnabled ? new w() : null,\n          s = (t.filterVisibilityEnabled || t.timeExtentVisibilityEnabled) && \"multipatch\" !== t.layer.geometryType ? new y() : null,\n          r = t.elevationAlignmentEnabled ? new m() : null,\n          n = new g({\n      owner: t.owner,\n      layer: t.layer,\n      preferredUpdatePolicy: t.preferredUpdatePolicy,\n      elevationFeatureExpressionEnabled: t.elevationFeatureExpressionEnabled,\n      graphicSymbolSupported: !1,\n      hasZ: t.owner.hasZ,\n      hasM: t.owner.hasM\n    }),\n          {\n      updateClippingExtent: a,\n      suspendResumeExtentMode: o,\n      dataExtent: l\n    } = t;\n    return {\n      graphicsCore: n,\n      frustumVisibility: e,\n      scaleVisibility: i,\n      filterVisibility: s,\n      elevationAlignment: r,\n      updateClippingExtent: a,\n      suspendResumeExtentMode: o,\n      dataExtent: l\n    };\n  }\n\n  initialize() {\n    this.scaleVisibility && this.watchUpdatingTracking.add(this.layer, \"scaleRangeId\", () => this.scaleVisibility.layerMinMaxScaleChangeHandler()), this.filterVisibility && (this.watchUpdatingTracking.add(this.owner, \"filter\", () => this.filterVisibility.filterChanged()), this.watchUpdatingTracking.add(this.owner, \"timeExtent\", () => this.filterVisibility.filterChanged())), this.elevationAlignment && this.watchUpdatingTracking.add(this.layer, \"elevationInfo\", (t, e) => {\n      p(t, e) && this.watchUpdatingTracking.addPromise(this.graphicsCore.elevationInfoChange());\n    }), this.watchUpdatingTracking.add(this.layer, \"labelsVisible\", () => this.graphicsCore.updateVisibilityInfo()), this.watchUpdatingTracking.add(this.layer, \"labelingInfo\", (t, e) => {\n      p(t, e) && this.graphicsCore.updateLabelingInfo();\n    });\n  }\n\n  async setup() {\n    this.frustumVisibility && this.frustumVisibility.setup(this.owner);\n\n    const t = this.owner,\n          e = this.owner.view.basemapTerrain,\n          i = (t, e, i) => this.graphicsCore.spatialIndex.queryGraphicUIDsInExtent(t, e, i);\n\n    if (this.scaleVisibility && this.scaleVisibility.setup(t, this.layer, i, this.graphicsCore, e), this.filterVisibility && (\"filter\" in t || \"timeExtent\" in t) && this.filterVisibility.setup(t, this.graphicsCore), this.elevationAlignment) {\n      const e = t.view.elevationProvider;\n      this.elevationAlignment.setup(t, i, this.graphicsCore, e);\n    }\n\n    this._set(\"objectStates\", new b(this.graphicsCore)), this._set(\"labeling\", this.owner.view.labeler.addGraphicsOwner(this.graphicsCore, this.scaleVisibility)), this._set(\"deconfliction\", t.view.deconflictor.addGraphicsOwner(this.graphicsCore)), await n(this.graphicsCore.setup({\n      elevationAlignment: this.elevationAlignment,\n      scaleVisibility: this.scaleVisibility,\n      filterVisibility: this.filterVisibility,\n      deconflictor: this.deconfliction,\n      labeler: this.labeling,\n      objectStates: this.objectStates\n    })), this.watchUpdatingTracking.add(this.layer, \"renderer\", t => this.watchUpdatingTracking.addPromise(this.graphicsCore.rendererChange(t))), this.watchUpdatingTracking.add(t, \"fullOpacity\", () => this.graphicsCore.opacityChange()), this.setupSuspendResumeExtent(), this.updateClippingExtent && (this.watchUpdatingTracking.add(t.view, \"clippingArea\", () => this._updateClippingExtent()), this._updateClippingExtent()), this.graphicsCore.startCreateGraphics(), this.graphicsCore.labelsEnabled && (await n(this.graphicsCore.updateLabelingInfo()));\n  }\n\n  destroy() {\n    this._handles && (this._handles.destroy(), this._handles = null);\n    const t = [\"watchUpdatingTracking\", \"frustumVisibility\", \"scaleVisibility\", \"filterVisibility\", \"elevationAlignment\", \"objectStates\", \"graphicsCore\"];\n\n    for (const e of t) {\n      const t = this[e];\n      t && (t.destroy(), this._set(e, null));\n    }\n\n    this._set(\"layer\", null), this._set(\"owner\", null);\n  }\n\n  maskOccludee(t) {\n    const {\n      set: e,\n      handle: i\n    } = this.objectStates.acquireSet(1, null);\n    return this.objectStates.setUid(e, t.uid), i;\n  }\n\n  highlight(t, i) {\n    if (t instanceof c) {\n      const {\n        set: e,\n        handle: s\n      } = this.objectStates.acquireSet(0, i);\n      return this.owner.queryObjectIds(t).then(t => this.objectStates.setObjectIds(e, t)), s;\n    }\n\n    if (\"number\" == typeof t || \"string\" == typeof t) return this.highlight([t], i);\n    if (t instanceof e) return this.highlight([t], i);\n\n    if (\"toArray\" in t && (t = t.toArray()), Array.isArray(t) && t.length > 0) {\n      if (t[0] instanceof e) {\n        const e = t;\n\n        if (null == E(this.layer.fieldsIndex, e[0].attributes, i)) {\n          const t = e.map(t => t.uid),\n                {\n            set: i,\n            handle: s\n          } = this.objectStates.acquireSet(0, null);\n          return this.objectStates.setUids(i, t), s;\n        }\n\n        t = e.map(t => E(this.layer.fieldsIndex, t.attributes, i));\n      }\n\n      if (\"number\" == typeof t[0] || \"string\" == typeof t[0]) {\n        const e = t,\n              {\n          set: s,\n          handle: r\n        } = this.objectStates.acquireSet(0, i);\n        return this.objectStates.setObjectIds(s, e), r;\n      }\n    }\n\n    return S;\n  }\n\n  _updateClippingExtent() {\n    const t = this.owner.view.clippingArea;\n    this.graphicsCore.setClippingExtent(t, this.owner.view.spatialReference) && (this.updateClippingExtent(t) || this.graphicsCore.recreateAllGraphics());\n  }\n\n  setupSuspendResumeExtent() {\n    (this.frustumVisibility || this.scaleVisibility) && this._handles.add(a(this, \"suspendResumeExtentMode\", () => {\n      switch (this._handles.remove(j), this.suspendResumeExtentMode) {\n        case \"computed\":\n          this._handles.add([a(this.graphicsCore, \"computedExtent\", t => this.updateSuspendResumeExtent(t)), this.graphicsCore.watch(\"extentPadding\", () => this.updateSuspendResumeExtent(this.graphicsCore.computedExtent))], j);\n\n          break;\n\n        case \"data\":\n          this._handles.add([a(this, \"dataExtent\", t => this.updateSuspendResumeExtent(t)), this.graphicsCore.watch(\"extentPadding\", () => this.updateSuspendResumeExtent(this.dataExtent))], j);\n\n          break;\n\n        default:\n          s(this.suspendResumeExtentMode);\n      }\n    }));\n  }\n\n  updateSuspendResumeExtent(t) {\n    t ? this.suspendResumeExtentChanged(this.extentToSuspendResumeRect(t, this.suspendResumeExtent)) : this.suspendResumeExtentChanged(null);\n  }\n\n  extentToSuspendResumeRect(t, e) {\n    const i = this.owner.view.spatialReference;\n\n    if (!t.spatialReference.equals(i)) {\n      if (!h(t, i)) return;\n      t = d(t, i);\n    }\n\n    return x(t, e, u, this.graphicsCore.extentPadding);\n  }\n\n  suspendResumeExtentChanged(t) {\n    this.frustumVisibility && this.frustumVisibility.setExtent(t), this.scaleVisibility && this.scaleVisibility.setExtent(t);\n  }\n\n};\nt([o({\n  aliasOf: \"graphicsCore.layer\"\n})], V.prototype, \"layer\", void 0), t([o({\n  aliasOf: \"graphicsCore.owner\"\n})], V.prototype, \"owner\", void 0), t([o({\n  constructOnly: !0\n})], V.prototype, \"updateClippingExtent\", void 0), t([o({\n  constructOnly: !0\n})], V.prototype, \"graphicsCore\", void 0), t([o({\n  constructOnly: !0\n})], V.prototype, \"scaleVisibility\", void 0), t([o({\n  constructOnly: !0\n})], V.prototype, \"filterVisibility\", void 0), t([o({\n  constructOnly: !0\n})], V.prototype, \"elevationAlignment\", void 0), t([o({\n  constructOnly: !0\n})], V.prototype, \"frustumVisibility\", void 0), t([o({\n  readOnly: !0\n})], V.prototype, \"deconfliction\", void 0), t([o({\n  readOnly: !0\n})], V.prototype, \"labeling\", void 0), t([o({\n  readOnly: !0\n})], V.prototype, \"objectStates\", void 0), t([o({\n  readOnly: !0\n})], V.prototype, \"watchUpdatingTracking\", void 0), t([o()], V.prototype, \"suspendResumeExtentMode\", void 0), t([o()], V.prototype, \"dataExtent\", void 0), t([o({\n  readOnly: !0\n})], V.prototype, \"suspended\", null), t([o({\n  readOnly: !0\n})], V.prototype, \"suspendInfo\", null), t([o({\n  readOnly: !0,\n  dependsOn: [\"graphicsCore.updating\", \"frustumVisibility.updating\", \"watchUpdatingTracking.updating\"]\n})], V.prototype, \"updating\", null), V = t([l(\"esri.views.3d.layers.graphics.Graphics3DFeatureLikeLayerView\")], V);\nvar v = V;\nconst j = \"suspendResumeExtentMode\",\n      S = {\n  remove() {},\n\n  pause() {},\n\n  resume() {}\n\n};\nexport default v;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DFeatureLikeLayerView.js"],"names":["_","t","e","i","neverReached","s","r","logOnError","n","init","a","property","o","subclass","l","diff","p","canProject","h","project","d","c","SUSPEND_RESUME_EXTENT_OPTIMISM","u","Graphics3DCore","g","m","Graphics3DFilterVisibility","y","f","Graphics3DObjectStates","b","w","enlargeExtent","x","attributeLookup","E","WatchUpdatingTracking","C","V","constructor","_handles","watchUpdatingTracking","suspendResumeExtentMode","dataExtent","suspendResumeExtent","suspended","scaleVisibility","suspendInfo","outsideScaleRange","frustumVisibility","outsideOfView","updating","graphicsCore","normalizeCtorArgs","frustumVisibilityEnabled","scaleVisibilityEnabled","filterVisibilityEnabled","timeExtentVisibilityEnabled","layer","geometryType","elevationAlignmentEnabled","owner","preferredUpdatePolicy","elevationFeatureExpressionEnabled","graphicSymbolSupported","hasZ","hasM","updateClippingExtent","filterVisibility","elevationAlignment","initialize","add","layerMinMaxScaleChangeHandler","filterChanged","addPromise","elevationInfoChange","updateVisibilityInfo","updateLabelingInfo","setup","view","basemapTerrain","spatialIndex","queryGraphicUIDsInExtent","elevationProvider","_set","labeler","addGraphicsOwner","deconflictor","deconfliction","labeling","objectStates","rendererChange","opacityChange","setupSuspendResumeExtent","_updateClippingExtent","startCreateGraphics","labelsEnabled","destroy","maskOccludee","set","handle","acquireSet","setUid","uid","highlight","queryObjectIds","then","setObjectIds","toArray","Array","isArray","length","fieldsIndex","attributes","map","setUids","S","clippingArea","setClippingExtent","spatialReference","recreateAllGraphics","remove","j","updateSuspendResumeExtent","watch","computedExtent","suspendResumeExtentChanged","extentToSuspendResumeRect","equals","extentPadding","setExtent","aliasOf","prototype","constructOnly","readOnly","dependsOn","v","pause","resume"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,iCAAlB;AAAoD,OAAOC,CAAP,MAAa,wBAAb;AAAsC,OAAOC,CAAP,MAAa,8BAAb;AAA4C,SAAOC,YAAY,IAAIC,CAAvB,QAA6B,mCAA7B;AAAiE,OAAOC,CAAP,MAAa,6BAAb;AAA2C,SAAOC,UAAU,IAAIC,CAArB,QAA2B,kCAA3B;AAA8D,SAAOC,IAAI,IAAIC,CAAf,QAAqB,gCAArB;AAAsD,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,yDAAzB;AAAmF,OAAM,yBAAN;AAAgC,OAAM,gDAAN;AAAuD,OAAM,4BAAN;AAAmC,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,yDAAzB;AAAmF,SAAOC,IAAI,IAAIC,CAAf,QAAqB,+CAArB;AAAqE,SAAOC,UAAU,IAAIC,CAArB,EAAuBC,OAAO,IAAIC,CAAlC,QAAwC,kDAAxC;AAA2F,OAAOC,CAAP,MAAa,mCAAb;AAAiD,SAAOC,8BAA8B,IAAIC,CAAzC,QAA+C,gBAA/C;AAAgE,SAAOC,cAAc,IAAIC,CAAzB,QAA+B,qBAA/B;AAAqD,OAAOC,CAAP,MAAa,mCAAb;AAAiD,SAAOC,0BAA0B,IAAIC,CAArC,QAA2C,iCAA3C;AAA6E,OAAOC,CAAP,MAAa,kCAAb;AAAgD,SAAOC,sBAAsB,IAAIC,CAAjC,QAAuC,6BAAvC;AAAqE,OAAOC,CAAP,MAAa,gCAAb;AAA8C,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,mBAA9B;AAAkD,SAAOC,eAAe,IAAIC,CAA1B,QAAgC,8BAAhC;AAA+D,SAAOC,qBAAqB,IAAIC,CAAhC,QAAsC,2CAAtC;AAAkF,IAAIC,CAAC,GAAC,cAAcpC,CAAd,CAAe;AAACqC,EAAAA,WAAW,CAACvC,CAAD,EAAG;AAAC,UAAMA,CAAN,GAAS,KAAKwC,QAAL,GAAc,IAAInC,CAAJ,EAAvB,EAA6B,KAAKoC,qBAAL,GAA2B,IAAIJ,CAAJ,EAAxD,EAA8D,KAAKK,uBAAL,GAA6B,UAA3F,EAAsG,KAAKC,UAAL,GAAgB,IAAtH,EAA2H,KAAKC,mBAAL,GAAyB,IAApJ;AAAyJ;;AAAa,MAATC,SAAS,GAAE;AAAC,QAAI7C,CAAJ;AAAM,WAAO,SAAOA,CAAC,GAAC,KAAK8C,eAAd,IAA+B,KAAK,CAApC,GAAsC9C,CAAC,CAAC6C,SAA/C;AAAyD;;AAAe,MAAXE,WAAW,GAAE;AAAC,QAAI/C,CAAJ,EAAMC,CAAN;AAAQ,UAAMC,CAAC,GAAC,EAAR;AAAW,WAAO,SAAOF,CAAC,GAAC,KAAK8C,eAAd,KAAgC9C,CAAC,CAAC6C,SAAlC,KAA8C3C,CAAC,CAAC8C,iBAAF,GAAoB,CAAC,CAAnE,GAAsE,SAAO/C,CAAC,GAAC,KAAKgD,iBAAd,KAAkChD,CAAC,CAAC4C,SAApC,KAAgD3C,CAAC,CAACgD,aAAF,GAAgB,CAAC,CAAjE,CAAtE,EAA0IhD,CAAjJ;AAAmJ;;AAAY,MAARiD,QAAQ,GAAE;AAAC,QAAInD,CAAJ,EAAMC,CAAN,EAAQC,CAAR;AAAU,WAAM,CAAC,EAAE,SAAOF,CAAC,GAAC,KAAKoD,YAAd,KAA6BpD,CAAC,CAACmD,QAA/B,IAAyC,SAAOlD,CAAC,GAAC,KAAKgD,iBAAd,KAAkChD,CAAC,CAACkD,QAA7E,IAAuF,SAAOjD,CAAC,GAAC,KAAKuC,qBAAd,KAAsCvC,CAAC,CAACiD,QAAjI,CAAP;AAAkJ;;AAAAE,EAAAA,iBAAiB,CAACrD,CAAD,EAAG;AAAC,UAAMC,CAAC,GAACD,CAAC,CAACsD,wBAAF,GAA2B,IAAI1B,CAAJ,EAA3B,GAAiC,IAAzC;AAAA,UAA8C1B,CAAC,GAACF,CAAC,CAACuD,sBAAF,GAAyB,IAAIxB,CAAJ,EAAzB,GAA+B,IAA/E;AAAA,UAAoF3B,CAAC,GAAC,CAACJ,CAAC,CAACwD,uBAAF,IAA2BxD,CAAC,CAACyD,2BAA9B,KAA4D,iBAAezD,CAAC,CAAC0D,KAAF,CAAQC,YAAnF,GAAgG,IAAIhC,CAAJ,EAAhG,GAAsG,IAA5L;AAAA,UAAiMtB,CAAC,GAACL,CAAC,CAAC4D,yBAAF,GAA4B,IAAInC,CAAJ,EAA5B,GAAkC,IAArO;AAAA,UAA0OlB,CAAC,GAAC,IAAIiB,CAAJ,CAAM;AAACqC,MAAAA,KAAK,EAAC7D,CAAC,CAAC6D,KAAT;AAAeH,MAAAA,KAAK,EAAC1D,CAAC,CAAC0D,KAAvB;AAA6BI,MAAAA,qBAAqB,EAAC9D,CAAC,CAAC8D,qBAArD;AAA2EC,MAAAA,iCAAiC,EAAC/D,CAAC,CAAC+D,iCAA/G;AAAiJC,MAAAA,sBAAsB,EAAC,CAAC,CAAzK;AAA2KC,MAAAA,IAAI,EAACjE,CAAC,CAAC6D,KAAF,CAAQI,IAAxL;AAA6LC,MAAAA,IAAI,EAAClE,CAAC,CAAC6D,KAAF,CAAQK;AAA1M,KAAN,CAA5O;AAAA,UAAmc;AAACC,MAAAA,oBAAoB,EAAC1D,CAAtB;AAAwBiC,MAAAA,uBAAuB,EAAC/B,CAAhD;AAAkDgC,MAAAA,UAAU,EAAC9B;AAA7D,QAAgEb,CAAngB;AAAqgB,WAAM;AAACoD,MAAAA,YAAY,EAAC7C,CAAd;AAAgB0C,MAAAA,iBAAiB,EAAChD,CAAlC;AAAoC6C,MAAAA,eAAe,EAAC5C,CAApD;AAAsDkE,MAAAA,gBAAgB,EAAChE,CAAvE;AAAyEiE,MAAAA,kBAAkB,EAAChE,CAA5F;AAA8F8D,MAAAA,oBAAoB,EAAC1D,CAAnH;AAAqHiC,MAAAA,uBAAuB,EAAC/B,CAA7I;AAA+IgC,MAAAA,UAAU,EAAC9B;AAA1J,KAAN;AAAmK;;AAAAyD,EAAAA,UAAU,GAAE;AAAC,SAAKxB,eAAL,IAAsB,KAAKL,qBAAL,CAA2B8B,GAA3B,CAA+B,KAAKb,KAApC,EAA0C,cAA1C,EAA0D,MAAI,KAAKZ,eAAL,CAAqB0B,6BAArB,EAA9D,CAAtB,EAA2I,KAAKJ,gBAAL,KAAwB,KAAK3B,qBAAL,CAA2B8B,GAA3B,CAA+B,KAAKV,KAApC,EAA0C,QAA1C,EAAoD,MAAI,KAAKO,gBAAL,CAAsBK,aAAtB,EAAxD,GAAgG,KAAKhC,qBAAL,CAA2B8B,GAA3B,CAA+B,KAAKV,KAApC,EAA0C,YAA1C,EAAwD,MAAI,KAAKO,gBAAL,CAAsBK,aAAtB,EAA5D,CAAxH,CAA3I,EAAwW,KAAKJ,kBAAL,IAAyB,KAAK5B,qBAAL,CAA2B8B,GAA3B,CAA+B,KAAKb,KAApC,EAA0C,eAA1C,EAA2D,CAAC1D,CAAD,EAAGC,CAAH,KAAO;AAACc,MAAAA,CAAC,CAACf,CAAD,EAAGC,CAAH,CAAD,IAAQ,KAAKwC,qBAAL,CAA2BiC,UAA3B,CAAsC,KAAKtB,YAAL,CAAkBuB,mBAAlB,EAAtC,CAAR;AAAuF,KAA1J,CAAjY,EAA8hB,KAAKlC,qBAAL,CAA2B8B,GAA3B,CAA+B,KAAKb,KAApC,EAA0C,eAA1C,EAA2D,MAAI,KAAKN,YAAL,CAAkBwB,oBAAlB,EAA/D,CAA9hB,EAAwoB,KAAKnC,qBAAL,CAA2B8B,GAA3B,CAA+B,KAAKb,KAApC,EAA0C,cAA1C,EAA0D,CAAC1D,CAAD,EAAGC,CAAH,KAAO;AAACc,MAAAA,CAAC,CAACf,CAAD,EAAGC,CAAH,CAAD,IAAQ,KAAKmD,YAAL,CAAkByB,kBAAlB,EAAR;AAA+C,KAAjH,CAAxoB;AAA4vB;;AAAW,QAALC,KAAK,GAAE;AAAC,SAAK7B,iBAAL,IAAwB,KAAKA,iBAAL,CAAuB6B,KAAvB,CAA6B,KAAKjB,KAAlC,CAAxB;;AAAiE,UAAM7D,CAAC,GAAC,KAAK6D,KAAb;AAAA,UAAmB5D,CAAC,GAAC,KAAK4D,KAAL,CAAWkB,IAAX,CAAgBC,cAArC;AAAA,UAAoD9E,CAAC,GAAC,CAACF,CAAD,EAAGC,CAAH,EAAKC,CAAL,KAAS,KAAKkD,YAAL,CAAkB6B,YAAlB,CAA+BC,wBAA/B,CAAwDlF,CAAxD,EAA0DC,CAA1D,EAA4DC,CAA5D,CAA/D;;AAA8H,QAAG,KAAK4C,eAAL,IAAsB,KAAKA,eAAL,CAAqBgC,KAArB,CAA2B9E,CAA3B,EAA6B,KAAK0D,KAAlC,EAAwCxD,CAAxC,EAA0C,KAAKkD,YAA/C,EAA4DnD,CAA5D,CAAtB,EAAqF,KAAKmE,gBAAL,KAAwB,YAAWpE,CAAX,IAAc,gBAAeA,CAArD,KAAyD,KAAKoE,gBAAL,CAAsBU,KAAtB,CAA4B9E,CAA5B,EAA8B,KAAKoD,YAAnC,CAA9I,EAA+L,KAAKiB,kBAAvM,EAA0N;AAAC,YAAMpE,CAAC,GAACD,CAAC,CAAC+E,IAAF,CAAOI,iBAAf;AAAiC,WAAKd,kBAAL,CAAwBS,KAAxB,CAA8B9E,CAA9B,EAAgCE,CAAhC,EAAkC,KAAKkD,YAAvC,EAAoDnD,CAApD;AAAuD;;AAAA,SAAKmF,IAAL,CAAU,cAAV,EAAyB,IAAItD,CAAJ,CAAM,KAAKsB,YAAX,CAAzB,GAAmD,KAAKgC,IAAL,CAAU,UAAV,EAAqB,KAAKvB,KAAL,CAAWkB,IAAX,CAAgBM,OAAhB,CAAwBC,gBAAxB,CAAyC,KAAKlC,YAA9C,EAA2D,KAAKN,eAAhE,CAArB,CAAnD,EAA0J,KAAKsC,IAAL,CAAU,eAAV,EAA0BpF,CAAC,CAAC+E,IAAF,CAAOQ,YAAP,CAAoBD,gBAApB,CAAqC,KAAKlC,YAA1C,CAA1B,CAA1J,EAA6O,MAAM7C,CAAC,CAAC,KAAK6C,YAAL,CAAkB0B,KAAlB,CAAwB;AAACT,MAAAA,kBAAkB,EAAC,KAAKA,kBAAzB;AAA4CvB,MAAAA,eAAe,EAAC,KAAKA,eAAjE;AAAiFsB,MAAAA,gBAAgB,EAAC,KAAKA,gBAAvG;AAAwHmB,MAAAA,YAAY,EAAC,KAAKC,aAA1I;AAAwJH,MAAAA,OAAO,EAAC,KAAKI,QAArK;AAA8KC,MAAAA,YAAY,EAAC,KAAKA;AAAhM,KAAxB,CAAD,CAApP,EAA6d,KAAKjD,qBAAL,CAA2B8B,GAA3B,CAA+B,KAAKb,KAApC,EAA0C,UAA1C,EAAsD1D,CAAC,IAAE,KAAKyC,qBAAL,CAA2BiC,UAA3B,CAAsC,KAAKtB,YAAL,CAAkBuC,cAAlB,CAAiC3F,CAAjC,CAAtC,CAAzD,CAA7d,EAAmmB,KAAKyC,qBAAL,CAA2B8B,GAA3B,CAA+BvE,CAA/B,EAAiC,aAAjC,EAAgD,MAAI,KAAKoD,YAAL,CAAkBwC,aAAlB,EAApD,CAAnmB,EAA2rB,KAAKC,wBAAL,EAA3rB,EAA2tB,KAAK1B,oBAAL,KAA4B,KAAK1B,qBAAL,CAA2B8B,GAA3B,CAA+BvE,CAAC,CAAC+E,IAAjC,EAAsC,cAAtC,EAAsD,MAAI,KAAKe,qBAAL,EAA1D,GAAyF,KAAKA,qBAAL,EAArH,CAA3tB,EAA82B,KAAK1C,YAAL,CAAkB2C,mBAAlB,EAA92B,EAAs5B,KAAK3C,YAAL,CAAkB4C,aAAlB,KAAiC,MAAMzF,CAAC,CAAC,KAAK6C,YAAL,CAAkByB,kBAAlB,EAAD,CAAxC,CAAt5B;AAAu+B;;AAAAoB,EAAAA,OAAO,GAAE;AAAC,SAAKzD,QAAL,KAAgB,KAAKA,QAAL,CAAcyD,OAAd,IAAwB,KAAKzD,QAAL,GAAc,IAAtD;AAA4D,UAAMxC,CAAC,GAAC,CAAC,uBAAD,EAAyB,mBAAzB,EAA6C,iBAA7C,EAA+D,kBAA/D,EAAkF,oBAAlF,EAAuG,cAAvG,EAAsH,cAAtH,CAAR;;AAA8I,SAAI,MAAMC,CAAV,IAAeD,CAAf,EAAiB;AAAC,YAAMA,CAAC,GAAC,KAAKC,CAAL,CAAR;AAAgBD,MAAAA,CAAC,KAAGA,CAAC,CAACiG,OAAF,IAAY,KAAKb,IAAL,CAAUnF,CAAV,EAAY,IAAZ,CAAf,CAAD;AAAmC;;AAAA,SAAKmF,IAAL,CAAU,OAAV,EAAkB,IAAlB,GAAwB,KAAKA,IAAL,CAAU,OAAV,EAAkB,IAAlB,CAAxB;AAAgD;;AAAAc,EAAAA,YAAY,CAAClG,CAAD,EAAG;AAAC,UAAK;AAACmG,MAAAA,GAAG,EAAClG,CAAL;AAAOmG,MAAAA,MAAM,EAAClG;AAAd,QAAiB,KAAKwF,YAAL,CAAkBW,UAAlB,CAA6B,CAA7B,EAA+B,IAA/B,CAAtB;AAA2D,WAAO,KAAKX,YAAL,CAAkBY,MAAlB,CAAyBrG,CAAzB,EAA2BD,CAAC,CAACuG,GAA7B,GAAkCrG,CAAzC;AAA2C;;AAAAsG,EAAAA,SAAS,CAACxG,CAAD,EAAGE,CAAH,EAAK;AAAC,QAAGF,CAAC,YAAYoB,CAAhB,EAAkB;AAAC,YAAK;AAAC+E,QAAAA,GAAG,EAAClG,CAAL;AAAOmG,QAAAA,MAAM,EAAChG;AAAd,UAAiB,KAAKsF,YAAL,CAAkBW,UAAlB,CAA6B,CAA7B,EAA+BnG,CAA/B,CAAtB;AAAwD,aAAO,KAAK2D,KAAL,CAAW4C,cAAX,CAA0BzG,CAA1B,EAA6B0G,IAA7B,CAAmC1G,CAAC,IAAE,KAAK0F,YAAL,CAAkBiB,YAAlB,CAA+B1G,CAA/B,EAAiCD,CAAjC,CAAtC,GAA4EI,CAAnF;AAAqF;;AAAA,QAAG,YAAU,OAAOJ,CAAjB,IAAoB,YAAU,OAAOA,CAAxC,EAA0C,OAAO,KAAKwG,SAAL,CAAe,CAACxG,CAAD,CAAf,EAAmBE,CAAnB,CAAP;AAA6B,QAAGF,CAAC,YAAYC,CAAhB,EAAkB,OAAO,KAAKuG,SAAL,CAAe,CAACxG,CAAD,CAAf,EAAmBE,CAAnB,CAAP;;AAA6B,QAAG,aAAYF,CAAZ,KAAgBA,CAAC,GAACA,CAAC,CAAC4G,OAAF,EAAlB,GAA+BC,KAAK,CAACC,OAAN,CAAc9G,CAAd,KAAkBA,CAAC,CAAC+G,MAAF,GAAS,CAA7D,EAA+D;AAAC,UAAG/G,CAAC,CAAC,CAAD,CAAD,YAAeC,CAAlB,EAAoB;AAAC,cAAMA,CAAC,GAACD,CAAR;;AAAU,YAAG,QAAMmC,CAAC,CAAC,KAAKuB,KAAL,CAAWsD,WAAZ,EAAwB/G,CAAC,CAAC,CAAD,CAAD,CAAKgH,UAA7B,EAAwC/G,CAAxC,CAAV,EAAqD;AAAC,gBAAMF,CAAC,GAACC,CAAC,CAACiH,GAAF,CAAOlH,CAAC,IAAEA,CAAC,CAACuG,GAAZ,CAAR;AAAA,gBAA0B;AAACJ,YAAAA,GAAG,EAACjG,CAAL;AAAOkG,YAAAA,MAAM,EAAChG;AAAd,cAAiB,KAAKsF,YAAL,CAAkBW,UAAlB,CAA6B,CAA7B,EAA+B,IAA/B,CAA3C;AAAgF,iBAAO,KAAKX,YAAL,CAAkByB,OAAlB,CAA0BjH,CAA1B,EAA4BF,CAA5B,GAA+BI,CAAtC;AAAwC;;AAAAJ,QAAAA,CAAC,GAACC,CAAC,CAACiH,GAAF,CAAOlH,CAAC,IAAEmC,CAAC,CAAC,KAAKuB,KAAL,CAAWsD,WAAZ,EAAwBhH,CAAC,CAACiH,UAA1B,EAAqC/G,CAArC,CAAX,CAAF;AAAuD;;AAAA,UAAG,YAAU,OAAOF,CAAC,CAAC,CAAD,CAAlB,IAAuB,YAAU,OAAOA,CAAC,CAAC,CAAD,CAA5C,EAAgD;AAAC,cAAMC,CAAC,GAACD,CAAR;AAAA,cAAU;AAACmG,UAAAA,GAAG,EAAC/F,CAAL;AAAOgG,UAAAA,MAAM,EAAC/F;AAAd,YAAiB,KAAKqF,YAAL,CAAkBW,UAAlB,CAA6B,CAA7B,EAA+BnG,CAA/B,CAA3B;AAA6D,eAAO,KAAKwF,YAAL,CAAkBiB,YAAlB,CAA+BvG,CAA/B,EAAiCH,CAAjC,GAAoCI,CAA3C;AAA6C;AAAC;;AAAA,WAAO+G,CAAP;AAAS;;AAAAtB,EAAAA,qBAAqB,GAAE;AAAC,UAAM9F,CAAC,GAAC,KAAK6D,KAAL,CAAWkB,IAAX,CAAgBsC,YAAxB;AAAqC,SAAKjE,YAAL,CAAkBkE,iBAAlB,CAAoCtH,CAApC,EAAsC,KAAK6D,KAAL,CAAWkB,IAAX,CAAgBwC,gBAAtD,MAA0E,KAAKpD,oBAAL,CAA0BnE,CAA1B,KAA8B,KAAKoD,YAAL,CAAkBoE,mBAAlB,EAAxG;AAAiJ;;AAAA3B,EAAAA,wBAAwB,GAAE;AAAC,KAAC,KAAK5C,iBAAL,IAAwB,KAAKH,eAA9B,KAAgD,KAAKN,QAAL,CAAc+B,GAAd,CAAkB9D,CAAC,CAAC,IAAD,EAAM,yBAAN,EAAiC,MAAI;AAAC,cAAO,KAAK+B,QAAL,CAAciF,MAAd,CAAqBC,CAArB,GAAwB,KAAKhF,uBAApC;AAA6D,aAAI,UAAJ;AAAe,eAAKF,QAAL,CAAc+B,GAAd,CAAkB,CAAC9D,CAAC,CAAC,KAAK2C,YAAN,EAAmB,gBAAnB,EAAqCpD,CAAC,IAAE,KAAK2H,yBAAL,CAA+B3H,CAA/B,CAAxC,CAAF,EAA8E,KAAKoD,YAAL,CAAkBwE,KAAlB,CAAwB,eAAxB,EAAyC,MAAI,KAAKD,yBAAL,CAA+B,KAAKvE,YAAL,CAAkByE,cAAjD,CAA7C,CAA9E,CAAlB,EAAiNH,CAAjN;;AAAoN;;AAAM,aAAI,MAAJ;AAAW,eAAKlF,QAAL,CAAc+B,GAAd,CAAkB,CAAC9D,CAAC,CAAC,IAAD,EAAM,YAAN,EAAoBT,CAAC,IAAE,KAAK2H,yBAAL,CAA+B3H,CAA/B,CAAvB,CAAF,EAA6D,KAAKoD,YAAL,CAAkBwE,KAAlB,CAAwB,eAAxB,EAAyC,MAAI,KAAKD,yBAAL,CAA+B,KAAKhF,UAApC,CAA7C,CAA7D,CAAlB,EAA+K+E,CAA/K;;AAAkL;;AAAM;AAAQtH,UAAAA,CAAC,CAAC,KAAKsC,uBAAN,CAAD;AAAjf;AAAkhB,KAAxjB,CAAnB,CAAhD;AAA+nB;;AAAAiF,EAAAA,yBAAyB,CAAC3H,CAAD,EAAG;AAACA,IAAAA,CAAC,GAAC,KAAK8H,0BAAL,CAAgC,KAAKC,yBAAL,CAA+B/H,CAA/B,EAAiC,KAAK4C,mBAAtC,CAAhC,CAAD,GAA6F,KAAKkF,0BAAL,CAAgC,IAAhC,CAA9F;AAAoI;;AAAAC,EAAAA,yBAAyB,CAAC/H,CAAD,EAAGC,CAAH,EAAK;AAAC,UAAMC,CAAC,GAAC,KAAK2D,KAAL,CAAWkB,IAAX,CAAgBwC,gBAAxB;;AAAyC,QAAG,CAACvH,CAAC,CAACuH,gBAAF,CAAmBS,MAAnB,CAA0B9H,CAA1B,CAAJ,EAAiC;AAAC,UAAG,CAACe,CAAC,CAACjB,CAAD,EAAGE,CAAH,CAAL,EAAW;AAAOF,MAAAA,CAAC,GAACmB,CAAC,CAACnB,CAAD,EAAGE,CAAH,CAAH;AAAS;;AAAA,WAAO+B,CAAC,CAACjC,CAAD,EAAGC,CAAH,EAAKqB,CAAL,EAAO,KAAK8B,YAAL,CAAkB6E,aAAzB,CAAR;AAAgD;;AAAAH,EAAAA,0BAA0B,CAAC9H,CAAD,EAAG;AAAC,SAAKiD,iBAAL,IAAwB,KAAKA,iBAAL,CAAuBiF,SAAvB,CAAiClI,CAAjC,CAAxB,EAA4D,KAAK8C,eAAL,IAAsB,KAAKA,eAAL,CAAqBoF,SAArB,CAA+BlI,CAA/B,CAAlF;AAAoH;;AAAriM,CAArB;AAA4jMA,CAAC,CAAC,CAACW,CAAC,CAAC;AAACwH,EAAAA,OAAO,EAAC;AAAT,CAAD,CAAF,CAAD,EAAqC7F,CAAC,CAAC8F,SAAvC,EAAiD,OAAjD,EAAyD,KAAK,CAA9D,CAAD,EAAkEpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAACwH,EAAAA,OAAO,EAAC;AAAT,CAAD,CAAF,CAAD,EAAqC7F,CAAC,CAAC8F,SAAvC,EAAiD,OAAjD,EAAyD,KAAK,CAA9D,CAAnE,EAAoIpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC0H,EAAAA,aAAa,EAAC,CAAC;AAAhB,CAAD,CAAF,CAAD,EAAyB/F,CAAC,CAAC8F,SAA3B,EAAqC,sBAArC,EAA4D,KAAK,CAAjE,CAArI,EAAyMpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC0H,EAAAA,aAAa,EAAC,CAAC;AAAhB,CAAD,CAAF,CAAD,EAAyB/F,CAAC,CAAC8F,SAA3B,EAAqC,cAArC,EAAoD,KAAK,CAAzD,CAA1M,EAAsQpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC0H,EAAAA,aAAa,EAAC,CAAC;AAAhB,CAAD,CAAF,CAAD,EAAyB/F,CAAC,CAAC8F,SAA3B,EAAqC,iBAArC,EAAuD,KAAK,CAA5D,CAAvQ,EAAsUpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC0H,EAAAA,aAAa,EAAC,CAAC;AAAhB,CAAD,CAAF,CAAD,EAAyB/F,CAAC,CAAC8F,SAA3B,EAAqC,kBAArC,EAAwD,KAAK,CAA7D,CAAvU,EAAuYpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC0H,EAAAA,aAAa,EAAC,CAAC;AAAhB,CAAD,CAAF,CAAD,EAAyB/F,CAAC,CAAC8F,SAA3B,EAAqC,oBAArC,EAA0D,KAAK,CAA/D,CAAxY,EAA0cpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC0H,EAAAA,aAAa,EAAC,CAAC;AAAhB,CAAD,CAAF,CAAD,EAAyB/F,CAAC,CAAC8F,SAA3B,EAAqC,mBAArC,EAAyD,KAAK,CAA9D,CAA3c,EAA4gBpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC2H,EAAAA,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoBhG,CAAC,CAAC8F,SAAtB,EAAgC,eAAhC,EAAgD,KAAK,CAArD,CAA7gB,EAAqkBpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC2H,EAAAA,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoBhG,CAAC,CAAC8F,SAAtB,EAAgC,UAAhC,EAA2C,KAAK,CAAhD,CAAtkB,EAAynBpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC2H,EAAAA,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoBhG,CAAC,CAAC8F,SAAtB,EAAgC,cAAhC,EAA+C,KAAK,CAApD,CAA1nB,EAAirBpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC2H,EAAAA,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoBhG,CAAC,CAAC8F,SAAtB,EAAgC,uBAAhC,EAAwD,KAAK,CAA7D,CAAlrB,EAAkvBpI,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO2B,CAAC,CAAC8F,SAAT,EAAmB,yBAAnB,EAA6C,KAAK,CAAlD,CAAnvB,EAAwyBpI,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO2B,CAAC,CAAC8F,SAAT,EAAmB,YAAnB,EAAgC,KAAK,CAArC,CAAzyB,EAAi1BpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC2H,EAAAA,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoBhG,CAAC,CAAC8F,SAAtB,EAAgC,WAAhC,EAA4C,IAA5C,CAAl1B,EAAo4BpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC2H,EAAAA,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoBhG,CAAC,CAAC8F,SAAtB,EAAgC,aAAhC,EAA8C,IAA9C,CAAr4B,EAAy7BpI,CAAC,CAAC,CAACW,CAAC,CAAC;AAAC2H,EAAAA,QAAQ,EAAC,CAAC,CAAX;AAAaC,EAAAA,SAAS,EAAC,CAAC,uBAAD,EAAyB,4BAAzB,EAAsD,gCAAtD;AAAvB,CAAD,CAAF,CAAD,EAAsHjG,CAAC,CAAC8F,SAAxH,EAAkI,UAAlI,EAA6I,IAA7I,CAA17B,EAA6kC9F,CAAC,GAACtC,CAAC,CAAC,CAACa,CAAC,CAAC,8DAAD,CAAF,CAAD,EAAqEyB,CAArE,CAAhlC;AAAwpC,IAAIkG,CAAC,GAAClG,CAAN;AAAQ,MAAMoF,CAAC,GAAC,yBAAR;AAAA,MAAkCN,CAAC,GAAC;AAACK,EAAAA,MAAM,GAAE,CAAE,CAAX;;AAAYgB,EAAAA,KAAK,GAAE,CAAE,CAArB;;AAAsBC,EAAAA,MAAM,GAAE,CAAE;;AAAhC,CAApC;AAAsE,eAAeF,CAAf","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../Graphic.js\";import i from\"../../../../core/Accessor.js\";import{neverReached as s}from\"../../../../core/compilerUtils.js\";import r from\"../../../../core/Handles.js\";import{logOnError as n}from\"../../../../core/promiseUtils.js\";import{init as a}from\"../../../../core/watchUtils.js\";import{property as o}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{diff as p}from\"../../../../core/accessorSupport/diffUtils.js\";import{canProject as h,project as d}from\"../../../../geometry/support/webMercatorUtils.js\";import c from\"../../../../rest/support/Query.js\";import{SUSPEND_RESUME_EXTENT_OPTIMISM as u}from\"./constants.js\";import{Graphics3DCore as g}from\"./Graphics3DCore.js\";import m from\"./Graphics3DElevationAlignment.js\";import{Graphics3DFilterVisibility as y}from\"./Graphics3DFilterVisibility.js\";import f from\"./Graphics3DFrustumVisibility.js\";import{Graphics3DObjectStates as b}from\"./Graphics3DObjectStates.js\";import w from\"./Graphics3DScaleVisibility.js\";import{enlargeExtent as x}from\"./graphicUtils.js\";import{attributeLookup as E}from\"../support/attributeUtils.js\";import{WatchUpdatingTracking as C}from\"../../../support/WatchUpdatingTracking.js\";let V=class extends i{constructor(t){super(t),this._handles=new r,this.watchUpdatingTracking=new C,this.suspendResumeExtentMode=\"computed\",this.dataExtent=null,this.suspendResumeExtent=null}get suspended(){var t;return null==(t=this.scaleVisibility)?void 0:t.suspended}get suspendInfo(){var t,e;const i={};return null!=(t=this.scaleVisibility)&&t.suspended&&(i.outsideScaleRange=!0),null!=(e=this.frustumVisibility)&&e.suspended&&(i.outsideOfView=!0),i}get updating(){var t,e,i;return!!(null!=(t=this.graphicsCore)&&t.updating||null!=(e=this.frustumVisibility)&&e.updating||null!=(i=this.watchUpdatingTracking)&&i.updating)}normalizeCtorArgs(t){const e=t.frustumVisibilityEnabled?new f:null,i=t.scaleVisibilityEnabled?new w:null,s=(t.filterVisibilityEnabled||t.timeExtentVisibilityEnabled)&&\"multipatch\"!==t.layer.geometryType?new y:null,r=t.elevationAlignmentEnabled?new m:null,n=new g({owner:t.owner,layer:t.layer,preferredUpdatePolicy:t.preferredUpdatePolicy,elevationFeatureExpressionEnabled:t.elevationFeatureExpressionEnabled,graphicSymbolSupported:!1,hasZ:t.owner.hasZ,hasM:t.owner.hasM}),{updateClippingExtent:a,suspendResumeExtentMode:o,dataExtent:l}=t;return{graphicsCore:n,frustumVisibility:e,scaleVisibility:i,filterVisibility:s,elevationAlignment:r,updateClippingExtent:a,suspendResumeExtentMode:o,dataExtent:l}}initialize(){this.scaleVisibility&&this.watchUpdatingTracking.add(this.layer,\"scaleRangeId\",(()=>this.scaleVisibility.layerMinMaxScaleChangeHandler())),this.filterVisibility&&(this.watchUpdatingTracking.add(this.owner,\"filter\",(()=>this.filterVisibility.filterChanged())),this.watchUpdatingTracking.add(this.owner,\"timeExtent\",(()=>this.filterVisibility.filterChanged()))),this.elevationAlignment&&this.watchUpdatingTracking.add(this.layer,\"elevationInfo\",((t,e)=>{p(t,e)&&this.watchUpdatingTracking.addPromise(this.graphicsCore.elevationInfoChange())})),this.watchUpdatingTracking.add(this.layer,\"labelsVisible\",(()=>this.graphicsCore.updateVisibilityInfo())),this.watchUpdatingTracking.add(this.layer,\"labelingInfo\",((t,e)=>{p(t,e)&&this.graphicsCore.updateLabelingInfo()}))}async setup(){this.frustumVisibility&&this.frustumVisibility.setup(this.owner);const t=this.owner,e=this.owner.view.basemapTerrain,i=(t,e,i)=>this.graphicsCore.spatialIndex.queryGraphicUIDsInExtent(t,e,i);if(this.scaleVisibility&&this.scaleVisibility.setup(t,this.layer,i,this.graphicsCore,e),this.filterVisibility&&(\"filter\"in t||\"timeExtent\"in t)&&this.filterVisibility.setup(t,this.graphicsCore),this.elevationAlignment){const e=t.view.elevationProvider;this.elevationAlignment.setup(t,i,this.graphicsCore,e)}this._set(\"objectStates\",new b(this.graphicsCore)),this._set(\"labeling\",this.owner.view.labeler.addGraphicsOwner(this.graphicsCore,this.scaleVisibility)),this._set(\"deconfliction\",t.view.deconflictor.addGraphicsOwner(this.graphicsCore)),await n(this.graphicsCore.setup({elevationAlignment:this.elevationAlignment,scaleVisibility:this.scaleVisibility,filterVisibility:this.filterVisibility,deconflictor:this.deconfliction,labeler:this.labeling,objectStates:this.objectStates})),this.watchUpdatingTracking.add(this.layer,\"renderer\",(t=>this.watchUpdatingTracking.addPromise(this.graphicsCore.rendererChange(t)))),this.watchUpdatingTracking.add(t,\"fullOpacity\",(()=>this.graphicsCore.opacityChange())),this.setupSuspendResumeExtent(),this.updateClippingExtent&&(this.watchUpdatingTracking.add(t.view,\"clippingArea\",(()=>this._updateClippingExtent())),this._updateClippingExtent()),this.graphicsCore.startCreateGraphics(),this.graphicsCore.labelsEnabled&&await n(this.graphicsCore.updateLabelingInfo())}destroy(){this._handles&&(this._handles.destroy(),this._handles=null);const t=[\"watchUpdatingTracking\",\"frustumVisibility\",\"scaleVisibility\",\"filterVisibility\",\"elevationAlignment\",\"objectStates\",\"graphicsCore\"];for(const e of t){const t=this[e];t&&(t.destroy(),this._set(e,null))}this._set(\"layer\",null),this._set(\"owner\",null)}maskOccludee(t){const{set:e,handle:i}=this.objectStates.acquireSet(1,null);return this.objectStates.setUid(e,t.uid),i}highlight(t,i){if(t instanceof c){const{set:e,handle:s}=this.objectStates.acquireSet(0,i);return this.owner.queryObjectIds(t).then((t=>this.objectStates.setObjectIds(e,t))),s}if(\"number\"==typeof t||\"string\"==typeof t)return this.highlight([t],i);if(t instanceof e)return this.highlight([t],i);if(\"toArray\"in t&&(t=t.toArray()),Array.isArray(t)&&t.length>0){if(t[0]instanceof e){const e=t;if(null==E(this.layer.fieldsIndex,e[0].attributes,i)){const t=e.map((t=>t.uid)),{set:i,handle:s}=this.objectStates.acquireSet(0,null);return this.objectStates.setUids(i,t),s}t=e.map((t=>E(this.layer.fieldsIndex,t.attributes,i)))}if(\"number\"==typeof t[0]||\"string\"==typeof t[0]){const e=t,{set:s,handle:r}=this.objectStates.acquireSet(0,i);return this.objectStates.setObjectIds(s,e),r}}return S}_updateClippingExtent(){const t=this.owner.view.clippingArea;this.graphicsCore.setClippingExtent(t,this.owner.view.spatialReference)&&(this.updateClippingExtent(t)||this.graphicsCore.recreateAllGraphics())}setupSuspendResumeExtent(){(this.frustumVisibility||this.scaleVisibility)&&this._handles.add(a(this,\"suspendResumeExtentMode\",(()=>{switch(this._handles.remove(j),this.suspendResumeExtentMode){case\"computed\":this._handles.add([a(this.graphicsCore,\"computedExtent\",(t=>this.updateSuspendResumeExtent(t))),this.graphicsCore.watch(\"extentPadding\",(()=>this.updateSuspendResumeExtent(this.graphicsCore.computedExtent)))],j);break;case\"data\":this._handles.add([a(this,\"dataExtent\",(t=>this.updateSuspendResumeExtent(t))),this.graphicsCore.watch(\"extentPadding\",(()=>this.updateSuspendResumeExtent(this.dataExtent)))],j);break;default:s(this.suspendResumeExtentMode)}})))}updateSuspendResumeExtent(t){t?this.suspendResumeExtentChanged(this.extentToSuspendResumeRect(t,this.suspendResumeExtent)):this.suspendResumeExtentChanged(null)}extentToSuspendResumeRect(t,e){const i=this.owner.view.spatialReference;if(!t.spatialReference.equals(i)){if(!h(t,i))return;t=d(t,i)}return x(t,e,u,this.graphicsCore.extentPadding)}suspendResumeExtentChanged(t){this.frustumVisibility&&this.frustumVisibility.setExtent(t),this.scaleVisibility&&this.scaleVisibility.setExtent(t)}};t([o({aliasOf:\"graphicsCore.layer\"})],V.prototype,\"layer\",void 0),t([o({aliasOf:\"graphicsCore.owner\"})],V.prototype,\"owner\",void 0),t([o({constructOnly:!0})],V.prototype,\"updateClippingExtent\",void 0),t([o({constructOnly:!0})],V.prototype,\"graphicsCore\",void 0),t([o({constructOnly:!0})],V.prototype,\"scaleVisibility\",void 0),t([o({constructOnly:!0})],V.prototype,\"filterVisibility\",void 0),t([o({constructOnly:!0})],V.prototype,\"elevationAlignment\",void 0),t([o({constructOnly:!0})],V.prototype,\"frustumVisibility\",void 0),t([o({readOnly:!0})],V.prototype,\"deconfliction\",void 0),t([o({readOnly:!0})],V.prototype,\"labeling\",void 0),t([o({readOnly:!0})],V.prototype,\"objectStates\",void 0),t([o({readOnly:!0})],V.prototype,\"watchUpdatingTracking\",void 0),t([o()],V.prototype,\"suspendResumeExtentMode\",void 0),t([o()],V.prototype,\"dataExtent\",void 0),t([o({readOnly:!0})],V.prototype,\"suspended\",null),t([o({readOnly:!0})],V.prototype,\"suspendInfo\",null),t([o({readOnly:!0,dependsOn:[\"graphicsCore.updating\",\"frustumVisibility.updating\",\"watchUpdatingTracking.updating\"]})],V.prototype,\"updating\",null),V=t([l(\"esri.views.3d.layers.graphics.Graphics3DFeatureLikeLayerView\")],V);var v=V;const j=\"suspendResumeExtentMode\",S={remove(){},pause(){},resume(){}};export default v;\n"]},"metadata":{},"sourceType":"module"}