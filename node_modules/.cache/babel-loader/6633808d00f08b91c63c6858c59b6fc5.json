{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport \"../../core/has.js\";\nimport { isNone as e } from \"../../core/maybe.js\";\n\nfunction r(e, r) {\n  return e.vertexBuffers[r].size / t(e.layout[r]);\n}\n\nfunction t(e) {\n  return e[0].stride;\n}\n\nfunction i(e, r, t, i, s) {\n  const n = e.gl,\n        o = e.capabilities.instancing;\n  e.bindBuffer(t);\n\n  for (const a of i) {\n    const e = r.get(a.name);\n    void 0 === e && console.error(`There is no location for vertex attribute '${a.name}' defined.`), a.baseInstance && !a.divisor && console.error(`Vertex attribute '${a.name}' uses baseInstanceOffset without divisor.`);\n    const t = (s || (0 + a.baseInstance ? a.baseInstance : 0)) * a.stride;\n    if (a.count <= 4) n.vertexAttribPointer(e, a.count, a.type, a.normalized, a.stride, a.offset + t), n.enableVertexAttribArray(e), a.divisor > 0 && o && o.vertexAttribDivisor(e, a.divisor);else if (9 === a.count) for (let r = 0; r < 3; r++) n.vertexAttribPointer(e + r, 3, a.type, a.normalized, a.stride, a.offset + 12 * r + t), n.enableVertexAttribArray(e + r), a.divisor > 0 && o && o.vertexAttribDivisor(e + r, a.divisor);else if (16 === a.count) for (let r = 0; r < 4; r++) n.vertexAttribPointer(e + r, 4, a.type, a.normalized, a.stride, a.offset + 16 * r + t), n.enableVertexAttribArray(e + r), a.divisor > 0 && o && o.vertexAttribDivisor(e + r, a.divisor);else console.error(\"Unsupported vertex attribute element count: \" + a.count);\n  }\n}\n\nfunction s(e, r, t, i) {\n  const s = e.gl,\n        n = e.capabilities.instancing;\n  e.bindBuffer(t);\n\n  for (const o of i) {\n    const e = r.get(o.name);\n    if (o.count <= 4) s.disableVertexAttribArray(e), o.divisor && o.divisor > 0 && n && n.vertexAttribDivisor(e, 0);else if (9 === o.count) for (let r = 0; r < 3; r++) s.disableVertexAttribArray(e + r), o.divisor && o.divisor > 0 && n && n.vertexAttribDivisor(e + r, 0);else if (16 === o.count) for (let r = 0; r < 4; r++) s.disableVertexAttribArray(e + r), o.divisor && o.divisor > 0 && n && n.vertexAttribDivisor(e + r, 0);else console.error(\"Unsupported vertex attribute element count: \" + o.count);\n  }\n\n  e.unbindBuffer(34962);\n}\n\nfunction n(e) {\n  switch (e) {\n    case 6406:\n    case 6409:\n    case 36168:\n      return 1;\n\n    case 6410:\n    case 32854:\n    case 33325:\n    case 32854:\n    case 33189:\n      return 2;\n\n    case 6407:\n    case 6402:\n      return 3;\n\n    case 6408:\n    case 34041:\n    case 33326:\n    case 35898:\n    case 33327:\n    case 34041:\n      return 4;\n\n    case 33328:\n    case 34842:\n      return 8;\n\n    case 34836:\n      return 16;\n\n    case 33776:\n    case 33777:\n      return .5;\n\n    case 33778:\n    case 33779:\n      return 1;\n\n    case 37488:\n    case 37489:\n    case 37492:\n    case 37493:\n    case 37494:\n    case 37495:\n      return .5;\n\n    case 37490:\n    case 37491:\n    case 37496:\n    case 37497:\n      return 1;\n  }\n\n  return 0;\n}\n\nfunction o(r) {\n  if (e(r)) return 0;\n  if (\"descriptor\" in r) return r.glName ? o(r.descriptor) : 0;\n  const t = r.internalFormat || \"pixelFormat\" in r && r.pixelFormat;\n  if (!t) return 0;\n  const i = \"hasMipmap\" in r && r.hasMipmap ? 1.3 : 1,\n        s = r.width * r.height;\n  return n(t) * s * i;\n}\n\nexport { i as bindVertexBufferLayout, n as getBytesPerElementFormat, o as getGpuMemoryUsage, t as getStride, s as unbindVertexBufferLayout, r as vertexCount };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/webgl/Util.js"],"names":["isNone","e","r","vertexBuffers","size","t","layout","stride","i","s","n","gl","o","capabilities","instancing","bindBuffer","a","get","name","console","error","baseInstance","divisor","count","vertexAttribPointer","type","normalized","offset","enableVertexAttribArray","vertexAttribDivisor","disableVertexAttribArray","unbindBuffer","glName","descriptor","internalFormat","pixelFormat","hasMipmap","width","height","bindVertexBufferLayout","getBytesPerElementFormat","getGpuMemoryUsage","getStride","unbindVertexBufferLayout","vertexCount"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAM,mBAAN;AAA0B,SAAOA,MAAM,IAAIC,CAAjB,QAAuB,qBAAvB;;AAA6C,SAASC,CAAT,CAAWD,CAAX,EAAaC,CAAb,EAAe;AAAC,SAAOD,CAAC,CAACE,aAAF,CAAgBD,CAAhB,EAAmBE,IAAnB,GAAwBC,CAAC,CAACJ,CAAC,CAACK,MAAF,CAASJ,CAAT,CAAD,CAAhC;AAA8C;;AAAA,SAASG,CAAT,CAAWJ,CAAX,EAAa;AAAC,SAAOA,CAAC,CAAC,CAAD,CAAD,CAAKM,MAAZ;AAAmB;;AAAA,SAASC,CAAT,CAAWP,CAAX,EAAaC,CAAb,EAAeG,CAAf,EAAiBG,CAAjB,EAAmBC,CAAnB,EAAqB;AAAC,QAAMC,CAAC,GAACT,CAAC,CAACU,EAAV;AAAA,QAAaC,CAAC,GAACX,CAAC,CAACY,YAAF,CAAeC,UAA9B;AAAyCb,EAAAA,CAAC,CAACc,UAAF,CAAaV,CAAb;;AAAgB,OAAI,MAAMW,CAAV,IAAeR,CAAf,EAAiB;AAAC,UAAMP,CAAC,GAACC,CAAC,CAACe,GAAF,CAAMD,CAAC,CAACE,IAAR,CAAR;AAAsB,SAAK,CAAL,KAASjB,CAAT,IAAYkB,OAAO,CAACC,KAAR,CAAe,8CAA6CJ,CAAC,CAACE,IAAK,YAAnE,CAAZ,EAA4FF,CAAC,CAACK,YAAF,IAAgB,CAACL,CAAC,CAACM,OAAnB,IAA4BH,OAAO,CAACC,KAAR,CAAe,qBAAoBJ,CAAC,CAACE,IAAK,4CAA1C,CAAxH;AAA+M,UAAMb,CAAC,GAAC,CAACI,CAAC,KAAG,IAAEO,CAAC,CAACK,YAAJ,GAAiBL,CAAC,CAACK,YAAnB,GAAgC,CAAnC,CAAF,IAAyCL,CAAC,CAACT,MAAnD;AAA0D,QAAGS,CAAC,CAACO,KAAF,IAAS,CAAZ,EAAcb,CAAC,CAACc,mBAAF,CAAsBvB,CAAtB,EAAwBe,CAAC,CAACO,KAA1B,EAAgCP,CAAC,CAACS,IAAlC,EAAuCT,CAAC,CAACU,UAAzC,EAAoDV,CAAC,CAACT,MAAtD,EAA6DS,CAAC,CAACW,MAAF,GAAStB,CAAtE,GAAyEK,CAAC,CAACkB,uBAAF,CAA0B3B,CAA1B,CAAzE,EAAsGe,CAAC,CAACM,OAAF,GAAU,CAAV,IAAaV,CAAb,IAAgBA,CAAC,CAACiB,mBAAF,CAAsB5B,CAAtB,EAAwBe,CAAC,CAACM,OAA1B,CAAtH,CAAd,KAA4K,IAAG,MAAIN,CAAC,CAACO,KAAT,EAAe,KAAI,IAAIrB,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,CAAd,EAAgBA,CAAC,EAAjB,EAAoBQ,CAAC,CAACc,mBAAF,CAAsBvB,CAAC,GAACC,CAAxB,EAA0B,CAA1B,EAA4Bc,CAAC,CAACS,IAA9B,EAAmCT,CAAC,CAACU,UAArC,EAAgDV,CAAC,CAACT,MAAlD,EAAyDS,CAAC,CAACW,MAAF,GAAS,KAAGzB,CAAZ,GAAcG,CAAvE,GAA0EK,CAAC,CAACkB,uBAAF,CAA0B3B,CAAC,GAACC,CAA5B,CAA1E,EAAyGc,CAAC,CAACM,OAAF,GAAU,CAAV,IAAaV,CAAb,IAAgBA,CAAC,CAACiB,mBAAF,CAAsB5B,CAAC,GAACC,CAAxB,EAA0Bc,CAAC,CAACM,OAA5B,CAAzH,CAAnC,KAAsM,IAAG,OAAKN,CAAC,CAACO,KAAV,EAAgB,KAAI,IAAIrB,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,CAAd,EAAgBA,CAAC,EAAjB,EAAoBQ,CAAC,CAACc,mBAAF,CAAsBvB,CAAC,GAACC,CAAxB,EAA0B,CAA1B,EAA4Bc,CAAC,CAACS,IAA9B,EAAmCT,CAAC,CAACU,UAArC,EAAgDV,CAAC,CAACT,MAAlD,EAAyDS,CAAC,CAACW,MAAF,GAAS,KAAGzB,CAAZ,GAAcG,CAAvE,GAA0EK,CAAC,CAACkB,uBAAF,CAA0B3B,CAAC,GAACC,CAA5B,CAA1E,EAAyGc,CAAC,CAACM,OAAF,GAAU,CAAV,IAAaV,CAAb,IAAgBA,CAAC,CAACiB,mBAAF,CAAsB5B,CAAC,GAACC,CAAxB,EAA0Bc,CAAC,CAACM,OAA5B,CAAzH,CAApC,KAAuMH,OAAO,CAACC,KAAR,CAAc,iDAA+CJ,CAAC,CAACO,KAA/D;AAAsE;AAAC;;AAAA,SAASd,CAAT,CAAWR,CAAX,EAAaC,CAAb,EAAeG,CAAf,EAAiBG,CAAjB,EAAmB;AAAC,QAAMC,CAAC,GAACR,CAAC,CAACU,EAAV;AAAA,QAAaD,CAAC,GAACT,CAAC,CAACY,YAAF,CAAeC,UAA9B;AAAyCb,EAAAA,CAAC,CAACc,UAAF,CAAaV,CAAb;;AAAgB,OAAI,MAAMO,CAAV,IAAeJ,CAAf,EAAiB;AAAC,UAAMP,CAAC,GAACC,CAAC,CAACe,GAAF,CAAML,CAAC,CAACM,IAAR,CAAR;AAAsB,QAAGN,CAAC,CAACW,KAAF,IAAS,CAAZ,EAAcd,CAAC,CAACqB,wBAAF,CAA2B7B,CAA3B,GAA8BW,CAAC,CAACU,OAAF,IAAWV,CAAC,CAACU,OAAF,GAAU,CAArB,IAAwBZ,CAAxB,IAA2BA,CAAC,CAACmB,mBAAF,CAAsB5B,CAAtB,EAAwB,CAAxB,CAAzD,CAAd,KAAuG,IAAG,MAAIW,CAAC,CAACW,KAAT,EAAe,KAAI,IAAIrB,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,CAAd,EAAgBA,CAAC,EAAjB,EAAoBO,CAAC,CAACqB,wBAAF,CAA2B7B,CAAC,GAACC,CAA7B,GAAgCU,CAAC,CAACU,OAAF,IAAWV,CAAC,CAACU,OAAF,GAAU,CAArB,IAAwBZ,CAAxB,IAA2BA,CAAC,CAACmB,mBAAF,CAAsB5B,CAAC,GAACC,CAAxB,EAA0B,CAA1B,CAA3D,CAAnC,KAAgI,IAAG,OAAKU,CAAC,CAACW,KAAV,EAAgB,KAAI,IAAIrB,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,CAAd,EAAgBA,CAAC,EAAjB,EAAoBO,CAAC,CAACqB,wBAAF,CAA2B7B,CAAC,GAACC,CAA7B,GAAgCU,CAAC,CAACU,OAAF,IAAWV,CAAC,CAACU,OAAF,GAAU,CAArB,IAAwBZ,CAAxB,IAA2BA,CAAC,CAACmB,mBAAF,CAAsB5B,CAAC,GAACC,CAAxB,EAA0B,CAA1B,CAA3D,CAApC,KAAiIiB,OAAO,CAACC,KAAR,CAAc,iDAA+CR,CAAC,CAACW,KAA/D;AAAsE;;AAAAtB,EAAAA,CAAC,CAAC8B,YAAF,CAAe,KAAf;AAAsB;;AAAA,SAASrB,CAAT,CAAWT,CAAX,EAAa;AAAC,UAAOA,CAAP;AAAU,SAAK,IAAL;AAAU,SAAK,IAAL;AAAU,SAAK,KAAL;AAAW,aAAO,CAAP;;AAAS,SAAK,IAAL;AAAU,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,aAAO,CAAP;;AAAS,SAAK,IAAL;AAAU,SAAK,IAAL;AAAU,aAAO,CAAP;;AAAS,SAAK,IAAL;AAAU,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,aAAO,CAAP;;AAAS,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,aAAO,CAAP;;AAAS,SAAK,KAAL;AAAW,aAAO,EAAP;;AAAU,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,aAAM,EAAN;;AAAS,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,aAAO,CAAP;;AAAS,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,aAAM,EAAN;;AAAS,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,SAAK,KAAL;AAAW,aAAO,CAAP;AAAjc;;AAA0c,SAAO,CAAP;AAAS;;AAAA,SAASW,CAAT,CAAWV,CAAX,EAAa;AAAC,MAAGD,CAAC,CAACC,CAAD,CAAJ,EAAQ,OAAO,CAAP;AAAS,MAAG,gBAAeA,CAAlB,EAAoB,OAAOA,CAAC,CAAC8B,MAAF,GAASpB,CAAC,CAACV,CAAC,CAAC+B,UAAH,CAAV,GAAyB,CAAhC;AAAkC,QAAM5B,CAAC,GAACH,CAAC,CAACgC,cAAF,IAAkB,iBAAgBhC,CAAhB,IAAmBA,CAAC,CAACiC,WAA/C;AAA2D,MAAG,CAAC9B,CAAJ,EAAM,OAAO,CAAP;AAAS,QAAMG,CAAC,GAAC,eAAcN,CAAd,IAAiBA,CAAC,CAACkC,SAAnB,GAA6B,GAA7B,GAAiC,CAAzC;AAAA,QAA2C3B,CAAC,GAACP,CAAC,CAACmC,KAAF,GAAQnC,CAAC,CAACoC,MAAvD;AAA8D,SAAO5B,CAAC,CAACL,CAAD,CAAD,GAAKI,CAAL,GAAOD,CAAd;AAAgB;;AAAA,SAAOA,CAAC,IAAI+B,sBAAZ,EAAmC7B,CAAC,IAAI8B,wBAAxC,EAAiE5B,CAAC,IAAI6B,iBAAtE,EAAwFpC,CAAC,IAAIqC,SAA7F,EAAuGjC,CAAC,IAAIkC,wBAA5G,EAAqIzC,CAAC,IAAI0C,WAA1I","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../core/has.js\";import{isNone as e}from\"../../core/maybe.js\";function r(e,r){return e.vertexBuffers[r].size/t(e.layout[r])}function t(e){return e[0].stride}function i(e,r,t,i,s){const n=e.gl,o=e.capabilities.instancing;e.bindBuffer(t);for(const a of i){const e=r.get(a.name);void 0===e&&console.error(`There is no location for vertex attribute '${a.name}' defined.`),a.baseInstance&&!a.divisor&&console.error(`Vertex attribute '${a.name}' uses baseInstanceOffset without divisor.`);const t=(s||(0+a.baseInstance?a.baseInstance:0))*a.stride;if(a.count<=4)n.vertexAttribPointer(e,a.count,a.type,a.normalized,a.stride,a.offset+t),n.enableVertexAttribArray(e),a.divisor>0&&o&&o.vertexAttribDivisor(e,a.divisor);else if(9===a.count)for(let r=0;r<3;r++)n.vertexAttribPointer(e+r,3,a.type,a.normalized,a.stride,a.offset+12*r+t),n.enableVertexAttribArray(e+r),a.divisor>0&&o&&o.vertexAttribDivisor(e+r,a.divisor);else if(16===a.count)for(let r=0;r<4;r++)n.vertexAttribPointer(e+r,4,a.type,a.normalized,a.stride,a.offset+16*r+t),n.enableVertexAttribArray(e+r),a.divisor>0&&o&&o.vertexAttribDivisor(e+r,a.divisor);else console.error(\"Unsupported vertex attribute element count: \"+a.count)}}function s(e,r,t,i){const s=e.gl,n=e.capabilities.instancing;e.bindBuffer(t);for(const o of i){const e=r.get(o.name);if(o.count<=4)s.disableVertexAttribArray(e),o.divisor&&o.divisor>0&&n&&n.vertexAttribDivisor(e,0);else if(9===o.count)for(let r=0;r<3;r++)s.disableVertexAttribArray(e+r),o.divisor&&o.divisor>0&&n&&n.vertexAttribDivisor(e+r,0);else if(16===o.count)for(let r=0;r<4;r++)s.disableVertexAttribArray(e+r),o.divisor&&o.divisor>0&&n&&n.vertexAttribDivisor(e+r,0);else console.error(\"Unsupported vertex attribute element count: \"+o.count)}e.unbindBuffer(34962)}function n(e){switch(e){case 6406:case 6409:case 36168:return 1;case 6410:case 32854:case 33325:case 32854:case 33189:return 2;case 6407:case 6402:return 3;case 6408:case 34041:case 33326:case 35898:case 33327:case 34041:return 4;case 33328:case 34842:return 8;case 34836:return 16;case 33776:case 33777:return.5;case 33778:case 33779:return 1;case 37488:case 37489:case 37492:case 37493:case 37494:case 37495:return.5;case 37490:case 37491:case 37496:case 37497:return 1}return 0}function o(r){if(e(r))return 0;if(\"descriptor\"in r)return r.glName?o(r.descriptor):0;const t=r.internalFormat||\"pixelFormat\"in r&&r.pixelFormat;if(!t)return 0;const i=\"hasMipmap\"in r&&r.hasMipmap?1.3:1,s=r.width*r.height;return n(t)*s*i}export{i as bindVertexBufferLayout,n as getBytesPerElementFormat,o as getGpuMemoryUsage,t as getStride,s as unbindVertexBufferLayout,r as vertexCount};\n"]},"metadata":{},"sourceType":"module"}