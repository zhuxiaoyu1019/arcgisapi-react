{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../../../../core/BidiEngine.js\";\nimport { numericHash as t } from \"../../../../../core/string.js\";\nimport { C_DEG_TO_RAD as n, log2 as i, interpolate as s } from \"../GeometryUtils.js\";\nimport { TILE_PIXEL_RATIO as a, Anchor as o, TILE_COORD_SIZE as r } from \"../Placement.js\";\nimport { SDF_GLYPH_SIZE as l, TextShaping as h } from \"../TextShaping.js\";\nimport x from \"./BaseBucket.js\";\nimport { IconLayout as c, TextLayout as d } from \"../style/StyleLayer.js\";\nimport { Point as g } from \"../../webgl/Geometry.js\";\nconst f = 10;\n\nfunction y(e, t) {\n  return e.iconMosaicItem && t.iconMosaicItem ? e.iconMosaicItem.page === t.iconMosaicItem.page ? 0 : e.iconMosaicItem.page - t.iconMosaicItem.page : e.iconMosaicItem && !t.iconMosaicItem ? 1 : !e.iconMosaicItem && t.iconMosaicItem ? -1 : 0;\n}\n\nclass m extends x {\n  constructor(e, t, n, i, s, a, o, r) {\n    super(e, t, r.getSpriteItems()), this.type = 3, this._markerMap = new Map(), this._glyphMap = new Map(), this._glyphBufferDataStorage = new Map(), this._isIconSDF = !1, this._iconVertexBuffer = n, this._iconIndexBuffer = i, this._textVertexBuffer = s, this._textIndexBuffer = a, this._placementEngine = o, this._workerTileHandler = r;\n  }\n\n  get markerPageMap() {\n    return this._markerMap;\n  }\n\n  get glyphsPageMap() {\n    return this._glyphMap;\n  }\n\n  get symbolInstances() {\n    return this._symbolInstances;\n  }\n\n  getResources(e, n, i) {\n    const s = this.layer,\n          a = this.zoom;\n    e && e.setExtent(this.layerExtent);\n    const o = s.getLayoutProperty(\"icon-image\"),\n          r = s.getLayoutProperty(\"text-field\");\n    let l = s.getLayoutProperty(\"text-transform\"),\n        h = s.getLayoutProperty(\"text-font\");\n    const x = [];\n    let c, d, g, f;\n    o && !o.isDataDriven && (c = o.getValue(a)), r && !r.isDataDriven && (d = r.getValue(a)), l && l.isDataDriven || (g = s.getLayoutValue(\"text-transform\", a), l = null), h && h.isDataDriven || (f = s.getLayoutValue(\"text-font\", a), h = null);\n\n    for (const y of this._features) {\n      const u = y.getGeometry(e);\n      if (!u || 0 === u.length) continue;\n\n      let p, _;\n\n      o && (p = o.isDataDriven ? o.getValue(a, y) : this._replaceKeys(c, y.values), p && n.add({\n        name: p\n      }));\n      let M = !1;\n\n      if (r && (_ = r.isDataDriven ? r.getValue(a, y) : this._replaceKeys(d, y.values), _)) {\n        switch (_ = _.replace(/\\\\n/g, \"\\n\"), l && (g = l.getValue(a, y)), g) {\n          case 2:\n            _ = _.toLowerCase();\n            break;\n\n          case 1:\n            _ = _.toUpperCase();\n        }\n\n        if (m._bidiEngine.hasBidiChar(_)) {\n          let e;\n          e = \"rtl\" === m._bidiEngine.checkContextual(_) ? \"IDNNN\" : \"ICNNN\", _ = m._bidiEngine.bidiTransform(_, e, \"VLYSN\"), M = !0;\n        }\n\n        const e = _.length;\n\n        if (e > 0) {\n          h && (f = h.getValue(a, y));\n\n          for (const t of f) {\n            let n = i[t];\n            n || (n = i[t] = new Set());\n\n            for (let t = 0; t < e; t++) {\n              const e = _.charCodeAt(t);\n\n              n.add(e);\n            }\n          }\n        }\n      }\n\n      if (!p && !_) continue;\n      const b = s.getLayoutValue(\"symbol-sort-key\", a, y),\n            P = {\n        feature: y,\n        sprite: p,\n        label: _,\n        rtl: M,\n        geometry: u,\n        hash: (_ ? t(_) : 0) ^ (p ? t(p) : 0),\n        priority: b,\n        textFont: f\n      };\n      x.push(P);\n    }\n\n    this._symbolFeatures = x;\n  }\n\n  processFeatures(e) {\n    e && e.setExtent(this.layerExtent);\n\n    const t = this.layer,\n          i = this.zoom,\n          s = t.getLayoutValue(\"symbol-placement\", i),\n          x = 0 !== s,\n          g = t.getLayoutValue(\"symbol-spacing\", i) * a,\n          f = t.getLayoutProperty(\"icon-image\"),\n          u = t.getLayoutProperty(\"text-field\"),\n          p = f ? new c(t, i, x) : null,\n          _ = u ? new d(t, i, x) : null,\n          M = this._workerTileHandler;\n\n    let b;\n    f && (b = M.getSpriteItems()), this._iconIndexStart = 3 * this._iconIndexBuffer.index, this._textIndexStart = 3 * this._textIndexBuffer.index, this._iconIndexCount = 0, this._textIndexCount = 0, this._markerMap.clear(), this._glyphMap.clear();\n    const P = [];\n    let I = 1;\n    _ && _.size && (I = _.size / l);\n    const A = _ ? _.maxAngle * n : 0,\n          V = _ ? _.size * a : 0;\n\n    for (const n of this._symbolFeatures) {\n      let e;\n      p && b && n.sprite && (e = b[n.sprite], e && e.sdf && (this._isIconSDF = !0));\n      let t;\n      !!e && p.update(i, n.feature);\n      let c = 0;\n      const d = n.label;\n\n      if (d) {\n        _.update(i, n.feature);\n\n        const e = x ? _.keepUpright : _.writingMode && _.writingMode.indexOf(1) >= 0;\n        let s = .5;\n\n        switch (_.anchor) {\n          case 5:\n          case 1:\n          case 7:\n            s = 0;\n            break;\n\n          case 6:\n          case 2:\n          case 8:\n            s = 1;\n        }\n\n        let o = .5;\n\n        switch (_.anchor) {\n          case 5:\n          case 3:\n          case 6:\n            o = 0;\n            break;\n\n          case 7:\n          case 4:\n          case 8:\n            o = 1;\n        }\n\n        let r = .5;\n\n        switch (_.justify) {\n          case 0:\n            r = s;\n            break;\n\n          case 1:\n            r = 0;\n            break;\n\n          case 3:\n            r = 1;\n        }\n\n        const g = _.letterSpacing * l,\n              f = x ? 0 : _.maxWidth * l,\n              y = _.lineHeight * l,\n              m = n.textFont.map(e => M.getGlyphItems(e));\n\n        if (t = new h(m, f, y, g, s, o, r).getShaping(d, n.rtl, e), t && t.length > 0) {\n          let e = 1e30,\n              n = -1e30;\n\n          for (const i of t) e = Math.min(e, i.x), n = Math.max(n, i.x);\n\n          c = (n - e + 2 * l) * I * a;\n        }\n      }\n\n      for (let i of n.geometry) {\n        const l = [];\n\n        if (1 === s) {\n          if (t && t.length > 0 && _ && _.size) {\n            const e = _.size * a * (2 + Math.min(2, 4 * Math.abs(_.offset[1])));\n            i = m._smoothVertices(i, e);\n          }\n\n          m._pushAnchors(l, i, g, c);\n        } else 2 === s ? m._pushCenterAnchor(l, i) : 3 === n.feature.type ? m._pushCentroid(l, i) : l.push(new o(i[0].x, i[0].y));\n\n        for (const s of l) {\n          if (s.x < 0 || s.x > r || s.y < 0 || s.y > r) continue;\n          if (x && c > 0 && 0 === _.rotationAlignment && !m._honorsTextMaxAngle(i, s, c, A, V)) continue;\n          const a = {\n            shaping: t,\n            line: i,\n            iconMosaicItem: e,\n            anchor: s,\n            symbolFeature: n,\n            textColliders: [],\n            iconColliders: [],\n            textVertexRanges: [],\n            iconVertexRanges: []\n          };\n          P.push(a), this._processFeature(a, p, _);\n        }\n      }\n    }\n\n    P.sort(y), this._addPlacedGlyphs(), this._symbolInstances = P;\n  }\n\n  serialize() {\n    let e = 11;\n    e += this.layerUIDs.length, e += 3 * this.markerPageMap.size, e += 3 * this.glyphsPageMap.size, e += m.symbolsSerializationLength(this._symbolInstances), e += this._iconVertexBuffer.array.length, e += this._iconIndexBuffer.array.length, e += this._textVertexBuffer.array.length, e += this._textIndexBuffer.array.length;\n    const t = new Uint32Array(e),\n          n = new Int32Array(t.buffer),\n          i = new Float32Array(t.buffer);\n    let s = 0;\n    t[s++] = this.type, t[s++] = this.layerUIDs.length;\n\n    for (let a = 0; a < this.layerUIDs.length; a++) t[s++] = this.layerUIDs[a];\n\n    t[s++] = this._isIconSDF ? 1 : 0, t[s++] = this.markerPageMap.size;\n\n    for (const [a, [o, r]] of this.markerPageMap) t[s++] = a, t[s++] = o, t[s++] = r;\n\n    t[s++] = this.glyphsPageMap.size;\n\n    for (const [a, [o, r]] of this.glyphsPageMap) t[s++] = a, t[s++] = o, t[s++] = r;\n\n    t[s++] = this._iconVertexBuffer.index / 4, t[s++] = this._textVertexBuffer.index / 4, s = m.serializeSymbols(t, n, i, s, this._symbolInstances), t[s++] = this._iconVertexBuffer.array.length;\n\n    for (let a = 0; a < this._iconVertexBuffer.array.length; a++) n[s++] = this._iconVertexBuffer.array[a];\n\n    t[s++] = this._iconIndexBuffer.array.length;\n\n    for (let a = 0; a < this._iconIndexBuffer.array.length; a++) t[s++] = this._iconIndexBuffer.array[a];\n\n    t[s++] = this._textVertexBuffer.array.length;\n\n    for (let a = 0; a < this._textVertexBuffer.array.length; a++) n[s++] = this._textVertexBuffer.array[a];\n\n    t[s++] = this._textIndexBuffer.array.length;\n\n    for (let a = 0; a < this._textIndexBuffer.array.length; a++) t[s++] = this._textIndexBuffer.array[a];\n\n    return t.buffer;\n  }\n\n  static symbolsSerializationLength(e) {\n    let t = 0;\n    t += 1;\n\n    for (const n of e || []) {\n      t += 4, t += 1;\n\n      for (const e of n.textColliders) t += f;\n\n      for (const e of n.iconColliders) t += f;\n\n      t += 1, t += 2 * n.textVertexRanges.length, t += 1, t += 2 * n.iconVertexRanges.length;\n    }\n\n    return t;\n  }\n\n  static serializeSymbols(e, t, n, i, s) {\n    s = s || [], t[i++] = s.length;\n\n    for (const a of s) {\n      t[i++] = a.anchor.x, t[i++] = a.anchor.y, t[i++] = a.symbolFeature.hash, t[i++] = a.symbolFeature.priority, t[i++] = a.textColliders.length + a.iconColliders.length;\n\n      for (const e of a.textColliders) t[i++] = e.xTile, t[i++] = e.yTile, t[i++] = e.dxPixels, t[i++] = e.dyPixels, t[i++] = e.hard ? 1 : 0, t[i++] = e.partIndex, n[i++] = e.minLod, n[i++] = e.maxLod, t[i++] = e.width, t[i++] = e.height;\n\n      for (const e of a.iconColliders) t[i++] = e.xTile, t[i++] = e.yTile, t[i++] = e.dxPixels, t[i++] = e.dyPixels, t[i++] = e.hard ? 1 : 0, t[i++] = e.partIndex, n[i++] = e.minLod, n[i++] = e.maxLod, t[i++] = e.width, t[i++] = e.height;\n\n      t[i++] = a.textVertexRanges.length;\n\n      for (const [e, n] of a.textVertexRanges) t[i++] = e, t[i++] = n;\n\n      t[i++] = a.iconVertexRanges.length;\n\n      for (const [e, n] of a.iconVertexRanges) t[i++] = e, t[i++] = n;\n    }\n\n    return i;\n  }\n\n  _replaceKeys(e, t) {\n    return e.replace(/{([^{}]+)}/g, function (e, n) {\n      return n in t ? t[n] : \"\";\n    });\n  }\n\n  _processFeature(e, t, n) {\n    const {\n      line: s,\n      iconMosaicItem: a,\n      shaping: o,\n      anchor: r\n    } = e,\n          l = this.zoom,\n          h = this.layer,\n          x = !!a;\n    let c = !0;\n    x && (c = t.optional || !a);\n    const d = o && o.length > 0;\n    let g,\n        f,\n        y = !0;\n\n    if (d && (y = n.optional), x && (g = this._placementEngine.getIconPlacement(r, a, t)), (g || c) && (d && (f = this._placementEngine.getTextPlacement(r, o, s, n)), f || y)) {\n      if (g && f || (y || c ? y || f ? c || g || (f = null) : g = null : (g = null, f = null)), f) {\n        const t = h.hasDataDrivenText ? h.textMaterial.encodeAttributes(e.symbolFeature.feature, l, h) : null;\n\n        if (this._storePlacedGlyphs(e, f.shapes, l, n.rotationAlignment, t), f.textColliders) {\n          e.textColliders = f.textColliders;\n\n          for (const e of f.textColliders) {\n            e.minLod = Math.max(l + i(e.minLod), 0), e.maxLod = Math.min(l + i(e.maxLod), 25);\n            const t = e.angle;\n\n            if (t) {\n              const n = Math.cos(t),\n                    i = Math.sin(t),\n                    s = e.dxPixels * n - e.dyPixels * i,\n                    a = e.dxPixels * i + e.dyPixels * n,\n                    o = (e.dxPixels + e.width) * n - e.dyPixels * i,\n                    r = (e.dxPixels + e.width) * i + e.dyPixels * n,\n                    l = e.dxPixels * n - (e.dyPixels + e.height) * i,\n                    h = e.dxPixels * i + (e.dyPixels + e.height) * n,\n                    x = (e.dxPixels + e.width) * n - (e.dyPixels + e.height) * i,\n                    c = (e.dxPixels + e.width) * i + (e.dyPixels + e.height) * n,\n                    d = Math.min(s, o, l, x),\n                    g = Math.max(s, o, l, x),\n                    f = Math.min(a, r, h, c),\n                    y = Math.max(a, r, h, c);\n              e.dxPixels = d, e.dyPixels = f, e.width = g - d, e.height = y - f;\n            }\n          }\n        }\n      }\n\n      if (g) {\n        const n = h.hasDataDrivenIcon ? h.iconMaterial.encodeAttributes(e.symbolFeature.feature, l, h) : null;\n\n        if (this._addPlacedIcons(e, g.shapes, l, a.page, 1 === t.rotationAlignment, n), g.iconColliders) {\n          e.iconColliders = g.iconColliders;\n\n          for (const e of g.iconColliders) {\n            e.minLod = Math.max(l + i(e.minLod), 0), e.maxLod = Math.min(l + i(e.maxLod), 25);\n            const t = e.angle;\n\n            if (t) {\n              const n = Math.cos(t),\n                    i = Math.sin(t),\n                    s = e.dxPixels * n - e.dyPixels * i,\n                    a = e.dxPixels * i + e.dyPixels * n,\n                    o = (e.dxPixels + e.width) * n - e.dyPixels * i,\n                    r = (e.dxPixels + e.width) * i + e.dyPixels * n,\n                    l = e.dxPixels * n - (e.dyPixels + e.height) * i,\n                    h = e.dxPixels * i + (e.dyPixels + e.height) * n,\n                    x = (e.dxPixels + e.width) * n - (e.dyPixels + e.height) * i,\n                    c = (e.dxPixels + e.width) * i + (e.dyPixels + e.height) * n,\n                    d = Math.min(s, o, l, x),\n                    g = Math.max(s, o, l, x),\n                    f = Math.min(a, r, h, c),\n                    y = Math.max(a, r, h, c);\n              e.dxPixels = d, e.dyPixels = f, e.width = g - d, e.height = y - f;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  _addPlacedIcons(e, t, n, s, a, o) {\n    const r = Math.max(n - 1, 0),\n          l = this._iconVertexBuffer,\n          h = this._iconIndexBuffer,\n          x = this._markerMap;\n\n    for (const c of t) {\n      const t = a ? 0 : Math.max(n + i(c.minzoom), r),\n            d = a ? 25 : Math.min(n + i(c.maxzoom), 25);\n      if (d <= t) continue;\n      const g = c.tl,\n            f = c.tr,\n            y = c.bl,\n            m = c.br,\n            u = c.mosaicRect,\n            p = c.labelAngle,\n            _ = c.minAngle,\n            M = c.maxAngle,\n            b = c.anchor,\n            P = l.index,\n            I = u.x,\n            A = u.y,\n            V = I + u.width,\n            w = A + u.height,\n            L = l.index;\n      l.add(b.x, b.y, g.x, g.y, I, A, p, _, M, t, d, o), l.add(b.x, b.y, f.x, f.y, V, A, p, _, M, t, d, o), l.add(b.x, b.y, y.x, y.y, I, w, p, _, M, t, d, o), l.add(b.x, b.y, m.x, m.y, V, w, p, _, M, t, d, o), e.iconVertexRanges.length > 0 && e.iconVertexRanges[0][0] + e.iconVertexRanges[0][1] === L ? e.iconVertexRanges[0][1] += 4 : e.iconVertexRanges.push([L, 4]), h.add(P + 0, P + 1, P + 2), h.add(P + 1, P + 2, P + 3), x.has(s) ? x.get(s)[1] += 6 : x.set(s, [this._iconIndexStart + this._iconIndexCount, 6]), this._iconIndexCount += 6;\n    }\n  }\n\n  _addPlacedGlyphs() {\n    const e = this._textVertexBuffer,\n          t = this._textIndexBuffer,\n          n = this._glyphMap;\n\n    for (const [i, s] of this._glyphBufferDataStorage) for (const a of s) {\n      const s = e.index,\n            o = a.symbolInstance,\n            r = a.ddAttributes,\n            l = e.index;\n      e.add(a.glyphAnchor[0], a.glyphAnchor[1], a.tl[0], a.tl[1], a.xmin, a.ymin, a.labelAngle, a.minAngle, a.maxAngle, a.minLod, a.maxLod, r), e.add(a.glyphAnchor[0], a.glyphAnchor[1], a.tr[0], a.tr[1], a.xmax, a.ymin, a.labelAngle, a.minAngle, a.maxAngle, a.minLod, a.maxLod, r), e.add(a.glyphAnchor[0], a.glyphAnchor[1], a.bl[0], a.bl[1], a.xmin, a.ymax, a.labelAngle, a.minAngle, a.maxAngle, a.minLod, a.maxLod, r), e.add(a.glyphAnchor[0], a.glyphAnchor[1], a.br[0], a.br[1], a.xmax, a.ymax, a.labelAngle, a.minAngle, a.maxAngle, a.minLod, a.maxLod, r), o.textVertexRanges.length > 0 && o.textVertexRanges[0][0] + o.textVertexRanges[0][1] === l ? o.textVertexRanges[0][1] += 4 : o.textVertexRanges.push([l, 4]), t.add(s + 0, s + 1, s + 2), t.add(s + 1, s + 2, s + 3), n.has(i) ? n.get(i)[1] += 6 : n.set(i, [this._textIndexStart + this._textIndexCount, 6]), this._textIndexCount += 6;\n    }\n\n    this._glyphBufferDataStorage.clear();\n  }\n\n  _storePlacedGlyphs(e, t, n, s, a) {\n    const o = Math.max(n - 1, 0),\n          r = 1 === s;\n    let l, h, x, c, d, g, f, y, m, u, p;\n\n    for (const _ of t) {\n      if (l = r ? 0 : Math.max(n + i(_.minzoom), o), h = r ? 25 : Math.min(n + i(_.maxzoom), 25), h <= l) continue;\n      x = _.tl, c = _.tr, d = _.bl, g = _.br, f = _.labelAngle, y = _.minAngle, m = _.maxAngle, u = _.anchor, p = _.mosaicRect, this._glyphBufferDataStorage.has(_.page) || this._glyphBufferDataStorage.set(_.page, []);\n\n      this._glyphBufferDataStorage.get(_.page).push({\n        glyphAnchor: [u.x, u.y],\n        tl: [x.x, x.y],\n        tr: [c.x, c.y],\n        bl: [d.x, d.y],\n        br: [g.x, g.y],\n        xmin: p.x,\n        ymin: p.y,\n        xmax: p.x + p.width,\n        ymax: p.y + p.height,\n        labelAngle: f,\n        minAngle: y,\n        maxAngle: m,\n        minLod: l,\n        maxLod: h,\n        placementLod: o,\n        symbolInstance: e,\n        ddAttributes: a\n      });\n    }\n  }\n\n  static _pushAnchors(e, t, n, i) {\n    n += i;\n    let a = 0;\n    const r = t.length - 1;\n\n    for (let s = 0; s < r; s++) a += g.distance(t[s], t[s + 1]);\n\n    let l = i || n;\n    if (l *= .5, a <= l) return;\n    const h = l / a;\n    let x = 0,\n        c = -(n = a / Math.max(Math.round(a / n), 1)) / 2;\n    const d = t.length - 1;\n\n    for (let g = 0; g < d; g++) {\n      const i = t[g],\n            a = t[g + 1],\n            r = a.x - i.x,\n            l = a.y - i.y,\n            d = Math.sqrt(r * r + l * l);\n      let f;\n\n      for (; c + n < x + d;) {\n        c += n;\n        const t = (c - x) / d,\n              y = s(i.x, a.x, t),\n              m = s(i.y, a.y, t);\n        void 0 === f && (f = Math.atan2(l, r)), e.push(new o(y, m, f, g, h));\n      }\n\n      x += d;\n    }\n  }\n\n  static _pushCenterAnchor(e, t) {\n    let n = 0;\n    const i = t.length - 1;\n\n    for (let s = 0; s < i; s++) n += g.distance(t[s], t[s + 1]);\n\n    const a = n / 2;\n    let r = 0;\n    const l = t.length - 1;\n\n    for (let h = 0; h < l; h++) {\n      const n = t[h],\n            i = t[h + 1],\n            l = i.x - n.x,\n            x = i.y - n.y,\n            c = Math.sqrt(l * l + x * x);\n\n      if (a < r + c) {\n        const t = (a - r) / c,\n              d = s(n.x, i.x, t),\n              g = s(n.y, i.y, t),\n              f = Math.atan2(x, l);\n        return void e.push(new o(d, g, f, h, 0));\n      }\n\n      r += c;\n    }\n  }\n\n  static _deviation(e, t, n) {\n    const i = (t.x - e.x) * (n.x - t.x) + (t.y - e.y) * (n.y - t.y),\n          s = (t.x - e.x) * (n.y - t.y) - (t.y - e.y) * (n.x - t.x);\n    return Math.atan2(s, i);\n  }\n\n  static _honorsTextMaxAngle(e, t, n, i, s) {\n    let a = 0;\n    const o = n / 2;\n    let r = new g(t.x, t.y),\n        l = t.segment + 1;\n\n    for (; a > -o;) {\n      if (--l, l < 0) return !1;\n      a -= g.distance(e[l], r), r = e[l];\n    }\n\n    a += g.distance(e[l], e[l + 1]);\n    const h = [];\n    let x = 0;\n    const c = e.length;\n\n    for (; a < o;) {\n      const t = e[l];\n      let n,\n          o = l;\n\n      do {\n        if (++o, o === c) return !1;\n        n = e[o];\n      } while (n.isEqual(t));\n\n      let r,\n          d = o;\n\n      do {\n        if (++d, d === c) return !1;\n        r = e[d];\n      } while (r.isEqual(n));\n\n      const f = this._deviation(t, n, r);\n\n      for (h.push({\n        deviation: f,\n        distToAnchor: a\n      }), x += f; a - h[0].distToAnchor > s;) x -= h.shift().deviation;\n\n      if (Math.abs(x) > i) return !1;\n      a += g.distance(n, r), l = o;\n    }\n\n    return !0;\n  }\n\n  static _smoothVertices(e, t) {\n    if (t <= 0) return e;\n    let n = e.length;\n    if (n < 3) return e;\n    const i = [];\n    let s = 0,\n        a = 0;\n    i.push(0);\n\n    for (let y = 1; y < n; y++) {\n      const t = g.distance(e[y], e[y - 1]);\n      t > 0 && (s += t, i.push(s), a++, a !== y && (e[a] = e[y]));\n    }\n\n    if (n = a + 1, n < 3) return e;\n    t = Math.min(t, .2 * s);\n    const o = e[0].x,\n          r = e[0].y,\n          l = e[n - 1].x,\n          h = e[n - 1].y,\n          x = g.sub(e[0], e[1]);\n    x.normalize(), e[0].x += t * x.x, e[0].y += t * x.y, x.assignSub(e[n - 1], e[n - 2]), x.normalize(), e[n - 1].x += t * x.x, e[n - 1].y += t * x.y, i[0] -= t, i[n - 1] += t;\n    const c = [];\n    c.push(new g(o, r));\n    const d = 1e-6,\n          f = .5 * t;\n\n    for (let y = 1; y < n - 1; y++) {\n      let s = 0,\n          a = 0,\n          o = 0;\n\n      for (let n = y - 1; n >= 0; n--) {\n        const r = f + i[n + 1] - i[y];\n        if (r < 0) break;\n        const l = i[n + 1] - i[n],\n              h = i[y] - i[n] < f ? 1 : r / l;\n        if (h < d) break;\n        const x = h * h,\n              c = h * r - .5 * x * l,\n              g = h * l / t,\n              m = e[n + 1],\n              u = e[n].x - m.x,\n              p = e[n].y - m.y;\n        s += g / c * (m.x * h * r + .5 * x * (r * u - l * m.x) - x * h * l * u / 3), a += g / c * (m.y * h * r + .5 * x * (r * p - l * m.y) - x * h * l * p / 3), o += g;\n      }\n\n      for (let r = y + 1; r < n; r++) {\n        const n = f - i[r - 1] + i[y];\n        if (n < 0) break;\n        const l = i[r] - i[r - 1],\n              h = i[r] - i[y] < f ? 1 : n / l;\n        if (h < d) break;\n        const x = h * h,\n              c = h * n - .5 * x * l,\n              g = h * l / t,\n              m = e[r - 1],\n              u = e[r].x - m.x,\n              p = e[r].y - m.y;\n        s += g / c * (m.x * h * n + .5 * x * (n * u - l * m.x) - x * h * l * u / 3), a += g / c * (m.y * h * n + .5 * x * (n * p - l * m.y) - x * h * l * p / 3), o += g;\n      }\n\n      c.push(new g(s / o, a / o));\n    }\n\n    return c.push(new g(l, h)), e[0].x = o, e[0].y = r, e[n - 1].x = l, e[n - 1].y = h, c;\n  }\n\n  static _pushCentroid(e, t) {\n    const n = 0,\n          i = 0,\n          s = 4096,\n          a = 4096,\n          r = t.length - 1;\n    let l = 0,\n        h = 0,\n        x = 0,\n        c = t[0].x,\n        d = t[0].y;\n    c > s && (c = s), c < n && (c = n), d > a && (d = a), d < i && (d = i);\n\n    for (let o = 1; o < r; o++) {\n      let e = t[o].x,\n          r = t[o].y,\n          g = t[o + 1].x,\n          f = t[o + 1].y;\n      e > s && (e = s), e < n && (e = n), r > a && (r = a), r < i && (r = i), g > s && (g = s), g < n && (g = n), f > a && (f = a), f < i && (f = i);\n      const y = (e - c) * (f - d) - (g - c) * (r - d);\n      l += y * (c + e + g), h += y * (d + r + f), x += y;\n    }\n\n    l /= 3 * x, h /= 3 * x, isNaN(l) || isNaN(h) || e.push(new o(l, h));\n  }\n\n}\n\nm._bidiEngine = new e();\nexport default m;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/2d/engine/vectorTiles/buckets/SymbolBucket.js"],"names":["e","numericHash","t","C_DEG_TO_RAD","n","log2","i","interpolate","s","TILE_PIXEL_RATIO","a","Anchor","o","TILE_COORD_SIZE","r","SDF_GLYPH_SIZE","l","TextShaping","h","x","IconLayout","c","TextLayout","d","Point","g","f","y","iconMosaicItem","page","m","constructor","getSpriteItems","type","_markerMap","Map","_glyphMap","_glyphBufferDataStorage","_isIconSDF","_iconVertexBuffer","_iconIndexBuffer","_textVertexBuffer","_textIndexBuffer","_placementEngine","_workerTileHandler","markerPageMap","glyphsPageMap","symbolInstances","_symbolInstances","getResources","layer","zoom","setExtent","layerExtent","getLayoutProperty","isDataDriven","getValue","getLayoutValue","_features","u","getGeometry","length","p","_","_replaceKeys","values","add","name","M","replace","toLowerCase","toUpperCase","_bidiEngine","hasBidiChar","checkContextual","bidiTransform","Set","charCodeAt","b","P","feature","sprite","label","rtl","geometry","hash","priority","textFont","push","_symbolFeatures","processFeatures","_iconIndexStart","index","_textIndexStart","_iconIndexCount","_textIndexCount","clear","I","size","A","maxAngle","V","sdf","update","keepUpright","writingMode","indexOf","anchor","justify","letterSpacing","maxWidth","lineHeight","map","getGlyphItems","getShaping","Math","min","max","abs","offset","_smoothVertices","_pushAnchors","_pushCenterAnchor","_pushCentroid","rotationAlignment","_honorsTextMaxAngle","shaping","line","symbolFeature","textColliders","iconColliders","textVertexRanges","iconVertexRanges","_processFeature","sort","_addPlacedGlyphs","serialize","layerUIDs","symbolsSerializationLength","array","Uint32Array","Int32Array","buffer","Float32Array","serializeSymbols","xTile","yTile","dxPixels","dyPixels","hard","partIndex","minLod","maxLod","width","height","optional","getIconPlacement","getTextPlacement","hasDataDrivenText","textMaterial","encodeAttributes","_storePlacedGlyphs","shapes","angle","cos","sin","hasDataDrivenIcon","iconMaterial","_addPlacedIcons","minzoom","maxzoom","tl","tr","bl","br","mosaicRect","labelAngle","minAngle","w","L","has","get","set","symbolInstance","ddAttributes","glyphAnchor","xmin","ymin","xmax","ymax","placementLod","distance","round","sqrt","atan2","_deviation","segment","isEqual","deviation","distToAnchor","shift","sub","normalize","assignSub","isNaN"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../core/BidiEngine.js\";import{numericHash as t}from\"../../../../../core/string.js\";import{C_DEG_TO_RAD as n,log2 as i,interpolate as s}from\"../GeometryUtils.js\";import{TILE_PIXEL_RATIO as a,Anchor as o,TILE_COORD_SIZE as r}from\"../Placement.js\";import{SDF_GLYPH_SIZE as l,TextShaping as h}from\"../TextShaping.js\";import x from\"./BaseBucket.js\";import{IconLayout as c,TextLayout as d}from\"../style/StyleLayer.js\";import{Point as g}from\"../../webgl/Geometry.js\";const f=10;function y(e,t){return e.iconMosaicItem&&t.iconMosaicItem?e.iconMosaicItem.page===t.iconMosaicItem.page?0:e.iconMosaicItem.page-t.iconMosaicItem.page:e.iconMosaicItem&&!t.iconMosaicItem?1:!e.iconMosaicItem&&t.iconMosaicItem?-1:0}class m extends x{constructor(e,t,n,i,s,a,o,r){super(e,t,r.getSpriteItems()),this.type=3,this._markerMap=new Map,this._glyphMap=new Map,this._glyphBufferDataStorage=new Map,this._isIconSDF=!1,this._iconVertexBuffer=n,this._iconIndexBuffer=i,this._textVertexBuffer=s,this._textIndexBuffer=a,this._placementEngine=o,this._workerTileHandler=r}get markerPageMap(){return this._markerMap}get glyphsPageMap(){return this._glyphMap}get symbolInstances(){return this._symbolInstances}getResources(e,n,i){const s=this.layer,a=this.zoom;e&&e.setExtent(this.layerExtent);const o=s.getLayoutProperty(\"icon-image\"),r=s.getLayoutProperty(\"text-field\");let l=s.getLayoutProperty(\"text-transform\"),h=s.getLayoutProperty(\"text-font\");const x=[];let c,d,g,f;o&&!o.isDataDriven&&(c=o.getValue(a)),r&&!r.isDataDriven&&(d=r.getValue(a)),l&&l.isDataDriven||(g=s.getLayoutValue(\"text-transform\",a),l=null),h&&h.isDataDriven||(f=s.getLayoutValue(\"text-font\",a),h=null);for(const y of this._features){const u=y.getGeometry(e);if(!u||0===u.length)continue;let p,_;o&&(p=o.isDataDriven?o.getValue(a,y):this._replaceKeys(c,y.values),p&&n.add({name:p}));let M=!1;if(r&&(_=r.isDataDriven?r.getValue(a,y):this._replaceKeys(d,y.values),_)){switch(_=_.replace(/\\\\n/g,\"\\n\"),l&&(g=l.getValue(a,y)),g){case 2:_=_.toLowerCase();break;case 1:_=_.toUpperCase()}if(m._bidiEngine.hasBidiChar(_)){let e;e=\"rtl\"===m._bidiEngine.checkContextual(_)?\"IDNNN\":\"ICNNN\",_=m._bidiEngine.bidiTransform(_,e,\"VLYSN\"),M=!0}const e=_.length;if(e>0){h&&(f=h.getValue(a,y));for(const t of f){let n=i[t];n||(n=i[t]=new Set);for(let t=0;t<e;t++){const e=_.charCodeAt(t);n.add(e)}}}}if(!p&&!_)continue;const b=s.getLayoutValue(\"symbol-sort-key\",a,y),P={feature:y,sprite:p,label:_,rtl:M,geometry:u,hash:(_?t(_):0)^(p?t(p):0),priority:b,textFont:f};x.push(P)}this._symbolFeatures=x}processFeatures(e){e&&e.setExtent(this.layerExtent);const t=this.layer,i=this.zoom,s=t.getLayoutValue(\"symbol-placement\",i),x=0!==s,g=t.getLayoutValue(\"symbol-spacing\",i)*a,f=t.getLayoutProperty(\"icon-image\"),u=t.getLayoutProperty(\"text-field\"),p=f?new c(t,i,x):null,_=u?new d(t,i,x):null,M=this._workerTileHandler;let b;f&&(b=M.getSpriteItems()),this._iconIndexStart=3*this._iconIndexBuffer.index,this._textIndexStart=3*this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();const P=[];let I=1;_&&_.size&&(I=_.size/l);const A=_?_.maxAngle*n:0,V=_?_.size*a:0;for(const n of this._symbolFeatures){let e;p&&b&&n.sprite&&(e=b[n.sprite],e&&e.sdf&&(this._isIconSDF=!0));let t;!!e&&p.update(i,n.feature);let c=0;const d=n.label;if(d){_.update(i,n.feature);const e=x?_.keepUpright:_.writingMode&&_.writingMode.indexOf(1)>=0;let s=.5;switch(_.anchor){case 5:case 1:case 7:s=0;break;case 6:case 2:case 8:s=1}let o=.5;switch(_.anchor){case 5:case 3:case 6:o=0;break;case 7:case 4:case 8:o=1}let r=.5;switch(_.justify){case 0:r=s;break;case 1:r=0;break;case 3:r=1}const g=_.letterSpacing*l,f=x?0:_.maxWidth*l,y=_.lineHeight*l,m=n.textFont.map((e=>M.getGlyphItems(e)));if(t=new h(m,f,y,g,s,o,r).getShaping(d,n.rtl,e),t&&t.length>0){let e=1e30,n=-1e30;for(const i of t)e=Math.min(e,i.x),n=Math.max(n,i.x);c=(n-e+2*l)*I*a}}for(let i of n.geometry){const l=[];if(1===s){if(t&&t.length>0&&_&&_.size){const e=_.size*a*(2+Math.min(2,4*Math.abs(_.offset[1])));i=m._smoothVertices(i,e)}m._pushAnchors(l,i,g,c)}else 2===s?m._pushCenterAnchor(l,i):3===n.feature.type?m._pushCentroid(l,i):l.push(new o(i[0].x,i[0].y));for(const s of l){if(s.x<0||s.x>r||s.y<0||s.y>r)continue;if(x&&c>0&&0===_.rotationAlignment&&!m._honorsTextMaxAngle(i,s,c,A,V))continue;const a={shaping:t,line:i,iconMosaicItem:e,anchor:s,symbolFeature:n,textColliders:[],iconColliders:[],textVertexRanges:[],iconVertexRanges:[]};P.push(a),this._processFeature(a,p,_)}}}P.sort(y),this._addPlacedGlyphs(),this._symbolInstances=P}serialize(){let e=11;e+=this.layerUIDs.length,e+=3*this.markerPageMap.size,e+=3*this.glyphsPageMap.size,e+=m.symbolsSerializationLength(this._symbolInstances),e+=this._iconVertexBuffer.array.length,e+=this._iconIndexBuffer.array.length,e+=this._textVertexBuffer.array.length,e+=this._textIndexBuffer.array.length;const t=new Uint32Array(e),n=new Int32Array(t.buffer),i=new Float32Array(t.buffer);let s=0;t[s++]=this.type,t[s++]=this.layerUIDs.length;for(let a=0;a<this.layerUIDs.length;a++)t[s++]=this.layerUIDs[a];t[s++]=this._isIconSDF?1:0,t[s++]=this.markerPageMap.size;for(const[a,[o,r]]of this.markerPageMap)t[s++]=a,t[s++]=o,t[s++]=r;t[s++]=this.glyphsPageMap.size;for(const[a,[o,r]]of this.glyphsPageMap)t[s++]=a,t[s++]=o,t[s++]=r;t[s++]=this._iconVertexBuffer.index/4,t[s++]=this._textVertexBuffer.index/4,s=m.serializeSymbols(t,n,i,s,this._symbolInstances),t[s++]=this._iconVertexBuffer.array.length;for(let a=0;a<this._iconVertexBuffer.array.length;a++)n[s++]=this._iconVertexBuffer.array[a];t[s++]=this._iconIndexBuffer.array.length;for(let a=0;a<this._iconIndexBuffer.array.length;a++)t[s++]=this._iconIndexBuffer.array[a];t[s++]=this._textVertexBuffer.array.length;for(let a=0;a<this._textVertexBuffer.array.length;a++)n[s++]=this._textVertexBuffer.array[a];t[s++]=this._textIndexBuffer.array.length;for(let a=0;a<this._textIndexBuffer.array.length;a++)t[s++]=this._textIndexBuffer.array[a];return t.buffer}static symbolsSerializationLength(e){let t=0;t+=1;for(const n of e||[]){t+=4,t+=1;for(const e of n.textColliders)t+=f;for(const e of n.iconColliders)t+=f;t+=1,t+=2*n.textVertexRanges.length,t+=1,t+=2*n.iconVertexRanges.length}return t}static serializeSymbols(e,t,n,i,s){s=s||[],t[i++]=s.length;for(const a of s){t[i++]=a.anchor.x,t[i++]=a.anchor.y,t[i++]=a.symbolFeature.hash,t[i++]=a.symbolFeature.priority,t[i++]=a.textColliders.length+a.iconColliders.length;for(const e of a.textColliders)t[i++]=e.xTile,t[i++]=e.yTile,t[i++]=e.dxPixels,t[i++]=e.dyPixels,t[i++]=e.hard?1:0,t[i++]=e.partIndex,n[i++]=e.minLod,n[i++]=e.maxLod,t[i++]=e.width,t[i++]=e.height;for(const e of a.iconColliders)t[i++]=e.xTile,t[i++]=e.yTile,t[i++]=e.dxPixels,t[i++]=e.dyPixels,t[i++]=e.hard?1:0,t[i++]=e.partIndex,n[i++]=e.minLod,n[i++]=e.maxLod,t[i++]=e.width,t[i++]=e.height;t[i++]=a.textVertexRanges.length;for(const[e,n]of a.textVertexRanges)t[i++]=e,t[i++]=n;t[i++]=a.iconVertexRanges.length;for(const[e,n]of a.iconVertexRanges)t[i++]=e,t[i++]=n}return i}_replaceKeys(e,t){return e.replace(/{([^{}]+)}/g,(function(e,n){return n in t?t[n]:\"\"}))}_processFeature(e,t,n){const{line:s,iconMosaicItem:a,shaping:o,anchor:r}=e,l=this.zoom,h=this.layer,x=!!a;let c=!0;x&&(c=t.optional||!a);const d=o&&o.length>0;let g,f,y=!0;if(d&&(y=n.optional),x&&(g=this._placementEngine.getIconPlacement(r,a,t)),(g||c)&&(d&&(f=this._placementEngine.getTextPlacement(r,o,s,n)),f||y)){if(g&&f||(y||c?y||f?c||g||(f=null):g=null:(g=null,f=null)),f){const t=h.hasDataDrivenText?h.textMaterial.encodeAttributes(e.symbolFeature.feature,l,h):null;if(this._storePlacedGlyphs(e,f.shapes,l,n.rotationAlignment,t),f.textColliders){e.textColliders=f.textColliders;for(const e of f.textColliders){e.minLod=Math.max(l+i(e.minLod),0),e.maxLod=Math.min(l+i(e.maxLod),25);const t=e.angle;if(t){const n=Math.cos(t),i=Math.sin(t),s=e.dxPixels*n-e.dyPixels*i,a=e.dxPixels*i+e.dyPixels*n,o=(e.dxPixels+e.width)*n-e.dyPixels*i,r=(e.dxPixels+e.width)*i+e.dyPixels*n,l=e.dxPixels*n-(e.dyPixels+e.height)*i,h=e.dxPixels*i+(e.dyPixels+e.height)*n,x=(e.dxPixels+e.width)*n-(e.dyPixels+e.height)*i,c=(e.dxPixels+e.width)*i+(e.dyPixels+e.height)*n,d=Math.min(s,o,l,x),g=Math.max(s,o,l,x),f=Math.min(a,r,h,c),y=Math.max(a,r,h,c);e.dxPixels=d,e.dyPixels=f,e.width=g-d,e.height=y-f}}}}if(g){const n=h.hasDataDrivenIcon?h.iconMaterial.encodeAttributes(e.symbolFeature.feature,l,h):null;if(this._addPlacedIcons(e,g.shapes,l,a.page,1===t.rotationAlignment,n),g.iconColliders){e.iconColliders=g.iconColliders;for(const e of g.iconColliders){e.minLod=Math.max(l+i(e.minLod),0),e.maxLod=Math.min(l+i(e.maxLod),25);const t=e.angle;if(t){const n=Math.cos(t),i=Math.sin(t),s=e.dxPixels*n-e.dyPixels*i,a=e.dxPixels*i+e.dyPixels*n,o=(e.dxPixels+e.width)*n-e.dyPixels*i,r=(e.dxPixels+e.width)*i+e.dyPixels*n,l=e.dxPixels*n-(e.dyPixels+e.height)*i,h=e.dxPixels*i+(e.dyPixels+e.height)*n,x=(e.dxPixels+e.width)*n-(e.dyPixels+e.height)*i,c=(e.dxPixels+e.width)*i+(e.dyPixels+e.height)*n,d=Math.min(s,o,l,x),g=Math.max(s,o,l,x),f=Math.min(a,r,h,c),y=Math.max(a,r,h,c);e.dxPixels=d,e.dyPixels=f,e.width=g-d,e.height=y-f}}}}}}_addPlacedIcons(e,t,n,s,a,o){const r=Math.max(n-1,0),l=this._iconVertexBuffer,h=this._iconIndexBuffer,x=this._markerMap;for(const c of t){const t=a?0:Math.max(n+i(c.minzoom),r),d=a?25:Math.min(n+i(c.maxzoom),25);if(d<=t)continue;const g=c.tl,f=c.tr,y=c.bl,m=c.br,u=c.mosaicRect,p=c.labelAngle,_=c.minAngle,M=c.maxAngle,b=c.anchor,P=l.index,I=u.x,A=u.y,V=I+u.width,w=A+u.height,L=l.index;l.add(b.x,b.y,g.x,g.y,I,A,p,_,M,t,d,o),l.add(b.x,b.y,f.x,f.y,V,A,p,_,M,t,d,o),l.add(b.x,b.y,y.x,y.y,I,w,p,_,M,t,d,o),l.add(b.x,b.y,m.x,m.y,V,w,p,_,M,t,d,o),e.iconVertexRanges.length>0&&e.iconVertexRanges[0][0]+e.iconVertexRanges[0][1]===L?e.iconVertexRanges[0][1]+=4:e.iconVertexRanges.push([L,4]),h.add(P+0,P+1,P+2),h.add(P+1,P+2,P+3),x.has(s)?x.get(s)[1]+=6:x.set(s,[this._iconIndexStart+this._iconIndexCount,6]),this._iconIndexCount+=6}}_addPlacedGlyphs(){const e=this._textVertexBuffer,t=this._textIndexBuffer,n=this._glyphMap;for(const[i,s]of this._glyphBufferDataStorage)for(const a of s){const s=e.index,o=a.symbolInstance,r=a.ddAttributes,l=e.index;e.add(a.glyphAnchor[0],a.glyphAnchor[1],a.tl[0],a.tl[1],a.xmin,a.ymin,a.labelAngle,a.minAngle,a.maxAngle,a.minLod,a.maxLod,r),e.add(a.glyphAnchor[0],a.glyphAnchor[1],a.tr[0],a.tr[1],a.xmax,a.ymin,a.labelAngle,a.minAngle,a.maxAngle,a.minLod,a.maxLod,r),e.add(a.glyphAnchor[0],a.glyphAnchor[1],a.bl[0],a.bl[1],a.xmin,a.ymax,a.labelAngle,a.minAngle,a.maxAngle,a.minLod,a.maxLod,r),e.add(a.glyphAnchor[0],a.glyphAnchor[1],a.br[0],a.br[1],a.xmax,a.ymax,a.labelAngle,a.minAngle,a.maxAngle,a.minLod,a.maxLod,r),o.textVertexRanges.length>0&&o.textVertexRanges[0][0]+o.textVertexRanges[0][1]===l?o.textVertexRanges[0][1]+=4:o.textVertexRanges.push([l,4]),t.add(s+0,s+1,s+2),t.add(s+1,s+2,s+3),n.has(i)?n.get(i)[1]+=6:n.set(i,[this._textIndexStart+this._textIndexCount,6]),this._textIndexCount+=6}this._glyphBufferDataStorage.clear()}_storePlacedGlyphs(e,t,n,s,a){const o=Math.max(n-1,0),r=1===s;let l,h,x,c,d,g,f,y,m,u,p;for(const _ of t){if(l=r?0:Math.max(n+i(_.minzoom),o),h=r?25:Math.min(n+i(_.maxzoom),25),h<=l)continue;x=_.tl,c=_.tr,d=_.bl,g=_.br,f=_.labelAngle,y=_.minAngle,m=_.maxAngle,u=_.anchor,p=_.mosaicRect,this._glyphBufferDataStorage.has(_.page)||this._glyphBufferDataStorage.set(_.page,[]);this._glyphBufferDataStorage.get(_.page).push({glyphAnchor:[u.x,u.y],tl:[x.x,x.y],tr:[c.x,c.y],bl:[d.x,d.y],br:[g.x,g.y],xmin:p.x,ymin:p.y,xmax:p.x+p.width,ymax:p.y+p.height,labelAngle:f,minAngle:y,maxAngle:m,minLod:l,maxLod:h,placementLod:o,symbolInstance:e,ddAttributes:a})}}static _pushAnchors(e,t,n,i){n+=i;let a=0;const r=t.length-1;for(let s=0;s<r;s++)a+=g.distance(t[s],t[s+1]);let l=i||n;if(l*=.5,a<=l)return;const h=l/a;let x=0,c=-(n=a/Math.max(Math.round(a/n),1))/2;const d=t.length-1;for(let g=0;g<d;g++){const i=t[g],a=t[g+1],r=a.x-i.x,l=a.y-i.y,d=Math.sqrt(r*r+l*l);let f;for(;c+n<x+d;){c+=n;const t=(c-x)/d,y=s(i.x,a.x,t),m=s(i.y,a.y,t);void 0===f&&(f=Math.atan2(l,r)),e.push(new o(y,m,f,g,h))}x+=d}}static _pushCenterAnchor(e,t){let n=0;const i=t.length-1;for(let s=0;s<i;s++)n+=g.distance(t[s],t[s+1]);const a=n/2;let r=0;const l=t.length-1;for(let h=0;h<l;h++){const n=t[h],i=t[h+1],l=i.x-n.x,x=i.y-n.y,c=Math.sqrt(l*l+x*x);if(a<r+c){const t=(a-r)/c,d=s(n.x,i.x,t),g=s(n.y,i.y,t),f=Math.atan2(x,l);return void e.push(new o(d,g,f,h,0))}r+=c}}static _deviation(e,t,n){const i=(t.x-e.x)*(n.x-t.x)+(t.y-e.y)*(n.y-t.y),s=(t.x-e.x)*(n.y-t.y)-(t.y-e.y)*(n.x-t.x);return Math.atan2(s,i)}static _honorsTextMaxAngle(e,t,n,i,s){let a=0;const o=n/2;let r=new g(t.x,t.y),l=t.segment+1;for(;a>-o;){if(--l,l<0)return!1;a-=g.distance(e[l],r),r=e[l]}a+=g.distance(e[l],e[l+1]);const h=[];let x=0;const c=e.length;for(;a<o;){const t=e[l];let n,o=l;do{if(++o,o===c)return!1;n=e[o]}while(n.isEqual(t));let r,d=o;do{if(++d,d===c)return!1;r=e[d]}while(r.isEqual(n));const f=this._deviation(t,n,r);for(h.push({deviation:f,distToAnchor:a}),x+=f;a-h[0].distToAnchor>s;)x-=h.shift().deviation;if(Math.abs(x)>i)return!1;a+=g.distance(n,r),l=o}return!0}static _smoothVertices(e,t){if(t<=0)return e;let n=e.length;if(n<3)return e;const i=[];let s=0,a=0;i.push(0);for(let y=1;y<n;y++){const t=g.distance(e[y],e[y-1]);t>0&&(s+=t,i.push(s),a++,a!==y&&(e[a]=e[y]))}if(n=a+1,n<3)return e;t=Math.min(t,.2*s);const o=e[0].x,r=e[0].y,l=e[n-1].x,h=e[n-1].y,x=g.sub(e[0],e[1]);x.normalize(),e[0].x+=t*x.x,e[0].y+=t*x.y,x.assignSub(e[n-1],e[n-2]),x.normalize(),e[n-1].x+=t*x.x,e[n-1].y+=t*x.y,i[0]-=t,i[n-1]+=t;const c=[];c.push(new g(o,r));const d=1e-6,f=.5*t;for(let y=1;y<n-1;y++){let s=0,a=0,o=0;for(let n=y-1;n>=0;n--){const r=f+i[n+1]-i[y];if(r<0)break;const l=i[n+1]-i[n],h=i[y]-i[n]<f?1:r/l;if(h<d)break;const x=h*h,c=h*r-.5*x*l,g=h*l/t,m=e[n+1],u=e[n].x-m.x,p=e[n].y-m.y;s+=g/c*(m.x*h*r+.5*x*(r*u-l*m.x)-x*h*l*u/3),a+=g/c*(m.y*h*r+.5*x*(r*p-l*m.y)-x*h*l*p/3),o+=g}for(let r=y+1;r<n;r++){const n=f-i[r-1]+i[y];if(n<0)break;const l=i[r]-i[r-1],h=i[r]-i[y]<f?1:n/l;if(h<d)break;const x=h*h,c=h*n-.5*x*l,g=h*l/t,m=e[r-1],u=e[r].x-m.x,p=e[r].y-m.y;s+=g/c*(m.x*h*n+.5*x*(n*u-l*m.x)-x*h*l*u/3),a+=g/c*(m.y*h*n+.5*x*(n*p-l*m.y)-x*h*l*p/3),o+=g}c.push(new g(s/o,a/o))}return c.push(new g(l,h)),e[0].x=o,e[0].y=r,e[n-1].x=l,e[n-1].y=h,c}static _pushCentroid(e,t){const n=0,i=0,s=4096,a=4096,r=t.length-1;let l=0,h=0,x=0,c=t[0].x,d=t[0].y;c>s&&(c=s),c<n&&(c=n),d>a&&(d=a),d<i&&(d=i);for(let o=1;o<r;o++){let e=t[o].x,r=t[o].y,g=t[o+1].x,f=t[o+1].y;e>s&&(e=s),e<n&&(e=n),r>a&&(r=a),r<i&&(r=i),g>s&&(g=s),g<n&&(g=n),f>a&&(f=a),f<i&&(f=i);const y=(e-c)*(f-d)-(g-c)*(r-d);l+=y*(c+e+g),h+=y*(d+r+f),x+=y}l/=3*x,h/=3*x,isNaN(l)||isNaN(h)||e.push(new o(l,h))}}m._bidiEngine=new e;export default m;\n"]},"metadata":{},"sourceType":"module"}