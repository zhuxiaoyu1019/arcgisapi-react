{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { c as e } from \"../../../../../../chunks/vec3f64.js\";\nimport { DoublePrecision as i } from \"../util/DoublePrecision.glsl.js\";\nimport { glsl as r } from \"../../shaderModules/interfaces.js\";\nimport { encodeDoubleArraySplit as n } from \"../../../lib/doublePrecisionUtils.js\";\n\nfunction o(e, n) {\n  n.instanced && n.instancedDoublePrecision && (e.attributes.add(\"modelOriginHi\", \"vec3\"), e.attributes.add(\"modelOriginLo\", \"vec3\"), e.attributes.add(\"model\", \"mat3\"), e.attributes.add(\"modelNormal\", \"mat3\")), n.instancedDoublePrecision && (e.vertex.include(i, n), e.vertex.uniforms.add(\"viewOriginHi\", \"vec3\"), e.vertex.uniforms.add(\"viewOriginLo\", \"vec3\"));\n  const o = [r`\n    vec3 calculateVPos() {\n      ${n.instancedDoublePrecision ? \"return model * localPosition().xyz;\" : \"return localPosition().xyz;\"}\n    }\n    `, r`\n    vec3 subtractOrigin(vec3 _pos) {\n      ${n.instancedDoublePrecision ? r`\n          vec3 originDelta = dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;` : \"return vpos;\"}\n    }\n    `, r`\n    vec3 dpNormal(vec4 _normal) {\n      ${n.instancedDoublePrecision ? \"return normalize(modelNormal * _normal.xyz);\" : \"return normalize(_normal.xyz);\"}\n    }\n    `, r`\n    vec3 dpNormalView(vec4 _normal) {\n      ${n.instancedDoublePrecision ? \"return normalize((viewNormal * vec4(modelNormal * _normal.xyz, 1.0)).xyz);\" : \"return normalize((viewNormal * _normal).xyz);\"}\n    }\n    `, n.vertexTangents ? r`\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ${n.instancedDoublePrecision ? \"return vec4(modelNormal * _tangent.xyz, _tangent.w);\" : \"return _tangent;\"}\n\n    }\n    ` : r``];\n  e.vertex.code.add(o[0]), e.vertex.code.add(o[1]), e.vertex.code.add(o[2]), 2 === n.output && e.vertex.code.add(o[3]), e.vertex.code.add(o[4]);\n}\n\n!function (e) {\n  class i {}\n\n  function r(e, i) {\n    n(i, t, a, 3), e.setUniform3fv(\"viewOriginHi\", t), e.setUniform3fv(\"viewOriginLo\", a);\n  }\n\n  e.Uniforms = i, e.bindCustomOrigin = r;\n}(o || (o = {}));\nconst t = e(),\n      a = e();\nexport { o as InstancedDoublePrecision };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js"],"names":["c","e","DoublePrecision","i","glsl","r","encodeDoubleArraySplit","n","o","instanced","instancedDoublePrecision","attributes","add","vertex","include","uniforms","vertexTangents","code","output","t","a","setUniform3fv","Uniforms","bindCustomOrigin","InstancedDoublePrecision"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{c as e}from\"../../../../../../chunks/vec3f64.js\";import{DoublePrecision as i}from\"../util/DoublePrecision.glsl.js\";import{glsl as r}from\"../../shaderModules/interfaces.js\";import{encodeDoubleArraySplit as n}from\"../../../lib/doublePrecisionUtils.js\";function o(e,n){n.instanced&&n.instancedDoublePrecision&&(e.attributes.add(\"modelOriginHi\",\"vec3\"),e.attributes.add(\"modelOriginLo\",\"vec3\"),e.attributes.add(\"model\",\"mat3\"),e.attributes.add(\"modelNormal\",\"mat3\")),n.instancedDoublePrecision&&(e.vertex.include(i,n),e.vertex.uniforms.add(\"viewOriginHi\",\"vec3\"),e.vertex.uniforms.add(\"viewOriginLo\",\"vec3\"));const o=[r`\n    vec3 calculateVPos() {\n      ${n.instancedDoublePrecision?\"return model * localPosition().xyz;\":\"return localPosition().xyz;\"}\n    }\n    `,r`\n    vec3 subtractOrigin(vec3 _pos) {\n      ${n.instancedDoublePrecision?r`\n          vec3 originDelta = dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;`:\"return vpos;\"}\n    }\n    `,r`\n    vec3 dpNormal(vec4 _normal) {\n      ${n.instancedDoublePrecision?\"return normalize(modelNormal * _normal.xyz);\":\"return normalize(_normal.xyz);\"}\n    }\n    `,r`\n    vec3 dpNormalView(vec4 _normal) {\n      ${n.instancedDoublePrecision?\"return normalize((viewNormal * vec4(modelNormal * _normal.xyz, 1.0)).xyz);\":\"return normalize((viewNormal * _normal).xyz);\"}\n    }\n    `,n.vertexTangents?r`\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ${n.instancedDoublePrecision?\"return vec4(modelNormal * _tangent.xyz, _tangent.w);\":\"return _tangent;\"}\n\n    }\n    `:r``];e.vertex.code.add(o[0]),e.vertex.code.add(o[1]),e.vertex.code.add(o[2]),2===n.output&&e.vertex.code.add(o[3]),e.vertex.code.add(o[4])}!function(e){class i{}function r(e,i){n(i,t,a,3),e.setUniform3fv(\"viewOriginHi\",t),e.setUniform3fv(\"viewOriginLo\",a)}e.Uniforms=i,e.bindCustomOrigin=r}(o||(o={}));const t=e(),a=e();export{o as InstancedDoublePrecision};\n"]},"metadata":{},"sourceType":"module"}