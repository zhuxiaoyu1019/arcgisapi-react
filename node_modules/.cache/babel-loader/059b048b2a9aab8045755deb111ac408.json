{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { h as t, d as e } from \"../../../chunks/mat3.js\";\nimport { c as a } from \"../../../chunks/mat3f64.js\";\nimport { a as n, c as r } from \"../../../chunks/quat.js\";\nimport { c as s, a as f } from \"../../../chunks/quatf32.js\";\nimport { a as o } from \"../../../chunks/quatf64.js\";\nimport { g as i, f as h, q as c, w as u, s as l, t as m, b as z } from \"../../../chunks/vec3.js\";\nimport { b as S, a as b } from \"../../../chunks/vec3f32.js\";\nimport { b as M, a as p, c as q } from \"../../../chunks/vec3f64.js\";\nimport { t as j } from \"../../../chunks/vec4.js\";\nimport { c as k } from \"../../../chunks/vec4f64.js\";\nimport { create as g } from \"../../../geometry/support/aaBoundingBox.js\";\nimport { signedDistance as v, normal as x } from \"../../../geometry/support/plane.js\";\nimport { computeOBB as y } from \"./dito.js\";\nconst w = o(),\n      d = q(),\n      A = q(),\n      B = k(),\n      I = a();\n\nclass C {\n  constructor(t) {\n    const e = 56,\n          a = 0,\n          n = 24,\n          r = 36,\n          f = t * e;\n    this.buffer = new ArrayBuffer(f), this.obbs = new Array(t);\n\n    for (let o = 0; o < t; o++) this.obbs[o] = {\n      center: M(this.buffer, e * o + a),\n      halfSize: S(this.buffer, e * o + n),\n      quaternion: s(this.buffer, e * o + r)\n    };\n  }\n\n}\n\nfunction D(t = [0, 0, 0], e = [-1, -1, -1], a = [0, 0, 0, 1]) {\n  return {\n    center: p(t),\n    halfSize: b(e),\n    quaternion: f(a)\n  };\n}\n\nfunction E(t) {\n  return D(t.center, t.halfSize, t.quaternion);\n}\n\nfunction F(t, e) {\n  i(e.center, t.center), i(e.halfSize, t.halfSize), n(e.quaternion, t.quaternion);\n}\n\nfunction G(t, e) {\n  return e = e || D(), y(t, e), e;\n}\n\nfunction H(t, e) {\n  const a = v(e, t.center),\n        n = T(t, x(e));\n  return a > n ? 1 : a < -n ? -1 : 0;\n}\n\nfunction J(e, a) {\n  a || (a = g());\n  const n = t(I, e.quaternion),\n        r = e.halfSize[0] * Math.abs(n[0]) + e.halfSize[1] * Math.abs(n[3]) + e.halfSize[2] * Math.abs(n[6]),\n        s = e.halfSize[0] * Math.abs(n[1]) + e.halfSize[1] * Math.abs(n[4]) + e.halfSize[2] * Math.abs(n[7]),\n        f = e.halfSize[0] * Math.abs(n[2]) + e.halfSize[1] * Math.abs(n[5]) + e.halfSize[2] * Math.abs(n[8]);\n  return a[0] = e.center[0] - r, a[1] = e.center[1] - s, a[2] = e.center[2] - f, a[3] = e.center[0] + r, a[4] = e.center[1] + s, a[5] = e.center[2] + f, a;\n}\n\nfunction K(t, e) {\n  return v(e, t.center) - T(t, x(e));\n}\n\nfunction L(t, e) {\n  return v(e, t.center) + T(t, x(e));\n}\n\nfunction N(t, e) {\n  return H(t, e[0]) <= 0 && H(t, e[1]) <= 0 && H(t, e[2]) <= 0 && H(t, e[3]) <= 0 && H(t, e[4]) <= 0 && H(t, e[5]) <= 0;\n}\n\nfunction O(t, e, a, n = 0) {\n  r(w, t.quaternion), h(d, e, t.center);\n  const s = c(d, d, w),\n        f = c(A, a, w);\n  let o = -1 / 0,\n      i = 1 / 0;\n\n  for (let r = 0; r < 3; r++) if (Math.abs(f[r]) > 1e-6) {\n    const e = (n + t.halfSize[r] - s[r]) / f[r],\n          a = (-n - t.halfSize[r] - s[r]) / f[r];\n    o = Math.max(o, Math.min(e, a)), i = Math.min(i, Math.max(e, a));\n  } else if (s[r] > t.halfSize[r] + n || s[r] < -t.halfSize[r] - n) return !1;\n\n  return o <= i;\n}\n\nfunction P(a, n, s, f, o) {\n  r(w, a.quaternion), u(d, n, a.center), c(d, d, w);\n  const i = d[0] < -a.halfSize[0] ? -1 : d[0] > a.halfSize[0] ? 1 : 0,\n        h = d[1] < -a.halfSize[1] ? -1 : d[1] > a.halfSize[1] ? 1 : 0,\n        S = d[2] < -a.halfSize[2] ? -1 : d[2] > a.halfSize[2] ? 1 : 0,\n        b = Math.abs(i) + Math.abs(h) + Math.abs(S);\n  if (0 === b) return 1 / 0;\n  const M = 1 === b ? 4 : 6,\n        p = 6 * (i + 3 * h + 9 * S + 13);\n  t(I, a.quaternion), e(I, I, a.halfSize);\n\n  for (let t = 0; t < M; t++) {\n    const e = R[p + t];\n    l(d, ((1 & e) << 1) - 1, (2 & e) - 1, ((4 & e) >> 1) - 1), m(d, d, I), z(B, a.center, d), B[3] = 1, j(B, B, s);\n    const n = 1 / Math.max(1e-6, B[3]);\n    Q[2 * t] = B[0] * n, Q[2 * t + 1] = B[1] * n;\n  }\n\n  const q = 2 * M - 2;\n  let k = Q[0] * (Q[3] - Q[q + 1]) + Q[q] * (Q[1] - Q[q - 1]);\n\n  for (let t = 2; t < q; t += 2) k += Q[t] * (Q[t + 3] - Q[t - 1]);\n\n  return Math.abs(k) * f * o * .125;\n}\n\nconst Q = [.1, .2, .3, .4, .5, .6, .7, .8, .9, 1, 1.1, 1.2],\n      R = (() => {\n  const t = new Int8Array(162);\n  let e = 0;\n\n  const a = a => {\n    for (let n = 0; n < a.length; n++) t[e + n] = a[n];\n\n    e += 6;\n  };\n\n  return a([6, 2, 3, 1, 5, 4]), a([0, 2, 3, 1, 5, 4]), a([0, 2, 3, 7, 5, 4]), a([0, 1, 3, 2, 6, 4]), a([0, 1, 3, 2, 0, 0]), a([0, 1, 5, 7, 3, 2]), a([0, 1, 3, 7, 6, 4]), a([0, 1, 3, 7, 6, 2]), a([0, 1, 5, 7, 6, 2]), a([0, 1, 5, 4, 6, 2]), a([0, 1, 5, 4, 0, 0]), a([0, 1, 3, 7, 5, 4]), a([0, 2, 6, 4, 0, 0]), a([0, 0, 0, 0, 0, 0]), a([1, 3, 7, 5, 0, 0]), a([2, 3, 7, 6, 4, 0]), a([2, 3, 7, 6, 0, 0]), a([2, 3, 1, 5, 7, 6]), a([0, 1, 5, 7, 6, 2]), a([0, 1, 5, 7, 6, 4]), a([0, 1, 3, 7, 6, 4]), a([4, 5, 7, 6, 2, 0]), a([4, 5, 7, 6, 0, 0]), a([4, 5, 1, 3, 7, 6]), a([0, 2, 3, 7, 5, 4]), a([6, 2, 3, 7, 5, 4]), a([6, 2, 3, 1, 5, 4]), t;\n})();\n\nfunction T(t, e) {\n  r(w, t.quaternion), c(d, e, w);\n  const a = t.halfSize;\n  return Math.abs(d[0] * a[0]) + Math.abs(d[1] * a[1]) + Math.abs(d[2] * a[2]);\n}\n\nfunction U(t, e) {\n  for (let a = 0; a < 8; ++a) {\n    const n = e[a];\n    n[0] = 1 & a ? -t.halfSize[0] : t.halfSize[0], n[1] = 2 & a ? -t.halfSize[1] : t.halfSize[1], n[2] = 4 & a ? -t.halfSize[2] : t.halfSize[2], c(n, n, t.quaternion), z(n, n, t.center);\n  }\n}\n\nexport { C as ObbArray, E as clone, G as compute, U as corners, D as create, O as intersectLine, H as intersectPlane, N as isVisible, L as maximumDistancePlane, K as minimumDistancePlane, P as projectedArea, T as projectedRadius, F as set, J as toAaBoundingBox };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/support/orientedBoundingBox.js"],"names":["h","t","d","e","c","a","n","r","s","f","o","g","i","q","w","u","l","m","b","z","S","M","p","j","k","create","signedDistance","v","normal","x","computeOBB","y","A","B","I","C","constructor","buffer","ArrayBuffer","obbs","Array","center","halfSize","quaternion","D","E","F","G","H","T","J","Math","abs","K","L","N","O","max","min","P","R","Q","Int8Array","length","U","ObbArray","clone","compute","corners","intersectLine","intersectPlane","isVisible","maximumDistancePlane","minimumDistancePlane","projectedArea","projectedRadius","set","toAaBoundingBox"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{h as t,d as e}from\"../../../chunks/mat3.js\";import{c as a}from\"../../../chunks/mat3f64.js\";import{a as n,c as r}from\"../../../chunks/quat.js\";import{c as s,a as f}from\"../../../chunks/quatf32.js\";import{a as o}from\"../../../chunks/quatf64.js\";import{g as i,f as h,q as c,w as u,s as l,t as m,b as z}from\"../../../chunks/vec3.js\";import{b as S,a as b}from\"../../../chunks/vec3f32.js\";import{b as M,a as p,c as q}from\"../../../chunks/vec3f64.js\";import{t as j}from\"../../../chunks/vec4.js\";import{c as k}from\"../../../chunks/vec4f64.js\";import{create as g}from\"../../../geometry/support/aaBoundingBox.js\";import{signedDistance as v,normal as x}from\"../../../geometry/support/plane.js\";import{computeOBB as y}from\"./dito.js\";const w=o(),d=q(),A=q(),B=k(),I=a();class C{constructor(t){const e=56,a=0,n=24,r=36,f=t*e;this.buffer=new ArrayBuffer(f),this.obbs=new Array(t);for(let o=0;o<t;o++)this.obbs[o]={center:M(this.buffer,e*o+a),halfSize:S(this.buffer,e*o+n),quaternion:s(this.buffer,e*o+r)}}}function D(t=[0,0,0],e=[-1,-1,-1],a=[0,0,0,1]){return{center:p(t),halfSize:b(e),quaternion:f(a)}}function E(t){return D(t.center,t.halfSize,t.quaternion)}function F(t,e){i(e.center,t.center),i(e.halfSize,t.halfSize),n(e.quaternion,t.quaternion)}function G(t,e){return e=e||D(),y(t,e),e}function H(t,e){const a=v(e,t.center),n=T(t,x(e));return a>n?1:a<-n?-1:0}function J(e,a){a||(a=g());const n=t(I,e.quaternion),r=e.halfSize[0]*Math.abs(n[0])+e.halfSize[1]*Math.abs(n[3])+e.halfSize[2]*Math.abs(n[6]),s=e.halfSize[0]*Math.abs(n[1])+e.halfSize[1]*Math.abs(n[4])+e.halfSize[2]*Math.abs(n[7]),f=e.halfSize[0]*Math.abs(n[2])+e.halfSize[1]*Math.abs(n[5])+e.halfSize[2]*Math.abs(n[8]);return a[0]=e.center[0]-r,a[1]=e.center[1]-s,a[2]=e.center[2]-f,a[3]=e.center[0]+r,a[4]=e.center[1]+s,a[5]=e.center[2]+f,a}function K(t,e){return v(e,t.center)-T(t,x(e))}function L(t,e){return v(e,t.center)+T(t,x(e))}function N(t,e){return H(t,e[0])<=0&&H(t,e[1])<=0&&H(t,e[2])<=0&&H(t,e[3])<=0&&H(t,e[4])<=0&&H(t,e[5])<=0}function O(t,e,a,n=0){r(w,t.quaternion),h(d,e,t.center);const s=c(d,d,w),f=c(A,a,w);let o=-1/0,i=1/0;for(let r=0;r<3;r++)if(Math.abs(f[r])>1e-6){const e=(n+t.halfSize[r]-s[r])/f[r],a=(-n-t.halfSize[r]-s[r])/f[r];o=Math.max(o,Math.min(e,a)),i=Math.min(i,Math.max(e,a))}else if(s[r]>t.halfSize[r]+n||s[r]<-t.halfSize[r]-n)return!1;return o<=i}function P(a,n,s,f,o){r(w,a.quaternion),u(d,n,a.center),c(d,d,w);const i=d[0]<-a.halfSize[0]?-1:d[0]>a.halfSize[0]?1:0,h=d[1]<-a.halfSize[1]?-1:d[1]>a.halfSize[1]?1:0,S=d[2]<-a.halfSize[2]?-1:d[2]>a.halfSize[2]?1:0,b=Math.abs(i)+Math.abs(h)+Math.abs(S);if(0===b)return 1/0;const M=1===b?4:6,p=6*(i+3*h+9*S+13);t(I,a.quaternion),e(I,I,a.halfSize);for(let t=0;t<M;t++){const e=R[p+t];l(d,((1&e)<<1)-1,(2&e)-1,((4&e)>>1)-1),m(d,d,I),z(B,a.center,d),B[3]=1,j(B,B,s);const n=1/Math.max(1e-6,B[3]);Q[2*t]=B[0]*n,Q[2*t+1]=B[1]*n}const q=2*M-2;let k=Q[0]*(Q[3]-Q[q+1])+Q[q]*(Q[1]-Q[q-1]);for(let t=2;t<q;t+=2)k+=Q[t]*(Q[t+3]-Q[t-1]);return Math.abs(k)*f*o*.125}const Q=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2],R=(()=>{const t=new Int8Array(162);let e=0;const a=a=>{for(let n=0;n<a.length;n++)t[e+n]=a[n];e+=6};return a([6,2,3,1,5,4]),a([0,2,3,1,5,4]),a([0,2,3,7,5,4]),a([0,1,3,2,6,4]),a([0,1,3,2,0,0]),a([0,1,5,7,3,2]),a([0,1,3,7,6,4]),a([0,1,3,7,6,2]),a([0,1,5,7,6,2]),a([0,1,5,4,6,2]),a([0,1,5,4,0,0]),a([0,1,3,7,5,4]),a([0,2,6,4,0,0]),a([0,0,0,0,0,0]),a([1,3,7,5,0,0]),a([2,3,7,6,4,0]),a([2,3,7,6,0,0]),a([2,3,1,5,7,6]),a([0,1,5,7,6,2]),a([0,1,5,7,6,4]),a([0,1,3,7,6,4]),a([4,5,7,6,2,0]),a([4,5,7,6,0,0]),a([4,5,1,3,7,6]),a([0,2,3,7,5,4]),a([6,2,3,7,5,4]),a([6,2,3,1,5,4]),t})();function T(t,e){r(w,t.quaternion),c(d,e,w);const a=t.halfSize;return Math.abs(d[0]*a[0])+Math.abs(d[1]*a[1])+Math.abs(d[2]*a[2])}function U(t,e){for(let a=0;a<8;++a){const n=e[a];n[0]=1&a?-t.halfSize[0]:t.halfSize[0],n[1]=2&a?-t.halfSize[1]:t.halfSize[1],n[2]=4&a?-t.halfSize[2]:t.halfSize[2],c(n,n,t.quaternion),z(n,n,t.center)}}export{C as ObbArray,E as clone,G as compute,U as corners,D as create,O as intersectLine,H as intersectPlane,N as isVisible,L as maximumDistancePlane,K as minimumDistancePlane,P as projectedArea,T as projectedRadius,F as set,J as toAaBoundingBox};\n"]},"metadata":{},"sourceType":"module"}