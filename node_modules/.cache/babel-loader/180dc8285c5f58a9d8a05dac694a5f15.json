{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport \"../../../../layers/graphics/dehydratedFeatures.js\";\nimport { equals as e } from \"../../../../layers/graphics/dehydratedFeatureComparison.js\";\n\nclass s {\n  constructor(e, s) {\n    this.highestResolutionVersion = null, this.versions = [], this.ref(e, s);\n  }\n\n  get isReferenced() {\n    return 0 !== this.versions.length;\n  }\n\n  get isSingle() {\n    return 1 === this.versions.length && 1 === this.versions[0].refCount;\n  }\n\n  ref(s, t) {\n    const r = this.feature;\n    i.oldVersion = r, this.feature && Object.defineProperty(s, \"uid\", {\n      value: this.feature.uid,\n      configurable: !0\n    });\n\n    for (const o of this.versions) if (o.resolution === t) {\n      o.refCount++;\n      const t = this.highestResolutionVersion === o && !e(s, o.feature);\n      return (t || this.highestResolutionVersion !== o) && (o.feature = s), i.newVersion = t ? s : r, i;\n    }\n\n    const n = {\n      feature: s,\n      resolution: t,\n      refCount: 1\n    };\n    return this.versions.push(n), !this.highestResolutionVersion || t < this.highestResolutionVersion.resolution ? (i.newVersion = s, this.highestResolutionVersion = n) : i.newVersion = r, i;\n  }\n\n  unref(e) {\n    for (let s = 0; s < this.versions.length; s++) {\n      const t = this.versions[s];\n      if (t.resolution === e) return t.refCount--, i.oldVersion = this.feature, 0 === t.refCount && (this.versions[s] = this.versions[this.versions.length - 1], this.versions.length--, this.highestResolutionVersion === t && (this.recalculateHighestResolutionVersion(), i.oldVersion = t.feature)), i.newVersion = this.feature, i;\n    }\n\n    return null;\n  }\n\n  get feature() {\n    return this.highestResolutionVersion ? this.highestResolutionVersion.feature : null;\n  }\n\n  recalculateHighestResolutionVersion() {\n    if (0 === this.versions.length) return void (this.highestResolutionVersion = null);\n    let e = this.versions[0];\n\n    for (let s = 1; s < this.versions.length; s++) {\n      const t = this.versions[s];\n      t.resolution < e.resolution && (e = t);\n    }\n\n    this.highestResolutionVersion = e;\n  }\n\n}\n\nclass t {\n  constructor(e) {\n    this._feature = e, this.refCount = 1;\n  }\n\n  get isReferenced() {\n    return 0 !== this.refCount;\n  }\n\n  get isSingle() {\n    return 1 === this.refCount;\n  }\n\n  ref(s) {\n    return ++this.refCount, i.oldVersion = this._feature, this.feature && Object.defineProperty(s, \"uid\", {\n      value: this.feature.uid,\n      configurable: !0\n    }), e(this._feature, s) || (this._feature = s), i.newVersion = this._feature, i;\n  }\n\n  unref() {\n    return i.oldVersion = this._feature, this.refCount > 0 && (this.refCount--, !this.isReferenced) ? (i.newVersion = null, i) : (i.newVersion = this._feature, i);\n  }\n\n  get feature() {\n    return this._feature;\n  }\n\n}\n\nconst i = {\n  oldVersion: null,\n  newVersion: null\n};\nexport { s as MultiFeatureReference, t as SingleFeatureReference };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/layers/support/featureReference.js"],"names":["equals","e","s","constructor","highestResolutionVersion","versions","ref","isReferenced","length","isSingle","refCount","t","r","feature","i","oldVersion","Object","defineProperty","value","uid","configurable","o","resolution","newVersion","n","push","unref","recalculateHighestResolutionVersion","_feature","MultiFeatureReference","SingleFeatureReference"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAM,mDAAN;AAA0D,SAAOA,MAAM,IAAIC,CAAjB,QAAuB,4DAAvB;;AAAoF,MAAMC,CAAN,CAAO;AAACC,EAAAA,WAAW,CAACF,CAAD,EAAGC,CAAH,EAAK;AAAC,SAAKE,wBAAL,GAA8B,IAA9B,EAAmC,KAAKC,QAAL,GAAc,EAAjD,EAAoD,KAAKC,GAAL,CAASL,CAAT,EAAWC,CAAX,CAApD;AAAkE;;AAAgB,MAAZK,YAAY,GAAE;AAAC,WAAO,MAAI,KAAKF,QAAL,CAAcG,MAAzB;AAAgC;;AAAY,MAARC,QAAQ,GAAE;AAAC,WAAO,MAAI,KAAKJ,QAAL,CAAcG,MAAlB,IAA0B,MAAI,KAAKH,QAAL,CAAc,CAAd,EAAiBK,QAAtD;AAA+D;;AAAAJ,EAAAA,GAAG,CAACJ,CAAD,EAAGS,CAAH,EAAK;AAAC,UAAMC,CAAC,GAAC,KAAKC,OAAb;AAAqBC,IAAAA,CAAC,CAACC,UAAF,GAAaH,CAAb,EAAe,KAAKC,OAAL,IAAcG,MAAM,CAACC,cAAP,CAAsBf,CAAtB,EAAwB,KAAxB,EAA8B;AAACgB,MAAAA,KAAK,EAAC,KAAKL,OAAL,CAAaM,GAApB;AAAwBC,MAAAA,YAAY,EAAC,CAAC;AAAtC,KAA9B,CAA7B;;AAAqG,SAAI,MAAMC,CAAV,IAAe,KAAKhB,QAApB,EAA6B,IAAGgB,CAAC,CAACC,UAAF,KAAeX,CAAlB,EAAoB;AAACU,MAAAA,CAAC,CAACX,QAAF;AAAa,YAAMC,CAAC,GAAC,KAAKP,wBAAL,KAAgCiB,CAAhC,IAAmC,CAACpB,CAAC,CAACC,CAAD,EAAGmB,CAAC,CAACR,OAAL,CAA7C;AAA2D,aAAM,CAACF,CAAC,IAAE,KAAKP,wBAAL,KAAgCiB,CAApC,MAAyCA,CAAC,CAACR,OAAF,GAAUX,CAAnD,GAAsDY,CAAC,CAACS,UAAF,GAAaZ,CAAC,GAACT,CAAD,GAAGU,CAAvE,EAAyEE,CAA/E;AAAiF;;AAAA,UAAMU,CAAC,GAAC;AAACX,MAAAA,OAAO,EAACX,CAAT;AAAWoB,MAAAA,UAAU,EAACX,CAAtB;AAAwBD,MAAAA,QAAQ,EAAC;AAAjC,KAAR;AAA4C,WAAO,KAAKL,QAAL,CAAcoB,IAAd,CAAmBD,CAAnB,GAAsB,CAAC,KAAKpB,wBAAN,IAAgCO,CAAC,GAAC,KAAKP,wBAAL,CAA8BkB,UAAhE,IAA4ER,CAAC,CAACS,UAAF,GAAarB,CAAb,EAAe,KAAKE,wBAAL,GAA8BoB,CAAzH,IAA4HV,CAAC,CAACS,UAAF,GAAaX,CAA/J,EAAiKE,CAAxK;AAA0K;;AAAAY,EAAAA,KAAK,CAACzB,CAAD,EAAG;AAAC,SAAI,IAAIC,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,KAAKG,QAAL,CAAcG,MAA5B,EAAmCN,CAAC,EAApC,EAAuC;AAAC,YAAMS,CAAC,GAAC,KAAKN,QAAL,CAAcH,CAAd,CAAR;AAAyB,UAAGS,CAAC,CAACW,UAAF,KAAerB,CAAlB,EAAoB,OAAOU,CAAC,CAACD,QAAF,IAAaI,CAAC,CAACC,UAAF,GAAa,KAAKF,OAA/B,EAAuC,MAAIF,CAAC,CAACD,QAAN,KAAiB,KAAKL,QAAL,CAAcH,CAAd,IAAiB,KAAKG,QAAL,CAAc,KAAKA,QAAL,CAAcG,MAAd,GAAqB,CAAnC,CAAjB,EAAuD,KAAKH,QAAL,CAAcG,MAAd,EAAvD,EAA8E,KAAKJ,wBAAL,KAAgCO,CAAhC,KAAoC,KAAKgB,mCAAL,IAA2Cb,CAAC,CAACC,UAAF,GAAaJ,CAAC,CAACE,OAA9F,CAA/F,CAAvC,EAA8OC,CAAC,CAACS,UAAF,GAAa,KAAKV,OAAhQ,EAAwQC,CAA/Q;AAAiR;;AAAA,WAAO,IAAP;AAAY;;AAAW,MAAPD,OAAO,GAAE;AAAC,WAAO,KAAKT,wBAAL,GAA8B,KAAKA,wBAAL,CAA8BS,OAA5D,GAAoE,IAA3E;AAAgF;;AAAAc,EAAAA,mCAAmC,GAAE;AAAC,QAAG,MAAI,KAAKtB,QAAL,CAAcG,MAArB,EAA4B,OAAO,MAAK,KAAKJ,wBAAL,GAA8B,IAAnC,CAAP;AAAgD,QAAIH,CAAC,GAAC,KAAKI,QAAL,CAAc,CAAd,CAAN;;AAAuB,SAAI,IAAIH,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,KAAKG,QAAL,CAAcG,MAA5B,EAAmCN,CAAC,EAApC,EAAuC;AAAC,YAAMS,CAAC,GAAC,KAAKN,QAAL,CAAcH,CAAd,CAAR;AAAyBS,MAAAA,CAAC,CAACW,UAAF,GAAarB,CAAC,CAACqB,UAAf,KAA4BrB,CAAC,GAACU,CAA9B;AAAiC;;AAAA,SAAKP,wBAAL,GAA8BH,CAA9B;AAAgC;;AAA79C;;AAA89C,MAAMU,CAAN,CAAO;AAACR,EAAAA,WAAW,CAACF,CAAD,EAAG;AAAC,SAAK2B,QAAL,GAAc3B,CAAd,EAAgB,KAAKS,QAAL,GAAc,CAA9B;AAAgC;;AAAgB,MAAZH,YAAY,GAAE;AAAC,WAAO,MAAI,KAAKG,QAAhB;AAAyB;;AAAY,MAARD,QAAQ,GAAE;AAAC,WAAO,MAAI,KAAKC,QAAhB;AAAyB;;AAAAJ,EAAAA,GAAG,CAACJ,CAAD,EAAG;AAAC,WAAM,EAAE,KAAKQ,QAAP,EAAgBI,CAAC,CAACC,UAAF,GAAa,KAAKa,QAAlC,EAA2C,KAAKf,OAAL,IAAcG,MAAM,CAACC,cAAP,CAAsBf,CAAtB,EAAwB,KAAxB,EAA8B;AAACgB,MAAAA,KAAK,EAAC,KAAKL,OAAL,CAAaM,GAApB;AAAwBC,MAAAA,YAAY,EAAC,CAAC;AAAtC,KAA9B,CAAzD,EAAiInB,CAAC,CAAC,KAAK2B,QAAN,EAAe1B,CAAf,CAAD,KAAqB,KAAK0B,QAAL,GAAc1B,CAAnC,CAAjI,EAAuKY,CAAC,CAACS,UAAF,GAAa,KAAKK,QAAzL,EAAkMd,CAAxM;AAA0M;;AAAAY,EAAAA,KAAK,GAAE;AAAC,WAAOZ,CAAC,CAACC,UAAF,GAAa,KAAKa,QAAlB,EAA2B,KAAKlB,QAAL,GAAc,CAAd,KAAkB,KAAKA,QAAL,IAAgB,CAAC,KAAKH,YAAxC,KAAuDO,CAAC,CAACS,UAAF,GAAa,IAAb,EAAkBT,CAAzE,KAA6EA,CAAC,CAACS,UAAF,GAAa,KAAKK,QAAlB,EAA2Bd,CAAxG,CAAlC;AAA6I;;AAAW,MAAPD,OAAO,GAAE;AAAC,WAAO,KAAKe,QAAZ;AAAqB;;AAA7gB;;AAA8gB,MAAMd,CAAC,GAAC;AAACC,EAAAA,UAAU,EAAC,IAAZ;AAAiBQ,EAAAA,UAAU,EAAC;AAA5B,CAAR;AAA0C,SAAOrB,CAAC,IAAI2B,qBAAZ,EAAkClB,CAAC,IAAImB,sBAAvC","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../../../layers/graphics/dehydratedFeatures.js\";import{equals as e}from\"../../../../layers/graphics/dehydratedFeatureComparison.js\";class s{constructor(e,s){this.highestResolutionVersion=null,this.versions=[],this.ref(e,s)}get isReferenced(){return 0!==this.versions.length}get isSingle(){return 1===this.versions.length&&1===this.versions[0].refCount}ref(s,t){const r=this.feature;i.oldVersion=r,this.feature&&Object.defineProperty(s,\"uid\",{value:this.feature.uid,configurable:!0});for(const o of this.versions)if(o.resolution===t){o.refCount++;const t=this.highestResolutionVersion===o&&!e(s,o.feature);return(t||this.highestResolutionVersion!==o)&&(o.feature=s),i.newVersion=t?s:r,i}const n={feature:s,resolution:t,refCount:1};return this.versions.push(n),!this.highestResolutionVersion||t<this.highestResolutionVersion.resolution?(i.newVersion=s,this.highestResolutionVersion=n):i.newVersion=r,i}unref(e){for(let s=0;s<this.versions.length;s++){const t=this.versions[s];if(t.resolution===e)return t.refCount--,i.oldVersion=this.feature,0===t.refCount&&(this.versions[s]=this.versions[this.versions.length-1],this.versions.length--,this.highestResolutionVersion===t&&(this.recalculateHighestResolutionVersion(),i.oldVersion=t.feature)),i.newVersion=this.feature,i}return null}get feature(){return this.highestResolutionVersion?this.highestResolutionVersion.feature:null}recalculateHighestResolutionVersion(){if(0===this.versions.length)return void(this.highestResolutionVersion=null);let e=this.versions[0];for(let s=1;s<this.versions.length;s++){const t=this.versions[s];t.resolution<e.resolution&&(e=t)}this.highestResolutionVersion=e}}class t{constructor(e){this._feature=e,this.refCount=1}get isReferenced(){return 0!==this.refCount}get isSingle(){return 1===this.refCount}ref(s){return++this.refCount,i.oldVersion=this._feature,this.feature&&Object.defineProperty(s,\"uid\",{value:this.feature.uid,configurable:!0}),e(this._feature,s)||(this._feature=s),i.newVersion=this._feature,i}unref(){return i.oldVersion=this._feature,this.refCount>0&&(this.refCount--,!this.isReferenced)?(i.newVersion=null,i):(i.newVersion=this._feature,i)}get feature(){return this._feature}}const i={oldVersion:null,newVersion:null};export{s as MultiFeatureReference,t as SingleFeatureReference};\n"]},"metadata":{},"sourceType":"module"}