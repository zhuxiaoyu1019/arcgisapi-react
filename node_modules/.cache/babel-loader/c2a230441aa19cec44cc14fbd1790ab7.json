{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../../core/maybe.js\";\nimport { getFeatureEditFields as p, fixFields as l } from \"../../../layers/support/fieldUtils.js\";\n\nasync function t(t, d = t.popupTemplate) {\n  if (!e(d)) return [];\n  const i = await d.getRequiredFields(t.fieldsIndex),\n        {\n    lastEditInfoEnabled: n\n  } = d,\n        {\n    objectIdField: s,\n    typeIdField: a,\n    globalIdField: o,\n    relationships: u\n  } = t;\n  if (i.includes(\"*\")) return [\"*\"];\n  const f = n ? await p(t) : [],\n        r = l(t.fieldsIndex, [...i, ...f]);\n  return a && r.push(a), r && s && t.fieldsIndex.has(s) && -1 === r.indexOf(s) && r.push(s), r && o && t.fieldsIndex.has(o) && -1 === r.indexOf(o) && r.push(o), u && u.forEach(e => {\n    const {\n      keyField: p\n    } = e;\n    r && p && t.fieldsIndex.has(p) && -1 === r.indexOf(p) && r.push(p);\n  }), r;\n}\n\nfunction d(p, l) {\n  return p.popupTemplate ? p.popupTemplate : e(l) && l.defaultPopupTemplateEnabled && e(p.defaultPopupTemplate) ? p.defaultPopupTemplate : null;\n}\n\nexport { d as getFetchPopupTemplate, t as getRequiredFields };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/layers/support/popupUtils.js"],"names":["isSome","e","getFeatureEditFields","p","fixFields","l","t","d","popupTemplate","i","getRequiredFields","fieldsIndex","lastEditInfoEnabled","n","objectIdField","s","typeIdField","a","globalIdField","o","relationships","u","includes","f","r","push","has","indexOf","forEach","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate","getFetchPopupTemplate"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,MAAM,IAAIC,CAAjB,QAAuB,wBAAvB;AAAgD,SAAOC,oBAAoB,IAAIC,CAA/B,EAAiCC,SAAS,IAAIC,CAA9C,QAAoD,uCAApD;;AAA4F,eAAeC,CAAf,CAAiBA,CAAjB,EAAmBC,CAAC,GAACD,CAAC,CAACE,aAAvB,EAAqC;AAAC,MAAG,CAACP,CAAC,CAACM,CAAD,CAAL,EAAS,OAAM,EAAN;AAAS,QAAME,CAAC,GAAC,MAAMF,CAAC,CAACG,iBAAF,CAAoBJ,CAAC,CAACK,WAAtB,CAAd;AAAA,QAAiD;AAACC,IAAAA,mBAAmB,EAACC;AAArB,MAAwBN,CAAzE;AAAA,QAA2E;AAACO,IAAAA,aAAa,EAACC,CAAf;AAAiBC,IAAAA,WAAW,EAACC,CAA7B;AAA+BC,IAAAA,aAAa,EAACC,CAA7C;AAA+CC,IAAAA,aAAa,EAACC;AAA7D,MAAgEf,CAA3I;AAA6I,MAAGG,CAAC,CAACa,QAAF,CAAW,GAAX,CAAH,EAAmB,OAAM,CAAC,GAAD,CAAN;AAAY,QAAMC,CAAC,GAACV,CAAC,GAAC,MAAMV,CAAC,CAACG,CAAD,CAAR,GAAY,EAArB;AAAA,QAAwBkB,CAAC,GAACnB,CAAC,CAACC,CAAC,CAACK,WAAH,EAAe,CAAC,GAAGF,CAAJ,EAAM,GAAGc,CAAT,CAAf,CAA3B;AAAuD,SAAON,CAAC,IAAEO,CAAC,CAACC,IAAF,CAAOR,CAAP,CAAH,EAAaO,CAAC,IAAET,CAAH,IAAMT,CAAC,CAACK,WAAF,CAAce,GAAd,CAAkBX,CAAlB,CAAN,IAA4B,CAAC,CAAD,KAAKS,CAAC,CAACG,OAAF,CAAUZ,CAAV,CAAjC,IAA+CS,CAAC,CAACC,IAAF,CAAOV,CAAP,CAA5D,EAAsES,CAAC,IAAEL,CAAH,IAAMb,CAAC,CAACK,WAAF,CAAce,GAAd,CAAkBP,CAAlB,CAAN,IAA4B,CAAC,CAAD,KAAKK,CAAC,CAACG,OAAF,CAAUR,CAAV,CAAjC,IAA+CK,CAAC,CAACC,IAAF,CAAON,CAAP,CAArH,EAA+HE,CAAC,IAAEA,CAAC,CAACO,OAAF,CAAW3B,CAAC,IAAE;AAAC,UAAK;AAAC4B,MAAAA,QAAQ,EAAC1B;AAAV,QAAaF,CAAlB;AAAoBuB,IAAAA,CAAC,IAAErB,CAAH,IAAMG,CAAC,CAACK,WAAF,CAAce,GAAd,CAAkBvB,CAAlB,CAAN,IAA4B,CAAC,CAAD,KAAKqB,CAAC,CAACG,OAAF,CAAUxB,CAAV,CAAjC,IAA+CqB,CAAC,CAACC,IAAF,CAAOtB,CAAP,CAA/C;AAAyD,GAA5F,CAAlI,EAAiOqB,CAAxO;AAA0O;;AAAA,SAASjB,CAAT,CAAWJ,CAAX,EAAaE,CAAb,EAAe;AAAC,SAAOF,CAAC,CAACK,aAAF,GAAgBL,CAAC,CAACK,aAAlB,GAAgCP,CAAC,CAACI,CAAD,CAAD,IAAMA,CAAC,CAACyB,2BAAR,IAAqC7B,CAAC,CAACE,CAAC,CAAC4B,oBAAH,CAAtC,GAA+D5B,CAAC,CAAC4B,oBAAjE,GAAsF,IAA7H;AAAkI;;AAAA,SAAOxB,CAAC,IAAIyB,qBAAZ,EAAkC1B,CAAC,IAAII,iBAAvC","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l}from\"../../../layers/support/fieldUtils.js\";async function t(t,d=t.popupTemplate){if(!e(d))return[];const i=await d.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:n}=d,{objectIdField:s,typeIdField:a,globalIdField:o,relationships:u}=t;if(i.includes(\"*\"))return[\"*\"];const f=n?await p(t):[],r=l(t.fieldsIndex,[...i,...f]);return a&&r.push(a),r&&s&&t.fieldsIndex.has(s)&&-1===r.indexOf(s)&&r.push(s),r&&o&&t.fieldsIndex.has(o)&&-1===r.indexOf(o)&&r.push(o),u&&u.forEach((e=>{const{keyField:p}=e;r&&p&&t.fieldsIndex.has(p)&&-1===r.indexOf(p)&&r.push(p)})),r}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,t as getRequiredFields};\n"]},"metadata":{},"sourceType":"module"}