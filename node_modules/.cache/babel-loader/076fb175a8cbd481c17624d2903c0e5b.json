{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../config.js\";\nimport t from \"../../core/Error.js\";\nimport r from \"../../core/has.js\";\nimport o from \"../../core/Logger.js\";\nimport i from \"../../geometry/Point.js\";\nimport { geographicToWebMercator as s } from \"../../geometry/support/webMercatorUtils.js\";\nimport n from \"../../portal/Portal.js\";\nimport \"../../request.js\";\nimport \"../../core/urlUtils.js\";\nimport \"../../geometry.js\";\nimport \"../../geometry/Extent.js\";\nimport \"../../geometry/Geometry.js\";\nimport \"../../geometry/Multipoint.js\";\nimport \"../../geometry/Polygon.js\";\nimport \"../../geometry/Polyline.js\";\nimport \"../../rest/geometryService/units.js\";\nimport \"../../rest/support/GeneralizeParameters.js\";\nimport \"../../tasks/operations/generalize.js\";\nimport \"../../rest/support/LengthsParameters.js\";\nimport \"../../tasks/operations/lengths.js\";\nimport \"../../rest/support/OffsetParameters.js\";\nimport \"../../tasks/operations/offset.js\";\nimport { project as m } from \"../../rest/geometryService/project.js\";\nimport \"../../rest/support/RelationParameters.js\";\nimport \"../../tasks/operations/relation.js\";\nimport \"../../rest/support/TrimExtendParameters.js\";\nimport \"../../tasks/operations/trimExtend.js\";\nimport a from \"../../rest/support/ProjectParameters.js\";\nconst u = o.getLogger(\"esri.widgets.support.geolocationUtils\"),\n      c = {\n  maximumAge: 0,\n  timeout: 15e3,\n  enableHighAccuracy: !0\n};\n\nfunction p() {\n  const e = r(\"esri-geolocation\");\n  return e || u.warn(\"geolocation-unsupported\", \"Geolocation unsupported.\"), e;\n}\n\nfunction l() {\n  const e = window.isSecureContext;\n  return e || u.warn(\"insecure-context\", \"Geolocation requires a secure origin.\"), e;\n}\n\nfunction g() {\n  return p() && l();\n}\n\nfunction f(e) {\n  const r = 15e3;\n  return e || (e = c), new Promise((o, i) => {\n    setTimeout(() => i(new t(\"geolocation:timeout\", \"getting the current geolocation position timed out\")), r), navigator.geolocation.getCurrentPosition(o, i, e);\n  });\n}\n\nfunction j(e, t) {\n  const {\n    position: r,\n    view: o\n  } = e;\n  return P(y(d(r)), o, t);\n}\n\nfunction d(e) {\n  const t = e && e.coords || {},\n        r = {\n    accuracy: t.accuracy,\n    altitude: t.altitude,\n    altitudeAccuracy: t.altitudeAccuracy,\n    heading: t.heading,\n    latitude: t.latitude,\n    longitude: t.longitude,\n    speed: t.speed\n  };\n  return e ? {\n    coords: r,\n    timestamp: e.timestamp\n  } : e;\n}\n\nfunction y(e) {\n  const t = e && e.coords;\n  return t ? new i({\n    longitude: t.longitude,\n    latitude: t.latitude,\n    z: t.altitude || null,\n    spatialReference: {\n      wkid: 4326\n    }\n  }) : null;\n}\n\nfunction P(e, r, o) {\n  if (!r) return Promise.resolve(e);\n  const i = r.spatialReference;\n  return i.isWGS84 ? Promise.resolve(e) : i.isWebMercator ? Promise.resolve(s(e)) : w(o).then(r => {\n    if (!r) throw new t(\"geometry-service:missing-url\", \"Geometry service URL is missing\");\n    const s = new a({\n      geometries: [e],\n      outSpatialReference: i\n    });\n    return m(r, s, o).then(e => e[0]);\n  });\n}\n\nfunction w(t) {\n  if (e.geometryServiceUrl) return Promise.resolve(e.geometryServiceUrl);\n  const r = n.getDefault();\n  return r.load(t).catch(() => {}).then(() => r.get(\"helperServices.geometry.url\"));\n}\n\nexport { f as getCurrentPosition, j as positionToPoint, g as supported };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/widgets/support/geolocationUtils.js"],"names":["e","t","r","o","i","geographicToWebMercator","s","n","project","m","a","u","getLogger","c","maximumAge","timeout","enableHighAccuracy","p","warn","l","window","isSecureContext","g","f","Promise","setTimeout","navigator","geolocation","getCurrentPosition","j","position","view","P","y","d","coords","accuracy","altitude","altitudeAccuracy","heading","latitude","longitude","speed","timestamp","z","spatialReference","wkid","resolve","isWGS84","isWebMercator","w","then","geometries","outSpatialReference","geometryServiceUrl","getDefault","load","catch","get","positionToPoint","supported"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../config.js\";import t from\"../../core/Error.js\";import r from\"../../core/has.js\";import o from\"../../core/Logger.js\";import i from\"../../geometry/Point.js\";import{geographicToWebMercator as s}from\"../../geometry/support/webMercatorUtils.js\";import n from\"../../portal/Portal.js\";import\"../../request.js\";import\"../../core/urlUtils.js\";import\"../../geometry.js\";import\"../../geometry/Extent.js\";import\"../../geometry/Geometry.js\";import\"../../geometry/Multipoint.js\";import\"../../geometry/Polygon.js\";import\"../../geometry/Polyline.js\";import\"../../rest/geometryService/units.js\";import\"../../rest/support/GeneralizeParameters.js\";import\"../../tasks/operations/generalize.js\";import\"../../rest/support/LengthsParameters.js\";import\"../../tasks/operations/lengths.js\";import\"../../rest/support/OffsetParameters.js\";import\"../../tasks/operations/offset.js\";import{project as m}from\"../../rest/geometryService/project.js\";import\"../../rest/support/RelationParameters.js\";import\"../../tasks/operations/relation.js\";import\"../../rest/support/TrimExtendParameters.js\";import\"../../tasks/operations/trimExtend.js\";import a from\"../../rest/support/ProjectParameters.js\";const u=o.getLogger(\"esri.widgets.support.geolocationUtils\"),c={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function p(){const e=r(\"esri-geolocation\");return e||u.warn(\"geolocation-unsupported\",\"Geolocation unsupported.\"),e}function l(){const e=window.isSecureContext;return e||u.warn(\"insecure-context\",\"Geolocation requires a secure origin.\"),e}function g(){return p()&&l()}function f(e){const r=15e3;return e||(e=c),new Promise(((o,i)=>{setTimeout((()=>i(new t(\"geolocation:timeout\",\"getting the current geolocation position timed out\"))),r),navigator.geolocation.getCurrentPosition(o,i,e)}))}function j(e,t){const{position:r,view:o}=e;return P(y(d(r)),o,t)}function d(e){const t=e&&e.coords||{},r={accuracy:t.accuracy,altitude:t.altitude,altitudeAccuracy:t.altitudeAccuracy,heading:t.heading,latitude:t.latitude,longitude:t.longitude,speed:t.speed};return e?{coords:r,timestamp:e.timestamp}:e}function y(e){const t=e&&e.coords;return t?new i({longitude:t.longitude,latitude:t.latitude,z:t.altitude||null,spatialReference:{wkid:4326}}):null}function P(e,r,o){if(!r)return Promise.resolve(e);const i=r.spatialReference;return i.isWGS84?Promise.resolve(e):i.isWebMercator?Promise.resolve(s(e)):w(o).then((r=>{if(!r)throw new t(\"geometry-service:missing-url\",\"Geometry service URL is missing\");const s=new a({geometries:[e],outSpatialReference:i});return m(r,s,o).then((e=>e[0]))}))}function w(t){if(e.geometryServiceUrl)return Promise.resolve(e.geometryServiceUrl);const r=n.getDefault();return r.load(t).catch((()=>{})).then((()=>r.get(\"helperServices.geometry.url\")))}export{f as getCurrentPosition,j as positionToPoint,g as supported};\n"]},"metadata":{},"sourceType":"module"}