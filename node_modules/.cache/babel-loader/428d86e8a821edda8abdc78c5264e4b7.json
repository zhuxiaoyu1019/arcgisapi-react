{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from \"../../Graphic.js\";\nimport { isNone as e, isSome as r } from \"../../core/maybe.js\";\nimport s from \"../../geometry/Extent.js\";\nimport o from \"../../geometry/Mesh.js\";\nimport n from \"../../geometry/Point.js\";\nimport { fromAxisAndAngle as a } from \"../../geometry/support/axisAngleDegrees.js\";\nimport i from \"../../geometry/support/MeshTransform.js\";\nimport u from \"./FeatureSet.js\";\n\nfunction l(s, o, n) {\n  const a = n.features;\n  n.features = [], delete n.geometryType;\n  const i = u.fromJSON(n);\n  i.geometryType = \"mesh\";\n  const l = i.spatialReference,\n        f = e(s.outFields) || !s.outFields.length ? () => ({}) : m(s.outFields.includes(\"*\") ? null : new Set(s.outFields));\n\n  for (const e of a) {\n    const s = c(e, l, o);\n    r(s) && i.features.push(new t({\n      geometry: s,\n      attributes: f(e)\n    }));\n  }\n\n  return i;\n}\n\nfunction m(t) {\n  return ({\n    attributes: e\n  }) => {\n    if (!e) return {};\n    if (!t) return e;\n\n    for (const r in e) t.has(r) || delete e[r];\n\n    return e;\n  };\n}\n\nfunction c(t, e, r) {\n  const {\n    status: n,\n    source: a\n  } = g(t);\n  if (0 === n) return null;\n  const i = f(t, e, r),\n        u = s.fromJSON(t.geometry);\n  u.spatialReference = e;\n  const l = p(t, r);\n  return 1 === n ? o.createIncomplete(i, {\n    extent: u,\n    transform: l\n  }) : o.createWithExternalSource(i, a, {\n    extent: u,\n    transform: l\n  });\n}\n\nfunction f({\n  attributes: t\n}, e, {\n  transformFieldRoles: r\n}) {\n  return new n({\n    x: t[r.originX],\n    y: t[r.originY],\n    z: t[r.originZ],\n    spatialReference: e\n  });\n}\n\nfunction p({\n  attributes: t,\n  assetMappings: e\n}, {\n  transformFieldRoles: r\n}) {\n  var s;\n  return new i({\n    translation: [t[r.translationX], t[r.translationY], t[r.translationZ]],\n    rotation: a([t[r.rotationX], t[r.rotationY], t[r.rotationZ]], t[r.rotationDeg]),\n    scale: [t[r.scaleX], t[r.scaleY], t[r.scaleZ]],\n    geographic: !(null != (s = e.flags) && s.includes(\"PROJECT_VERTICES\"))\n  });\n}\n\nfunction g(t) {\n  if (!t.assetMappings) return {\n    status: 0\n  };\n  const e = [],\n        r = new Map();\n\n  for (const s of t.assetMappings) {\n    const t = s.seqNo,\n          o = s.assetName,\n          n = s.assetURL,\n          a = s.conversionStatus;\n    if (\"FAILED\" === a) return {\n      status: 0\n    };\n    if (\"COMPLETED\" !== a) return {\n      status: 1\n    };\n    if (null == t) e.push({\n      name: o,\n      source: n\n    });else {\n      const s = r.get(o);\n      let a;\n      s ? a = s.multipart : (a = [], e.push({\n        name: o,\n        source: {\n          multipart: a\n        }\n      }), r.set(o, {\n        multipart: a\n      })), a[t] = n;\n    }\n  }\n\n  return {\n    status: 2,\n    source: e\n  };\n}\n\nexport { l as meshFeatureSetFromJSON };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/rest/support/meshFeatureSet.js"],"names":["t","isNone","e","isSome","r","s","o","n","fromAxisAndAngle","a","i","u","l","features","geometryType","fromJSON","spatialReference","f","outFields","length","m","includes","Set","c","push","geometry","attributes","has","status","source","g","p","createIncomplete","extent","transform","createWithExternalSource","transformFieldRoles","x","originX","y","originY","z","originZ","assetMappings","translation","translationX","translationY","translationZ","rotation","rotationX","rotationY","rotationZ","rotationDeg","scale","scaleX","scaleY","scaleZ","geographic","flags","Map","seqNo","assetName","assetURL","conversionStatus","name","get","multipart","set","meshFeatureSetFromJSON"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from\"../../Graphic.js\";import{isNone as e,isSome as r}from\"../../core/maybe.js\";import s from\"../../geometry/Extent.js\";import o from\"../../geometry/Mesh.js\";import n from\"../../geometry/Point.js\";import{fromAxisAndAngle as a}from\"../../geometry/support/axisAngleDegrees.js\";import i from\"../../geometry/support/MeshTransform.js\";import u from\"./FeatureSet.js\";function l(s,o,n){const a=n.features;n.features=[],delete n.geometryType;const i=u.fromJSON(n);i.geometryType=\"mesh\";const l=i.spatialReference,f=e(s.outFields)||!s.outFields.length?()=>({}):m(s.outFields.includes(\"*\")?null:new Set(s.outFields));for(const e of a){const s=c(e,l,o);r(s)&&i.features.push(new t({geometry:s,attributes:f(e)}))}return i}function m(t){return({attributes:e})=>{if(!e)return{};if(!t)return e;for(const r in e)t.has(r)||delete e[r];return e}}function c(t,e,r){const{status:n,source:a}=g(t);if(0===n)return null;const i=f(t,e,r),u=s.fromJSON(t.geometry);u.spatialReference=e;const l=p(t,r);return 1===n?o.createIncomplete(i,{extent:u,transform:l}):o.createWithExternalSource(i,a,{extent:u,transform:l})}function f({attributes:t},e,{transformFieldRoles:r}){return new n({x:t[r.originX],y:t[r.originY],z:t[r.originZ],spatialReference:e})}function p({attributes:t,assetMappings:e},{transformFieldRoles:r}){var s;return new i({translation:[t[r.translationX],t[r.translationY],t[r.translationZ]],rotation:a([t[r.rotationX],t[r.rotationY],t[r.rotationZ]],t[r.rotationDeg]),scale:[t[r.scaleX],t[r.scaleY],t[r.scaleZ]],geographic:!(null!=(s=e.flags)&&s.includes(\"PROJECT_VERTICES\"))})}function g(t){if(!t.assetMappings)return{status:0};const e=[],r=new Map;for(const s of t.assetMappings){const t=s.seqNo,o=s.assetName,n=s.assetURL,a=s.conversionStatus;if(\"FAILED\"===a)return{status:0};if(\"COMPLETED\"!==a)return{status:1};if(null==t)e.push({name:o,source:n});else{const s=r.get(o);let a;s?a=s.multipart:(a=[],e.push({name:o,source:{multipart:a}}),r.set(o,{multipart:a})),a[t]=n}}return{status:2,source:e}}export{l as meshFeatureSetFromJSON};\n"]},"metadata":{},"sourceType":"module"}