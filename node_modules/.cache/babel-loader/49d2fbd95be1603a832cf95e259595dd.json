{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { disposeMaybe as t, isNone as r } from \"../../../../core/maybe.js\";\nimport { createQuadVAO as e } from \"./glUtil3D.js\";\nimport { CompositingTechnique as o, CompositingTechniqueConfiguration as i } from \"../shaders/CompositingTechnique.js\";\nimport { vertexCount as s } from \"../../../webgl/Util.js\";\n\nclass a {\n  constructor(t, r) {\n    this._rctx = t, this._techniqueRepository = r;\n  }\n\n  dispose() {\n    this._vao = t(this._vao);\n  }\n\n  compositeTransparent(t, r, e, i = 1) {\n    const a = this._rctx;\n    c.alphaMode = 1, c.function = 2, c.hasOpacityFactor = 1 !== i;\n\n    const n = this._techniqueRepository.acquire(o, c);\n\n    a.useProgram(n.program), n.bindPipelineState(a), n.program.bindTexture(t, \"colorTexture\"), n.program.bindTexture(r, \"alphaTexture\"), n.program.bindTexture(e, \"frontFaceTexture\");\n    const p = this.ensureVAO();\n    a.bindVAO(p), a.drawArrays(5, 0, s(p, \"geometry\")), n.release();\n  }\n\n  compositeSpecial(t, r) {\n    this.composite(t, 0, 1, r);\n  }\n\n  composite(t, r = 0, e = 1, i = 0, a = 0) {\n    const n = this._rctx;\n    c.alphaMode = r, c.function = i, c.hasOpacityFactor = 1 !== e;\n\n    const p = this._techniqueRepository.acquire(o, c);\n\n    n.useProgram(p.program), p.bindPipelineState(n), p.program.bindTexture(t, \"tex\"), c.hasOpacityFactor && p.program.setUniform1f(\"opacity\", e), 3 === i && p.program.setUniform1i(\"overlayIdx\", a);\n    const m = this.ensureVAO();\n    n.bindVAO(m), n.drawArrays(5, 0, s(m, \"geometry\")), p.release();\n  }\n\n  ensureVAO() {\n    return r(this._vao) && (this._vao = e(this._rctx)), this._vao;\n  }\n\n}\n\nconst c = new i();\nexport default a;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/webgl-engine/lib/CompositingHelper.js"],"names":["disposeMaybe","t","isNone","r","createQuadVAO","e","CompositingTechnique","o","CompositingTechniqueConfiguration","i","vertexCount","s","a","constructor","_rctx","_techniqueRepository","dispose","_vao","compositeTransparent","c","alphaMode","function","hasOpacityFactor","n","acquire","useProgram","program","bindPipelineState","bindTexture","p","ensureVAO","bindVAO","drawArrays","release","compositeSpecial","composite","setUniform1f","setUniform1i","m"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as t,isNone as r}from\"../../../../core/maybe.js\";import{createQuadVAO as e}from\"./glUtil3D.js\";import{CompositingTechnique as o,CompositingTechniqueConfiguration as i}from\"../shaders/CompositingTechnique.js\";import{vertexCount as s}from\"../../../webgl/Util.js\";class a{constructor(t,r){this._rctx=t,this._techniqueRepository=r}dispose(){this._vao=t(this._vao)}compositeTransparent(t,r,e,i=1){const a=this._rctx;c.alphaMode=1,c.function=2,c.hasOpacityFactor=1!==i;const n=this._techniqueRepository.acquire(o,c);a.useProgram(n.program),n.bindPipelineState(a),n.program.bindTexture(t,\"colorTexture\"),n.program.bindTexture(r,\"alphaTexture\"),n.program.bindTexture(e,\"frontFaceTexture\");const p=this.ensureVAO();a.bindVAO(p),a.drawArrays(5,0,s(p,\"geometry\")),n.release()}compositeSpecial(t,r){this.composite(t,0,1,r)}composite(t,r=0,e=1,i=0,a=0){const n=this._rctx;c.alphaMode=r,c.function=i,c.hasOpacityFactor=1!==e;const p=this._techniqueRepository.acquire(o,c);n.useProgram(p.program),p.bindPipelineState(n),p.program.bindTexture(t,\"tex\"),c.hasOpacityFactor&&p.program.setUniform1f(\"opacity\",e),3===i&&p.program.setUniform1i(\"overlayIdx\",a);const m=this.ensureVAO();n.bindVAO(m),n.drawArrays(5,0,s(m,\"geometry\")),p.release()}ensureVAO(){return r(this._vao)&&(this._vao=e(this._rctx)),this._vao}}const c=new i;export default a;\n"]},"metadata":{},"sourceType":"module"}