{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { unwrapOr as t, isNone as e, isSome as n } from \"../../../../core/maybe.js\";\nimport { getMetersPerUnit as s, supportsUnit as i } from \"../../../../symbols/support/unitConversionUtils.js\";\nimport { execute as r, clone as o, setContextFeature as f, createFeature as u } from \"./featureExpressionInfoUtils.js\";\n\nclass h {\n  constructor() {\n    this._meterUnitOffset = 0, this._renderUnitOffset = 0, this._unit = \"meters\", this._metersPerElevationInfoUnit = 1, this._featureExpressionInfoContext = null, this.centerPointInElevationSR = null, this.mode = null;\n  }\n\n  get featureExpressionInfoContext() {\n    return this._featureExpressionInfoContext;\n  }\n\n  get meterUnitOffset() {\n    return this._meterUnitOffset;\n  }\n\n  get unit() {\n    return this._unit;\n  }\n\n  set unit(t) {\n    this._unit = t, this._metersPerElevationInfoUnit = s(t);\n  }\n\n  reset() {\n    this.mode = null, this._meterUnitOffset = 0, this._renderUnitOffset = 0, this._featureExpressionInfoContext = null, this.unit = \"meters\";\n  }\n\n  set offsetMeters(t) {\n    this._meterUnitOffset = t, this._renderUnitOffset = 0;\n  }\n\n  set offsetElevationInfoUnits(t) {\n    this._meterUnitOffset = t * this._metersPerElevationInfoUnit, this._renderUnitOffset = 0;\n  }\n\n  addOffsetRenderUnits(t) {\n    this._renderUnitOffset += t;\n  }\n\n  geometryZWithOffset(t, e) {\n    const n = this.calculateOffsetRenderUnits(e);\n    return null != this.featureExpressionInfoContext ? n : t + n;\n  }\n\n  calculateOffsetRenderUnits(t) {\n    let e = this._meterUnitOffset;\n    const n = this.featureExpressionInfoContext;\n    return null != n && (e += r(n) * this._metersPerElevationInfoUnit), e / t.unitInMeters + this._renderUnitOffset;\n  }\n\n  setFromElevationInfo(e) {\n    this.mode = e.mode, this.unit = i(e.unit) ? e.unit : \"meters\", this.offsetElevationInfoUnits = t(e.offset, 0);\n  }\n\n  updateFeatureExpressionInfoContext(t, s, i) {\n    if (e(t)) return void (this._featureExpressionInfoContext = null);\n    const r = t && t.arcade;\n    r && n(s) && n(i) ? (this._featureExpressionInfoContext = o(t), f(this._featureExpressionInfoContext, u(r.modules, s, i))) : this._featureExpressionInfoContext = t;\n  }\n\n  static fromElevationInfo(t) {\n    const e = new h();\n    return n(t) && e.setFromElevationInfo(t), e;\n  }\n\n}\n\nexport { h as ElevationContext };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/layers/graphics/ElevationContext.js"],"names":["unwrapOr","t","isNone","e","isSome","n","getMetersPerUnit","s","supportsUnit","i","execute","r","clone","o","setContextFeature","f","createFeature","u","h","constructor","_meterUnitOffset","_renderUnitOffset","_unit","_metersPerElevationInfoUnit","_featureExpressionInfoContext","centerPointInElevationSR","mode","featureExpressionInfoContext","meterUnitOffset","unit","reset","offsetMeters","offsetElevationInfoUnits","addOffsetRenderUnits","geometryZWithOffset","calculateOffsetRenderUnits","unitInMeters","setFromElevationInfo","offset","updateFeatureExpressionInfoContext","arcade","modules","fromElevationInfo","ElevationContext"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{unwrapOr as t,isNone as e,isSome as n}from\"../../../../core/maybe.js\";import{getMetersPerUnit as s,supportsUnit as i}from\"../../../../symbols/support/unitConversionUtils.js\";import{execute as r,clone as o,setContextFeature as f,createFeature as u}from\"./featureExpressionInfoUtils.js\";class h{constructor(){this._meterUnitOffset=0,this._renderUnitOffset=0,this._unit=\"meters\",this._metersPerElevationInfoUnit=1,this._featureExpressionInfoContext=null,this.centerPointInElevationSR=null,this.mode=null}get featureExpressionInfoContext(){return this._featureExpressionInfoContext}get meterUnitOffset(){return this._meterUnitOffset}get unit(){return this._unit}set unit(t){this._unit=t,this._metersPerElevationInfoUnit=s(t)}reset(){this.mode=null,this._meterUnitOffset=0,this._renderUnitOffset=0,this._featureExpressionInfoContext=null,this.unit=\"meters\"}set offsetMeters(t){this._meterUnitOffset=t,this._renderUnitOffset=0}set offsetElevationInfoUnits(t){this._meterUnitOffset=t*this._metersPerElevationInfoUnit,this._renderUnitOffset=0}addOffsetRenderUnits(t){this._renderUnitOffset+=t}geometryZWithOffset(t,e){const n=this.calculateOffsetRenderUnits(e);return null!=this.featureExpressionInfoContext?n:t+n}calculateOffsetRenderUnits(t){let e=this._meterUnitOffset;const n=this.featureExpressionInfoContext;return null!=n&&(e+=r(n)*this._metersPerElevationInfoUnit),e/t.unitInMeters+this._renderUnitOffset}setFromElevationInfo(e){this.mode=e.mode,this.unit=i(e.unit)?e.unit:\"meters\",this.offsetElevationInfoUnits=t(e.offset,0)}updateFeatureExpressionInfoContext(t,s,i){if(e(t))return void(this._featureExpressionInfoContext=null);const r=t&&t.arcade;r&&n(s)&&n(i)?(this._featureExpressionInfoContext=o(t),f(this._featureExpressionInfoContext,u(r.modules,s,i))):this._featureExpressionInfoContext=t}static fromElevationInfo(t){const e=new h;return n(t)&&e.setFromElevationInfo(t),e}}export{h as ElevationContext};\n"]},"metadata":{},"sourceType":"module"}