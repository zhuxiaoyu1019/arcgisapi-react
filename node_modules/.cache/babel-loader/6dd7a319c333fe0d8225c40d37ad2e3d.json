{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { createExpression as e } from \"../expression/expression.js\";\nimport { BooleanType as r } from \"../expression/types.js\";\n\nclass t {\n  constructor(e) {\n    this._expression = e;\n  }\n\n  filter(e, r) {\n    if (!this._expression) return !0;\n\n    try {\n      return this._expression.evaluate(e, r);\n    } catch (t) {\n      return console.log(t.message), !0;\n    }\n  }\n\n  static createFilter(n) {\n    if (!n) return null;\n    this.isLegacyFilter(n) && (n = this.convertLegacyFilter(n));\n\n    try {\n      const s = e(n, null, r);\n      return new t(s);\n    } catch (s) {\n      return console.log(s.message), null;\n    }\n  }\n\n  static isLegacyFilter(e) {\n    if (!Array.isArray(e)) return !0;\n    if (0 === e.length) return !0;\n\n    switch (e[0]) {\n      case \"==\":\n      case \"!=\":\n      case \">\":\n      case \"<\":\n      case \">=\":\n      case \"<=\":\n        return 3 === e.length && \"string\" == typeof e[1] && !Array.isArray(e[2]);\n\n      case \"in\":\n        return e.length >= 3 && \"string\" == typeof e[1] && !Array.isArray(e[2]);\n\n      case \"!in\":\n        return !0;\n\n      case \"any\":\n      case \"all\":\n        for (let r = 1; r < e.length; r++) if (!this.isLegacyFilter(e[1])) return !1;\n\n        return !0;\n\n      case \"none\":\n        return !0;\n\n      case \"has\":\n        return 2 === e.length && (\"$id\" === e[1] || \"$type\" === e[1]);\n\n      case \"!has\":\n        return !0;\n\n      default:\n        return !1;\n    }\n  }\n\n  static convertLegacyFilter(e) {\n    if (!Array.isArray(e) || 0 === e.length) return !0;\n    const r = e[0];\n    if (1 === e.length) return \"any\" !== r;\n\n    switch (r) {\n      case \"==\":\n        return t.convertComparison(\"==\", e[1], e[2]);\n\n      case \"!=\":\n        return t.negate(t.convertComparison(\"==\", e[1], e[2]));\n\n      case \">\":\n      case \"<\":\n      case \">=\":\n      case \"<=\":\n        return t.convertComparison(r, e[1], e[2]);\n\n      case \"in\":\n        return t.convertIn(e[1], e.slice(2));\n\n      case \"!in\":\n        return t.negate(t.convertIn(e[1], e.slice(2)));\n\n      case \"any\":\n      case \"all\":\n      case \"none\":\n        return t.convertCombining(r, e.slice(1));\n\n      case \"has\":\n        return t.convertHas(e[1]);\n\n      case \"!has\":\n        return t.negate(t.convertHas(e[1]));\n\n      default:\n        throw new Error(\"Unexpected legacy filter.\");\n    }\n  }\n\n  static convertComparison(e, r, t) {\n    switch (r) {\n      case \"$type\":\n        return [e, [\"geometry-type\"], t];\n\n      case \"$id\":\n        return [e, [\"id\"], t];\n\n      default:\n        return [e, [\"get\", r], t];\n    }\n  }\n\n  static convertIn(e, r) {\n    switch (e) {\n      case \"$type\":\n        return [\"in\", [\"geometry-type\"], [\"literal\", r]];\n\n      case \"$id\":\n        return [\"in\", [\"id\"], [\"literal\", r]];\n\n      default:\n        return [\"in\", [\"get\", e], [\"literal\", r]];\n    }\n  }\n\n  static convertHas(e) {\n    switch (e) {\n      case \"$type\":\n        return !0;\n\n      case \"$id\":\n        return [\"has-id\"];\n\n      default:\n        return [\"has\", e];\n    }\n  }\n\n  static convertCombining(e, r) {\n    return [e].concat(r.map(this.convertLegacyFilter));\n  }\n\n  static negate(e) {\n    return [\"!\", e];\n  }\n\n}\n\nexport default t;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/2d/engine/vectorTiles/style/Filter.js"],"names":["createExpression","e","BooleanType","r","t","constructor","_expression","filter","evaluate","console","log","message","createFilter","n","isLegacyFilter","convertLegacyFilter","s","Array","isArray","length","convertComparison","negate","convertIn","slice","convertCombining","convertHas","Error","concat","map"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{createExpression as e}from\"../expression/expression.js\";import{BooleanType as r}from\"../expression/types.js\";class t{constructor(e){this._expression=e}filter(e,r){if(!this._expression)return!0;try{return this._expression.evaluate(e,r)}catch(t){return console.log(t.message),!0}}static createFilter(n){if(!n)return null;this.isLegacyFilter(n)&&(n=this.convertLegacyFilter(n));try{const s=e(n,null,r);return new t(s)}catch(s){return console.log(s.message),null}}static isLegacyFilter(e){if(!Array.isArray(e))return!0;if(0===e.length)return!0;switch(e[0]){case\"==\":case\"!=\":case\">\":case\"<\":case\">=\":case\"<=\":return 3===e.length&&\"string\"==typeof e[1]&&!Array.isArray(e[2]);case\"in\":return e.length>=3&&\"string\"==typeof e[1]&&!Array.isArray(e[2]);case\"!in\":return!0;case\"any\":case\"all\":for(let r=1;r<e.length;r++)if(!this.isLegacyFilter(e[1]))return!1;return!0;case\"none\":return!0;case\"has\":return 2===e.length&&(\"$id\"===e[1]||\"$type\"===e[1]);case\"!has\":return!0;default:return!1}}static convertLegacyFilter(e){if(!Array.isArray(e)||0===e.length)return!0;const r=e[0];if(1===e.length)return\"any\"!==r;switch(r){case\"==\":return t.convertComparison(\"==\",e[1],e[2]);case\"!=\":return t.negate(t.convertComparison(\"==\",e[1],e[2]));case\">\":case\"<\":case\">=\":case\"<=\":return t.convertComparison(r,e[1],e[2]);case\"in\":return t.convertIn(e[1],e.slice(2));case\"!in\":return t.negate(t.convertIn(e[1],e.slice(2)));case\"any\":case\"all\":case\"none\":return t.convertCombining(r,e.slice(1));case\"has\":return t.convertHas(e[1]);case\"!has\":return t.negate(t.convertHas(e[1]));default:throw new Error(\"Unexpected legacy filter.\")}}static convertComparison(e,r,t){switch(r){case\"$type\":return[e,[\"geometry-type\"],t];case\"$id\":return[e,[\"id\"],t];default:return[e,[\"get\",r],t]}}static convertIn(e,r){switch(e){case\"$type\":return[\"in\",[\"geometry-type\"],[\"literal\",r]];case\"$id\":return[\"in\",[\"id\"],[\"literal\",r]];default:return[\"in\",[\"get\",e],[\"literal\",r]]}}static convertHas(e){switch(e){case\"$type\":return!0;case\"$id\":return[\"has-id\"];default:return[\"has\",e]}}static convertCombining(e,r){return[e].concat(r.map(this.convertLegacyFilter))}static negate(e){return[\"!\",e]}}export default t;\n"]},"metadata":{},"sourceType":"module"}