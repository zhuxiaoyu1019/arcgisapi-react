{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport \"../geometry.js\";\nimport r from \"../PopupTemplate.js\";\nimport \"../renderers/ClassBreaksRenderer.js\";\nimport \"../renderers/DictionaryRenderer.js\";\nimport \"../renderers/DotDensityRenderer.js\";\nimport \"../renderers/HeatmapRenderer.js\";\nimport \"../renderers/Renderer.js\";\nimport t from \"../renderers/SimpleRenderer.js\";\nimport o from \"../renderers/UniqueValueRenderer.js\";\nimport { read as i, write as s } from \"../renderers/support/jsonUtils.js\";\nimport { rendererTypes as n, webSceneRendererTypes as p } from \"../renderers/support/types.js\";\nimport a from \"../request.js\";\nimport { symbolTypesRenderer as l } from \"../symbols.js\";\nimport d from \"../core/Error.js\";\nimport m from \"../core/global.js\";\nimport u from \"../core/Logger.js\";\nimport { isSome as y } from \"../core/maybe.js\";\nimport { MultiOriginJSONMixin as f } from \"../core/MultiOriginJSONSupport.js\";\nimport { throwIfAbortError as c } from \"../core/promiseUtils.js\";\nimport { property as h } from \"../core/accessorSupport/decorators/property.js\";\nimport \"../core/has.js\";\nimport { Integer as g } from \"../core/accessorSupport/ensureType.js\";\nimport { reader as j } from \"../core/accessorSupport/decorators/reader.js\";\nimport { subclass as S } from \"../core/accessorSupport/decorators/subclass.js\";\nimport { writer as b } from \"../core/accessorSupport/decorators/writer.js\";\nimport { createTypeReader as v } from \"../core/accessorSupport/extensions/serializableProperty/reader.js\";\nimport { featureGeometryTypeKebabDictionary as w } from \"../geometry/support/typeUtils.js\";\nimport I from \"./Layer.js\";\nimport { ArcGISService as R } from \"./mixins/ArcGISService.js\";\nimport { BlendLayer as x } from \"./mixins/BlendLayer.js\";\nimport { OperationalLayer as T } from \"./mixins/OperationalLayer.js\";\nimport { PortalLayer as F } from \"./mixins/PortalLayer.js\";\nimport { RefreshableLayer as D } from \"./mixins/RefreshableLayer.js\";\nimport { ScaleRangeLayer as L } from \"./mixins/ScaleRangeLayer.js\";\nimport { TemporalLayer as P } from \"./mixins/TemporalLayer.js\";\nimport { labelsVisible as U, legendEnabled as E, maxScale as O, minScale as k, popupEnabled as _, screenSizePerspectiveEnabled as N, url as A } from \"./support/commonProperties.js\";\nimport { read as J, writeTarget as W, webSceneFeatureReductionTypes as G } from \"./support/featureReductionUtils.js\";\nimport { defineFieldProperties as q } from \"./support/fieldProperties.js\";\nimport { fixRendererFields as V, fixTimeInfoFields as z } from \"./support/fieldUtils.js\";\nimport C from \"./support/LabelClass.js\";\nimport { reader as B } from \"./support/labelingInfo.js\";\nimport M from \"./support/PurgeOptions.js\";\nimport { loadStyleRenderer as Q } from \"../renderers/support/styleUtils.js\";\nimport H from \"../rest/support/Query.js\";\nimport { createPopupTemplate as K } from \"../support/popupUtils.js\";\nimport X from \"../symbols/support/ElevationInfo.js\";\nimport Y from \"../geometry/SpatialReference.js\";\nimport Z from \"../geometry/Extent.js\";\nconst $ = u.getLogger(\"esri.layers.StreamLayer\"),\n      ee = q();\nlet re = class extends x(P(L(D(R(T(F(f(I)))))))) {\n  constructor(...e) {\n    super(...e), this.copyright = null, this.definitionExpression = null, this.displayField = null, this.elevationInfo = null, this.featureReduction = null, this.fields = null, this.fieldsIndex = null, this.geometryDefinition = null, this.geometryType = null, this.labelsVisible = !0, this.labelingInfo = null, this.legendEnabled = !0, this.maxReconnectionAttempts = 0, this.maxReconnectionInterval = 20, this.maxScale = 0, this.minScale = 0, this.objectIdField = null, this.operationalLayerType = \"ArcGISStreamLayer\", this.popupEnabled = !0, this.popupTemplate = null, this.purgeOptions = new M(), this.screenSizePerspectiveEnabled = !0, this.sourceJSON = null, this.spatialReference = Y.WGS84, this.type = \"stream\", this.url = null, this.updateInterval = 300, this.webSocketUrl = null;\n  }\n\n  normalizeCtorArgs(e, r) {\n    return \"string\" == typeof e ? {\n      url: e,\n      ...r\n    } : e;\n  }\n\n  load(e) {\n    if (!(\"WebSocket\" in m)) return this.addResolvingPromise(Promise.reject(new d(\"stream-layer:websocket-unsupported\", \"WebSocket is not supported in this browser. StreamLayer will not have real-time connection with the stream service.\"))), Promise.resolve(this);\n    const r = y(e) ? e.signal : null;\n    return this.addResolvingPromise(this.loadFromPortal({\n      supportedTypes: [\"Stream Service\", \"Feed\"]\n    }, e).catch(c).then(() => this._fetchService(r))), Promise.resolve(this);\n  }\n\n  get defaultPopupTemplate() {\n    return this.createPopupTemplate();\n  }\n\n  readFeatureReduction(e, r) {\n    return J(e, r);\n  }\n\n  writeWebSceneFeatureReduction(e, r, t, o) {\n    W(e, r, \"layerDefinition.featureReduction\", o);\n  }\n\n  set renderer(e) {\n    V(e, this.fieldsIndex), this._set(\"renderer\", e);\n  }\n\n  readRenderer(e, r, s) {\n    const n = (r = r.layerDefinition || r).drawingInfo && r.drawingInfo.renderer || void 0;\n\n    if (n) {\n      const e = i(n, r, s) || void 0;\n      return e || $.error(\"Failed to create renderer\", {\n        rendererDefinition: r.drawingInfo.renderer,\n        layer: this,\n        context: s\n      }), e;\n    }\n\n    if (r.defaultSymbol) return r.types && r.types.length ? new o({\n      defaultSymbol: te(r.defaultSymbol, r, s),\n      field: r.typeIdField,\n      uniqueValueInfos: r.types.map(e => ({\n        id: e.id,\n        symbol: te(e.symbol, e, s)\n      }))\n    }) : new t({\n      symbol: te(r.defaultSymbol, r, s)\n    });\n  }\n\n  writeRenderer(e, r, t, o) {\n    s(e, r, t, o);\n  }\n\n  writeWebSceneRenderer(e, r, t, o) {\n    s(e, r, \"layerDefinition.drawingInfo.renderer\", o);\n  }\n\n  createPopupTemplate(e) {\n    return K(this, e);\n  }\n\n  createQuery() {\n    const e = new H();\n    return e.returnGeometry = !0, e.outFields = [\"*\"], e.where = this.definitionExpression || \"1=1\", e;\n  }\n\n  getFieldDomain(e, r) {\n    if (!this.fields) return null;\n    let t = null;\n    return this.fields.some(r => (r.name === e && (t = r.domain), !!t)), t;\n  }\n\n  getField(e) {\n    return this.fieldsIndex.get(e);\n  }\n\n  async _fetchService(e) {\n    var r;\n\n    if (!!this.webSocketUrl) {\n      var t;\n      if (null == (t = this.timeInfo) || !t.trackIdField) throw new d(\"stream-layer:missing-metadata\", \"The stream layer trackIdField must be specified.\");\n      if (!this.objectIdField) throw new d(\"stream-layer:missing-metadata\", \"The stream layer objectIdField must be specified.\");\n      if (!this.fields) throw new d(\"stream-layer:missing-metadata\", \"The stream layer fields must be specified.\");\n      if (!this.geometryType) throw new d(\"stream-layer:missing-metadata\", \"The stream layer geometryType must be specified.\");\n      this.url = this.webSocketUrl;\n    } else if (!this.sourceJSON) {\n      const {\n        data: r\n      } = await a(this.parsedUrl.path, {\n        query: {\n          f: \"json\",\n          ...this.parsedUrl.query\n        },\n        responseType: \"json\",\n        signal: e\n      });\n      this.sourceJSON = r;\n    }\n\n    return this.sourceJSON = { ...(null != (r = this.sourceJSON) ? r : {}),\n      objectIdField: \"__esri_stream_id__\"\n    }, this.read(this.sourceJSON, {\n      origin: \"service\",\n      url: this.parsedUrl\n    }), V(this.renderer, this.fieldsIndex), z(this.timeInfo, this.fieldsIndex), Q(this, {\n      origin: \"service\"\n    });\n  }\n\n};\ne([h({\n  type: String\n})], re.prototype, \"copyright\", void 0), e([h({\n  readOnly: !0\n})], re.prototype, \"defaultPopupTemplate\", null), e([h({\n  type: String,\n  json: {\n    name: \"layerDefinition.definitionExpression\",\n    write: {\n      enabled: !0,\n      allowNull: !0\n    }\n  }\n})], re.prototype, \"definitionExpression\", void 0), e([h({\n  type: String\n})], re.prototype, \"displayField\", void 0), e([h({\n  type: X\n})], re.prototype, \"elevationInfo\", void 0), e([j(\"featureReduction\", [\"layerDefinition.featureReduction\"])], re.prototype, \"readFeatureReduction\", null), e([b(\"web-scene\", \"featureReduction\", {\n  \"layerDefinition.featureReduction\": {\n    types: G\n  }\n})], re.prototype, \"writeWebSceneFeatureReduction\", null), e([h(ee.fields)], re.prototype, \"fields\", void 0), e([h(ee.fieldsIndex)], re.prototype, \"fieldsIndex\", void 0), e([h({\n  type: Z\n})], re.prototype, \"geometryDefinition\", void 0), e([h({\n  type: w.apiValues,\n  json: {\n    read: {\n      reader: w.read\n    }\n  }\n})], re.prototype, \"geometryType\", void 0), e([h(U)], re.prototype, \"labelsVisible\", void 0), e([h({\n  type: [C],\n  json: {\n    read: {\n      source: \"layerDefinition.drawingInfo.labelingInfo\",\n      reader: B\n    },\n    write: {\n      target: \"layerDefinition.drawingInfo.labelingInfo\"\n    }\n  }\n})], re.prototype, \"labelingInfo\", void 0), e([h(E)], re.prototype, \"legendEnabled\", void 0), e([h({\n  type: [\"show\", \"hide\"]\n})], re.prototype, \"listMode\", void 0), e([h({\n  type: g\n})], re.prototype, \"maxReconnectionAttempts\", void 0), e([h({\n  type: g\n})], re.prototype, \"maxReconnectionInterval\", void 0), e([h(O)], re.prototype, \"maxScale\", void 0), e([h(k)], re.prototype, \"minScale\", void 0), e([h({\n  type: String\n})], re.prototype, \"objectIdField\", void 0), e([h({\n  value: \"ArcGISStreamLayer\",\n  type: [\"ArcGISStreamLayer\"]\n})], re.prototype, \"operationalLayerType\", void 0), e([h(_)], re.prototype, \"popupEnabled\", void 0), e([h({\n  type: r,\n  json: {\n    read: {\n      source: \"popupInfo\"\n    },\n    write: {\n      target: \"popupInfo\"\n    }\n  }\n})], re.prototype, \"popupTemplate\", void 0), e([h({\n  type: M\n})], re.prototype, \"purgeOptions\", void 0), e([h({\n  types: n,\n  json: {\n    origins: {\n      service: {\n        write: {\n          target: \"drawingInfo.renderer\",\n          enabled: !1\n        }\n      }\n    },\n    write: {\n      target: \"layerDefinition.drawingInfo.renderer\"\n    }\n  }\n})], re.prototype, \"renderer\", null), e([j(\"service\", \"renderer\", [\"drawingInfo.renderer\", \"defaultSymbol\"]), j(\"renderer\", [\"layerDefinition.drawingInfo.renderer\", \"layerDefinition.defaultSymbol\"])], re.prototype, \"readRenderer\", null), e([b(\"renderer\")], re.prototype, \"writeRenderer\", null), e([b(\"web-scene\", \"renderer\", {\n  \"layerDefinition.drawingInfo.renderer\": {\n    types: p\n  }\n})], re.prototype, \"writeWebSceneRenderer\", null), e([h(N)], re.prototype, \"screenSizePerspectiveEnabled\", void 0), e([h({\n  type: Y,\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"spatialReference\"\n        }\n      }\n    }\n  }\n})], re.prototype, \"spatialReference\", void 0), e([h({\n  json: {\n    read: !1\n  }\n})], re.prototype, \"type\", void 0), e([h(A)], re.prototype, \"url\", void 0), e([h({\n  type: Number\n})], re.prototype, \"updateInterval\", void 0), e([h({\n  type: String\n})], re.prototype, \"webSocketUrl\", void 0), re = e([S(\"esri.layers.StreamLayer\")], re);\nconst te = v({\n  types: l\n});\nvar oe = re;\nexport default oe;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/layers/StreamLayer.js"],"names":["_","e","r","t","o","read","i","write","s","rendererTypes","n","webSceneRendererTypes","p","a","symbolTypesRenderer","l","d","m","u","isSome","y","MultiOriginJSONMixin","f","throwIfAbortError","c","property","h","Integer","g","reader","j","subclass","S","writer","b","createTypeReader","v","featureGeometryTypeKebabDictionary","w","I","ArcGISService","R","BlendLayer","x","OperationalLayer","T","PortalLayer","F","RefreshableLayer","D","ScaleRangeLayer","L","TemporalLayer","P","labelsVisible","U","legendEnabled","E","maxScale","O","minScale","k","popupEnabled","screenSizePerspectiveEnabled","N","url","A","J","writeTarget","W","webSceneFeatureReductionTypes","G","defineFieldProperties","q","fixRendererFields","V","fixTimeInfoFields","z","C","B","M","loadStyleRenderer","Q","H","createPopupTemplate","K","X","Y","Z","$","getLogger","ee","re","constructor","copyright","definitionExpression","displayField","elevationInfo","featureReduction","fields","fieldsIndex","geometryDefinition","geometryType","labelingInfo","maxReconnectionAttempts","maxReconnectionInterval","objectIdField","operationalLayerType","popupTemplate","purgeOptions","sourceJSON","spatialReference","WGS84","type","updateInterval","webSocketUrl","normalizeCtorArgs","load","addResolvingPromise","Promise","reject","resolve","signal","loadFromPortal","supportedTypes","catch","then","_fetchService","defaultPopupTemplate","readFeatureReduction","writeWebSceneFeatureReduction","renderer","_set","readRenderer","layerDefinition","drawingInfo","error","rendererDefinition","layer","context","defaultSymbol","types","length","te","field","typeIdField","uniqueValueInfos","map","id","symbol","writeRenderer","writeWebSceneRenderer","createQuery","returnGeometry","outFields","where","getFieldDomain","some","name","domain","getField","get","timeInfo","trackIdField","data","parsedUrl","path","query","responseType","origin","String","prototype","readOnly","json","enabled","allowNull","apiValues","source","target","value","origins","service","Number","oe"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,wBAAlB;AAA2C,OAAM,gBAAN;AAAuB,OAAOC,CAAP,MAAa,qBAAb;AAAmC,OAAM,qCAAN;AAA4C,OAAM,oCAAN;AAA2C,OAAM,oCAAN;AAA2C,OAAM,iCAAN;AAAwC,OAAM,0BAAN;AAAiC,OAAOC,CAAP,MAAa,gCAAb;AAA8C,OAAOC,CAAP,MAAa,qCAAb;AAAmD,SAAOC,IAAI,IAAIC,CAAf,EAAiBC,KAAK,IAAIC,CAA1B,QAAgC,mCAAhC;AAAoE,SAAOC,aAAa,IAAIC,CAAxB,EAA0BC,qBAAqB,IAAIC,CAAnD,QAAyD,+BAAzD;AAAyF,OAAOC,CAAP,MAAa,eAAb;AAA6B,SAAOC,mBAAmB,IAAIC,CAA9B,QAAoC,eAApC;AAAoD,OAAOC,CAAP,MAAa,kBAAb;AAAgC,OAAOC,CAAP,MAAa,mBAAb;AAAiC,OAAOC,CAAP,MAAa,mBAAb;AAAiC,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,kBAAvB;AAA0C,SAAOC,oBAAoB,IAAIC,CAA/B,QAAqC,mCAArC;AAAyE,SAAOC,iBAAiB,IAAIC,CAA5B,QAAkC,yBAAlC;AAA4D,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,gDAAzB;AAA0E,OAAM,gBAAN;AAAuB,SAAOC,OAAO,IAAIC,CAAlB,QAAwB,uCAAxB;AAAgE,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,8CAAvB;AAAsE,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,gDAAzB;AAA0E,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,8CAAvB;AAAsE,SAAOC,gBAAgB,IAAIC,CAA3B,QAAiC,mEAAjC;AAAqG,SAAOC,kCAAkC,IAAIC,CAA7C,QAAmD,kCAAnD;AAAsF,OAAOC,CAAP,MAAa,YAAb;AAA0B,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,2BAA9B;AAA0D,SAAOC,UAAU,IAAIC,CAArB,QAA2B,wBAA3B;AAAoD,SAAOC,gBAAgB,IAAIC,CAA3B,QAAiC,8BAAjC;AAAgE,SAAOC,WAAW,IAAIC,CAAtB,QAA4B,yBAA5B;AAAsD,SAAOC,gBAAgB,IAAIC,CAA3B,QAAiC,8BAAjC;AAAgE,SAAOC,eAAe,IAAIC,CAA1B,QAAgC,6BAAhC;AAA8D,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,2BAA9B;AAA0D,SAAOC,aAAa,IAAIC,CAAxB,EAA0BC,aAAa,IAAIC,CAA3C,EAA6CC,QAAQ,IAAIC,CAAzD,EAA2DC,QAAQ,IAAIC,CAAvE,EAAyEC,YAAY,IAAI9D,CAAzF,EAA2F+D,4BAA4B,IAAIC,CAA3H,EAA6HC,GAAG,IAAIC,CAApI,QAA0I,+BAA1I;AAA0K,SAAO7D,IAAI,IAAI8D,CAAf,EAAiBC,WAAW,IAAIC,CAAhC,EAAkCC,6BAA6B,IAAIC,CAAnE,QAAyE,oCAAzE;AAA8G,SAAOC,qBAAqB,IAAIC,CAAhC,QAAsC,8BAAtC;AAAqE,SAAOC,iBAAiB,IAAIC,CAA5B,EAA8BC,iBAAiB,IAAIC,CAAnD,QAAyD,yBAAzD;AAAmF,OAAOC,CAAP,MAAa,yBAAb;AAAuC,SAAOjD,MAAM,IAAIkD,CAAjB,QAAuB,2BAAvB;AAAmD,OAAOC,CAAP,MAAa,2BAAb;AAAyC,SAAOC,iBAAiB,IAAIC,CAA5B,QAAkC,oCAAlC;AAAuE,OAAOC,CAAP,MAAa,0BAAb;AAAwC,SAAOC,mBAAmB,IAAIC,CAA9B,QAAoC,0BAApC;AAA+D,OAAOC,CAAP,MAAa,qCAAb;AAAmD,OAAOC,CAAP,MAAa,iCAAb;AAA+C,OAAOC,CAAP,MAAa,uBAAb;AAAqC,MAAMC,CAAC,GAACvE,CAAC,CAACwE,SAAF,CAAY,yBAAZ,CAAR;AAAA,MAA+CC,EAAE,GAAClB,CAAC,EAAnD;AAAsD,IAAImB,EAAE,GAAC,cAAcjD,CAAC,CAACU,CAAC,CAACF,CAAC,CAACF,CAAC,CAACR,CAAC,CAACI,CAAC,CAACE,CAAC,CAACzB,CAAC,CAACiB,CAAD,CAAF,CAAF,CAAF,CAAF,CAAF,CAAF,CAAF,CAAf,CAAwC;AAACsD,EAAAA,WAAW,CAAC,GAAG5F,CAAJ,EAAM;AAAC,UAAM,GAAGA,CAAT,GAAY,KAAK6F,SAAL,GAAe,IAA3B,EAAgC,KAAKC,oBAAL,GAA0B,IAA1D,EAA+D,KAAKC,YAAL,GAAkB,IAAjF,EAAsF,KAAKC,aAAL,GAAmB,IAAzG,EAA8G,KAAKC,gBAAL,GAAsB,IAApI,EAAyI,KAAKC,MAAL,GAAY,IAArJ,EAA0J,KAAKC,WAAL,GAAiB,IAA3K,EAAgL,KAAKC,kBAAL,GAAwB,IAAxM,EAA6M,KAAKC,YAAL,GAAkB,IAA/N,EAAoO,KAAKhD,aAAL,GAAmB,CAAC,CAAxP,EAA0P,KAAKiD,YAAL,GAAkB,IAA5Q,EAAiR,KAAK/C,aAAL,GAAmB,CAAC,CAArS,EAAuS,KAAKgD,uBAAL,GAA6B,CAApU,EAAsU,KAAKC,uBAAL,GAA6B,EAAnW,EAAsW,KAAK/C,QAAL,GAAc,CAApX,EAAsX,KAAKE,QAAL,GAAc,CAApY,EAAsY,KAAK8C,aAAL,GAAmB,IAAzZ,EAA8Z,KAAKC,oBAAL,GAA0B,mBAAxb,EAA4c,KAAK7C,YAAL,GAAkB,CAAC,CAA/d,EAAie,KAAK8C,aAAL,GAAmB,IAApf,EAAyf,KAAKC,YAAL,GAAkB,IAAI7B,CAAJ,EAA3gB,EAAihB,KAAKjB,4BAAL,GAAkC,CAAC,CAApjB,EAAsjB,KAAK+C,UAAL,GAAgB,IAAtkB,EAA2kB,KAAKC,gBAAL,GAAsBxB,CAAC,CAACyB,KAAnmB,EAAymB,KAAKC,IAAL,GAAU,QAAnnB,EAA4nB,KAAKhD,GAAL,GAAS,IAAroB,EAA0oB,KAAKiD,cAAL,GAAoB,GAA9pB,EAAkqB,KAAKC,YAAL,GAAkB,IAAprB;AAAyrB;;AAAAC,EAAAA,iBAAiB,CAACnH,CAAD,EAAGC,CAAH,EAAK;AAAC,WAAM,YAAU,OAAOD,CAAjB,GAAmB;AAACgE,MAAAA,GAAG,EAAChE,CAAL;AAAO,SAAGC;AAAV,KAAnB,GAAgCD,CAAtC;AAAwC;;AAAAoH,EAAAA,IAAI,CAACpH,CAAD,EAAG;AAAC,QAAG,EAAE,eAAcgB,CAAhB,CAAH,EAAsB,OAAO,KAAKqG,mBAAL,CAAyBC,OAAO,CAACC,MAAR,CAAe,IAAIxG,CAAJ,CAAM,oCAAN,EAA2C,qHAA3C,CAAf,CAAzB,GAA4MuG,OAAO,CAACE,OAAR,CAAgB,IAAhB,CAAnN;AAAyO,UAAMvH,CAAC,GAACkB,CAAC,CAACnB,CAAD,CAAD,GAAKA,CAAC,CAACyH,MAAP,GAAc,IAAtB;AAA2B,WAAO,KAAKJ,mBAAL,CAAyB,KAAKK,cAAL,CAAoB;AAACC,MAAAA,cAAc,EAAC,CAAC,gBAAD,EAAkB,MAAlB;AAAhB,KAApB,EAA+D3H,CAA/D,EAAkE4H,KAAlE,CAAwErG,CAAxE,EAA2EsG,IAA3E,CAAiF,MAAI,KAAKC,aAAL,CAAmB7H,CAAnB,CAArF,CAAzB,GAAuIqH,OAAO,CAACE,OAAR,CAAgB,IAAhB,CAA9I;AAAoK;;AAAwB,MAApBO,oBAAoB,GAAE;AAAC,WAAO,KAAK5C,mBAAL,EAAP;AAAkC;;AAAA6C,EAAAA,oBAAoB,CAAChI,CAAD,EAAGC,CAAH,EAAK;AAAC,WAAOiE,CAAC,CAAClE,CAAD,EAAGC,CAAH,CAAR;AAAc;;AAAAgI,EAAAA,6BAA6B,CAACjI,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOC,CAAP,EAAS;AAACiE,IAAAA,CAAC,CAACpE,CAAD,EAAGC,CAAH,EAAK,kCAAL,EAAwCE,CAAxC,CAAD;AAA4C;;AAAY,MAAR+H,QAAQ,CAAClI,CAAD,EAAG;AAAC0E,IAAAA,CAAC,CAAC1E,CAAD,EAAG,KAAKmG,WAAR,CAAD,EAAsB,KAAKgC,IAAL,CAAU,UAAV,EAAqBnI,CAArB,CAAtB;AAA8C;;AAAAoI,EAAAA,YAAY,CAACpI,CAAD,EAAGC,CAAH,EAAKM,CAAL,EAAO;AAAC,UAAME,CAAC,GAAC,CAACR,CAAC,GAACA,CAAC,CAACoI,eAAF,IAAmBpI,CAAtB,EAAyBqI,WAAzB,IAAsCrI,CAAC,CAACqI,WAAF,CAAcJ,QAApD,IAA8D,KAAK,CAA3E;;AAA6E,QAAGzH,CAAH,EAAK;AAAC,YAAMT,CAAC,GAACK,CAAC,CAACI,CAAD,EAAGR,CAAH,EAAKM,CAAL,CAAD,IAAU,KAAK,CAAvB;AAAyB,aAAOP,CAAC,IAAEwF,CAAC,CAAC+C,KAAF,CAAQ,2BAAR,EAAoC;AAACC,QAAAA,kBAAkB,EAACvI,CAAC,CAACqI,WAAF,CAAcJ,QAAlC;AAA2CO,QAAAA,KAAK,EAAC,IAAjD;AAAsDC,QAAAA,OAAO,EAACnI;AAA9D,OAApC,CAAH,EAAyGP,CAAhH;AAAkH;;AAAA,QAAGC,CAAC,CAAC0I,aAAL,EAAmB,OAAO1I,CAAC,CAAC2I,KAAF,IAAS3I,CAAC,CAAC2I,KAAF,CAAQC,MAAjB,GAAwB,IAAI1I,CAAJ,CAAM;AAACwI,MAAAA,aAAa,EAACG,EAAE,CAAC7I,CAAC,CAAC0I,aAAH,EAAiB1I,CAAjB,EAAmBM,CAAnB,CAAjB;AAAuCwI,MAAAA,KAAK,EAAC9I,CAAC,CAAC+I,WAA/C;AAA2DC,MAAAA,gBAAgB,EAAChJ,CAAC,CAAC2I,KAAF,CAAQM,GAAR,CAAalJ,CAAC,KAAG;AAACmJ,QAAAA,EAAE,EAACnJ,CAAC,CAACmJ,EAAN;AAASC,QAAAA,MAAM,EAACN,EAAE,CAAC9I,CAAC,CAACoJ,MAAH,EAAUpJ,CAAV,EAAYO,CAAZ;AAAlB,OAAH,CAAd;AAA5E,KAAN,CAAxB,GAAkK,IAAIL,CAAJ,CAAM;AAACkJ,MAAAA,MAAM,EAACN,EAAE,CAAC7I,CAAC,CAAC0I,aAAH,EAAiB1I,CAAjB,EAAmBM,CAAnB;AAAV,KAAN,CAAzK;AAAiN;;AAAA8I,EAAAA,aAAa,CAACrJ,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOC,CAAP,EAAS;AAACI,IAAAA,CAAC,CAACP,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOC,CAAP,CAAD;AAAW;;AAAAmJ,EAAAA,qBAAqB,CAACtJ,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOC,CAAP,EAAS;AAACI,IAAAA,CAAC,CAACP,CAAD,EAAGC,CAAH,EAAK,sCAAL,EAA4CE,CAA5C,CAAD;AAAgD;;AAAAgF,EAAAA,mBAAmB,CAACnF,CAAD,EAAG;AAAC,WAAOoF,CAAC,CAAC,IAAD,EAAMpF,CAAN,CAAR;AAAiB;;AAAAuJ,EAAAA,WAAW,GAAE;AAAC,UAAMvJ,CAAC,GAAC,IAAIkF,CAAJ,EAAR;AAAc,WAAOlF,CAAC,CAACwJ,cAAF,GAAiB,CAAC,CAAlB,EAAoBxJ,CAAC,CAACyJ,SAAF,GAAY,CAAC,GAAD,CAAhC,EAAsCzJ,CAAC,CAAC0J,KAAF,GAAQ,KAAK5D,oBAAL,IAA2B,KAAzE,EAA+E9F,CAAtF;AAAwF;;AAAA2J,EAAAA,cAAc,CAAC3J,CAAD,EAAGC,CAAH,EAAK;AAAC,QAAG,CAAC,KAAKiG,MAAT,EAAgB,OAAO,IAAP;AAAY,QAAIhG,CAAC,GAAC,IAAN;AAAW,WAAO,KAAKgG,MAAL,CAAY0D,IAAZ,CAAkB3J,CAAC,KAAGA,CAAC,CAAC4J,IAAF,KAAS7J,CAAT,KAAaE,CAAC,GAACD,CAAC,CAAC6J,MAAjB,GAAyB,CAAC,CAAC5J,CAA9B,CAAnB,GAAsDA,CAA7D;AAA+D;;AAAA6J,EAAAA,QAAQ,CAAC/J,CAAD,EAAG;AAAC,WAAO,KAAKmG,WAAL,CAAiB6D,GAAjB,CAAqBhK,CAArB,CAAP;AAA+B;;AAAmB,QAAb8H,aAAa,CAAC9H,CAAD,EAAG;AAAC,QAAIC,CAAJ;;AAAM,QAAG,CAAC,CAAC,KAAKiH,YAAV,EAAuB;AAAC,UAAIhH,CAAJ;AAAM,UAAG,SAAOA,CAAC,GAAC,KAAK+J,QAAd,KAAyB,CAAC/J,CAAC,CAACgK,YAA/B,EAA4C,MAAM,IAAInJ,CAAJ,CAAM,+BAAN,EAAsC,kDAAtC,CAAN;AAAgG,UAAG,CAAC,KAAK0F,aAAT,EAAuB,MAAM,IAAI1F,CAAJ,CAAM,+BAAN,EAAsC,mDAAtC,CAAN;AAAiG,UAAG,CAAC,KAAKmF,MAAT,EAAgB,MAAM,IAAInF,CAAJ,CAAM,+BAAN,EAAsC,4CAAtC,CAAN;AAA0F,UAAG,CAAC,KAAKsF,YAAT,EAAsB,MAAM,IAAItF,CAAJ,CAAM,+BAAN,EAAsC,kDAAtC,CAAN;AAAgG,WAAKiD,GAAL,GAAS,KAAKkD,YAAd;AAA2B,KAA7hB,MAAkiB,IAAG,CAAC,KAAKL,UAAT,EAAoB;AAAC,YAAK;AAACsD,QAAAA,IAAI,EAAClK;AAAN,UAAS,MAAMW,CAAC,CAAC,KAAKwJ,SAAL,CAAeC,IAAhB,EAAqB;AAACC,QAAAA,KAAK,EAAC;AAACjJ,UAAAA,CAAC,EAAC,MAAH;AAAU,aAAG,KAAK+I,SAAL,CAAeE;AAA5B,SAAP;AAA0CC,QAAAA,YAAY,EAAC,MAAvD;AAA8D9C,QAAAA,MAAM,EAACzH;AAArE,OAArB,CAArB;AAAmH,WAAK6G,UAAL,GAAgB5G,CAAhB;AAAkB;;AAAA,WAAO,KAAK4G,UAAL,GAAgB,EAAC,IAAG,SAAO5G,CAAC,GAAC,KAAK4G,UAAd,IAA0B5G,CAA1B,GAA4B,EAA/B,CAAD;AAAmCwG,MAAAA,aAAa,EAAC;AAAjD,KAAhB,EAAuF,KAAKrG,IAAL,CAAU,KAAKyG,UAAf,EAA0B;AAAC2D,MAAAA,MAAM,EAAC,SAAR;AAAkBxG,MAAAA,GAAG,EAAC,KAAKoG;AAA3B,KAA1B,CAAvF,EAAwJ1F,CAAC,CAAC,KAAKwD,QAAN,EAAe,KAAK/B,WAApB,CAAzJ,EAA0LvB,CAAC,CAAC,KAAKqF,QAAN,EAAe,KAAK9D,WAApB,CAA3L,EAA4NlB,CAAC,CAAC,IAAD,EAAM;AAACuF,MAAAA,MAAM,EAAC;AAAR,KAAN,CAApO;AAA8P;;AAAtyG,CAA/C;AAAu1GxK,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAACyD;AAAN,CAAD,CAAF,CAAD,EAAoB9E,EAAE,CAAC+E,SAAvB,EAAiC,WAAjC,EAA6C,KAAK,CAAlD,CAAD,EAAsD1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACkJ,EAAAA,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoBhF,EAAE,CAAC+E,SAAvB,EAAiC,sBAAjC,EAAwD,IAAxD,CAAvD,EAAqH1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAACyD,MAAN;AAAaG,EAAAA,IAAI,EAAC;AAACf,IAAAA,IAAI,EAAC,sCAAN;AAA6CvJ,IAAAA,KAAK,EAAC;AAACuK,MAAAA,OAAO,EAAC,CAAC,CAAV;AAAYC,MAAAA,SAAS,EAAC,CAAC;AAAvB;AAAnD;AAAlB,CAAD,CAAF,CAAD,EAAuGnF,EAAE,CAAC+E,SAA1G,EAAoH,sBAApH,EAA2I,KAAK,CAAhJ,CAAtH,EAAyQ1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAACyD;AAAN,CAAD,CAAF,CAAD,EAAoB9E,EAAE,CAAC+E,SAAvB,EAAiC,cAAjC,EAAgD,KAAK,CAArD,CAA1Q,EAAkU1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAAC3B;AAAN,CAAD,CAAF,CAAD,EAAeM,EAAE,CAAC+E,SAAlB,EAA4B,eAA5B,EAA4C,KAAK,CAAjD,CAAnU,EAAuX1K,CAAC,CAAC,CAAC6B,CAAC,CAAC,kBAAD,EAAoB,CAAC,kCAAD,CAApB,CAAF,CAAD,EAA8D8D,EAAE,CAAC+E,SAAjE,EAA2E,sBAA3E,EAAkG,IAAlG,CAAxX,EAAge1K,CAAC,CAAC,CAACiC,CAAC,CAAC,WAAD,EAAa,kBAAb,EAAgC;AAAC,sCAAmC;AAAC2G,IAAAA,KAAK,EAACtE;AAAP;AAApC,CAAhC,CAAF,CAAD,EAAoFqB,EAAE,CAAC+E,SAAvF,EAAiG,+BAAjG,EAAiI,IAAjI,CAAje,EAAwmB1K,CAAC,CAAC,CAACyB,CAAC,CAACiE,EAAE,CAACQ,MAAJ,CAAF,CAAD,EAAgBP,EAAE,CAAC+E,SAAnB,EAA6B,QAA7B,EAAsC,KAAK,CAA3C,CAAzmB,EAAupB1K,CAAC,CAAC,CAACyB,CAAC,CAACiE,EAAE,CAACS,WAAJ,CAAF,CAAD,EAAqBR,EAAE,CAAC+E,SAAxB,EAAkC,aAAlC,EAAgD,KAAK,CAArD,CAAxpB,EAAgtB1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAACzB;AAAN,CAAD,CAAF,CAAD,EAAeI,EAAE,CAAC+E,SAAlB,EAA4B,oBAA5B,EAAiD,KAAK,CAAtD,CAAjtB,EAA0wB1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAAC3E,CAAC,CAAC0I,SAAR;AAAkBH,EAAAA,IAAI,EAAC;AAACxK,IAAAA,IAAI,EAAC;AAACwB,MAAAA,MAAM,EAACS,CAAC,CAACjC;AAAV;AAAN;AAAvB,CAAD,CAAF,CAAD,EAAqDuF,EAAE,CAAC+E,SAAxD,EAAkE,cAAlE,EAAiF,KAAK,CAAtF,CAA3wB,EAAo2B1K,CAAC,CAAC,CAACyB,CAAC,CAAC6B,CAAD,CAAF,CAAD,EAAQqC,EAAE,CAAC+E,SAAX,EAAqB,eAArB,EAAqC,KAAK,CAA1C,CAAr2B,EAAk5B1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAAC,CAACnC,CAAD,CAAN;AAAU+F,EAAAA,IAAI,EAAC;AAACxK,IAAAA,IAAI,EAAC;AAAC4K,MAAAA,MAAM,EAAC,0CAAR;AAAmDpJ,MAAAA,MAAM,EAACkD;AAA1D,KAAN;AAAmExE,IAAAA,KAAK,EAAC;AAAC2K,MAAAA,MAAM,EAAC;AAAR;AAAzE;AAAf,CAAD,CAAF,CAAD,EAAoJtF,EAAE,CAAC+E,SAAvJ,EAAiK,cAAjK,EAAgL,KAAK,CAArL,CAAn5B,EAA2kC1K,CAAC,CAAC,CAACyB,CAAC,CAAC+B,CAAD,CAAF,CAAD,EAAQmC,EAAE,CAAC+E,SAAX,EAAqB,eAArB,EAAqC,KAAK,CAA1C,CAA5kC,EAAynC1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAAC,CAAC,MAAD,EAAQ,MAAR;AAAN,CAAD,CAAF,CAAD,EAA6BrB,EAAE,CAAC+E,SAAhC,EAA0C,UAA1C,EAAqD,KAAK,CAA1D,CAA1nC,EAAurC1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAACrF;AAAN,CAAD,CAAF,CAAD,EAAegE,EAAE,CAAC+E,SAAlB,EAA4B,yBAA5B,EAAsD,KAAK,CAA3D,CAAxrC,EAAsvC1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAACrF;AAAN,CAAD,CAAF,CAAD,EAAegE,EAAE,CAAC+E,SAAlB,EAA4B,yBAA5B,EAAsD,KAAK,CAA3D,CAAvvC,EAAqzC1K,CAAC,CAAC,CAACyB,CAAC,CAACiC,CAAD,CAAF,CAAD,EAAQiC,EAAE,CAAC+E,SAAX,EAAqB,UAArB,EAAgC,KAAK,CAArC,CAAtzC,EAA81C1K,CAAC,CAAC,CAACyB,CAAC,CAACmC,CAAD,CAAF,CAAD,EAAQ+B,EAAE,CAAC+E,SAAX,EAAqB,UAArB,EAAgC,KAAK,CAArC,CAA/1C,EAAu4C1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAACyD;AAAN,CAAD,CAAF,CAAD,EAAoB9E,EAAE,CAAC+E,SAAvB,EAAiC,eAAjC,EAAiD,KAAK,CAAtD,CAAx4C,EAAi8C1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACyJ,EAAAA,KAAK,EAAC,mBAAP;AAA2BlE,EAAAA,IAAI,EAAC,CAAC,mBAAD;AAAhC,CAAD,CAAF,CAAD,EAA6DrB,EAAE,CAAC+E,SAAhE,EAA0E,sBAA1E,EAAiG,KAAK,CAAtG,CAAl8C,EAA2iD1K,CAAC,CAAC,CAACyB,CAAC,CAAC1B,CAAD,CAAF,CAAD,EAAQ4F,EAAE,CAAC+E,SAAX,EAAqB,cAArB,EAAoC,KAAK,CAAzC,CAA5iD,EAAwlD1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAAC/G,CAAN;AAAQ2K,EAAAA,IAAI,EAAC;AAACxK,IAAAA,IAAI,EAAC;AAAC4K,MAAAA,MAAM,EAAC;AAAR,KAAN;AAA2B1K,IAAAA,KAAK,EAAC;AAAC2K,MAAAA,MAAM,EAAC;AAAR;AAAjC;AAAb,CAAD,CAAF,CAAD,EAA2EtF,EAAE,CAAC+E,SAA9E,EAAwF,eAAxF,EAAwG,KAAK,CAA7G,CAAzlD,EAAysD1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAACjC;AAAN,CAAD,CAAF,CAAD,EAAeY,EAAE,CAAC+E,SAAlB,EAA4B,cAA5B,EAA2C,KAAK,CAAhD,CAA1sD,EAA6vD1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACmH,EAAAA,KAAK,EAACnI,CAAP;AAASmK,EAAAA,IAAI,EAAC;AAACO,IAAAA,OAAO,EAAC;AAACC,MAAAA,OAAO,EAAC;AAAC9K,QAAAA,KAAK,EAAC;AAAC2K,UAAAA,MAAM,EAAC,sBAAR;AAA+BJ,UAAAA,OAAO,EAAC,CAAC;AAAxC;AAAP;AAAT,KAAT;AAAsEvK,IAAAA,KAAK,EAAC;AAAC2K,MAAAA,MAAM,EAAC;AAAR;AAA5E;AAAd,CAAD,CAAF,CAAD,EAAkJtF,EAAE,CAAC+E,SAArJ,EAA+J,UAA/J,EAA0K,IAA1K,CAA9vD,EAA86D1K,CAAC,CAAC,CAAC6B,CAAC,CAAC,SAAD,EAAW,UAAX,EAAsB,CAAC,sBAAD,EAAwB,eAAxB,CAAtB,CAAF,EAAkEA,CAAC,CAAC,UAAD,EAAY,CAAC,sCAAD,EAAwC,+BAAxC,CAAZ,CAAnE,CAAD,EAA2J8D,EAAE,CAAC+E,SAA9J,EAAwK,cAAxK,EAAuL,IAAvL,CAA/6D,EAA4mE1K,CAAC,CAAC,CAACiC,CAAC,CAAC,UAAD,CAAF,CAAD,EAAiB0D,EAAE,CAAC+E,SAApB,EAA8B,eAA9B,EAA8C,IAA9C,CAA7mE,EAAiqE1K,CAAC,CAAC,CAACiC,CAAC,CAAC,WAAD,EAAa,UAAb,EAAwB;AAAC,0CAAuC;AAAC2G,IAAAA,KAAK,EAACjI;AAAP;AAAxC,CAAxB,CAAF,CAAD,EAAgFgF,EAAE,CAAC+E,SAAnF,EAA6F,uBAA7F,EAAqH,IAArH,CAAlqE,EAA6xE1K,CAAC,CAAC,CAACyB,CAAC,CAACsC,CAAD,CAAF,CAAD,EAAQ4B,EAAE,CAAC+E,SAAX,EAAqB,8BAArB,EAAoD,KAAK,CAAzD,CAA9xE,EAA01E1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAAC1B,CAAN;AAAQsF,EAAAA,IAAI,EAAC;AAACO,IAAAA,OAAO,EAAC;AAACC,MAAAA,OAAO,EAAC;AAAChL,QAAAA,IAAI,EAAC;AAAC4K,UAAAA,MAAM,EAAC;AAAR;AAAN;AAAT;AAAT;AAAb,CAAD,CAAF,CAAD,EAA2ErF,EAAE,CAAC+E,SAA9E,EAAwF,kBAAxF,EAA2G,KAAK,CAAhH,CAA31E,EAA88E1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACmJ,EAAAA,IAAI,EAAC;AAACxK,IAAAA,IAAI,EAAC,CAAC;AAAP;AAAN,CAAD,CAAF,CAAD,EAAuBuF,EAAE,CAAC+E,SAA1B,EAAoC,MAApC,EAA2C,KAAK,CAAhD,CAA/8E,EAAkgF1K,CAAC,CAAC,CAACyB,CAAC,CAACwC,CAAD,CAAF,CAAD,EAAQ0B,EAAE,CAAC+E,SAAX,EAAqB,KAArB,EAA2B,KAAK,CAAhC,CAAngF,EAAsiF1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAACqE;AAAN,CAAD,CAAF,CAAD,EAAoB1F,EAAE,CAAC+E,SAAvB,EAAiC,gBAAjC,EAAkD,KAAK,CAAvD,CAAviF,EAAimF1K,CAAC,CAAC,CAACyB,CAAC,CAAC;AAACuF,EAAAA,IAAI,EAACyD;AAAN,CAAD,CAAF,CAAD,EAAoB9E,EAAE,CAAC+E,SAAvB,EAAiC,cAAjC,EAAgD,KAAK,CAArD,CAAlmF,EAA0pF/E,EAAE,GAAC3F,CAAC,CAAC,CAAC+B,CAAC,CAAC,yBAAD,CAAF,CAAD,EAAgC4D,EAAhC,CAA9pF;AAAksF,MAAMmD,EAAE,GAAC3G,CAAC,CAAC;AAACyG,EAAAA,KAAK,EAAC9H;AAAP,CAAD,CAAV;AAAsB,IAAIwK,EAAE,GAAC3F,EAAP;AAAU,eAAe2F,EAAf","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../geometry.js\";import r from\"../PopupTemplate.js\";import\"../renderers/ClassBreaksRenderer.js\";import\"../renderers/DictionaryRenderer.js\";import\"../renderers/DotDensityRenderer.js\";import\"../renderers/HeatmapRenderer.js\";import\"../renderers/Renderer.js\";import t from\"../renderers/SimpleRenderer.js\";import o from\"../renderers/UniqueValueRenderer.js\";import{read as i,write as s}from\"../renderers/support/jsonUtils.js\";import{rendererTypes as n,webSceneRendererTypes as p}from\"../renderers/support/types.js\";import a from\"../request.js\";import{symbolTypesRenderer as l}from\"../symbols.js\";import d from\"../core/Error.js\";import m from\"../core/global.js\";import u from\"../core/Logger.js\";import{isSome as y}from\"../core/maybe.js\";import{MultiOriginJSONMixin as f}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as c}from\"../core/promiseUtils.js\";import{property as h}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import{Integer as g}from\"../core/accessorSupport/ensureType.js\";import{reader as j}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as S}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as b}from\"../core/accessorSupport/decorators/writer.js\";import{createTypeReader as v}from\"../core/accessorSupport/extensions/serializableProperty/reader.js\";import{featureGeometryTypeKebabDictionary as w}from\"../geometry/support/typeUtils.js\";import I from\"./Layer.js\";import{ArcGISService as R}from\"./mixins/ArcGISService.js\";import{BlendLayer as x}from\"./mixins/BlendLayer.js\";import{OperationalLayer as T}from\"./mixins/OperationalLayer.js\";import{PortalLayer as F}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as D}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as L}from\"./mixins/ScaleRangeLayer.js\";import{TemporalLayer as P}from\"./mixins/TemporalLayer.js\";import{labelsVisible as U,legendEnabled as E,maxScale as O,minScale as k,popupEnabled as _,screenSizePerspectiveEnabled as N,url as A}from\"./support/commonProperties.js\";import{read as J,writeTarget as W,webSceneFeatureReductionTypes as G}from\"./support/featureReductionUtils.js\";import{defineFieldProperties as q}from\"./support/fieldProperties.js\";import{fixRendererFields as V,fixTimeInfoFields as z}from\"./support/fieldUtils.js\";import C from\"./support/LabelClass.js\";import{reader as B}from\"./support/labelingInfo.js\";import M from\"./support/PurgeOptions.js\";import{loadStyleRenderer as Q}from\"../renderers/support/styleUtils.js\";import H from\"../rest/support/Query.js\";import{createPopupTemplate as K}from\"../support/popupUtils.js\";import X from\"../symbols/support/ElevationInfo.js\";import Y from\"../geometry/SpatialReference.js\";import Z from\"../geometry/Extent.js\";const $=u.getLogger(\"esri.layers.StreamLayer\"),ee=q();let re=class extends(x(P(L(D(R(T(F(f(I))))))))){constructor(...e){super(...e),this.copyright=null,this.definitionExpression=null,this.displayField=null,this.elevationInfo=null,this.featureReduction=null,this.fields=null,this.fieldsIndex=null,this.geometryDefinition=null,this.geometryType=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.maxReconnectionAttempts=0,this.maxReconnectionInterval=20,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.operationalLayerType=\"ArcGISStreamLayer\",this.popupEnabled=!0,this.popupTemplate=null,this.purgeOptions=new M,this.screenSizePerspectiveEnabled=!0,this.sourceJSON=null,this.spatialReference=Y.WGS84,this.type=\"stream\",this.url=null,this.updateInterval=300,this.webSocketUrl=null}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){if(!(\"WebSocket\"in m))return this.addResolvingPromise(Promise.reject(new d(\"stream-layer:websocket-unsupported\",\"WebSocket is not supported in this browser. StreamLayer will not have real-time connection with the stream service.\"))),Promise.resolve(this);const r=y(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Stream Service\",\"Feed\"]},e).catch(c).then((()=>this._fetchService(r)))),Promise.resolve(this)}get defaultPopupTemplate(){return this.createPopupTemplate()}readFeatureReduction(e,r){return J(e,r)}writeWebSceneFeatureReduction(e,r,t,o){W(e,r,\"layerDefinition.featureReduction\",o)}set renderer(e){V(e,this.fieldsIndex),this._set(\"renderer\",e)}readRenderer(e,r,s){const n=(r=r.layerDefinition||r).drawingInfo&&r.drawingInfo.renderer||void 0;if(n){const e=i(n,r,s)||void 0;return e||$.error(\"Failed to create renderer\",{rendererDefinition:r.drawingInfo.renderer,layer:this,context:s}),e}if(r.defaultSymbol)return r.types&&r.types.length?new o({defaultSymbol:te(r.defaultSymbol,r,s),field:r.typeIdField,uniqueValueInfos:r.types.map((e=>({id:e.id,symbol:te(e.symbol,e,s)})))}):new t({symbol:te(r.defaultSymbol,r,s)})}writeRenderer(e,r,t,o){s(e,r,t,o)}writeWebSceneRenderer(e,r,t,o){s(e,r,\"layerDefinition.drawingInfo.renderer\",o)}createPopupTemplate(e){return K(this,e)}createQuery(){const e=new H;return e.returnGeometry=!0,e.outFields=[\"*\"],e.where=this.definitionExpression||\"1=1\",e}getFieldDomain(e,r){if(!this.fields)return null;let t=null;return this.fields.some((r=>(r.name===e&&(t=r.domain),!!t))),t}getField(e){return this.fieldsIndex.get(e)}async _fetchService(e){var r;if(!!this.webSocketUrl){var t;if(null==(t=this.timeInfo)||!t.trackIdField)throw new d(\"stream-layer:missing-metadata\",\"The stream layer trackIdField must be specified.\");if(!this.objectIdField)throw new d(\"stream-layer:missing-metadata\",\"The stream layer objectIdField must be specified.\");if(!this.fields)throw new d(\"stream-layer:missing-metadata\",\"The stream layer fields must be specified.\");if(!this.geometryType)throw new d(\"stream-layer:missing-metadata\",\"The stream layer geometryType must be specified.\");this.url=this.webSocketUrl}else if(!this.sourceJSON){const{data:r}=await a(this.parsedUrl.path,{query:{f:\"json\",...this.parsedUrl.query},responseType:\"json\",signal:e});this.sourceJSON=r}return this.sourceJSON={...null!=(r=this.sourceJSON)?r:{},objectIdField:\"__esri_stream_id__\"},this.read(this.sourceJSON,{origin:\"service\",url:this.parsedUrl}),V(this.renderer,this.fieldsIndex),z(this.timeInfo,this.fieldsIndex),Q(this,{origin:\"service\"})}};e([h({type:String})],re.prototype,\"copyright\",void 0),e([h({readOnly:!0})],re.prototype,\"defaultPopupTemplate\",null),e([h({type:String,json:{name:\"layerDefinition.definitionExpression\",write:{enabled:!0,allowNull:!0}}})],re.prototype,\"definitionExpression\",void 0),e([h({type:String})],re.prototype,\"displayField\",void 0),e([h({type:X})],re.prototype,\"elevationInfo\",void 0),e([j(\"featureReduction\",[\"layerDefinition.featureReduction\"])],re.prototype,\"readFeatureReduction\",null),e([b(\"web-scene\",\"featureReduction\",{\"layerDefinition.featureReduction\":{types:G}})],re.prototype,\"writeWebSceneFeatureReduction\",null),e([h(ee.fields)],re.prototype,\"fields\",void 0),e([h(ee.fieldsIndex)],re.prototype,\"fieldsIndex\",void 0),e([h({type:Z})],re.prototype,\"geometryDefinition\",void 0),e([h({type:w.apiValues,json:{read:{reader:w.read}}})],re.prototype,\"geometryType\",void 0),e([h(U)],re.prototype,\"labelsVisible\",void 0),e([h({type:[C],json:{read:{source:\"layerDefinition.drawingInfo.labelingInfo\",reader:B},write:{target:\"layerDefinition.drawingInfo.labelingInfo\"}}})],re.prototype,\"labelingInfo\",void 0),e([h(E)],re.prototype,\"legendEnabled\",void 0),e([h({type:[\"show\",\"hide\"]})],re.prototype,\"listMode\",void 0),e([h({type:g})],re.prototype,\"maxReconnectionAttempts\",void 0),e([h({type:g})],re.prototype,\"maxReconnectionInterval\",void 0),e([h(O)],re.prototype,\"maxScale\",void 0),e([h(k)],re.prototype,\"minScale\",void 0),e([h({type:String})],re.prototype,\"objectIdField\",void 0),e([h({value:\"ArcGISStreamLayer\",type:[\"ArcGISStreamLayer\"]})],re.prototype,\"operationalLayerType\",void 0),e([h(_)],re.prototype,\"popupEnabled\",void 0),e([h({type:r,json:{read:{source:\"popupInfo\"},write:{target:\"popupInfo\"}}})],re.prototype,\"popupTemplate\",void 0),e([h({type:M})],re.prototype,\"purgeOptions\",void 0),e([h({types:n,json:{origins:{service:{write:{target:\"drawingInfo.renderer\",enabled:!1}}},write:{target:\"layerDefinition.drawingInfo.renderer\"}}})],re.prototype,\"renderer\",null),e([j(\"service\",\"renderer\",[\"drawingInfo.renderer\",\"defaultSymbol\"]),j(\"renderer\",[\"layerDefinition.drawingInfo.renderer\",\"layerDefinition.defaultSymbol\"])],re.prototype,\"readRenderer\",null),e([b(\"renderer\")],re.prototype,\"writeRenderer\",null),e([b(\"web-scene\",\"renderer\",{\"layerDefinition.drawingInfo.renderer\":{types:p}})],re.prototype,\"writeWebSceneRenderer\",null),e([h(N)],re.prototype,\"screenSizePerspectiveEnabled\",void 0),e([h({type:Y,json:{origins:{service:{read:{source:\"spatialReference\"}}}}})],re.prototype,\"spatialReference\",void 0),e([h({json:{read:!1}})],re.prototype,\"type\",void 0),e([h(A)],re.prototype,\"url\",void 0),e([h({type:Number})],re.prototype,\"updateInterval\",void 0),e([h({type:String})],re.prototype,\"webSocketUrl\",void 0),re=e([S(\"esri.layers.StreamLayer\")],re);const te=v({types:l});var oe=re;export default oe;\n"]},"metadata":{},"sourceType":"module"}