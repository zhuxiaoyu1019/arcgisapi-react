{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { VertexNormal as e } from \"../attributes/VertexNormal.glsl.js\";\nimport { VertexPosition as o } from \"../attributes/VertexPosition.glsl.js\";\nimport { glsl as r } from \"../../shaderModules/interfaces.js\";\n\nfunction d(d, a) {\n  const i = d.fragment;\n  0 === a.doubleSidedMode ? i.code.add(r`vec3 _adjustDoublesided(vec3 normal) {\nreturn normal;\n}`) : 1 === a.doubleSidedMode ? (d.include(o, a), i.uniforms.add(\"uTransform_ViewFromCameraLocal_T\", \"vec3\"), i.code.add(r`vec3 _adjustDoublesided(vec3 normal) {\nvec3 viewDir = vPositionWorldCameraRelative + uTransform_ViewFromCameraLocal_T;\nreturn dot(normal, viewDir) > 0.0 ? -normal : normal;\n}`)) : 2 === a.doubleSidedMode && i.code.add(r`vec3 _adjustDoublesided(vec3 normal) {\nreturn gl_FrontFacing ? normal : -normal;\n}`), 0 === a.normalType || 1 === a.normalType ? (d.include(e, a), i.code.add(r`vec3 shadingNormalWorld() {\nreturn _adjustDoublesided(normalize(vNormalWorld));\n}\nvec3 shadingNormal_view() {\nvec3 normal = normalize(vNormalView);\nreturn gl_FrontFacing ? normal : -normal;\n}`)) : 3 === a.normalType ? (d.extensions.add(\"GL_OES_standard_derivatives\"), d.include(o, a), i.code.add(r`vec3 shadingNormalWorld() {\nreturn normalize(cross(\ndFdx(vPositionWorldCameraRelative),\ndFdy(vPositionWorldCameraRelative)\n));\n}\nvec3 shadingNormal_view() {\nreturn normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view)));\n}`)) : 2 === a.normalType && (1 === a.viewingMode ? (d.include(o, a), i.code.add(r`vec3 shadingNormalWorld() {\nreturn normalize(positionWorld());\n}`)) : 2 === a.viewingMode && i.code.add(r`vec3 shadingNormalWorld() {\nreturn vec3(0.0, 0.0, 1.0);\n}`), d.extensions.add(\"GL_OES_standard_derivatives\"), i.code.add(r`vec3 shadingNormal_view() {\nreturn normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view))).xyz;\n}`));\n}\n\nexport { d as ComputeShadingNormal };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/ComputeShadingNormal.glsl.js"],"names":["VertexNormal","e","VertexPosition","o","glsl","r","d","a","i","fragment","doubleSidedMode","code","add","include","uniforms","normalType","extensions","viewingMode","ComputeShadingNormal"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,YAAY,IAAIC,CAAvB,QAA6B,oCAA7B;AAAkE,SAAOC,cAAc,IAAIC,CAAzB,QAA+B,sCAA/B;AAAsE,SAAOC,IAAI,IAAIC,CAAf,QAAqB,mCAArB;;AAAyD,SAASC,CAAT,CAAWA,CAAX,EAAaC,CAAb,EAAe;AAAC,QAAMC,CAAC,GAACF,CAAC,CAACG,QAAV;AAAmB,QAAIF,CAAC,CAACG,eAAN,GAAsBF,CAAC,CAACG,IAAF,CAAOC,GAAP,CAAWP,CAAE;AACvQ;AACA,EAF0P,CAAtB,GAEhO,MAAIE,CAAC,CAACG,eAAN,IAAuBJ,CAAC,CAACO,OAAF,CAAUV,CAAV,EAAYI,CAAZ,GAAeC,CAAC,CAACM,QAAF,CAAWF,GAAX,CAAe,kCAAf,EAAkD,MAAlD,CAAf,EAAyEJ,CAAC,CAACG,IAAF,CAAOC,GAAP,CAAWP,CAAE;AACjH;AACA;AACA,EAHoG,CAAhG,IAGC,MAAIE,CAAC,CAACG,eAAN,IAAuBF,CAAC,CAACG,IAAF,CAAOC,GAAP,CAAWP,CAAE;AACzC;AACA,EAF4B,CALwM,EAOhO,MAAIE,CAAC,CAACQ,UAAN,IAAkB,MAAIR,CAAC,CAACQ,UAAxB,IAAoCT,CAAC,CAACO,OAAF,CAAUZ,CAAV,EAAYM,CAAZ,GAAeC,CAAC,CAACG,IAAF,CAAOC,GAAP,CAAWP,CAAE;AACpE;AACA;AACA;AACA;AACA;AACA,EANuD,CAAnD,IAMC,MAAIE,CAAC,CAACQ,UAAN,IAAkBT,CAAC,CAACU,UAAF,CAAaJ,GAAb,CAAiB,6BAAjB,GAAgDN,CAAC,CAACO,OAAF,CAAUV,CAAV,EAAYI,CAAZ,CAAhD,EAA+DC,CAAC,CAACG,IAAF,CAAOC,GAAP,CAAWP,CAAE;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EARsF,CAAjF,IAQA,MAAIE,CAAC,CAACQ,UAAN,KAAmB,MAAIR,CAAC,CAACU,WAAN,IAAmBX,CAAC,CAACO,OAAF,CAAUV,CAAV,EAAYI,CAAZ,GAAeC,CAAC,CAACG,IAAF,CAAOC,GAAP,CAAWP,CAAE;AACvE;AACA,EAF0D,CAAlC,IAEnB,MAAIE,CAAC,CAACU,WAAN,IAAmBT,CAAC,CAACG,IAAF,CAAOC,GAAP,CAAWP,CAAE;AACrC;AACA,EAFwB,CAFA,EAIpBC,CAAC,CAACU,UAAF,CAAaJ,GAAb,CAAiB,6BAAjB,CAJoB,EAI4BJ,CAAC,CAACG,IAAF,CAAOC,GAAP,CAAWP,CAAE;AACjE;AACA,EAFoD,CAJ/C,CArB+N;AA2B/N;;AAAA,SAAOC,CAAC,IAAIY,oBAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{VertexNormal as e}from\"../attributes/VertexNormal.glsl.js\";import{VertexPosition as o}from\"../attributes/VertexPosition.glsl.js\";import{glsl as r}from\"../../shaderModules/interfaces.js\";function d(d,a){const i=d.fragment;0===a.doubleSidedMode?i.code.add(r`vec3 _adjustDoublesided(vec3 normal) {\nreturn normal;\n}`):1===a.doubleSidedMode?(d.include(o,a),i.uniforms.add(\"uTransform_ViewFromCameraLocal_T\",\"vec3\"),i.code.add(r`vec3 _adjustDoublesided(vec3 normal) {\nvec3 viewDir = vPositionWorldCameraRelative + uTransform_ViewFromCameraLocal_T;\nreturn dot(normal, viewDir) > 0.0 ? -normal : normal;\n}`)):2===a.doubleSidedMode&&i.code.add(r`vec3 _adjustDoublesided(vec3 normal) {\nreturn gl_FrontFacing ? normal : -normal;\n}`),0===a.normalType||1===a.normalType?(d.include(e,a),i.code.add(r`vec3 shadingNormalWorld() {\nreturn _adjustDoublesided(normalize(vNormalWorld));\n}\nvec3 shadingNormal_view() {\nvec3 normal = normalize(vNormalView);\nreturn gl_FrontFacing ? normal : -normal;\n}`)):3===a.normalType?(d.extensions.add(\"GL_OES_standard_derivatives\"),d.include(o,a),i.code.add(r`vec3 shadingNormalWorld() {\nreturn normalize(cross(\ndFdx(vPositionWorldCameraRelative),\ndFdy(vPositionWorldCameraRelative)\n));\n}\nvec3 shadingNormal_view() {\nreturn normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view)));\n}`)):2===a.normalType&&(1===a.viewingMode?(d.include(o,a),i.code.add(r`vec3 shadingNormalWorld() {\nreturn normalize(positionWorld());\n}`)):2===a.viewingMode&&i.code.add(r`vec3 shadingNormalWorld() {\nreturn vec3(0.0, 0.0, 1.0);\n}`),d.extensions.add(\"GL_OES_standard_derivatives\"),i.code.add(r`vec3 shadingNormal_view() {\nreturn normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view))).xyz;\n}`))}export{d as ComputeShadingNormal};\n"]},"metadata":{},"sourceType":"module"}