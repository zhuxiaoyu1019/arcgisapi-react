{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../../../core/Error.js\";\nimport { get as t, isSome as s, isNone as r } from \"../../../../core/maybe.js\";\nimport { e as n } from \"../../../../chunks/earcut.js\";\nimport { a } from \"../../../../chunks/mat3.js\";\nimport { c as o } from \"../../../../chunks/mat3f64.js\";\nimport { a as i } from \"../../../../chunks/mat4.js\";\nimport { I as l, c } from \"../../../../chunks/mat4f64.js\";\nimport { g as h, n as m, s as p, f as d, c as u, m as f } from \"../../../../chunks/vec3.js\";\nimport { d as g, c as y } from \"../../../../chunks/vec3f64.js\";\nimport { computeLinearTransformation as _ } from \"../../../../geometry/projection.js\";\nimport { create as E, empty as b, expandWithBuffer as x, intersectsClippingArea as v } from \"../../../../geometry/support/aaBoundingBox.js\";\nimport { BufferViewVec3f64 as P } from \"../../../../geometry/support/buffer/BufferView.js\";\nimport { t as w, a as A } from \"../../../../chunks/vec32.js\";\nimport { getDriverAxisSizeValue as j } from \"../../../../renderers/support/renderingInfoUtils.js\";\nimport { needsElevationUpdates3D as L, evaluateElevationAlignmentAtPoint as S } from \"./elevationAlignmentUtils.js\";\nimport { ElevationContext as B } from \"./ElevationContext.js\";\nimport { Graphics3DObject3DGraphicLayer as C } from \"./Graphics3DObject3DGraphicLayer.js\";\nimport { Graphics3DSymbolLayer as M } from \"./Graphics3DSymbolLayer.js\";\nimport { validateSymbolLayerSize as R, computeCentroid as z } from \"./graphicUtils.js\";\nimport { geometryAsPolygon as G, geometryToRenderInfo as D } from \"./polygonUtils.js\";\nimport { createMaterial as I } from \"../support/edgeUtils.js\";\nimport T from \"../../support/debugFlags.js\";\nimport { SamplePosition as U } from \"../../support/ElevationProvider.js\";\nimport { Geometry as V } from \"../../webgl-engine/lib/Geometry.js\";\nimport { Object3D as O } from \"../../webgl-engine/lib/Object3D.js\";\nimport { DefaultMaterial as k } from \"../../webgl-engine/materials/DefaultMaterial.js\";\nconst F = [\"polygon\", \"extent\"];\n\nclass N extends M {\n  constructor(e, t, s, r) {\n    super(e, t, s, r), this.ensureDrapedStatus(!1);\n  }\n\n  async doLoad() {\n    if (!this._drivenProperties.size) {\n      const t = R(this._getSymbolSize());\n      if (t) throw new e(\"graphics3dextrudesymbollayer:invalid-size\", t);\n    }\n\n    const s = t(this.symbolLayer, \"material\", \"color\"),\n          r = this._getCombinedOpacityAndColor(s),\n          n = g(r),\n          a = r[3],\n          o = a < 1 || this.needsDrivenTransparentPass,\n          i = {\n      usePBR: this._context.physicalBasedRenderingEnabled,\n      isSchematic: !0,\n      diffuse: n,\n      ambient: n,\n      opacity: a,\n      transparent: o,\n      cullFace: o ? 0 : 2,\n      vertexColors: !0,\n      slicePlaneEnabled: this._context.slicePlaneEnabled,\n      castShadows: this.symbolLayer.castShadows,\n      offsetTransparentBackfaces: !0\n    };\n\n    this._material = new k(i), this._bottomMaterial = new k({ ...i,\n      cullFace: 2\n    }), this._context.stage.add(this._material), this._context.stage.add(this._bottomMaterial);\n  }\n\n  destroy() {\n    super.destroy(), this._material && (this._context.stage.remove(this._material), this._context.stage.remove(this._bottomMaterial));\n  }\n\n  createGraphics3DGraphic(e) {\n    const t = e.graphic;\n    if (!this._validateGeometry(t.geometry, F, this.symbolLayer.type)) return null;\n\n    const s = this._getVertexOpacityAndColor(e.renderingInfo, 255),\n          r = this.setGraphicElevationContext(t, new B());\n\n    return this._createAs3DShape(t, e.renderingInfo, s, r, t.uid);\n  }\n\n  layerOpacityChanged(e, r) {\n    const n = t(this.symbolLayer, \"material\", \"color\"),\n          a = this._getCombinedOpacity(n),\n          o = a < 1 || this.needsDrivenTransparentPass;\n\n    this._material.setParameterValues({\n      opacity: a,\n      transparent: o\n    }), this._bottomMaterial.setParameterValues({\n      opacity: a,\n      transparent: o\n    });\n\n    const i = this._getLayerOpacity();\n\n    return e.forEach(e => {\n      const t = r(e);\n      s(t) && t.layerOpacityChanged(i, this._context.isAsync);\n    }), !0;\n  }\n\n  layerElevationInfoChanged(e, t) {\n    return this.updateGraphics3DGraphicElevationInfo(e, t, L);\n  }\n\n  slicePlaneEnabledChanged(e, t) {\n    return this._material.setParameterValues({\n      slicePlaneEnabled: this._context.slicePlaneEnabled\n    }), this._bottomMaterial.setParameterValues({\n      slicePlaneEnabled: this._context.slicePlaneEnabled\n    }), e.forEach(e => {\n      const r = t(e);\n      s(r) && r.slicePlaneEnabledChanged(this._context.slicePlaneEnabled, this._context.isAsync);\n    }), !0;\n  }\n\n  physicalBasedRenderingChanged() {\n    return this._material.setParameterValues({\n      usePBR: this._context.physicalBasedRenderingEnabled,\n      isSchematic: !0\n    }), this._bottomMaterial.setParameterValues({\n      usePBR: this._context.physicalBasedRenderingEnabled,\n      isSchematic: !0\n    }), !0;\n  }\n\n  pixelRatioChanged() {\n    return !0;\n  }\n\n  _getExtrusionSize(e) {\n    let t;\n    var s;\n    e.size && this._drivenProperties.size ? t = null != (s = j(e.size, 2)) ? s : 0 : t = this._getSymbolSize();\n    return t /= this._context.renderCoordsHelper.unitInMeters, t;\n  }\n\n  _getSymbolSize() {\n    var e;\n    return null != (e = this.symbolLayer.size) ? e : 1;\n  }\n\n  _createAs3DShape(e, t, h, m, p) {\n    const d = G(e.geometry);\n    if (r(d)) return null;\n    const u = D(d, this._context.elevationProvider, this._context.renderCoordsHelper, m);\n    if (this._logGeometryCreationWarnings(u, d.rings, \"rings\", \"ExtrudeSymbol3DLayer\"), 0 === d.rings.length || !d.rings.some(e => e.length > 0)) return null;\n    const f = z(d);\n    if (r(f)) return null;\n    const g = new Array(),\n          j = new Array(),\n          S = new Array(),\n          B = E(),\n          M = c(),\n          R = y(),\n          T = 1 === this._context.renderCoordsHelper.viewingMode;\n    T || this._context.renderCoordsHelper.worldUpAtPosition(null, R), _(d.spatialReference, [f.x, f.y, 0], M, this._context.renderCoordsHelper.spatialReference);\n    const U = c();\n    i(U, M);\n    const V = o();\n    a(V, U);\n    const {\n      polygons: k,\n      mapPosition: F,\n      position: N\n    } = u,\n          Y = N.length / 3,\n          W = new Float64Array(3 * Y * 6),\n          q = new Float64Array(3 * Y * 6),\n          J = new Float64Array(3 * Y * 6),\n          K = new Float64Array(1 * Y * 6);\n    let Q = 0;\n\n    for (let s = 0; s < k.length; ++s) {\n      const e = k[s],\n            r = e.count;\n      if (this._context.clippingExtent && (b(B), x(B, e.mapPosition), !v(B, this._context.clippingExtent))) continue;\n      const a = n(e.mapPosition, e.holeIndices, 3);\n      if (0 === a.length) continue;\n\n      const o = 3 * r * 2 + a.length,\n            i = new Uint32Array(o),\n            c = new Uint32Array(a.length),\n            m = 6 * r,\n            p = 3 * W.BYTES_PER_ELEMENT,\n            d = new P(W.buffer, Q * p, p, (Q + m) * p),\n            u = 3 * q.BYTES_PER_ELEMENT,\n            f = new P(q.buffer, Q * u, u, (Q + m) * u),\n            y = new Float64Array(J.buffer, 3 * Q * J.BYTES_PER_ELEMENT, 3 * m),\n            _ = new Float64Array(K.buffer, 1 * Q * K.BYTES_PER_ELEMENT, 1 * m),\n            E = this._getExtrusionSize(t);\n\n      H(N, F, a, e, d.typedBuffer, y, f.typedBuffer, _, 0, i, c, E, R, T), w(d, d, U), A(f, f, V), Q += 6 * r;\n\n      const L = this._createExtrudeGeometry(i, i.length - c.length, {\n        positions: d.typedBuffer,\n        elevation: y,\n        normals: f.typedBuffer,\n        heights: _\n      }, h);\n\n      g.push(L), j.push(this._material), S.push(l);\n\n      const C = this._createExtrudeGeometry(c, 0, {\n        positions: d.typedBuffer,\n        elevation: y,\n        normals: f.typedBuffer,\n        heights: _\n      }, h);\n\n      g.push(C), j.push(this._bottomMaterial), S.push(l);\n    }\n\n    if (0 === g.length) return null;\n    const X = new O({\n      geometries: g,\n      materials: j,\n      transformations: S,\n      metadata: {\n        layerUid: this._context.layer.uid,\n        graphicUid: p,\n        isElevationSource: !0\n      }\n    });\n    X.transformation = M;\n    const Z = se,\n          $ = I(this.symbolLayer, {\n      opacity: this._getLayerOpacity()\n    }),\n          ee = s($) ? {\n      baseMaterial: this._material,\n      edgeMaterials: [$],\n      properties: {\n        mergeGeometries: !0,\n        slicePlaneEnabled: this._context.slicePlaneEnabled\n      }\n    } : null,\n          te = new C(this, X, g, null, null, Z, m, ee);\n    return te.alignedSampledElevation = u.sampledElevation, te.needsElevationUpdates = L(m.mode), te;\n  }\n\n  _createExtrudeGeometry(e, t, s, r) {\n    const n = new Uint32Array(e.length),\n          a = [[\"position\", {\n      size: 3,\n      data: s.positions,\n      exclusive: !0\n    }], [\"normal\", {\n      size: 3,\n      data: s.normals,\n      exclusive: !0\n    }], [\"color\", {\n      size: 4,\n      data: r,\n      exclusive: !0\n    }], [\"size\", {\n      size: 1,\n      data: s.heights,\n      exclusive: !0\n    }]],\n          o = [[\"position\", e], [\"normal\", e], [\"color\", n]];\n    return s.elevation && (a.push([\"mapPos\", {\n      size: 3,\n      data: s.elevation\n    }]), o.push([\"mapPos\", e])), new V(a, o, 0, t);\n  }\n\n}\n\nfunction H(e, t, s, r, n, a, o, i, l, c, h, m, p, d) {\n  const u = s.length / 3;\n  let f = 0,\n      g = 2 * r.count;\n  Y(e, t, r.index, r.count, s, 0, u, n, a, o, i, l, c, h, g, m, p, d), l += 2 * r.count, g = 0, J(n, a, i, o, f, r.pathLengths[0], r.count, l, c, g, m), l += 4 * r.pathLengths[0], g += 2 * r.pathLengths[0], f += r.pathLengths[0];\n\n  for (let y = 1; y < r.pathLengths.length; ++y) J(n, a, i, o, f, r.pathLengths[y], r.count, l, c, g, m), l += 4 * r.pathLengths[y], g += 2 * r.pathLengths[y], f += r.pathLengths[y];\n}\n\nfunction Y(e, t, s, r, n, a, o, i, l, c, p, d, u, f, g, y, _, E) {\n  h(ne, _);\n  const b = y > 0 ? 1 : -1;\n  let x = 3 * s,\n      v = d,\n      P = 3 * v,\n      w = d + r,\n      A = 3 * w;\n\n  for (let h = 0; h < r; ++h) E && (ne[0] = e[x + 0], ne[1] = e[x + 1], ne[2] = e[x + 2], m(ne, ne)), i[P + 0] = e[x + 0], i[P + 1] = e[x + 1], i[P + 2] = e[x + 2], l[P + 0] = t[x + 0], l[P + 1] = t[x + 1], l[P + 2] = t[x + 2], c[P + 0] = -b * ne[0], c[P + 1] = -b * ne[1], c[P + 2] = -b * ne[2], p[v] = 0, i[A + 0] = e[x + 0] + y * ne[0], i[A + 1] = e[x + 1] + y * ne[1], i[A + 2] = e[x + 2] + y * ne[2], l[A + 0] = t[x + 0], l[A + 1] = t[x + 1], l[A + 2] = t[x + 2], c[A + 0] = b * ne[0], c[A + 1] = b * ne[1], c[A + 2] = b * ne[2], p[w] = y, P += 3, A += 3, x += 3, v += 1, w += 1;\n\n  x = 3 * a, P = 0, A = 3 * g;\n  const j = y < 0 ? oe : ae,\n        L = y < 0 ? ae : oe;\n\n  for (let h = 0; h < o; ++h) f[P + 0] = n[x + j[0]], f[P + 1] = n[x + j[1]], f[P + 2] = n[x + j[2]], u[A + 0] = n[x + L[0]] + r, u[A + 1] = n[x + L[1]] + r, u[A + 2] = n[x + L[2]] + r, P += 3, A += 3, x += 3;\n}\n\nfunction W(e, t, s, r, n, a, o) {\n  r[a] = r[o], o *= 3, e[(a *= 3) + 0] = e[o + 0], e[a + 1] = e[o + 1], e[a + 2] = e[o + 2], t[a + 0] = t[o + 0], t[a + 1] = t[o + 1], t[a + 2] = t[o + 2], s[a + 0] = n[0], s[a + 1] = n[1], s[a + 2] = n[2];\n}\n\nconst q = y();\n\nfunction J(e, t, s, r, n, a, o, i, l, c, h) {\n  let m = n,\n      p = n + 1,\n      d = n + o,\n      u = n + o + 1,\n      f = i,\n      g = i + 1,\n      y = i + 2 * a,\n      _ = i + 2 * a + 1;\n\n  h < 0 && (m = n + o + 1, u = n), c *= 3;\n\n  for (let E = 0; E < a; ++E) E === a - 1 && (h > 0 ? (p = n, u = n + o) : (p = n, m = n + o)), ee(e, m, p, d, q), W(e, t, r, s, q, f, m), W(e, t, r, s, q, g, p), W(e, t, r, s, q, y, d), W(e, t, r, s, q, _, u), l[c++] = f, l[c++] = y, l[c++] = _, l[c++] = f, l[c++] = _, l[c++] = g, m++, p++, d++, u++, f += 2, g += 2, y += 2, _ += 2;\n}\n\nconst K = y(),\n      Q = y(),\n      X = y(),\n      Z = y(),\n      $ = y();\n\nfunction ee(e, t, s, r, n) {\n  t *= 3, s *= 3, r *= 3, p(K, e[t++], e[t++], e[t++]), p(Q, e[s++], e[s++], e[s++]), p(X, e[r++], e[r++], e[r++]), d(Z, Q, K), d($, X, K), u(n, $, Z), m(n, n);\n}\n\nconst te = y();\n\nfunction se(e, t, s, r) {\n  const n = e.stageObject,\n        a = n.geometryRecords,\n        o = a.length,\n        l = \"absolute-height\" !== t.mode;\n  let h = 0;\n  const m = n.transformation,\n        d = i(c(), m);\n\n  for (let i = 0; i < o; i += 2) {\n    const e = a[i].geometry,\n          o = e.getMutableAttribute(\"position\").data,\n          c = e.vertexAttributes.get(\"size\").data,\n          u = e.vertexAttributes.get(\"mapPos\").data,\n          g = new U(u),\n          y = o.length / 3;\n    let _ = 0,\n        E = !1,\n        b = 0;\n    const x = s.spatialReference;\n\n    for (let n = 0; n < y; n++) {\n      te[0] = o[_], te[1] = o[_ + 1], te[2] = o[_ + 2];\n      const e = S(g, s, t, r, l ? le : null);\n      l && (b += le.sampledElevation), T.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES ? (p(re, g.array[g.offset + 0], g.array[g.offset + 1], e + c[_ / 3]), r.toRenderCoords(re, x, re), f(re, re, d)) : (p(re, o[_ + 0], o[_ + 1], o[_ + 2]), f(re, re, m), r.setAltitude(re, e + c[_ / 3]), f(re, re, d)), o[_] = re[0], o[_ + 1] = re[1], o[_ + 2] = re[2];\n      const n = ie / r.unitInMeters;\n      (Math.abs(te[0] - o[_]) >= n || Math.abs(te[1] - o[_ + 1]) >= n || Math.abs(te[2] - o[_ + 2]) >= n) && (E = !0), g.offset += 3, _ += 3;\n    }\n\n    E && (e.invalidateBoundingInfo(), n.geometryVertexAttrsUpdated(i), a[i + 1].geometry.invalidateBoundingInfo(), n.geometryVertexAttrsUpdated(i + 1)), h += b / y;\n  }\n\n  return h / o;\n}\n\nconst re = y(),\n      ne = y(),\n      ae = [0, 2, 1],\n      oe = [0, 1, 2],\n      ie = .01,\n      le = {\n  verticalDistanceToGround: 0,\n  sampledElevation: 0\n};\nexport default N;\nexport { N as Graphics3DExtrudeSymbolLayer };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DExtrudeSymbolLayer.js"],"names":["e","get","t","isSome","s","isNone","r","n","a","c","o","i","I","l","g","h","m","p","f","d","u","y","computeLinearTransformation","_","create","E","empty","b","expandWithBuffer","x","intersectsClippingArea","v","BufferViewVec3f64","P","w","A","getDriverAxisSizeValue","j","needsElevationUpdates3D","L","evaluateElevationAlignmentAtPoint","S","ElevationContext","B","Graphics3DObject3DGraphicLayer","C","Graphics3DSymbolLayer","M","validateSymbolLayerSize","R","computeCentroid","z","geometryAsPolygon","G","geometryToRenderInfo","D","createMaterial","T","SamplePosition","U","Geometry","V","Object3D","O","DefaultMaterial","k","F","N","constructor","ensureDrapedStatus","doLoad","_drivenProperties","size","_getSymbolSize","symbolLayer","_getCombinedOpacityAndColor","needsDrivenTransparentPass","usePBR","_context","physicalBasedRenderingEnabled","isSchematic","diffuse","ambient","opacity","transparent","cullFace","vertexColors","slicePlaneEnabled","castShadows","offsetTransparentBackfaces","_material","_bottomMaterial","stage","add","destroy","remove","createGraphics3DGraphic","graphic","_validateGeometry","geometry","type","_getVertexOpacityAndColor","renderingInfo","setGraphicElevationContext","_createAs3DShape","uid","layerOpacityChanged","_getCombinedOpacity","setParameterValues","_getLayerOpacity","forEach","isAsync","layerElevationInfoChanged","updateGraphics3DGraphicElevationInfo","slicePlaneEnabledChanged","physicalBasedRenderingChanged","pixelRatioChanged","_getExtrusionSize","renderCoordsHelper","unitInMeters","elevationProvider","_logGeometryCreationWarnings","rings","length","some","Array","viewingMode","worldUpAtPosition","spatialReference","polygons","mapPosition","position","Y","W","Float64Array","q","J","K","Q","count","clippingExtent","holeIndices","Uint32Array","BYTES_PER_ELEMENT","buffer","H","typedBuffer","_createExtrudeGeometry","positions","elevation","normals","heights","push","X","geometries","materials","transformations","metadata","layerUid","layer","graphicUid","isElevationSource","transformation","Z","se","$","ee","baseMaterial","edgeMaterials","properties","mergeGeometries","te","alignedSampledElevation","sampledElevation","needsElevationUpdates","mode","data","exclusive","index","pathLengths","ne","oe","ae","stageObject","geometryRecords","getMutableAttribute","vertexAttributes","le","DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES","re","array","offset","toRenderCoords","setAltitude","ie","Math","abs","invalidateBoundingInfo","geometryVertexAttrsUpdated","verticalDistanceToGround","Graphics3DExtrudeSymbolLayer"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAa,2BAAb;AAAyC,SAAOC,GAAG,IAAIC,CAAd,EAAgBC,MAAM,IAAIC,CAA1B,EAA4BC,MAAM,IAAIC,CAAtC,QAA4C,2BAA5C;AAAwE,SAAON,CAAC,IAAIO,CAAZ,QAAkB,8BAAlB;AAAiD,SAAOC,CAAP,QAAa,4BAAb;AAA0C,SAAOC,CAAC,IAAIC,CAAZ,QAAkB,+BAAlB;AAAkD,SAAOF,CAAC,IAAIG,CAAZ,QAAkB,4BAAlB;AAA+C,SAAOC,CAAC,IAAIC,CAAZ,EAAcJ,CAAd,QAAoB,+BAApB;AAAoD,SAAOK,CAAC,IAAIC,CAAZ,EAAcR,CAAC,IAAIS,CAAnB,EAAqBZ,CAAC,IAAIa,CAA1B,EAA4BC,CAAC,IAAIC,CAAjC,EAAmCV,CAAC,IAAIW,CAAxC,EAA0CJ,CAAC,IAAIE,CAA/C,QAAqD,4BAArD;AAAkF,SAAOC,CAAC,IAAIL,CAAZ,EAAcL,CAAC,IAAIY,CAAnB,QAAyB,+BAAzB;AAAyD,SAAOC,2BAA2B,IAAIC,CAAtC,QAA4C,oCAA5C;AAAiF,SAAOC,MAAM,IAAIC,CAAjB,EAAmBC,KAAK,IAAIC,CAA5B,EAA8BC,gBAAgB,IAAIC,CAAlD,EAAoDC,sBAAsB,IAAIC,CAA9E,QAAoF,+CAApF;AAAoI,SAAOC,iBAAiB,IAAIC,CAA5B,QAAkC,mDAAlC;AAAsF,SAAO/B,CAAC,IAAIgC,CAAZ,EAAc1B,CAAC,IAAI2B,CAAnB,QAAyB,6BAAzB;AAAuD,SAAOC,sBAAsB,IAAIC,CAAjC,QAAuC,qDAAvC;AAA6F,SAAOC,uBAAuB,IAAIC,CAAlC,EAAoCC,iCAAiC,IAAIC,CAAzE,QAA+E,8BAA/E;AAA8G,SAAOC,gBAAgB,IAAIC,CAA3B,QAAiC,uBAAjC;AAAyD,SAAOC,8BAA8B,IAAIC,CAAzC,QAA+C,qCAA/C;AAAqF,SAAOC,qBAAqB,IAAIC,CAAhC,QAAsC,4BAAtC;AAAmE,SAAOC,uBAAuB,IAAIC,CAAlC,EAAoCC,eAAe,IAAIC,CAAvD,QAA6D,mBAA7D;AAAiF,SAAOC,iBAAiB,IAAIC,CAA5B,EAA8BC,oBAAoB,IAAIC,CAAtD,QAA4D,mBAA5D;AAAgF,SAAOC,cAAc,IAAI5C,CAAzB,QAA+B,yBAA/B;AAAyD,OAAO6C,CAAP,MAAa,6BAAb;AAA2C,SAAOC,cAAc,IAAIC,CAAzB,QAA+B,oCAA/B;AAAoE,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,oCAAzB;AAA8D,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,oCAAzB;AAA8D,SAAOC,eAAe,IAAIC,CAA1B,QAAgC,iDAAhC;AAAkF,MAAMC,CAAC,GAAC,CAAC,SAAD,EAAW,QAAX,CAAR;;AAA6B,MAAMC,CAAN,SAAgBpB,CAAhB,CAAiB;AAACqB,EAAAA,WAAW,CAACpE,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAOE,CAAP,EAAS;AAAC,UAAMN,CAAN,EAAQE,CAAR,EAAUE,CAAV,EAAYE,CAAZ,GAAe,KAAK+D,kBAAL,CAAwB,CAAC,CAAzB,CAAf;AAA2C;;AAAY,QAANC,MAAM,GAAE;AAAC,QAAG,CAAC,KAAKC,iBAAL,CAAuBC,IAA3B,EAAgC;AAAC,YAAMtE,CAAC,GAAC+C,CAAC,CAAC,KAAKwB,cAAL,EAAD,CAAT;AAAiC,UAAGvE,CAAH,EAAK,MAAM,IAAIF,CAAJ,CAAM,2CAAN,EAAkDE,CAAlD,CAAN;AAA2D;;AAAA,UAAME,CAAC,GAACF,CAAC,CAAC,KAAKwE,WAAN,EAAkB,UAAlB,EAA6B,OAA7B,CAAT;AAAA,UAA+CpE,CAAC,GAAC,KAAKqE,2BAAL,CAAiCvE,CAAjC,CAAjD;AAAA,UAAqFG,CAAC,GAACO,CAAC,CAACR,CAAD,CAAxF;AAAA,UAA4FE,CAAC,GAACF,CAAC,CAAC,CAAD,CAA/F;AAAA,UAAmGI,CAAC,GAACF,CAAC,GAAC,CAAF,IAAK,KAAKoE,0BAA/G;AAAA,UAA0IjE,CAAC,GAAC;AAACkE,MAAAA,MAAM,EAAC,KAAKC,QAAL,CAAcC,6BAAtB;AAAoDC,MAAAA,WAAW,EAAC,CAAC,CAAjE;AAAmEC,MAAAA,OAAO,EAAC1E,CAA3E;AAA6E2E,MAAAA,OAAO,EAAC3E,CAArF;AAAuF4E,MAAAA,OAAO,EAAC3E,CAA/F;AAAiG4E,MAAAA,WAAW,EAAC1E,CAA7G;AAA+G2E,MAAAA,QAAQ,EAAC3E,CAAC,GAAC,CAAD,GAAG,CAA5H;AAA8H4E,MAAAA,YAAY,EAAC,CAAC,CAA5I;AAA8IC,MAAAA,iBAAiB,EAAC,KAAKT,QAAL,CAAcS,iBAA9K;AAAgMC,MAAAA,WAAW,EAAC,KAAKd,WAAL,CAAiBc,WAA7N;AAAyOC,MAAAA,0BAA0B,EAAC,CAAC;AAArQ,KAA5I;;AAAoZ,SAAKC,SAAL,GAAe,IAAIzB,CAAJ,CAAMtD,CAAN,CAAf,EAAwB,KAAKgF,eAAL,GAAqB,IAAI1B,CAAJ,CAAM,EAAC,GAAGtD,CAAJ;AAAM0E,MAAAA,QAAQ,EAAC;AAAf,KAAN,CAA7C,EAAsE,KAAKP,QAAL,CAAcc,KAAd,CAAoBC,GAApB,CAAwB,KAAKH,SAA7B,CAAtE,EAA8G,KAAKZ,QAAL,CAAcc,KAAd,CAAoBC,GAApB,CAAwB,KAAKF,eAA7B,CAA9G;AAA4J;;AAAAG,EAAAA,OAAO,GAAE;AAAC,UAAMA,OAAN,IAAgB,KAAKJ,SAAL,KAAiB,KAAKZ,QAAL,CAAcc,KAAd,CAAoBG,MAApB,CAA2B,KAAKL,SAAhC,GAA2C,KAAKZ,QAAL,CAAcc,KAAd,CAAoBG,MAApB,CAA2B,KAAKJ,eAAhC,CAA5D,CAAhB;AAA8H;;AAAAK,EAAAA,uBAAuB,CAAChG,CAAD,EAAG;AAAC,UAAME,CAAC,GAACF,CAAC,CAACiG,OAAV;AAAkB,QAAG,CAAC,KAAKC,iBAAL,CAAuBhG,CAAC,CAACiG,QAAzB,EAAkCjC,CAAlC,EAAoC,KAAKQ,WAAL,CAAiB0B,IAArD,CAAJ,EAA+D,OAAO,IAAP;;AAAY,UAAMhG,CAAC,GAAC,KAAKiG,yBAAL,CAA+BrG,CAAC,CAACsG,aAAjC,EAA+C,GAA/C,CAAR;AAAA,UAA4DhG,CAAC,GAAC,KAAKiG,0BAAL,CAAgCrG,CAAhC,EAAkC,IAAIyC,CAAJ,EAAlC,CAA9D;;AAAuG,WAAO,KAAK6D,gBAAL,CAAsBtG,CAAtB,EAAwBF,CAAC,CAACsG,aAA1B,EAAwClG,CAAxC,EAA0CE,CAA1C,EAA4CJ,CAAC,CAACuG,GAA9C,CAAP;AAA0D;;AAAAC,EAAAA,mBAAmB,CAAC1G,CAAD,EAAGM,CAAH,EAAK;AAAC,UAAMC,CAAC,GAACL,CAAC,CAAC,KAAKwE,WAAN,EAAkB,UAAlB,EAA6B,OAA7B,CAAT;AAAA,UAA+ClE,CAAC,GAAC,KAAKmG,mBAAL,CAAyBpG,CAAzB,CAAjD;AAAA,UAA6EG,CAAC,GAACF,CAAC,GAAC,CAAF,IAAK,KAAKoE,0BAAzF;;AAAoH,SAAKc,SAAL,CAAekB,kBAAf,CAAkC;AAACzB,MAAAA,OAAO,EAAC3E,CAAT;AAAW4E,MAAAA,WAAW,EAAC1E;AAAvB,KAAlC,GAA6D,KAAKiF,eAAL,CAAqBiB,kBAArB,CAAwC;AAACzB,MAAAA,OAAO,EAAC3E,CAAT;AAAW4E,MAAAA,WAAW,EAAC1E;AAAvB,KAAxC,CAA7D;;AAAgI,UAAMC,CAAC,GAAC,KAAKkG,gBAAL,EAAR;;AAAgC,WAAO7G,CAAC,CAAC8G,OAAF,CAAW9G,CAAC,IAAE;AAAC,YAAME,CAAC,GAACI,CAAC,CAACN,CAAD,CAAT;AAAaI,MAAAA,CAAC,CAACF,CAAD,CAAD,IAAMA,CAAC,CAACwG,mBAAF,CAAsB/F,CAAtB,EAAwB,KAAKmE,QAAL,CAAciC,OAAtC,CAAN;AAAqD,KAAjF,GAAoF,CAAC,CAA5F;AAA8F;;AAAAC,EAAAA,yBAAyB,CAAChH,CAAD,EAAGE,CAAH,EAAK;AAAC,WAAO,KAAK+G,oCAAL,CAA0CjH,CAA1C,EAA4CE,CAA5C,EAA8CqC,CAA9C,CAAP;AAAwD;;AAAA2E,EAAAA,wBAAwB,CAAClH,CAAD,EAAGE,CAAH,EAAK;AAAC,WAAO,KAAKwF,SAAL,CAAekB,kBAAf,CAAkC;AAACrB,MAAAA,iBAAiB,EAAC,KAAKT,QAAL,CAAcS;AAAjC,KAAlC,GAAuF,KAAKI,eAAL,CAAqBiB,kBAArB,CAAwC;AAACrB,MAAAA,iBAAiB,EAAC,KAAKT,QAAL,CAAcS;AAAjC,KAAxC,CAAvF,EAAoLvF,CAAC,CAAC8G,OAAF,CAAW9G,CAAC,IAAE;AAAC,YAAMM,CAAC,GAACJ,CAAC,CAACF,CAAD,CAAT;AAAaI,MAAAA,CAAC,CAACE,CAAD,CAAD,IAAMA,CAAC,CAAC4G,wBAAF,CAA2B,KAAKpC,QAAL,CAAcS,iBAAzC,EAA2D,KAAKT,QAAL,CAAciC,OAAzE,CAAN;AAAwF,KAApH,CAApL,EAA2S,CAAC,CAAnT;AAAqT;;AAAAI,EAAAA,6BAA6B,GAAE;AAAC,WAAO,KAAKzB,SAAL,CAAekB,kBAAf,CAAkC;AAAC/B,MAAAA,MAAM,EAAC,KAAKC,QAAL,CAAcC,6BAAtB;AAAoDC,MAAAA,WAAW,EAAC,CAAC;AAAjE,KAAlC,GAAuG,KAAKW,eAAL,CAAqBiB,kBAArB,CAAwC;AAAC/B,MAAAA,MAAM,EAAC,KAAKC,QAAL,CAAcC,6BAAtB;AAAoDC,MAAAA,WAAW,EAAC,CAAC;AAAjE,KAAxC,CAAvG,EAAoN,CAAC,CAA5N;AAA8N;;AAAAoC,EAAAA,iBAAiB,GAAE;AAAC,WAAM,CAAC,CAAP;AAAS;;AAAAC,EAAAA,iBAAiB,CAACrH,CAAD,EAAG;AAAC,QAAIE,CAAJ;AAAM,QAAIE,CAAJ;AAAMJ,IAAAA,CAAC,CAACwE,IAAF,IAAQ,KAAKD,iBAAL,CAAuBC,IAA/B,GAAoCtE,CAAC,GAAC,SAAOE,CAAC,GAACiC,CAAC,CAACrC,CAAC,CAACwE,IAAH,EAAQ,CAAR,CAAV,IAAsBpE,CAAtB,GAAwB,CAA9D,GAAgEF,CAAC,GAAC,KAAKuE,cAAL,EAAlE;AAAwF,WAAOvE,CAAC,IAAE,KAAK4E,QAAL,CAAcwC,kBAAd,CAAiCC,YAApC,EAAiDrH,CAAxD;AAA0D;;AAAAuE,EAAAA,cAAc,GAAE;AAAC,QAAIzE,CAAJ;AAAM,WAAO,SAAOA,CAAC,GAAC,KAAK0E,WAAL,CAAiBF,IAA1B,IAAgCxE,CAAhC,GAAkC,CAAzC;AAA2C;;AAAAwG,EAAAA,gBAAgB,CAACxG,CAAD,EAAGE,CAAH,EAAKa,CAAL,EAAOC,CAAP,EAASC,CAAT,EAAW;AAAC,UAAME,CAAC,GAACkC,CAAC,CAACrD,CAAC,CAACmG,QAAH,CAAT;AAAsB,QAAG7F,CAAC,CAACa,CAAD,CAAJ,EAAQ,OAAO,IAAP;AAAY,UAAMC,CAAC,GAACmC,CAAC,CAACpC,CAAD,EAAG,KAAK2D,QAAL,CAAc0C,iBAAjB,EAAmC,KAAK1C,QAAL,CAAcwC,kBAAjD,EAAoEtG,CAApE,CAAT;AAAgF,QAAG,KAAKyG,4BAAL,CAAkCrG,CAAlC,EAAoCD,CAAC,CAACuG,KAAtC,EAA4C,OAA5C,EAAoD,sBAApD,GAA4E,MAAIvG,CAAC,CAACuG,KAAF,CAAQC,MAAZ,IAAoB,CAACxG,CAAC,CAACuG,KAAF,CAAQE,IAAR,CAAc5H,CAAC,IAAEA,CAAC,CAAC2H,MAAF,GAAS,CAA1B,CAApG,EAAkI,OAAO,IAAP;AAAY,UAAMzG,CAAC,GAACiC,CAAC,CAAChC,CAAD,CAAT;AAAa,QAAGb,CAAC,CAACY,CAAD,CAAJ,EAAQ,OAAO,IAAP;AAAY,UAAMJ,CAAC,GAAC,IAAI+G,KAAJ,EAAR;AAAA,UAAkBxF,CAAC,GAAC,IAAIwF,KAAJ,EAApB;AAAA,UAA8BpF,CAAC,GAAC,IAAIoF,KAAJ,EAAhC;AAAA,UAA0ClF,CAAC,GAAClB,CAAC,EAA7C;AAAA,UAAgDsB,CAAC,GAACtC,CAAC,EAAnD;AAAA,UAAsDwC,CAAC,GAAC5B,CAAC,EAAzD;AAAA,UAA4DoC,CAAC,GAAC,MAAI,KAAKqB,QAAL,CAAcwC,kBAAd,CAAiCQ,WAAnG;AAA+GrE,IAAAA,CAAC,IAAE,KAAKqB,QAAL,CAAcwC,kBAAd,CAAiCS,iBAAjC,CAAmD,IAAnD,EAAwD9E,CAAxD,CAAH,EAA8D1B,CAAC,CAACJ,CAAC,CAAC6G,gBAAH,EAAoB,CAAC9G,CAAC,CAACW,CAAH,EAAKX,CAAC,CAACG,CAAP,EAAS,CAAT,CAApB,EAAgC0B,CAAhC,EAAkC,KAAK+B,QAAL,CAAcwC,kBAAd,CAAiCU,gBAAnE,CAA/D;AAAoJ,UAAMrE,CAAC,GAAClD,CAAC,EAAT;AAAYE,IAAAA,CAAC,CAACgD,CAAD,EAAGZ,CAAH,CAAD;AAAO,UAAMc,CAAC,GAACnD,CAAC,EAAT;AAAYF,IAAAA,CAAC,CAACqD,CAAD,EAAGF,CAAH,CAAD;AAAO,UAAK;AAACsE,MAAAA,QAAQ,EAAChE,CAAV;AAAYiE,MAAAA,WAAW,EAAChE,CAAxB;AAA0BiE,MAAAA,QAAQ,EAAChE;AAAnC,QAAsC/C,CAA3C;AAAA,UAA6CgH,CAAC,GAACjE,CAAC,CAACwD,MAAF,GAAS,CAAxD;AAAA,UAA0DU,CAAC,GAAC,IAAIC,YAAJ,CAAiB,IAAEF,CAAF,GAAI,CAArB,CAA5D;AAAA,UAAoFG,CAAC,GAAC,IAAID,YAAJ,CAAiB,IAAEF,CAAF,GAAI,CAArB,CAAtF;AAAA,UAA8GI,CAAC,GAAC,IAAIF,YAAJ,CAAiB,IAAEF,CAAF,GAAI,CAArB,CAAhH;AAAA,UAAwIK,CAAC,GAAC,IAAIH,YAAJ,CAAiB,IAAEF,CAAF,GAAI,CAArB,CAA1I;AAAkK,QAAIM,CAAC,GAAC,CAAN;;AAAQ,SAAI,IAAItI,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC6D,CAAC,CAAC0D,MAAhB,EAAuB,EAAEvH,CAAzB,EAA2B;AAAC,YAAMJ,CAAC,GAACiE,CAAC,CAAC7D,CAAD,CAAT;AAAA,YAAaE,CAAC,GAACN,CAAC,CAAC2I,KAAjB;AAAuB,UAAG,KAAK7D,QAAL,CAAc8D,cAAd,KAA+BjH,CAAC,CAACgB,CAAD,CAAD,EAAKd,CAAC,CAACc,CAAD,EAAG3C,CAAC,CAACkI,WAAL,CAAN,EAAwB,CAACnG,CAAC,CAACY,CAAD,EAAG,KAAKmC,QAAL,CAAc8D,cAAjB,CAAzD,CAAH,EAA8F;AAAS,YAAMpI,CAAC,GAACD,CAAC,CAACP,CAAC,CAACkI,WAAH,EAAelI,CAAC,CAAC6I,WAAjB,EAA6B,CAA7B,CAAT;AAAyC,UAAG,MAAIrI,CAAC,CAACmH,MAAT,EAAgB;;AAAS,YAAMjH,CAAC,GAAC,IAAEJ,CAAF,GAAI,CAAJ,GAAME,CAAC,CAACmH,MAAhB;AAAA,YAAuBhH,CAAC,GAAC,IAAImI,WAAJ,CAAgBpI,CAAhB,CAAzB;AAAA,YAA4CD,CAAC,GAAC,IAAIqI,WAAJ,CAAgBtI,CAAC,CAACmH,MAAlB,CAA9C;AAAA,YAAwE3G,CAAC,GAAC,IAAEV,CAA5E;AAAA,YAA8EW,CAAC,GAAC,IAAEoH,CAAC,CAACU,iBAApF;AAAA,YAAsG5H,CAAC,GAAC,IAAIc,CAAJ,CAAMoG,CAAC,CAACW,MAAR,EAAeN,CAAC,GAACzH,CAAjB,EAAmBA,CAAnB,EAAqB,CAACyH,CAAC,GAAC1H,CAAH,IAAMC,CAA3B,CAAxG;AAAA,YAAsIG,CAAC,GAAC,IAAEmH,CAAC,CAACQ,iBAA5I;AAAA,YAA8J7H,CAAC,GAAC,IAAIe,CAAJ,CAAMsG,CAAC,CAACS,MAAR,EAAeN,CAAC,GAACtH,CAAjB,EAAmBA,CAAnB,EAAqB,CAACsH,CAAC,GAAC1H,CAAH,IAAMI,CAA3B,CAAhK;AAAA,YAA8LC,CAAC,GAAC,IAAIiH,YAAJ,CAAiBE,CAAC,CAACQ,MAAnB,EAA0B,IAAEN,CAAF,GAAIF,CAAC,CAACO,iBAAhC,EAAkD,IAAE/H,CAApD,CAAhM;AAAA,YAAuPO,CAAC,GAAC,IAAI+G,YAAJ,CAAiBG,CAAC,CAACO,MAAnB,EAA0B,IAAEN,CAAF,GAAID,CAAC,CAACM,iBAAhC,EAAkD,IAAE/H,CAApD,CAAzP;AAAA,YAAgTS,CAAC,GAAC,KAAK4F,iBAAL,CAAuBnH,CAAvB,CAAlT;;AAA4U+I,MAAAA,CAAC,CAAC9E,CAAD,EAAGD,CAAH,EAAK1D,CAAL,EAAOR,CAAP,EAASmB,CAAC,CAAC+H,WAAX,EAAuB7H,CAAvB,EAAyBH,CAAC,CAACgI,WAA3B,EAAuC3H,CAAvC,EAAyC,CAAzC,EAA2CZ,CAA3C,EAA6CF,CAA7C,EAA+CgB,CAA/C,EAAiDwB,CAAjD,EAAmDQ,CAAnD,CAAD,EAAuDvB,CAAC,CAACf,CAAD,EAAGA,CAAH,EAAKwC,CAAL,CAAxD,EAAgExB,CAAC,CAACjB,CAAD,EAAGA,CAAH,EAAK2C,CAAL,CAAjE,EAAyE6E,CAAC,IAAE,IAAEpI,CAA9E;;AAAgF,YAAMiC,CAAC,GAAC,KAAK4G,sBAAL,CAA4BxI,CAA5B,EAA8BA,CAAC,CAACgH,MAAF,GAASlH,CAAC,CAACkH,MAAzC,EAAgD;AAACyB,QAAAA,SAAS,EAACjI,CAAC,CAAC+H,WAAb;AAAyBG,QAAAA,SAAS,EAAChI,CAAnC;AAAqCiI,QAAAA,OAAO,EAACpI,CAAC,CAACgI,WAA/C;AAA2DK,QAAAA,OAAO,EAAChI;AAAnE,OAAhD,EAAsHR,CAAtH,CAAR;;AAAiID,MAAAA,CAAC,CAAC0I,IAAF,CAAOjH,CAAP,GAAUF,CAAC,CAACmH,IAAF,CAAO,KAAK9D,SAAZ,CAAV,EAAiCjD,CAAC,CAAC+G,IAAF,CAAO3I,CAAP,CAAjC;;AAA2C,YAAMgC,CAAC,GAAC,KAAKsG,sBAAL,CAA4B1I,CAA5B,EAA8B,CAA9B,EAAgC;AAAC2I,QAAAA,SAAS,EAACjI,CAAC,CAAC+H,WAAb;AAAyBG,QAAAA,SAAS,EAAChI,CAAnC;AAAqCiI,QAAAA,OAAO,EAACpI,CAAC,CAACgI,WAA/C;AAA2DK,QAAAA,OAAO,EAAChI;AAAnE,OAAhC,EAAsGR,CAAtG,CAAR;;AAAiHD,MAAAA,CAAC,CAAC0I,IAAF,CAAO3G,CAAP,GAAUR,CAAC,CAACmH,IAAF,CAAO,KAAK7D,eAAZ,CAAV,EAAuClD,CAAC,CAAC+G,IAAF,CAAO3I,CAAP,CAAvC;AAAiD;;AAAA,QAAG,MAAIC,CAAC,CAAC6G,MAAT,EAAgB,OAAO,IAAP;AAAY,UAAM8B,CAAC,GAAC,IAAI1F,CAAJ,CAAM;AAAC2F,MAAAA,UAAU,EAAC5I,CAAZ;AAAc6I,MAAAA,SAAS,EAACtH,CAAxB;AAA0BuH,MAAAA,eAAe,EAACnH,CAA1C;AAA4CoH,MAAAA,QAAQ,EAAC;AAACC,QAAAA,QAAQ,EAAC,KAAKhF,QAAL,CAAciF,KAAd,CAAoBtD,GAA9B;AAAkCuD,QAAAA,UAAU,EAAC/I,CAA7C;AAA+CgJ,QAAAA,iBAAiB,EAAC,CAAC;AAAlE;AAArD,KAAN,CAAR;AAA0IR,IAAAA,CAAC,CAACS,cAAF,GAAiBnH,CAAjB;AAAmB,UAAMoH,CAAC,GAACC,EAAR;AAAA,UAAWC,CAAC,GAACzJ,CAAC,CAAC,KAAK8D,WAAN,EAAkB;AAACS,MAAAA,OAAO,EAAC,KAAK0B,gBAAL;AAAT,KAAlB,CAAd;AAAA,UAAmEyD,EAAE,GAAClK,CAAC,CAACiK,CAAD,CAAD,GAAK;AAACE,MAAAA,YAAY,EAAC,KAAK7E,SAAnB;AAA6B8E,MAAAA,aAAa,EAAC,CAACH,CAAD,CAA3C;AAA+CI,MAAAA,UAAU,EAAC;AAACC,QAAAA,eAAe,EAAC,CAAC,CAAlB;AAAoBnF,QAAAA,iBAAiB,EAAC,KAAKT,QAAL,CAAcS;AAApD;AAA1D,KAAL,GAAuI,IAA7M;AAAA,UAAkNoF,EAAE,GAAC,IAAI9H,CAAJ,CAAM,IAAN,EAAW4G,CAAX,EAAa3I,CAAb,EAAe,IAAf,EAAoB,IAApB,EAAyBqJ,CAAzB,EAA2BnJ,CAA3B,EAA6BsJ,EAA7B,CAArN;AAAsP,WAAOK,EAAE,CAACC,uBAAH,GAA2BxJ,CAAC,CAACyJ,gBAA7B,EAA8CF,EAAE,CAACG,qBAAH,GAAyBvI,CAAC,CAACvB,CAAC,CAAC+J,IAAH,CAAxE,EAAiFJ,EAAxF;AAA2F;;AAAAxB,EAAAA,sBAAsB,CAACnJ,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAOE,CAAP,EAAS;AAAC,UAAMC,CAAC,GAAC,IAAIuI,WAAJ,CAAgB9I,CAAC,CAAC2H,MAAlB,CAAR;AAAA,UAAkCnH,CAAC,GAAC,CAAC,CAAC,UAAD,EAAY;AAACgE,MAAAA,IAAI,EAAC,CAAN;AAAQwG,MAAAA,IAAI,EAAC5K,CAAC,CAACgJ,SAAf;AAAyB6B,MAAAA,SAAS,EAAC,CAAC;AAApC,KAAZ,CAAD,EAAqD,CAAC,QAAD,EAAU;AAACzG,MAAAA,IAAI,EAAC,CAAN;AAAQwG,MAAAA,IAAI,EAAC5K,CAAC,CAACkJ,OAAf;AAAuB2B,MAAAA,SAAS,EAAC,CAAC;AAAlC,KAAV,CAArD,EAAqG,CAAC,OAAD,EAAS;AAACzG,MAAAA,IAAI,EAAC,CAAN;AAAQwG,MAAAA,IAAI,EAAC1K,CAAb;AAAe2K,MAAAA,SAAS,EAAC,CAAC;AAA1B,KAAT,CAArG,EAA4I,CAAC,MAAD,EAAQ;AAACzG,MAAAA,IAAI,EAAC,CAAN;AAAQwG,MAAAA,IAAI,EAAC5K,CAAC,CAACmJ,OAAf;AAAuB0B,MAAAA,SAAS,EAAC,CAAC;AAAlC,KAAR,CAA5I,CAApC;AAAA,UAA+NvK,CAAC,GAAC,CAAC,CAAC,UAAD,EAAYV,CAAZ,CAAD,EAAgB,CAAC,QAAD,EAAUA,CAAV,CAAhB,EAA6B,CAAC,OAAD,EAASO,CAAT,CAA7B,CAAjO;AAA2Q,WAAOH,CAAC,CAACiJ,SAAF,KAAc7I,CAAC,CAACgJ,IAAF,CAAO,CAAC,QAAD,EAAU;AAAChF,MAAAA,IAAI,EAAC,CAAN;AAAQwG,MAAAA,IAAI,EAAC5K,CAAC,CAACiJ;AAAf,KAAV,CAAP,GAA6C3I,CAAC,CAAC8I,IAAF,CAAO,CAAC,QAAD,EAAUxJ,CAAV,CAAP,CAA3D,GAAiF,IAAI6D,CAAJ,CAAMrD,CAAN,EAAQE,CAAR,EAAU,CAAV,EAAYR,CAAZ,CAAxF;AAAuG;;AAAlmK;;AAAmmK,SAAS+I,CAAT,CAAWjJ,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiBE,CAAjB,EAAmBC,CAAnB,EAAqBC,CAArB,EAAuBE,CAAvB,EAAyBC,CAAzB,EAA2BE,CAA3B,EAA6BJ,CAA7B,EAA+BM,CAA/B,EAAiCC,CAAjC,EAAmCC,CAAnC,EAAqCE,CAArC,EAAuC;AAAC,QAAMC,CAAC,GAAChB,CAAC,CAACuH,MAAF,GAAS,CAAjB;AAAmB,MAAIzG,CAAC,GAAC,CAAN;AAAA,MAAQJ,CAAC,GAAC,IAAER,CAAC,CAACqI,KAAd;AAAoBP,EAAAA,CAAC,CAACpI,CAAD,EAAGE,CAAH,EAAKI,CAAC,CAAC4K,KAAP,EAAa5K,CAAC,CAACqI,KAAf,EAAqBvI,CAArB,EAAuB,CAAvB,EAAyBgB,CAAzB,EAA2Bb,CAA3B,EAA6BC,CAA7B,EAA+BE,CAA/B,EAAiCC,CAAjC,EAAmCE,CAAnC,EAAqCJ,CAArC,EAAuCM,CAAvC,EAAyCD,CAAzC,EAA2CE,CAA3C,EAA6CC,CAA7C,EAA+CE,CAA/C,CAAD,EAAmDN,CAAC,IAAE,IAAEP,CAAC,CAACqI,KAA1D,EAAgE7H,CAAC,GAAC,CAAlE,EAAoE0H,CAAC,CAACjI,CAAD,EAAGC,CAAH,EAAKG,CAAL,EAAOD,CAAP,EAASQ,CAAT,EAAWZ,CAAC,CAAC6K,WAAF,CAAc,CAAd,CAAX,EAA4B7K,CAAC,CAACqI,KAA9B,EAAoC9H,CAApC,EAAsCJ,CAAtC,EAAwCK,CAAxC,EAA0CE,CAA1C,CAArE,EAAkHH,CAAC,IAAE,IAAEP,CAAC,CAAC6K,WAAF,CAAc,CAAd,CAAvH,EAAwIrK,CAAC,IAAE,IAAER,CAAC,CAAC6K,WAAF,CAAc,CAAd,CAA7I,EAA8JjK,CAAC,IAAEZ,CAAC,CAAC6K,WAAF,CAAc,CAAd,CAAjK;;AAAkL,OAAI,IAAI9J,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACf,CAAC,CAAC6K,WAAF,CAAcxD,MAA5B,EAAmC,EAAEtG,CAArC,EAAuCmH,CAAC,CAACjI,CAAD,EAAGC,CAAH,EAAKG,CAAL,EAAOD,CAAP,EAASQ,CAAT,EAAWZ,CAAC,CAAC6K,WAAF,CAAc9J,CAAd,CAAX,EAA4Bf,CAAC,CAACqI,KAA9B,EAAoC9H,CAApC,EAAsCJ,CAAtC,EAAwCK,CAAxC,EAA0CE,CAA1C,CAAD,EAA8CH,CAAC,IAAE,IAAEP,CAAC,CAAC6K,WAAF,CAAc9J,CAAd,CAAnD,EAAoEP,CAAC,IAAE,IAAER,CAAC,CAAC6K,WAAF,CAAc9J,CAAd,CAAzE,EAA0FH,CAAC,IAAEZ,CAAC,CAAC6K,WAAF,CAAc9J,CAAd,CAA7F;AAA8G;;AAAA,SAAS+G,CAAT,CAAWpI,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiBE,CAAjB,EAAmBC,CAAnB,EAAqBC,CAArB,EAAuBE,CAAvB,EAAyBC,CAAzB,EAA2BE,CAA3B,EAA6BJ,CAA7B,EAA+BQ,CAA/B,EAAiCE,CAAjC,EAAmCC,CAAnC,EAAqCF,CAArC,EAAuCJ,CAAvC,EAAyCO,CAAzC,EAA2CE,CAA3C,EAA6CE,CAA7C,EAA+C;AAACV,EAAAA,CAAC,CAACqK,EAAD,EAAI7J,CAAJ,CAAD;AAAQ,QAAMI,CAAC,GAACN,CAAC,GAAC,CAAF,GAAI,CAAJ,GAAM,CAAC,CAAf;AAAiB,MAAIQ,CAAC,GAAC,IAAEzB,CAAR;AAAA,MAAU2B,CAAC,GAACZ,CAAZ;AAAA,MAAcc,CAAC,GAAC,IAAEF,CAAlB;AAAA,MAAoBG,CAAC,GAACf,CAAC,GAACb,CAAxB;AAAA,MAA0B6B,CAAC,GAAC,IAAED,CAA9B;;AAAgC,OAAI,IAAInB,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACT,CAAd,EAAgB,EAAES,CAAlB,EAAoBU,CAAC,KAAG2J,EAAE,CAAC,CAAD,CAAF,GAAMpL,CAAC,CAAC6B,CAAC,GAAC,CAAH,CAAP,EAAauJ,EAAE,CAAC,CAAD,CAAF,GAAMpL,CAAC,CAAC6B,CAAC,GAAC,CAAH,CAApB,EAA0BuJ,EAAE,CAAC,CAAD,CAAF,GAAMpL,CAAC,CAAC6B,CAAC,GAAC,CAAH,CAAjC,EAAuCb,CAAC,CAACoK,EAAD,EAAIA,EAAJ,CAA3C,CAAD,EAAqDzK,CAAC,CAACsB,CAAC,GAAC,CAAH,CAAD,GAAOjC,CAAC,CAAC6B,CAAC,GAAC,CAAH,CAA7D,EAAmElB,CAAC,CAACsB,CAAC,GAAC,CAAH,CAAD,GAAOjC,CAAC,CAAC6B,CAAC,GAAC,CAAH,CAA3E,EAAiFlB,CAAC,CAACsB,CAAC,GAAC,CAAH,CAAD,GAAOjC,CAAC,CAAC6B,CAAC,GAAC,CAAH,CAAzF,EAA+FhB,CAAC,CAACoB,CAAC,GAAC,CAAH,CAAD,GAAO/B,CAAC,CAAC2B,CAAC,GAAC,CAAH,CAAvG,EAA6GhB,CAAC,CAACoB,CAAC,GAAC,CAAH,CAAD,GAAO/B,CAAC,CAAC2B,CAAC,GAAC,CAAH,CAArH,EAA2HhB,CAAC,CAACoB,CAAC,GAAC,CAAH,CAAD,GAAO/B,CAAC,CAAC2B,CAAC,GAAC,CAAH,CAAnI,EAAyIpB,CAAC,CAACwB,CAAC,GAAC,CAAH,CAAD,GAAO,CAACN,CAAD,GAAGyJ,EAAE,CAAC,CAAD,CAArJ,EAAyJ3K,CAAC,CAACwB,CAAC,GAAC,CAAH,CAAD,GAAO,CAACN,CAAD,GAAGyJ,EAAE,CAAC,CAAD,CAArK,EAAyK3K,CAAC,CAACwB,CAAC,GAAC,CAAH,CAAD,GAAO,CAACN,CAAD,GAAGyJ,EAAE,CAAC,CAAD,CAArL,EAAyLnK,CAAC,CAACc,CAAD,CAAD,GAAK,CAA9L,EAAgMpB,CAAC,CAACwB,CAAC,GAAC,CAAH,CAAD,GAAOnC,CAAC,CAAC6B,CAAC,GAAC,CAAH,CAAD,GAAOR,CAAC,GAAC+J,EAAE,CAAC,CAAD,CAAlN,EAAsNzK,CAAC,CAACwB,CAAC,GAAC,CAAH,CAAD,GAAOnC,CAAC,CAAC6B,CAAC,GAAC,CAAH,CAAD,GAAOR,CAAC,GAAC+J,EAAE,CAAC,CAAD,CAAxO,EAA4OzK,CAAC,CAACwB,CAAC,GAAC,CAAH,CAAD,GAAOnC,CAAC,CAAC6B,CAAC,GAAC,CAAH,CAAD,GAAOR,CAAC,GAAC+J,EAAE,CAAC,CAAD,CAA9P,EAAkQvK,CAAC,CAACsB,CAAC,GAAC,CAAH,CAAD,GAAOjC,CAAC,CAAC2B,CAAC,GAAC,CAAH,CAA1Q,EAAgRhB,CAAC,CAACsB,CAAC,GAAC,CAAH,CAAD,GAAOjC,CAAC,CAAC2B,CAAC,GAAC,CAAH,CAAxR,EAA8RhB,CAAC,CAACsB,CAAC,GAAC,CAAH,CAAD,GAAOjC,CAAC,CAAC2B,CAAC,GAAC,CAAH,CAAtS,EAA4SpB,CAAC,CAAC0B,CAAC,GAAC,CAAH,CAAD,GAAOR,CAAC,GAACyJ,EAAE,CAAC,CAAD,CAAvT,EAA2T3K,CAAC,CAAC0B,CAAC,GAAC,CAAH,CAAD,GAAOR,CAAC,GAACyJ,EAAE,CAAC,CAAD,CAAtU,EAA0U3K,CAAC,CAAC0B,CAAC,GAAC,CAAH,CAAD,GAAOR,CAAC,GAACyJ,EAAE,CAAC,CAAD,CAArV,EAAyVnK,CAAC,CAACiB,CAAD,CAAD,GAAKb,CAA9V,EAAgWY,CAAC,IAAE,CAAnW,EAAqWE,CAAC,IAAE,CAAxW,EAA0WN,CAAC,IAAE,CAA7W,EAA+WE,CAAC,IAAE,CAAlX,EAAoXG,CAAC,IAAE,CAAvX;;AAAyXL,EAAAA,CAAC,GAAC,IAAErB,CAAJ,EAAMyB,CAAC,GAAC,CAAR,EAAUE,CAAC,GAAC,IAAErB,CAAd;AAAgB,QAAMuB,CAAC,GAAChB,CAAC,GAAC,CAAF,GAAIgK,EAAJ,GAAOC,EAAf;AAAA,QAAkB/I,CAAC,GAAClB,CAAC,GAAC,CAAF,GAAIiK,EAAJ,GAAOD,EAA3B;;AAA8B,OAAI,IAAItK,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACL,CAAd,EAAgB,EAAEK,CAAlB,EAAoBG,CAAC,CAACe,CAAC,GAAC,CAAH,CAAD,GAAO1B,CAAC,CAACsB,CAAC,GAACQ,CAAC,CAAC,CAAD,CAAJ,CAAR,EAAiBnB,CAAC,CAACe,CAAC,GAAC,CAAH,CAAD,GAAO1B,CAAC,CAACsB,CAAC,GAACQ,CAAC,CAAC,CAAD,CAAJ,CAAzB,EAAkCnB,CAAC,CAACe,CAAC,GAAC,CAAH,CAAD,GAAO1B,CAAC,CAACsB,CAAC,GAACQ,CAAC,CAAC,CAAD,CAAJ,CAA1C,EAAmDjB,CAAC,CAACe,CAAC,GAAC,CAAH,CAAD,GAAO5B,CAAC,CAACsB,CAAC,GAACU,CAAC,CAAC,CAAD,CAAJ,CAAD,GAAUjC,CAApE,EAAsEc,CAAC,CAACe,CAAC,GAAC,CAAH,CAAD,GAAO5B,CAAC,CAACsB,CAAC,GAACU,CAAC,CAAC,CAAD,CAAJ,CAAD,GAAUjC,CAAvF,EAAyFc,CAAC,CAACe,CAAC,GAAC,CAAH,CAAD,GAAO5B,CAAC,CAACsB,CAAC,GAACU,CAAC,CAAC,CAAD,CAAJ,CAAD,GAAUjC,CAA1G,EAA4G2B,CAAC,IAAE,CAA/G,EAAiHE,CAAC,IAAE,CAApH,EAAsHN,CAAC,IAAE,CAAzH;AAA2H;;AAAA,SAASwG,CAAT,CAAWrI,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiBE,CAAjB,EAAmBC,CAAnB,EAAqBC,CAArB,EAAuBE,CAAvB,EAAyB;AAACJ,EAAAA,CAAC,CAACE,CAAD,CAAD,GAAKF,CAAC,CAACI,CAAD,CAAN,EAAUA,CAAC,IAAE,CAAb,EAAeV,CAAC,CAAC,CAACQ,CAAC,IAAE,CAAJ,IAAO,CAAR,CAAD,GAAYR,CAAC,CAACU,CAAC,GAAC,CAAH,CAA5B,EAAkCV,CAAC,CAACQ,CAAC,GAAC,CAAH,CAAD,GAAOR,CAAC,CAACU,CAAC,GAAC,CAAH,CAA1C,EAAgDV,CAAC,CAACQ,CAAC,GAAC,CAAH,CAAD,GAAOR,CAAC,CAACU,CAAC,GAAC,CAAH,CAAxD,EAA8DR,CAAC,CAACM,CAAC,GAAC,CAAH,CAAD,GAAON,CAAC,CAACQ,CAAC,GAAC,CAAH,CAAtE,EAA4ER,CAAC,CAACM,CAAC,GAAC,CAAH,CAAD,GAAON,CAAC,CAACQ,CAAC,GAAC,CAAH,CAApF,EAA0FR,CAAC,CAACM,CAAC,GAAC,CAAH,CAAD,GAAON,CAAC,CAACQ,CAAC,GAAC,CAAH,CAAlG,EAAwGN,CAAC,CAACI,CAAC,GAAC,CAAH,CAAD,GAAOD,CAAC,CAAC,CAAD,CAAhH,EAAoHH,CAAC,CAACI,CAAC,GAAC,CAAH,CAAD,GAAOD,CAAC,CAAC,CAAD,CAA5H,EAAgIH,CAAC,CAACI,CAAC,GAAC,CAAH,CAAD,GAAOD,CAAC,CAAC,CAAD,CAAxI;AAA4I;;AAAA,MAAMgI,CAAC,GAAClH,CAAC,EAAT;;AAAY,SAASmH,CAAT,CAAWxI,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiBE,CAAjB,EAAmBC,CAAnB,EAAqBC,CAArB,EAAuBE,CAAvB,EAAyBC,CAAzB,EAA2BE,CAA3B,EAA6BJ,CAA7B,EAA+BM,CAA/B,EAAiC;AAAC,MAAIC,CAAC,GAACT,CAAN;AAAA,MAAQU,CAAC,GAACV,CAAC,GAAC,CAAZ;AAAA,MAAcY,CAAC,GAACZ,CAAC,GAACG,CAAlB;AAAA,MAAoBU,CAAC,GAACb,CAAC,GAACG,CAAF,GAAI,CAA1B;AAAA,MAA4BQ,CAAC,GAACP,CAA9B;AAAA,MAAgCG,CAAC,GAACH,CAAC,GAAC,CAApC;AAAA,MAAsCU,CAAC,GAACV,CAAC,GAAC,IAAEH,CAA5C;AAAA,MAA8Ce,CAAC,GAACZ,CAAC,GAAC,IAAEH,CAAJ,GAAM,CAAtD;;AAAwDO,EAAAA,CAAC,GAAC,CAAF,KAAMC,CAAC,GAACT,CAAC,GAACG,CAAF,GAAI,CAAN,EAAQU,CAAC,GAACb,CAAhB,GAAmBE,CAAC,IAAE,CAAtB;;AAAwB,OAAI,IAAIgB,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACjB,CAAd,EAAgB,EAAEiB,CAAlB,EAAoBA,CAAC,KAAGjB,CAAC,GAAC,CAAN,KAAUO,CAAC,GAAC,CAAF,IAAKE,CAAC,GAACV,CAAF,EAAIa,CAAC,GAACb,CAAC,GAACG,CAAb,KAAiBO,CAAC,GAACV,CAAF,EAAIS,CAAC,GAACT,CAAC,GAACG,CAAzB,CAAV,GAAuC4J,EAAE,CAACtK,CAAD,EAAGgB,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAASoH,CAAT,CAAzC,EAAqDF,CAAC,CAACrI,CAAD,EAAGE,CAAH,EAAKI,CAAL,EAAOF,CAAP,EAASmI,CAAT,EAAWrH,CAAX,EAAaF,CAAb,CAAtD,EAAsEqH,CAAC,CAACrI,CAAD,EAAGE,CAAH,EAAKI,CAAL,EAAOF,CAAP,EAASmI,CAAT,EAAWzH,CAAX,EAAaG,CAAb,CAAvE,EAAuFoH,CAAC,CAACrI,CAAD,EAAGE,CAAH,EAAKI,CAAL,EAAOF,CAAP,EAASmI,CAAT,EAAWlH,CAAX,EAAaF,CAAb,CAAxF,EAAwGkH,CAAC,CAACrI,CAAD,EAAGE,CAAH,EAAKI,CAAL,EAAOF,CAAP,EAASmI,CAAT,EAAWhH,CAAX,EAAaH,CAAb,CAAzG,EAAyHP,CAAC,CAACJ,CAAC,EAAF,CAAD,GAAOS,CAAhI,EAAkIL,CAAC,CAACJ,CAAC,EAAF,CAAD,GAAOY,CAAzI,EAA2IR,CAAC,CAACJ,CAAC,EAAF,CAAD,GAAOc,CAAlJ,EAAoJV,CAAC,CAACJ,CAAC,EAAF,CAAD,GAAOS,CAA3J,EAA6JL,CAAC,CAACJ,CAAC,EAAF,CAAD,GAAOc,CAApK,EAAsKV,CAAC,CAACJ,CAAC,EAAF,CAAD,GAAOK,CAA7K,EAA+KE,CAAC,EAAhL,EAAmLC,CAAC,EAApL,EAAuLE,CAAC,EAAxL,EAA2LC,CAAC,EAA5L,EAA+LF,CAAC,IAAE,CAAlM,EAAoMJ,CAAC,IAAE,CAAvM,EAAyMO,CAAC,IAAE,CAA5M,EAA8ME,CAAC,IAAE,CAAjN;AAAmN;;AAAA,MAAMkH,CAAC,GAACpH,CAAC,EAAT;AAAA,MAAYqH,CAAC,GAACrH,CAAC,EAAf;AAAA,MAAkBoI,CAAC,GAACpI,CAAC,EAArB;AAAA,MAAwB8I,CAAC,GAAC9I,CAAC,EAA3B;AAAA,MAA8BgJ,CAAC,GAAChJ,CAAC,EAAjC;;AAAoC,SAASiJ,EAAT,CAAYtK,CAAZ,EAAcE,CAAd,EAAgBE,CAAhB,EAAkBE,CAAlB,EAAoBC,CAApB,EAAsB;AAACL,EAAAA,CAAC,IAAE,CAAH,EAAKE,CAAC,IAAE,CAAR,EAAUE,CAAC,IAAE,CAAb,EAAeW,CAAC,CAACwH,CAAD,EAAGzI,CAAC,CAACE,CAAC,EAAF,CAAJ,EAAUF,CAAC,CAACE,CAAC,EAAF,CAAX,EAAiBF,CAAC,CAACE,CAAC,EAAF,CAAlB,CAAhB,EAAyCe,CAAC,CAACyH,CAAD,EAAG1I,CAAC,CAACI,CAAC,EAAF,CAAJ,EAAUJ,CAAC,CAACI,CAAC,EAAF,CAAX,EAAiBJ,CAAC,CAACI,CAAC,EAAF,CAAlB,CAA1C,EAAmEa,CAAC,CAACwI,CAAD,EAAGzJ,CAAC,CAACM,CAAC,EAAF,CAAJ,EAAUN,CAAC,CAACM,CAAC,EAAF,CAAX,EAAiBN,CAAC,CAACM,CAAC,EAAF,CAAlB,CAApE,EAA6Fa,CAAC,CAACgJ,CAAD,EAAGzB,CAAH,EAAKD,CAAL,CAA9F,EAAsGtH,CAAC,CAACkJ,CAAD,EAAGZ,CAAH,EAAKhB,CAAL,CAAvG,EAA+GrH,CAAC,CAACb,CAAD,EAAG8J,CAAH,EAAKF,CAAL,CAAhH,EAAwHnJ,CAAC,CAACT,CAAD,EAAGA,CAAH,CAAzH;AAA+H;;AAAA,MAAMoK,EAAE,GAACtJ,CAAC,EAAV;;AAAa,SAAS+I,EAAT,CAAYpK,CAAZ,EAAcE,CAAd,EAAgBE,CAAhB,EAAkBE,CAAlB,EAAoB;AAAC,QAAMC,CAAC,GAACP,CAAC,CAACuL,WAAV;AAAA,QAAsB/K,CAAC,GAACD,CAAC,CAACiL,eAA1B;AAAA,QAA0C9K,CAAC,GAACF,CAAC,CAACmH,MAA9C;AAAA,QAAqD9G,CAAC,GAAC,sBAAoBX,CAAC,CAAC6K,IAA7E;AAAkF,MAAIhK,CAAC,GAAC,CAAN;AAAQ,QAAMC,CAAC,GAACT,CAAC,CAAC2J,cAAV;AAAA,QAAyB/I,CAAC,GAACR,CAAC,CAACF,CAAC,EAAF,EAAKO,CAAL,CAA5B;;AAAoC,OAAI,IAAIL,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACD,CAAd,EAAgBC,CAAC,IAAE,CAAnB,EAAqB;AAAC,UAAMX,CAAC,GAACQ,CAAC,CAACG,CAAD,CAAD,CAAKwF,QAAb;AAAA,UAAsBzF,CAAC,GAACV,CAAC,CAACyL,mBAAF,CAAsB,UAAtB,EAAkCT,IAA1D;AAAA,UAA+DvK,CAAC,GAACT,CAAC,CAAC0L,gBAAF,CAAmBzL,GAAnB,CAAuB,MAAvB,EAA+B+K,IAAhG;AAAA,UAAqG5J,CAAC,GAACpB,CAAC,CAAC0L,gBAAF,CAAmBzL,GAAnB,CAAuB,QAAvB,EAAiC+K,IAAxI;AAAA,UAA6IlK,CAAC,GAAC,IAAI6C,CAAJ,CAAMvC,CAAN,CAA/I;AAAA,UAAwJC,CAAC,GAACX,CAAC,CAACiH,MAAF,GAAS,CAAnK;AAAqK,QAAIpG,CAAC,GAAC,CAAN;AAAA,QAAQE,CAAC,GAAC,CAAC,CAAX;AAAA,QAAaE,CAAC,GAAC,CAAf;AAAiB,UAAME,CAAC,GAACzB,CAAC,CAAC4H,gBAAV;;AAA2B,SAAI,IAAIzH,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACc,CAAd,EAAgBd,CAAC,EAAjB,EAAoB;AAACoK,MAAAA,EAAE,CAAC,CAAD,CAAF,GAAMjK,CAAC,CAACa,CAAD,CAAP,EAAWoJ,EAAE,CAAC,CAAD,CAAF,GAAMjK,CAAC,CAACa,CAAC,GAAC,CAAH,CAAlB,EAAwBoJ,EAAE,CAAC,CAAD,CAAF,GAAMjK,CAAC,CAACa,CAAC,GAAC,CAAH,CAA/B;AAAqC,YAAMvB,CAAC,GAACyC,CAAC,CAAC3B,CAAD,EAAGV,CAAH,EAAKF,CAAL,EAAOI,CAAP,EAASO,CAAC,GAAC8K,EAAD,GAAI,IAAd,CAAT;AAA6B9K,MAAAA,CAAC,KAAGc,CAAC,IAAEgK,EAAE,CAACd,gBAAT,CAAD,EAA4BpH,CAAC,CAACmI,4CAAF,IAAgD3K,CAAC,CAAC4K,EAAD,EAAI/K,CAAC,CAACgL,KAAF,CAAQhL,CAAC,CAACiL,MAAF,GAAS,CAAjB,CAAJ,EAAwBjL,CAAC,CAACgL,KAAF,CAAQhL,CAAC,CAACiL,MAAF,GAAS,CAAjB,CAAxB,EAA4C/L,CAAC,GAACS,CAAC,CAACc,CAAC,GAAC,CAAH,CAA/C,CAAD,EAAuDjB,CAAC,CAAC0L,cAAF,CAAiBH,EAAjB,EAAoBhK,CAApB,EAAsBgK,EAAtB,CAAvD,EAAiF3K,CAAC,CAAC2K,EAAD,EAAIA,EAAJ,EAAO1K,CAAP,CAAlI,KAA8IF,CAAC,CAAC4K,EAAD,EAAInL,CAAC,CAACa,CAAC,GAAC,CAAH,CAAL,EAAWb,CAAC,CAACa,CAAC,GAAC,CAAH,CAAZ,EAAkBb,CAAC,CAACa,CAAC,GAAC,CAAH,CAAnB,CAAD,EAA2BL,CAAC,CAAC2K,EAAD,EAAIA,EAAJ,EAAO7K,CAAP,CAA5B,EAAsCV,CAAC,CAAC2L,WAAF,CAAcJ,EAAd,EAAiB7L,CAAC,GAACS,CAAC,CAACc,CAAC,GAAC,CAAH,CAApB,CAAtC,EAAiEL,CAAC,CAAC2K,EAAD,EAAIA,EAAJ,EAAO1K,CAAP,CAAhN,CAA5B,EAAuPT,CAAC,CAACa,CAAD,CAAD,GAAKsK,EAAE,CAAC,CAAD,CAA9P,EAAkQnL,CAAC,CAACa,CAAC,GAAC,CAAH,CAAD,GAAOsK,EAAE,CAAC,CAAD,CAA3Q,EAA+QnL,CAAC,CAACa,CAAC,GAAC,CAAH,CAAD,GAAOsK,EAAE,CAAC,CAAD,CAAxR;AAA4R,YAAMtL,CAAC,GAAC2L,EAAE,GAAC5L,CAAC,CAACiH,YAAb;AAA0B,OAAC4E,IAAI,CAACC,GAAL,CAASzB,EAAE,CAAC,CAAD,CAAF,GAAMjK,CAAC,CAACa,CAAD,CAAhB,KAAsBhB,CAAtB,IAAyB4L,IAAI,CAACC,GAAL,CAASzB,EAAE,CAAC,CAAD,CAAF,GAAMjK,CAAC,CAACa,CAAC,GAAC,CAAH,CAAhB,KAAwBhB,CAAjD,IAAoD4L,IAAI,CAACC,GAAL,CAASzB,EAAE,CAAC,CAAD,CAAF,GAAMjK,CAAC,CAACa,CAAC,GAAC,CAAH,CAAhB,KAAwBhB,CAA7E,MAAkFkB,CAAC,GAAC,CAAC,CAArF,GAAwFX,CAAC,CAACiL,MAAF,IAAU,CAAlG,EAAoGxK,CAAC,IAAE,CAAvG;AAAyG;;AAAAE,IAAAA,CAAC,KAAGzB,CAAC,CAACqM,sBAAF,IAA2B9L,CAAC,CAAC+L,0BAAF,CAA6B3L,CAA7B,CAA3B,EAA2DH,CAAC,CAACG,CAAC,GAAC,CAAH,CAAD,CAAOwF,QAAP,CAAgBkG,sBAAhB,EAA3D,EAAoG9L,CAAC,CAAC+L,0BAAF,CAA6B3L,CAAC,GAAC,CAA/B,CAAvG,CAAD,EAA2II,CAAC,IAAEY,CAAC,GAACN,CAAhJ;AAAkJ;;AAAA,SAAON,CAAC,GAACL,CAAT;AAAW;;AAAA,MAAMmL,EAAE,GAACxK,CAAC,EAAV;AAAA,MAAa+J,EAAE,GAAC/J,CAAC,EAAjB;AAAA,MAAoBiK,EAAE,GAAC,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,CAAvB;AAAA,MAA+BD,EAAE,GAAC,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,CAAlC;AAAA,MAA0Ca,EAAE,GAAC,GAA7C;AAAA,MAAiDP,EAAE,GAAC;AAACY,EAAAA,wBAAwB,EAAC,CAA1B;AAA4B1B,EAAAA,gBAAgB,EAAC;AAA7C,CAApD;AAAoG,eAAe1G,CAAf;AAAiB,SAAOA,CAAC,IAAIqI,4BAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import{get as t,isSome as s,isNone as r}from\"../../../../core/maybe.js\";import{e as n}from\"../../../../chunks/earcut.js\";import{a}from\"../../../../chunks/mat3.js\";import{c as o}from\"../../../../chunks/mat3f64.js\";import{a as i}from\"../../../../chunks/mat4.js\";import{I as l,c}from\"../../../../chunks/mat4f64.js\";import{g as h,n as m,s as p,f as d,c as u,m as f}from\"../../../../chunks/vec3.js\";import{d as g,c as y}from\"../../../../chunks/vec3f64.js\";import{computeLinearTransformation as _}from\"../../../../geometry/projection.js\";import{create as E,empty as b,expandWithBuffer as x,intersectsClippingArea as v}from\"../../../../geometry/support/aaBoundingBox.js\";import{BufferViewVec3f64 as P}from\"../../../../geometry/support/buffer/BufferView.js\";import{t as w,a as A}from\"../../../../chunks/vec32.js\";import{getDriverAxisSizeValue as j}from\"../../../../renderers/support/renderingInfoUtils.js\";import{needsElevationUpdates3D as L,evaluateElevationAlignmentAtPoint as S}from\"./elevationAlignmentUtils.js\";import{ElevationContext as B}from\"./ElevationContext.js\";import{Graphics3DObject3DGraphicLayer as C}from\"./Graphics3DObject3DGraphicLayer.js\";import{Graphics3DSymbolLayer as M}from\"./Graphics3DSymbolLayer.js\";import{validateSymbolLayerSize as R,computeCentroid as z}from\"./graphicUtils.js\";import{geometryAsPolygon as G,geometryToRenderInfo as D}from\"./polygonUtils.js\";import{createMaterial as I}from\"../support/edgeUtils.js\";import T from\"../../support/debugFlags.js\";import{SamplePosition as U}from\"../../support/ElevationProvider.js\";import{Geometry as V}from\"../../webgl-engine/lib/Geometry.js\";import{Object3D as O}from\"../../webgl-engine/lib/Object3D.js\";import{DefaultMaterial as k}from\"../../webgl-engine/materials/DefaultMaterial.js\";const F=[\"polygon\",\"extent\"];class N extends M{constructor(e,t,s,r){super(e,t,s,r),this.ensureDrapedStatus(!1)}async doLoad(){if(!this._drivenProperties.size){const t=R(this._getSymbolSize());if(t)throw new e(\"graphics3dextrudesymbollayer:invalid-size\",t)}const s=t(this.symbolLayer,\"material\",\"color\"),r=this._getCombinedOpacityAndColor(s),n=g(r),a=r[3],o=a<1||this.needsDrivenTransparentPass,i={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,diffuse:n,ambient:n,opacity:a,transparent:o,cullFace:o?0:2,vertexColors:!0,slicePlaneEnabled:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,offsetTransparentBackfaces:!0};this._material=new k(i),this._bottomMaterial=new k({...i,cullFace:2}),this._context.stage.add(this._material),this._context.stage.add(this._bottomMaterial)}destroy(){super.destroy(),this._material&&(this._context.stage.remove(this._material),this._context.stage.remove(this._bottomMaterial))}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,F,this.symbolLayer.type))return null;const s=this._getVertexOpacityAndColor(e.renderingInfo,255),r=this.setGraphicElevationContext(t,new B);return this._createAs3DShape(t,e.renderingInfo,s,r,t.uid)}layerOpacityChanged(e,r){const n=t(this.symbolLayer,\"material\",\"color\"),a=this._getCombinedOpacity(n),o=a<1||this.needsDrivenTransparentPass;this._material.setParameterValues({opacity:a,transparent:o}),this._bottomMaterial.setParameterValues({opacity:a,transparent:o});const i=this._getLayerOpacity();return e.forEach((e=>{const t=r(e);s(t)&&t.layerOpacityChanged(i,this._context.isAsync)})),!0}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,L)}slicePlaneEnabledChanged(e,t){return this._material.setParameterValues({slicePlaneEnabled:this._context.slicePlaneEnabled}),this._bottomMaterial.setParameterValues({slicePlaneEnabled:this._context.slicePlaneEnabled}),e.forEach((e=>{const r=t(e);s(r)&&r.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync)})),!0}physicalBasedRenderingChanged(){return this._material.setParameterValues({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),this._bottomMaterial.setParameterValues({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),!0}pixelRatioChanged(){return!0}_getExtrusionSize(e){let t;var s;e.size&&this._drivenProperties.size?t=null!=(s=j(e.size,2))?s:0:t=this._getSymbolSize();return t/=this._context.renderCoordsHelper.unitInMeters,t}_getSymbolSize(){var e;return null!=(e=this.symbolLayer.size)?e:1}_createAs3DShape(e,t,h,m,p){const d=G(e.geometry);if(r(d))return null;const u=D(d,this._context.elevationProvider,this._context.renderCoordsHelper,m);if(this._logGeometryCreationWarnings(u,d.rings,\"rings\",\"ExtrudeSymbol3DLayer\"),0===d.rings.length||!d.rings.some((e=>e.length>0)))return null;const f=z(d);if(r(f))return null;const g=new Array,j=new Array,S=new Array,B=E(),M=c(),R=y(),T=1===this._context.renderCoordsHelper.viewingMode;T||this._context.renderCoordsHelper.worldUpAtPosition(null,R),_(d.spatialReference,[f.x,f.y,0],M,this._context.renderCoordsHelper.spatialReference);const U=c();i(U,M);const V=o();a(V,U);const{polygons:k,mapPosition:F,position:N}=u,Y=N.length/3,W=new Float64Array(3*Y*6),q=new Float64Array(3*Y*6),J=new Float64Array(3*Y*6),K=new Float64Array(1*Y*6);let Q=0;for(let s=0;s<k.length;++s){const e=k[s],r=e.count;if(this._context.clippingExtent&&(b(B),x(B,e.mapPosition),!v(B,this._context.clippingExtent)))continue;const a=n(e.mapPosition,e.holeIndices,3);if(0===a.length)continue;const o=3*r*2+a.length,i=new Uint32Array(o),c=new Uint32Array(a.length),m=6*r,p=3*W.BYTES_PER_ELEMENT,d=new P(W.buffer,Q*p,p,(Q+m)*p),u=3*q.BYTES_PER_ELEMENT,f=new P(q.buffer,Q*u,u,(Q+m)*u),y=new Float64Array(J.buffer,3*Q*J.BYTES_PER_ELEMENT,3*m),_=new Float64Array(K.buffer,1*Q*K.BYTES_PER_ELEMENT,1*m),E=this._getExtrusionSize(t);H(N,F,a,e,d.typedBuffer,y,f.typedBuffer,_,0,i,c,E,R,T),w(d,d,U),A(f,f,V),Q+=6*r;const L=this._createExtrudeGeometry(i,i.length-c.length,{positions:d.typedBuffer,elevation:y,normals:f.typedBuffer,heights:_},h);g.push(L),j.push(this._material),S.push(l);const C=this._createExtrudeGeometry(c,0,{positions:d.typedBuffer,elevation:y,normals:f.typedBuffer,heights:_},h);g.push(C),j.push(this._bottomMaterial),S.push(l)}if(0===g.length)return null;const X=new O({geometries:g,materials:j,transformations:S,metadata:{layerUid:this._context.layer.uid,graphicUid:p,isElevationSource:!0}});X.transformation=M;const Z=se,$=I(this.symbolLayer,{opacity:this._getLayerOpacity()}),ee=s($)?{baseMaterial:this._material,edgeMaterials:[$],properties:{mergeGeometries:!0,slicePlaneEnabled:this._context.slicePlaneEnabled}}:null,te=new C(this,X,g,null,null,Z,m,ee);return te.alignedSampledElevation=u.sampledElevation,te.needsElevationUpdates=L(m.mode),te}_createExtrudeGeometry(e,t,s,r){const n=new Uint32Array(e.length),a=[[\"position\",{size:3,data:s.positions,exclusive:!0}],[\"normal\",{size:3,data:s.normals,exclusive:!0}],[\"color\",{size:4,data:r,exclusive:!0}],[\"size\",{size:1,data:s.heights,exclusive:!0}]],o=[[\"position\",e],[\"normal\",e],[\"color\",n]];return s.elevation&&(a.push([\"mapPos\",{size:3,data:s.elevation}]),o.push([\"mapPos\",e])),new V(a,o,0,t)}}function H(e,t,s,r,n,a,o,i,l,c,h,m,p,d){const u=s.length/3;let f=0,g=2*r.count;Y(e,t,r.index,r.count,s,0,u,n,a,o,i,l,c,h,g,m,p,d),l+=2*r.count,g=0,J(n,a,i,o,f,r.pathLengths[0],r.count,l,c,g,m),l+=4*r.pathLengths[0],g+=2*r.pathLengths[0],f+=r.pathLengths[0];for(let y=1;y<r.pathLengths.length;++y)J(n,a,i,o,f,r.pathLengths[y],r.count,l,c,g,m),l+=4*r.pathLengths[y],g+=2*r.pathLengths[y],f+=r.pathLengths[y]}function Y(e,t,s,r,n,a,o,i,l,c,p,d,u,f,g,y,_,E){h(ne,_);const b=y>0?1:-1;let x=3*s,v=d,P=3*v,w=d+r,A=3*w;for(let h=0;h<r;++h)E&&(ne[0]=e[x+0],ne[1]=e[x+1],ne[2]=e[x+2],m(ne,ne)),i[P+0]=e[x+0],i[P+1]=e[x+1],i[P+2]=e[x+2],l[P+0]=t[x+0],l[P+1]=t[x+1],l[P+2]=t[x+2],c[P+0]=-b*ne[0],c[P+1]=-b*ne[1],c[P+2]=-b*ne[2],p[v]=0,i[A+0]=e[x+0]+y*ne[0],i[A+1]=e[x+1]+y*ne[1],i[A+2]=e[x+2]+y*ne[2],l[A+0]=t[x+0],l[A+1]=t[x+1],l[A+2]=t[x+2],c[A+0]=b*ne[0],c[A+1]=b*ne[1],c[A+2]=b*ne[2],p[w]=y,P+=3,A+=3,x+=3,v+=1,w+=1;x=3*a,P=0,A=3*g;const j=y<0?oe:ae,L=y<0?ae:oe;for(let h=0;h<o;++h)f[P+0]=n[x+j[0]],f[P+1]=n[x+j[1]],f[P+2]=n[x+j[2]],u[A+0]=n[x+L[0]]+r,u[A+1]=n[x+L[1]]+r,u[A+2]=n[x+L[2]]+r,P+=3,A+=3,x+=3}function W(e,t,s,r,n,a,o){r[a]=r[o],o*=3,e[(a*=3)+0]=e[o+0],e[a+1]=e[o+1],e[a+2]=e[o+2],t[a+0]=t[o+0],t[a+1]=t[o+1],t[a+2]=t[o+2],s[a+0]=n[0],s[a+1]=n[1],s[a+2]=n[2]}const q=y();function J(e,t,s,r,n,a,o,i,l,c,h){let m=n,p=n+1,d=n+o,u=n+o+1,f=i,g=i+1,y=i+2*a,_=i+2*a+1;h<0&&(m=n+o+1,u=n),c*=3;for(let E=0;E<a;++E)E===a-1&&(h>0?(p=n,u=n+o):(p=n,m=n+o)),ee(e,m,p,d,q),W(e,t,r,s,q,f,m),W(e,t,r,s,q,g,p),W(e,t,r,s,q,y,d),W(e,t,r,s,q,_,u),l[c++]=f,l[c++]=y,l[c++]=_,l[c++]=f,l[c++]=_,l[c++]=g,m++,p++,d++,u++,f+=2,g+=2,y+=2,_+=2}const K=y(),Q=y(),X=y(),Z=y(),$=y();function ee(e,t,s,r,n){t*=3,s*=3,r*=3,p(K,e[t++],e[t++],e[t++]),p(Q,e[s++],e[s++],e[s++]),p(X,e[r++],e[r++],e[r++]),d(Z,Q,K),d($,X,K),u(n,$,Z),m(n,n)}const te=y();function se(e,t,s,r){const n=e.stageObject,a=n.geometryRecords,o=a.length,l=\"absolute-height\"!==t.mode;let h=0;const m=n.transformation,d=i(c(),m);for(let i=0;i<o;i+=2){const e=a[i].geometry,o=e.getMutableAttribute(\"position\").data,c=e.vertexAttributes.get(\"size\").data,u=e.vertexAttributes.get(\"mapPos\").data,g=new U(u),y=o.length/3;let _=0,E=!1,b=0;const x=s.spatialReference;for(let n=0;n<y;n++){te[0]=o[_],te[1]=o[_+1],te[2]=o[_+2];const e=S(g,s,t,r,l?le:null);l&&(b+=le.sampledElevation),T.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES?(p(re,g.array[g.offset+0],g.array[g.offset+1],e+c[_/3]),r.toRenderCoords(re,x,re),f(re,re,d)):(p(re,o[_+0],o[_+1],o[_+2]),f(re,re,m),r.setAltitude(re,e+c[_/3]),f(re,re,d)),o[_]=re[0],o[_+1]=re[1],o[_+2]=re[2];const n=ie/r.unitInMeters;(Math.abs(te[0]-o[_])>=n||Math.abs(te[1]-o[_+1])>=n||Math.abs(te[2]-o[_+2])>=n)&&(E=!0),g.offset+=3,_+=3}E&&(e.invalidateBoundingInfo(),n.geometryVertexAttrsUpdated(i),a[i+1].geometry.invalidateBoundingInfo(),n.geometryVertexAttrsUpdated(i+1)),h+=b/y}return h/o}const re=y(),ne=y(),ae=[0,2,1],oe=[0,1,2],ie=.01,le={verticalDistanceToGround:0,sampledElevation:0};export default N;export{N as Graphics3DExtrudeSymbolLayer};\n"]},"metadata":{},"sourceType":"module"}