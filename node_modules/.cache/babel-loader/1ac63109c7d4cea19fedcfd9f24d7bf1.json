{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../../core/Error.js\";\nimport r from \"../../../core/Logger.js\";\nimport { unquantizeMultipoint as t, unquantizePolyline as o, unquantizePolygon as n, unquantizePoint as a } from \"../../../geometry/support/quantizationUtils.js\";\n\nfunction s(e, t, o, n, a) {\n  const s = e.referencesGeometry() && a ? u(t, n, a) : t,\n        i = e.repurposeFeature(s);\n\n  try {\n    return e.evaluate({ ...o,\n      $feature: i\n    });\n  } catch (c) {\n    return r.getLogger(\"esri.views.2d.support.arcadeOnDemand\").warn(\"Feature arcade evaluation failed:\", c), null;\n  }\n}\n\nconst i = new Map();\n\nfunction u(e, r, t) {\n  const {\n    transform: o,\n    hasZ: n,\n    hasM: a\n  } = t;\n  i.has(r) || i.set(r, c(r));\n  const s = i.get(r)(e.geometry, o, n, a);\n  return { ...e,\n    geometry: s\n  };\n}\n\nfunction c(s) {\n  const i = {};\n\n  switch (s) {\n    case \"esriGeometryPoint\":\n      return (e, r, t, o) => a(r, i, e, t, o);\n\n    case \"esriGeometryPolygon\":\n      return (e, r, t, o) => n(r, i, e, t, o);\n\n    case \"esriGeometryPolyline\":\n      return (e, r, t, n) => o(r, i, e, t, n);\n\n    case \"esriGeometryMultipoint\":\n      return (e, r, o, n) => t(r, i, e, o, n);\n\n    default:\n      return r.getLogger(\"esri.views.2d.support.arcadeOnDemand\").error(new e(\"mapview-arcade\", `Unable to handle geometryType: ${s}`)), e => e;\n  }\n}\n\nexport default s;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/2d/arcade/callExpressionWithFeature.js"],"names":["e","r","unquantizeMultipoint","t","unquantizePolyline","o","unquantizePolygon","n","unquantizePoint","a","s","referencesGeometry","u","i","repurposeFeature","evaluate","$feature","c","getLogger","warn","Map","transform","hasZ","hasM","has","set","get","geometry","error"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import r from\"../../../core/Logger.js\";import{unquantizeMultipoint as t,unquantizePolyline as o,unquantizePolygon as n,unquantizePoint as a}from\"../../../geometry/support/quantizationUtils.js\";function s(e,t,o,n,a){const s=e.referencesGeometry()&&a?u(t,n,a):t,i=e.repurposeFeature(s);try{return e.evaluate({...o,$feature:i})}catch(c){return r.getLogger(\"esri.views.2d.support.arcadeOnDemand\").warn(\"Feature arcade evaluation failed:\",c),null}}const i=new Map;function u(e,r,t){const{transform:o,hasZ:n,hasM:a}=t;i.has(r)||i.set(r,c(r));const s=i.get(r)(e.geometry,o,n,a);return{...e,geometry:s}}function c(s){const i={};switch(s){case\"esriGeometryPoint\":return(e,r,t,o)=>a(r,i,e,t,o);case\"esriGeometryPolygon\":return(e,r,t,o)=>n(r,i,e,t,o);case\"esriGeometryPolyline\":return(e,r,t,n)=>o(r,i,e,t,n);case\"esriGeometryMultipoint\":return(e,r,o,n)=>t(r,i,e,o,n);default:return r.getLogger(\"esri.views.2d.support.arcadeOnDemand\").error(new e(\"mapview-arcade\",`Unable to handle geometryType: ${s}`)),e=>e}}export default s;\n"]},"metadata":{},"sourceType":"module"}