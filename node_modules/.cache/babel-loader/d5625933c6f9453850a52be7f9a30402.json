{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport r from \"../config.js\";\nimport t from \"../Graphic.js\";\nimport s from \"../PopupTemplate.js\";\nimport o from \"../request.js\";\nimport i from \"../core/Collection.js\";\nimport a from \"../core/CollectionFlattener.js\";\nimport { HandleOwnerMixin as n } from \"../core/HandleOwner.js\";\nimport { JSONMap as l } from \"../core/jsonMap.js\";\nimport { clone as p } from \"../core/lang.js\";\nimport { isSome as m } from \"../core/maybe.js\";\nimport { MultiOriginJSONMixin as u } from \"../core/MultiOriginJSONSupport.js\";\nimport { throwIfAbortError as y } from \"../core/promiseUtils.js\";\nimport { addQueryParameters as c, Url as d } from \"../core/urlUtils.js\";\nimport { property as f } from \"../core/accessorSupport/decorators/property.js\";\nimport { Integer as h } from \"../core/accessorSupport/ensureType.js\";\nimport \"../core/has.js\";\nimport \"../core/Logger.js\";\nimport { reader as g } from \"../core/accessorSupport/decorators/reader.js\";\nimport { subclass as b } from \"../core/accessorSupport/decorators/subclass.js\";\nimport { writer as x } from \"../core/accessorSupport/decorators/writer.js\";\nimport { willPropertyWrite as w } from \"../core/accessorSupport/write.js\";\nimport v from \"../geometry/Extent.js\";\nimport j from \"../geometry/SpatialReference.js\";\nimport { getScale as S } from \"../geometry/support/scaleUtils.js\";\nimport { equals as I } from \"../geometry/support/spatialReferenceUtils.js\";\nimport R from \"./Layer.js\";\nimport { BlendLayer as E } from \"./mixins/BlendLayer.js\";\nimport { OperationalLayer as U } from \"./mixins/OperationalLayer.js\";\nimport { PortalLayer as L } from \"./mixins/PortalLayer.js\";\nimport { RefreshableLayer as F } from \"./mixins/RefreshableLayer.js\";\nimport { ScaleRangeLayer as O } from \"./mixins/ScaleRangeLayer.js\";\nimport { TemporalLayer as P } from \"./mixins/TemporalLayer.js\";\nimport { isWmsServer as q } from \"./support/arcgisLayerUrl.js\";\nimport { legendEnabled as M, url as T } from \"./support/commonProperties.js\";\nimport { ExportWMSImageParameters as W } from \"./support/ExportWMSImageParameters.js\";\nimport C from \"./support/WMSSublayer.js\";\nimport { normalizeWKID as $, coordsReversedForWKID as _, toISOString as N, getPopupLayers as H, parseCapabilities as B } from \"./support/wmsUtils.js\";\nconst k = new l({\n  bmp: \"image/bmp\",\n  gif: \"image/gif\",\n  jpg: \"image/jpeg\",\n  png: \"image/png\",\n  svg: \"image/svg+xml\"\n}, {\n  ignoreUnknown: !1\n});\nlet A = class extends n(E(P(F(O(U(L(u(R)))))))) {\n  constructor(...e) {\n    super(...e), this.allSublayers = new a({\n      getCollections: () => [this.sublayers],\n      getChildrenFunction: e => e.sublayers\n    }), this.customParameters = null, this.customLayerParameters = null, this.copyright = null, this.description = null, this.dimensions = null, this.fullExtent = null, this.fullExtents = null, this.featureInfoFormat = null, this.featureInfoUrl = null, this.imageFormat = null, this.imageMaxHeight = 2048, this.imageMaxWidth = 2048, this.imageTransparency = !0, this.legendEnabled = !0, this.mapUrl = null, this.isReference = null, this.operationalLayerType = \"WMS\", this.spatialReference = null, this.spatialReferences = null, this.sublayers = null, this.type = \"wms\", this.url = null, this.version = null, this.watch(\"sublayers\", (e, r) => {\n      if (r) {\n        for (const e of r) e.layer = null;\n\n        this.handles.remove(\"wms-sublayer\");\n      }\n\n      if (e) {\n        for (const r of e) r.parent = this, r.layer = this;\n\n        this.handles.add([e.on(\"after-add\", ({\n          item: e\n        }) => {\n          e.parent = this, e.layer = this;\n        }), e.on(\"after-remove\", ({\n          item: e\n        }) => {\n          e.parent = null, e.layer = null;\n        })], \"wms-sublayer\");\n      }\n    }, !0);\n  }\n\n  normalizeCtorArgs(e, r) {\n    return \"string\" == typeof e ? {\n      url: e,\n      ...r\n    } : e;\n  }\n\n  load(e) {\n    const r = m(e) ? e.signal : null;\n    return this.addResolvingPromise(this.loadFromPortal({\n      supportedTypes: [\"WMS\"]\n    }, e).catch(y).then(() => this._fetchService(r))), Promise.resolve(this);\n  }\n\n  readFullExtentFromItemOrMap(e, r) {\n    const t = r.extent;\n    return new v({\n      xmin: t[0][0],\n      ymin: t[0][1],\n      xmax: t[1][0],\n      ymax: t[1][1]\n    });\n  }\n\n  writeFullExtent(e, r) {\n    r.extent = [[e.xmin, e.ymin], [e.xmax, e.ymax]];\n  }\n\n  readImageFormat(e, r) {\n    const t = r.supportedImageFormatTypes;\n    return t && t.indexOf(\"image/png\") > -1 ? \"image/png\" : t && t[0];\n  }\n\n  readSpatialReferenceFromItemOrDocument(e, r) {\n    return new j(r.spatialReferences[0]);\n  }\n\n  writeSpatialReferences(e, r) {\n    const t = this.spatialReference && this.spatialReference.wkid;\n    e && t ? (r.spatialReferences = e.filter(e => e !== t), r.spatialReferences.unshift(t)) : r.spatialReferences = e;\n  }\n\n  readSublayersFromItemOrMap(e, r, t) {\n    return G(r.layers, t, r.visibleLayers);\n  }\n\n  readSublayers(e, r, t) {\n    return G(r.layers, t);\n  }\n\n  writeSublayers(e, r, t, s) {\n    r.layers = [];\n    const o = new Map(),\n          i = e.flatten(({\n      sublayers: e\n    }) => e && e.toArray()).toArray();\n    i.forEach(e => {\n      \"number\" == typeof e.parent.id && (o.has(e.parent.id) ? o.get(e.parent.id).push(e.id) : o.set(e.parent.id, [e.id]));\n    }), i.forEach(e => {\n      const t = {\n        sublayer: e,\n        ...s\n      },\n            i = e.write({\n        parentLayerId: \"number\" == typeof e.parent.id ? e.parent.id : -1\n      }, t);\n\n      if (o.has(e.id) && (i.sublayerIds = o.get(e.id)), !e.sublayers && e.name) {\n        const s = e.write({}, t);\n        delete s.id, r.layers.push(s);\n      }\n    }), r.visibleLayers = i.filter(e => e.visible && !e.sublayers).map(e => e.name);\n  }\n\n  createExportImageParameters(e, r, t, s) {\n    const o = s && s.pixelRatio || 1,\n          i = S({\n      extent: e,\n      width: r\n    }) * o,\n          a = new W({\n      layer: this,\n      scale: i\n    }),\n          {\n      xmin: n,\n      ymin: l,\n      xmax: p,\n      ymax: m,\n      spatialReference: u\n    } = e,\n          y = $(u, this.spatialReferences),\n          c = \"1.3.0\" === this.version && _(y) ? `${l},${n},${m},${p}` : `${n},${l},${p},${m}`,\n          d = a.toJSON();\n    return {\n      bbox: c,\n      [\"1.3.0\" === this.version ? \"crs\" : \"srs\"]: isNaN(y) ? void 0 : \"EPSG:\" + y,\n      ...d\n    };\n  }\n\n  async fetchImage(e, r, t, s) {\n    var i, a;\n    const n = this.mapUrl,\n          l = this.createExportImageParameters(e, r, t, s);\n\n    if (!l.layers) {\n      const e = document.createElement(\"canvas\");\n      return e.width = r, e.height = t, e;\n    }\n\n    const p = null == s || null == (i = s.timeExtent) ? void 0 : i.start,\n          u = null == s || null == (a = s.timeExtent) ? void 0 : a.end,\n          y = m(p) && m(u) ? p.getTime() === u.getTime() ? N(p) : `${N(p)}/${N(u)}` : void 0,\n          c = {\n      responseType: \"image\",\n      query: this._mixCustomParameters({\n        width: r,\n        height: t,\n        ...l,\n        time: y\n      }),\n      signal: null == s ? void 0 : s.signal\n    };\n    return null != s && s.timestamp && (c.query = {\n      _ts: s.timestamp,\n      ...c.query\n    }), o(n, c).then(e => e.data);\n  }\n\n  fetchFeatureInfo(e, r, o, i, a) {\n    const n = S({\n      extent: e,\n      width: r\n    }),\n          l = new W({\n      layer: this,\n      scale: n\n    }),\n          p = H(l.visibleSublayers);\n    if (!this.featureInfoUrl || !p) return null;\n\n    const m = \"1.3.0\" === this.version ? {\n      I: i,\n      J: a\n    } : {\n      x: i,\n      y: a\n    },\n          u = {\n      query_layers: p,\n      request: \"GetFeatureInfo\",\n      info_format: this.featureInfoFormat,\n      feature_count: 25,\n      width: r,\n      height: o,\n      ...m\n    },\n          y = { ...this.createExportImageParameters(e, r, o),\n      ...u\n    },\n          d = this._mixCustomParameters(y),\n          f = c(this.featureInfoUrl, d),\n          h = document.createElement(\"iframe\");\n\n    h.src = f, h.frameBorder = \"0\", h.marginHeight = \"0\", h.marginWidth = \"0\", h.style.width = \"100%\", h.setAttribute(\"sandbox\", \"\");\n    const g = new s({\n      title: this.title,\n      content: h\n    });\n    return new t({\n      sourceLayer: this,\n      popupTemplate: g\n    });\n  }\n\n  findSublayerById(e) {\n    return this.allSublayers.find(r => r.id === e);\n  }\n\n  findSublayerByName(e) {\n    return this.allSublayers.find(r => r.name === e);\n  }\n\n  supportsSpatialReference(e) {\n    return q(this.url) || this.spatialReferences.some(r => {\n      const t = 900913 === r ? j.WebMercator : new j({\n        wkid: r\n      });\n      return I(t, e);\n    });\n  }\n\n  async _fetchService(e) {\n    if (!this.resourceInfo) {\n      this.parsedUrl.query && this.parsedUrl.query.service && (this.parsedUrl.query.SERVICE = this.parsedUrl.query.service, delete this.parsedUrl.query.service), this.parsedUrl.query && this.parsedUrl.query.request && (this.parsedUrl.query.REQUEST = this.parsedUrl.query.request, delete this.parsedUrl.query.request);\n      const r = await o(this.parsedUrl.path, {\n        query: {\n          SERVICE: \"WMS\",\n          REQUEST: \"GetCapabilities\",\n          ...this.parsedUrl.query,\n          ...this.customParameters\n        },\n        responseType: \"xml\",\n        signal: e\n      });\n      this.resourceInfo = B(r.data);\n    }\n\n    if (this.parsedUrl) {\n      const e = new d(this.parsedUrl.path);\n      \"https\" !== e.scheme || e.port && \"443\" !== e.port || -1 !== r.request.httpsDomains.indexOf(e.host) || r.request.httpsDomains.push(e.host);\n    }\n\n    this.read(this.resourceInfo, {\n      origin: \"service\"\n    });\n  }\n\n  _mixCustomParameters(e) {\n    if (!this.customLayerParameters && !this.customParameters) return e;\n    const r = { ...this.customParameters,\n      ...this.customLayerParameters\n    };\n\n    for (const t in r) e[t.toLowerCase()] = r[t];\n\n    return e;\n  }\n\n};\n\nfunction D(e, r) {\n  return e.some(e => {\n    for (const t in e) if (w(e, t, null, r)) return !0;\n\n    return !1;\n  });\n}\n\nfunction G(e, r, t) {\n  const s = new Map();\n  e.every(e => null == e.id) && (e = p(e)).forEach((e, r) => e.id = r);\n\n  for (const i of e) {\n    const e = new C();\n    e.read(i, r), -1 === (null == t ? void 0 : t.indexOf(e.name)) && (e.visible = !1), s.set(e.id, e);\n  }\n\n  const o = [];\n\n  for (const a of e) {\n    const e = s.get(a.id);\n\n    if (null != a.parentLayerId && a.parentLayerId >= 0) {\n      const r = s.get(a.parentLayerId);\n      r.sublayers || (r.sublayers = new i()), r.sublayers.unshift(e);\n    } else o.unshift(e);\n  }\n\n  return o;\n}\n\ne([f({\n  readOnly: !0\n})], A.prototype, \"allSublayers\", void 0), e([f({\n  json: {\n    type: Object,\n    write: !0\n  }\n})], A.prototype, \"customParameters\", void 0), e([f({\n  json: {\n    type: Object,\n    write: !0\n  }\n})], A.prototype, \"customLayerParameters\", void 0), e([f({\n  type: String,\n  json: {\n    write: !0\n  }\n})], A.prototype, \"copyright\", void 0), e([f()], A.prototype, \"description\", void 0), e([f({\n  readOnly: !0\n})], A.prototype, \"dimensions\", void 0), e([f({\n  json: {\n    type: [[Number]],\n    read: {\n      source: \"extent\"\n    },\n    write: {\n      target: \"extent\"\n    },\n    origins: {\n      service: {\n        read: {\n          source: \"extent\"\n        }\n      }\n    }\n  }\n})], A.prototype, \"fullExtent\", void 0), e([g([\"web-document\", \"portal-item\"], \"fullExtent\", [\"extent\"])], A.prototype, \"readFullExtentFromItemOrMap\", null), e([x([\"web-document\", \"portal-item\"], \"fullExtent\", {\n  extent: {\n    type: [[Number]]\n  }\n})], A.prototype, \"writeFullExtent\", null), e([f()], A.prototype, \"fullExtents\", void 0), e([f({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], A.prototype, \"featureInfoFormat\", void 0), e([f({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], A.prototype, \"featureInfoUrl\", void 0), e([f({\n  type: String,\n  json: {\n    origins: {\n      \"web-document\": {\n        default: \"image/png\",\n        type: k.jsonValues,\n        read: {\n          reader: k.read,\n          source: \"format\"\n        },\n        write: {\n          writer: k.write,\n          target: \"format\"\n        }\n      }\n    }\n  }\n})], A.prototype, \"imageFormat\", void 0), e([g(\"imageFormat\", [\"supportedImageFormatTypes\"])], A.prototype, \"readImageFormat\", null), e([f({\n  type: Number,\n  json: {\n    read: {\n      source: \"maxHeight\"\n    },\n    write: {\n      target: \"maxHeight\"\n    }\n  }\n})], A.prototype, \"imageMaxHeight\", void 0), e([f({\n  type: Number,\n  json: {\n    read: {\n      source: \"maxWidth\"\n    },\n    write: {\n      target: \"maxWidth\"\n    }\n  }\n})], A.prototype, \"imageMaxWidth\", void 0), e([f()], A.prototype, \"imageTransparency\", void 0), e([f(M)], A.prototype, \"legendEnabled\", void 0), e([f({\n  type: [\"show\", \"hide\", \"hide-children\"]\n})], A.prototype, \"listMode\", void 0), e([f({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], A.prototype, \"mapUrl\", void 0), e([f({\n  type: Boolean,\n  json: {\n    read: !1,\n    write: {\n      enabled: !0,\n      overridePolicy: () => ({\n        enabled: !1\n      })\n    }\n  }\n})], A.prototype, \"isReference\", void 0), e([f({\n  type: [\"WMS\"]\n})], A.prototype, \"operationalLayerType\", void 0), e([f({\n  type: j,\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"extent.spatialReference\"\n        }\n      }\n    },\n    write: !1\n  }\n})], A.prototype, \"spatialReference\", void 0), e([g([\"web-document\", \"portal-item\"], \"spatialReference\", [\"spatialReferences\"])], A.prototype, \"readSpatialReferenceFromItemOrDocument\", null), e([f({\n  type: [h],\n  json: {\n    read: {\n      source: \"spatialReferences\"\n    },\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], A.prototype, \"spatialReferences\", void 0), e([x([\"web-document\", \"portal-item\"], \"spatialReferences\")], A.prototype, \"writeSpatialReferences\", null), e([f({\n  type: i.ofType(C),\n  json: {\n    write: {\n      target: \"layers\",\n\n      overridePolicy(e, r, t) {\n        if (D(this.allSublayers, t)) return {\n          ignoreOrigin: !0\n        };\n      }\n\n    }\n  }\n})], A.prototype, \"sublayers\", void 0), e([g([\"web-document\", \"portal-item\"], \"sublayers\", [\"layers\", \"visibleLayers\"])], A.prototype, \"readSublayersFromItemOrMap\", null), e([g(\"service\", \"sublayers\", [\"layers\"])], A.prototype, \"readSublayers\", null), e([x(\"sublayers\", {\n  layers: {\n    type: [C]\n  },\n  visibleLayers: {\n    type: [String]\n  }\n})], A.prototype, \"writeSublayers\", null), e([f({\n  json: {\n    read: !1\n  },\n  readOnly: !0,\n  value: \"wms\"\n})], A.prototype, \"type\", void 0), e([f(T)], A.prototype, \"url\", void 0), e([f({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], A.prototype, \"version\", void 0), A = e([b(\"esri.layers.WMSLayer\")], A);\nvar J = A;\nexport default J;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/layers/WMSLayer.js"],"names":["_","e","r","t","s","o","i","a","HandleOwnerMixin","n","JSONMap","l","clone","p","isSome","m","MultiOriginJSONMixin","u","throwIfAbortError","y","addQueryParameters","c","Url","d","property","f","Integer","h","reader","g","subclass","b","writer","x","willPropertyWrite","w","v","j","getScale","S","equals","I","R","BlendLayer","E","OperationalLayer","U","PortalLayer","L","RefreshableLayer","F","ScaleRangeLayer","O","TemporalLayer","P","isWmsServer","q","legendEnabled","M","url","T","ExportWMSImageParameters","W","C","normalizeWKID","$","coordsReversedForWKID","toISOString","N","getPopupLayers","H","parseCapabilities","B","k","bmp","gif","jpg","png","svg","ignoreUnknown","A","constructor","allSublayers","getCollections","sublayers","getChildrenFunction","customParameters","customLayerParameters","copyright","description","dimensions","fullExtent","fullExtents","featureInfoFormat","featureInfoUrl","imageFormat","imageMaxHeight","imageMaxWidth","imageTransparency","mapUrl","isReference","operationalLayerType","spatialReference","spatialReferences","type","version","watch","layer","handles","remove","parent","add","on","item","normalizeCtorArgs","load","signal","addResolvingPromise","loadFromPortal","supportedTypes","catch","then","_fetchService","Promise","resolve","readFullExtentFromItemOrMap","extent","xmin","ymin","xmax","ymax","writeFullExtent","readImageFormat","supportedImageFormatTypes","indexOf","readSpatialReferenceFromItemOrDocument","writeSpatialReferences","wkid","filter","unshift","readSublayersFromItemOrMap","G","layers","visibleLayers","readSublayers","writeSublayers","Map","flatten","toArray","forEach","id","has","get","push","set","sublayer","write","parentLayerId","sublayerIds","name","visible","map","createExportImageParameters","pixelRatio","width","scale","toJSON","bbox","isNaN","fetchImage","document","createElement","height","timeExtent","start","end","getTime","responseType","query","_mixCustomParameters","time","timestamp","_ts","data","fetchFeatureInfo","visibleSublayers","J","query_layers","request","info_format","feature_count","src","frameBorder","marginHeight","marginWidth","style","setAttribute","title","content","sourceLayer","popupTemplate","findSublayerById","find","findSublayerByName","supportsSpatialReference","some","WebMercator","resourceInfo","parsedUrl","service","SERVICE","REQUEST","path","scheme","port","httpsDomains","host","read","origin","toLowerCase","D","every","readOnly","prototype","json","Object","String","Number","source","target","origins","ignoreOrigin","default","jsonValues","Boolean","enabled","overridePolicy","ofType","value"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import r from\"../config.js\";import t from\"../Graphic.js\";import s from\"../PopupTemplate.js\";import o from\"../request.js\";import i from\"../core/Collection.js\";import a from\"../core/CollectionFlattener.js\";import{HandleOwnerMixin as n}from\"../core/HandleOwner.js\";import{JSONMap as l}from\"../core/jsonMap.js\";import{clone as p}from\"../core/lang.js\";import{isSome as m}from\"../core/maybe.js\";import{MultiOriginJSONMixin as u}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as y}from\"../core/promiseUtils.js\";import{addQueryParameters as c,Url as d}from\"../core/urlUtils.js\";import{property as f}from\"../core/accessorSupport/decorators/property.js\";import{Integer as h}from\"../core/accessorSupport/ensureType.js\";import\"../core/has.js\";import\"../core/Logger.js\";import{reader as g}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as b}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as x}from\"../core/accessorSupport/decorators/writer.js\";import{willPropertyWrite as w}from\"../core/accessorSupport/write.js\";import v from\"../geometry/Extent.js\";import j from\"../geometry/SpatialReference.js\";import{getScale as S}from\"../geometry/support/scaleUtils.js\";import{equals as I}from\"../geometry/support/spatialReferenceUtils.js\";import R from\"./Layer.js\";import{BlendLayer as E}from\"./mixins/BlendLayer.js\";import{OperationalLayer as U}from\"./mixins/OperationalLayer.js\";import{PortalLayer as L}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as F}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as O}from\"./mixins/ScaleRangeLayer.js\";import{TemporalLayer as P}from\"./mixins/TemporalLayer.js\";import{isWmsServer as q}from\"./support/arcgisLayerUrl.js\";import{legendEnabled as M,url as T}from\"./support/commonProperties.js\";import{ExportWMSImageParameters as W}from\"./support/ExportWMSImageParameters.js\";import C from\"./support/WMSSublayer.js\";import{normalizeWKID as $,coordsReversedForWKID as _,toISOString as N,getPopupLayers as H,parseCapabilities as B}from\"./support/wmsUtils.js\";const k=new l({bmp:\"image/bmp\",gif:\"image/gif\",jpg:\"image/jpeg\",png:\"image/png\",svg:\"image/svg+xml\"},{ignoreUnknown:!1});let A=class extends(n(E(P(F(O(U(L(u(R))))))))){constructor(...e){super(...e),this.allSublayers=new a({getCollections:()=>[this.sublayers],getChildrenFunction:e=>e.sublayers}),this.customParameters=null,this.customLayerParameters=null,this.copyright=null,this.description=null,this.dimensions=null,this.fullExtent=null,this.fullExtents=null,this.featureInfoFormat=null,this.featureInfoUrl=null,this.imageFormat=null,this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.legendEnabled=!0,this.mapUrl=null,this.isReference=null,this.operationalLayerType=\"WMS\",this.spatialReference=null,this.spatialReferences=null,this.sublayers=null,this.type=\"wms\",this.url=null,this.version=null,this.watch(\"sublayers\",((e,r)=>{if(r){for(const e of r)e.layer=null;this.handles.remove(\"wms-sublayer\")}if(e){for(const r of e)r.parent=this,r.layer=this;this.handles.add([e.on(\"after-add\",(({item:e})=>{e.parent=this,e.layer=this})),e.on(\"after-remove\",(({item:e})=>{e.parent=null,e.layer=null}))],\"wms-sublayer\")}}),!0)}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const r=m(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"WMS\"]},e).catch(y).then((()=>this._fetchService(r)))),Promise.resolve(this)}readFullExtentFromItemOrMap(e,r){const t=r.extent;return new v({xmin:t[0][0],ymin:t[0][1],xmax:t[1][0],ymax:t[1][1]})}writeFullExtent(e,r){r.extent=[[e.xmin,e.ymin],[e.xmax,e.ymax]]}readImageFormat(e,r){const t=r.supportedImageFormatTypes;return t&&t.indexOf(\"image/png\")>-1?\"image/png\":t&&t[0]}readSpatialReferenceFromItemOrDocument(e,r){return new j(r.spatialReferences[0])}writeSpatialReferences(e,r){const t=this.spatialReference&&this.spatialReference.wkid;e&&t?(r.spatialReferences=e.filter((e=>e!==t)),r.spatialReferences.unshift(t)):r.spatialReferences=e}readSublayersFromItemOrMap(e,r,t){return G(r.layers,t,r.visibleLayers)}readSublayers(e,r,t){return G(r.layers,t)}writeSublayers(e,r,t,s){r.layers=[];const o=new Map,i=e.flatten((({sublayers:e})=>e&&e.toArray())).toArray();i.forEach((e=>{\"number\"==typeof e.parent.id&&(o.has(e.parent.id)?o.get(e.parent.id).push(e.id):o.set(e.parent.id,[e.id]))})),i.forEach((e=>{const t={sublayer:e,...s},i=e.write({parentLayerId:\"number\"==typeof e.parent.id?e.parent.id:-1},t);if(o.has(e.id)&&(i.sublayerIds=o.get(e.id)),!e.sublayers&&e.name){const s=e.write({},t);delete s.id,r.layers.push(s)}})),r.visibleLayers=i.filter((e=>e.visible&&!e.sublayers)).map((e=>e.name))}createExportImageParameters(e,r,t,s){const o=s&&s.pixelRatio||1,i=S({extent:e,width:r})*o,a=new W({layer:this,scale:i}),{xmin:n,ymin:l,xmax:p,ymax:m,spatialReference:u}=e,y=$(u,this.spatialReferences),c=\"1.3.0\"===this.version&&_(y)?`${l},${n},${m},${p}`:`${n},${l},${p},${m}`,d=a.toJSON();return{bbox:c,[\"1.3.0\"===this.version?\"crs\":\"srs\"]:isNaN(y)?void 0:\"EPSG:\"+y,...d}}async fetchImage(e,r,t,s){var i,a;const n=this.mapUrl,l=this.createExportImageParameters(e,r,t,s);if(!l.layers){const e=document.createElement(\"canvas\");return e.width=r,e.height=t,e}const p=null==s||null==(i=s.timeExtent)?void 0:i.start,u=null==s||null==(a=s.timeExtent)?void 0:a.end,y=m(p)&&m(u)?p.getTime()===u.getTime()?N(p):`${N(p)}/${N(u)}`:void 0,c={responseType:\"image\",query:this._mixCustomParameters({width:r,height:t,...l,time:y}),signal:null==s?void 0:s.signal};return null!=s&&s.timestamp&&(c.query={_ts:s.timestamp,...c.query}),o(n,c).then((e=>e.data))}fetchFeatureInfo(e,r,o,i,a){const n=S({extent:e,width:r}),l=new W({layer:this,scale:n}),p=H(l.visibleSublayers);if(!this.featureInfoUrl||!p)return null;const m=\"1.3.0\"===this.version?{I:i,J:a}:{x:i,y:a},u={query_layers:p,request:\"GetFeatureInfo\",info_format:this.featureInfoFormat,feature_count:25,width:r,height:o,...m},y={...this.createExportImageParameters(e,r,o),...u},d=this._mixCustomParameters(y),f=c(this.featureInfoUrl,d),h=document.createElement(\"iframe\");h.src=f,h.frameBorder=\"0\",h.marginHeight=\"0\",h.marginWidth=\"0\",h.style.width=\"100%\",h.setAttribute(\"sandbox\",\"\");const g=new s({title:this.title,content:h});return new t({sourceLayer:this,popupTemplate:g})}findSublayerById(e){return this.allSublayers.find((r=>r.id===e))}findSublayerByName(e){return this.allSublayers.find((r=>r.name===e))}supportsSpatialReference(e){return q(this.url)||this.spatialReferences.some((r=>{const t=900913===r?j.WebMercator:new j({wkid:r});return I(t,e)}))}async _fetchService(e){if(!this.resourceInfo){this.parsedUrl.query&&this.parsedUrl.query.service&&(this.parsedUrl.query.SERVICE=this.parsedUrl.query.service,delete this.parsedUrl.query.service),this.parsedUrl.query&&this.parsedUrl.query.request&&(this.parsedUrl.query.REQUEST=this.parsedUrl.query.request,delete this.parsedUrl.query.request);const r=await o(this.parsedUrl.path,{query:{SERVICE:\"WMS\",REQUEST:\"GetCapabilities\",...this.parsedUrl.query,...this.customParameters},responseType:\"xml\",signal:e});this.resourceInfo=B(r.data)}if(this.parsedUrl){const e=new d(this.parsedUrl.path);\"https\"!==e.scheme||e.port&&\"443\"!==e.port||-1!==r.request.httpsDomains.indexOf(e.host)||r.request.httpsDomains.push(e.host)}this.read(this.resourceInfo,{origin:\"service\"})}_mixCustomParameters(e){if(!this.customLayerParameters&&!this.customParameters)return e;const r={...this.customParameters,...this.customLayerParameters};for(const t in r)e[t.toLowerCase()]=r[t];return e}};function D(e,r){return e.some((e=>{for(const t in e)if(w(e,t,null,r))return!0;return!1}))}function G(e,r,t){const s=new Map;e.every((e=>null==e.id))&&(e=p(e)).forEach(((e,r)=>e.id=r));for(const i of e){const e=new C;e.read(i,r),-1===(null==t?void 0:t.indexOf(e.name))&&(e.visible=!1),s.set(e.id,e)}const o=[];for(const a of e){const e=s.get(a.id);if(null!=a.parentLayerId&&a.parentLayerId>=0){const r=s.get(a.parentLayerId);r.sublayers||(r.sublayers=new i),r.sublayers.unshift(e)}else o.unshift(e)}return o}e([f({readOnly:!0})],A.prototype,\"allSublayers\",void 0),e([f({json:{type:Object,write:!0}})],A.prototype,\"customParameters\",void 0),e([f({json:{type:Object,write:!0}})],A.prototype,\"customLayerParameters\",void 0),e([f({type:String,json:{write:!0}})],A.prototype,\"copyright\",void 0),e([f()],A.prototype,\"description\",void 0),e([f({readOnly:!0})],A.prototype,\"dimensions\",void 0),e([f({json:{type:[[Number]],read:{source:\"extent\"},write:{target:\"extent\"},origins:{service:{read:{source:\"extent\"}}}}})],A.prototype,\"fullExtent\",void 0),e([g([\"web-document\",\"portal-item\"],\"fullExtent\",[\"extent\"])],A.prototype,\"readFullExtentFromItemOrMap\",null),e([x([\"web-document\",\"portal-item\"],\"fullExtent\",{extent:{type:[[Number]]}})],A.prototype,\"writeFullExtent\",null),e([f()],A.prototype,\"fullExtents\",void 0),e([f({type:String,json:{write:{ignoreOrigin:!0}}})],A.prototype,\"featureInfoFormat\",void 0),e([f({type:String,json:{write:{ignoreOrigin:!0}}})],A.prototype,\"featureInfoUrl\",void 0),e([f({type:String,json:{origins:{\"web-document\":{default:\"image/png\",type:k.jsonValues,read:{reader:k.read,source:\"format\"},write:{writer:k.write,target:\"format\"}}}}})],A.prototype,\"imageFormat\",void 0),e([g(\"imageFormat\",[\"supportedImageFormatTypes\"])],A.prototype,\"readImageFormat\",null),e([f({type:Number,json:{read:{source:\"maxHeight\"},write:{target:\"maxHeight\"}}})],A.prototype,\"imageMaxHeight\",void 0),e([f({type:Number,json:{read:{source:\"maxWidth\"},write:{target:\"maxWidth\"}}})],A.prototype,\"imageMaxWidth\",void 0),e([f()],A.prototype,\"imageTransparency\",void 0),e([f(M)],A.prototype,\"legendEnabled\",void 0),e([f({type:[\"show\",\"hide\",\"hide-children\"]})],A.prototype,\"listMode\",void 0),e([f({type:String,json:{write:{ignoreOrigin:!0}}})],A.prototype,\"mapUrl\",void 0),e([f({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],A.prototype,\"isReference\",void 0),e([f({type:[\"WMS\"]})],A.prototype,\"operationalLayerType\",void 0),e([f({type:j,json:{origins:{service:{read:{source:\"extent.spatialReference\"}}},write:!1}})],A.prototype,\"spatialReference\",void 0),e([g([\"web-document\",\"portal-item\"],\"spatialReference\",[\"spatialReferences\"])],A.prototype,\"readSpatialReferenceFromItemOrDocument\",null),e([f({type:[h],json:{read:{source:\"spatialReferences\"},write:{ignoreOrigin:!0}}})],A.prototype,\"spatialReferences\",void 0),e([x([\"web-document\",\"portal-item\"],\"spatialReferences\")],A.prototype,\"writeSpatialReferences\",null),e([f({type:i.ofType(C),json:{write:{target:\"layers\",overridePolicy(e,r,t){if(D(this.allSublayers,t))return{ignoreOrigin:!0}}}}})],A.prototype,\"sublayers\",void 0),e([g([\"web-document\",\"portal-item\"],\"sublayers\",[\"layers\",\"visibleLayers\"])],A.prototype,\"readSublayersFromItemOrMap\",null),e([g(\"service\",\"sublayers\",[\"layers\"])],A.prototype,\"readSublayers\",null),e([x(\"sublayers\",{layers:{type:[C]},visibleLayers:{type:[String]}})],A.prototype,\"writeSublayers\",null),e([f({json:{read:!1},readOnly:!0,value:\"wms\"})],A.prototype,\"type\",void 0),e([f(T)],A.prototype,\"url\",void 0),e([f({type:String,json:{write:{ignoreOrigin:!0}}})],A.prototype,\"version\",void 0),A=e([b(\"esri.layers.WMSLayer\")],A);var J=A;export default J;\n"]},"metadata":{},"sourceType":"module"}