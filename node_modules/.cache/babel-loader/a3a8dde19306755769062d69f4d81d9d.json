{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../../../core/maybe.js\";\nimport { c as t } from \"../../../../chunks/mat4f64.js\";\nimport { m as i, s as n } from \"../../../../chunks/vec3.js\";\nimport { c as s } from \"../../../../chunks/vec3f64.js\";\nimport { create as a, empty as r, expandWithVec3 as o, isPoint as h, center as l, offset as d } from \"../../../../geometry/support/aaBoundingBox.js\";\nimport { setContextFeature as c } from \"./featureExpressionInfoUtils.js\";\nimport { demResolutionForBoundingBox as g } from \"./graphicUtils.js\";\nimport { Object3DStateID as m } from \"../../webgl-engine/lib/Object3DStateID.js\";\n\nclass u {\n  constructor(e, t, i, n) {\n    this.graphics3DSymbolLayer = e, this.instanceIndex = t, this.elevationAligner = i, this.elevationContext = n, this.type = \"lod-instance\", this.alignedSampledElevation = 0, this.isElevationSource = !1, this.needsElevationUpdates = !1;\n  }\n\n  initialize() {}\n\n  setVisibility(e) {\n    const t = this.lodRenderer.instanceData;\n    e !== t.getVisible(this.instanceIndex) && t.setVisible(this.instanceIndex, e);\n  }\n\n  destroy() {\n    null != this.instanceIndex && (this.lodRenderer.instanceData.removeInstance(this.instanceIndex), this.graphics3DSymbolLayer.notifyDestroyGraphicLayer(this));\n  }\n\n  alignWithElevation(e, t, i) {\n    if (this.elevationAligner) {\n      c(this.elevationContext.featureExpressionInfoContext, i);\n      const n = this.elevationAligner(this, this.elevationContext, e, t);\n      null != n && (this.alignedSampledElevation = n);\n    }\n  }\n\n  getCenterObjectSpace(e = s()) {\n    return this.lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex, b), i(e, this.lodRenderer.baseBoundingSphere.center, b);\n  }\n\n  getBoundingBoxObjectSpace(e = a()) {\n    this.lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex, b);\n    const t = this.lodRenderer.baseBoundingBox;\n    r(e);\n\n    for (let s = 0; s < 8; ++s) n(f, 0 == (1 & s) ? t[0] : t[3], 0 == (2 & s) ? t[1] : t[4], 0 == (4 & s) ? t[2] : t[5]), i(f, f, b), o(e, f);\n\n    return e;\n  }\n\n  computeAttachmentOrigin(e) {\n    this.lodRenderer.instanceData.getGlobalTransform(this.instanceIndex, b), e.render.origin[0] += b[12], e.render.origin[1] += b[13], e.render.origin[2] += b[14], e.render.num++;\n  }\n\n  async getProjectedBoundingBox(t, n, s, a, o) {\n    const c = this.getBoundingBoxObjectSpace(o),\n          m = v,\n          u = h(c) ? 1 : m.length;\n    this.lodRenderer.instanceData.getGlobalTransform(this.instanceIndex, b);\n\n    for (let e = 0; e < u; e++) {\n      const t = m[e];\n      f[0] = c[t[0]], f[1] = c[t[1]], f[2] = c[t[2]], i(f, f, b), p[3 * e + 0] = f[0], p[3 * e + 1] = f[1], p[3 * e + 2] = f[2];\n    }\n\n    if (!t(p, 0, u)) return null;\n    r(c);\n    let I = null;\n    this.calculateRelativeScreenBounds && (I = this.calculateRelativeScreenBounds());\n\n    for (let e = 0; e < 3 * u; e += 3) {\n      for (let t = 0; t < 3; t++) c[t] = Math.min(c[t], p[e + t]), c[t + 3] = Math.max(c[t + 3], p[e + t]);\n\n      I && s.push({\n        location: p.slice(e, e + 3),\n        screenSpaceBoundingRect: I\n      });\n    }\n\n    if (n && (l(c, x), \"absolute-height\" !== this.elevationContext.mode)) {\n      let t;\n      const i = g(c, n);\n\n      try {\n        t = await n.service.queryElevation(x[0], x[1], a, i, \"ground\");\n      } catch (S) {}\n\n      e(t) && d(c, 0, 0, -this.alignedSampledElevation + t);\n    }\n\n    return c;\n  }\n\n  addObjectState(e, t) {\n    if (0 === e) {\n      const i = new m(e);\n      this.addHighlightId(i), t.addExternal(e => {\n        this.removeHighlightId(e);\n      }, i);\n    }\n  }\n\n  removeObjectState(e) {\n    this.highlights && this.highlights.forEach(t => e.remove(t));\n  }\n\n  addHighlightId(e) {\n    this.highlights = this.highlights || new Set(), this.highlights.add(e), this.lodRenderer.instanceData.setHighlight(this.instanceIndex, !0);\n  }\n\n  removeHighlightId(e) {\n    this.highlights && (this.highlights.delete(e), this.lodRenderer.instanceData.setHighlight(this.instanceIndex, this.highlights.size > 0), 0 === this.highlights.size && (this.highlights = null));\n  }\n\n  get lodRenderer() {\n    return this.graphics3DSymbolLayer.lodRenderer;\n  }\n\n}\n\nconst p = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n      f = s(),\n      x = s(),\n      v = [[0, 1, 2], [3, 1, 2], [0, 4, 2], [3, 4, 2], [0, 1, 5], [3, 1, 5], [0, 4, 5], [3, 4, 5]],\n      b = t();\nexport default u;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DLodInstanceGraphicLayer.js"],"names":["isSome","e","c","t","m","i","s","n","create","a","empty","r","expandWithVec3","o","isPoint","h","center","l","offset","d","setContextFeature","demResolutionForBoundingBox","g","Object3DStateID","u","constructor","graphics3DSymbolLayer","instanceIndex","elevationAligner","elevationContext","type","alignedSampledElevation","isElevationSource","needsElevationUpdates","initialize","setVisibility","lodRenderer","instanceData","getVisible","setVisible","destroy","removeInstance","notifyDestroyGraphicLayer","alignWithElevation","featureExpressionInfoContext","getCenterObjectSpace","getCombinedLocalTransform","b","baseBoundingSphere","getBoundingBoxObjectSpace","baseBoundingBox","f","computeAttachmentOrigin","getGlobalTransform","render","origin","num","getProjectedBoundingBox","v","length","p","I","calculateRelativeScreenBounds","Math","min","max","push","location","slice","screenSpaceBoundingRect","x","mode","service","queryElevation","S","addObjectState","addHighlightId","addExternal","removeHighlightId","removeObjectState","highlights","forEach","remove","Set","add","setHighlight","delete","size"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../../core/maybe.js\";import{c as t}from\"../../../../chunks/mat4f64.js\";import{m as i,s as n}from\"../../../../chunks/vec3.js\";import{c as s}from\"../../../../chunks/vec3f64.js\";import{create as a,empty as r,expandWithVec3 as o,isPoint as h,center as l,offset as d}from\"../../../../geometry/support/aaBoundingBox.js\";import{setContextFeature as c}from\"./featureExpressionInfoUtils.js\";import{demResolutionForBoundingBox as g}from\"./graphicUtils.js\";import{Object3DStateID as m}from\"../../webgl-engine/lib/Object3DStateID.js\";class u{constructor(e,t,i,n){this.graphics3DSymbolLayer=e,this.instanceIndex=t,this.elevationAligner=i,this.elevationContext=n,this.type=\"lod-instance\",this.alignedSampledElevation=0,this.isElevationSource=!1,this.needsElevationUpdates=!1}initialize(){}setVisibility(e){const t=this.lodRenderer.instanceData;e!==t.getVisible(this.instanceIndex)&&t.setVisible(this.instanceIndex,e)}destroy(){null!=this.instanceIndex&&(this.lodRenderer.instanceData.removeInstance(this.instanceIndex),this.graphics3DSymbolLayer.notifyDestroyGraphicLayer(this))}alignWithElevation(e,t,i){if(this.elevationAligner){c(this.elevationContext.featureExpressionInfoContext,i);const n=this.elevationAligner(this,this.elevationContext,e,t);null!=n&&(this.alignedSampledElevation=n)}}getCenterObjectSpace(e=s()){return this.lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex,b),i(e,this.lodRenderer.baseBoundingSphere.center,b)}getBoundingBoxObjectSpace(e=a()){this.lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex,b);const t=this.lodRenderer.baseBoundingBox;r(e);for(let s=0;s<8;++s)n(f,0==(1&s)?t[0]:t[3],0==(2&s)?t[1]:t[4],0==(4&s)?t[2]:t[5]),i(f,f,b),o(e,f);return e}computeAttachmentOrigin(e){this.lodRenderer.instanceData.getGlobalTransform(this.instanceIndex,b),e.render.origin[0]+=b[12],e.render.origin[1]+=b[13],e.render.origin[2]+=b[14],e.render.num++}async getProjectedBoundingBox(t,n,s,a,o){const c=this.getBoundingBoxObjectSpace(o),m=v,u=h(c)?1:m.length;this.lodRenderer.instanceData.getGlobalTransform(this.instanceIndex,b);for(let e=0;e<u;e++){const t=m[e];f[0]=c[t[0]],f[1]=c[t[1]],f[2]=c[t[2]],i(f,f,b),p[3*e+0]=f[0],p[3*e+1]=f[1],p[3*e+2]=f[2]}if(!t(p,0,u))return null;r(c);let I=null;this.calculateRelativeScreenBounds&&(I=this.calculateRelativeScreenBounds());for(let e=0;e<3*u;e+=3){for(let t=0;t<3;t++)c[t]=Math.min(c[t],p[e+t]),c[t+3]=Math.max(c[t+3],p[e+t]);I&&s.push({location:p.slice(e,e+3),screenSpaceBoundingRect:I})}if(n&&(l(c,x),\"absolute-height\"!==this.elevationContext.mode)){let t;const i=g(c,n);try{t=await n.service.queryElevation(x[0],x[1],a,i,\"ground\")}catch(S){}e(t)&&d(c,0,0,-this.alignedSampledElevation+t)}return c}addObjectState(e,t){if(0===e){const i=new m(e);this.addHighlightId(i),t.addExternal((e=>{this.removeHighlightId(e)}),i)}}removeObjectState(e){this.highlights&&this.highlights.forEach((t=>e.remove(t)))}addHighlightId(e){this.highlights=this.highlights||new Set,this.highlights.add(e),this.lodRenderer.instanceData.setHighlight(this.instanceIndex,!0)}removeHighlightId(e){this.highlights&&(this.highlights.delete(e),this.lodRenderer.instanceData.setHighlight(this.instanceIndex,this.highlights.size>0),0===this.highlights.size&&(this.highlights=null))}get lodRenderer(){return this.graphics3DSymbolLayer.lodRenderer}}const p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=s(),x=s(),v=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],b=t();export default u;\n"]},"metadata":{},"sourceType":"module"}