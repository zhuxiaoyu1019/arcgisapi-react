{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Accessor.js\";\nimport { property as s } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/Logger.js\";\nimport { subclass as r } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { d as o } from \"../../../chunks/vec2.js\";\nimport { QueueProcessor as i } from \"../../support/QueueProcessor.js\";\n\nfunction n(e, t) {\n  return e.length = 0, t.forEach(t => e.push(t)), e;\n}\n\nconst u = new Set(),\n      c = [],\n      a = new Map(),\n      h = [0, 0];\nlet l = class extends t {\n  constructor(e) {\n    super(e), this._keyToItem = new Map(), this.concurrency = 6, this.strategy = \"scale-first\", this.tileInfoView = null;\n  }\n\n  initialize() {\n    const {\n      concurrency: e,\n      process: t,\n      strategy: s\n    } = this;\n    this._queue = new i({\n      concurrency: e,\n      process: (e, s) => {\n        const r = this._keyToItem.get(e);\n\n        return t(r, {\n          signal: s\n        });\n      },\n      peeker: \"scale-first\" === s ? e => this._peekByScaleFirst(e) : e => this._peekByCenterFirst(e)\n    });\n  }\n\n  destroy() {\n    this.clear(), this._queue.destroy(), this._queue = null;\n  }\n\n  get length() {\n    return this._queue ? this._queue.length : 0;\n  }\n\n  get onGoingCount() {\n    return this._keyToItem.size;\n  }\n\n  get updating() {\n    return this.length > 0 || this.onGoingCount > 0;\n  }\n\n  abort(e) {\n    const t = \"string\" == typeof e ? e : e.id;\n\n    this._queue.abort(t);\n  }\n\n  clear() {\n    this._queue.clear(), this._keyToItem.clear(), this.notifyChange(\"updating\");\n  }\n\n  has(e) {\n    return \"string\" == typeof e ? this._keyToItem.has(e) : this._keyToItem.has(e.id);\n  }\n\n  isOngoing(e) {\n    const t = \"string\" == typeof e ? e : e.id;\n    return this.has(t) && this._queue.isOngoing(t);\n  }\n\n  pause() {\n    this._queue.pause();\n  }\n\n  push(e) {\n    const t = e.key.id;\n    if (this._queue.has(t)) return this._queue.get(t);\n\n    const s = this._queue.push(t),\n          r = () => {\n      this._keyToItem.delete(t), this.notifyChange(\"updating\");\n    };\n\n    return this._keyToItem.set(t, e), s.then(r, r), this.notifyChange(\"updating\"), s;\n  }\n\n  reset() {\n    this._queue.reset();\n  }\n\n  resume() {\n    this._queue.resume();\n  }\n\n  _peekByScaleFirst(e) {\n    if (!this.state) return e.values().next().value;\n    const t = this.tileInfoView;\n    let s = Number.NEGATIVE_INFINITY,\n        r = Number.POSITIVE_INFINITY;\n    e.forEach(e => {\n      const t = this._keyToItem.get(e),\n            o = this.tileInfoView.getTileScale(t.key);\n\n      a.has(o) || (a.set(o, []), s = Math.max(o, s), r = Math.min(o, r)), a.get(o).push(t.key), u.add(o);\n    });\n    let o = this.state.scale;\n    a.has(o) || (n(c, u), c.sort(), o = c.reduce((e, t) => Math.abs(t - o) < Math.abs(e - o) ? t : e, c[0])), o = Math.min(o, s), o = Math.max(o, r);\n    const i = a.get(o),\n          h = t.getClosestInfoForScale(o),\n          l = h.getColumnForX(this.state.center[0]),\n          p = h.getRowForY(this.state.center[1]);\n    return i.sort((e, t) => {\n      const s = h.denormalizeCol(e.col, e.world),\n            r = h.denormalizeCol(t.col, t.world);\n      return Math.sqrt((l - s) * (l - s) + (p - e.row) * (p - e.row)) - Math.sqrt((l - r) * (l - r) + (p - t.row) * (p - t.row));\n    }), u.clear(), a.clear(), i[0].id;\n  }\n\n  _peekByCenterFirst(e) {\n    if (!this.state) return e.values().next().value;\n    const t = this.tileInfoView,\n          s = this.state.center;\n    let r = Number.POSITIVE_INFINITY,\n        i = null;\n    return e.forEach(e => {\n      const n = this._keyToItem.get(e);\n\n      t.getTileCoords(h, n.key);\n      const u = o(h, s);\n      u < r && (r = u, i = n.key);\n    }), i.id;\n  }\n\n};\ne([s({\n  constructOnly: !0\n})], l.prototype, \"concurrency\", void 0), e([s({\n  constructOnly: !0\n})], l.prototype, \"process\", void 0), e([s()], l.prototype, \"state\", void 0), e([s({\n  constructOnly: !0\n})], l.prototype, \"strategy\", void 0), e([s({\n  constructOnly: !0\n})], l.prototype, \"tileInfoView\", void 0), e([s({\n  readOnly: !0\n})], l.prototype, \"updating\", null), l = e([r(\"esri.views.2d.tiling.TileQueue\")], l);\nvar p = l;\nexport default p;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/2d/tiling/TileQueue.js"],"names":["_","e","t","property","s","subclass","r","d","o","QueueProcessor","i","n","length","forEach","push","u","Set","c","a","Map","h","l","constructor","_keyToItem","concurrency","strategy","tileInfoView","initialize","process","_queue","get","signal","peeker","_peekByScaleFirst","_peekByCenterFirst","destroy","clear","onGoingCount","size","updating","abort","id","notifyChange","has","isOngoing","pause","key","delete","set","then","reset","resume","state","values","next","value","Number","NEGATIVE_INFINITY","POSITIVE_INFINITY","getTileScale","Math","max","min","add","scale","sort","reduce","abs","getClosestInfoForScale","getColumnForX","center","p","getRowForY","denormalizeCol","col","world","sqrt","row","getTileCoords","constructOnly","prototype","readOnly"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Accessor.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as r}from\"../../../core/accessorSupport/decorators/subclass.js\";import{d as o}from\"../../../chunks/vec2.js\";import{QueueProcessor as i}from\"../../support/QueueProcessor.js\";function n(e,t){return e.length=0,t.forEach((t=>e.push(t))),e}const u=new Set,c=[],a=new Map,h=[0,0];let l=class extends t{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy=\"scale-first\",this.tileInfoView=null}initialize(){const{concurrency:e,process:t,strategy:s}=this;this._queue=new i({concurrency:e,process:(e,s)=>{const r=this._keyToItem.get(e);return t(r,{signal:s})},peeker:\"scale-first\"===s?e=>this._peekByScaleFirst(e):e=>this._peekByCenterFirst(e)})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const t=\"string\"==typeof e?e:e.id;this._queue.abort(t)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange(\"updating\")}has(e){return\"string\"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const t=\"string\"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause()}push(e){const t=e.key.id;if(this._queue.has(t))return this._queue.get(t);const s=this._queue.push(t),r=()=>{this._keyToItem.delete(t),this.notifyChange(\"updating\")};return this._keyToItem.set(t,e),s.then(r,r),this.notifyChange(\"updating\"),s}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView;let s=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach((e=>{const t=this._keyToItem.get(e),o=this.tileInfoView.getTileScale(t.key);a.has(o)||(a.set(o,[]),s=Math.max(o,s),r=Math.min(o,r)),a.get(o).push(t.key),u.add(o)}));let o=this.state.scale;a.has(o)||(n(c,u),c.sort(),o=c.reduce(((e,t)=>Math.abs(t-o)<Math.abs(e-o)?t:e),c[0])),o=Math.min(o,s),o=Math.max(o,r);const i=a.get(o),h=t.getClosestInfoForScale(o),l=h.getColumnForX(this.state.center[0]),p=h.getRowForY(this.state.center[1]);return i.sort(((e,t)=>{const s=h.denormalizeCol(e.col,e.world),r=h.denormalizeCol(t.col,t.world);return Math.sqrt((l-s)*(l-s)+(p-e.row)*(p-e.row))-Math.sqrt((l-r)*(l-r)+(p-t.row)*(p-t.row))})),u.clear(),a.clear(),i[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView,s=this.state.center;let r=Number.POSITIVE_INFINITY,i=null;return e.forEach((e=>{const n=this._keyToItem.get(e);t.getTileCoords(h,n.key);const u=o(h,s);u<r&&(r=u,i=n.key)})),i.id}};e([s({constructOnly:!0})],l.prototype,\"concurrency\",void 0),e([s({constructOnly:!0})],l.prototype,\"process\",void 0),e([s()],l.prototype,\"state\",void 0),e([s({constructOnly:!0})],l.prototype,\"strategy\",void 0),e([s({constructOnly:!0})],l.prototype,\"tileInfoView\",void 0),e([s({readOnly:!0})],l.prototype,\"updating\",null),l=e([r(\"esri.views.2d.tiling.TileQueue\")],l);var p=l;export default p;\n"]},"metadata":{},"sourceType":"module"}