{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { AutoDisposable as t } from \"../../lib/AutoDisposable.js\";\n\nclass e extends t {\n  constructor() {\n    super(...arguments), this._bucket = null, this._bucketIndex = 0;\n  }\n\n  get bucketKey() {\n    return this._bucket.key;\n  }\n\n}\n\nclass s {\n  constructor() {\n    this._buckets = new Map();\n  }\n\n  add(t, e) {\n    const s = this._getBucket(t);\n\n    e._bucket = s, e._bucketIndex = s.count, s.data.push(e), ++s.statistics.added;\n  }\n\n  remove(t) {\n    ++t._bucket.statistics.removed;\n    const e = t._bucket.data,\n          s = e[e.length - 1];\n    e[t._bucketIndex] = s, s._bucketIndex = t._bucketIndex, e.pop(), t._bucket = null, t._bucketIndex = 0;\n  }\n\n  updateKey(t, e) {\n    this.remove(t), this.add(e, t);\n  }\n\n  getBucket(t) {\n    return this._getBucket(t).data;\n  }\n\n  getPerformanceInfo(t) {\n    return this._getBucket(t).statistics;\n  }\n\n  forEach(t) {\n    this._buckets.forEach(e => t(e.data, e.key));\n  }\n\n  get count() {\n    let t = 0;\n    return this._buckets.forEach(e => t += e.count), t;\n  }\n\n  _getBucket(t) {\n    const e = this._buckets.get(t);\n\n    if (e) return e;\n    const s = new c(t);\n    return this._buckets.set(t, s), s;\n  }\n\n}\n\nclass c {\n  constructor(t) {\n    this.key = t, this.data = new Array(), this.statistics = {\n      added: 0,\n      removed: 0\n    };\n  }\n\n  get count() {\n    return this.data.length;\n  }\n\n}\n\nexport { e as BucketStorable, s as BucketedObjectStore };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/webgl-engine/core/util/BucketedObjectStore.js"],"names":["AutoDisposable","t","e","constructor","arguments","_bucket","_bucketIndex","bucketKey","key","s","_buckets","Map","add","_getBucket","count","data","push","statistics","added","remove","removed","length","pop","updateKey","getBucket","getPerformanceInfo","forEach","get","c","set","Array","BucketStorable","BucketedObjectStore"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{AutoDisposable as t}from\"../../lib/AutoDisposable.js\";class e extends t{constructor(){super(...arguments),this._bucket=null,this._bucketIndex=0}get bucketKey(){return this._bucket.key}}class s{constructor(){this._buckets=new Map}add(t,e){const s=this._getBucket(t);e._bucket=s,e._bucketIndex=s.count,s.data.push(e),++s.statistics.added}remove(t){++t._bucket.statistics.removed;const e=t._bucket.data,s=e[e.length-1];e[t._bucketIndex]=s,s._bucketIndex=t._bucketIndex,e.pop(),t._bucket=null,t._bucketIndex=0}updateKey(t,e){this.remove(t),this.add(e,t)}getBucket(t){return this._getBucket(t).data}getPerformanceInfo(t){return this._getBucket(t).statistics}forEach(t){this._buckets.forEach((e=>t(e.data,e.key)))}get count(){let t=0;return this._buckets.forEach((e=>t+=e.count)),t}_getBucket(t){const e=this._buckets.get(t);if(e)return e;const s=new c(t);return this._buckets.set(t,s),s}}class c{constructor(t){this.key=t,this.data=new Array,this.statistics={added:0,removed:0}}get count(){return this.data.length}}export{e as BucketStorable,s as BucketedObjectStore};\n"]},"metadata":{},"sourceType":"module"}