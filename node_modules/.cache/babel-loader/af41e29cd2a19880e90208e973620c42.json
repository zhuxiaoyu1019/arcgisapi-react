{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { px2pt as t } from \"../../core/screenUtils.js\";\nimport { CIMSymbolRasterizer as e } from \"../cim/CIMSymbolRasterizer.js\";\nimport { getCIMSymbolSize as a, scaleCIMSymbolTo as l } from \"./cimSymbolUtils.js\";\nconst i = new e(null, !0),\n      o = 120;\n\nasync function n(e, n = {}) {\n  const {\n    size: s,\n    maxSize: c,\n    node: m,\n    opacity: r\n  } = n,\n        y = n.cimOptions || n,\n        {\n    feature: d,\n    fieldMap: h,\n    geometryType: p,\n    style: u\n  } = y,\n        g = a(e),\n        f = Math.min(null != s ? s : g, null != c ? c : t(o));\n  f !== g && (e = e.clone(), l(e, f, {\n    preserveOutlineWidth: !0\n  }));\n  let M = 3;\n  e && e.data && e.data.symbol && \"CIMPointSymbol\" !== e.data.symbol.type && (M = 1);\n  const b = await i.rasterizeCIMSymbolAsync(e, d, h, p, {\n    scaleFactor: M,\n    style: u\n  }),\n        w = document.createElement(\"canvas\");\n  w.width = b.imageData.width, w.height = b.imageData.height;\n  w.getContext(\"2d\").putImageData(b.imageData, 0, 0);\n  let C = w.width / M,\n      D = w.height / M;\n\n  if (null != s && (null == (null == n ? void 0 : n.scale) || (null == n ? void 0 : n.scale))) {\n    const t = C / D;\n    C = t <= 1 ? Math.ceil(f * t) : f, D = t <= 1 ? f : Math.ceil(f / t);\n  }\n\n  const I = new Image(C, D);\n  return I.src = w.toDataURL(), null != r && (I.style.opacity = `${r}`), m && m.appendChild(I), I;\n}\n\nexport { n as previewCIMSymbol };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/symbols/support/previewCIMSymbol.js"],"names":["px2pt","t","CIMSymbolRasterizer","e","getCIMSymbolSize","a","scaleCIMSymbolTo","l","i","o","n","size","s","maxSize","c","node","m","opacity","r","y","cimOptions","feature","d","fieldMap","h","geometryType","p","style","u","g","f","Math","min","clone","preserveOutlineWidth","M","data","symbol","type","b","rasterizeCIMSymbolAsync","scaleFactor","w","document","createElement","width","imageData","height","getContext","putImageData","C","D","scale","ceil","I","Image","src","toDataURL","appendChild","previewCIMSymbol"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{px2pt as t}from\"../../core/screenUtils.js\";import{CIMSymbolRasterizer as e}from\"../cim/CIMSymbolRasterizer.js\";import{getCIMSymbolSize as a,scaleCIMSymbolTo as l}from\"./cimSymbolUtils.js\";const i=new e(null,!0),o=120;async function n(e,n={}){const{size:s,maxSize:c,node:m,opacity:r}=n,y=n.cimOptions||n,{feature:d,fieldMap:h,geometryType:p,style:u}=y,g=a(e),f=Math.min(null!=s?s:g,null!=c?c:t(o));f!==g&&(e=e.clone(),l(e,f,{preserveOutlineWidth:!0}));let M=3;e&&e.data&&e.data.symbol&&\"CIMPointSymbol\"!==e.data.symbol.type&&(M=1);const b=await i.rasterizeCIMSymbolAsync(e,d,h,p,{scaleFactor:M,style:u}),w=document.createElement(\"canvas\");w.width=b.imageData.width,w.height=b.imageData.height;w.getContext(\"2d\").putImageData(b.imageData,0,0);let C=w.width/M,D=w.height/M;if(null!=s&&(null==(null==n?void 0:n.scale)||(null==n?void 0:n.scale))){const t=C/D;C=t<=1?Math.ceil(f*t):f,D=t<=1?f:Math.ceil(f/t)}const I=new Image(C,D);return I.src=w.toDataURL(),null!=r&&(I.style.opacity=`${r}`),m&&m.appendChild(I),I}export{n as previewCIMSymbol};\n"]},"metadata":{},"sourceType":"module"}