{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport \"../../geometry.js\";\nimport r from \"../../core/Collection.js\";\nimport t from \"../../core/Evented.js\";\nimport { JSONSupportMixin as s } from \"../../core/JSONSupport.js\";\nimport o from \"../../core/Loadable.js\";\nimport { isSome as i } from \"../../core/maybe.js\";\nimport { stripHTML as l } from \"../../core/string.js\";\nimport { whenOnce as a, whenTrueOnce as n } from \"../../core/watchUtils.js\";\nimport { property as u } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/has.js\";\nimport { cast as p } from \"../../core/accessorSupport/decorators/cast.js\";\nimport \"../../core/Logger.js\";\nimport { reader as y } from \"../../core/accessorSupport/decorators/reader.js\";\nimport { subclass as h } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { ensureType as c } from \"../../core/accessorSupport/ensureType.js\";\nimport { computeExtent as m, sublayersFromJSON as d, fetchService as b, parseKML as f } from \"./kmlUtils.js\";\nimport v from \"../../geometry/Extent.js\";\nvar j;\nlet S = j = class extends t.EventedMixin(s(o)) {\n  constructor() {\n    super(...arguments), this._sublayersHandles = null, this.description = null, this.id = null, this.networkLink = null, this.title = null, this.sourceJSON = null, this.fullExtent = null;\n  }\n\n  initialize() {\n    a(this, \"networkLink\").then(() => n(this, \"visible\")).then(() => this.load());\n  }\n\n  load(e) {\n    if (!this.networkLink) return;\n    if (this.networkLink.viewFormat) return;\n\n    const t = i(e) ? e.signal : null,\n          s = this._fetchService(this._get(\"networkLink\").href, t).then(e => {\n      const t = m(e.sublayers);\n      this.fullExtent = v.fromJSON(t), this.sourceJSON = e;\n      const s = c(r.ofType(j), d(j, e));\n      this.sublayers ? this.sublayers.addMany(s) : this.sublayers = s, this.layer.emit(\"sublayer-update\"), this.layer && this.layer.notifyChange(\"visibleSublayers\");\n    });\n\n    return this.addResolvingPromise(s), Promise.resolve(this);\n  }\n\n  set sublayers(e) {\n    const r = this._get(\"sublayers\");\n\n    r && (r.forEach(e => {\n      e.parent = null, e.layer = null;\n    }), this._sublayersHandles.forEach(e => e.remove()), this._sublayersHandles = null), e && (e.forEach(e => {\n      e.parent = this, e.layer = this.layer;\n    }), this._sublayersHandles = [e.on(\"after-add\", ({\n      item: e\n    }) => {\n      e.parent = this, e.layer = this.layer;\n    }), e.on(\"after-remove\", ({\n      item: e\n    }) => {\n      e.parent = null, e.layer = null;\n    })]), this._set(\"sublayers\", e);\n  }\n\n  castSublayers(e) {\n    return c(r.ofType(j), e);\n  }\n\n  get visible() {\n    return this._get(\"visible\");\n  }\n\n  set visible(e) {\n    this._get(\"visible\") !== e && (this._set(\"visible\", e), this.layer && this.layer.notifyChange(\"visibleSublayers\"));\n  }\n\n  readVisible(e, r) {\n    return !!r.visibility;\n  }\n\n  set layer(e) {\n    this._set(\"layer\", e), this.sublayers && this.sublayers.forEach(r => r.layer = e);\n  }\n\n  _fetchService(e, r) {\n    return b(e, this.layer.outSpatialReference, this.layer.refreshInterval, r).then(e => f(e.data));\n  }\n\n};\ne([u()], S.prototype, \"description\", void 0), e([u()], S.prototype, \"id\", void 0), e([u({\n  readOnly: !0,\n  value: null\n})], S.prototype, \"networkLink\", void 0), e([u({\n  json: {\n    write: {\n      allowNull: !0\n    }\n  }\n})], S.prototype, \"parent\", void 0), e([u({\n  value: null,\n  json: {\n    write: {\n      allowNull: !0\n    }\n  }\n})], S.prototype, \"sublayers\", null), e([p(\"sublayers\")], S.prototype, \"castSublayers\", null), e([u({\n  value: null,\n  json: {\n    read: {\n      source: \"name\",\n      reader: e => l(e)\n    }\n  }\n})], S.prototype, \"title\", void 0), e([u({\n  value: !0\n})], S.prototype, \"visible\", null), e([y(\"visible\", [\"visibility\"])], S.prototype, \"readVisible\", null), e([u()], S.prototype, \"sourceJSON\", void 0), e([u({\n  value: null\n})], S.prototype, \"layer\", null), e([u({\n  type: v\n})], S.prototype, \"fullExtent\", void 0), S = j = e([h(\"esri.layers.support.KMLSublayer\")], S);\nvar g = S;\nexport default g;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/layers/support/KMLSublayer.js"],"names":["_","e","r","t","JSONSupportMixin","s","o","isSome","i","stripHTML","l","whenOnce","a","whenTrueOnce","n","property","u","cast","p","reader","y","subclass","h","ensureType","c","computeExtent","m","sublayersFromJSON","d","fetchService","b","parseKML","f","v","j","S","EventedMixin","constructor","arguments","_sublayersHandles","description","id","networkLink","title","sourceJSON","fullExtent","initialize","then","load","viewFormat","signal","_fetchService","_get","href","sublayers","fromJSON","ofType","addMany","layer","emit","notifyChange","addResolvingPromise","Promise","resolve","forEach","parent","remove","on","item","_set","castSublayers","visible","readVisible","visibility","outSpatialReference","refreshInterval","data","prototype","readOnly","value","json","write","allowNull","read","source","type","g"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import r from\"../../core/Collection.js\";import t from\"../../core/Evented.js\";import{JSONSupportMixin as s}from\"../../core/JSONSupport.js\";import o from\"../../core/Loadable.js\";import{isSome as i}from\"../../core/maybe.js\";import{stripHTML as l}from\"../../core/string.js\";import{whenOnce as a,whenTrueOnce as n}from\"../../core/watchUtils.js\";import{property as u}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import{cast as p}from\"../../core/accessorSupport/decorators/cast.js\";import\"../../core/Logger.js\";import{reader as y}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as h}from\"../../core/accessorSupport/decorators/subclass.js\";import{ensureType as c}from\"../../core/accessorSupport/ensureType.js\";import{computeExtent as m,sublayersFromJSON as d,fetchService as b,parseKML as f}from\"./kmlUtils.js\";import v from\"../../geometry/Extent.js\";var j;let S=j=class extends(t.EventedMixin(s(o))){constructor(){super(...arguments),this._sublayersHandles=null,this.description=null,this.id=null,this.networkLink=null,this.title=null,this.sourceJSON=null,this.fullExtent=null}initialize(){a(this,\"networkLink\").then((()=>n(this,\"visible\"))).then((()=>this.load()))}load(e){if(!this.networkLink)return;if(this.networkLink.viewFormat)return;const t=i(e)?e.signal:null,s=this._fetchService(this._get(\"networkLink\").href,t).then((e=>{const t=m(e.sublayers);this.fullExtent=v.fromJSON(t),this.sourceJSON=e;const s=c(r.ofType(j),d(j,e));this.sublayers?this.sublayers.addMany(s):this.sublayers=s,this.layer.emit(\"sublayer-update\"),this.layer&&this.layer.notifyChange(\"visibleSublayers\")}));return this.addResolvingPromise(s),Promise.resolve(this)}set sublayers(e){const r=this._get(\"sublayers\");r&&(r.forEach((e=>{e.parent=null,e.layer=null})),this._sublayersHandles.forEach((e=>e.remove())),this._sublayersHandles=null),e&&(e.forEach((e=>{e.parent=this,e.layer=this.layer})),this._sublayersHandles=[e.on(\"after-add\",(({item:e})=>{e.parent=this,e.layer=this.layer})),e.on(\"after-remove\",(({item:e})=>{e.parent=null,e.layer=null}))]),this._set(\"sublayers\",e)}castSublayers(e){return c(r.ofType(j),e)}get visible(){return this._get(\"visible\")}set visible(e){this._get(\"visible\")!==e&&(this._set(\"visible\",e),this.layer&&this.layer.notifyChange(\"visibleSublayers\"))}readVisible(e,r){return!!r.visibility}set layer(e){this._set(\"layer\",e),this.sublayers&&this.sublayers.forEach((r=>r.layer=e))}_fetchService(e,r){return b(e,this.layer.outSpatialReference,this.layer.refreshInterval,r).then((e=>f(e.data)))}};e([u()],S.prototype,\"description\",void 0),e([u()],S.prototype,\"id\",void 0),e([u({readOnly:!0,value:null})],S.prototype,\"networkLink\",void 0),e([u({json:{write:{allowNull:!0}}})],S.prototype,\"parent\",void 0),e([u({value:null,json:{write:{allowNull:!0}}})],S.prototype,\"sublayers\",null),e([p(\"sublayers\")],S.prototype,\"castSublayers\",null),e([u({value:null,json:{read:{source:\"name\",reader:e=>l(e)}}})],S.prototype,\"title\",void 0),e([u({value:!0})],S.prototype,\"visible\",null),e([y(\"visible\",[\"visibility\"])],S.prototype,\"readVisible\",null),e([u()],S.prototype,\"sourceJSON\",void 0),e([u({value:null})],S.prototype,\"layer\",null),e([u({type:v})],S.prototype,\"fullExtent\",void 0),S=j=e([h(\"esri.layers.support.KMLSublayer\")],S);var g=S;export default g;\n"]},"metadata":{},"sourceType":"module"}