{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isNone as e } from \"../../../../../../core/maybe.js\";\nimport { THIN_LINE_HALF_WIDTH_THRESHOLD as t } from \"../../definitions.js\";\nimport { WGLGeometryType as i } from \"../../enums.js\";\nimport { i1616to32 as s, i8888to32 as r } from \"../../number.js\";\nimport { LineTessellation as o } from \"../../TurboLine.js\";\nimport { LineMaterialKey as n } from \"../../materialKey/MaterialKey.js\";\nimport { clipLinesMarshall as l } from \"./templateUtils.js\";\n\nconst a = 8,\n      h = 31,\n      p = 1024,\n      m = 65535,\n      d = s => class extends s {\n  constructor(...e) {\n    super(...e), this.tessellationProperties = {}, this._tessellationOptions = {\n      halfWidth: 0,\n      pixelCoordRatio: 1,\n      offset: 0\n    }, this.geometryType = i.LINE;\n  }\n\n  _initializeTessellator(e) {\n    const i = n.load(this._materialKey),\n          s = this._tessellationOptions,\n          r = i.vvSizeFieldStops || i.vvSizeMinMaxValue || i.vvSizeScaleStops || i.vvSizeUnitValue,\n          l = this.tessellationProperties._halfWidth < t;\n    this.tessellationProperties.minMaxZoom = this._minMaxZoom;\n    const a = l && !e && !r;\n    s.wrapDistance = m, s.textured = this._isDashed || this._hasPattern, s.offset = this.tessellationProperties.offset, s.halfWidth = this.tessellationProperties._halfWidth;\n    const h = a ? 0 : 1;\n    this._lineTessellator = new o(f(this.tessellationProperties, h, h), u(this.tessellationProperties), a);\n  }\n\n  _write(e, t, i) {\n    const s = \"esriGeometryPoint\" === t.geometryType;\n    e.recordStart(t.getDisplayId(), this._materialKey, this.geometryType, !1, s), this._writeGeometry(e, t, i, s), e.recordEnd();\n  }\n\n  _writeGeometry(t, i, s, r) {\n    const o = null != s ? s : i.readLegacyGeometry(),\n          n = this._getLines(o, r);\n\n    e(n) || this._writeVertices(t, i, n);\n  }\n\n  _getLines(t, i) {\n    if (e(t)) return null;\n    const s = t.paths || t.rings;\n    if (e(s)) return null;\n    return l(s, i ? 256 : 16);\n  }\n\n  _writeVertices(e, t, i) {\n    const s = t.getDisplayId(),\n          r = e.vertexCount(),\n          o = this.tessellationProperties,\n          n = this._tessellationOptions;\n    o.out = e, o.id = s, o.indexCount = 0, o.vertexCount = 0, o.offset = r, n.capType = this._capType, n.joinType = this._joinType;\n\n    for (const {\n      line: l,\n      start: a\n    } of i) n.initialDistance = a % m, this._lineTessellator.tessellate(l, n);\n  }\n\n},\n      f = (e, t, i) => (o, n, l, m, d, f, u, c, x, _, v) => {\n  const y = s(v, Math.ceil(p * e._halfWidth)),\n        W = r(Math.round(h * u), Math.round(h * c), Math.round(h * x), Math.round(h * _)),\n        M = r(h * d, h * f, 0, e._bitset),\n        T = e.out;\n  return T.vertexBounds(o, n, t, i), T.vertexWrite(s(a * o, a * n)), T.vertexWrite(e.id), T.vertexWrite(e._fillColor), T.vertexWrite(W), T.vertexWrite(y), T.vertexWrite(e._tl), T.vertexWrite(e._br), T.vertexWrite(M), T.vertexWrite(s(Math.ceil(p * e._halfReferenceWidth), 0)), T.vertexWrite(e.minMaxZoom), T.vertexEnd(), e.offset + e.vertexCount++;\n},\n      u = e => (t, i, s) => {\n  const r = e.out;\n  r.indexWrite(t), r.indexWrite(i), r.indexWrite(s), e.indexCount += 3;\n};\n\nexport default d;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate.js"],"names":["isNone","e","THIN_LINE_HALF_WIDTH_THRESHOLD","t","WGLGeometryType","i","i1616to32","s","i8888to32","r","LineTessellation","o","LineMaterialKey","n","clipLinesMarshall","l","a","h","p","m","d","constructor","tessellationProperties","_tessellationOptions","halfWidth","pixelCoordRatio","offset","geometryType","LINE","_initializeTessellator","load","_materialKey","vvSizeFieldStops","vvSizeMinMaxValue","vvSizeScaleStops","vvSizeUnitValue","_halfWidth","minMaxZoom","_minMaxZoom","wrapDistance","textured","_isDashed","_hasPattern","_lineTessellator","f","u","_write","recordStart","getDisplayId","_writeGeometry","recordEnd","readLegacyGeometry","_getLines","_writeVertices","paths","rings","vertexCount","out","id","indexCount","capType","_capType","joinType","_joinType","line","start","initialDistance","tessellate","c","x","_","v","y","Math","ceil","W","round","M","_bitset","T","vertexBounds","vertexWrite","_fillColor","_tl","_br","_halfReferenceWidth","vertexEnd","indexWrite"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isNone as e}from\"../../../../../../core/maybe.js\";import{THIN_LINE_HALF_WIDTH_THRESHOLD as t}from\"../../definitions.js\";import{WGLGeometryType as i}from\"../../enums.js\";import{i1616to32 as s,i8888to32 as r}from\"../../number.js\";import{LineTessellation as o}from\"../../TurboLine.js\";import{LineMaterialKey as n}from\"../../materialKey/MaterialKey.js\";import{clipLinesMarshall as l}from\"./templateUtils.js\";const a=8,h=31,p=1024,m=65535,d=s=>class extends s{constructor(...e){super(...e),this.tessellationProperties={},this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0},this.geometryType=i.LINE}_initializeTessellator(e){const i=n.load(this._materialKey),s=this._tessellationOptions,r=i.vvSizeFieldStops||i.vvSizeMinMaxValue||i.vvSizeScaleStops||i.vvSizeUnitValue,l=this.tessellationProperties._halfWidth<t;this.tessellationProperties.minMaxZoom=this._minMaxZoom;const a=l&&!e&&!r;s.wrapDistance=m,s.textured=this._isDashed||this._hasPattern,s.offset=this.tessellationProperties.offset,s.halfWidth=this.tessellationProperties._halfWidth;const h=a?0:1;this._lineTessellator=new o(f(this.tessellationProperties,h,h),u(this.tessellationProperties),a)}_write(e,t,i){const s=\"esriGeometryPoint\"===t.geometryType;e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,!1,s),this._writeGeometry(e,t,i,s),e.recordEnd()}_writeGeometry(t,i,s,r){const o=null!=s?s:i.readLegacyGeometry(),n=this._getLines(o,r);e(n)||this._writeVertices(t,i,n)}_getLines(t,i){if(e(t))return null;const s=t.paths||t.rings;if(e(s))return null;return l(s,i?256:16)}_writeVertices(e,t,i){const s=t.getDisplayId(),r=e.vertexCount(),o=this.tessellationProperties,n=this._tessellationOptions;o.out=e,o.id=s,o.indexCount=0,o.vertexCount=0,o.offset=r,n.capType=this._capType,n.joinType=this._joinType;for(const{line:l,start:a}of i)n.initialDistance=a%m,this._lineTessellator.tessellate(l,n)}},f=(e,t,i)=>(o,n,l,m,d,f,u,c,x,_,v)=>{const y=s(v,Math.ceil(p*e._halfWidth)),W=r(Math.round(h*u),Math.round(h*c),Math.round(h*x),Math.round(h*_)),M=r(h*d,h*f,0,e._bitset),T=e.out;return T.vertexBounds(o,n,t,i),T.vertexWrite(s(a*o,a*n)),T.vertexWrite(e.id),T.vertexWrite(e._fillColor),T.vertexWrite(W),T.vertexWrite(y),T.vertexWrite(e._tl),T.vertexWrite(e._br),T.vertexWrite(M),T.vertexWrite(s(Math.ceil(p*e._halfReferenceWidth),0)),T.vertexWrite(e.minMaxZoom),T.vertexEnd(),e.offset+e.vertexCount++},u=e=>(t,i,s)=>{const r=e.out;r.indexWrite(t),r.indexWrite(i),r.indexWrite(s),e.indexCount+=3};export default d;\n"]},"metadata":{},"sourceType":"module"}