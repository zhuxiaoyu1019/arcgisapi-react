{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Accessor.js\";\nimport { property as s } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/Logger.js\";\nimport { subclass as r } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { d as o } from \"../../../chunks/vec2.js\";\nimport { QueueProcessor as i } from \"../../support/QueueProcessor.js\";\n\nfunction n(e, t) {\n  return e.length = 0, t.forEach(t => e.push(t)), e;\n}\n\nconst u = new Set(),\n      a = [],\n      c = new Map(),\n      h = [0, 0];\nlet l = class extends t {\n  constructor(e) {\n    super(e), this._keyToItem = new Map(), this.concurrency = 6, this.strategy = \"scale-first\", this.tileInfoView = null;\n  }\n\n  initialize() {\n    const {\n      concurrency: e,\n      process: t\n    } = this;\n    this._queue = new i({\n      concurrency: e,\n      process: (e, s) => {\n        const r = this._keyToItem.get(e);\n\n        return t(r, {\n          signal: s\n        });\n      },\n      peeker: e => e.values().next().value\n    });\n  }\n\n  destroy() {\n    this.clear(), this._queue.destroy(), this._queue = null;\n  }\n\n  get length() {\n    return this._queue ? this._queue.length : 0;\n  }\n\n  get onGoingCount() {\n    return this._keyToItem.size;\n  }\n\n  get updating() {\n    return this.length > 0 || this.onGoingCount > 0;\n  }\n\n  abort(e) {\n    const t = \"string\" == typeof e ? e : e.id;\n\n    this._queue.abort(t);\n  }\n\n  clear() {\n    this._queue.clear(), this._keyToItem.clear(), this.notifyChange(\"updating\");\n  }\n\n  has(e) {\n    return \"string\" == typeof e ? this._keyToItem.has(e) : this._keyToItem.has(e.id);\n  }\n\n  isOngoing(e) {\n    const t = \"string\" == typeof e ? e : e.id;\n    return this.has(t) && this._queue.isOngoing(t);\n  }\n\n  pause() {\n    this._queue.pause();\n  }\n\n  push(e, t) {\n    const s = e.key.id + \"-\" + t;\n    if (this.has(s)) return this.get(s);\n\n    const r = this._queue.push(s),\n          o = () => {\n      this._keyToItem.delete(s), this.notifyChange(\"updating\");\n    };\n\n    return this._keyToItem.set(s, e), r.then(o, o), this.notifyChange(\"updating\"), r;\n  }\n\n  reset() {\n    this._queue.reset(), this.notifyChange(\"updating\");\n  }\n\n  resume() {\n    this._queue.resume();\n  }\n\n  _peekByScaleFirst(e) {\n    if (!this.state) return e.values().next().value;\n    const t = this.tileInfoView;\n    let s = Number.NEGATIVE_INFINITY,\n        r = Number.POSITIVE_INFINITY;\n    e.forEach(e => {\n      const t = this._keyToItem.get(e),\n            o = this.tileInfoView.getTileScale(t.key);\n\n      c.has(o) || (c.set(o, []), s = Math.max(o, s), r = Math.min(o, r)), c.get(o).push(t.key), u.add(o);\n    });\n    let o = this.state.scale;\n    c.has(o) || (n(a, u), a.sort(), o = a.reduce((e, t) => Math.abs(t - o) < Math.abs(e - o) ? t : e, a[0])), o = Math.min(o, s), o = Math.max(o, r);\n    const i = c.get(o),\n          h = t.getClosestInfoForScale(o),\n          l = h.getColumnForX(this.state.center[0]),\n          p = h.getRowForY(this.state.center[1]);\n    return i.sort((e, t) => {\n      const s = h.denormalizeCol(e.col, e.world),\n            r = h.denormalizeCol(t.col, t.world);\n      return Math.sqrt((l - s) * (l - s) + (p - e.row) * (p - e.row)) - Math.sqrt((l - r) * (l - r) + (p - t.row) * (p - t.row));\n    }), u.clear(), c.clear(), i[0].id;\n  }\n\n  _peekByCenterFirst(e) {\n    if (!this.state) return e.values().next().value;\n    const t = this.tileInfoView,\n          s = this.state.center;\n    let r = Number.POSITIVE_INFINITY,\n        i = null;\n    return e.forEach(e => {\n      const n = this._keyToItem.get(e);\n\n      t.getTileCoords(h, n.key);\n      const u = o(h, s);\n      u < r && (r = u, i = n.key);\n    }), i.id;\n  }\n\n};\ne([s({\n  constructOnly: !0\n})], l.prototype, \"concurrency\", void 0), e([s({\n  constructOnly: !0\n})], l.prototype, \"process\", void 0), e([s()], l.prototype, \"state\", void 0), e([s({\n  constructOnly: !0\n})], l.prototype, \"strategy\", void 0), e([s({\n  constructOnly: !0\n})], l.prototype, \"tileInfoView\", void 0), e([s({\n  readOnly: !0\n})], l.prototype, \"updating\", null), l = e([r(\"esri.views.2d.tiling.PagedTileQueue\")], l);\nvar p = l;\nexport default p;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/2d/tiling/PagedTileQueue.js"],"names":["_","e","t","property","s","subclass","r","d","o","QueueProcessor","i","n","length","forEach","push","u","Set","a","c","Map","h","l","constructor","_keyToItem","concurrency","strategy","tileInfoView","initialize","process","_queue","get","signal","peeker","values","next","value","destroy","clear","onGoingCount","size","updating","abort","id","notifyChange","has","isOngoing","pause","key","delete","set","then","reset","resume","_peekByScaleFirst","state","Number","NEGATIVE_INFINITY","POSITIVE_INFINITY","getTileScale","Math","max","min","add","scale","sort","reduce","abs","getClosestInfoForScale","getColumnForX","center","p","getRowForY","denormalizeCol","col","world","sqrt","row","_peekByCenterFirst","getTileCoords","constructOnly","prototype","readOnly"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Accessor.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as r}from\"../../../core/accessorSupport/decorators/subclass.js\";import{d as o}from\"../../../chunks/vec2.js\";import{QueueProcessor as i}from\"../../support/QueueProcessor.js\";function n(e,t){return e.length=0,t.forEach((t=>e.push(t))),e}const u=new Set,a=[],c=new Map,h=[0,0];let l=class extends t{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy=\"scale-first\",this.tileInfoView=null}initialize(){const{concurrency:e,process:t}=this;this._queue=new i({concurrency:e,process:(e,s)=>{const r=this._keyToItem.get(e);return t(r,{signal:s})},peeker:e=>e.values().next().value})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const t=\"string\"==typeof e?e:e.id;this._queue.abort(t)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange(\"updating\")}has(e){return\"string\"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const t=\"string\"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause()}push(e,t){const s=e.key.id+\"-\"+t;if(this.has(s))return this.get(s);const r=this._queue.push(s),o=()=>{this._keyToItem.delete(s),this.notifyChange(\"updating\")};return this._keyToItem.set(s,e),r.then(o,o),this.notifyChange(\"updating\"),r}reset(){this._queue.reset(),this.notifyChange(\"updating\")}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView;let s=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach((e=>{const t=this._keyToItem.get(e),o=this.tileInfoView.getTileScale(t.key);c.has(o)||(c.set(o,[]),s=Math.max(o,s),r=Math.min(o,r)),c.get(o).push(t.key),u.add(o)}));let o=this.state.scale;c.has(o)||(n(a,u),a.sort(),o=a.reduce(((e,t)=>Math.abs(t-o)<Math.abs(e-o)?t:e),a[0])),o=Math.min(o,s),o=Math.max(o,r);const i=c.get(o),h=t.getClosestInfoForScale(o),l=h.getColumnForX(this.state.center[0]),p=h.getRowForY(this.state.center[1]);return i.sort(((e,t)=>{const s=h.denormalizeCol(e.col,e.world),r=h.denormalizeCol(t.col,t.world);return Math.sqrt((l-s)*(l-s)+(p-e.row)*(p-e.row))-Math.sqrt((l-r)*(l-r)+(p-t.row)*(p-t.row))})),u.clear(),c.clear(),i[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView,s=this.state.center;let r=Number.POSITIVE_INFINITY,i=null;return e.forEach((e=>{const n=this._keyToItem.get(e);t.getTileCoords(h,n.key);const u=o(h,s);u<r&&(r=u,i=n.key)})),i.id}};e([s({constructOnly:!0})],l.prototype,\"concurrency\",void 0),e([s({constructOnly:!0})],l.prototype,\"process\",void 0),e([s()],l.prototype,\"state\",void 0),e([s({constructOnly:!0})],l.prototype,\"strategy\",void 0),e([s({constructOnly:!0})],l.prototype,\"tileInfoView\",void 0),e([s({readOnly:!0})],l.prototype,\"updating\",null),l=e([r(\"esri.views.2d.tiling.PagedTileQueue\")],l);var p=l;export default p;\n"]},"metadata":{},"sourceType":"module"}