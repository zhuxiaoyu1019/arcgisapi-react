{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport \"../../../../core/has.js\";\nimport { unwrap as t } from \"../../../../core/maybe.js\";\nimport { pt2px as e } from \"../../../../core/screenUtils.js\";\nimport { i as s, t as n, r as o, s as r } from \"../../../../chunks/mat2d.js\";\nimport { c as i } from \"../../../../chunks/mat2df32.js\";\nimport { s as a, a as c, b as m, h as l, t as h } from \"../../../../chunks/vec2.js\";\nimport { c as f } from \"../../../../chunks/vec2f32.js\";\nimport { create as u } from \"../../../../geometry/support/aaBoundingRect.js\";\nimport { getBoundsXY as p } from \"../../../../geometry/support/boundsUtils.js\";\nimport { isPoint as g } from \"../../../../geometry/support/jsonUtils.js\";\nimport { normalizeMapX as y } from \"../../../../geometry/support/normalizeUtils.js\";\nimport { getSpatialReferenceMinMaxX as b } from \"../../../../geometry/support/normalizeUtilsCommon.js\";\nimport { getInfo as M } from \"../../../../geometry/support/spatialReferenceUtils.js\";\nimport { CIMSymbolHelper as d } from \"../../../../symbols/cim/CIMSymbolHelper.js\";\nimport { getXAnchorDirection as x, getYAnchorDirection as S } from \"../../engine/webgl/alignmentUtils.js\";\nimport { shapeGlyphs as j } from \"../../engine/webgl/mesh/templates/shapingUtils.js\";\nimport { bidiText as w } from \"../../engine/webgl/util/BidiText.js\";\nconst k = Math.PI / 180,\n      I = .04,\n      U = i(),\n      v = f(),\n      z = 512,\n      P = 50;\n\nfunction T(t, e) {\n  if (!e.isWrappable) return null;\n  const [s, n] = b(e);\n  return t[2] > n ? [u([t[0], t[1], n, t[3]]), u([s, t[1], s + t[2] - n, t[3]])] : t[0] < s ? [u([s, t[1], t[2], t[3]]), u([n - (s - t[0]), t[1], n, t[3]])] : null;\n}\n\nfunction A(t, e, s, n, o, r, i) {\n  if (!n || !s.symbol) return t[0] = t[1] = t[2] = t[3] = 0, e[0] = e[1] = e[2] = e[3] = 0, t;\n  const a = n;\n\n  if (!g(a)) {\n    p(t, a);\n    let n = e[0];\n    0 === n && (n = N(s), e[0] = n);\n    const r = o * n / 2;\n    return t[0] -= r, t[1] -= r, t[2] += r, t[3] += r, t;\n  }\n\n  {\n    const n = a.x,\n          c = a.y;\n    \"esriTS\" === s.symbol.type && 0 === e[2] && 0 === e[3] && Q(e, s.symbol, s.mosaicItem), V(t, n, c, s.symbol, e, o, r, i);\n  }\n  return t;\n}\n\nfunction C(t) {\n  return \"text\" === t || \"esriTS\" === t;\n}\n\nfunction H(t) {\n  return \"simple-marker\" === t || \"picture-marker\" === t || \"esriSMS\" === t || \"esriPMS\" === t;\n}\n\nfunction W(e) {\n  switch (t(e.geometry).type) {\n    case \"point\":\n    case \"multipoint\":\n      return 0;\n\n    case \"polyline\":\n      return 1;\n\n    case \"polygon\":\n    case \"extent\":\n      return 2;\n  }\n\n  return 0;\n}\n\nconst q = f(),\n      R = f(),\n      B = f(),\n      E = f(),\n      F = f(),\n      L = f(),\n      O = f();\n\nfunction D(t, e, s, n) {\n  a(B, e, s);\n  const o = t.paths;\n  let r,\n      i,\n      h,\n      f,\n      u,\n      p,\n      g,\n      y,\n      b,\n      M = 1 / 0;\n\n  for (let d = 0; d < o.length; d++) {\n    const t = o[d];\n    if (!(t.length < 2)) for (let o = 1; o < t.length; o++) r = t[o - 1][0], h = t[o - 1][1], i = t[o][0], f = t[o][1], u = Math.min(r, i) - n, p = Math.min(h, f) - n, g = Math.max(r, i) + n, y = Math.max(h, f) + n, e < u || e > g || s < p || s > y || (a(q, r, h), a(R, i, f), c(E, R, q), c(F, q, B), m(L, E, l(E, F) / l(E, E)), c(O, F, L), b = l(O, O), M > b && (M = b));\n  }\n\n  return Math.sqrt(M) <= n;\n}\n\nfunction G(t, i, c, m, l, f) {\n  let u, p;\n  const g = e(c.xoffset),\n        y = e(c.yoffset),\n        b = k * c.angle,\n        M = k * f;\n\n  switch (c.type) {\n    case \"esriSMS\":\n      u = p = e(c.size);\n      break;\n\n    case \"esriPMS\":\n      u = e(c.width), p = e(c.height);\n  }\n\n  l < I && (m = I * m / l);\n  const d = s(U);\n  n(d, d, a(v, t, i)), o(d, d, M - b), r(d, d, a(v, m, -m)), n(d, d, a(v, g, -y));\n  const x = [0, 0];\n  h(x, a(v, -.5 * u, -.5 * p), d);\n  const S = [0, 0];\n  h(S, a(v, -.5 * u, .5 * p), d);\n  const j = [0, 0];\n  h(j, a(v, .5 * u, -.5 * p), d);\n  const w = [0, 0];\n  return h(w, a(v, .5 * u, .5 * p), d), {\n    rings: [[x, j, w, S, x]]\n  };\n}\n\nfunction J(t, i, c, m, l, f) {\n  const u = d.getEnvelope(c.data);\n  if (!u) return null;\n  l < I && (m = I * m / l);\n  const p = e(u.width),\n        g = e(u.height),\n        y = e(u.x),\n        b = e(u.y),\n        M = 0 * k,\n        x = k * f,\n        S = s(U);\n  n(S, S, a(v, t, i)), o(S, S, x - M), r(S, S, a(v, m, m));\n  const j = [0, 0];\n  h(j, a(v, y, b + g), S);\n  const w = [0, 0];\n  h(w, a(v, y, b), S);\n  const z = [0, 0];\n  h(z, a(v, y + p, b + g), S);\n  const P = [0, 0];\n  return h(P, a(v, y + p, b), S), {\n    rings: [[j, z, P, w, j]]\n  };\n}\n\nfunction K(t, i, c, m, l, f) {\n  const u = e(c.xoffset),\n        p = e(c.yoffset),\n        g = k * c.angle,\n        y = k * f,\n        b = s(U);\n  n(b, b, a(v, t, i)), o(b, b, y), r(b, b, a(v, l, -l));\n  const M = m[0] + m[2] / 2,\n        d = m[1] + m[3] / 2;\n  n(b, b, a(v, u, -p)), n(b, b, a(v, M, d)), o(b, b, g), n(b, b, a(v, -M, -d));\n  const x = [0, 0];\n  h(x, a(v, m[0], m[1]), b);\n  const S = [0, 0];\n  h(S, a(v, m[0], m[1] + m[3]), b);\n  const j = [0, 0];\n  h(j, a(v, m[0] + m[2], m[1]), b);\n  const w = [0, 0];\n  return h(w, a(v, m[0] + m[2], m[1] + m[3]), b), {\n    rings: [[x, j, w, S, x]]\n  };\n}\n\nfunction N(t) {\n  switch (t.symbol.type) {\n    case \"esriSFS\":\n    case \"esriPFS\":\n      {\n        const e = t.symbol.outline;\n        return e ? e.width : 0;\n      }\n\n    case \"esriSLS\":\n      return e(t.symbol.width);\n\n    case \"esriSMS\":\n      return e(t.symbol.size);\n\n    case \"esriPMS\":\n      return e(Math.max(t.symbol.width, t.symbol.height));\n\n    case \"esriTS\":\n      {\n        const e = [0, 0, 0, 0];\n        Q(e, t.symbol, t.mosaicItem);\n        const s = Math.max(Math.abs(e[0]), Math.abs(e[1]));\n        return Math.max(e[2], e[3]) + s;\n      }\n\n    case \"expanded-cim\":\n      {\n        const s = d.getEnvelope(t.symbol.data);\n        return s.width !== -1 / 0 && s.height !== -1 / 0 || (s.width = 10, s.height = 10, s.x = 0, s.y = 0), e(Math.sqrt(s.width * s.width + s.height * s.height));\n      }\n\n    case \"composite-symbol\":\n      {\n        if (!t.symbol.layers.length) return 0;\n        const e = t.symbol.layers.length - 1;\n        return N({\n          symbol: t.symbol.layers[e],\n          mosaicItem: null\n        });\n      }\n\n    case \"label\":\n    default:\n      return 0;\n  }\n}\n\nfunction Q(t, s, n) {\n  if (!n || 0 === n.glyphMosaicItems.length) return t;\n  const o = w(s.text)[1],\n        r = n.glyphMosaicItems,\n        i = j(r, o, {\n    scale: e(s.font.size) / 24,\n    angle: s.angle,\n    xOffset: s.xoffset,\n    yOffset: s.yoffset,\n    hAlign: x(s.horizontalAlignment || \"center\"),\n    vAlign: S(s.verticalAlignment || \"baseline\"),\n    maxLineWidth: Math.max(32, Math.min(s.lineWidth || 512, 512)),\n    lineHeight: 30 * Math.max(.25, Math.min(s.lineHeight || 1, 4)),\n    decoration: s.font.decoration || \"none\",\n    isCIM: !1\n  }).bounds;\n  return t[0] = e(i.x - i.halfWidth), t[1] = e(i.y - i.halfHeight), t[2] = e(i.width), t[3] = e(i.height), t;\n}\n\nfunction V(t, e, s, n, o, r, i, a) {\n  let c;\n\n  switch (n.type) {\n    case \"esriSMS\":\n    case \"esriPMS\":\n      c = G(e, s, n, r, i, 0);\n      break;\n\n    case \"esriTS\":\n      c = K(e, s, n, o, r, 0);\n      break;\n\n    case \"cim\":\n    case \"CIMSymbolReference\":\n    case \"expanded-cim\":\n      c = J(e, s, n, r, i, 0);\n  }\n\n  let m,\n      l,\n      h = 0;\n\n  for (let p = 0; p < c.rings[0].length - 1; p++) l = c.rings[0][p], m = (e - l[0]) * (e - l[0]) + (s - l[1]) * (s - l[1]), h = Math.max(h, m);\n\n  h = Math.sqrt(h);\n  let f = y(e - h, a),\n      u = y(e + h, a);\n\n  if (f > u) {\n    const t = M(a);\n\n    if (t) {\n      const [e, s] = t.valid;\n      f = e, u = s;\n    }\n  }\n\n  return t[0] = f, t[1] = s - h, t[2] = u, t[3] = s + h, t;\n}\n\nexport { P as PIXEL_BUFFER, z as TILE_SIZE, A as getBounds, J as getCIMMarkerBounds, G as getMarkerSymbolBounds, K as getTextSymbolBounds, Q as getTextSymbolSize, W as graphicGeometryToNumber, T as intersectingInternationalDateline, H as isMarkerSymbol, D as isPointOnPolyline, C as isTextSymbol };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/2d/layers/graphics/graphicsUtils.js"],"names":["unwrap","t","pt2px","e","i","s","n","r","o","c","a","b","m","h","l","f","create","u","getBoundsXY","p","isPoint","g","normalizeMapX","y","getSpatialReferenceMinMaxX","getInfo","M","CIMSymbolHelper","d","getXAnchorDirection","x","getYAnchorDirection","S","shapeGlyphs","j","bidiText","w","k","Math","PI","I","U","v","z","P","T","isWrappable","A","symbol","N","type","Q","mosaicItem","V","C","H","W","geometry","q","R","B","E","F","L","O","D","paths","length","min","max","sqrt","G","xoffset","yoffset","angle","size","width","height","rings","J","getEnvelope","data","K","outline","abs","layers","glyphMosaicItems","text","scale","font","xOffset","yOffset","hAlign","horizontalAlignment","vAlign","verticalAlignment","maxLineWidth","lineWidth","lineHeight","decoration","isCIM","bounds","halfWidth","halfHeight","valid","PIXEL_BUFFER","TILE_SIZE","getBounds","getCIMMarkerBounds","getMarkerSymbolBounds","getTextSymbolBounds","getTextSymbolSize","graphicGeometryToNumber","intersectingInternationalDateline","isMarkerSymbol","isPointOnPolyline","isTextSymbol"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{unwrap as t}from\"../../../../core/maybe.js\";import{pt2px as e}from\"../../../../core/screenUtils.js\";import{i as s,t as n,r as o,s as r}from\"../../../../chunks/mat2d.js\";import{c as i}from\"../../../../chunks/mat2df32.js\";import{s as a,a as c,b as m,h as l,t as h}from\"../../../../chunks/vec2.js\";import{c as f}from\"../../../../chunks/vec2f32.js\";import{create as u}from\"../../../../geometry/support/aaBoundingRect.js\";import{getBoundsXY as p}from\"../../../../geometry/support/boundsUtils.js\";import{isPoint as g}from\"../../../../geometry/support/jsonUtils.js\";import{normalizeMapX as y}from\"../../../../geometry/support/normalizeUtils.js\";import{getSpatialReferenceMinMaxX as b}from\"../../../../geometry/support/normalizeUtilsCommon.js\";import{getInfo as M}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{CIMSymbolHelper as d}from\"../../../../symbols/cim/CIMSymbolHelper.js\";import{getXAnchorDirection as x,getYAnchorDirection as S}from\"../../engine/webgl/alignmentUtils.js\";import{shapeGlyphs as j}from\"../../engine/webgl/mesh/templates/shapingUtils.js\";import{bidiText as w}from\"../../engine/webgl/util/BidiText.js\";const k=Math.PI/180,I=.04,U=i(),v=f(),z=512,P=50;function T(t,e){if(!e.isWrappable)return null;const[s,n]=b(e);return t[2]>n?[u([t[0],t[1],n,t[3]]),u([s,t[1],s+t[2]-n,t[3]])]:t[0]<s?[u([s,t[1],t[2],t[3]]),u([n-(s-t[0]),t[1],n,t[3]])]:null}function A(t,e,s,n,o,r,i){if(!n||!s.symbol)return t[0]=t[1]=t[2]=t[3]=0,e[0]=e[1]=e[2]=e[3]=0,t;const a=n;if(!g(a)){p(t,a);let n=e[0];0===n&&(n=N(s),e[0]=n);const r=o*n/2;return t[0]-=r,t[1]-=r,t[2]+=r,t[3]+=r,t}{const n=a.x,c=a.y;\"esriTS\"===s.symbol.type&&0===e[2]&&0===e[3]&&Q(e,s.symbol,s.mosaicItem),V(t,n,c,s.symbol,e,o,r,i)}return t}function C(t){return\"text\"===t||\"esriTS\"===t}function H(t){return\"simple-marker\"===t||\"picture-marker\"===t||\"esriSMS\"===t||\"esriPMS\"===t}function W(e){switch(t(e.geometry).type){case\"point\":case\"multipoint\":return 0;case\"polyline\":return 1;case\"polygon\":case\"extent\":return 2}return 0}const q=f(),R=f(),B=f(),E=f(),F=f(),L=f(),O=f();function D(t,e,s,n){a(B,e,s);const o=t.paths;let r,i,h,f,u,p,g,y,b,M=1/0;for(let d=0;d<o.length;d++){const t=o[d];if(!(t.length<2))for(let o=1;o<t.length;o++)r=t[o-1][0],h=t[o-1][1],i=t[o][0],f=t[o][1],u=Math.min(r,i)-n,p=Math.min(h,f)-n,g=Math.max(r,i)+n,y=Math.max(h,f)+n,e<u||e>g||s<p||s>y||(a(q,r,h),a(R,i,f),c(E,R,q),c(F,q,B),m(L,E,l(E,F)/l(E,E)),c(O,F,L),b=l(O,O),M>b&&(M=b))}return Math.sqrt(M)<=n}function G(t,i,c,m,l,f){let u,p;const g=e(c.xoffset),y=e(c.yoffset),b=k*c.angle,M=k*f;switch(c.type){case\"esriSMS\":u=p=e(c.size);break;case\"esriPMS\":u=e(c.width),p=e(c.height)}l<I&&(m=I*m/l);const d=s(U);n(d,d,a(v,t,i)),o(d,d,M-b),r(d,d,a(v,m,-m)),n(d,d,a(v,g,-y));const x=[0,0];h(x,a(v,-.5*u,-.5*p),d);const S=[0,0];h(S,a(v,-.5*u,.5*p),d);const j=[0,0];h(j,a(v,.5*u,-.5*p),d);const w=[0,0];return h(w,a(v,.5*u,.5*p),d),{rings:[[x,j,w,S,x]]}}function J(t,i,c,m,l,f){const u=d.getEnvelope(c.data);if(!u)return null;l<I&&(m=I*m/l);const p=e(u.width),g=e(u.height),y=e(u.x),b=e(u.y),M=0*k,x=k*f,S=s(U);n(S,S,a(v,t,i)),o(S,S,x-M),r(S,S,a(v,m,m));const j=[0,0];h(j,a(v,y,b+g),S);const w=[0,0];h(w,a(v,y,b),S);const z=[0,0];h(z,a(v,y+p,b+g),S);const P=[0,0];return h(P,a(v,y+p,b),S),{rings:[[j,z,P,w,j]]}}function K(t,i,c,m,l,f){const u=e(c.xoffset),p=e(c.yoffset),g=k*c.angle,y=k*f,b=s(U);n(b,b,a(v,t,i)),o(b,b,y),r(b,b,a(v,l,-l));const M=m[0]+m[2]/2,d=m[1]+m[3]/2;n(b,b,a(v,u,-p)),n(b,b,a(v,M,d)),o(b,b,g),n(b,b,a(v,-M,-d));const x=[0,0];h(x,a(v,m[0],m[1]),b);const S=[0,0];h(S,a(v,m[0],m[1]+m[3]),b);const j=[0,0];h(j,a(v,m[0]+m[2],m[1]),b);const w=[0,0];return h(w,a(v,m[0]+m[2],m[1]+m[3]),b),{rings:[[x,j,w,S,x]]}}function N(t){switch(t.symbol.type){case\"esriSFS\":case\"esriPFS\":{const e=t.symbol.outline;return e?e.width:0}case\"esriSLS\":return e(t.symbol.width);case\"esriSMS\":return e(t.symbol.size);case\"esriPMS\":return e(Math.max(t.symbol.width,t.symbol.height));case\"esriTS\":{const e=[0,0,0,0];Q(e,t.symbol,t.mosaicItem);const s=Math.max(Math.abs(e[0]),Math.abs(e[1]));return Math.max(e[2],e[3])+s}case\"expanded-cim\":{const s=d.getEnvelope(t.symbol.data);return s.width!==-1/0&&s.height!==-1/0||(s.width=10,s.height=10,s.x=0,s.y=0),e(Math.sqrt(s.width*s.width+s.height*s.height))}case\"composite-symbol\":{if(!t.symbol.layers.length)return 0;const e=t.symbol.layers.length-1;return N({symbol:t.symbol.layers[e],mosaicItem:null})}case\"label\":default:return 0}}function Q(t,s,n){if(!n||0===n.glyphMosaicItems.length)return t;const o=w(s.text)[1],r=n.glyphMosaicItems,i=j(r,o,{scale:e(s.font.size)/24,angle:s.angle,xOffset:s.xoffset,yOffset:s.yoffset,hAlign:x(s.horizontalAlignment||\"center\"),vAlign:S(s.verticalAlignment||\"baseline\"),maxLineWidth:Math.max(32,Math.min(s.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(s.lineHeight||1,4)),decoration:s.font.decoration||\"none\",isCIM:!1}).bounds;return t[0]=e(i.x-i.halfWidth),t[1]=e(i.y-i.halfHeight),t[2]=e(i.width),t[3]=e(i.height),t}function V(t,e,s,n,o,r,i,a){let c;switch(n.type){case\"esriSMS\":case\"esriPMS\":c=G(e,s,n,r,i,0);break;case\"esriTS\":c=K(e,s,n,o,r,0);break;case\"cim\":case\"CIMSymbolReference\":case\"expanded-cim\":c=J(e,s,n,r,i,0)}let m,l,h=0;for(let p=0;p<c.rings[0].length-1;p++)l=c.rings[0][p],m=(e-l[0])*(e-l[0])+(s-l[1])*(s-l[1]),h=Math.max(h,m);h=Math.sqrt(h);let f=y(e-h,a),u=y(e+h,a);if(f>u){const t=M(a);if(t){const[e,s]=t.valid;f=e,u=s}}return t[0]=f,t[1]=s-h,t[2]=u,t[3]=s+h,t}export{P as PIXEL_BUFFER,z as TILE_SIZE,A as getBounds,J as getCIMMarkerBounds,G as getMarkerSymbolBounds,K as getTextSymbolBounds,Q as getTextSymbolSize,W as graphicGeometryToNumber,T as intersectingInternationalDateline,H as isMarkerSymbol,D as isPointOnPolyline,C as isTextSymbol};\n"]},"metadata":{},"sourceType":"module"}