{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../Color.js\";\nimport i from \"../../../Graphic.js\";\nimport s from \"../../../core/Collection.js\";\nimport r from \"../../../core/has.js\";\nimport o from \"../../../core/Logger.js\";\nimport { someMap as a } from \"../../../core/MapUtils.js\";\nimport { unwrapOr as n, isSome as l, destroyMaybe as d, isNone as h, applySome as c, unwrap as u } from \"../../../core/maybe.js\";\nimport _ from \"../../../core/PooledArray.js\";\nimport { throwIfAborted as m, createResolver as g } from \"../../../core/promiseUtils.js\";\nimport { schedule as p } from \"../../../core/scheduling.js\";\nimport { isArrayBuffer as f } from \"../../../core/typedArrayUtil.js\";\nimport { getMetersPerVerticalUnitForSR as b } from \"../../../core/unitUtils.js\";\nimport { init as y } from \"../../../core/watchUtils.js\";\nimport { property as v } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as I } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { f as M } from \"../../../chunks/mat3.js\";\nimport { c as C } from \"../../../chunks/mat3f32.js\";\nimport { m as x, u as O } from \"../../../chunks/mat4.js\";\nimport { b as j, c as w } from \"../../../chunks/mat4f64.js\";\nimport { m as S, g as E } from \"../../../chunks/vec3.js\";\nimport { c as F } from \"../../../chunks/vec3f64.js\";\nimport { s as D } from \"../../../chunks/vec4.js\";\nimport { projectBuffer as R, getProjectorName as N, localLinearScaleFactors as T, projectVectorToVector as V, projectBoundingSphere as A } from \"../../../geometry/projection.js\";\nimport { create as P, empty as H, expandWithBuffer as U, intersects as G } from \"../../../geometry/support/aaBoundingBox.js\";\nimport L from \"../../../layers/graphics/controllers/I3SOnDemandController.js\";\nimport { fixFields as B } from \"../../../layers/support/fieldUtils.js\";\nimport { areLabelsVisible as k } from \"../../../layers/support/layerUtils.js\";\nimport q from \"../../../layers/support/SceneModification.js\";\nimport { getColor as z, getOpacity as W } from \"../../../renderers/visualVariables/support/visualVariableUtils.js\";\nimport { loadArcade as $ } from \"../../../support/arcadeOnDemand.js\";\nimport K from \"../../../symbols/Symbol3D.js\";\nimport { getMetersPerUnit as J } from \"../../../symbols/support/unitConversionUtils.js\";\nimport Q from \"./I3SMeshViewLabeler.js\";\nimport { I3SMeshWorkerHandle as X, toWasmModification as Y } from \"./I3SMeshWorkerHandle.js\";\nimport { initialize as Z, setModificationsSync as ee, filterObbsForModificationsSync as te, interpretObbModificationResults as ie } from \"./SceneLayerWorker.js\";\nimport { overrideColor as se } from \"./graphics/graphicUtils.js\";\nimport re from \"./i3s/Highlights.js\";\nimport { I3SAttributeOverrides as oe } from \"./i3s/I3SAttributeOverrides.js\";\nimport { I3SCrossfadeHelper as ae, NodeCrossfadeMetaData as ne } from \"./i3s/I3SCrossfadeHelper.js\";\nimport le from \"./i3s/I3SElevationProvider.js\";\nimport { boundingBoxCornerPoints as de } from \"./i3s/I3SGeometryUtil.js\";\nimport { I3SIntersectionHandler as he } from \"./i3s/I3SIntersectionHandler.js\";\nimport { getSupportedEncodings as ce, selectEncoding as ue, createTexture as _e, configureMaterial as me } from \"./i3s/I3SMaterialUtil.js\";\nimport { computeGlobalTransformation as ge, getLocalOrigin as pe } from \"./i3s/I3SProjectionUtil.js\";\nimport { rendererNeedsTextures as fe, checkSceneLayerValid as be, checkSceneLayerCompatibleWithView as ye, getCacheKeySuffix as ve, whenGraphicAttributes as Ie, computeVisibilityObb as Me, filterInPlace as Ce, getCachedAttributeValue as xe, intersectBoundingBoxWithMbs as Oe, addWraparound as je, getSymbolInfo as we, transparentEdgeMaterial as Se, getClipAABB as Ee } from \"./i3s/I3SUtil.js\";\nimport { IDBCache as Fe } from \"./i3s/IDBCache.js\";\nimport { attributeLookup as De } from \"./support/attributeUtils.js\";\nimport Re from \"../support/debugFlags.js\";\nimport { projectToBoundingBox as Ne } from \"../support/extentUtils.js\";\nimport { create as Te, clone as Ve } from \"../support/orientedBoundingBox.js\";\nimport { updatingProgress as Ae } from \"../support/updatingProperties.js\";\nimport { glLayout as Pe } from \"../support/buffer/glUtil.js\";\nimport { createVertexBufferLayout as He } from \"../webgl-engine/collections/Component/SourceGeometry.js\";\nimport { loadBasis as Ue } from \"../webgl-engine/lib/BasisUtil.js\";\nconst Ge = o.getLogger(\"esri.views.3d.layers.SceneLayerView3D\"),\n      Le = [1, 1, 1, 1];\n\nclass Be extends ne {\n  constructor(e, t, i, s, r, o, a) {\n    super(), this.node = e, this.featureIds = t, this.objectHandle = i, this.cachedRendererVersion = s, this.attributeInfo = r, this.material = o, this.textures = a, this.cachedEdgeMaterials = new Array(), this.cachedSymbology = null;\n  }\n\n}\n\nconst ke = 18,\n      qe = 104857600,\n      ze = t => {\n  var o;\n  let f = o = class extends t {\n    constructor(...e) {\n      super(e), this._elevationProvider = null, this._intersectionHandler = null, this._nodeId2Meta = new Map(), this._nodeId2MetaReloading = new Map(), this._i3sWasmLoaded = !1, this._hasLoadedPBRTextures = !1, this._asyncModuleLoading = 0, this._addTasks = new Map(), this._rendererVersion = 0, this._colorVariable = null, this._opacityVariable = null, this._rendererFields = null, this._symbologyFields = null, this._symbologyOverride = null, this._symbologyOverrideFields = null, this._symbolInfos = new Map(), this._idbCache = new Fe(\"esri-scenelayer-cache\", \"geometries\"), this.holeFilling = \"auto\", this._hasColors = !1, this._hasTextures = !1, this._hasData = !1, this.slicePlaneEnabled = !1, this._modifications = new Array(), this._layerUrl = \"\", this._cacheKeySuffix = null, this._arcade = null, this._tmpAttributeOnlyGraphic = new i(null, null, {}), this._crossfadeHelper = new ae(this), this.index = o.lastIndex++;\n    }\n\n    get lodCrossfadeoutDuration() {\n      return 0;\n    }\n\n    get lodCrossfadeinDuration() {\n      return 0;\n    }\n\n    get lodCrossfadeUncoveredDuration() {\n      return 0;\n    }\n\n    get layerUid() {\n      return this.i3slayer && this.i3slayer.uid;\n    }\n\n    get sublayerUid() {\n      return null;\n    }\n\n    get hasTexturesOrVertexColors() {\n      return this._hasData ? this._hasTextures || this._hasColors ? \"yes\" : \"probably-not\" : \"unknown\";\n    }\n\n    get rendererTextureUsage() {\n      return fe(this._currentRenderer) ? this._usePBR() || this._hasLoadedPBRTextures ? 63 : 37 : this._usePBR() || this._hasLoadedPBRTextures ? 44 : 36;\n    }\n\n    get elevationOffset() {\n      const e = null != this.i3slayer ? this.i3slayer.elevationInfo : null;\n\n      if (null != e && \"absolute-height\" === e.mode) {\n        const t = b(this.i3slayer.spatialReference),\n              i = J(e.unit);\n        return n(e.offset, 0) * i / t;\n      }\n\n      return 0;\n    }\n\n    get supportedTextureEncodings() {\n      return ce(this.view._stage.renderView);\n    }\n\n    get uncompressedTextureDownsamplingEnabled() {\n      var e;\n      const t = null == (e = this.view) ? void 0 : e.qualitySettings.sceneService.uncompressedTextureDownsamplingEnabled,\n            i = 0 == (4 & this.supportedTextureEncodings);\n      return t && i;\n    }\n\n    initialize() {\n      this.preLoadBasis(), this.addResolvingPromise(this.i3slayer.indexInfo);\n      const e = this.view.resourceController;\n      if (this.attributeOverrides = new oe(this.i3slayer, e.memoryController), this._worker = new X(t => e.schedule(t)), this.addResolvingPromise(this._worker.promise), this._worker.setLegacySchema(this.layerUid, this.i3slayer.store.defaultGeometrySchema), be(this.i3slayer), ye(this.i3slayer, this.view), this._layerUrl = this.i3slayer.parsedUrl.path, this._controller = new L({\n        layerView: this\n      }), this.gpuMemoryEstimate = 0, this.texMemoryEstimate = 0, this.geoMemoryEstimate = 0, this._stage = this.view._stage, this._collection = this._stage.renderView.componentObjectCollection, this._highlights = new re({\n        collection: this._collection,\n        forAllFeatures: e => this._forAllFeatures(e, null, 1),\n        forAllFeaturesOfNode: (e, t) => this._forAllFeaturesOfNode(e, t)\n      }), this._isIntegratedMesh || !this.i3slayer.store.defaultGeometrySchema) this._hasSymbolColors = !1;else {\n        const e = this.i3slayer.store.defaultGeometrySchema.featureAttributes;\n        this._hasSymbolColors = !!(e && e.faceRange && e.id);\n      }\n      this._hasVertexColors = null != this.i3slayer.store.defaultGeometrySchema.vertexAttributes.color && (null == this.i3slayer.cachedDrawingInfo || !this.i3slayer.cachedDrawingInfo.color), this._isIntegratedMesh || (this._edgeView = this._stage.renderView.ensureEdgeView()), this._memCache = this.view.resourceController.memoryController.getMemCache(this.i3slayer.uid, e => this._deleteComponentObject(e)), this._intersectionHandler = new he({\n        layerUid: this.layerUid,\n        sublayerUid: this.sublayerUid,\n        collection: this._collection,\n        slicePlaneEnabled: this.slicePlaneEnabled,\n        isGround: this._isIntegratedMesh,\n        forEach: e => {\n          this._nodeId2Meta.forEach(t => l(t) && e(t.node, t.objectHandle)), this._nodeId2MetaReloading.forEach(t => l(t) && e(t.node, t.objectHandle));\n        }\n      }), this._elevationProvider = new le({\n        layerView: this,\n        intersectionHandler: this._intersectionHandler\n      }), this._hasLoadedPBRTextures = this._usePBR(), this.updatingHandles.add(this, \"view.clippingArea\", () => this._clippingAreaChanged(), 2), this.updatingHandles.add(this, \"fullOpacity\", e => this._opacityChange(e)), this.updatingHandles.add(this, \"slicePlaneEnabled\", e => this._slicePlaneEnabledChange(e)), this.updatingHandles.add(this, \"elevationOffset\", (e, t) => {\n        this._reloadAll(t), this._controller.invalidateVisibilityObbs();\n      }), this.updatingHandles.add(this, \"filter\", () => this._filterChange(), 2), this.updatingHandles.add(this, \"view.qualitySettings.physicallyBasedRenderingEnabled\", () => this._updatePBR());\n\n      const t = () => {\n        this._reloadAll(), this.clearMemCache();\n      };\n\n      this.updatingHandles.add(this, \"rendererTextureUsage\", t), this.updatingHandles.add(this, \"uncompressedTextureDownsamplingEnabled\", t), this.updatingHandles.add(this, \"suspended\", e => this._suspendedChange(e), 2), this.updatingHandles.add(this.i3slayer, \"labelsVisible\", () => this._labelingChanged(), 2), this.updatingHandles.add(this.i3slayer, \"labelingInfo\", () => this._labelingChanged(), 2), this.updatingHandles.add(this, \"_modifications\", () => this._modificationsChanged(), 2), this.handles.add([y(Re, \"I3S_TREE_SHOW_TILES\", e => {\n        if (e && !this._treeDebugger) {\n          const e = this._controller.crsIndex;\n          import(\"./support/I3STreeDebugger.js\").then(({\n            I3STreeDebugger: t\n          }) => {\n            !this._treeDebugger && Re.I3S_TREE_SHOW_TILES && (this._treeDebugger = new t({\n              lv: this,\n              view: this.view,\n              nodeSR: e\n            }));\n          });\n        } else e || Re.I3S_TREE_SHOW_TILES || (this._treeDebugger = d(this._treeDebugger));\n      }), y(Re, \"I3S_SHOW_MODIFICATIONS\", () => this._showModifications())]), this._cacheKeySuffix = ve(this.i3slayer.spatialReference, this.view.renderSpatialReference), this._idbCache.init().catch(e => Ge.warn(`Failed to initialize IndexedDB cache: ${e}`));\n    }\n\n    destroy() {\n      this._clearAddTasks(), this.attributeOverrides = d(this.attributeOverrides), this._elevationProvider && (this._elevationProvider.layerChanged(), this.view.elevationProvider.unregister(this._elevationProvider), this._elevationProvider = null), this._intersectionHandler && (this._stage.sceneIntersectionHelper.removeIntersectionHandler(this._intersectionHandler), this._intersectionHandler = null);\n      const e = this._worker;\n      e && (e.destroyContext(this.i3slayer.uid).then(() => e.destroy()), this._worker = null), this._removeAllNodeDataFromStage(), this._memCache = d(this._memCache), this._collection = null, this._stage = null, this._edgeView = null, this._labeler = d(this._labeler), this._treeDebugger = d(this._treeDebugger), this._controller = d(this._controller), this._highlights.destroy(), this._nodeId2Meta.clear(), this._nodeId2MetaReloading.clear(), this.emit(\"visible-geometry-changed\"), this._visibleGeometryChangedSchedulerHandle && (this._visibleGeometryChangedSchedulerHandle.remove(), this._visibleGeometryChangedSchedulerHandle = null);\n    }\n\n    memEstimateTextureAdded(e) {\n      const t = e.estimatedTexMemRequired;\n      return this.gpuMemoryEstimate += t, this.texMemoryEstimate += t, t;\n    }\n\n    memEstimateTextureRemoved(e) {\n      const t = e.estimatedTexMemRequired;\n      this.gpuMemoryEstimate -= t, this.texMemoryEstimate -= t;\n    }\n\n    memEstimateGeometryAdded(e) {\n      const t = this._collection.getObjectGPUMemoryUsage(e);\n\n      return this.gpuMemoryEstimate += t, this.geoMemoryEstimate += t, t;\n    }\n\n    memEstimateGeometryRemoved(e) {\n      const t = this._collection.getObjectGPUMemoryUsage(e);\n\n      this.gpuMemoryEstimate -= t, this.geoMemoryEstimate -= t;\n    }\n\n    isNodeLoaded(e) {\n      return this._nodeId2Meta.has(e);\n    }\n\n    isNodeReloading(e) {\n      return this._nodeId2MetaReloading.has(e);\n    }\n\n    getUsedMemory() {\n      let e = l(this._labeler) ? this._labeler.usedMemory : 0;\n      return this._nodeId2Meta.forEach(t => e += l(t) ? t.node.memory : 0), this._nodeId2MetaReloading.forEach(t => e += l(t) ? t.node.memory : 0), e;\n    }\n\n    getUnloadedMemory() {\n      return (l(this._controller) ? this._controller.unloadedMemoryEstimate : 0) + (l(this._labeler) ? this._labeler.unloadedMemoryEstimate : 0);\n    }\n\n    ignoresMemoryFactor() {\n      return !1;\n    }\n\n    _labelingChanged() {\n      if (!(k(this.i3slayer) && this._supportsLabeling)) return void (l(this._labeler) && (this._labeler.destroy(), this._labeler = null));\n      if (l(this._labeler)) return;\n      const e = new Q({\n        view: this.view,\n        layer: this.i3slayer,\n        collection: this._collection\n      });\n      this._nodeId2Meta.forEach(t => l(t) && this._addMetaToLabeler(e, t)), this._labeler = e;\n    }\n\n    _loadAsyncModule(e) {\n      return ++this._asyncModuleLoading, e.then(e => (--this._asyncModuleLoading, e), e => {\n        throw --this._asyncModuleLoading, e;\n      });\n    }\n\n    _modificationsChanged() {\n      if (!this._i3sWasmLoaded && this._hasModifications) return this._i3sWasmLoaded = Z().then(() => {\n        this._i3sWasmLoaded = !0, this._modificationsChanged(), this.notifyUpdate();\n      }), void this.notifyUpdate();\n      if (!0 !== this._i3sWasmLoaded) return;\n      const e = this.i3slayer.uid,\n            t = this.i3slayer.spatialReference;\n\n      this._worker.setModifications(e, this._modifications, t);\n\n      const i = Y(this._modifications, t);\n      ee({\n        context: e,\n        modifications: i,\n        isGeodetic: t.isGeographic\n      }), this._controller.modificationsChanged();\n      const s = this._hasModifications ? new _() : null;\n      this._nodeId2Meta.forEach((e, t) => {\n        h(e) ? this._nodeId2Meta.delete(t) : e.node.hasModifications ? (this._nodeId2Meta.delete(t), this._nodeId2MetaReloading.set(t, e)) : l(s) && s.push(e.node);\n      }), l(s) && this._nodeId2MetaReloading.forEach(e => s.push(e.node)), l(s) && s.length > 0 && (this.updateNodeModificationStatus(s), s.forAll(e => {\n        if (2 !== e.imModificationImpact) {\n          const t = this._nodeId2Meta.get(e.index);\n\n          this._controller.invalidateGeometryVisibility(e.index), this._nodeId2Meta.delete(e.index), l(t) && this._nodeId2MetaReloading.set(e.index, t);\n        }\n      })), this.clearMemCache(), this._controller.restartNodeLoading(), this._showModifications();\n    }\n\n    _showModifications() {\n      if (l(this._modificationGraphics) && (this.view.graphics.removeMany(this._modificationGraphics), this._modificationGraphics = null), !Re.I3S_SHOW_MODIFICATIONS || 0 === this._modifications.length) return;\n      const e = {\n        clip: [227, 227, 79, .8],\n        mask: [227, 139, 79, .8],\n        replace: [139, 227, 79, .8]\n      },\n            t = {\n        type: \"simple-fill\",\n        outline: {\n          color: [255, 255, 255],\n          width: 1\n        }\n      };\n      this._modificationGraphics = new Array();\n\n      for (const s of this._modifications) {\n        s.geometry.spatialReference = this.i3slayer.spatialReference;\n        const r = { ...t,\n          color: e[s.type]\n        };\n\n        this._modificationGraphics.push(new i({\n          geometry: s.geometry,\n          symbol: r\n        }));\n      }\n\n      this.view.graphics.addMany(this._modificationGraphics);\n    }\n\n    _addMetaToLabeler(e, t) {\n      e.addNodeMeta(t, (e, t) => this._createAttributes(e, t));\n    }\n\n    _suspendedChange(e) {\n      e ? (this._removeAllNodeDataFromStage(), this.view.elevationProvider && this.view.elevationProvider.unregister(this._elevationProvider), this._stage.sceneIntersectionHelper.removeIntersectionHandler(this._intersectionHandler)) : (this.view.elevationProvider.register(this._elevationContext, this._elevationProvider), this._stage.sceneIntersectionHelper.addIntersectionHandler(this._intersectionHandler));\n    }\n\n    getLoadedAttributes(e) {\n      const t = this._nodeId2Meta.get(e);\n\n      if (l(t) && l(t.attributeInfo)) return t.attributeInfo.loadedAttributes;\n    }\n\n    getAttributeData(e) {\n      const t = this._nodeId2Meta.get(e);\n\n      if (l(t) && l(t.attributeInfo)) return t.attributeInfo.attributeData;\n    }\n\n    setAttributeData(e, t) {\n      const i = this._nodeId2Meta.get(e);\n\n      l(i) && l(i.attributeInfo) && (i.attributeInfo.attributeData = t, this._attributeValuesChanged(i));\n    }\n\n    async updateAttributes(e, t, i) {\n      const s = this._nodeId2Meta.get(e);\n\n      l(s) && (await this.attributeOverrides.apply(s.featureIds, t, i), s.attributeInfo = t, this._attributeValuesChanged(s));\n    }\n\n    _attributeValuesChanged(e) {\n      e.cachedRendererVersion = this._getInvalidRendererVersion(), e.filteredIds = null, l(this._labeler) && this._labeler.setNodeMetaAttributes(e, (e, t) => this._createAttributes(e, t)), this._updateEngineObject(e);\n    }\n\n    clearMemCache() {\n      l(this._memCache) && this._memCache.clear();\n    }\n\n    getVisibleNodes() {\n      const e = new Array();\n      return this._nodeId2Meta.forEach(t => l(t) && e.push(t.node)), e;\n    }\n\n    getLoadedNodeIndices(e) {\n      this._nodeId2Meta.forEach((t, i) => e.push(i)), this._nodeId2MetaReloading.forEach((t, i) => e.push(i));\n    }\n\n    preLoadBasis() {\n      !r(\"disable-feature:i3s-basis\") && 0 != (2 & this.supportedTextureEncodings) && c(this.i3slayer.textureSetDefinitions, e => e.some(e => e.formats.some(e => \"basis\" === e.format || \"ktx2\" === e.format))) && Ue();\n    }\n\n    _getVertexBufferLayout(e, t) {\n      const i = {\n        hasTexture: Ye(e.params.material),\n        hasNormals: t.normal,\n        hasRegions: t.uvRegion\n      };\n      return Pe(He(this._getGeometryParameters(i)));\n    }\n\n    _getObjectIdField() {\n      return this.i3slayer.objectIdField || \"OBJECTID\";\n    }\n\n    _findGraphicNodeAndIndex(e) {\n      const t = De(this.i3slayer.fieldsIndex, e.attributes, this._getObjectIdField());\n      let i = null;\n      return a(this._nodeId2Meta, e => {\n        if (h(e)) return !1;\n        const s = e.featureIds.indexOf(t);\n        return -1 !== s && (i = {\n          node: e.node,\n          index: s\n        }, !0);\n      }), i;\n    }\n\n    _getGraphicIndices(e, t) {\n      const i = this._nodeId2Meta.get(e.index);\n\n      if (h(i)) return [];\n\n      const s = [],\n            r = this._getObjectIdField(),\n            o = this.i3slayer.fieldsIndex;\n\n      for (const a of t) {\n        const e = De(o, a.attributes, r),\n              t = i.featureIds.indexOf(e);\n        -1 !== t && s.push(t);\n      }\n\n      return s;\n    }\n\n    whenGraphicBounds(e) {\n      const t = this._findGraphicNodeAndIndex(e);\n\n      if (!t) return Promise.reject();\n\n      const i = this._nodeId2Meta.get(t.node.index);\n\n      if (h(i)) return Promise.reject();\n      const s = i.objectHandle,\n            r = de(t.index, this._collection, s, new Float64Array(24)),\n            o = this.view.renderSpatialReference,\n            a = this.view.spatialReference;\n\n      if (R(r, o, 0, r, a, 0, 8)) {\n        const e = H();\n        return U(e, r, 0, 8), Promise.resolve({\n          boundingBox: e,\n          screenSpaceObjects: []\n        });\n      }\n    }\n\n    whenGraphicAttributes(e, t) {\n      return Ie(this.i3slayer, e, this._getObjectIdField(), t, () => [...this._nodeId2Meta.values()].filter(l));\n    }\n\n    getGraphicFromIntersectorMetadata(e) {\n      if (null == e.nodeIndex || null == e.componentIndex) return null;\n\n      const t = this._nodeId2Meta.get(e.nodeIndex);\n\n      return h(t) || null == t.featureIds || e.componentIndex >= t.featureIds.length ? null : this._createGraphic(e.componentIndex, t);\n    }\n\n    _getCacheKey(e) {\n      return `${this._layerUrl}/v${ke}/${e.id}${this._cacheKeySuffix}`;\n    }\n\n    _getMemCacheKey(e, t = this.elevationOffset) {\n      return e + \"#\" + t;\n    }\n\n    get _idbCacheEnabled() {\n      return !this._controller.disableIDBCache && 0 === this._modifications.length && 0 === this.elevationOffset && null != this._cacheKeySuffix;\n    }\n\n    loadCachedGPUData(e) {\n      return l(this._memCache) ? this._memCache.pop(this._getMemCacheKey(e.index)) : null;\n    }\n\n    deleteCachedGPUData(e) {\n      l(e) && this._deleteComponentObject(e);\n    }\n\n    _cacheGPUData(e, t = this.elevationOffset) {\n      if (h(this._memCache)) return void this._deleteComponentObject(e);\n      const i = this._controller.indexDepth - e.node.level;\n\n      this._memCache.put(this._getMemCacheKey(e.node.index, t), e, e.node.memory, i);\n    }\n\n    loadMissingTextures(e, t, i, s) {\n      const r = e.filter((e, i) => {\n        if (0 == (e.usage & this.rendererTextureUsage)) return !1;\n        if (h(t)) return !0;\n        const s = ue(e.encodings, this.supportedTextureEncodings),\n              r = t[i];\n        return !!(h(r) || null == r.data || s && r.encoding !== s.encoding);\n      });\n      return 0 === r.length ? Promise.resolve(!1) : i(r, s).then(i => {\n        let s = 0;\n\n        for (let r = 0; r < e.length; r++) s < i.length && i[s].id === e[r].id && (t[r] = i[s], s++);\n\n        return !0;\n      });\n    }\n\n    loadCachedNodeData(e, t, i) {\n      return this._idbCacheEnabled ? this._idbCache.get(this._getCacheKey(e), t).then(s => null == s ? null : s.nodeVersion !== e.version ? (this._idbCache.remove(this._getCacheKey(e)), null) : (e.geometryObb = s.geometryObb, this.loadMissingTextures(s.requiredTextures, s.textureData, i, t).then(i => (i && this._idbCache.initialized && l(s.textureData) && (s.byteSize = tt(s.transformedGeometry, s.textureData), s.textureData.every(et) && it(e, s) && this._idbCache.put(this._getCacheKey(e), s).catch(t => Ge.warn(`Failed to update node with textures in IndexedDB cache: ${e.id}: ${t}`))), m(t), s)))) : Promise.resolve(null);\n    }\n\n    addNode(e, t, i) {\n      return Ze(t) ? this._addData(e, t.attributeDataInfo, () => this._transformNode(e, t, i).then(s => this._safeReschedule(() => {\n        if (h(s)) return e.hasModifications = !1, this._addCachedNodeData(e, null, i);\n        e.hasModifications = s.transformedGeometry.hasModifications;\n        const {\n          obb: r,\n          componentOffsets: o,\n          featureIds: a,\n          transformedGeometry: n\n        } = s,\n              d = this._controller.crsIndex,\n              c = this.view.renderSpatialReference,\n              u = ge(e.mbs, this.elevationOffset, d, c);\n        e.geometryObb = Te([r.center.x, r.center.y, r.center.z], [r.extents.x, r.extents.y, r.extents.z], [r.orientation.x, r.orientation.y, r.orientation.z, r.orientation.w]), S(e.geometryObb.center, e.geometryObb.center, u), t.geometryData.componentOffsets = o, a && (t.geometryData.featureIds = Array.prototype.slice.call(a));\n        const _ = {\n          nodeVersion: e.version,\n          geometryData: t.geometryData,\n          requiredTextures: t.requiredTextures,\n          textureData: t.textureData,\n          transformedGeometry: n,\n          globalTrafo: u,\n          geometryObb: e.geometryObb,\n          byteSize: tt(n, t.textureData)\n        };\n\n        if (this._idbCacheEnabled && this._idbCache.initialized && it(e, _)) {\n          const t = l(_.textureData) ? _.textureData.map(e => et(e) ? e : null) : null;\n\n          this._idbCache.put(this._getCacheKey(e), { ..._,\n            textureData: t\n          }).catch(t => Ge.warn(`Failed to store node in IndexedDB cache: ${e.id}: ${t}`));\n        }\n\n        return this._addCachedNodeData(e, _, i);\n      }, i))) : Promise.reject();\n    }\n\n    computeVisibilityObb(e) {\n      return Me(e, this.view.renderSpatialReference, this._controller.crsIndex, this.i3slayer.spatialReference, this.elevationOffset, this._modifications);\n    }\n\n    _transformNode(e, t, i) {\n      const s = t.geometryData.geometries,\n            r = new Array(s.length);\n\n      for (let h = 0; h < s.length; ++h) r[h] = this._getVertexBufferLayout(s[h], t.geometryDescriptor);\n\n      const o = e.mbs,\n            a = this.elevationOffset,\n            n = this._controller.crsIndex,\n            l = this._controller.crsVertex,\n            d = this.view.renderSpatialReference,\n            c = pe(o, a, n),\n            u = ge(o, a, n, d),\n            _ = N(n, l),\n            m = N(l, d);\n\n      if (h(_) || h(m)) return Promise.resolve(null);\n      const g = {\n        context: this.i3slayer.uid,\n        geometryBuffer: t.geometryBuffer,\n        geometryData: t.geometryData,\n        geometryDescriptor: t.geometryDescriptor,\n        layouts: r,\n        localOrigin: c,\n        globalTrafo: u,\n        mbs: o,\n        obb: e.serviceObb,\n        elevationOffset: a,\n        needNormals: !this._isIntegratedMesh && this._controller.isMeshPyramid,\n        normalReferenceFrame: this.i3slayer.normalReferenceFrame || \"none\",\n        indexToVertexProjector: _,\n        vertexToRenderProjector: m\n      };\n      return this._worker.invoke(g, i);\n    }\n\n    get supportsNodeCrossFading() {\n      var e, t;\n      return !(null != (e = this.view) && null != (t = e._stage) && t.renderView.has(3));\n    }\n\n    get nodeCrossfadingEnabled() {\n      return this.supportsNodeCrossFading && (this.lodCrossfadeinDuration > 0 || this.lodCrossfadeoutDuration > 0 || this.lodCrossfadeUncoveredDuration > 0);\n    }\n\n    get nodeFadeoutEnabled() {\n      return this.supportsNodeCrossFading && this.lodCrossfadeoutDuration > 0;\n    }\n\n    _setNewNodeOpacity(e) {\n      const t = this.nodeCrossfadingEnabled ? 0 : this.fullOpacity;\n\n      this._setNodeOpacity(e, t);\n    }\n\n    addCachedGPUData(e, t, i) {\n      if (e.geometryObb = Ve(this._collection.getComponentObb(t.objectHandle)), !this._controller.isGeometryVisible(e)) return void this._cacheGPUData(t);\n      l(this._labeler) && this._addMetaToLabeler(this._labeler, t);\n      const s = e.index;\n      this._addNodeMeta(s, t), this.updateNodeState(s, i), this._collection.setObjectVisibility(t.objectHandle, !0), this._updateMaterial(t), this._setNewNodeOpacity(t), this._updateEngineObject(t), this._highlights.objectCreated(t), l(this._treeDebugger) && this._treeDebugger.update();\n    }\n\n    addCachedNodeData(e, t, i, s) {\n      return this._addData(e, i, () => this._addCachedNodeData(e, t, s));\n    }\n\n    async _addCachedNodeData(e, t, i) {\n      if (this.suspended || !this._controller.isGeometryVisible(e)) return void this._removeNodeStageData(e.index, this.elevationOffset, this._nodeId2MetaReloading);\n      if (h(t)) return void this._addNodeMeta(e.index, null);\n\n      const s = this._addTasks.get(e.index),\n            {\n        geometryData: o,\n        transformedGeometry: a,\n        globalTrafo: n\n      } = t;\n\n      await this.attributeOverrides.apply(o.featureIds, s.attributeInfo, i);\n      const d = l(t.textureData) ? t.textureData.filter(e => l(e) && 0 != (e.usage & this.rendererTextureUsage)) : [];\n      !r(\"disable-feature:i3s-basis\") && d.some(e => l(e) && (2 === e.encoding || 1 === e.encoding)) && (await Ue()), e.memory = 0;\n\n      const {\n        componentOffsets: c,\n        geometries: _,\n        featureIds: m\n      } = o,\n            g = this._collection,\n            p = _[0],\n            {\n        layout: f,\n        indices: b,\n        interleavedVertexData: y,\n        positionData: v,\n        hasColors: I\n      } = a,\n            S = this._materialParameters(p, f),\n            E = c || new Uint32Array([0, b ? b.length : y.byteLength / f[0].stride]),\n            D = {\n        vertices: {\n          data: y,\n          count: y.byteLength / f[0].stride,\n          layoutParameters: S.geometryParams\n        },\n        positionData: {\n          positions: v.data,\n          indices: v.indices\n        },\n        indices: b,\n        componentOffsets: E\n      },\n            R = p.transformation ? j(p.transformation) : w();\n\n      x(R, n, R);\n      const N = O(F(), R),\n            A = M(C(), R),\n            P = this.view.renderSpatialReference,\n            H = this.view.basemapTerrain.spatialReference,\n            U = F(),\n            G = [1, 1, 1];\n      T(N, P, G, H), V(N, P, U, H);\n\n      const L = g.createObject({\n        toMapSpace: [U[0], U[1], G[0], G[1]],\n        geometry: D,\n        obb: u(e.geometryObb),\n        transform: {\n          position: N,\n          rotationScale: A\n        },\n        visible: !1\n      }),\n            B = 2 === S.geometryParams.textureCoordinates,\n            k = this._initMaterialAndTextures(L, S.material, d, B);\n\n      e.memory += this.memEstimateGeometryAdded(L), e.memory += k.reduce((e, t) => e + (l(t) ? this.memEstimateTextureAdded(t) : 0), 0);\n      const q = !!S.material.hasParametersFromSource,\n            z = \"blend\" !== S.material.alphaMode && S.material.metallicRoughness.baseColorFactor[3] >= 1,\n            W = new Be(e, m, L, this._getInvalidRendererVersion(), s.attributeInfo, {\n        hasParametersFromSource: q,\n        isOpaque: z\n      }, k);\n      s.meta = W, !this._hasTextures && t.requiredTextures.some(({\n        usage: e\n      }) => 0 != (19 & e)) && (this._hasTextures = !0), this._hasData = !0, this._hasColors = this._hasColors || I, this._hasTextures = this._hasTextures || !!e.resources.texture, this.notifyChange(\"hasTexturesOrVertexColors\");\n      const $ = this.slicePlaneEnabled;\n      return this._addOrUpdateEdgeRendering(W).then(t => (l(t) && t.updateObjectVisibility(W.objectHandle, !1), this._safeReschedule(() => {\n        const i = this._addTasks.get(e.index);\n\n        if (!i) return;\n        if (l(this._labeler) && this._addMetaToLabeler(this._labeler, W), this._addNodeMeta(e.index, W), i.meta = null, this.suspended) return void this._removeNodeStageData(e.index, this.elevationOffset);\n        g.setObjectVisibility(L, !0), l(t) && t.updateObjectVisibility(W.objectHandle, !0), W.attributeInfo = i.attributeInfo;\n        const s = W.cachedRendererVersion !== this._rendererVersion,\n              r = $ !== this.slicePlaneEnabled;\n\n        this._setObjectSymbolColors(W);\n\n        const o = this._applyFiltersToNode(W);\n\n        (s || l(t) && (r || o)) && this._addOrUpdateEdgeRendering(W), this._visibleGeometryChanged(W), this._highlights.objectCreated(W), this._updateMaterial(W), this._setNewNodeOpacity(W), l(this._treeDebugger) && this._treeDebugger.update();\n      }, i))).catch(e => {\n        throw l(s.meta) && (this._deleteComponentObject(s.meta), s.meta = null), e;\n      });\n    }\n\n    _addNodeMeta(e, t) {\n      if (this._removeNodeStageData(e, this.elevationOffset, this._nodeId2MetaReloading), this._nodeId2Meta.has(e)) {\n        Ge.error(\"Removing duplicated node\");\n\n        const t = this._nodeId2Meta.get(e);\n\n        l(t) && this._deleteComponentObject(t);\n      }\n\n      l(t) && (t.lodCrossfadeProgress = null, this.nodeCrossfadingEnabled && ot(t.cachedEdgeMaterials, 0)), this._nodeId2Meta.set(e, t);\n    }\n\n    _safeReschedule(e, t) {\n      return m(t), this._controller.reschedule(e, t);\n    }\n\n    _materialParameters(e, t) {\n      const i = e.params.material,\n            s = t.some(e => \"uvRegion\" === e.name),\n            r = t.some(e => \"normalCompressed\" === e.name),\n            o = Ye(i);\n      return {\n        geometryParams: this._getGeometryParameters({\n          hasTexture: o,\n          hasNormals: r,\n          hasRegions: s\n        }),\n        material: i\n      };\n    }\n\n    _initMaterialAndTextures(e, t, i, s) {\n      const r = this._stage.renderView,\n            o = i.map(e => _e(e, t, s, r));\n\n      for (const a of o) l(a) && this._stage.add(a);\n\n      return this._collection.updateMaterial(e, e => {\n        me(e, t, o, i, this.view._stage.renderView.textureRepository, {\n          rendererTextureUsage: this.rendererTextureUsage,\n          usePBR: this._usePBR(),\n          isIntegratedMesh: this._isIntegratedMesh,\n          slicePlaneEnabled: this.slicePlaneEnabled,\n          viewSpatialReference: this.view.spatialReference\n        }), this._updateMaterialOverlay(e);\n      }), o;\n    }\n\n    _getGeometryParameters(e) {\n      return {\n        textureCoordinates: e.hasTexture ? e.hasRegions ? 2 : 1 : 0,\n        colors: this._hasVertexColors,\n        normals: e.hasNormals && !this._isIntegratedMesh\n      };\n    }\n\n    _addData(e, t, i) {\n      let s = this._addTasks.get(e.index);\n\n      return s ? s.attributeInfo = t : (s = { ...g(),\n        attributeInfo: t,\n        meta: null\n      }, this._addTasks.set(e.index, s), i().then(s.resolve, s.reject).then(() => this._addTasks.delete(e.index)).catch(t => {\n        throw this._addTasks.delete(e.index), t;\n      })), s.promise;\n    }\n\n    _clearAddTasks() {\n      this._addTasks.forEach(e => {\n        l(e.meta) && (this._deleteComponentObject(e.meta), e.meta = null);\n      }), this._addTasks.clear();\n    }\n\n    _clippingAreaChanged() {\n      const e = P();\n      Ne(this.view.clippingArea, e, this.view.renderSpatialReference) ? this._clippingArea = e : this._clippingArea = null, this._filterChange(), this._controller && this._controller.updateClippingArea(this.view.clippingArea);\n    }\n\n    _geometryFilterChange() {\n      this._controller.geometryFilterChanged(this.hasGeometryFilter);\n    }\n\n    get hasGeometryFilter() {\n      return !1;\n    }\n\n    _filterChange() {\n      this._applyFilters(!1);\n    }\n\n    _applyFilters(e) {\n      this._filters = this.getFilters(), e ? this._controller && this._controller.requestUpdate() : this._nodeId2Meta.forEach(e => {\n        l(e) && this._applyFiltersToNode(e) && (this._addOrUpdateEdgeRendering(e), this._visibleGeometryChanged(e));\n      });\n    }\n\n    getFilters() {\n      const e = [];\n      return this._clippingArea && e.push((e, t) => this._boundingboxFilter(e, t, this._clippingArea)), e;\n    }\n\n    addSqlFilter(e, t, i) {\n      if (l(t)) {\n        const s = t.fieldNames;\n        e.push((e, r) => this._sqlFilter(e, r, t, s, i));\n      }\n    }\n\n    _sqlFilter(e, t, i, s, r) {\n      const o = {},\n            a = this._createLayerGraphic(o),\n            n = this.i3slayer.objectIdField,\n            d = t.featureIds,\n            h = l(t.attributeInfo) && t.attributeInfo.attributeData;\n\n      s.every(e => null != h[e] || e === n) && Ce(e, d, e => {\n        o[n] = d[e];\n\n        for (const i of s) i !== n && (o[i] = xe(h[i], e));\n\n        try {\n          return i.testFeature(a);\n        } catch (t) {\n          return r(t), !1;\n        }\n      });\n    }\n\n    _boundingboxNodeTest(e, t) {\n      return A(e.node.mbs, this._controller.crsIndex, Xe, this.view.renderSpatialReference), Oe(t, Xe);\n    }\n\n    _boundingboxFeatureTest(e, t, i) {\n      return G(i, this._collection.getComponentAabb(e.objectHandle, t, We));\n    }\n\n    _boundingboxFilter(e, t, i) {\n      const s = this._collection,\n            r = this._boundingboxNodeTest(t, i);\n\n      if (3 === r) return;\n      if (0 === r) return void (e.length = 0);\n      const o = s.getComponentCount(t.objectHandle);\n      if (o.invisible + o.visible !== t.featureIds.length) return;\n\n      const a = this._transformAABB($e, i, t.objectHandle);\n\n      Ce(e, t.featureIds, e => this._boundingboxFeatureTest(t, e, a));\n    }\n\n    _transformAABB(e, t, i) {\n      const s = this._collection.getObjectTransform(i),\n            r = s.position,\n            o = s.rotationScale;\n\n      return e[0] = (t[0] - r[0]) / o[0], e[1] = (t[1] - r[1]) / o[4], e[2] = (t[2] - r[2]) / o[8], e[3] = (t[3] - r[0]) / o[0], e[4] = (t[4] - r[1]) / o[4], e[5] = (t[5] - r[2]) / o[8], e;\n    }\n\n    _addOrUpdateEdgeRendering(e, t = !0) {\n      if (h(this._edgeView)) return Promise.resolve(null);\n\n      const i = e.objectHandle,\n            s = this._edgeView.hasObject(i),\n            {\n        hasEdges: r,\n        perFeatureEdgeMaterials: o\n      } = this._getFilteredEdgeMaterials(e),\n            a = {\n        slicePlaneEnabled: this.slicePlaneEnabled\n      };\n\n      if (r) {\n        if (s) {\n          if (this.nodeCrossfadingEnabled) {\n            ot(o, this.getNodeOpacity(e));\n          }\n\n          return this._edgeView.updateAllComponentMaterials(i, o, a, t), this._edgeView.updateObjectVisibility(i, !0), Promise.resolve(this._edgeView);\n        }\n\n        return this._collection.addEdges(i, this._edgeView, o, a).then(() => this._edgeView);\n      }\n\n      return s && this._edgeView.removeObject(i), Promise.resolve(null);\n    }\n\n    _removeEdgeRendering(e) {\n      l(this._edgeView) && this._edgeView.hasObject(e.objectHandle) && this._edgeView.removeObject(e.objectHandle);\n    }\n\n    _applyFiltersToNode(e) {\n      return !!this._applyFiltersToNodeComponents(e) && (l(this._labeler) && this._labeler.applyFilterChange(e), !0);\n    }\n\n    _applyFiltersToNodeComponents(e) {\n      const t = this._collection,\n            i = 0 === t.getComponentCount(e.objectHandle).invisible;\n      if (t.setAllComponentVisibilities(e.objectHandle, \"all\"), 0 === this._filters.length) return e.filteredIds = null, !i;\n      if (this._updateCachedFilteredIds(e), e.filteredIds === e.featureIds) return !i;\n\n      const s = this._computeFilteredComponentIndices(e);\n\n      return t.setAllComponentVisibilities(e.objectHandle, s), !0;\n    }\n\n    _updateCachedFilteredIds(e) {\n      null != e.filteredIds && e.appliedFilters === this._filters || (e.filteredIds = this._computeFilteredIds(e), e.appliedFilters = this._filters);\n    }\n\n    _computeFilteredIds(e) {\n      const t = e.featureIds.slice();\n\n      for (const i of this._filters) if (i(t, e), 0 === t.length) break;\n\n      return t.length === e.featureIds.length ? e.featureIds : t;\n    }\n\n    _computeFilteredComponentIndices(e) {\n      const t = new Array();\n      return e.featureIds.forEach((i, s) => {\n        e.filteredIds[t.length] === i && t.push(s);\n      }), t;\n    }\n\n    _removeAllNodeDataFromStage(e = this.elevationOffset) {\n      this._nodeId2Meta.forEach((t, i) => this._removeNodeStageData(i, e)), this._nodeId2MetaReloading.forEach((t, i) => this._removeNodeStageData(i, e, this._nodeId2MetaReloading));\n    }\n\n    removeNode(e) {\n      const t = this.elevationOffset;\n      this._removeNodeStageData(e, t), this._removeNodeStageData(e, t, this._nodeId2MetaReloading);\n    }\n\n    _removeNodeStageData(e, t, i = this._nodeId2Meta) {\n      const s = i.get(e);\n      h(s) ? i.delete(e) : (this._collection.setObjectVisibility(s.objectHandle, !1), this._visibleGeometryChanged(s), this._removeEdgeRendering(s), l(this._labeler) && this._labeler.removeNodeMeta(s), i.delete(e), this._highlights.objectDeleted(s), i === this._nodeId2Meta ? (this._cacheGPUData(s, t), this.nodeCrossfadingEnabled && this._crossfadeHelper.stopNodeFading(s)) : this._deleteComponentObject(s), l(this._treeDebugger) && this._treeDebugger.update());\n    }\n\n    _deleteComponentObject(e) {\n      if (l(this._edgeView) && this._edgeView.removeObject(e.objectHandle), this.memEstimateGeometryRemoved(e.objectHandle), this._collection.destroyObject(e.objectHandle), e.textures) for (const t of e.textures) this.memEstimateTextureRemoved(t), this._stage.remove(t);\n    }\n\n    updateNodeState(e, t) {\n      const i = this._nodeId2Meta.get(e);\n\n      l(i) && this._collection.updateMaterial(i.objectHandle, e => e.polygonOffsetEnabled = 0 === t);\n    }\n\n    _invalidateAllSymbols() {\n      this._rendererVersion = je(this._rendererVersion, 1), this._controller && this._controller.requestUpdate();\n    }\n\n    _getInvalidRendererVersion() {\n      return je(this._rendererVersion, -1);\n    }\n\n    async _rendererChange(e) {\n      if (this._currentRenderer = e, this.notifyChange(\"rendererTextureUsage\"), this._rendererVersion = je(this._rendererVersion, 1), this._rendererFields = null, this._colorVariable = null, this._opacityVariable = null, this._invalidateAllSymbols(), e && (this._rendererFields = await e.getRequiredFields(this.i3slayer.fieldsIndex)), this._updateSymbologyFields(), !this._arcade && e && \"arcadeRequired\" in e && e.arcadeRequired && (this._arcade = await $()), e && \"visualVariables\" in e && e.visualVariables) for (const t of e.visualVariables) \"color\" === t.type ? this._colorVariable = t : \"opacity\" === t.type ? this._opacityVariable = t : Ge.warn(`Unsupported visual variable type for 3D Object Scene Services: ${t.type}`);\n      if (e) for (const t of e.getSymbols()) \"mesh-3d\" !== t.type && Ge.error(`Symbols of type '${t.type}' are not supported for 3D Object Scene Services.`);\n      this._controller && this._controller.requestUpdate();\n    }\n\n    _getCachedEdgeMaterials(e) {\n      return this._hasSymbolColors && e.cachedRendererVersion !== this._rendererVersion && this._updateCachedRendererData(e), e.cachedEdgeMaterials;\n    }\n\n    _getSymbolColors(e) {\n      this._hasSymbolColors && e.cachedRendererVersion !== this._rendererVersion && this._updateCachedRendererData(e);\n      const t = e.cachedSymbology;\n      return (e, i) => {\n        const s = 5 * e;\n        D(i.externalColor, t[s + 0] / 255, t[s + 1] / 255, t[s + 2] / 255, t[s + 3] / 255), i.externalColorMixMode = 15 & t[s + 4], i.castShadows = 0 != (16 & t[s + 4]), i.pickable = 0 != (32 & t[s + 4]);\n      };\n    }\n\n    _getSymbolInfo(e, t) {\n      const i = e && e.getSymbol(t, {\n        arcade: this._arcade\n      });\n      if (!(i instanceof K)) return null;\n      const s = i.id;\n      if (this._symbolInfos.has(s)) return this._symbolInfos.get(s);\n      const r = we(i);\n      return this._symbolInfos.set(s, r), r;\n    }\n\n    _setSymbologyOverride(e, t) {\n      this._symbologyOverride !== e && (this._symbologyOverride = e, this._symbologyOverrideFields = t, this._invalidateAllSymbols(), this._updateSymbologyFields());\n    }\n\n    _updateSymbologyFields() {\n      this._symbologyFields = l(this._symbologyOverrideFields) && this._symbologyOverrideFields.length > 0 ? l(this._rendererFields) && this._rendererFields.length > 0 ? B(this.i3slayer.fieldsIndex, [...this._rendererFields, ...this._symbologyOverrideFields]) : this._symbologyOverrideFields : this._rendererFields;\n    }\n\n    _updateCachedRendererData(e) {\n      if (e.cachedRendererVersion = this._rendererVersion, !this._hasSymbolColors) return;\n      const t = this._tmpAttributeOnlyGraphic,\n            i = {};\n      t.attributes = i;\n      const s = this._currentRenderer,\n            r = l(e.attributeInfo) && e.attributeInfo.attributeData,\n            o = null != e.featureIds ? this.i3slayer.objectIdField : null,\n            a = null != r && l(this._symbologyFields) && this._symbologyFields.length > 0,\n            n = a ? [] : null,\n            d = a ? [] : null;\n      if (a && l(this._symbologyFields)) for (const l of this._symbologyFields) {\n        const e = r[l];\n        e && (n.push(l), d.push(e));\n      }\n      e.cachedSymbology || (e.cachedSymbology = new Uint8Array(5 * e.featureIds.length));\n\n      const c = {\n        color: Je,\n        castShadows: !0,\n        pickable: !0,\n        colorMixMode: 1,\n        edgeMaterial: null\n      },\n            u = this.fullOpacity,\n            _ = this.nodeCrossfadingEnabled ? this.getNodeOpacity(e) : u;\n\n      let m = null,\n          g = 2,\n          p = Se,\n          f = 0;\n\n      for (let b = 0; b < e.featureIds.length; b++) {\n        if (null != o && (i[o] = e.featureIds[b]), a) for (let e = 0; e < n.length; e++) i[n[e]] = xe(d[e], b);\n\n        const r = this._getSymbolInfo(s, t);\n\n        let u = null,\n            y = null;\n\n        if (s && \"visualVariables\" in s) {\n          if (this._colorVariable) {\n            const e = z(this._colorVariable, t, {\n              color: Qe,\n              arcade: this._arcade\n            });\n            e && (u = Je, u[0] = e.r / 255, u[1] = e.g / 255, u[2] = e.b / 255, this._opacityVariable || null === e.a || (y = e.a));\n          }\n\n          this._opacityVariable && (y = W(this._opacityVariable, t, {\n            arcade: this._arcade\n          }));\n        }\n\n        if (r && r.material) {\n          const e = r.material;\n          u = h(u) || h(y) ? se(u, y, e.color, e.alpha, Le, Je) : se(u, y, null, null, Le, Je);\n        }\n\n        if (h(u) && (u = Je, u[0] = 1, u[1] = 1, u[2] = 1, u[3] = 1), c.pickable = !0, c.castShadows = !r || r.castShadows, c.colorMixMode = r && r.material ? r.material.colorMixMode : 1, c.edgeMaterial = r ? r.edgeMaterial : null, l(this._symbologyOverride) && (c.color = u, this._symbologyOverride(t, c), u = c.color), l(c.edgeMaterial)) {\n          const t = u[3] <= 0 ? 0 : u[3] >= 1 && (e.material.isOpaque || 3 === c.colorMixMode) ? 2 : 1;\n          c.edgeMaterial === m && t === g || (p = { ...c.edgeMaterial,\n            opacity: _,\n            objectTransparency: t\n          }, m = c.edgeMaterial, g = t), e.cachedEdgeMaterials[b] = p;\n        } else e.cachedEdgeMaterials[b] = Se;\n\n        e.cachedSymbology[f + 0] = Math.round(255 * u[0]), e.cachedSymbology[f + 1] = Math.round(255 * u[1]), e.cachedSymbology[f + 2] = Math.round(255 * u[2]), e.cachedSymbology[f + 3] = Math.round(255 * u[3]), e.cachedSymbology[f + 4] = c.colorMixMode | +c.castShadows << 4 | +c.pickable << 5, f += 5;\n      }\n    }\n\n    _getFilteredEdgeMaterials(e) {\n      const t = this._getCachedEdgeMaterials(e);\n\n      if (this.nodeCrossfadingEnabled || ot(t, this.fullOpacity), h(e.filteredIds)) {\n        return {\n          hasEdges: t.some(e => e !== Se),\n          perFeatureEdgeMaterials: t\n        };\n      }\n\n      let i = 0,\n          s = !1;\n      const r = t.map((t, r) => e.featureIds[r] !== e.filteredIds[i] ? Se : (s = s || t !== Se, i++, t));\n      return {\n        hasEdges: s,\n        perFeatureEdgeMaterials: r\n      };\n    }\n\n    _setObjectSymbolColors(e) {\n      if (!this._hasSymbolColors) return;\n\n      const t = e.objectHandle,\n            i = this._getSymbolColors(e);\n\n      this._collection.setComponentData(t, i), this._stage.renderView.setNeedsRender();\n    }\n\n    _reloadAll(e = this.elevationOffset) {\n      this._removeAllNodeDataFromStage(e), null != this._controller && this._controller.restartNodeLoading();\n    }\n\n    _opacityChange(e) {\n      this.nodeCrossfadingEnabled && this._crossfadeHelper.stopAllNodeFading(), this._nodeId2Meta.forEach(t => {\n        h(t) || (this._collection.updateMaterial(t.objectHandle, t => t.objectOpacity = e), ot(t.cachedEdgeMaterials, e), this._updateEdgeRendering(t));\n      });\n    }\n\n    _updateMaterial(e) {\n      this._collection.updateMaterial(e.objectHandle, e => {\n        e.commonMaterialParameters.slicePlaneEnabled = this.slicePlaneEnabled, e.usePBR = this._usePBR(), this._updateMaterialOverlay(e);\n      });\n    }\n\n    _updateMaterialOverlay(e) {}\n\n    _updateEngineObject(e) {\n      this._setObjectSymbolColors(e), this._applyFiltersToNode(e), this._addOrUpdateEdgeRendering(e), this._visibleGeometryChanged(e);\n    }\n\n    _slicePlaneEnabledChange(e) {\n      this._intersectionHandler && (this._intersectionHandler.slicePlane = e), l(this._labeler) && (this._labeler.slicePlaneEnabled = e), this._nodeId2Meta.forEach(t => {\n        h(t) || (this._collection.updateMaterial(t.objectHandle, t => {\n          t.commonMaterialParameters.slicePlaneEnabled = e;\n        }), this._updateEdgeRendering(t, !1));\n      });\n    }\n\n    _updatePBR() {\n      this._nodeId2Meta.forEach(e => {\n        h(e) || this._collection.updateMaterial(e.objectHandle, e => {\n          e.usePBR = this._usePBR();\n        });\n      }), this._hasLoadedPBRTextures = !0;\n    }\n\n    _usePBR() {\n      return !this._isIntegratedMesh && this.view.qualitySettings.physicallyBasedRenderingEnabled;\n    }\n\n    _updateEdgeRendering(e, t = !0) {\n      l(this._edgeView) && this._edgeView.hasObject(e.objectHandle) && this._addOrUpdateEdgeRendering(e, t);\n    }\n\n    _forAllNodes(e) {\n      this._nodeId2Meta.forEach(e);\n    }\n\n    _forAllFeatures(e, t, i = 0) {\n      a(this._nodeId2Meta, s => {\n        if (h(s)) return !1;\n\n        if (l(t)) {\n          switch (t(s)) {\n            case 0:\n              return !0;\n\n            case 2:\n              return !1;\n          }\n        }\n\n        let r = 1;\n\n        switch (i) {\n          case 1:\n            r = this._forAllFeaturesOfNode(s, e);\n            break;\n\n          case 0:\n            r = this._forVisibleFeaturesOfNode(s, e);\n            break;\n\n          case 2:\n            r = this._forAllFeaturesOfNodeInClippingArea(s, e);\n        }\n\n        return 0 === r;\n      });\n    }\n\n    _forAllFeaturesOfNode(e, t) {\n      let i = 1;\n      const s = e.featureIds;\n\n      for (let r = 0; r < s.length; r++) if (i = t(s[r], r, e), 0 === i) return i;\n\n      return i;\n    }\n\n    _forVisibleFeaturesOfNode(e, t) {\n      let i = 1;\n      const s = e.featureIds;\n      return this._collection.forEachVisibleComponent(e.objectHandle, r => (i = t(s[r], r, e), 1 === i)), i;\n    }\n\n    _forAllFeaturesOfNodeInClippingArea(e, t) {\n      if (null == this._clippingArea) return this._forAllFeaturesOfNode(e, t);\n\n      const i = this._boundingboxNodeTest(e, this._clippingArea);\n\n      if (0 === i) return 1;\n      if (3 === i) return this._forAllFeaturesOfNode(e, t);\n      const s = 1,\n            r = e.featureIds,\n            o = e.objectHandle,\n            a = Ee(this._clippingArea, this._collection.getObjectTransform(o));\n\n      for (let n = 0; n < r.length; n++) {\n        if (!this._boundingboxFeatureTest(e, n, a)) continue;\n        const i = t(r[n], n, e);\n        if (0 === i) return i;\n      }\n\n      return s;\n    }\n\n    _createAttributes(e, t) {\n      const i = {};\n      null != t.featureIds && (i[this._getObjectIdField()] = t.featureIds[e]);\n      const s = l(t.attributeInfo) && t.attributeInfo.attributeData;\n      if (l(s)) for (const r of Object.keys(s)) i[r] = xe(s[r], e);\n      return i;\n    }\n\n    _createGraphic(e, t) {\n      return this._createLayerGraphic(this._createAttributes(e, t));\n    }\n\n    highlight(e) {\n      const t = this._highlights;\n\n      if (\"number\" == typeof e || e instanceof i ? e = [e] : e instanceof s && (e = e.toArray()), Array.isArray(e) && e.length > 0) {\n        if (e[0] instanceof i) {\n          const i = e,\n                s = this.i3slayer.fieldsIndex,\n                r = this._getObjectIdField(),\n                o = i.map(e => De(s, e.attributes, r)),\n                {\n            set: a,\n            handle: n\n          } = t.acquireSet();\n\n          return t.setFeatureIds(a, o), n;\n        }\n\n        if (\"number\" == typeof e[0]) {\n          const i = e,\n                {\n            set: s,\n            handle: r\n          } = t.acquireSet();\n          return t.setFeatureIds(s, i), r;\n        }\n      }\n\n      return rt;\n    }\n\n    _visibleGeometryChanged(e) {\n      this._elevationProvider && (this._elevationProvider.objectChanged(e.node), null == this._visibleGeometryChangedSchedulerHandle && (this._visibleGeometryChangedSchedulerHandle = p(() => {\n        this.emit(\"visible-geometry-changed\"), this._visibleGeometryChangedSchedulerHandle = null;\n      })));\n    }\n\n    get performanceInfo() {\n      const e = {\n        displayedNumberOfFeatures: 0,\n        maximumNumberOfFeatures: 0,\n        totalNumberOfFeatures: 0,\n        core: null,\n        index: 0,\n        nodes: this._nodeId2Meta.size,\n        \"Total GPU Memory Estimate\": (this.gpuMemoryEstimate / 1048576).toFixed(1) + \"MB\",\n        \"Geometry Memory Estimate\": (this.geoMemoryEstimate / 1048576).toFixed(1) + \"MB\",\n        \"Texture Memory Estimate\": (this.texMemoryEstimate / 1048576).toFixed(1) + \"MB\",\n        \"Unloaded Memory Estimate\": (this.getUnloadedMemory() / 1048576).toFixed(1) + \"MB\",\n        ...(this._collection ? this._collection.performanceInfo : {\n          shown: 0,\n          hidden: 0\n        })\n      };\n      return l(this._memCache) && (e.MemCache = Math.round(100 * this._memCache.hitRate) + \"% hit\"), this._controller && (this._idbCacheEnabled && (e.IDBCache = Math.round(100 * this._idbCache.getHitRate()) + \"% hit\"), this._controller.updateStats(e)), e;\n    }\n\n    get test() {\n      const e = this;\n      return {\n        controller: this._controller,\n        labeler: this._labeler,\n\n        get visibleObjectIds() {\n          const t = [];\n          return e._forAllFeatures(e => (t.push(e), 1), null, 0), t.sort((e, t) => e - t), t;\n        },\n\n        get numNodes() {\n          return e._nodeId2Meta.size;\n        }\n\n      };\n    }\n\n    getNodeOpacityByIndex(e) {\n      const t = this._nodeId2Meta.get(e);\n\n      return this.getNodeOpacity(t);\n    }\n\n    getNodeOpacity(e) {\n      return l(e) ? this._collection.getMaterial(e.objectHandle).objectOpacity : 0;\n    }\n\n    isNodeFullyFadedIn(e) {\n      return this._crossfadeHelper.isNodeFullyFadedIn(e);\n    }\n\n    getNodeCrossfadeMetaData(e) {\n      return this._nodeId2Meta.get(e);\n    }\n\n    markNodeToRemove(e) {\n      this._controller && this._controller.markNodeToRemove(e);\n    }\n\n    removeMarkedNodes() {\n      this._controller && this._controller.removeMarkedNodes();\n    }\n\n    foreachCrossfadeNode(e) {\n      this._nodeId2Meta.forEach((t, i) => e(i, t));\n    }\n\n    fadeNode(e, t, i) {\n      if (!this.nodeCrossfadingEnabled) return;\n\n      const s = this._nodeId2Meta.get(e);\n\n      l(s) && this._crossfadeHelper.fadeNode(e, s, t, i);\n    }\n\n    setNodeOpacityByIndex(e, t) {\n      const i = this._nodeId2Meta.get(e);\n\n      l(i) && this._setNodeOpacity(i, t);\n    }\n\n    _setNodeOpacity(e, t) {\n      this._collection.updateMaterial(e.objectHandle, e => e.objectOpacity = t), this._setNodeEdgeOpacity(e, t);\n    }\n\n    _setNodeEdgeOpacity(e, t) {\n      if (!l(this._edgeView) || !e.cachedEdgeMaterials) return;\n      ot(e.cachedEdgeMaterials, t);\n      const i = e.objectHandle;\n      this._edgeView.hasObject(i) && this._edgeView.updateAllComponentOpacities(i, t);\n    }\n\n    get _hasModifications() {\n      return this._modifications && this._modifications.length > 0;\n    }\n\n    updateNodeModificationStatus(e) {\n      const t = e.length;\n      if (!this._hasModifications || t <= 0 || !0 !== this._i3sWasmLoaded) return;\n      const i = this.i3slayer.uid,\n            s = st(e);\n\n      if (l(s)) {\n        const t = {\n          context: i,\n          buffer: s.buffer\n        };\n        te(t);\n        const r = new Float64Array(s.buffer);\n        e.forAll((e, t) => {\n          const i = r[t],\n                s = ie(i);\n          e.imModificationImpact = s, 0 !== s && this._controller.invalidateGeometryVisibility(e.index);\n        });\n      }\n    }\n\n    notifyUpdate() {\n      this.notifyChange(\"updating\");\n    }\n\n    notifyLODUpdate() {\n      this._controller.notifyLODUpdate();\n    }\n\n    isUpdating() {\n      return !(!this._controller || !this._controller.updating) || !!this._visibleGeometryChangedSchedulerHandle || l(this._labeler) && this._labeler.updating || this._crossfadeHelper.updating || this._i3sWasmLoaded instanceof Promise || this._asyncModuleLoading > 0;\n    }\n\n  };\n  return f.lastIndex = 0, e([v()], f.prototype, \"_hasLoadedPBRTextures\", void 0), e([v()], f.prototype, \"_asyncModuleLoading\", void 0), e([v()], f.prototype, \"_visibleGeometryChangedSchedulerHandle\", void 0), e([v()], f.prototype, \"view\", void 0), e([v()], f.prototype, \"i3slayer\", void 0), e([v()], f.prototype, \"_controller\", void 0), e([v()], f.prototype, \"_labeler\", void 0), e([v()], f.prototype, \"updating\", void 0), e([v()], f.prototype, \"suspended\", void 0), e([v()], f.prototype, \"holeFilling\", void 0), e([v(Ae)], f.prototype, \"updatingProgress\", void 0), e([v({\n    readOnly: !0,\n    aliasOf: \"_controller.updatingProgress\"\n  })], f.prototype, \"updatingProgressValue\", void 0), e([v({\n    readOnly: !0\n  })], f.prototype, \"hasTexturesOrVertexColors\", null), e([v({\n    readOnly: !0\n  })], f.prototype, \"rendererTextureUsage\", null), e([v({\n    readOnly: !0\n  })], f.prototype, \"elevationOffset\", null), e([v({\n    type: Boolean\n  })], f.prototype, \"slicePlaneEnabled\", void 0), e([v()], f.prototype, \"supportedTextureEncodings\", null), e([v()], f.prototype, \"uncompressedTextureDownsamplingEnabled\", null), e([v({\n    type: [q]\n  })], f.prototype, \"_modifications\", void 0), f = o = e([I(\"esri.views.3d.layers.I3SMeshView3D\")], f), f;\n},\n      We = P(),\n      $e = P(),\n      Ke = Te(),\n      Je = [0, 0, 0, 0],\n      Qe = new t([0, 0, 0, 0]),\n      Xe = [0, 0, 0, 0];\n\nfunction Ye(e) {\n  const t = e.metallicRoughness;\n  return t && t.baseColorTextureId >= 0 || t && t.metallicRoughnessTextureId >= 0 || e.normalTextureId >= 0 || e.emissiveTextureId >= 0 || e.occlusionTextureId >= 0;\n}\n\nfunction Ze(e) {\n  return \"geometryData\" in e;\n}\n\nfunction et(e) {\n  return l(e) && f(e.data);\n}\n\nfunction tt(e, t) {\n  let i = 1024 + e.interleavedVertexData.byteLength + (e.indices ? e.indices.byteLength : 0) + e.positionData.data.byteLength + e.positionData.indices.byteLength;\n  if (l(t)) for (const s of t) l(s) && f(s.data) && (i += s.data.byteLength);\n  return i;\n}\n\nfunction it(e, t) {\n  return t.byteSize > qe ? (Ge.warn(`Node is too big to store in IndexedDB cache: ${e.id} (${t.byteSize} bytes)`), !1) : t.byteSize > 0;\n}\n\nfunction st(e) {\n  if (0 === e.length) return null;\n  const t = 10 * e.length,\n        i = new Float64Array(t);\n  return e.forAll((e, t) => {\n    let s = e.serviceObb;\n    h(s) && (s = Ke, E(s.center, e.mbs), s.halfSize[0] = s.halfSize[1] = s.halfSize[2] = e.mbs[3]);\n    const r = 10 * t;\n    i[r + 0] = s.center[0], i[r + 1] = s.center[1], i[r + 2] = s.center[2], i[r + 3] = s.halfSize[0], i[r + 4] = s.halfSize[1], i[r + 5] = s.halfSize[2], i[r + 6] = s.quaternion[0], i[r + 7] = s.quaternion[1], i[r + 8] = s.quaternion[2], i[r + 9] = s.quaternion[3];\n  }), i;\n}\n\nconst rt = {\n  remove() {},\n\n  pause() {},\n\n  resume() {}\n\n};\n\nfunction ot(e, t) {\n  e.forEach(e => e.opacity = t);\n}\n\nexport { ze as I3SMeshView3D };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/layers/I3SMeshView3D.js"],"names":["_","e","t","i","s","r","o","someMap","a","unwrapOr","n","isSome","l","destroyMaybe","d","isNone","h","applySome","c","unwrap","u","throwIfAborted","m","createResolver","g","schedule","p","isArrayBuffer","f","getMetersPerVerticalUnitForSR","b","init","y","property","v","subclass","I","M","C","x","O","j","w","S","E","F","D","projectBuffer","R","getProjectorName","N","localLinearScaleFactors","T","projectVectorToVector","V","projectBoundingSphere","A","create","P","empty","H","expandWithBuffer","U","intersects","G","L","fixFields","B","areLabelsVisible","k","q","getColor","z","getOpacity","W","loadArcade","$","K","getMetersPerUnit","J","Q","I3SMeshWorkerHandle","X","toWasmModification","Y","initialize","Z","setModificationsSync","ee","filterObbsForModificationsSync","te","interpretObbModificationResults","ie","overrideColor","se","re","I3SAttributeOverrides","oe","I3SCrossfadeHelper","ae","NodeCrossfadeMetaData","ne","le","boundingBoxCornerPoints","de","I3SIntersectionHandler","he","getSupportedEncodings","ce","selectEncoding","ue","createTexture","_e","configureMaterial","me","computeGlobalTransformation","ge","getLocalOrigin","pe","rendererNeedsTextures","fe","checkSceneLayerValid","be","checkSceneLayerCompatibleWithView","ye","getCacheKeySuffix","ve","whenGraphicAttributes","Ie","computeVisibilityObb","Me","filterInPlace","Ce","getCachedAttributeValue","xe","intersectBoundingBoxWithMbs","Oe","addWraparound","je","getSymbolInfo","we","transparentEdgeMaterial","Se","getClipAABB","Ee","IDBCache","Fe","attributeLookup","De","Re","projectToBoundingBox","Ne","Te","clone","Ve","updatingProgress","Ae","glLayout","Pe","createVertexBufferLayout","He","loadBasis","Ue","Ge","getLogger","Le","Be","constructor","node","featureIds","objectHandle","cachedRendererVersion","attributeInfo","material","textures","cachedEdgeMaterials","Array","cachedSymbology","ke","qe","ze","_elevationProvider","_intersectionHandler","_nodeId2Meta","Map","_nodeId2MetaReloading","_i3sWasmLoaded","_hasLoadedPBRTextures","_asyncModuleLoading","_addTasks","_rendererVersion","_colorVariable","_opacityVariable","_rendererFields","_symbologyFields","_symbologyOverride","_symbologyOverrideFields","_symbolInfos","_idbCache","holeFilling","_hasColors","_hasTextures","_hasData","slicePlaneEnabled","_modifications","_layerUrl","_cacheKeySuffix","_arcade","_tmpAttributeOnlyGraphic","_crossfadeHelper","index","lastIndex","lodCrossfadeoutDuration","lodCrossfadeinDuration","lodCrossfadeUncoveredDuration","layerUid","i3slayer","uid","sublayerUid","hasTexturesOrVertexColors","rendererTextureUsage","_currentRenderer","_usePBR","elevationOffset","elevationInfo","mode","spatialReference","unit","offset","supportedTextureEncodings","view","_stage","renderView","uncompressedTextureDownsamplingEnabled","qualitySettings","sceneService","preLoadBasis","addResolvingPromise","indexInfo","resourceController","attributeOverrides","memoryController","_worker","promise","setLegacySchema","store","defaultGeometrySchema","parsedUrl","path","_controller","layerView","gpuMemoryEstimate","texMemoryEstimate","geoMemoryEstimate","_collection","componentObjectCollection","_highlights","collection","forAllFeatures","_forAllFeatures","forAllFeaturesOfNode","_forAllFeaturesOfNode","_isIntegratedMesh","_hasSymbolColors","featureAttributes","faceRange","id","_hasVertexColors","vertexAttributes","color","cachedDrawingInfo","_edgeView","ensureEdgeView","_memCache","getMemCache","_deleteComponentObject","isGround","forEach","intersectionHandler","updatingHandles","add","_clippingAreaChanged","_opacityChange","_slicePlaneEnabledChange","_reloadAll","invalidateVisibilityObbs","_filterChange","_updatePBR","clearMemCache","_suspendedChange","_labelingChanged","_modificationsChanged","handles","_treeDebugger","crsIndex","then","I3STreeDebugger","I3S_TREE_SHOW_TILES","lv","nodeSR","_showModifications","renderSpatialReference","catch","warn","destroy","_clearAddTasks","layerChanged","elevationProvider","unregister","sceneIntersectionHelper","removeIntersectionHandler","destroyContext","_removeAllNodeDataFromStage","_labeler","clear","emit","_visibleGeometryChangedSchedulerHandle","remove","memEstimateTextureAdded","estimatedTexMemRequired","memEstimateTextureRemoved","memEstimateGeometryAdded","getObjectGPUMemoryUsage","memEstimateGeometryRemoved","isNodeLoaded","has","isNodeReloading","getUsedMemory","usedMemory","memory","getUnloadedMemory","unloadedMemoryEstimate","ignoresMemoryFactor","_supportsLabeling","layer","_addMetaToLabeler","_loadAsyncModule","_hasModifications","notifyUpdate","setModifications","context","modifications","isGeodetic","isGeographic","modificationsChanged","delete","hasModifications","set","push","length","updateNodeModificationStatus","forAll","imModificationImpact","get","invalidateGeometryVisibility","restartNodeLoading","_modificationGraphics","graphics","removeMany","I3S_SHOW_MODIFICATIONS","clip","mask","replace","type","outline","width","geometry","symbol","addMany","addNodeMeta","_createAttributes","register","_elevationContext","addIntersectionHandler","getLoadedAttributes","loadedAttributes","getAttributeData","attributeData","setAttributeData","_attributeValuesChanged","updateAttributes","apply","_getInvalidRendererVersion","filteredIds","setNodeMetaAttributes","_updateEngineObject","getVisibleNodes","getLoadedNodeIndices","textureSetDefinitions","some","formats","format","_getVertexBufferLayout","hasTexture","Ye","params","hasNormals","normal","hasRegions","uvRegion","_getGeometryParameters","_getObjectIdField","objectIdField","_findGraphicNodeAndIndex","fieldsIndex","attributes","indexOf","_getGraphicIndices","whenGraphicBounds","Promise","reject","Float64Array","resolve","boundingBox","screenSpaceObjects","values","filter","getGraphicFromIntersectorMetadata","nodeIndex","componentIndex","_createGraphic","_getCacheKey","_getMemCacheKey","_idbCacheEnabled","disableIDBCache","loadCachedGPUData","pop","deleteCachedGPUData","_cacheGPUData","indexDepth","level","put","loadMissingTextures","usage","encodings","data","encoding","loadCachedNodeData","nodeVersion","version","geometryObb","requiredTextures","textureData","initialized","byteSize","tt","transformedGeometry","every","et","it","addNode","Ze","_addData","attributeDataInfo","_transformNode","_safeReschedule","_addCachedNodeData","obb","componentOffsets","mbs","center","extents","orientation","geometryData","prototype","slice","call","globalTrafo","map","geometries","geometryDescriptor","crsVertex","geometryBuffer","layouts","localOrigin","serviceObb","needNormals","isMeshPyramid","normalReferenceFrame","indexToVertexProjector","vertexToRenderProjector","invoke","supportsNodeCrossFading","nodeCrossfadingEnabled","nodeFadeoutEnabled","_setNewNodeOpacity","fullOpacity","_setNodeOpacity","addCachedGPUData","getComponentObb","isGeometryVisible","_addNodeMeta","updateNodeState","setObjectVisibility","_updateMaterial","objectCreated","update","addCachedNodeData","suspended","_removeNodeStageData","layout","indices","interleavedVertexData","positionData","hasColors","_materialParameters","Uint32Array","byteLength","stride","vertices","count","layoutParameters","geometryParams","positions","transformation","basemapTerrain","createObject","toMapSpace","transform","position","rotationScale","visible","textureCoordinates","_initMaterialAndTextures","reduce","hasParametersFromSource","alphaMode","metallicRoughness","baseColorFactor","isOpaque","meta","resources","texture","notifyChange","_addOrUpdateEdgeRendering","updateObjectVisibility","_setObjectSymbolColors","_applyFiltersToNode","_visibleGeometryChanged","error","lodCrossfadeProgress","ot","reschedule","name","updateMaterial","textureRepository","usePBR","isIntegratedMesh","viewSpatialReference","_updateMaterialOverlay","colors","normals","clippingArea","_clippingArea","updateClippingArea","_geometryFilterChange","geometryFilterChanged","hasGeometryFilter","_applyFilters","_filters","getFilters","requestUpdate","_boundingboxFilter","addSqlFilter","fieldNames","_sqlFilter","_createLayerGraphic","testFeature","_boundingboxNodeTest","Xe","_boundingboxFeatureTest","getComponentAabb","We","getComponentCount","invisible","_transformAABB","$e","getObjectTransform","hasObject","hasEdges","perFeatureEdgeMaterials","_getFilteredEdgeMaterials","getNodeOpacity","updateAllComponentMaterials","addEdges","removeObject","_removeEdgeRendering","_applyFiltersToNodeComponents","applyFilterChange","setAllComponentVisibilities","_updateCachedFilteredIds","_computeFilteredComponentIndices","appliedFilters","_computeFilteredIds","removeNode","removeNodeMeta","objectDeleted","stopNodeFading","destroyObject","polygonOffsetEnabled","_invalidateAllSymbols","_rendererChange","getRequiredFields","_updateSymbologyFields","arcadeRequired","visualVariables","getSymbols","_getCachedEdgeMaterials","_updateCachedRendererData","_getSymbolColors","externalColor","externalColorMixMode","castShadows","pickable","_getSymbolInfo","getSymbol","arcade","_setSymbologyOverride","Uint8Array","Je","colorMixMode","edgeMaterial","Qe","alpha","opacity","objectTransparency","Math","round","setComponentData","setNeedsRender","stopAllNodeFading","objectOpacity","_updateEdgeRendering","commonMaterialParameters","slicePlane","physicallyBasedRenderingEnabled","_forAllNodes","_forVisibleFeaturesOfNode","_forAllFeaturesOfNodeInClippingArea","forEachVisibleComponent","Object","keys","highlight","toArray","isArray","handle","acquireSet","setFeatureIds","rt","objectChanged","performanceInfo","displayedNumberOfFeatures","maximumNumberOfFeatures","totalNumberOfFeatures","core","nodes","size","toFixed","shown","hidden","MemCache","hitRate","getHitRate","updateStats","test","controller","labeler","visibleObjectIds","sort","numNodes","getNodeOpacityByIndex","getMaterial","isNodeFullyFadedIn","getNodeCrossfadeMetaData","markNodeToRemove","removeMarkedNodes","foreachCrossfadeNode","fadeNode","setNodeOpacityByIndex","_setNodeEdgeOpacity","updateAllComponentOpacities","st","buffer","notifyLODUpdate","isUpdating","updating","readOnly","aliasOf","Boolean","Ke","baseColorTextureId","metallicRoughnessTextureId","normalTextureId","emissiveTextureId","occlusionTextureId","halfSize","quaternion","pause","resume","I3SMeshView3D"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../Color.js\";import i from\"../../../Graphic.js\";import s from\"../../../core/Collection.js\";import r from\"../../../core/has.js\";import o from\"../../../core/Logger.js\";import{someMap as a}from\"../../../core/MapUtils.js\";import{unwrapOr as n,isSome as l,destroyMaybe as d,isNone as h,applySome as c,unwrap as u}from\"../../../core/maybe.js\";import _ from\"../../../core/PooledArray.js\";import{throwIfAborted as m,createResolver as g}from\"../../../core/promiseUtils.js\";import{schedule as p}from\"../../../core/scheduling.js\";import{isArrayBuffer as f}from\"../../../core/typedArrayUtil.js\";import{getMetersPerVerticalUnitForSR as b}from\"../../../core/unitUtils.js\";import{init as y}from\"../../../core/watchUtils.js\";import{property as v}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as I}from\"../../../core/accessorSupport/decorators/subclass.js\";import{f as M}from\"../../../chunks/mat3.js\";import{c as C}from\"../../../chunks/mat3f32.js\";import{m as x,u as O}from\"../../../chunks/mat4.js\";import{b as j,c as w}from\"../../../chunks/mat4f64.js\";import{m as S,g as E}from\"../../../chunks/vec3.js\";import{c as F}from\"../../../chunks/vec3f64.js\";import{s as D}from\"../../../chunks/vec4.js\";import{projectBuffer as R,getProjectorName as N,localLinearScaleFactors as T,projectVectorToVector as V,projectBoundingSphere as A}from\"../../../geometry/projection.js\";import{create as P,empty as H,expandWithBuffer as U,intersects as G}from\"../../../geometry/support/aaBoundingBox.js\";import L from\"../../../layers/graphics/controllers/I3SOnDemandController.js\";import{fixFields as B}from\"../../../layers/support/fieldUtils.js\";import{areLabelsVisible as k}from\"../../../layers/support/layerUtils.js\";import q from\"../../../layers/support/SceneModification.js\";import{getColor as z,getOpacity as W}from\"../../../renderers/visualVariables/support/visualVariableUtils.js\";import{loadArcade as $}from\"../../../support/arcadeOnDemand.js\";import K from\"../../../symbols/Symbol3D.js\";import{getMetersPerUnit as J}from\"../../../symbols/support/unitConversionUtils.js\";import Q from\"./I3SMeshViewLabeler.js\";import{I3SMeshWorkerHandle as X,toWasmModification as Y}from\"./I3SMeshWorkerHandle.js\";import{initialize as Z,setModificationsSync as ee,filterObbsForModificationsSync as te,interpretObbModificationResults as ie}from\"./SceneLayerWorker.js\";import{overrideColor as se}from\"./graphics/graphicUtils.js\";import re from\"./i3s/Highlights.js\";import{I3SAttributeOverrides as oe}from\"./i3s/I3SAttributeOverrides.js\";import{I3SCrossfadeHelper as ae,NodeCrossfadeMetaData as ne}from\"./i3s/I3SCrossfadeHelper.js\";import le from\"./i3s/I3SElevationProvider.js\";import{boundingBoxCornerPoints as de}from\"./i3s/I3SGeometryUtil.js\";import{I3SIntersectionHandler as he}from\"./i3s/I3SIntersectionHandler.js\";import{getSupportedEncodings as ce,selectEncoding as ue,createTexture as _e,configureMaterial as me}from\"./i3s/I3SMaterialUtil.js\";import{computeGlobalTransformation as ge,getLocalOrigin as pe}from\"./i3s/I3SProjectionUtil.js\";import{rendererNeedsTextures as fe,checkSceneLayerValid as be,checkSceneLayerCompatibleWithView as ye,getCacheKeySuffix as ve,whenGraphicAttributes as Ie,computeVisibilityObb as Me,filterInPlace as Ce,getCachedAttributeValue as xe,intersectBoundingBoxWithMbs as Oe,addWraparound as je,getSymbolInfo as we,transparentEdgeMaterial as Se,getClipAABB as Ee}from\"./i3s/I3SUtil.js\";import{IDBCache as Fe}from\"./i3s/IDBCache.js\";import{attributeLookup as De}from\"./support/attributeUtils.js\";import Re from\"../support/debugFlags.js\";import{projectToBoundingBox as Ne}from\"../support/extentUtils.js\";import{create as Te,clone as Ve}from\"../support/orientedBoundingBox.js\";import{updatingProgress as Ae}from\"../support/updatingProperties.js\";import{glLayout as Pe}from\"../support/buffer/glUtil.js\";import{createVertexBufferLayout as He}from\"../webgl-engine/collections/Component/SourceGeometry.js\";import{loadBasis as Ue}from\"../webgl-engine/lib/BasisUtil.js\";const Ge=o.getLogger(\"esri.views.3d.layers.SceneLayerView3D\"),Le=[1,1,1,1];class Be extends ne{constructor(e,t,i,s,r,o,a){super(),this.node=e,this.featureIds=t,this.objectHandle=i,this.cachedRendererVersion=s,this.attributeInfo=r,this.material=o,this.textures=a,this.cachedEdgeMaterials=new Array,this.cachedSymbology=null}}const ke=18,qe=104857600,ze=t=>{var o;let f=o=class extends t{constructor(...e){super(e),this._elevationProvider=null,this._intersectionHandler=null,this._nodeId2Meta=new Map,this._nodeId2MetaReloading=new Map,this._i3sWasmLoaded=!1,this._hasLoadedPBRTextures=!1,this._asyncModuleLoading=0,this._addTasks=new Map,this._rendererVersion=0,this._colorVariable=null,this._opacityVariable=null,this._rendererFields=null,this._symbologyFields=null,this._symbologyOverride=null,this._symbologyOverrideFields=null,this._symbolInfos=new Map,this._idbCache=new Fe(\"esri-scenelayer-cache\",\"geometries\"),this.holeFilling=\"auto\",this._hasColors=!1,this._hasTextures=!1,this._hasData=!1,this.slicePlaneEnabled=!1,this._modifications=new Array,this._layerUrl=\"\",this._cacheKeySuffix=null,this._arcade=null,this._tmpAttributeOnlyGraphic=new i(null,null,{}),this._crossfadeHelper=new ae(this),this.index=o.lastIndex++}get lodCrossfadeoutDuration(){return 0}get lodCrossfadeinDuration(){return 0}get lodCrossfadeUncoveredDuration(){return 0}get layerUid(){return this.i3slayer&&this.i3slayer.uid}get sublayerUid(){return null}get hasTexturesOrVertexColors(){return this._hasData?this._hasTextures||this._hasColors?\"yes\":\"probably-not\":\"unknown\"}get rendererTextureUsage(){return fe(this._currentRenderer)?this._usePBR()||this._hasLoadedPBRTextures?63:37:this._usePBR()||this._hasLoadedPBRTextures?44:36}get elevationOffset(){const e=null!=this.i3slayer?this.i3slayer.elevationInfo:null;if(null!=e&&\"absolute-height\"===e.mode){const t=b(this.i3slayer.spatialReference),i=J(e.unit);return n(e.offset,0)*i/t}return 0}get supportedTextureEncodings(){return ce(this.view._stage.renderView)}get uncompressedTextureDownsamplingEnabled(){var e;const t=null==(e=this.view)?void 0:e.qualitySettings.sceneService.uncompressedTextureDownsamplingEnabled,i=0==(4&this.supportedTextureEncodings);return t&&i}initialize(){this.preLoadBasis(),this.addResolvingPromise(this.i3slayer.indexInfo);const e=this.view.resourceController;if(this.attributeOverrides=new oe(this.i3slayer,e.memoryController),this._worker=new X((t=>e.schedule(t))),this.addResolvingPromise(this._worker.promise),this._worker.setLegacySchema(this.layerUid,this.i3slayer.store.defaultGeometrySchema),be(this.i3slayer),ye(this.i3slayer,this.view),this._layerUrl=this.i3slayer.parsedUrl.path,this._controller=new L({layerView:this}),this.gpuMemoryEstimate=0,this.texMemoryEstimate=0,this.geoMemoryEstimate=0,this._stage=this.view._stage,this._collection=this._stage.renderView.componentObjectCollection,this._highlights=new re({collection:this._collection,forAllFeatures:e=>this._forAllFeatures(e,null,1),forAllFeaturesOfNode:(e,t)=>this._forAllFeaturesOfNode(e,t)}),this._isIntegratedMesh||!this.i3slayer.store.defaultGeometrySchema)this._hasSymbolColors=!1;else{const e=this.i3slayer.store.defaultGeometrySchema.featureAttributes;this._hasSymbolColors=!!(e&&e.faceRange&&e.id)}this._hasVertexColors=null!=this.i3slayer.store.defaultGeometrySchema.vertexAttributes.color&&(null==this.i3slayer.cachedDrawingInfo||!this.i3slayer.cachedDrawingInfo.color),this._isIntegratedMesh||(this._edgeView=this._stage.renderView.ensureEdgeView()),this._memCache=this.view.resourceController.memoryController.getMemCache(this.i3slayer.uid,(e=>this._deleteComponentObject(e))),this._intersectionHandler=new he({layerUid:this.layerUid,sublayerUid:this.sublayerUid,collection:this._collection,slicePlaneEnabled:this.slicePlaneEnabled,isGround:this._isIntegratedMesh,forEach:e=>{this._nodeId2Meta.forEach((t=>l(t)&&e(t.node,t.objectHandle))),this._nodeId2MetaReloading.forEach((t=>l(t)&&e(t.node,t.objectHandle)))}}),this._elevationProvider=new le({layerView:this,intersectionHandler:this._intersectionHandler}),this._hasLoadedPBRTextures=this._usePBR(),this.updatingHandles.add(this,\"view.clippingArea\",(()=>this._clippingAreaChanged()),2),this.updatingHandles.add(this,\"fullOpacity\",(e=>this._opacityChange(e))),this.updatingHandles.add(this,\"slicePlaneEnabled\",(e=>this._slicePlaneEnabledChange(e))),this.updatingHandles.add(this,\"elevationOffset\",((e,t)=>{this._reloadAll(t),this._controller.invalidateVisibilityObbs()})),this.updatingHandles.add(this,\"filter\",(()=>this._filterChange()),2),this.updatingHandles.add(this,\"view.qualitySettings.physicallyBasedRenderingEnabled\",(()=>this._updatePBR()));const t=()=>{this._reloadAll(),this.clearMemCache()};this.updatingHandles.add(this,\"rendererTextureUsage\",t),this.updatingHandles.add(this,\"uncompressedTextureDownsamplingEnabled\",t),this.updatingHandles.add(this,\"suspended\",(e=>this._suspendedChange(e)),2),this.updatingHandles.add(this.i3slayer,\"labelsVisible\",(()=>this._labelingChanged()),2),this.updatingHandles.add(this.i3slayer,\"labelingInfo\",(()=>this._labelingChanged()),2),this.updatingHandles.add(this,\"_modifications\",(()=>this._modificationsChanged()),2),this.handles.add([y(Re,\"I3S_TREE_SHOW_TILES\",(e=>{if(e&&!this._treeDebugger){const e=this._controller.crsIndex;import(\"./support/I3STreeDebugger.js\").then((({I3STreeDebugger:t})=>{!this._treeDebugger&&Re.I3S_TREE_SHOW_TILES&&(this._treeDebugger=new t({lv:this,view:this.view,nodeSR:e}))}))}else e||Re.I3S_TREE_SHOW_TILES||(this._treeDebugger=d(this._treeDebugger))})),y(Re,\"I3S_SHOW_MODIFICATIONS\",(()=>this._showModifications()))]),this._cacheKeySuffix=ve(this.i3slayer.spatialReference,this.view.renderSpatialReference),this._idbCache.init().catch((e=>Ge.warn(`Failed to initialize IndexedDB cache: ${e}`)))}destroy(){this._clearAddTasks(),this.attributeOverrides=d(this.attributeOverrides),this._elevationProvider&&(this._elevationProvider.layerChanged(),this.view.elevationProvider.unregister(this._elevationProvider),this._elevationProvider=null),this._intersectionHandler&&(this._stage.sceneIntersectionHelper.removeIntersectionHandler(this._intersectionHandler),this._intersectionHandler=null);const e=this._worker;e&&(e.destroyContext(this.i3slayer.uid).then((()=>e.destroy())),this._worker=null),this._removeAllNodeDataFromStage(),this._memCache=d(this._memCache),this._collection=null,this._stage=null,this._edgeView=null,this._labeler=d(this._labeler),this._treeDebugger=d(this._treeDebugger),this._controller=d(this._controller),this._highlights.destroy(),this._nodeId2Meta.clear(),this._nodeId2MetaReloading.clear(),this.emit(\"visible-geometry-changed\"),this._visibleGeometryChangedSchedulerHandle&&(this._visibleGeometryChangedSchedulerHandle.remove(),this._visibleGeometryChangedSchedulerHandle=null)}memEstimateTextureAdded(e){const t=e.estimatedTexMemRequired;return this.gpuMemoryEstimate+=t,this.texMemoryEstimate+=t,t}memEstimateTextureRemoved(e){const t=e.estimatedTexMemRequired;this.gpuMemoryEstimate-=t,this.texMemoryEstimate-=t}memEstimateGeometryAdded(e){const t=this._collection.getObjectGPUMemoryUsage(e);return this.gpuMemoryEstimate+=t,this.geoMemoryEstimate+=t,t}memEstimateGeometryRemoved(e){const t=this._collection.getObjectGPUMemoryUsage(e);this.gpuMemoryEstimate-=t,this.geoMemoryEstimate-=t}isNodeLoaded(e){return this._nodeId2Meta.has(e)}isNodeReloading(e){return this._nodeId2MetaReloading.has(e)}getUsedMemory(){let e=l(this._labeler)?this._labeler.usedMemory:0;return this._nodeId2Meta.forEach((t=>e+=l(t)?t.node.memory:0)),this._nodeId2MetaReloading.forEach((t=>e+=l(t)?t.node.memory:0)),e}getUnloadedMemory(){return(l(this._controller)?this._controller.unloadedMemoryEstimate:0)+(l(this._labeler)?this._labeler.unloadedMemoryEstimate:0)}ignoresMemoryFactor(){return!1}_labelingChanged(){if(!(k(this.i3slayer)&&this._supportsLabeling))return void(l(this._labeler)&&(this._labeler.destroy(),this._labeler=null));if(l(this._labeler))return;const e=new Q({view:this.view,layer:this.i3slayer,collection:this._collection});this._nodeId2Meta.forEach((t=>l(t)&&this._addMetaToLabeler(e,t))),this._labeler=e}_loadAsyncModule(e){return++this._asyncModuleLoading,e.then((e=>(--this._asyncModuleLoading,e)),(e=>{throw--this._asyncModuleLoading,e}))}_modificationsChanged(){if(!this._i3sWasmLoaded&&this._hasModifications)return this._i3sWasmLoaded=Z().then((()=>{this._i3sWasmLoaded=!0,this._modificationsChanged(),this.notifyUpdate()})),void this.notifyUpdate();if(!0!==this._i3sWasmLoaded)return;const e=this.i3slayer.uid,t=this.i3slayer.spatialReference;this._worker.setModifications(e,this._modifications,t);const i=Y(this._modifications,t);ee({context:e,modifications:i,isGeodetic:t.isGeographic}),this._controller.modificationsChanged();const s=this._hasModifications?new _:null;this._nodeId2Meta.forEach(((e,t)=>{h(e)?this._nodeId2Meta.delete(t):e.node.hasModifications?(this._nodeId2Meta.delete(t),this._nodeId2MetaReloading.set(t,e)):l(s)&&s.push(e.node)})),l(s)&&this._nodeId2MetaReloading.forEach((e=>s.push(e.node))),l(s)&&s.length>0&&(this.updateNodeModificationStatus(s),s.forAll((e=>{if(2!==e.imModificationImpact){const t=this._nodeId2Meta.get(e.index);this._controller.invalidateGeometryVisibility(e.index),this._nodeId2Meta.delete(e.index),l(t)&&this._nodeId2MetaReloading.set(e.index,t)}}))),this.clearMemCache(),this._controller.restartNodeLoading(),this._showModifications()}_showModifications(){if(l(this._modificationGraphics)&&(this.view.graphics.removeMany(this._modificationGraphics),this._modificationGraphics=null),!Re.I3S_SHOW_MODIFICATIONS||0===this._modifications.length)return;const e={clip:[227,227,79,.8],mask:[227,139,79,.8],replace:[139,227,79,.8]},t={type:\"simple-fill\",outline:{color:[255,255,255],width:1}};this._modificationGraphics=new Array;for(const s of this._modifications){s.geometry.spatialReference=this.i3slayer.spatialReference;const r={...t,color:e[s.type]};this._modificationGraphics.push(new i({geometry:s.geometry,symbol:r}))}this.view.graphics.addMany(this._modificationGraphics)}_addMetaToLabeler(e,t){e.addNodeMeta(t,((e,t)=>this._createAttributes(e,t)))}_suspendedChange(e){e?(this._removeAllNodeDataFromStage(),this.view.elevationProvider&&this.view.elevationProvider.unregister(this._elevationProvider),this._stage.sceneIntersectionHelper.removeIntersectionHandler(this._intersectionHandler)):(this.view.elevationProvider.register(this._elevationContext,this._elevationProvider),this._stage.sceneIntersectionHelper.addIntersectionHandler(this._intersectionHandler))}getLoadedAttributes(e){const t=this._nodeId2Meta.get(e);if(l(t)&&l(t.attributeInfo))return t.attributeInfo.loadedAttributes}getAttributeData(e){const t=this._nodeId2Meta.get(e);if(l(t)&&l(t.attributeInfo))return t.attributeInfo.attributeData}setAttributeData(e,t){const i=this._nodeId2Meta.get(e);l(i)&&l(i.attributeInfo)&&(i.attributeInfo.attributeData=t,this._attributeValuesChanged(i))}async updateAttributes(e,t,i){const s=this._nodeId2Meta.get(e);l(s)&&(await this.attributeOverrides.apply(s.featureIds,t,i),s.attributeInfo=t,this._attributeValuesChanged(s))}_attributeValuesChanged(e){e.cachedRendererVersion=this._getInvalidRendererVersion(),e.filteredIds=null,l(this._labeler)&&this._labeler.setNodeMetaAttributes(e,((e,t)=>this._createAttributes(e,t))),this._updateEngineObject(e)}clearMemCache(){l(this._memCache)&&this._memCache.clear()}getVisibleNodes(){const e=new Array;return this._nodeId2Meta.forEach((t=>l(t)&&e.push(t.node))),e}getLoadedNodeIndices(e){this._nodeId2Meta.forEach(((t,i)=>e.push(i))),this._nodeId2MetaReloading.forEach(((t,i)=>e.push(i)))}preLoadBasis(){!r(\"disable-feature:i3s-basis\")&&0!=(2&this.supportedTextureEncodings)&&c(this.i3slayer.textureSetDefinitions,(e=>e.some((e=>e.formats.some((e=>\"basis\"===e.format||\"ktx2\"===e.format))))))&&Ue()}_getVertexBufferLayout(e,t){const i={hasTexture:Ye(e.params.material),hasNormals:t.normal,hasRegions:t.uvRegion};return Pe(He(this._getGeometryParameters(i)))}_getObjectIdField(){return this.i3slayer.objectIdField||\"OBJECTID\"}_findGraphicNodeAndIndex(e){const t=De(this.i3slayer.fieldsIndex,e.attributes,this._getObjectIdField());let i=null;return a(this._nodeId2Meta,(e=>{if(h(e))return!1;const s=e.featureIds.indexOf(t);return-1!==s&&(i={node:e.node,index:s},!0)})),i}_getGraphicIndices(e,t){const i=this._nodeId2Meta.get(e.index);if(h(i))return[];const s=[],r=this._getObjectIdField(),o=this.i3slayer.fieldsIndex;for(const a of t){const e=De(o,a.attributes,r),t=i.featureIds.indexOf(e);-1!==t&&s.push(t)}return s}whenGraphicBounds(e){const t=this._findGraphicNodeAndIndex(e);if(!t)return Promise.reject();const i=this._nodeId2Meta.get(t.node.index);if(h(i))return Promise.reject();const s=i.objectHandle,r=de(t.index,this._collection,s,new Float64Array(24)),o=this.view.renderSpatialReference,a=this.view.spatialReference;if(R(r,o,0,r,a,0,8)){const e=H();return U(e,r,0,8),Promise.resolve({boundingBox:e,screenSpaceObjects:[]})}}whenGraphicAttributes(e,t){return Ie(this.i3slayer,e,this._getObjectIdField(),t,(()=>[...this._nodeId2Meta.values()].filter(l)))}getGraphicFromIntersectorMetadata(e){if(null==e.nodeIndex||null==e.componentIndex)return null;const t=this._nodeId2Meta.get(e.nodeIndex);return h(t)||null==t.featureIds||e.componentIndex>=t.featureIds.length?null:this._createGraphic(e.componentIndex,t)}_getCacheKey(e){return`${this._layerUrl}/v${ke}/${e.id}${this._cacheKeySuffix}`}_getMemCacheKey(e,t=this.elevationOffset){return e+\"#\"+t}get _idbCacheEnabled(){return!this._controller.disableIDBCache&&0===this._modifications.length&&0===this.elevationOffset&&null!=this._cacheKeySuffix}loadCachedGPUData(e){return l(this._memCache)?this._memCache.pop(this._getMemCacheKey(e.index)):null}deleteCachedGPUData(e){l(e)&&this._deleteComponentObject(e)}_cacheGPUData(e,t=this.elevationOffset){if(h(this._memCache))return void this._deleteComponentObject(e);const i=this._controller.indexDepth-e.node.level;this._memCache.put(this._getMemCacheKey(e.node.index,t),e,e.node.memory,i)}loadMissingTextures(e,t,i,s){const r=e.filter(((e,i)=>{if(0==(e.usage&this.rendererTextureUsage))return!1;if(h(t))return!0;const s=ue(e.encodings,this.supportedTextureEncodings),r=t[i];return!!(h(r)||null==r.data||s&&r.encoding!==s.encoding)}));return 0===r.length?Promise.resolve(!1):i(r,s).then((i=>{let s=0;for(let r=0;r<e.length;r++)s<i.length&&i[s].id===e[r].id&&(t[r]=i[s],s++);return!0}))}loadCachedNodeData(e,t,i){return this._idbCacheEnabled?this._idbCache.get(this._getCacheKey(e),t).then((s=>null==s?null:s.nodeVersion!==e.version?(this._idbCache.remove(this._getCacheKey(e)),null):(e.geometryObb=s.geometryObb,this.loadMissingTextures(s.requiredTextures,s.textureData,i,t).then((i=>(i&&this._idbCache.initialized&&l(s.textureData)&&(s.byteSize=tt(s.transformedGeometry,s.textureData),s.textureData.every(et)&&it(e,s)&&this._idbCache.put(this._getCacheKey(e),s).catch((t=>Ge.warn(`Failed to update node with textures in IndexedDB cache: ${e.id}: ${t}`)))),m(t),s)))))):Promise.resolve(null)}addNode(e,t,i){return Ze(t)?this._addData(e,t.attributeDataInfo,(()=>this._transformNode(e,t,i).then((s=>this._safeReschedule((()=>{if(h(s))return e.hasModifications=!1,this._addCachedNodeData(e,null,i);e.hasModifications=s.transformedGeometry.hasModifications;const{obb:r,componentOffsets:o,featureIds:a,transformedGeometry:n}=s,d=this._controller.crsIndex,c=this.view.renderSpatialReference,u=ge(e.mbs,this.elevationOffset,d,c);e.geometryObb=Te([r.center.x,r.center.y,r.center.z],[r.extents.x,r.extents.y,r.extents.z],[r.orientation.x,r.orientation.y,r.orientation.z,r.orientation.w]),S(e.geometryObb.center,e.geometryObb.center,u),t.geometryData.componentOffsets=o,a&&(t.geometryData.featureIds=Array.prototype.slice.call(a));const _={nodeVersion:e.version,geometryData:t.geometryData,requiredTextures:t.requiredTextures,textureData:t.textureData,transformedGeometry:n,globalTrafo:u,geometryObb:e.geometryObb,byteSize:tt(n,t.textureData)};if(this._idbCacheEnabled&&this._idbCache.initialized&&it(e,_)){const t=l(_.textureData)?_.textureData.map((e=>et(e)?e:null)):null;this._idbCache.put(this._getCacheKey(e),{..._,textureData:t}).catch((t=>Ge.warn(`Failed to store node in IndexedDB cache: ${e.id}: ${t}`)))}return this._addCachedNodeData(e,_,i)}),i))))):Promise.reject()}computeVisibilityObb(e){return Me(e,this.view.renderSpatialReference,this._controller.crsIndex,this.i3slayer.spatialReference,this.elevationOffset,this._modifications)}_transformNode(e,t,i){const s=t.geometryData.geometries,r=new Array(s.length);for(let h=0;h<s.length;++h)r[h]=this._getVertexBufferLayout(s[h],t.geometryDescriptor);const o=e.mbs,a=this.elevationOffset,n=this._controller.crsIndex,l=this._controller.crsVertex,d=this.view.renderSpatialReference,c=pe(o,a,n),u=ge(o,a,n,d),_=N(n,l),m=N(l,d);if(h(_)||h(m))return Promise.resolve(null);const g={context:this.i3slayer.uid,geometryBuffer:t.geometryBuffer,geometryData:t.geometryData,geometryDescriptor:t.geometryDescriptor,layouts:r,localOrigin:c,globalTrafo:u,mbs:o,obb:e.serviceObb,elevationOffset:a,needNormals:!this._isIntegratedMesh&&this._controller.isMeshPyramid,normalReferenceFrame:this.i3slayer.normalReferenceFrame||\"none\",indexToVertexProjector:_,vertexToRenderProjector:m};return this._worker.invoke(g,i)}get supportsNodeCrossFading(){var e,t;return!(null!=(e=this.view)&&null!=(t=e._stage)&&t.renderView.has(3))}get nodeCrossfadingEnabled(){return this.supportsNodeCrossFading&&(this.lodCrossfadeinDuration>0||this.lodCrossfadeoutDuration>0||this.lodCrossfadeUncoveredDuration>0)}get nodeFadeoutEnabled(){return this.supportsNodeCrossFading&&this.lodCrossfadeoutDuration>0}_setNewNodeOpacity(e){const t=this.nodeCrossfadingEnabled?0:this.fullOpacity;this._setNodeOpacity(e,t)}addCachedGPUData(e,t,i){if(e.geometryObb=Ve(this._collection.getComponentObb(t.objectHandle)),!this._controller.isGeometryVisible(e))return void this._cacheGPUData(t);l(this._labeler)&&this._addMetaToLabeler(this._labeler,t);const s=e.index;this._addNodeMeta(s,t),this.updateNodeState(s,i),this._collection.setObjectVisibility(t.objectHandle,!0),this._updateMaterial(t),this._setNewNodeOpacity(t),this._updateEngineObject(t),this._highlights.objectCreated(t),l(this._treeDebugger)&&this._treeDebugger.update()}addCachedNodeData(e,t,i,s){return this._addData(e,i,(()=>this._addCachedNodeData(e,t,s)))}async _addCachedNodeData(e,t,i){if(this.suspended||!this._controller.isGeometryVisible(e))return void this._removeNodeStageData(e.index,this.elevationOffset,this._nodeId2MetaReloading);if(h(t))return void this._addNodeMeta(e.index,null);const s=this._addTasks.get(e.index),{geometryData:o,transformedGeometry:a,globalTrafo:n}=t;await this.attributeOverrides.apply(o.featureIds,s.attributeInfo,i);const d=l(t.textureData)?t.textureData.filter((e=>l(e)&&0!=(e.usage&this.rendererTextureUsage))):[];!r(\"disable-feature:i3s-basis\")&&d.some((e=>l(e)&&(2===e.encoding||1===e.encoding)))&&await Ue(),e.memory=0;const{componentOffsets:c,geometries:_,featureIds:m}=o,g=this._collection,p=_[0],{layout:f,indices:b,interleavedVertexData:y,positionData:v,hasColors:I}=a,S=this._materialParameters(p,f),E=c||new Uint32Array([0,b?b.length:y.byteLength/f[0].stride]),D={vertices:{data:y,count:y.byteLength/f[0].stride,layoutParameters:S.geometryParams},positionData:{positions:v.data,indices:v.indices},indices:b,componentOffsets:E},R=p.transformation?j(p.transformation):w();x(R,n,R);const N=O(F(),R),A=M(C(),R),P=this.view.renderSpatialReference,H=this.view.basemapTerrain.spatialReference,U=F(),G=[1,1,1];T(N,P,G,H),V(N,P,U,H);const L=g.createObject({toMapSpace:[U[0],U[1],G[0],G[1]],geometry:D,obb:u(e.geometryObb),transform:{position:N,rotationScale:A},visible:!1}),B=2===S.geometryParams.textureCoordinates,k=this._initMaterialAndTextures(L,S.material,d,B);e.memory+=this.memEstimateGeometryAdded(L),e.memory+=k.reduce(((e,t)=>e+(l(t)?this.memEstimateTextureAdded(t):0)),0);const q=!!S.material.hasParametersFromSource,z=\"blend\"!==S.material.alphaMode&&S.material.metallicRoughness.baseColorFactor[3]>=1,W=new Be(e,m,L,this._getInvalidRendererVersion(),s.attributeInfo,{hasParametersFromSource:q,isOpaque:z},k);s.meta=W,!this._hasTextures&&t.requiredTextures.some((({usage:e})=>0!=(19&e)))&&(this._hasTextures=!0),this._hasData=!0,this._hasColors=this._hasColors||I,this._hasTextures=this._hasTextures||!!e.resources.texture,this.notifyChange(\"hasTexturesOrVertexColors\");const $=this.slicePlaneEnabled;return this._addOrUpdateEdgeRendering(W).then((t=>(l(t)&&t.updateObjectVisibility(W.objectHandle,!1),this._safeReschedule((()=>{const i=this._addTasks.get(e.index);if(!i)return;if(l(this._labeler)&&this._addMetaToLabeler(this._labeler,W),this._addNodeMeta(e.index,W),i.meta=null,this.suspended)return void this._removeNodeStageData(e.index,this.elevationOffset);g.setObjectVisibility(L,!0),l(t)&&t.updateObjectVisibility(W.objectHandle,!0),W.attributeInfo=i.attributeInfo;const s=W.cachedRendererVersion!==this._rendererVersion,r=$!==this.slicePlaneEnabled;this._setObjectSymbolColors(W);const o=this._applyFiltersToNode(W);(s||l(t)&&(r||o))&&this._addOrUpdateEdgeRendering(W),this._visibleGeometryChanged(W),this._highlights.objectCreated(W),this._updateMaterial(W),this._setNewNodeOpacity(W),l(this._treeDebugger)&&this._treeDebugger.update()}),i)))).catch((e=>{throw l(s.meta)&&(this._deleteComponentObject(s.meta),s.meta=null),e}))}_addNodeMeta(e,t){if(this._removeNodeStageData(e,this.elevationOffset,this._nodeId2MetaReloading),this._nodeId2Meta.has(e)){Ge.error(\"Removing duplicated node\");const t=this._nodeId2Meta.get(e);l(t)&&this._deleteComponentObject(t)}l(t)&&(t.lodCrossfadeProgress=null,this.nodeCrossfadingEnabled&&ot(t.cachedEdgeMaterials,0)),this._nodeId2Meta.set(e,t)}_safeReschedule(e,t){return m(t),this._controller.reschedule(e,t)}_materialParameters(e,t){const i=e.params.material,s=t.some((e=>\"uvRegion\"===e.name)),r=t.some((e=>\"normalCompressed\"===e.name)),o=Ye(i);return{geometryParams:this._getGeometryParameters({hasTexture:o,hasNormals:r,hasRegions:s}),material:i}}_initMaterialAndTextures(e,t,i,s){const r=this._stage.renderView,o=i.map((e=>_e(e,t,s,r)));for(const a of o)l(a)&&this._stage.add(a);return this._collection.updateMaterial(e,(e=>{me(e,t,o,i,this.view._stage.renderView.textureRepository,{rendererTextureUsage:this.rendererTextureUsage,usePBR:this._usePBR(),isIntegratedMesh:this._isIntegratedMesh,slicePlaneEnabled:this.slicePlaneEnabled,viewSpatialReference:this.view.spatialReference}),this._updateMaterialOverlay(e)})),o}_getGeometryParameters(e){return{textureCoordinates:e.hasTexture?e.hasRegions?2:1:0,colors:this._hasVertexColors,normals:e.hasNormals&&!this._isIntegratedMesh}}_addData(e,t,i){let s=this._addTasks.get(e.index);return s?s.attributeInfo=t:(s={...g(),attributeInfo:t,meta:null},this._addTasks.set(e.index,s),i().then(s.resolve,s.reject).then((()=>this._addTasks.delete(e.index))).catch((t=>{throw this._addTasks.delete(e.index),t}))),s.promise}_clearAddTasks(){this._addTasks.forEach((e=>{l(e.meta)&&(this._deleteComponentObject(e.meta),e.meta=null)})),this._addTasks.clear()}_clippingAreaChanged(){const e=P();Ne(this.view.clippingArea,e,this.view.renderSpatialReference)?this._clippingArea=e:this._clippingArea=null,this._filterChange(),this._controller&&this._controller.updateClippingArea(this.view.clippingArea)}_geometryFilterChange(){this._controller.geometryFilterChanged(this.hasGeometryFilter)}get hasGeometryFilter(){return!1}_filterChange(){this._applyFilters(!1)}_applyFilters(e){this._filters=this.getFilters(),e?this._controller&&this._controller.requestUpdate():this._nodeId2Meta.forEach((e=>{l(e)&&this._applyFiltersToNode(e)&&(this._addOrUpdateEdgeRendering(e),this._visibleGeometryChanged(e))}))}getFilters(){const e=[];return this._clippingArea&&e.push(((e,t)=>this._boundingboxFilter(e,t,this._clippingArea))),e}addSqlFilter(e,t,i){if(l(t)){const s=t.fieldNames;e.push(((e,r)=>this._sqlFilter(e,r,t,s,i)))}}_sqlFilter(e,t,i,s,r){const o={},a=this._createLayerGraphic(o),n=this.i3slayer.objectIdField,d=t.featureIds,h=l(t.attributeInfo)&&t.attributeInfo.attributeData;s.every((e=>null!=h[e]||e===n))&&Ce(e,d,(e=>{o[n]=d[e];for(const i of s)i!==n&&(o[i]=xe(h[i],e));try{return i.testFeature(a)}catch(t){return r(t),!1}}))}_boundingboxNodeTest(e,t){return A(e.node.mbs,this._controller.crsIndex,Xe,this.view.renderSpatialReference),Oe(t,Xe)}_boundingboxFeatureTest(e,t,i){return G(i,this._collection.getComponentAabb(e.objectHandle,t,We))}_boundingboxFilter(e,t,i){const s=this._collection,r=this._boundingboxNodeTest(t,i);if(3===r)return;if(0===r)return void(e.length=0);const o=s.getComponentCount(t.objectHandle);if(o.invisible+o.visible!==t.featureIds.length)return;const a=this._transformAABB($e,i,t.objectHandle);Ce(e,t.featureIds,(e=>this._boundingboxFeatureTest(t,e,a)))}_transformAABB(e,t,i){const s=this._collection.getObjectTransform(i),r=s.position,o=s.rotationScale;return e[0]=(t[0]-r[0])/o[0],e[1]=(t[1]-r[1])/o[4],e[2]=(t[2]-r[2])/o[8],e[3]=(t[3]-r[0])/o[0],e[4]=(t[4]-r[1])/o[4],e[5]=(t[5]-r[2])/o[8],e}_addOrUpdateEdgeRendering(e,t=!0){if(h(this._edgeView))return Promise.resolve(null);const i=e.objectHandle,s=this._edgeView.hasObject(i),{hasEdges:r,perFeatureEdgeMaterials:o}=this._getFilteredEdgeMaterials(e),a={slicePlaneEnabled:this.slicePlaneEnabled};if(r){if(s){if(this.nodeCrossfadingEnabled){ot(o,this.getNodeOpacity(e))}return this._edgeView.updateAllComponentMaterials(i,o,a,t),this._edgeView.updateObjectVisibility(i,!0),Promise.resolve(this._edgeView)}return this._collection.addEdges(i,this._edgeView,o,a).then((()=>this._edgeView))}return s&&this._edgeView.removeObject(i),Promise.resolve(null)}_removeEdgeRendering(e){l(this._edgeView)&&this._edgeView.hasObject(e.objectHandle)&&this._edgeView.removeObject(e.objectHandle)}_applyFiltersToNode(e){return!!this._applyFiltersToNodeComponents(e)&&(l(this._labeler)&&this._labeler.applyFilterChange(e),!0)}_applyFiltersToNodeComponents(e){const t=this._collection,i=0===t.getComponentCount(e.objectHandle).invisible;if(t.setAllComponentVisibilities(e.objectHandle,\"all\"),0===this._filters.length)return e.filteredIds=null,!i;if(this._updateCachedFilteredIds(e),e.filteredIds===e.featureIds)return!i;const s=this._computeFilteredComponentIndices(e);return t.setAllComponentVisibilities(e.objectHandle,s),!0}_updateCachedFilteredIds(e){null!=e.filteredIds&&e.appliedFilters===this._filters||(e.filteredIds=this._computeFilteredIds(e),e.appliedFilters=this._filters)}_computeFilteredIds(e){const t=e.featureIds.slice();for(const i of this._filters)if(i(t,e),0===t.length)break;return t.length===e.featureIds.length?e.featureIds:t}_computeFilteredComponentIndices(e){const t=new Array;return e.featureIds.forEach(((i,s)=>{e.filteredIds[t.length]===i&&t.push(s)})),t}_removeAllNodeDataFromStage(e=this.elevationOffset){this._nodeId2Meta.forEach(((t,i)=>this._removeNodeStageData(i,e))),this._nodeId2MetaReloading.forEach(((t,i)=>this._removeNodeStageData(i,e,this._nodeId2MetaReloading)))}removeNode(e){const t=this.elevationOffset;this._removeNodeStageData(e,t),this._removeNodeStageData(e,t,this._nodeId2MetaReloading)}_removeNodeStageData(e,t,i=this._nodeId2Meta){const s=i.get(e);h(s)?i.delete(e):(this._collection.setObjectVisibility(s.objectHandle,!1),this._visibleGeometryChanged(s),this._removeEdgeRendering(s),l(this._labeler)&&this._labeler.removeNodeMeta(s),i.delete(e),this._highlights.objectDeleted(s),i===this._nodeId2Meta?(this._cacheGPUData(s,t),this.nodeCrossfadingEnabled&&this._crossfadeHelper.stopNodeFading(s)):this._deleteComponentObject(s),l(this._treeDebugger)&&this._treeDebugger.update())}_deleteComponentObject(e){if(l(this._edgeView)&&this._edgeView.removeObject(e.objectHandle),this.memEstimateGeometryRemoved(e.objectHandle),this._collection.destroyObject(e.objectHandle),e.textures)for(const t of e.textures)this.memEstimateTextureRemoved(t),this._stage.remove(t)}updateNodeState(e,t){const i=this._nodeId2Meta.get(e);l(i)&&this._collection.updateMaterial(i.objectHandle,(e=>e.polygonOffsetEnabled=0===t))}_invalidateAllSymbols(){this._rendererVersion=je(this._rendererVersion,1),this._controller&&this._controller.requestUpdate()}_getInvalidRendererVersion(){return je(this._rendererVersion,-1)}async _rendererChange(e){if(this._currentRenderer=e,this.notifyChange(\"rendererTextureUsage\"),this._rendererVersion=je(this._rendererVersion,1),this._rendererFields=null,this._colorVariable=null,this._opacityVariable=null,this._invalidateAllSymbols(),e&&(this._rendererFields=await e.getRequiredFields(this.i3slayer.fieldsIndex)),this._updateSymbologyFields(),!this._arcade&&e&&\"arcadeRequired\"in e&&e.arcadeRequired&&(this._arcade=await $()),e&&\"visualVariables\"in e&&e.visualVariables)for(const t of e.visualVariables)\"color\"===t.type?this._colorVariable=t:\"opacity\"===t.type?this._opacityVariable=t:Ge.warn(`Unsupported visual variable type for 3D Object Scene Services: ${t.type}`);if(e)for(const t of e.getSymbols())\"mesh-3d\"!==t.type&&Ge.error(`Symbols of type '${t.type}' are not supported for 3D Object Scene Services.`);this._controller&&this._controller.requestUpdate()}_getCachedEdgeMaterials(e){return this._hasSymbolColors&&e.cachedRendererVersion!==this._rendererVersion&&this._updateCachedRendererData(e),e.cachedEdgeMaterials}_getSymbolColors(e){this._hasSymbolColors&&e.cachedRendererVersion!==this._rendererVersion&&this._updateCachedRendererData(e);const t=e.cachedSymbology;return(e,i)=>{const s=5*e;D(i.externalColor,t[s+0]/255,t[s+1]/255,t[s+2]/255,t[s+3]/255),i.externalColorMixMode=15&t[s+4],i.castShadows=0!=(16&t[s+4]),i.pickable=0!=(32&t[s+4])}}_getSymbolInfo(e,t){const i=e&&e.getSymbol(t,{arcade:this._arcade});if(!(i instanceof K))return null;const s=i.id;if(this._symbolInfos.has(s))return this._symbolInfos.get(s);const r=we(i);return this._symbolInfos.set(s,r),r}_setSymbologyOverride(e,t){this._symbologyOverride!==e&&(this._symbologyOverride=e,this._symbologyOverrideFields=t,this._invalidateAllSymbols(),this._updateSymbologyFields())}_updateSymbologyFields(){this._symbologyFields=l(this._symbologyOverrideFields)&&this._symbologyOverrideFields.length>0?l(this._rendererFields)&&this._rendererFields.length>0?B(this.i3slayer.fieldsIndex,[...this._rendererFields,...this._symbologyOverrideFields]):this._symbologyOverrideFields:this._rendererFields}_updateCachedRendererData(e){if(e.cachedRendererVersion=this._rendererVersion,!this._hasSymbolColors)return;const t=this._tmpAttributeOnlyGraphic,i={};t.attributes=i;const s=this._currentRenderer,r=l(e.attributeInfo)&&e.attributeInfo.attributeData,o=null!=e.featureIds?this.i3slayer.objectIdField:null,a=null!=r&&l(this._symbologyFields)&&this._symbologyFields.length>0,n=a?[]:null,d=a?[]:null;if(a&&l(this._symbologyFields))for(const l of this._symbologyFields){const e=r[l];e&&(n.push(l),d.push(e))}e.cachedSymbology||(e.cachedSymbology=new Uint8Array(5*e.featureIds.length));const c={color:Je,castShadows:!0,pickable:!0,colorMixMode:1,edgeMaterial:null},u=this.fullOpacity,_=this.nodeCrossfadingEnabled?this.getNodeOpacity(e):u;let m=null,g=2,p=Se,f=0;for(let b=0;b<e.featureIds.length;b++){if(null!=o&&(i[o]=e.featureIds[b]),a)for(let e=0;e<n.length;e++)i[n[e]]=xe(d[e],b);const r=this._getSymbolInfo(s,t);let u=null,y=null;if(s&&\"visualVariables\"in s){if(this._colorVariable){const e=z(this._colorVariable,t,{color:Qe,arcade:this._arcade});e&&(u=Je,u[0]=e.r/255,u[1]=e.g/255,u[2]=e.b/255,this._opacityVariable||null===e.a||(y=e.a))}this._opacityVariable&&(y=W(this._opacityVariable,t,{arcade:this._arcade}))}if(r&&r.material){const e=r.material;u=h(u)||h(y)?se(u,y,e.color,e.alpha,Le,Je):se(u,y,null,null,Le,Je)}if(h(u)&&(u=Je,u[0]=1,u[1]=1,u[2]=1,u[3]=1),c.pickable=!0,c.castShadows=!r||r.castShadows,c.colorMixMode=r&&r.material?r.material.colorMixMode:1,c.edgeMaterial=r?r.edgeMaterial:null,l(this._symbologyOverride)&&(c.color=u,this._symbologyOverride(t,c),u=c.color),l(c.edgeMaterial)){const t=u[3]<=0?0:u[3]>=1&&(e.material.isOpaque||3===c.colorMixMode)?2:1;c.edgeMaterial===m&&t===g||(p={...c.edgeMaterial,opacity:_,objectTransparency:t},m=c.edgeMaterial,g=t),e.cachedEdgeMaterials[b]=p}else e.cachedEdgeMaterials[b]=Se;e.cachedSymbology[f+0]=Math.round(255*u[0]),e.cachedSymbology[f+1]=Math.round(255*u[1]),e.cachedSymbology[f+2]=Math.round(255*u[2]),e.cachedSymbology[f+3]=Math.round(255*u[3]),e.cachedSymbology[f+4]=c.colorMixMode|+c.castShadows<<4|+c.pickable<<5,f+=5}}_getFilteredEdgeMaterials(e){const t=this._getCachedEdgeMaterials(e);if(this.nodeCrossfadingEnabled||ot(t,this.fullOpacity),h(e.filteredIds)){return{hasEdges:t.some((e=>e!==Se)),perFeatureEdgeMaterials:t}}let i=0,s=!1;const r=t.map(((t,r)=>e.featureIds[r]!==e.filteredIds[i]?Se:(s=s||t!==Se,i++,t)));return{hasEdges:s,perFeatureEdgeMaterials:r}}_setObjectSymbolColors(e){if(!this._hasSymbolColors)return;const t=e.objectHandle,i=this._getSymbolColors(e);this._collection.setComponentData(t,i),this._stage.renderView.setNeedsRender()}_reloadAll(e=this.elevationOffset){this._removeAllNodeDataFromStage(e),null!=this._controller&&this._controller.restartNodeLoading()}_opacityChange(e){this.nodeCrossfadingEnabled&&this._crossfadeHelper.stopAllNodeFading(),this._nodeId2Meta.forEach((t=>{h(t)||(this._collection.updateMaterial(t.objectHandle,(t=>t.objectOpacity=e)),ot(t.cachedEdgeMaterials,e),this._updateEdgeRendering(t))}))}_updateMaterial(e){this._collection.updateMaterial(e.objectHandle,(e=>{e.commonMaterialParameters.slicePlaneEnabled=this.slicePlaneEnabled,e.usePBR=this._usePBR(),this._updateMaterialOverlay(e)}))}_updateMaterialOverlay(e){}_updateEngineObject(e){this._setObjectSymbolColors(e),this._applyFiltersToNode(e),this._addOrUpdateEdgeRendering(e),this._visibleGeometryChanged(e)}_slicePlaneEnabledChange(e){this._intersectionHandler&&(this._intersectionHandler.slicePlane=e),l(this._labeler)&&(this._labeler.slicePlaneEnabled=e),this._nodeId2Meta.forEach((t=>{h(t)||(this._collection.updateMaterial(t.objectHandle,(t=>{t.commonMaterialParameters.slicePlaneEnabled=e})),this._updateEdgeRendering(t,!1))}))}_updatePBR(){this._nodeId2Meta.forEach((e=>{h(e)||this._collection.updateMaterial(e.objectHandle,(e=>{e.usePBR=this._usePBR()}))})),this._hasLoadedPBRTextures=!0}_usePBR(){return!this._isIntegratedMesh&&this.view.qualitySettings.physicallyBasedRenderingEnabled}_updateEdgeRendering(e,t=!0){l(this._edgeView)&&this._edgeView.hasObject(e.objectHandle)&&this._addOrUpdateEdgeRendering(e,t)}_forAllNodes(e){this._nodeId2Meta.forEach(e)}_forAllFeatures(e,t,i=0){a(this._nodeId2Meta,(s=>{if(h(s))return!1;if(l(t)){switch(t(s)){case 0:return!0;case 2:return!1}}let r=1;switch(i){case 1:r=this._forAllFeaturesOfNode(s,e);break;case 0:r=this._forVisibleFeaturesOfNode(s,e);break;case 2:r=this._forAllFeaturesOfNodeInClippingArea(s,e)}return 0===r}))}_forAllFeaturesOfNode(e,t){let i=1;const s=e.featureIds;for(let r=0;r<s.length;r++)if(i=t(s[r],r,e),0===i)return i;return i}_forVisibleFeaturesOfNode(e,t){let i=1;const s=e.featureIds;return this._collection.forEachVisibleComponent(e.objectHandle,(r=>(i=t(s[r],r,e),1===i))),i}_forAllFeaturesOfNodeInClippingArea(e,t){if(null==this._clippingArea)return this._forAllFeaturesOfNode(e,t);const i=this._boundingboxNodeTest(e,this._clippingArea);if(0===i)return 1;if(3===i)return this._forAllFeaturesOfNode(e,t);const s=1,r=e.featureIds,o=e.objectHandle,a=Ee(this._clippingArea,this._collection.getObjectTransform(o));for(let n=0;n<r.length;n++){if(!this._boundingboxFeatureTest(e,n,a))continue;const i=t(r[n],n,e);if(0===i)return i}return s}_createAttributes(e,t){const i={};null!=t.featureIds&&(i[this._getObjectIdField()]=t.featureIds[e]);const s=l(t.attributeInfo)&&t.attributeInfo.attributeData;if(l(s))for(const r of Object.keys(s))i[r]=xe(s[r],e);return i}_createGraphic(e,t){return this._createLayerGraphic(this._createAttributes(e,t))}highlight(e){const t=this._highlights;if(\"number\"==typeof e||e instanceof i?e=[e]:e instanceof s&&(e=e.toArray()),Array.isArray(e)&&e.length>0){if(e[0]instanceof i){const i=e,s=this.i3slayer.fieldsIndex,r=this._getObjectIdField(),o=i.map((e=>De(s,e.attributes,r))),{set:a,handle:n}=t.acquireSet();return t.setFeatureIds(a,o),n}if(\"number\"==typeof e[0]){const i=e,{set:s,handle:r}=t.acquireSet();return t.setFeatureIds(s,i),r}}return rt}_visibleGeometryChanged(e){this._elevationProvider&&(this._elevationProvider.objectChanged(e.node),null==this._visibleGeometryChangedSchedulerHandle&&(this._visibleGeometryChangedSchedulerHandle=p((()=>{this.emit(\"visible-geometry-changed\"),this._visibleGeometryChangedSchedulerHandle=null}))))}get performanceInfo(){const e={displayedNumberOfFeatures:0,maximumNumberOfFeatures:0,totalNumberOfFeatures:0,core:null,index:0,nodes:this._nodeId2Meta.size,\"Total GPU Memory Estimate\":(this.gpuMemoryEstimate/1048576).toFixed(1)+\"MB\",\"Geometry Memory Estimate\":(this.geoMemoryEstimate/1048576).toFixed(1)+\"MB\",\"Texture Memory Estimate\":(this.texMemoryEstimate/1048576).toFixed(1)+\"MB\",\"Unloaded Memory Estimate\":(this.getUnloadedMemory()/1048576).toFixed(1)+\"MB\",...this._collection?this._collection.performanceInfo:{shown:0,hidden:0}};return l(this._memCache)&&(e.MemCache=Math.round(100*this._memCache.hitRate)+\"% hit\"),this._controller&&(this._idbCacheEnabled&&(e.IDBCache=Math.round(100*this._idbCache.getHitRate())+\"% hit\"),this._controller.updateStats(e)),e}get test(){const e=this;return{controller:this._controller,labeler:this._labeler,get visibleObjectIds(){const t=[];return e._forAllFeatures((e=>(t.push(e),1)),null,0),t.sort(((e,t)=>e-t)),t},get numNodes(){return e._nodeId2Meta.size}}}getNodeOpacityByIndex(e){const t=this._nodeId2Meta.get(e);return this.getNodeOpacity(t)}getNodeOpacity(e){return l(e)?this._collection.getMaterial(e.objectHandle).objectOpacity:0}isNodeFullyFadedIn(e){return this._crossfadeHelper.isNodeFullyFadedIn(e)}getNodeCrossfadeMetaData(e){return this._nodeId2Meta.get(e)}markNodeToRemove(e){this._controller&&this._controller.markNodeToRemove(e)}removeMarkedNodes(){this._controller&&this._controller.removeMarkedNodes()}foreachCrossfadeNode(e){this._nodeId2Meta.forEach(((t,i)=>e(i,t)))}fadeNode(e,t,i){if(!this.nodeCrossfadingEnabled)return;const s=this._nodeId2Meta.get(e);l(s)&&this._crossfadeHelper.fadeNode(e,s,t,i)}setNodeOpacityByIndex(e,t){const i=this._nodeId2Meta.get(e);l(i)&&this._setNodeOpacity(i,t)}_setNodeOpacity(e,t){this._collection.updateMaterial(e.objectHandle,(e=>e.objectOpacity=t)),this._setNodeEdgeOpacity(e,t)}_setNodeEdgeOpacity(e,t){if(!l(this._edgeView)||!e.cachedEdgeMaterials)return;ot(e.cachedEdgeMaterials,t);const i=e.objectHandle;this._edgeView.hasObject(i)&&this._edgeView.updateAllComponentOpacities(i,t)}get _hasModifications(){return this._modifications&&this._modifications.length>0}updateNodeModificationStatus(e){const t=e.length;if(!this._hasModifications||t<=0||!0!==this._i3sWasmLoaded)return;const i=this.i3slayer.uid,s=st(e);if(l(s)){const t={context:i,buffer:s.buffer};te(t);const r=new Float64Array(s.buffer);e.forAll(((e,t)=>{const i=r[t],s=ie(i);e.imModificationImpact=s,0!==s&&this._controller.invalidateGeometryVisibility(e.index)}))}}notifyUpdate(){this.notifyChange(\"updating\")}notifyLODUpdate(){this._controller.notifyLODUpdate()}isUpdating(){return!(!this._controller||!this._controller.updating)||!!this._visibleGeometryChangedSchedulerHandle||l(this._labeler)&&this._labeler.updating||this._crossfadeHelper.updating||this._i3sWasmLoaded instanceof Promise||this._asyncModuleLoading>0}};return f.lastIndex=0,e([v()],f.prototype,\"_hasLoadedPBRTextures\",void 0),e([v()],f.prototype,\"_asyncModuleLoading\",void 0),e([v()],f.prototype,\"_visibleGeometryChangedSchedulerHandle\",void 0),e([v()],f.prototype,\"view\",void 0),e([v()],f.prototype,\"i3slayer\",void 0),e([v()],f.prototype,\"_controller\",void 0),e([v()],f.prototype,\"_labeler\",void 0),e([v()],f.prototype,\"updating\",void 0),e([v()],f.prototype,\"suspended\",void 0),e([v()],f.prototype,\"holeFilling\",void 0),e([v(Ae)],f.prototype,\"updatingProgress\",void 0),e([v({readOnly:!0,aliasOf:\"_controller.updatingProgress\"})],f.prototype,\"updatingProgressValue\",void 0),e([v({readOnly:!0})],f.prototype,\"hasTexturesOrVertexColors\",null),e([v({readOnly:!0})],f.prototype,\"rendererTextureUsage\",null),e([v({readOnly:!0})],f.prototype,\"elevationOffset\",null),e([v({type:Boolean})],f.prototype,\"slicePlaneEnabled\",void 0),e([v()],f.prototype,\"supportedTextureEncodings\",null),e([v()],f.prototype,\"uncompressedTextureDownsamplingEnabled\",null),e([v({type:[q]})],f.prototype,\"_modifications\",void 0),f=o=e([I(\"esri.views.3d.layers.I3SMeshView3D\")],f),f},We=P(),$e=P(),Ke=Te(),Je=[0,0,0,0],Qe=new t([0,0,0,0]),Xe=[0,0,0,0];function Ye(e){const t=e.metallicRoughness;return t&&t.baseColorTextureId>=0||t&&t.metallicRoughnessTextureId>=0||e.normalTextureId>=0||e.emissiveTextureId>=0||e.occlusionTextureId>=0}function Ze(e){return\"geometryData\"in e}function et(e){return l(e)&&f(e.data)}function tt(e,t){let i=1024+e.interleavedVertexData.byteLength+(e.indices?e.indices.byteLength:0)+e.positionData.data.byteLength+e.positionData.indices.byteLength;if(l(t))for(const s of t)l(s)&&f(s.data)&&(i+=s.data.byteLength);return i}function it(e,t){return t.byteSize>qe?(Ge.warn(`Node is too big to store in IndexedDB cache: ${e.id} (${t.byteSize} bytes)`),!1):t.byteSize>0}function st(e){if(0===e.length)return null;const t=10*e.length,i=new Float64Array(t);return e.forAll(((e,t)=>{let s=e.serviceObb;h(s)&&(s=Ke,E(s.center,e.mbs),s.halfSize[0]=s.halfSize[1]=s.halfSize[2]=e.mbs[3]);const r=10*t;i[r+0]=s.center[0],i[r+1]=s.center[1],i[r+2]=s.center[2],i[r+3]=s.halfSize[0],i[r+4]=s.halfSize[1],i[r+5]=s.halfSize[2],i[r+6]=s.quaternion[0],i[r+7]=s.quaternion[1],i[r+8]=s.quaternion[2],i[r+9]=s.quaternion[3]})),i}const rt={remove(){},pause(){},resume(){}};function ot(e,t){e.forEach((e=>e.opacity=t))}export{ze as I3SMeshView3D};\n"]},"metadata":{},"sourceType":"module"}