{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isSome as e, isNone as t } from \"../../../../core/maybe.js\";\nimport r from \"./GLMaterial.js\";\n\nclass i extends r {\n  constructor(e) {\n    super(e), this._textureIDs = new Set(), this._textureRepository = e.textureRep, this._textureId = e.textureId, this._initTransparent = !!e.initTextureTransparent, this._texture = this._acquire(this._textureId), this._textureNormal = this._acquire(e.normalTextureId), this._textureEmissive = this._acquire(e.emissiveTextureId), this._textureOcclusion = this._acquire(e.occlusionTextureId), this._textureMetallicRoughness = this._acquire(e.metallicRoughnessTextureId);\n  }\n\n  dispose() {\n    this._textureIDs.forEach(e => this._textureRepository.release(e)), this._textureIDs.clear();\n  }\n\n  updateTexture(e) {\n    e !== this._textureId && (this._release(this._textureId), this._textureId = e, this._texture = this._acquire(this._textureId));\n  }\n\n  bindTextures(t) {\n    e(this._texture) && t.bindTexture(this._texture.glTexture, \"tex\"), e(this._textureNormal) && t.bindTexture(this._textureNormal.glTexture, \"normalTexture\"), e(this._textureEmissive) && t.bindTexture(this._textureEmissive.glTexture, \"texEmission\"), e(this._textureOcclusion) && t.bindTexture(this._textureOcclusion.glTexture, \"texOcclusion\"), e(this._textureMetallicRoughness) && t.bindTexture(this._textureMetallicRoughness.glTexture, \"texMetallicRoughness\");\n  }\n\n  bindTextureScale(t) {\n    const r = e(this._texture) && this._texture.glTexture;\n\n    r && r.descriptor.textureCoordinateScaleFactor ? t.setUniform2fv(\"textureCoordinateScaleFactor\", r.descriptor.textureCoordinateScaleFactor) : t.setUniform2f(\"textureCoordinateScaleFactor\", 1, 1);\n  }\n\n  _acquire(e) {\n    if (!t(e)) return this._textureIDs.add(e), this._textureRepository.acquire(e, this._initTransparent);\n  }\n\n  _release(e) {\n    t(e) || (this._textureIDs.delete(e), this._textureRepository.release(e));\n  }\n\n}\n\nexport default i;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterialTexture.js"],"names":["isSome","e","isNone","t","r","i","constructor","_textureIDs","Set","_textureRepository","textureRep","_textureId","textureId","_initTransparent","initTextureTransparent","_texture","_acquire","_textureNormal","normalTextureId","_textureEmissive","emissiveTextureId","_textureOcclusion","occlusionTextureId","_textureMetallicRoughness","metallicRoughnessTextureId","dispose","forEach","release","clear","updateTexture","_release","bindTextures","bindTexture","glTexture","bindTextureScale","descriptor","textureCoordinateScaleFactor","setUniform2fv","setUniform2f","add","acquire","delete"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../core/maybe.js\";import r from\"./GLMaterial.js\";class i extends r{constructor(e){super(e),this._textureIDs=new Set,this._textureRepository=e.textureRep,this._textureId=e.textureId,this._initTransparent=!!e.initTextureTransparent,this._texture=this._acquire(this._textureId),this._textureNormal=this._acquire(e.normalTextureId),this._textureEmissive=this._acquire(e.emissiveTextureId),this._textureOcclusion=this._acquire(e.occlusionTextureId),this._textureMetallicRoughness=this._acquire(e.metallicRoughnessTextureId)}dispose(){this._textureIDs.forEach((e=>this._textureRepository.release(e))),this._textureIDs.clear()}updateTexture(e){e!==this._textureId&&(this._release(this._textureId),this._textureId=e,this._texture=this._acquire(this._textureId))}bindTextures(t){e(this._texture)&&t.bindTexture(this._texture.glTexture,\"tex\"),e(this._textureNormal)&&t.bindTexture(this._textureNormal.glTexture,\"normalTexture\"),e(this._textureEmissive)&&t.bindTexture(this._textureEmissive.glTexture,\"texEmission\"),e(this._textureOcclusion)&&t.bindTexture(this._textureOcclusion.glTexture,\"texOcclusion\"),e(this._textureMetallicRoughness)&&t.bindTexture(this._textureMetallicRoughness.glTexture,\"texMetallicRoughness\")}bindTextureScale(t){const r=e(this._texture)&&this._texture.glTexture;r&&r.descriptor.textureCoordinateScaleFactor?t.setUniform2fv(\"textureCoordinateScaleFactor\",r.descriptor.textureCoordinateScaleFactor):t.setUniform2f(\"textureCoordinateScaleFactor\",1,1)}_acquire(e){if(!t(e))return this._textureIDs.add(e),this._textureRepository.acquire(e,this._initTransparent)}_release(e){t(e)||(this._textureIDs.delete(e),this._textureRepository.release(e))}}export default i;\n"]},"metadata":{},"sourceType":"module"}