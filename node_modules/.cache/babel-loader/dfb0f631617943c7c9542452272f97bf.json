{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../request.js\";\nimport \"../../core/has.js\";\nimport { normalizeCentralMeridian as a } from \"../../geometry/support/normalizeUtils.js\";\nimport t from \"../../layers/support/Field.js\";\nimport r from \"../../layers/support/MapImage.js\";\nimport { parseUrl as o, encode as u } from \"../utils.js\";\nimport l from \"../support/DataFile.js\";\nimport s from \"../support/FeatureSet.js\";\nimport n from \"../support/LinearUnit.js\";\nimport i from \"../support/ParameterValue.js\";\nimport c from \"../support/RasterData.js\";\n\nasync function m(t, r, u, l, s) {\n  const n = {},\n        i = {},\n        c = [];\n  return p(l, c, n), a(c).then(a => {\n    const {\n      outSpatialReference: c,\n      processExtent: m,\n      processSpatialReference: p,\n      returnFeatureCollection: f,\n      returnM: G,\n      returnZ: v\n    } = u,\n          {\n      path: S\n    } = o(t);\n\n    for (const e in n) {\n      const t = n[e];\n      i[e] = a.slice(t[0], t[1]);\n    }\n\n    const y = c ? c.wkid || c : null,\n          D = p ? p.wkid || p : null,\n          J = \"execute\" === r ? {\n      returnFeatureCollection: f || void 0,\n      returnM: G || void 0,\n      returnZ: v || void 0\n    } : null,\n          M = P({ ...(m ? {\n        context: {\n          extent: m,\n          outSR: y,\n          processSR: D\n        }\n      } : {\n        \"env:outSR\": y,\n        \"env:processSR\": D\n      }),\n      ...l,\n      ...J,\n      f: \"json\"\n    }, null, i),\n          N = { ...s,\n      query: M\n    };\n    return e(`${S}/${r}`, N);\n  });\n}\n\nfunction p(e, a, t) {\n  for (const r in e) {\n    const o = e[r];\n\n    if (o && \"object\" == typeof o && o instanceof s) {\n      const {\n        features: e\n      } = o;\n      t[r] = [a.length, a.length + e.length], e.forEach(e => {\n        a.push(e.geometry);\n      });\n    }\n  }\n}\n\nfunction f(e) {\n  const a = e.dataType,\n        o = i.fromJSON(e);\n\n  switch (a) {\n    case \"GPBoolean\":\n    case \"GPDouble\":\n    case \"GPLong\":\n    case \"GPString\":\n      return o;\n\n    case \"GPDate\":\n      o.value = new Date(o.value);\n      break;\n\n    case \"GPDataFile\":\n      o.value = l.fromJSON(o.value);\n      break;\n\n    case \"GPLinearUnit\":\n      o.value = n.fromJSON(o.value);\n      break;\n\n    case \"GPFeatureRecordSetLayer\":\n    case \"GPRecordSet\":\n      {\n        const a = e.value.url;\n        o.value = a ? l.fromJSON(o.value) : s.fromJSON(o.value);\n        break;\n      }\n\n    case \"GPRasterData\":\n    case \"GPRasterDataLayer\":\n      {\n        const a = e.value.mapImage;\n        o.value = a ? r.fromJSON(a) : c.fromJSON(o.value);\n        break;\n      }\n\n    case \"GPField\":\n      o.value = t.fromJSON(o.value);\n      break;\n\n    case \"GPMultiValue:GPBoolean\":\n    case \"GPMultiValue:GPDouble\":\n    case \"GPMultiValue:GPLong\":\n    case \"GPMultiValue:GPString\":\n      return o;\n\n    case \"GPMultiValue:GPDate\":\n      {\n        const e = o.value;\n        o.value = e.map(e => new Date(e));\n        break;\n      }\n\n    case \"GPMultiValue:GPDataFile\":\n      o.value = o.value.map(e => l.fromJSON(e));\n      break;\n\n    case \"GPMultiValue:GPLinearUnit\":\n      o.value = o.value.map(e => n.fromJSON(e));\n      break;\n\n    case \"GPMultiValue:GPFeatureRecordSetLayer\":\n    case \"GPMultiValue:GPRecordSet\":\n      o.value = o.value.map(e => s.fromJSON(e));\n      break;\n\n    case \"GPMultiValue:GPRasterData\":\n    case \"GPMultiValue:GPRasterDataLayer\":\n      o.value = o.value.map(e => e ? r.fromJSON(e) : c.fromJSON(o.value));\n      break;\n\n    case \"GPMultiValue:GPField\":\n      o.value = o.value.map(e => t.fromJSON(e));\n  }\n\n  return o;\n}\n\nfunction P(e, a, t) {\n  for (const r in e) {\n    const a = e[r];\n    Array.isArray(a) ? e[r] = JSON.stringify(a.map(e => P({\n      item: e\n    }, !0).item)) : a instanceof Date && (e[r] = a.getTime());\n  }\n\n  return u(e, a, t);\n}\n\nexport { p as collectGeometries, m as constructRequest, f as decode, P as gpEncode };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/rest/geoprocessor/utils.js"],"names":["e","normalizeCentralMeridian","a","t","r","parseUrl","o","encode","u","l","s","n","i","c","m","p","then","outSpatialReference","processExtent","processSpatialReference","returnFeatureCollection","f","returnM","G","returnZ","v","path","S","slice","y","wkid","D","J","M","P","context","extent","outSR","processSR","N","query","features","length","forEach","push","geometry","dataType","fromJSON","value","Date","url","mapImage","map","Array","isArray","JSON","stringify","item","getTime","collectGeometries","constructRequest","decode","gpEncode"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import\"../../core/has.js\";import{normalizeCentralMeridian as a}from\"../../geometry/support/normalizeUtils.js\";import t from\"../../layers/support/Field.js\";import r from\"../../layers/support/MapImage.js\";import{parseUrl as o,encode as u}from\"../utils.js\";import l from\"../support/DataFile.js\";import s from\"../support/FeatureSet.js\";import n from\"../support/LinearUnit.js\";import i from\"../support/ParameterValue.js\";import c from\"../support/RasterData.js\";async function m(t,r,u,l,s){const n={},i={},c=[];return p(l,c,n),a(c).then((a=>{const{outSpatialReference:c,processExtent:m,processSpatialReference:p,returnFeatureCollection:f,returnM:G,returnZ:v}=u,{path:S}=o(t);for(const e in n){const t=n[e];i[e]=a.slice(t[0],t[1])}const y=c?c.wkid||c:null,D=p?p.wkid||p:null,J=\"execute\"===r?{returnFeatureCollection:f||void 0,returnM:G||void 0,returnZ:v||void 0}:null,M=P({...m?{context:{extent:m,outSR:y,processSR:D}}:{\"env:outSR\":y,\"env:processSR\":D},...l,...J,f:\"json\"},null,i),N={...s,query:M};return e(`${S}/${r}`,N)}))}function p(e,a,t){for(const r in e){const o=e[r];if(o&&\"object\"==typeof o&&o instanceof s){const{features:e}=o;t[r]=[a.length,a.length+e.length],e.forEach((e=>{a.push(e.geometry)}))}}}function f(e){const a=e.dataType,o=i.fromJSON(e);switch(a){case\"GPBoolean\":case\"GPDouble\":case\"GPLong\":case\"GPString\":return o;case\"GPDate\":o.value=new Date(o.value);break;case\"GPDataFile\":o.value=l.fromJSON(o.value);break;case\"GPLinearUnit\":o.value=n.fromJSON(o.value);break;case\"GPFeatureRecordSetLayer\":case\"GPRecordSet\":{const a=e.value.url;o.value=a?l.fromJSON(o.value):s.fromJSON(o.value);break}case\"GPRasterData\":case\"GPRasterDataLayer\":{const a=e.value.mapImage;o.value=a?r.fromJSON(a):c.fromJSON(o.value);break}case\"GPField\":o.value=t.fromJSON(o.value);break;case\"GPMultiValue:GPBoolean\":case\"GPMultiValue:GPDouble\":case\"GPMultiValue:GPLong\":case\"GPMultiValue:GPString\":return o;case\"GPMultiValue:GPDate\":{const e=o.value;o.value=e.map((e=>new Date(e)));break}case\"GPMultiValue:GPDataFile\":o.value=o.value.map((e=>l.fromJSON(e)));break;case\"GPMultiValue:GPLinearUnit\":o.value=o.value.map((e=>n.fromJSON(e)));break;case\"GPMultiValue:GPFeatureRecordSetLayer\":case\"GPMultiValue:GPRecordSet\":o.value=o.value.map((e=>s.fromJSON(e)));break;case\"GPMultiValue:GPRasterData\":case\"GPMultiValue:GPRasterDataLayer\":o.value=o.value.map((e=>e?r.fromJSON(e):c.fromJSON(o.value)));break;case\"GPMultiValue:GPField\":o.value=o.value.map((e=>t.fromJSON(e)))}return o}function P(e,a,t){for(const r in e){const a=e[r];Array.isArray(a)?e[r]=JSON.stringify(a.map((e=>P({item:e},!0).item))):a instanceof Date&&(e[r]=a.getTime())}return u(e,a,t)}export{p as collectGeometries,m as constructRequest,f as decode,P as gpEncode};\n"]},"metadata":{},"sourceType":"module"}