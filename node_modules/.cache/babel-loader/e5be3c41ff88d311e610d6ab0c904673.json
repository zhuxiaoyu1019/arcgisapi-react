{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport r from \"../../PopupTemplate.js\";\nimport \"../../renderers/ClassBreaksRenderer.js\";\nimport \"../../renderers/DictionaryRenderer.js\";\nimport \"../../renderers/DotDensityRenderer.js\";\nimport \"../../renderers/HeatmapRenderer.js\";\nimport \"../../renderers/Renderer.js\";\nimport \"../../renderers/SimpleRenderer.js\";\nimport \"../../renderers/UniqueValueRenderer.js\";\nimport \"../../renderers/support/jsonUtils.js\";\nimport { webSceneRendererTypes as t } from \"../../renderers/support/types.js\";\nimport o from \"../../request.js\";\nimport s from \"../../core/Error.js\";\nimport { JSONMap as i } from \"../../core/jsonMap.js\";\nimport a from \"../../core/Loadable.js\";\nimport p from \"../../core/Logger.js\";\nimport { isSome as n, isNone as l } from \"../../core/maybe.js\";\nimport { EsriPromiseMixin as d } from \"../../core/Promise.js\";\nimport { property as y } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/has.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport { enumeration as u } from \"../../core/accessorSupport/decorators/enumeration.js\";\nimport { reader as c } from \"../../core/accessorSupport/decorators/reader.js\";\nimport { subclass as m } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport h from \"../../geometry/Extent.js\";\nimport f from \"../../geometry/SpatialReference.js\";\nimport g from \"../FeatureLayer.js\";\nimport j from \"./BuildingSublayer.js\";\nimport { zeroCapabilities as v } from \"../support/capabilities.js\";\nimport { popupEnabled as b } from \"../support/commonProperties.js\";\nimport { defineFieldProperties as L } from \"../support/fieldProperties.js\";\nimport F from \"../support/FieldsIndex.js\";\nimport { fetchIndexInfo as S } from \"../support/I3SIndexInfo.js\";\nimport { I3SNodePageDefinition as I, I3SMaterialDefinition as O, I3STextureSetDefinition as w, I3SGeometryDefinition as x } from \"../support/I3SLayerDefinitions.js\";\nimport T from \"../../rest/support/Query.js\";\nimport { createPopupTemplate as q } from \"../../support/popupUtils.js\";\nimport P from \"../../symbols/support/ElevationInfo.js\";\nconst D = p.getLogger(\"esri.layers.buildingSublayers.BuildingComponentSublayer\"),\n      Q = L();\nlet R = class extends a.LoadableMixin(d(j)) {\n  constructor(e) {\n    super(e), this.type = \"building-component\", this.nodePages = null, this.materialDefinitions = null, this.textureSetDefinitions = null, this.geometryDefinitions = null, this.serviceUpdateTimeStamp = null, this.fields = null, this.associatedLayer = null, this.outFields = null, this.listMode = \"show\", this.renderer = null, this.definitionExpression = null, this.popupEnabled = !0, this.popupTemplate = null, this.layerType = \"3d-object\";\n  }\n\n  get parsedUrl() {\n    return this.layer ? {\n      path: `${this.layer.parsedUrl.path}/sublayers/${this.id}`,\n      query: this.layer.parsedUrl.query\n    } : null;\n  }\n\n  get fieldsIndex() {\n    return new F(this.fields);\n  }\n\n  readAssociatedLayer(e, r) {\n    const t = this.layer.associatedFeatureServiceItem,\n          o = r.associatedLayerID;\n    return n(t) && \"number\" == typeof o ? new g({\n      portalItem: t,\n      layerId: o\n    }) : null;\n  }\n\n  get objectIdField() {\n    if (null != this.fields) for (const e of this.fields) if (\"oid\" === e.type) return e.name;\n    return null;\n  }\n\n  get displayField() {\n    return n(this.associatedLayer) ? this.associatedLayer.displayField : null;\n  }\n\n  get defaultPopupTemplate() {\n    return this.createPopupTemplate();\n  }\n\n  load(e) {\n    const r = n(e) ? e.signal : null,\n          t = this._fetchService(r).then(() => {\n      this.indexInfo = S(this.parsedUrl.path, this.rootNode, this.nodePages, this.apiKey, D, r);\n    });\n\n    return this.addResolvingPromise(t), Promise.resolve(this);\n  }\n\n  createPopupTemplate(e) {\n    return q(this, e);\n  }\n\n  async _fetchService(e) {\n    const r = (await o(this.parsedUrl.path, {\n      query: {\n        f: \"json\",\n        token: this.apiKey\n      },\n      responseType: \"json\",\n      signal: e\n    })).data;\n    this.read(r, {\n      origin: \"service\",\n      url: this.parsedUrl\n    });\n  }\n\n  getField(e) {\n    return this.fieldsIndex.get(e);\n  }\n\n  getFieldDomain(e, r) {\n    var t, o, s, i;\n    const a = null == (t = this.getFeatureType(null == r ? void 0 : r.feature)) || null == (o = t.domains) ? void 0 : o[e];\n    return a && \"inherited\" !== a.type ? a : null != (s = null == (i = this.getField(e)) ? void 0 : i.domain) ? s : null;\n  }\n\n  getFeatureType(e) {\n    return e && n(this.associatedLayer) ? this.associatedLayer.getFeatureType(e) : null;\n  }\n\n  get types() {\n    return n(this.associatedLayer) ? this.associatedLayer.types : [];\n  }\n\n  get typeIdField() {\n    return n(this.associatedLayer) ? this.associatedLayer.typeIdField : null;\n  }\n\n  get geometryType() {\n    return \"3d-object\" === this.layerType ? \"mesh\" : \"point\";\n  }\n\n  get profile() {\n    return \"3d-object\" === this.layerType ? \"mesh-pyramids\" : \"points\";\n  }\n\n  get capabilities() {\n    const e = n(this.associatedLayer) && this.associatedLayer.capabilities ? this.associatedLayer.capabilities : v,\n          {\n      query: r,\n      data: {\n        supportsZ: t,\n        supportsM: o,\n        isVersioned: s\n      }\n    } = e;\n    return {\n      query: r,\n      data: {\n        supportsZ: t,\n        supportsM: o,\n        isVersioned: s\n      }\n    };\n  }\n\n  createQuery() {\n    const e = new T();\n    return \"mesh\" !== this.geometryType && (e.returnGeometry = !0, e.returnZ = !0), e.where = this.definitionExpression || \"1=1\", e.sqlFormat = \"standard\", e;\n  }\n\n  queryExtent(e, r) {\n    return this._getAssociatedLayerForQuery().then(t => t.queryExtent(e || this.createQuery(), r));\n  }\n\n  queryFeatureCount(e, r) {\n    return this._getAssociatedLayerForQuery().then(t => t.queryFeatureCount(e || this.createQuery(), r));\n  }\n\n  queryFeatures(e, r) {\n    return this._getAssociatedLayerForQuery().then(t => t.queryFeatures(e || this.createQuery(), r)).then(e => {\n      if (null != e && e.features) for (const r of e.features) r.layer = this.layer, r.sourceLayer = this;\n      return e;\n    });\n  }\n\n  queryObjectIds(e, r) {\n    return this._getAssociatedLayerForQuery().then(t => t.queryObjectIds(e || this.createQuery(), r));\n  }\n\n  getFieldUsageInfo(e) {\n    return this.fieldsIndex.has(e) ? {\n      supportsLabelingInfo: !1,\n      supportsRenderer: !1,\n      supportsPopupTemplate: !1,\n      supportsLayerQuery: !1\n    } : {\n      supportsLabelingInfo: !1,\n      supportsRenderer: !0,\n      supportsPopupTemplate: !0,\n      supportsLayerQuery: n(this.associatedLayer)\n    };\n  }\n\n  _getAssociatedLayerForQuery() {\n    const e = this.associatedLayer;\n    return n(e) && e.loaded ? Promise.resolve(e) : this._loadAssociatedLayerForQuery();\n  }\n\n  async _loadAssociatedLayerForQuery() {\n    if (await this.load(), l(this.associatedLayer)) throw new s(\"buildingscenelayer:query-not-available\", \"BuildingSceneLayer component layer queries are not available without an associated feature layer\", {\n      layer: this\n    });\n\n    try {\n      await this.associatedLayer.load();\n    } catch (e) {\n      throw new s(\"buildingscenelayer:query-not-available\", \"BuildingSceneLayer associated feature layer could not be loaded\", {\n        layer: this,\n        error: e\n      });\n    }\n\n    return this.associatedLayer;\n  }\n\n};\ne([y({\n  readOnly: !0\n})], R.prototype, \"parsedUrl\", null), e([y({\n  type: I,\n  readOnly: !0\n})], R.prototype, \"nodePages\", void 0), e([y({\n  type: [O],\n  readOnly: !0\n})], R.prototype, \"materialDefinitions\", void 0), e([y({\n  type: [w],\n  readOnly: !0\n})], R.prototype, \"textureSetDefinitions\", void 0), e([y({\n  type: [x],\n  readOnly: !0\n})], R.prototype, \"geometryDefinitions\", void 0), e([y({\n  readOnly: !0\n})], R.prototype, \"serviceUpdateTimeStamp\", void 0), e([y({\n  readOnly: !0\n})], R.prototype, \"store\", void 0), e([y({\n  type: String,\n  readOnly: !0,\n  json: {\n    read: {\n      source: \"store.rootNode\"\n    }\n  }\n})], R.prototype, \"rootNode\", void 0), e([y({\n  readOnly: !0\n})], R.prototype, \"attributeStorageInfo\", void 0), e([y(Q.fields)], R.prototype, \"fields\", void 0), e([y({\n  readOnly: !0\n})], R.prototype, \"fieldsIndex\", null), e([y({\n  readOnly: !0,\n  type: g\n})], R.prototype, \"associatedLayer\", void 0), e([c(\"service\", \"associatedLayer\", [\"associatedLayerID\"])], R.prototype, \"readAssociatedLayer\", null), e([y(Q.outFields)], R.prototype, \"outFields\", void 0), e([y({\n  type: String,\n  readOnly: !0\n})], R.prototype, \"objectIdField\", null), e([y({\n  readOnly: !0,\n  type: String,\n  json: {\n    read: !1\n  }\n})], R.prototype, \"displayField\", null), e([y({\n  readOnly: !0,\n  type: String,\n  aliasOf: \"layer.apiKey\"\n})], R.prototype, \"apiKey\", void 0), e([y({\n  readOnly: !0,\n  type: h,\n  aliasOf: \"layer.fullExtent\"\n})], R.prototype, \"fullExtent\", void 0), e([y({\n  readOnly: !0,\n  type: f,\n  aliasOf: \"layer.spatialReference\"\n})], R.prototype, \"spatialReference\", void 0), e([y({\n  readOnly: !0,\n  aliasOf: \"layer.version\"\n})], R.prototype, \"version\", void 0), e([y({\n  readOnly: !0,\n  type: P,\n  aliasOf: \"layer.elevationInfo\"\n})], R.prototype, \"elevationInfo\", void 0), e([y({\n  readOnly: !0,\n  type: Number,\n  aliasOf: \"layer.minScale\"\n})], R.prototype, \"minScale\", void 0), e([y({\n  readOnly: !0,\n  type: Number,\n  aliasOf: \"layer.maxScale\"\n})], R.prototype, \"maxScale\", void 0), e([y({\n  type: [\"hide\", \"show\"],\n  json: {\n    write: !0\n  }\n})], R.prototype, \"listMode\", void 0), e([y({\n  types: t,\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"drawingInfo.renderer\"\n        }\n      }\n    },\n    name: \"layerDefinition.drawingInfo.renderer\",\n    write: !0\n  },\n  value: null\n})], R.prototype, \"renderer\", void 0), e([y({\n  type: String,\n  json: {\n    origins: {\n      service: {\n        read: !1,\n        write: !1\n      }\n    },\n    name: \"layerDefinition.definitionExpression\",\n    write: {\n      enabled: !0,\n      allowNull: !0\n    }\n  }\n})], R.prototype, \"definitionExpression\", void 0), e([y(b)], R.prototype, \"popupEnabled\", void 0), e([y({\n  type: r,\n  json: {\n    read: {\n      source: \"popupInfo\"\n    },\n    write: {\n      target: \"popupInfo\"\n    }\n  }\n})], R.prototype, \"popupTemplate\", void 0), e([y({\n  readOnly: !0,\n  type: String,\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"store.normalReferenceFrame\"\n        }\n      }\n    },\n    read: !1\n  }\n})], R.prototype, \"normalReferenceFrame\", void 0), e([y({\n  readOnly: !0,\n  json: {\n    read: !1\n  }\n})], R.prototype, \"defaultPopupTemplate\", null), e([y()], R.prototype, \"types\", null), e([y()], R.prototype, \"typeIdField\", null), e([y({\n  json: {\n    write: !1\n  }\n}), u(new i({\n  \"3DObject\": \"3d-object\",\n  Point: \"point\"\n}))], R.prototype, \"layerType\", void 0), e([y()], R.prototype, \"geometryType\", null), e([y()], R.prototype, \"profile\", null), e([y({\n  readOnly: !0,\n  json: {\n    read: !1\n  }\n})], R.prototype, \"capabilities\", null), R = e([m(\"esri.layers.buildingSublayers.BuildingComponentSublayer\")], R);\nvar E = R;\nexport default E;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/layers/buildingSublayers/BuildingComponentSublayer.js"],"names":["_","e","r","webSceneRendererTypes","t","o","s","JSONMap","i","a","p","isSome","n","isNone","l","EsriPromiseMixin","d","property","y","enumeration","u","reader","c","subclass","m","h","f","g","j","zeroCapabilities","v","popupEnabled","b","defineFieldProperties","L","F","fetchIndexInfo","S","I3SNodePageDefinition","I","I3SMaterialDefinition","O","I3STextureSetDefinition","w","I3SGeometryDefinition","x","T","createPopupTemplate","q","P","D","getLogger","Q","R","LoadableMixin","constructor","type","nodePages","materialDefinitions","textureSetDefinitions","geometryDefinitions","serviceUpdateTimeStamp","fields","associatedLayer","outFields","listMode","renderer","definitionExpression","popupTemplate","layerType","parsedUrl","layer","path","id","query","fieldsIndex","readAssociatedLayer","associatedFeatureServiceItem","associatedLayerID","portalItem","layerId","objectIdField","name","displayField","defaultPopupTemplate","load","signal","_fetchService","then","indexInfo","rootNode","apiKey","addResolvingPromise","Promise","resolve","token","responseType","data","read","origin","url","getField","get","getFieldDomain","getFeatureType","feature","domains","domain","types","typeIdField","geometryType","profile","capabilities","supportsZ","supportsM","isVersioned","createQuery","returnGeometry","returnZ","where","sqlFormat","queryExtent","_getAssociatedLayerForQuery","queryFeatureCount","queryFeatures","features","sourceLayer","queryObjectIds","getFieldUsageInfo","has","supportsLabelingInfo","supportsRenderer","supportsPopupTemplate","supportsLayerQuery","loaded","_loadAssociatedLayerForQuery","error","readOnly","prototype","String","json","source","aliasOf","Number","write","origins","service","value","enabled","allowNull","target","Point","E"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../PopupTemplate.js\";import\"../../renderers/ClassBreaksRenderer.js\";import\"../../renderers/DictionaryRenderer.js\";import\"../../renderers/DotDensityRenderer.js\";import\"../../renderers/HeatmapRenderer.js\";import\"../../renderers/Renderer.js\";import\"../../renderers/SimpleRenderer.js\";import\"../../renderers/UniqueValueRenderer.js\";import\"../../renderers/support/jsonUtils.js\";import{webSceneRendererTypes as t}from\"../../renderers/support/types.js\";import o from\"../../request.js\";import s from\"../../core/Error.js\";import{JSONMap as i}from\"../../core/jsonMap.js\";import a from\"../../core/Loadable.js\";import p from\"../../core/Logger.js\";import{isSome as n,isNone as l}from\"../../core/maybe.js\";import{EsriPromiseMixin as d}from\"../../core/Promise.js\";import{property as y}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{enumeration as u}from\"../../core/accessorSupport/decorators/enumeration.js\";import{reader as c}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as m}from\"../../core/accessorSupport/decorators/subclass.js\";import h from\"../../geometry/Extent.js\";import f from\"../../geometry/SpatialReference.js\";import g from\"../FeatureLayer.js\";import j from\"./BuildingSublayer.js\";import{zeroCapabilities as v}from\"../support/capabilities.js\";import{popupEnabled as b}from\"../support/commonProperties.js\";import{defineFieldProperties as L}from\"../support/fieldProperties.js\";import F from\"../support/FieldsIndex.js\";import{fetchIndexInfo as S}from\"../support/I3SIndexInfo.js\";import{I3SNodePageDefinition as I,I3SMaterialDefinition as O,I3STextureSetDefinition as w,I3SGeometryDefinition as x}from\"../support/I3SLayerDefinitions.js\";import T from\"../../rest/support/Query.js\";import{createPopupTemplate as q}from\"../../support/popupUtils.js\";import P from\"../../symbols/support/ElevationInfo.js\";const D=p.getLogger(\"esri.layers.buildingSublayers.BuildingComponentSublayer\"),Q=L();let R=class extends(a.LoadableMixin(d(j))){constructor(e){super(e),this.type=\"building-component\",this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.fields=null,this.associatedLayer=null,this.outFields=null,this.listMode=\"show\",this.renderer=null,this.definitionExpression=null,this.popupEnabled=!0,this.popupTemplate=null,this.layerType=\"3d-object\"}get parsedUrl(){return this.layer?{path:`${this.layer.parsedUrl.path}/sublayers/${this.id}`,query:this.layer.parsedUrl.query}:null}get fieldsIndex(){return new F(this.fields)}readAssociatedLayer(e,r){const t=this.layer.associatedFeatureServiceItem,o=r.associatedLayerID;return n(t)&&\"number\"==typeof o?new g({portalItem:t,layerId:o}):null}get objectIdField(){if(null!=this.fields)for(const e of this.fields)if(\"oid\"===e.type)return e.name;return null}get displayField(){return n(this.associatedLayer)?this.associatedLayer.displayField:null}get defaultPopupTemplate(){return this.createPopupTemplate()}load(e){const r=n(e)?e.signal:null,t=this._fetchService(r).then((()=>{this.indexInfo=S(this.parsedUrl.path,this.rootNode,this.nodePages,this.apiKey,D,r)}));return this.addResolvingPromise(t),Promise.resolve(this)}createPopupTemplate(e){return q(this,e)}async _fetchService(e){const r=(await o(this.parsedUrl.path,{query:{f:\"json\",token:this.apiKey},responseType:\"json\",signal:e})).data;this.read(r,{origin:\"service\",url:this.parsedUrl})}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,r){var t,o,s,i;const a=null==(t=this.getFeatureType(null==r?void 0:r.feature))||null==(o=t.domains)?void 0:o[e];return a&&\"inherited\"!==a.type?a:null!=(s=null==(i=this.getField(e))?void 0:i.domain)?s:null}getFeatureType(e){return e&&n(this.associatedLayer)?this.associatedLayer.getFeatureType(e):null}get types(){return n(this.associatedLayer)?this.associatedLayer.types:[]}get typeIdField(){return n(this.associatedLayer)?this.associatedLayer.typeIdField:null}get geometryType(){return\"3d-object\"===this.layerType?\"mesh\":\"point\"}get profile(){return\"3d-object\"===this.layerType?\"mesh-pyramids\":\"points\"}get capabilities(){const e=n(this.associatedLayer)&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:v,{query:r,data:{supportsZ:t,supportsM:o,isVersioned:s}}=e;return{query:r,data:{supportsZ:t,supportsM:o,isVersioned:s}}}createQuery(){const e=new T;return\"mesh\"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||\"1=1\",e.sqlFormat=\"standard\",e}queryExtent(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryExtent(e||this.createQuery(),r)))}queryFeatureCount(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryFeatureCount(e||this.createQuery(),r)))}queryFeatures(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryFeatures(e||this.createQuery(),r))).then((e=>{if(null!=e&&e.features)for(const r of e.features)r.layer=this.layer,r.sourceLayer=this;return e}))}queryObjectIds(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryObjectIds(e||this.createQuery(),r)))}getFieldUsageInfo(e){return this.fieldsIndex.has(e)?{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}:{supportsLabelingInfo:!1,supportsRenderer:!0,supportsPopupTemplate:!0,supportsLayerQuery:n(this.associatedLayer)}}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return n(e)&&e.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}async _loadAssociatedLayerForQuery(){if(await this.load(),l(this.associatedLayer))throw new s(\"buildingscenelayer:query-not-available\",\"BuildingSceneLayer component layer queries are not available without an associated feature layer\",{layer:this});try{await this.associatedLayer.load()}catch(e){throw new s(\"buildingscenelayer:query-not-available\",\"BuildingSceneLayer associated feature layer could not be loaded\",{layer:this,error:e})}return this.associatedLayer}};e([y({readOnly:!0})],R.prototype,\"parsedUrl\",null),e([y({type:I,readOnly:!0})],R.prototype,\"nodePages\",void 0),e([y({type:[O],readOnly:!0})],R.prototype,\"materialDefinitions\",void 0),e([y({type:[w],readOnly:!0})],R.prototype,\"textureSetDefinitions\",void 0),e([y({type:[x],readOnly:!0})],R.prototype,\"geometryDefinitions\",void 0),e([y({readOnly:!0})],R.prototype,\"serviceUpdateTimeStamp\",void 0),e([y({readOnly:!0})],R.prototype,\"store\",void 0),e([y({type:String,readOnly:!0,json:{read:{source:\"store.rootNode\"}}})],R.prototype,\"rootNode\",void 0),e([y({readOnly:!0})],R.prototype,\"attributeStorageInfo\",void 0),e([y(Q.fields)],R.prototype,\"fields\",void 0),e([y({readOnly:!0})],R.prototype,\"fieldsIndex\",null),e([y({readOnly:!0,type:g})],R.prototype,\"associatedLayer\",void 0),e([c(\"service\",\"associatedLayer\",[\"associatedLayerID\"])],R.prototype,\"readAssociatedLayer\",null),e([y(Q.outFields)],R.prototype,\"outFields\",void 0),e([y({type:String,readOnly:!0})],R.prototype,\"objectIdField\",null),e([y({readOnly:!0,type:String,json:{read:!1}})],R.prototype,\"displayField\",null),e([y({readOnly:!0,type:String,aliasOf:\"layer.apiKey\"})],R.prototype,\"apiKey\",void 0),e([y({readOnly:!0,type:h,aliasOf:\"layer.fullExtent\"})],R.prototype,\"fullExtent\",void 0),e([y({readOnly:!0,type:f,aliasOf:\"layer.spatialReference\"})],R.prototype,\"spatialReference\",void 0),e([y({readOnly:!0,aliasOf:\"layer.version\"})],R.prototype,\"version\",void 0),e([y({readOnly:!0,type:P,aliasOf:\"layer.elevationInfo\"})],R.prototype,\"elevationInfo\",void 0),e([y({readOnly:!0,type:Number,aliasOf:\"layer.minScale\"})],R.prototype,\"minScale\",void 0),e([y({readOnly:!0,type:Number,aliasOf:\"layer.maxScale\"})],R.prototype,\"maxScale\",void 0),e([y({type:[\"hide\",\"show\"],json:{write:!0}})],R.prototype,\"listMode\",void 0),e([y({types:t,json:{origins:{service:{read:{source:\"drawingInfo.renderer\"}}},name:\"layerDefinition.drawingInfo.renderer\",write:!0},value:null})],R.prototype,\"renderer\",void 0),e([y({type:String,json:{origins:{service:{read:!1,write:!1}},name:\"layerDefinition.definitionExpression\",write:{enabled:!0,allowNull:!0}}})],R.prototype,\"definitionExpression\",void 0),e([y(b)],R.prototype,\"popupEnabled\",void 0),e([y({type:r,json:{read:{source:\"popupInfo\"},write:{target:\"popupInfo\"}}})],R.prototype,\"popupTemplate\",void 0),e([y({readOnly:!0,type:String,json:{origins:{service:{read:{source:\"store.normalReferenceFrame\"}}},read:!1}})],R.prototype,\"normalReferenceFrame\",void 0),e([y({readOnly:!0,json:{read:!1}})],R.prototype,\"defaultPopupTemplate\",null),e([y()],R.prototype,\"types\",null),e([y()],R.prototype,\"typeIdField\",null),e([y({json:{write:!1}}),u(new i({\"3DObject\":\"3d-object\",Point:\"point\"}))],R.prototype,\"layerType\",void 0),e([y()],R.prototype,\"geometryType\",null),e([y()],R.prototype,\"profile\",null),e([y({readOnly:!0,json:{read:!1}})],R.prototype,\"capabilities\",null),R=e([m(\"esri.layers.buildingSublayers.BuildingComponentSublayer\")],R);var E=R;export default E;\n"]},"metadata":{},"sourceType":"module"}