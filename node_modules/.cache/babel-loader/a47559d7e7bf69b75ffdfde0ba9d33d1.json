{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { AnimationTimer as e } from \"../lib/AnimationTimer.js\";\nimport { Material as t } from \"../lib/Material.js\";\nimport { OITPolygonOffsetLimit as i } from \"../lib/OrderIndependentTransparency.js\";\nimport { WaterGLMaterial as a } from \"./WaterGLMaterial.js\";\nimport { WaterTechniqueConfiguration as n } from \"./WaterTechnique.js\";\nimport { DefaultBufferWriter as r, PositionUVLayout as s } from \"./internal/DefaultBufferWriter.js\";\nimport { intersectTriangleGeometry as o } from \"./internal/MaterialUtil.js\";\nimport { defaultWaterMaterialParameters as h } from \"./internal/waterMaterialUtils.js\";\n\nclass c extends t {\n  constructor(t) {\n    super(t, h), this.animation = new e(), this.techniqueConfig = new n();\n  }\n\n  getTechniqueConfig(e, t) {\n    return this.techniqueConfig.output = e, this.techniqueConfig.writeDepth = this.params.writeDepth, this.techniqueConfig.receiveShadows = this.params.receiveShadows, this.techniqueConfig.slicePlaneEnabled = this.params.slicePlaneEnabled, this.techniqueConfig.transparent = this.params.transparent, this.techniqueConfig.useSSR = this.params.ssrEnabled, this.techniqueConfig.isDraped = this.params.isDraped, this.techniqueConfig.transparencyPassType = t ? t.transparencyPassType : 3, this.techniqueConfig.enableOffset = !t || t.camera.relativeElevation < i, this.techniqueConfig.multipassTerrainEnabled = !!t && t.multipassTerrainEnabled, this.techniqueConfig.cullAboveGround = !!t && t.cullAboveGround, this.techniqueConfig;\n  }\n\n  update(e) {\n    const t = Math.min(e.camera.relativeElevation, e.camera.distance);\n    this.animation.enabled = Math.sqrt(this.params.waveTextureRepeat / this.params.waveStrength) * t < u;\n    const i = this.animation.advance(e.dt);\n    return this.animation.enabled && i;\n  }\n\n  intersect(e, t, i, a, n, r, s) {\n    o(e, t, a, n, r, void 0, s);\n  }\n\n  getGLMaterial(e) {\n    if (0 === e.output && this.params.isDraped) {\n      const t = e;\n      return t.output = 5, new a(t);\n    }\n\n    switch (e.output) {\n      case 0:\n      case 2:\n      case 4:\n      case 7:\n        return new a(e);\n    }\n  }\n\n  createBufferWriter() {\n    return new r(s);\n  }\n\n}\n\nconst u = 35e3;\nexport { c as WaterMaterial };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/webgl-engine/materials/WaterMaterial.js"],"names":["AnimationTimer","e","Material","t","OITPolygonOffsetLimit","i","WaterGLMaterial","a","WaterTechniqueConfiguration","n","DefaultBufferWriter","r","PositionUVLayout","s","intersectTriangleGeometry","o","defaultWaterMaterialParameters","h","c","constructor","animation","techniqueConfig","getTechniqueConfig","output","writeDepth","params","receiveShadows","slicePlaneEnabled","transparent","useSSR","ssrEnabled","isDraped","transparencyPassType","enableOffset","camera","relativeElevation","multipassTerrainEnabled","cullAboveGround","update","Math","min","distance","enabled","sqrt","waveTextureRepeat","waveStrength","u","advance","dt","intersect","getGLMaterial","createBufferWriter","WaterMaterial"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{AnimationTimer as e}from\"../lib/AnimationTimer.js\";import{Material as t}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as i}from\"../lib/OrderIndependentTransparency.js\";import{WaterGLMaterial as a}from\"./WaterGLMaterial.js\";import{WaterTechniqueConfiguration as n}from\"./WaterTechnique.js\";import{DefaultBufferWriter as r,PositionUVLayout as s}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as o}from\"./internal/MaterialUtil.js\";import{defaultWaterMaterialParameters as h}from\"./internal/waterMaterialUtils.js\";class c extends t{constructor(t){super(t,h),this.animation=new e,this.techniqueConfig=new n}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.receiveShadows=this.params.receiveShadows,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.useSSR=this.params.ssrEnabled,this.techniqueConfig.isDraped=this.params.isDraped,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<i,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}update(e){const t=Math.min(e.camera.relativeElevation,e.camera.distance);this.animation.enabled=Math.sqrt(this.params.waveTextureRepeat/this.params.waveStrength)*t<u;const i=this.animation.advance(e.dt);return this.animation.enabled&&i}intersect(e,t,i,a,n,r,s){o(e,t,a,n,r,void 0,s)}getGLMaterial(e){if(0===e.output&&this.params.isDraped){const t=e;return t.output=5,new a(t)}switch(e.output){case 0:case 2:case 4:case 7:return new a(e)}}createBufferWriter(){return new r(s)}}const u=35e3;export{c as WaterMaterial};\n"]},"metadata":{},"sourceType":"module"}