{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from \"../../../core/Logger.js\";\nimport { isSome as r, isNone as e } from \"../../../core/maybe.js\";\nimport { f as o } from \"../../../chunks/mat3.js\";\nimport { c as i } from \"../../../chunks/mat3f64.js\";\nimport { i as n, c as s } from \"../../../chunks/mat4.js\";\nimport { c as a } from \"../../../chunks/mat4f64.js\";\nimport { s as c, f, b as l, t as p, m } from \"../../../chunks/vec3.js\";\nimport { c as g, Z as u } from \"../../../chunks/vec3f64.js\";\nimport { projectPointToVector as h, computeLinearTransformation as v } from \"../../projection.js\";\nimport { getSphericalPCPF as j } from \"../../projectionEllipsoid.js\";\nimport { compose as d, create as x, axis as A, angleRad as b } from \"../axisAngleDegrees.js\";\nimport { isGeographicMesh as k } from \"./geographicUtils.js\";\nimport { projectToPCPF as y, projectNormalToPCPF as w, projectTangentToPCPF as R, projectFromPCPF as F, projectNormalFromPCPF as L, projectTangentFromPCPF as $ } from \"./projection.js\";\nconst z = t.getLogger(\"esri.geometry.support.meshUtils.rotate\");\n\nfunction C(t, e, o) {\n  if (!t.vertexAttributes || !t.vertexAttributes.position || 0 === e[3]) return;\n  const i = t.spatialReference;\n\n  if (r(t.transform)) {\n    var n;\n    null != (null == o ? void 0 : o.geographic) && o.geographic !== t.transform.geographic && z.warn(`Specifying the 'geographic' parameter (${o.geographic}) different from the Mesh transform setting (${t.transform.geographic}) is not supported`);\n    const r = null != (n = null == o ? void 0 : o.origin) ? n : t.transform.getOriginPoint(i);\n    I(t.transform, e, r);\n  } else {\n    var s;\n    const r = null != (s = null == o ? void 0 : o.origin) ? s : t.origin;\n    k(t.spatialReference, o) ? U(t, e, r) : D(t, e, r);\n  }\n}\n\nfunction I(t, r, e) {\n  const o = c(M, e.x, e.y, e.z),\n        i = f(M, o, t.origin);\n  t.applyLocalInverse(i, O), t.rotation = d(t.rotation, r, x()), t.applyLocalInverse(i, i), f(i, i, O), t.translation = l(g(), t.translation, i);\n}\n\nfunction U(t, e, i) {\n  const n = t.spatialReference,\n        s = j(n),\n        a = q;\n  h(i, a, s) || h(t.origin, a, s);\n  const c = t.vertexAttributes.position,\n        f = t.vertexAttributes.normal,\n        l = t.vertexAttributes.tangent,\n        m = new Float64Array(c.length),\n        g = r(f) ? new Float32Array(f.length) : null,\n        u = r(l) ? new Float32Array(l.length) : null;\n  v(s, a, S, s), o(Z, S);\n  const d = P;\n  p(A(P), A(e), Z), d[3] = e[3], y(c, n, m), r(f) && w(f, c, m, n, g), r(l) && R(l, c, m, n, u), E(m, d, 3, a), F(m, c, n), r(f) && (E(g, d, 3), L(g, c, m, n, f)), r(l) && (E(u, d, 4), $(u, c, m, n, l)), t.vertexAttributesChanged();\n}\n\nfunction D(t, r, e) {\n  const o = q;\n\n  if (!h(e, o, t.spatialReference)) {\n    const r = t.origin;\n    o[0] = r.x, o[1] = r.y, o[2] = r.z, z.error(`Failed to project specified origin (wkid:${e.spatialReference.wkid}) to mesh spatial reference (wkid:${t.spatialReference.wkid}).`);\n  }\n\n  E(t.vertexAttributes.position, r, 3, o), E(t.vertexAttributes.normal, r, 3), E(t.vertexAttributes.tangent, r, 4), t.vertexAttributesChanged();\n}\n\nfunction E(t, r, o, i = u) {\n  if (!e(t)) {\n    n(S), s(S, S, b(r), A(r));\n\n    for (let r = 0; r < t.length; r += o) {\n      for (let e = 0; e < 3; e++) M[e] = t[r + e] - i[e];\n\n      m(M, M, S);\n\n      for (let e = 0; e < 3; e++) t[r + e] = M[e] + i[e];\n    }\n  }\n}\n\nconst M = g(),\n      O = g(),\n      P = x(),\n      S = a(),\n      Z = i(),\n      q = g();\nexport { C as rotate };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/geometry/support/meshUtils/rotate.js"],"names":["t","isSome","r","isNone","e","f","o","c","i","n","s","a","b","l","p","m","g","Z","u","projectPointToVector","h","computeLinearTransformation","v","getSphericalPCPF","j","compose","d","create","x","axis","A","angleRad","isGeographicMesh","k","projectToPCPF","y","projectNormalToPCPF","w","projectTangentToPCPF","R","projectFromPCPF","F","projectNormalFromPCPF","L","projectTangentFromPCPF","$","z","getLogger","C","vertexAttributes","position","spatialReference","transform","geographic","warn","origin","getOriginPoint","I","U","D","M","applyLocalInverse","O","rotation","translation","q","normal","tangent","Float64Array","length","Float32Array","S","P","E","vertexAttributesChanged","error","wkid","rotate"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from\"../../../core/Logger.js\";import{isSome as r,isNone as e}from\"../../../core/maybe.js\";import{f as o}from\"../../../chunks/mat3.js\";import{c as i}from\"../../../chunks/mat3f64.js\";import{i as n,c as s}from\"../../../chunks/mat4.js\";import{c as a}from\"../../../chunks/mat4f64.js\";import{s as c,f,b as l,t as p,m}from\"../../../chunks/vec3.js\";import{c as g,Z as u}from\"../../../chunks/vec3f64.js\";import{projectPointToVector as h,computeLinearTransformation as v}from\"../../projection.js\";import{getSphericalPCPF as j}from\"../../projectionEllipsoid.js\";import{compose as d,create as x,axis as A,angleRad as b}from\"../axisAngleDegrees.js\";import{isGeographicMesh as k}from\"./geographicUtils.js\";import{projectToPCPF as y,projectNormalToPCPF as w,projectTangentToPCPF as R,projectFromPCPF as F,projectNormalFromPCPF as L,projectTangentFromPCPF as $}from\"./projection.js\";const z=t.getLogger(\"esri.geometry.support.meshUtils.rotate\");function C(t,e,o){if(!t.vertexAttributes||!t.vertexAttributes.position||0===e[3])return;const i=t.spatialReference;if(r(t.transform)){var n;null!=(null==o?void 0:o.geographic)&&o.geographic!==t.transform.geographic&&z.warn(`Specifying the 'geographic' parameter (${o.geographic}) different from the Mesh transform setting (${t.transform.geographic}) is not supported`);const r=null!=(n=null==o?void 0:o.origin)?n:t.transform.getOriginPoint(i);I(t.transform,e,r)}else{var s;const r=null!=(s=null==o?void 0:o.origin)?s:t.origin;k(t.spatialReference,o)?U(t,e,r):D(t,e,r)}}function I(t,r,e){const o=c(M,e.x,e.y,e.z),i=f(M,o,t.origin);t.applyLocalInverse(i,O),t.rotation=d(t.rotation,r,x()),t.applyLocalInverse(i,i),f(i,i,O),t.translation=l(g(),t.translation,i)}function U(t,e,i){const n=t.spatialReference,s=j(n),a=q;h(i,a,s)||h(t.origin,a,s);const c=t.vertexAttributes.position,f=t.vertexAttributes.normal,l=t.vertexAttributes.tangent,m=new Float64Array(c.length),g=r(f)?new Float32Array(f.length):null,u=r(l)?new Float32Array(l.length):null;v(s,a,S,s),o(Z,S);const d=P;p(A(P),A(e),Z),d[3]=e[3],y(c,n,m),r(f)&&w(f,c,m,n,g),r(l)&&R(l,c,m,n,u),E(m,d,3,a),F(m,c,n),r(f)&&(E(g,d,3),L(g,c,m,n,f)),r(l)&&(E(u,d,4),$(u,c,m,n,l)),t.vertexAttributesChanged()}function D(t,r,e){const o=q;if(!h(e,o,t.spatialReference)){const r=t.origin;o[0]=r.x,o[1]=r.y,o[2]=r.z,z.error(`Failed to project specified origin (wkid:${e.spatialReference.wkid}) to mesh spatial reference (wkid:${t.spatialReference.wkid}).`)}E(t.vertexAttributes.position,r,3,o),E(t.vertexAttributes.normal,r,3),E(t.vertexAttributes.tangent,r,4),t.vertexAttributesChanged()}function E(t,r,o,i=u){if(!e(t)){n(S),s(S,S,b(r),A(r));for(let r=0;r<t.length;r+=o){for(let e=0;e<3;e++)M[e]=t[r+e]-i[e];m(M,M,S);for(let e=0;e<3;e++)t[r+e]=M[e]+i[e]}}}const M=g(),O=g(),P=x(),S=a(),Z=i(),q=g();export{C as rotate};\n"]},"metadata":{},"sourceType":"module"}