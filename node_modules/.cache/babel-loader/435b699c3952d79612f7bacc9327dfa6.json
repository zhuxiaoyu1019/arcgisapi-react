{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isExtent as t } from \"../../geometry/support/jsonUtils.js\";\nimport { packFloatRGBA as n } from \"./packingUtils.js\";\nimport o from \"./Rect.js\";\n\nfunction r(t) {\n  if (!t) return null;\n\n  switch (t.type) {\n    case \"CIMPointSymbol\":\n      {\n        const n = t.symbolLayers;\n        return n && 1 === n.length ? r(n[0]) : null;\n      }\n\n    case \"CIMVectorMarker\":\n      {\n        const n = t.markerGraphics;\n        if (!n || 1 !== n.length) return null;\n        const o = n[0];\n        if (!o) return null;\n        const r = o.geometry;\n        if (!r) return null;\n        const l = o.symbol;\n        return !l || \"CIMPolygonSymbol\" !== l.type && \"CIMLineSymbol\" !== l.type ? null : {\n          geom: r,\n          asFill: \"CIMPolygonSymbol\" === l.type\n        };\n      }\n\n    case \"sdf\":\n      return {\n        geom: t.geom,\n        asFill: t.asFill\n      };\n  }\n\n  return null;\n}\n\nfunction l(t) {\n  const n = t.markerGraphics;\n  if (!n || 1 !== n.length) return null;\n  const o = n[0];\n  if (!o) return null;\n  const r = o.symbol;\n  return !r || \"CIMPolygonSymbol\" !== r.type && \"CIMLineSymbol\" !== r.type ? null : r;\n}\n\nfunction e(t) {\n  return t ? t.rings ? t.rings : t.paths ? t.paths : void 0 !== t.xmin && void 0 !== t.ymin && void 0 !== t.xmax && void 0 !== t.ymax ? [[[t.xmin, t.ymin], [t.xmin, t.ymax], [t.xmax, t.ymax], [t.xmax, t.ymin], [t.xmin, t.ymin]]] : null : null;\n}\n\nfunction i(t) {\n  let n = 1 / 0,\n      r = -1 / 0,\n      l = 1 / 0,\n      e = -1 / 0;\n\n  for (const o of t) for (const t of o) t[0] < n && (n = t[0]), t[0] > r && (r = t[0]), t[1] < l && (l = t[1]), t[1] > e && (e = t[1]);\n\n  return new o(n, l, r - n, e - l);\n}\n\nfunction s(t) {\n  let n = 1 / 0,\n      o = -1 / 0,\n      r = 1 / 0,\n      l = -1 / 0;\n\n  for (const e of t) for (const t of e) t[0] < n && (n = t[0]), t[0] > o && (o = t[0]), t[1] < r && (r = t[1]), t[1] > l && (l = t[1]);\n\n  return [n, r, o, l];\n}\n\nfunction f(n) {\n  return n ? n.rings ? s(n.rings) : n.paths ? s(n.paths) : t(n) ? [n.xmin, n.ymin, n.xmax, n.ymax] : null : null;\n}\n\nfunction m(t, n, o, r, l) {\n  const [e, i, s, f] = t;\n  if (s < e || f < i) return [0, 0, 0];\n  const m = s - e,\n        a = f - i,\n        c = 128,\n        u = 1,\n        y = Math.floor(.5 * (.5 * c - u)),\n        h = (c - 2 * (y + u)) / Math.max(m, a),\n        x = Math.round(m * h) + 2 * y,\n        M = Math.round(a * h) + 2 * y;\n  let g = 1;\n\n  if (n) {\n    g = M / h / (n.ymax - n.ymin);\n  }\n\n  let p = 0,\n      d = 0;\n  if (r) if (l) {\n    if (n && o && n.ymax - n.ymin > 0) {\n      const t = (n.xmax - n.xmin) / (n.ymax - n.ymin);\n      p = r.x / (o * t), d = r.y / o;\n    }\n  } else p = r.x, d = r.y;\n  p = .5 * (n.xmax + n.xmin) + p * (n.xmax - n.xmin), d = .5 * (n.ymax + n.ymin) + d * (n.ymax - n.ymin), p -= e, d -= i, p *= h, d *= h, p += y, d += y;\n  return [g, p / x - .5, -(d / M - .5)];\n}\n\nfunction a(t) {\n  const n = e(t.geom),\n        o = i(n),\n        r = 128,\n        l = 1,\n        s = Math.floor(.5 * (.5 * r - l)),\n        f = (r - 2 * (s + l)) / Math.max(o.width, o.height),\n        m = Math.round(o.width * f) + 2 * s,\n        a = Math.round(o.height * f) + 2 * s,\n        h = [];\n\n  for (const e of n) if (e && e.length > 1) {\n    const n = [];\n\n    for (const t of e) {\n      let [r, l] = t;\n      r -= o.x, l -= o.y, r *= f, l *= f, r += s - .5, l += s - .5, n.push([r, l]);\n    }\n\n    if (t.asFill) {\n      const t = n.length - 1;\n      n[0][0] === n[t][0] && n[0][1] === n[t][1] || n.push(n[0]);\n    }\n\n    h.push(n);\n  }\n\n  const x = c(h, m, a, s);\n  return t.asFill && u(h, m, a, s, x), [y(x, s), m, a];\n}\n\nfunction c(t, n, o, r) {\n  const l = n * o,\n        e = new Array(l),\n        i = r * r + 1;\n\n  for (let s = 0; s < l; ++s) e[s] = i;\n\n  for (const s of t) {\n    const t = s.length;\n\n    for (let l = 1; l < t; ++l) {\n      const t = s[l - 1],\n            i = s[l];\n      let f, m, a, c;\n      t[0] < i[0] ? (f = t[0], m = i[0]) : (f = i[0], m = t[0]), t[1] < i[1] ? (a = t[1], c = i[1]) : (a = i[1], c = t[1]);\n      let u = Math.floor(f) - r,\n          y = Math.floor(m) + r,\n          h = Math.floor(a) - r,\n          x = Math.floor(c) + r;\n      u < 0 && (u = 0), y > n && (y = n), h < 0 && (h = 0), x > o && (x = o);\n      const M = i[0] - t[0],\n            g = i[1] - t[1],\n            p = M * M + g * g;\n\n      for (let r = u; r < y; r++) for (let l = h; l < x; l++) {\n        let s,\n            f,\n            m = (r - t[0]) * M + (l - t[1]) * g;\n        m < 0 ? (s = t[0], f = t[1]) : m > p ? (s = i[0], f = i[1]) : (m /= p, s = t[0] + m * M, f = t[1] + m * g);\n        const a = (r - s) * (r - s) + (l - f) * (l - f),\n              c = (o - l - 1) * n + r;\n        a < e[c] && (e[c] = a);\n      }\n    }\n  }\n\n  for (let s = 0; s < l; ++s) e[s] = Math.sqrt(e[s]);\n\n  return e;\n}\n\nfunction u(t, n, o, r, l) {\n  for (const e of t) {\n    const t = e.length;\n\n    for (let i = 1; i < t; ++i) {\n      const t = e[i - 1],\n            s = e[i];\n      let f, m, a, c;\n      t[0] < s[0] ? (f = t[0], m = s[0]) : (f = s[0], m = t[0]), t[1] < s[1] ? (a = t[1], c = s[1]) : (a = s[1], c = t[1]);\n      let u = Math.floor(f),\n          y = Math.floor(m) + 1,\n          h = Math.floor(a),\n          x = Math.floor(c) + 1;\n      u < r && (u = r), y > n - r && (y = n - r), h < r && (h = r), x > o - r && (x = o - r);\n\n      for (let e = h; e < x; ++e) {\n        if (t[1] > e == s[1] > e) continue;\n        const i = (o - e - 1) * n;\n\n        for (let n = u; n < y; ++n) n < (s[0] - t[0]) * (e - t[1]) / (s[1] - t[1]) + t[0] && (l[i + n] = -l[i + n]);\n\n        for (let t = r; t < u; ++t) l[i + t] = -l[i + t];\n      }\n    }\n  }\n}\n\nfunction y(t, o) {\n  const r = 2 * o,\n        l = t.length,\n        e = new Uint8Array(4 * l);\n\n  for (let i = 0; i < l; ++i) {\n    const o = .5 - t[i] / r;\n    n(o, e, 4 * i);\n  }\n\n  return e;\n}\n\nexport { a as buildSDF, f as getExtent, r as getSDFInfo, m as getSDFMetrics, l as getSDFSymbol };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/symbols/cim/SDFHelper.js"],"names":["isExtent","t","packFloatRGBA","n","o","r","type","symbolLayers","length","markerGraphics","geometry","l","symbol","geom","asFill","e","rings","paths","xmin","ymin","xmax","ymax","i","s","f","m","a","c","u","y","Math","floor","h","max","x","round","M","g","p","d","width","height","push","Array","sqrt","Uint8Array","buildSDF","getExtent","getSDFInfo","getSDFMetrics","getSDFSymbol"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isExtent as t}from\"../../geometry/support/jsonUtils.js\";import{packFloatRGBA as n}from\"./packingUtils.js\";import o from\"./Rect.js\";function r(t){if(!t)return null;switch(t.type){case\"CIMPointSymbol\":{const n=t.symbolLayers;return n&&1===n.length?r(n[0]):null}case\"CIMVectorMarker\":{const n=t.markerGraphics;if(!n||1!==n.length)return null;const o=n[0];if(!o)return null;const r=o.geometry;if(!r)return null;const l=o.symbol;return!l||\"CIMPolygonSymbol\"!==l.type&&\"CIMLineSymbol\"!==l.type?null:{geom:r,asFill:\"CIMPolygonSymbol\"===l.type}}case\"sdf\":return{geom:t.geom,asFill:t.asFill}}return null}function l(t){const n=t.markerGraphics;if(!n||1!==n.length)return null;const o=n[0];if(!o)return null;const r=o.symbol;return!r||\"CIMPolygonSymbol\"!==r.type&&\"CIMLineSymbol\"!==r.type?null:r}function e(t){return t?t.rings?t.rings:t.paths?t.paths:void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:null:null}function i(t){let n=1/0,r=-1/0,l=1/0,e=-1/0;for(const o of t)for(const t of o)t[0]<n&&(n=t[0]),t[0]>r&&(r=t[0]),t[1]<l&&(l=t[1]),t[1]>e&&(e=t[1]);return new o(n,l,r-n,e-l)}function s(t){let n=1/0,o=-1/0,r=1/0,l=-1/0;for(const e of t)for(const t of e)t[0]<n&&(n=t[0]),t[0]>o&&(o=t[0]),t[1]<r&&(r=t[1]),t[1]>l&&(l=t[1]);return[n,r,o,l]}function f(n){return n?n.rings?s(n.rings):n.paths?s(n.paths):t(n)?[n.xmin,n.ymin,n.xmax,n.ymax]:null:null}function m(t,n,o,r,l){const[e,i,s,f]=t;if(s<e||f<i)return[0,0,0];const m=s-e,a=f-i,c=128,u=1,y=Math.floor(.5*(.5*c-u)),h=(c-2*(y+u))/Math.max(m,a),x=Math.round(m*h)+2*y,M=Math.round(a*h)+2*y;let g=1;if(n){g=M/h/(n.ymax-n.ymin)}let p=0,d=0;if(r)if(l){if(n&&o&&n.ymax-n.ymin>0){const t=(n.xmax-n.xmin)/(n.ymax-n.ymin);p=r.x/(o*t),d=r.y/o}}else p=r.x,d=r.y;p=.5*(n.xmax+n.xmin)+p*(n.xmax-n.xmin),d=.5*(n.ymax+n.ymin)+d*(n.ymax-n.ymin),p-=e,d-=i,p*=h,d*=h,p+=y,d+=y;return[g,p/x-.5,-(d/M-.5)]}function a(t){const n=e(t.geom),o=i(n),r=128,l=1,s=Math.floor(.5*(.5*r-l)),f=(r-2*(s+l))/Math.max(o.width,o.height),m=Math.round(o.width*f)+2*s,a=Math.round(o.height*f)+2*s,h=[];for(const e of n)if(e&&e.length>1){const n=[];for(const t of e){let[r,l]=t;r-=o.x,l-=o.y,r*=f,l*=f,r+=s-.5,l+=s-.5,n.push([r,l])}if(t.asFill){const t=n.length-1;n[0][0]===n[t][0]&&n[0][1]===n[t][1]||n.push(n[0])}h.push(n)}const x=c(h,m,a,s);return t.asFill&&u(h,m,a,s,x),[y(x,s),m,a]}function c(t,n,o,r){const l=n*o,e=new Array(l),i=r*r+1;for(let s=0;s<l;++s)e[s]=i;for(const s of t){const t=s.length;for(let l=1;l<t;++l){const t=s[l-1],i=s[l];let f,m,a,c;t[0]<i[0]?(f=t[0],m=i[0]):(f=i[0],m=t[0]),t[1]<i[1]?(a=t[1],c=i[1]):(a=i[1],c=t[1]);let u=Math.floor(f)-r,y=Math.floor(m)+r,h=Math.floor(a)-r,x=Math.floor(c)+r;u<0&&(u=0),y>n&&(y=n),h<0&&(h=0),x>o&&(x=o);const M=i[0]-t[0],g=i[1]-t[1],p=M*M+g*g;for(let r=u;r<y;r++)for(let l=h;l<x;l++){let s,f,m=(r-t[0])*M+(l-t[1])*g;m<0?(s=t[0],f=t[1]):m>p?(s=i[0],f=i[1]):(m/=p,s=t[0]+m*M,f=t[1]+m*g);const a=(r-s)*(r-s)+(l-f)*(l-f),c=(o-l-1)*n+r;a<e[c]&&(e[c]=a)}}}for(let s=0;s<l;++s)e[s]=Math.sqrt(e[s]);return e}function u(t,n,o,r,l){for(const e of t){const t=e.length;for(let i=1;i<t;++i){const t=e[i-1],s=e[i];let f,m,a,c;t[0]<s[0]?(f=t[0],m=s[0]):(f=s[0],m=t[0]),t[1]<s[1]?(a=t[1],c=s[1]):(a=s[1],c=t[1]);let u=Math.floor(f),y=Math.floor(m)+1,h=Math.floor(a),x=Math.floor(c)+1;u<r&&(u=r),y>n-r&&(y=n-r),h<r&&(h=r),x>o-r&&(x=o-r);for(let e=h;e<x;++e){if(t[1]>e==s[1]>e)continue;const i=(o-e-1)*n;for(let n=u;n<y;++n)n<(s[0]-t[0])*(e-t[1])/(s[1]-t[1])+t[0]&&(l[i+n]=-l[i+n]);for(let t=r;t<u;++t)l[i+t]=-l[i+t]}}}}function y(t,o){const r=2*o,l=t.length,e=new Uint8Array(4*l);for(let i=0;i<l;++i){const o=.5-t[i]/r;n(o,e,4*i)}return e}export{a as buildSDF,f as getExtent,r as getSDFInfo,m as getSDFMetrics,l as getSDFSymbol};\n"]},"metadata":{},"sourceType":"module"}