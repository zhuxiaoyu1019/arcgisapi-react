{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../Color.js\";\nimport { toCIMSymbolJSON as t, isCIMMarker as o, isCIMStroke as a, isCIMFill as r, isCIMMarkerStrokePlacement as c, fromCIMColor as s } from \"../cim/utils.js\";\n\nfunction n(e) {\n  const c = t(e);\n  if (\"CIMTextSymbol\" === c.type) return c.height;\n  let s = 0;\n  if (c.symbolLayers) for (const t of c.symbolLayers) o(t) && t.size > s ? s = t.size : a(t) && t.width > s ? s = t.width : r(t);\n  return s;\n}\n\nfunction i(e, o, a) {\n  const r = t(e),\n        c = n(e);\n  if (0 === c) return void l(r, o);\n  f(r, o / c, !1, a);\n}\n\nfunction l(e, t) {\n  if (\"CIMTextSymbol\" !== e.type) {\n    if (e.symbolLayers) for (const o of e.symbolLayers) switch (o.type) {\n      case \"CIMPictureMarker\":\n      case \"CIMVectorMarker\":\n        o.size = t;\n        break;\n\n      case \"CIMPictureStroke\":\n      case \"CIMSolidStroke\":\n        o.width = t;\n    }\n  } else e.height = t;\n}\n\nfunction f(e, t, o, a) {\n  if (\"CIMTextSymbol\" !== e.type) {\n    if (o && e.effects) for (const o of e.effects) y(o, t);\n    if (e.symbolLayers) for (const o of e.symbolLayers) switch (o.type) {\n      case \"CIMPictureMarker\":\n      case \"CIMVectorMarker\":\n        m(o, t, a);\n        break;\n\n      case \"CIMPictureStroke\":\n      case \"CIMSolidStroke\":\n        null != a && a.preserveOutlineWidth || (o.width *= t);\n        break;\n\n      case \"CIMPictureFill\":\n        o.height *= t, o.offsetX *= t, o.offsetY *= t;\n        break;\n\n      case \"CIMHatchFill\":\n        f(o.lineSymbol, t, !0, { ...a,\n          preserveOutlineWidth: !1\n        }), o.offsetX *= t, o.offsetY *= t, o.separation *= t;\n    }\n  } else e.height *= t;\n}\n\nfunction m(e, t, o) {\n  if (e.markerPlacement && M(e.markerPlacement, t), e.offsetX *= t, e.offsetY *= t, e.anchorPoint && \"Absolute\" === e.anchorPointUnits && (e.anchorPoint = {\n    x: e.anchorPoint.x * t,\n    y: e.anchorPoint.y * t\n  }), e.size *= t, \"CIMVectorMarker\" === e.type && e.markerGraphics) for (const a of e.markerGraphics) e.scaleSymbolsProportionally || f(a.symbol, t, !0, o);\n}\n\nfunction M(e, t) {\n  switch (c(e) && (e.offset *= t), e.type) {\n    case \"CIMMarkerPlacementAlongLineRandomSize\":\n    case \"CIMMarkerPlacementAlongLineSameSize\":\n      if (e.customEndingOffset *= t, e.offsetAlongLine *= t, e.placementTemplate && e.placementTemplate.length) {\n        const o = e.placementTemplate.map(e => e * t);\n        e.placementTemplate = o;\n      }\n\n      break;\n\n    case \"CIMMarkerPlacementAlongLineVariableSize\":\n      if (e.maxRandomOffset *= t, e.placementTemplate && e.placementTemplate.length) {\n        const o = e.placementTemplate.map(e => e * t);\n        e.placementTemplate = o;\n      }\n\n      break;\n\n    case \"CIMMarkerPlacementOnLine\":\n      e.startPointOffset *= t;\n      break;\n\n    case \"CIMMarkerPlacementAtExtremities\":\n      e.offsetAlongLine *= t;\n      break;\n\n    case \"CIMMarkerPlacementAtMeasuredUnits\":\n    case \"CIMMarkerPlacementOnVertices\":\n      break;\n\n    case \"CIMMarkerPlacementAtRatioPositions\":\n      e.beginPosition *= t, e.endPosition *= t;\n      break;\n\n    case \"CIMMarkerPlacementPolygonCenter\":\n      e.offsetX *= t, e.offsetY *= t;\n      break;\n\n    case \"CIMMarkerPlacementInsidePolygon\":\n      e.offsetX *= t, e.offsetY *= t, e.stepX *= t, e.stepY *= t;\n  }\n}\n\nfunction y(e, t) {\n  switch (e.type) {\n    case \"CIMGeometricEffectArrow\":\n    case \"CIMGeometricEffectDonut\":\n      e.width *= t;\n      break;\n\n    case \"CIMGeometricEffectBuffer\":\n      e.size *= t;\n      break;\n\n    case \"CIMGeometricEffectCut\":\n      e.beginCut *= t, e.endCut *= t, e.middleCut *= t;\n      break;\n\n    case \"CIMGeometricEffectDashes\":\n      if (e.customEndingOffset *= t, e.offsetAlongLine *= t, e.dashTemplate && e.dashTemplate.length) {\n        const o = e.dashTemplate.map(e => e * t);\n        e.dashTemplate = o;\n      }\n\n      break;\n\n    case \"CIMGeometricEffectExtension\":\n    case \"CIMGeometricEffectJog\":\n    case \"CIMGeometricEffectRadial\":\n      e.length *= t;\n      break;\n\n    case \"CIMGeometricEffectMove\":\n      e.offsetX *= t, e.offsetY *= t;\n      break;\n\n    case \"CIMGeometricEffectOffset\":\n    case \"CIMGeometricEffectOffsetTangent\":\n      e.offset *= t;\n      break;\n\n    case \"CIMGeometricEffectRegularPolygon\":\n      e.radius *= t;\n      break;\n\n    case \"CIMGeometricEffectTaperedPolygon\":\n      e.fromWidth *= t, e.length *= t, e.toWidth *= t;\n      break;\n\n    case \"CIMGeometricEffectWave\":\n      e.amplitude *= t, e.period *= t;\n  }\n}\n\nfunction C(o) {\n  const a = [];\n  return k(t(o), a), a.length ? new e(s(a[0])) : null;\n}\n\nfunction k(e, t) {\n  let r;\n  r = \"CIMTextSymbol\" === e.type ? e.symbol : e;\n  const s = \"CIMPolygonSymbol\" === e.type;\n  if (r.symbolLayers) for (const n of r.symbolLayers) if (!(n.colorLocked || s && (a(n) || o(n) && n.markerPlacement && c(n.markerPlacement)))) switch (n.type) {\n    case \"CIMPictureMarker\":\n    case \"CIMPictureStroke\":\n    case \"CIMPictureFill\":\n      break;\n\n    case \"CIMVectorMarker\":\n      n.markerGraphics.forEach(e => {\n        k(e.symbol, t);\n      });\n      break;\n\n    case \"CIMSolidStroke\":\n    case \"CIMSolidFill\":\n      b(t, n.color);\n      break;\n\n    case \"CIMHatchFill\":\n      k(n.lineSymbol, t);\n  }\n}\n\nfunction b(e, t) {\n  for (const o of e) if (o.join(\".\") === t.join(\".\")) return;\n\n  e.push(t);\n}\n\nfunction I(o, a) {\n  a instanceof e || (a = new e(a));\n  p(t(o), a);\n}\n\nfunction p(e, t) {\n  let r;\n  r = \"CIMTextSymbol\" === e.type ? e.symbol : e;\n  const s = \"CIMPolygonSymbol\" === e.type;\n  if (r.symbolLayers) for (const n of r.symbolLayers) {\n    if (n.colorLocked) continue;\n    if (s && (a(n) || o(n) && n.markerPlacement && c(n.markerPlacement))) continue;\n    const e = t.toArray(0);\n\n    switch (n.type) {\n      case \"CIMPictureMarker\":\n      case \"CIMPictureStroke\":\n      case \"CIMPictureFill\":\n        break;\n\n      case \"CIMVectorMarker\":\n        n.markerGraphics.forEach(e => {\n          p(e.symbol, t);\n        });\n        break;\n\n      case \"CIMSolidStroke\":\n      case \"CIMSolidFill\":\n        n.color = e;\n        break;\n\n      case \"CIMHatchFill\":\n        p(n.lineSymbol, t);\n    }\n  }\n}\n\nfunction u(e, o = !1) {\n  const a = t(e);\n  return \"CIMTextSymbol\" === a.type || \"CIMPointSymbol\" === a.type ? o && 0 !== a.angle ? 360 - a.angle : a.angle || 0 : 0;\n}\n\nfunction h(e, a, r = !1) {\n  const c = t(e);\n\n  if (r && 0 !== a && (a = 360 - a), \"CIMTextSymbol\" !== c.type) {\n    if (\"CIMPointSymbol\" === c.type && c.symbolLayers) {\n      const e = a - (c.angle || 0);\n\n      for (const t of c.symbolLayers) if (o(t)) {\n        let o = t.rotation || 0;\n        t.rotateClockwise ? o -= e : o += e, t.rotation = o;\n      }\n\n      c.angle = a;\n    }\n  } else c.angle = a;\n}\n\nexport { I as applyCIMSymbolColor, h as applyCIMSymbolRotation, C as getCIMSymbolColor, u as getCIMSymbolRotation, n as getCIMSymbolSize, m as scaleCIMMarker, i as scaleCIMSymbolTo };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/symbols/support/cimSymbolUtils.js"],"names":["e","toCIMSymbolJSON","t","isCIMMarker","o","isCIMStroke","a","isCIMFill","r","isCIMMarkerStrokePlacement","c","fromCIMColor","s","n","type","height","symbolLayers","size","width","i","l","f","effects","y","m","preserveOutlineWidth","offsetX","offsetY","lineSymbol","separation","markerPlacement","M","anchorPoint","anchorPointUnits","x","markerGraphics","scaleSymbolsProportionally","symbol","offset","customEndingOffset","offsetAlongLine","placementTemplate","length","map","maxRandomOffset","startPointOffset","beginPosition","endPosition","stepX","stepY","beginCut","endCut","middleCut","dashTemplate","radius","fromWidth","toWidth","amplitude","period","C","k","colorLocked","forEach","b","color","join","push","I","p","toArray","u","angle","h","rotation","rotateClockwise","applyCIMSymbolColor","applyCIMSymbolRotation","getCIMSymbolColor","getCIMSymbolRotation","getCIMSymbolSize","scaleCIMMarker","scaleCIMSymbolTo"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../Color.js\";import{toCIMSymbolJSON as t,isCIMMarker as o,isCIMStroke as a,isCIMFill as r,isCIMMarkerStrokePlacement as c,fromCIMColor as s}from\"../cim/utils.js\";function n(e){const c=t(e);if(\"CIMTextSymbol\"===c.type)return c.height;let s=0;if(c.symbolLayers)for(const t of c.symbolLayers)o(t)&&t.size>s?s=t.size:a(t)&&t.width>s?s=t.width:r(t);return s}function i(e,o,a){const r=t(e),c=n(e);if(0===c)return void l(r,o);f(r,o/c,!1,a)}function l(e,t){if(\"CIMTextSymbol\"!==e.type){if(e.symbolLayers)for(const o of e.symbolLayers)switch(o.type){case\"CIMPictureMarker\":case\"CIMVectorMarker\":o.size=t;break;case\"CIMPictureStroke\":case\"CIMSolidStroke\":o.width=t}}else e.height=t}function f(e,t,o,a){if(\"CIMTextSymbol\"!==e.type){if(o&&e.effects)for(const o of e.effects)y(o,t);if(e.symbolLayers)for(const o of e.symbolLayers)switch(o.type){case\"CIMPictureMarker\":case\"CIMVectorMarker\":m(o,t,a);break;case\"CIMPictureStroke\":case\"CIMSolidStroke\":null!=a&&a.preserveOutlineWidth||(o.width*=t);break;case\"CIMPictureFill\":o.height*=t,o.offsetX*=t,o.offsetY*=t;break;case\"CIMHatchFill\":f(o.lineSymbol,t,!0,{...a,preserveOutlineWidth:!1}),o.offsetX*=t,o.offsetY*=t,o.separation*=t}}else e.height*=t}function m(e,t,o){if(e.markerPlacement&&M(e.markerPlacement,t),e.offsetX*=t,e.offsetY*=t,e.anchorPoint&&\"Absolute\"===e.anchorPointUnits&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size*=t,\"CIMVectorMarker\"===e.type&&e.markerGraphics)for(const a of e.markerGraphics)e.scaleSymbolsProportionally||f(a.symbol,t,!0,o)}function M(e,t){switch(c(e)&&(e.offset*=t),e.type){case\"CIMMarkerPlacementAlongLineRandomSize\":case\"CIMMarkerPlacementAlongLineSameSize\":if(e.customEndingOffset*=t,e.offsetAlongLine*=t,e.placementTemplate&&e.placementTemplate.length){const o=e.placementTemplate.map((e=>e*t));e.placementTemplate=o}break;case\"CIMMarkerPlacementAlongLineVariableSize\":if(e.maxRandomOffset*=t,e.placementTemplate&&e.placementTemplate.length){const o=e.placementTemplate.map((e=>e*t));e.placementTemplate=o}break;case\"CIMMarkerPlacementOnLine\":e.startPointOffset*=t;break;case\"CIMMarkerPlacementAtExtremities\":e.offsetAlongLine*=t;break;case\"CIMMarkerPlacementAtMeasuredUnits\":case\"CIMMarkerPlacementOnVertices\":break;case\"CIMMarkerPlacementAtRatioPositions\":e.beginPosition*=t,e.endPosition*=t;break;case\"CIMMarkerPlacementPolygonCenter\":e.offsetX*=t,e.offsetY*=t;break;case\"CIMMarkerPlacementInsidePolygon\":e.offsetX*=t,e.offsetY*=t,e.stepX*=t,e.stepY*=t}}function y(e,t){switch(e.type){case\"CIMGeometricEffectArrow\":case\"CIMGeometricEffectDonut\":e.width*=t;break;case\"CIMGeometricEffectBuffer\":e.size*=t;break;case\"CIMGeometricEffectCut\":e.beginCut*=t,e.endCut*=t,e.middleCut*=t;break;case\"CIMGeometricEffectDashes\":if(e.customEndingOffset*=t,e.offsetAlongLine*=t,e.dashTemplate&&e.dashTemplate.length){const o=e.dashTemplate.map((e=>e*t));e.dashTemplate=o}break;case\"CIMGeometricEffectExtension\":case\"CIMGeometricEffectJog\":case\"CIMGeometricEffectRadial\":e.length*=t;break;case\"CIMGeometricEffectMove\":e.offsetX*=t,e.offsetY*=t;break;case\"CIMGeometricEffectOffset\":case\"CIMGeometricEffectOffsetTangent\":e.offset*=t;break;case\"CIMGeometricEffectRegularPolygon\":e.radius*=t;break;case\"CIMGeometricEffectTaperedPolygon\":e.fromWidth*=t,e.length*=t,e.toWidth*=t;break;case\"CIMGeometricEffectWave\":e.amplitude*=t,e.period*=t}}function C(o){const a=[];return k(t(o),a),a.length?new e(s(a[0])):null}function k(e,t){let r;r=\"CIMTextSymbol\"===e.type?e.symbol:e;const s=\"CIMPolygonSymbol\"===e.type;if(r.symbolLayers)for(const n of r.symbolLayers)if(!(n.colorLocked||s&&(a(n)||o(n)&&n.markerPlacement&&c(n.markerPlacement))))switch(n.type){case\"CIMPictureMarker\":case\"CIMPictureStroke\":case\"CIMPictureFill\":break;case\"CIMVectorMarker\":n.markerGraphics.forEach((e=>{k(e.symbol,t)}));break;case\"CIMSolidStroke\":case\"CIMSolidFill\":b(t,n.color);break;case\"CIMHatchFill\":k(n.lineSymbol,t)}}function b(e,t){for(const o of e)if(o.join(\".\")===t.join(\".\"))return;e.push(t)}function I(o,a){a instanceof e||(a=new e(a));p(t(o),a)}function p(e,t){let r;r=\"CIMTextSymbol\"===e.type?e.symbol:e;const s=\"CIMPolygonSymbol\"===e.type;if(r.symbolLayers)for(const n of r.symbolLayers){if(n.colorLocked)continue;if(s&&(a(n)||o(n)&&n.markerPlacement&&c(n.markerPlacement)))continue;const e=t.toArray(0);switch(n.type){case\"CIMPictureMarker\":case\"CIMPictureStroke\":case\"CIMPictureFill\":break;case\"CIMVectorMarker\":n.markerGraphics.forEach((e=>{p(e.symbol,t)}));break;case\"CIMSolidStroke\":case\"CIMSolidFill\":n.color=e;break;case\"CIMHatchFill\":p(n.lineSymbol,t)}}}function u(e,o=!1){const a=t(e);return\"CIMTextSymbol\"===a.type||\"CIMPointSymbol\"===a.type?o&&0!==a.angle?360-a.angle:a.angle||0:0}function h(e,a,r=!1){const c=t(e);if(r&&0!==a&&(a=360-a),\"CIMTextSymbol\"!==c.type){if(\"CIMPointSymbol\"===c.type&&c.symbolLayers){const e=a-(c.angle||0);for(const t of c.symbolLayers)if(o(t)){let o=t.rotation||0;t.rotateClockwise?o-=e:o+=e,t.rotation=o}c.angle=a}}else c.angle=a}export{I as applyCIMSymbolColor,h as applyCIMSymbolRotation,C as getCIMSymbolColor,u as getCIMSymbolRotation,n as getCIMSymbolSize,m as scaleCIMMarker,i as scaleCIMSymbolTo};\n"]},"metadata":{},"sourceType":"module"}