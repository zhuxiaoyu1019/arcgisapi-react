{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport { getAssetUrl as t } from \"../../assets.js\";\nimport r from \"../../config.js\";\nimport s from \"../../Graphic.js\";\nimport o from \"../../PopupTemplate.js\";\nimport i from \"../../core/Accessor.js\";\nimport l from \"../../core/Collection.js\";\nimport a from \"../../core/Error.js\";\nimport n from \"../../core/Evented.js\";\nimport u from \"../../core/Handles.js\";\nimport c from \"../../core/has.js\";\nimport h from \"../../core/Logger.js\";\nimport { unwrap as p, isSome as d, get as g } from \"../../core/maybe.js\";\nimport { eachAlways as m, after as y, createAbortController as f } from \"../../core/promiseUtils.js\";\nimport { on as S, init as v, whenFalseOnce as _, whenOnce as b } from \"../../core/watchUtils.js\";\nimport { property as w } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport { subclass as x } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport I from \"../../geometry/Point.js\";\nimport j from \"../../geometry/SpatialReference.js\";\nimport { onLocaleChange as T } from \"../../intl/locale.js\";\nimport { fetchMessageBundle as P } from \"../../intl/messages.js\";\nimport R from \"../../portal/Portal.js\";\nimport { g as L } from \"../../chunks/location.js\";\nimport E from \"../../symbols/PictureMarkerSymbol.js\";\nimport C from \"../../symbols/SimpleFillSymbol.js\";\nimport F from \"../../symbols/SimpleLineSymbol.js\";\nimport O from \"../../symbols/SimpleMarkerSymbol.js\";\nimport G from \"../../symbols/TextSymbol.js\";\nimport { highlightsSupported as A } from \"../../views/support/layerViewUtils.js\";\nimport D from \"./LayerSearchSource.js\";\nimport N from \"./LocatorSearchSource.js\";\nimport M from \"./SearchSource.js\";\nimport { getPointFromGeometry as k, getPointWithElevation as V } from \"./support/geometryUtils.js\";\nimport { isArcGISWorldGeocoder as B, meteredArcGISLocatorUrl as J, isProxiedArcGISWorldGeocoder as U, isMeteredArcGISWorldGeocoder as H } from \"./support/locatorUtils.js\";\nimport { supported as z, getCurrentPosition as Q, positionToPoint as Z } from \"../support/geolocationUtils.js\";\nimport { GoToMixin as q } from \"../support/GoTo.js\";\n\nfunction K(e, t) {\n  return e.hasOwnProperty(t) && null != e[t] && \"\" !== e[t];\n}\n\nconst W = () => P(\"esri/widgets/Search/t9n/Search\"),\n      X = \"esri.widgets.Search.SearchViewModel\",\n      Y = h.getLogger(X),\n      $ = \"highlight\",\n      ee = l.ofType({\n  key: e => e.layer ? \"layer\" : \"locator\",\n  base: M,\n  typeMap: {\n    layer: D,\n    locator: N\n  }\n}),\n      te = j.WGS84,\n      re = \"esri/images/search/search-symbol-32.svg\",\n      se = \"esri/images/search/search-symbol-32.png\",\n      oe = /<(?:.|\\s)*?>/g,\n      ie = -1;\n\nlet le = class extends q(n.EventedMixin(i)) {\n  constructor(e) {\n    super(e), this._handles = new u(), this._gotoController = null, this._searching = null, this.autoNavigate = !0, this.autoSelect = !0, this.defaultPopupTemplate = null, this.defaultSources = new ee(), this.defaultSymbol = new E({\n      url: t(c(\"trident\") ? se : re),\n      size: 24,\n      width: 24,\n      height: 24\n    }), this.includeDefaultSources = !0, this.maxInputLength = 128, this.maxResults = 6, this.maxSuggestions = 6, this.messages = null, this.minSuggestCharacters = 1, this.popupEnabled = !0, this.popupTemplate = null, this.portal = R.getDefault(), this.resultCount = null, this.resultGraphicEnabled = !0, this.resultGraphic = null, this.results = null, this.selectedSuggestion = null, this.searchAllEnabled = !0, this.selectedResult = null, this.sources = new ee(), this.suggestionDelay = 150, this.suggestionCount = null, this.suggestions = null, this.suggestionsEnabled = !0, this.view = null;\n  }\n\n  initialize() {\n    const e = async () => {\n      const e = await W();\n      this.messages = e, this.defaultPopupTemplate = new o({\n        title: e.searchResult,\n        content: \"{Match_addr}\"\n      });\n    };\n\n    e(), this._handles.add([S(this, [\"defaultSources\", \"sources\"], \"change\", () => this.notifyChange(\"allSources\")), v(this, [\"includeDefaultSources\", \"view\", \"portal\"], () => this._update()), T(e)]);\n  }\n\n  destroy() {\n    this._abortGoTo(), this.clearGraphics(), this._handles.destroy(), this._handles = null;\n  }\n\n  get activeSource() {\n    return this.allSources.getItemAt(this.activeSourceIndex) || null;\n  }\n\n  get activeSourceIndex() {\n    return 1 === this.allSources.length || !this.searchAllEnabled ? 0 : ie;\n  }\n\n  set activeSourceIndex(e) {\n    void 0 !== e ? this._override(\"activeSourceIndex\", e) : this._clearOverride(\"activeSourceIndex\");\n  }\n\n  get allPlaceholder() {\n    var e;\n    return null == (e = this.messages) ? void 0 : e.allPlaceholder;\n  }\n\n  set allPlaceholder(e) {\n    e ? this._override(\"allPlaceholder\", e) : this._clearOverride(\"allPlaceholder\");\n  }\n\n  get allSources() {\n    const {\n      sources: e,\n      defaultSources: t,\n      includeDefaultSources: r\n    } = this,\n          s = \"function\" == typeof r ? r.call(null, {\n      sources: e,\n      defaultSources: t\n    }) : r ? t.concat(e) : e,\n          o = this._get(\"allSources\") || new ee();\n    return o.removeAll(), o.addMany(s.filter(Boolean)), o;\n  }\n\n  get locationEnabled() {\n    return this._get(\"locationEnabled\") || z();\n  }\n\n  set locationEnabled(e) {\n    if (void 0 === e) return void this._clearOverride(\"locationEnabled\");\n    const t = z();\n\n    if (e && !t) {\n      const e = new a(\"locationEnabled:geolocation-unsupported\", \"Geolocation API is unsupported.\", {\n        geolocation: navigator.geolocation\n      });\n      Y.error(e);\n    }\n\n    this._override(\"locationEnabled\", e && t);\n  }\n\n  get placeholder() {\n    const {\n      allSources: e,\n      activeSourceIndex: t,\n      allPlaceholder: r\n    } = this;\n    if (t === ie) return r;\n    const s = e.getItemAt(t);\n    return s ? s.placeholder : \"\";\n  }\n\n  set searchTerm(e) {\n    this._set(\"searchTerm\", e || \"\"), this.clearGraphics(), this.selectedSuggestion && this.selectedSuggestion.text !== e && this._set(\"selectedSuggestion\", null), \"\" === e && this._clear();\n  }\n\n  get searchTerm() {\n    return this._get(\"searchTerm\") || \"\";\n  }\n\n  get state() {\n    return this._searching ? \"searching\" : this.updating ? \"loading\" : 0 === this.allSources.length ? \"disabled\" : \"ready\";\n  }\n\n  get updating() {\n    return null != this._updatingPromise;\n  }\n\n  clear() {\n    this.searchTerm = \"\";\n  }\n\n  clearGraphics() {\n    this._removeHighlight(), this._closePopup(), this.view && this.view.graphics.remove(this.resultGraphic), this._set(\"resultGraphic\", null);\n  }\n\n  search(e, t) {\n    this.emit(\"search-start\"), this.clearGraphics();\n\n    const r = this._createSuggestionForSearch(e),\n          s = this.when().then(() => this._getResultsFromSources(r, t).then(e => {\n      var s;\n      if (null != (s = p(null == t ? void 0 : t.signal)) && s.aborted) return null;\n      const o = {\n        activeSourceIndex: this.activeSourceIndex,\n        searchTerm: r.text,\n        numResults: 0,\n        numErrors: 0,\n        errors: [],\n        results: []\n      };\n\n      this._formatResponse(o, e, r);\n\n      const i = this._getFirstResult(o.results),\n            l = (r.location && i ? i.name : r.text).replace(oe, \"\");\n\n      return this._set(\"searchTerm\", l), (r.key && \"number\" == typeof r.sourceIndex || r.location) && this._set(\"selectedSuggestion\", r), this._set(\"results\", o.results), this._set(\"resultCount\", o.results.reduce((e, t) => e + t.results.length, 0)), this.emit(\"search-complete\", o), this._selectFirstResult(i).then(() => o);\n    })).then(e => (this._clearSearching(), e), e => {\n      throw this._clearSearching(), e;\n    });\n\n    return this._searching = s, this.notifyChange(\"state\"), s;\n  }\n\n  searchNearby(e) {\n    if (!this.locationEnabled) {\n      const e = new a(\"searchNearby:geolocation-unsupported\", \"Geolocation API is unsupported.\", {\n        geolocation: navigator.geolocation\n      });\n      return Y.error(e), Promise.reject(e);\n    }\n\n    const t = Q().then(t => Z({\n      position: t,\n      view: this.view\n    }, e)).then(t => this.search(t, e));\n    return this._searching = t, this.notifyChange(\"state\"), t.catch(() => {}).then(() => this._clearSearching()), t;\n  }\n\n  select(e) {\n    if (this.clearGraphics(), !e) {\n      const t = new a(\"select:missing-parameter\", \"Cannot select without a searchResult.\", {\n        searchResult: e\n      });\n      return Y.error(t), Promise.reject(t);\n    }\n\n    const {\n      view: t\n    } = this,\n          r = K(e, \"sourceIndex\") ? e.sourceIndex : this._getSourceIndexOfResult(e),\n          o = this.allSources.getItemAt(r);\n\n    if (!o) {\n      const e = new a(\"select:missing-source\", \"Cannot select without a source.\", {\n        source: o\n      });\n      return Y.error(e), Promise.reject(e);\n    }\n\n    const i = o instanceof D ? this._getLayerSourcePopupTemplate(o) : o.popupTemplate,\n          l = o.resultSymbol || this._getDefaultSymbol(e),\n          n = K(o, \"resultGraphicEnabled\") ? o.resultGraphicEnabled : this.resultGraphicEnabled,\n          u = K(o, \"autoNavigate\") ? o.autoNavigate : this.autoNavigate,\n          c = K(o, \"popupEnabled\") ? o.popupEnabled : this.popupEnabled,\n          h = c ? i || this.popupTemplate || this.defaultPopupTemplate : null,\n          {\n      feature: p\n    } = e;\n\n    if (!p) {\n      const e = new a(\"select:missing-feature\", \"Cannot select without a feature.\", {\n        feature: p\n      });\n      return Y.error(e), Promise.reject(e);\n    }\n\n    const {\n      attributes: g,\n      geometry: y,\n      layer: f,\n      sourceLayer: S\n    } = p,\n          v = k(y),\n          _ = {\n      layerViewQuery: this._getLayerView(p),\n      elevationQuery: t && d(v) ? V(v, t).catch(() => v) : Promise.resolve(v)\n    };\n    return m(_).then(i => {\n      const a = i.layerViewQuery.value,\n            m = i.elevationQuery.value;\n      l instanceof G && (l.text = e.name);\n      const v = t && u ? e.target || e.extent : null;\n      return (d(v) ? this._goToSearchResult(v) : Promise.resolve()).then(() => {\n        var i;\n        const u = a ? p : new s({\n          geometry: y,\n          symbol: l,\n          attributes: g,\n          layer: f,\n          sourceLayer: S,\n          popupTemplate: h\n        }),\n              d = c && (null == (i = this.view) ? void 0 : i.popup),\n              v = d && u.getEffectivePopupTemplate(d.defaultPopupTemplateEnabled);\n        return v && t.popup.open({\n          features: [u],\n          location: m\n        }), a && A(a) && !v && this._highlightFeature({\n          graphic: u,\n          layerView: a\n        }), !a && n && t && t.graphics.push(u), this._set(\"selectedResult\", e), this._set(\"resultGraphic\", u), this.emit(\"select-result\", {\n          result: e,\n          source: o,\n          sourceIndex: r\n        }), e;\n      });\n    });\n  }\n\n  suggest(e, t, r) {\n    const s = e || this.searchTerm;\n    return this.emit(\"suggest-start\", {\n      searchTerm: s\n    }), this._suggestTimer(t, r).then(() => this._suggestImmediate(s, r).then(e => (this._set(\"suggestions\", e.results), this._set(\"suggestionCount\", e.results.reduce((e, t) => e + t.results.length, 0)), this.emit(\"suggest-complete\", e), e)));\n  }\n\n  async when() {\n    await _(this, \"updating\");\n  }\n\n  async _update() {\n    const {\n      portal: e,\n      view: t\n    } = this;\n\n    if (this.includeDefaultSources) {\n      const r = this._updatingPromise = m([null == e ? void 0 : e.load(), null == t ? void 0 : t.when()]);\n      if (this.destroyed) return;\n      if (this.notifyChange(\"updating\"), await r, r !== this._updatingPromise) return;\n    }\n\n    this._updatingPromise = null, this.notifyChange(\"updating\");\n    const r = b(this, \"messages\");\n    this.destroyed || (this._handles.add(r), await r, this._updateDefaultSources());\n  }\n\n  _clearSearching() {\n    this._searching = null, this.notifyChange(\"state\");\n  }\n\n  _convertHelperServices() {\n    var e, t;\n    const s = null == (e = this.portal) || null == (t = e.helperServices) ? void 0 : t.geocode;\n    if (!s) return [];\n    return s.map(e => {\n      var t;\n      if (!1 === e.placefinding) return;\n      const s = r.apiKey && B(e.url) ? {\n        url: J\n      } : null,\n            o = N.fromJSON({ ...e,\n        ...s\n      }),\n            i = null == (t = o.locator) ? void 0 : t.url;\n\n      if (B(i) || U(i) || H(i)) {\n        const e = o.outFields || [\"Addr_type\", \"Match_addr\", \"StAddr\", \"City\"],\n              t = o.placeholder || this.messages.placeholder,\n              r = \"number\" == typeof o.defaultZoomScale ? o.defaultZoomScale : 2500;\n        o.set({\n          singleLineFieldName: \"SingleLine\",\n          outFields: e,\n          placeholder: t,\n          defaultZoomScale: r\n        });\n      }\n\n      return o.singleLineFieldName ? o : void 0;\n    }).filter(Boolean);\n  }\n\n  _getLayerSources(e, t) {\n    var r;\n    const s = null == (r = this.view) ? void 0 : r.map;\n    return e.map(e => {\n      const r = s.findLayerById(e.id);\n      if (!r) return;\n\n      const o = this._getLayerJSON(e),\n            i = D.fromJSON(o);\n\n      return i.placeholder = t, this._getLayer(r, o).then(e => {\n        i.layer = e;\n      }), i;\n    }).filter(Boolean).toArray();\n  }\n\n  _getTableSources(e, t) {\n    var r;\n    const s = null == (r = this.view) ? void 0 : r.map;\n    return e.map(e => {\n      const r = s.findTableById(e.id);\n      if (!r) return;\n\n      const o = this._getLayerJSON(e),\n            i = D.fromJSON(o);\n\n      return i.placeholder = t, this._getLayer(r, o).then(e => {\n        i.layer = e;\n      }), i;\n    }).filter(Boolean).toArray();\n  }\n\n  _convertApplicationProperties() {\n    var e, t, r;\n    const s = null == (e = this.view) ? void 0 : e.map,\n          o = null == s || null == (t = s.applicationProperties) || null == (r = t.viewing) ? void 0 : r.search;\n    if (!o) return [];\n    const {\n      enabled: i,\n      hintText: l,\n      layers: a,\n      tables: n\n    } = o;\n    if (!i) return [];\n    return [...this._getLayerSources(a, l), ...this._getTableSources(n, l)];\n  }\n\n  _getSubLayer(e, t) {\n    return e.load().then(() => {\n      if (!e.allSublayers) return Promise.reject();\n      const r = e.allSublayers.find(e => e.id === t.subLayer);\n      return r ? r.createFeatureLayer() : Promise.reject();\n    });\n  }\n\n  async _getBuildingSubLayer(e, t) {\n    await e.load();\n    const r = e.allSublayers.find(e => e.id === t.subLayer);\n    return \"building-component\" !== (null == r ? void 0 : r.type) ? Promise.reject() : (await r.load(), null == r.associatedLayer ? Promise.reject() : (await r.associatedLayer.load(), r));\n  }\n\n  _getLayer(e, t) {\n    return \"feature\" === e.type || \"scene\" === e.type || \"csv\" === e.type || \"geojson\" === e.type || \"ogc-feature\" === e.type ? Promise.resolve(e) : \"map-image\" === e.type ? this._getSubLayer(e, t).catch(() => {\n      const t = new a(\"search:create-featurelayer\", \"Could not create a FeatureLayer from the MapImageLayer\", {\n        layer: e\n      });\n      return Y.error(t), null;\n    }) : \"building-scene\" === e.type ? this._getBuildingSubLayer(e, t) : Promise.resolve(null);\n  }\n\n  _getLayerJSON(e) {\n    return \"function\" == typeof e.toJSON ? e.toJSON() : e;\n  }\n\n  _updateDefaultSources() {\n    const {\n      defaultSources: e,\n      includeDefaultSources: t\n    } = this;\n    e.removeAll(), t && e.addMany([...this._convertApplicationProperties(), ...this._convertHelperServices()]), this.notifyChange(\"allSources\");\n  }\n\n  _abortGoTo() {\n    this._gotoController && this._gotoController.abort(), this._gotoController = null;\n  }\n\n  _clear() {\n    this._abortGoTo(), this._set(\"resultCount\", null), this._set(\"results\", null), this._set(\"suggestions\", null), this._set(\"suggestionCount\", null), this._set(\"selectedResult\", null), this._set(\"selectedSuggestion\", null), this.emit(\"search-clear\");\n  }\n\n  _closePopup() {\n    var e;\n    const t = null == (e = this.view) ? void 0 : e.popup,\n          {\n      resultGraphic: r\n    } = this;\n    if (!t || !r) return;\n    const {\n      selectedFeature: s\n    } = t;\n    s && s === r && t.close();\n  }\n\n  _suggestTimer(e, t) {\n    const r = null != e ? e : this.suggestionDelay;\n    return y(r, null, t && t.signal);\n  }\n\n  _createLocationForSearch(e) {\n    return e instanceof s ? k(e.geometry) : e instanceof I ? e : Array.isArray(e) && 2 === e.length ? new I({\n      longitude: e[0],\n      latitude: e[1]\n    }) : null;\n  }\n\n  _createSuggestionForSearch(e) {\n    if (e && K(e, \"key\") && K(e, \"text\") && K(e, \"sourceIndex\")) return e;\n\n    const t = this._createLocationForSearch(e),\n          r = \"string\" == typeof e ? e : this.searchTerm,\n          {\n      selectedSuggestion: s,\n      selectedResult: o\n    } = this,\n          i = !e && s && o,\n          l = i && s.key === o.key && s.sourceIndex === o.sourceIndex,\n          a = i && s.location;\n\n    return l || a ? s : {\n      location: p(t),\n      text: t ? \"\" : r,\n      sourceIndex: null,\n      key: null\n    };\n  }\n\n  _getFirstResult(e) {\n    let t = null;\n    return e && e.some(e => {\n      const {\n        results: r\n      } = e,\n            s = r[0],\n            o = !!s;\n      return o && (t = s), o;\n    }), t;\n  }\n\n  _selectFirstResult(e) {\n    return this.autoSelect && e ? this.select(e) : Promise.resolve(null);\n  }\n\n  _suggestImmediate(e, t) {\n    return this.when().then(() => this._getSuggestionsFromSources(e, t)).then(r => {\n      var s;\n      if (null != (s = p(null == t ? void 0 : t.signal)) && s.aborted) return null;\n      const o = {\n        activeSourceIndex: this.activeSourceIndex,\n        searchTerm: e,\n        numResults: 0,\n        numErrors: 0,\n        errors: [],\n        results: []\n      };\n      return this._formatResponse(o, r), o;\n    });\n  }\n\n  _formatSourceResponse(e, t, r) {\n    const s = t && t.value || [],\n          o = t && t.error,\n          i = this.allSources.getItemAt(r);\n\n    if (o) {\n      const t = {\n        sourceIndex: r,\n        source: i,\n        error: o\n      };\n      e.errors.push(t), Y.error(o), e.numErrors++;\n    } else {\n      const t = {\n        sourceIndex: r,\n        source: i,\n        results: s\n      };\n      e.results.push(t), e.numResults += s.length;\n    }\n  }\n\n  _formatResponse(e, t, r) {\n    if (t) if (e.activeSourceIndex === ie) {\n      const s = r && K(r, \"sourceIndex\") && -1 !== r.sourceIndex ? r.sourceIndex : void 0;\n      t.forEach((t, r) => {\n        const o = void 0 !== s ? s : r;\n\n        this._formatSourceResponse(e, t, o);\n      });\n    } else this._formatSourceResponse(e, t[0], e.activeSourceIndex);\n  }\n\n  _getResultsFromSources(e, t) {\n    const {\n      allSources: r\n    } = this,\n          s = !e.location && K(e, \"sourceIndex\") ? e.sourceIndex : this.activeSourceIndex,\n          o = [];\n\n    if (!r.length) {\n      const e = new a(\"search:no-sources-defined\", \"At least one source is required.\", {\n        allSources: r\n      });\n      return Y.error(e), Promise.reject(e);\n    }\n\n    return s === ie ? r.forEach((r, s) => {\n      o.push(this._getResultsFromSource(e, s, t));\n    }) : o.push(this._getResultsFromSource(e, s, t)), m(o);\n  }\n\n  _getSuggestionsFromSources(e, t) {\n    const {\n      allSources: r,\n      activeSourceIndex: s\n    } = this,\n          o = [];\n\n    if (!r.length) {\n      const e = new a(\"suggest:no-sources-defined\", \"At least one source is required.\", {\n        allSources: r\n      });\n      return Y.error(e), Promise.reject(e);\n    }\n\n    return s === ie ? r.forEach((r, s) => {\n      o.push(this._getSuggestionsFromSource(e, s, t));\n    }) : o.push(this._getSuggestionsFromSource(e, s, t)), m(o);\n  }\n\n  _getResultsFromSource(e, t, r) {\n    var s;\n    const o = this.allSources.getItemAt(t),\n          {\n      location: i = null\n    } = e,\n          l = (null == (s = this.view) ? void 0 : s.spatialReference) || te,\n          a = K(o, \"maxResults\") ? o.maxResults : this.maxResults,\n          n = !!(o instanceof D && K(o, \"exactMatch\")) && o.exactMatch,\n          {\n      view: u\n    } = this;\n    return o.getResults({\n      view: u,\n      sourceIndex: t,\n      location: i,\n      suggestResult: e,\n      spatialReference: l,\n      exactMatch: n,\n      maxResults: a\n    }, r);\n  }\n\n  _getSuggestionsFromSource(e, t, r) {\n    const s = this.allSources.getItemAt(t),\n          o = K(s, \"suggestionsEnabled\") ? s.suggestionsEnabled : this.suggestionsEnabled,\n          i = e.length,\n          l = K(s, \"minSuggestCharacters\") ? s.minSuggestCharacters : this.minSuggestCharacters;\n\n    if (o && e.trim() && i >= l) {\n      var a;\n      const o = (null == (a = this.view) ? void 0 : a.spatialReference) || te,\n            i = K(s, \"maxSuggestions\") ? s.maxSuggestions : this.maxSuggestions,\n            {\n        view: l\n      } = this;\n      return s.getSuggestions({\n        view: l,\n        sourceIndex: t,\n        suggestTerm: e,\n        spatialReference: o,\n        maxSuggestions: i\n      }, r);\n    }\n\n    return Promise.resolve(null);\n  }\n\n  createDefaultSymbol(e, t) {\n    if (\"point\" === t) {\n      const t = e;\n      return new O({\n        color: e.color,\n        size: t.size,\n        outline: {\n          color: t.outline.color,\n          width: t.outline.width\n        }\n      });\n    }\n\n    if (\"polyline\" === t) {\n      const t = e;\n      return new F({\n        color: t.color,\n        width: t.width\n      });\n    }\n\n    if (\"polygon\" === t) {\n      const t = e;\n      return new C({\n        color: t.color,\n        outline: {\n          color: t.outline.color,\n          width: t.outline.width\n        }\n      });\n    }\n  }\n\n  _getLayerSourcePopupTemplate(e) {\n    const {\n      layer: t\n    } = e;\n    if (t) return K(e, \"popupTemplate\") ? e.popupTemplate : t.popupTemplate;\n  }\n\n  _getSourceIndexOfResult(e) {\n    const t = this.results;\n    let r = null;\n    return t.some(t => t.results.some(s => s === e && (r = t.sourceIndex, !0))), r;\n  }\n\n  async _goToSearchResult(e) {\n    const t = !!e;\n\n    this._abortGoTo();\n\n    const r = f();\n    this._gotoController = r;\n    const s = {\n      target: {\n        target: e\n      },\n      options: {\n        animate: t,\n        signal: r.signal\n      }\n    };\n    await this.callGoTo(s), this._gotoController = null;\n  }\n\n  _getDefaultSymbol(e) {\n    var t, r, s;\n    const o = null == (t = this.view) || null == (r = t.map) || null == (s = r.basemap) ? void 0 : s.id,\n          i = g(e, \"feature\", \"geometry\", \"type\");\n\n    if (d(i)) {\n      const e = L({\n        basemap: o,\n        geometryType: i\n      }) || L({\n        basemap: \"topo\",\n        geometryType: i\n      }),\n            t = e && e.primaryScheme;\n      if (t) return t.color && K(t, \"opacity\") && (t.color.a = t.opacity), this.createDefaultSymbol(t, i);\n    }\n\n    return this.defaultSymbol;\n  }\n\n  _removeHighlight() {\n    this._handles.remove($);\n  }\n\n  async _getLayerView(e) {\n    const {\n      view: t\n    } = this;\n    if (!e || !t || \"building-component\" === e.layer.type || \"subtype-sublayer\" === e.layer.type) return Promise.resolve(null);\n    const {\n      layer: r\n    } = e;\n    return await t.when(), t.whenLayerView(r);\n  }\n\n  _highlightFeature(e) {\n    const {\n      graphic: t,\n      layerView: r\n    } = e,\n          {\n      attributes: s,\n      layer: o\n    } = t,\n          {\n      objectIdField: i\n    } = o,\n          l = s && s[i],\n          a = r.highlight(l || t);\n\n    this._handles.add(a, $);\n  }\n\n};\nle.ALL_INDEX = ie, e([w({\n  readOnly: !0,\n  value: null\n})], le.prototype, \"activeSource\", null), e([w()], le.prototype, \"activeSourceIndex\", null), e([w()], le.prototype, \"allPlaceholder\", null), e([w({\n  readOnly: !0,\n  dependsOn: [\"defaultSources.length\", \"sources.length\", \"includeDefaultSources\"]\n})], le.prototype, \"allSources\", null), e([w()], le.prototype, \"autoNavigate\", void 0), e([w()], le.prototype, \"autoSelect\", void 0), e([w()], le.prototype, \"defaultPopupTemplate\", void 0), e([w({\n  readOnly: !0\n})], le.prototype, \"defaultSources\", void 0), e([w()], le.prototype, \"defaultSymbol\", void 0), e([w()], le.prototype, \"includeDefaultSources\", void 0), e([w()], le.prototype, \"locationEnabled\", null), e([w()], le.prototype, \"maxInputLength\", void 0), e([w()], le.prototype, \"maxResults\", void 0), e([w()], le.prototype, \"maxSuggestions\", void 0), e([w()], le.prototype, \"messages\", void 0), e([w()], le.prototype, \"minSuggestCharacters\", void 0), e([w({\n  readOnly: !0\n})], le.prototype, \"placeholder\", null), e([w()], le.prototype, \"popupEnabled\", void 0), e([w({\n  type: o\n})], le.prototype, \"popupTemplate\", void 0), e([w({\n  type: R\n})], le.prototype, \"portal\", void 0), e([w()], le.prototype, \"resultCount\", void 0), e([w()], le.prototype, \"resultGraphicEnabled\", void 0), e([w({\n  readOnly: !0\n})], le.prototype, \"resultGraphic\", void 0), e([w({\n  readOnly: !0\n})], le.prototype, \"results\", void 0), e([w({\n  readOnly: !0\n})], le.prototype, \"selectedSuggestion\", void 0), e([w()], le.prototype, \"searchAllEnabled\", void 0), e([w({\n  readOnly: !0\n})], le.prototype, \"selectedResult\", void 0), e([w()], le.prototype, \"searchTerm\", null), e([w({\n  type: ee\n})], le.prototype, \"sources\", void 0), e([w({\n  readOnly: !0,\n  dependsOn: [\"allSources.length\", \"updating\"]\n})], le.prototype, \"state\", null), e([w()], le.prototype, \"suggestionDelay\", void 0), e([w()], le.prototype, \"suggestionCount\", void 0), e([w({\n  readOnly: !0\n})], le.prototype, \"suggestions\", void 0), e([w()], le.prototype, \"suggestionsEnabled\", void 0), e([w({\n  readOnly: !0\n})], le.prototype, \"updating\", null), e([w()], le.prototype, \"view\", void 0), e([w()], le.prototype, \"clear\", null), le = e([x(X)], le);\nvar ae = le;\nexport default ae;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/widgets/Search/SearchViewModel.js"],"names":["_","e","getAssetUrl","t","r","s","o","i","l","a","n","u","c","h","unwrap","p","isSome","d","get","g","eachAlways","m","after","y","createAbortController","f","on","S","init","v","whenFalseOnce","whenOnce","b","property","w","subclass","x","I","j","onLocaleChange","T","fetchMessageBundle","P","R","L","E","C","F","O","G","highlightsSupported","A","D","N","M","getPointFromGeometry","k","getPointWithElevation","V","isArcGISWorldGeocoder","B","meteredArcGISLocatorUrl","J","isProxiedArcGISWorldGeocoder","U","isMeteredArcGISWorldGeocoder","H","supported","z","getCurrentPosition","Q","positionToPoint","Z","GoToMixin","q","K","hasOwnProperty","W","X","Y","getLogger","$","ee","ofType","key","layer","base","typeMap","locator","te","WGS84","re","se","oe","ie","le","EventedMixin","constructor","_handles","_gotoController","_searching","autoNavigate","autoSelect","defaultPopupTemplate","defaultSources","defaultSymbol","url","size","width","height","includeDefaultSources","maxInputLength","maxResults","maxSuggestions","messages","minSuggestCharacters","popupEnabled","popupTemplate","portal","getDefault","resultCount","resultGraphicEnabled","resultGraphic","results","selectedSuggestion","searchAllEnabled","selectedResult","sources","suggestionDelay","suggestionCount","suggestions","suggestionsEnabled","view","initialize","title","searchResult","content","add","notifyChange","_update","destroy","_abortGoTo","clearGraphics","activeSource","allSources","getItemAt","activeSourceIndex","length","_override","_clearOverride","allPlaceholder","call","concat","_get","removeAll","addMany","filter","Boolean","locationEnabled","geolocation","navigator","error","placeholder","searchTerm","_set","text","_clear","state","updating","_updatingPromise","clear","_removeHighlight","_closePopup","graphics","remove","search","emit","_createSuggestionForSearch","when","then","_getResultsFromSources","signal","aborted","numResults","numErrors","errors","_formatResponse","_getFirstResult","location","name","replace","sourceIndex","reduce","_selectFirstResult","_clearSearching","searchNearby","Promise","reject","position","catch","select","_getSourceIndexOfResult","source","_getLayerSourcePopupTemplate","resultSymbol","_getDefaultSymbol","feature","attributes","geometry","sourceLayer","layerViewQuery","_getLayerView","elevationQuery","resolve","value","target","extent","_goToSearchResult","symbol","popup","getEffectivePopupTemplate","defaultPopupTemplateEnabled","open","features","_highlightFeature","graphic","layerView","push","result","suggest","_suggestTimer","_suggestImmediate","load","destroyed","_updateDefaultSources","_convertHelperServices","helperServices","geocode","map","placefinding","apiKey","fromJSON","outFields","defaultZoomScale","set","singleLineFieldName","_getLayerSources","findLayerById","id","_getLayerJSON","_getLayer","toArray","_getTableSources","findTableById","_convertApplicationProperties","applicationProperties","viewing","enabled","hintText","layers","tables","_getSubLayer","allSublayers","find","subLayer","createFeatureLayer","_getBuildingSubLayer","type","associatedLayer","toJSON","abort","selectedFeature","close","_createLocationForSearch","Array","isArray","longitude","latitude","some","_getSuggestionsFromSources","_formatSourceResponse","forEach","_getResultsFromSource","_getSuggestionsFromSource","spatialReference","exactMatch","getResults","suggestResult","trim","getSuggestions","suggestTerm","createDefaultSymbol","color","outline","options","animate","callGoTo","basemap","geometryType","primaryScheme","opacity","whenLayerView","objectIdField","highlight","ALL_INDEX","readOnly","prototype","dependsOn","ae"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{getAssetUrl as t}from\"../../assets.js\";import r from\"../../config.js\";import s from\"../../Graphic.js\";import o from\"../../PopupTemplate.js\";import i from\"../../core/Accessor.js\";import l from\"../../core/Collection.js\";import a from\"../../core/Error.js\";import n from\"../../core/Evented.js\";import u from\"../../core/Handles.js\";import c from\"../../core/has.js\";import h from\"../../core/Logger.js\";import{unwrap as p,isSome as d,get as g}from\"../../core/maybe.js\";import{eachAlways as m,after as y,createAbortController as f}from\"../../core/promiseUtils.js\";import{on as S,init as v,whenFalseOnce as _,whenOnce as b}from\"../../core/watchUtils.js\";import{property as w}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as x}from\"../../core/accessorSupport/decorators/subclass.js\";import I from\"../../geometry/Point.js\";import j from\"../../geometry/SpatialReference.js\";import{onLocaleChange as T}from\"../../intl/locale.js\";import{fetchMessageBundle as P}from\"../../intl/messages.js\";import R from\"../../portal/Portal.js\";import{g as L}from\"../../chunks/location.js\";import E from\"../../symbols/PictureMarkerSymbol.js\";import C from\"../../symbols/SimpleFillSymbol.js\";import F from\"../../symbols/SimpleLineSymbol.js\";import O from\"../../symbols/SimpleMarkerSymbol.js\";import G from\"../../symbols/TextSymbol.js\";import{highlightsSupported as A}from\"../../views/support/layerViewUtils.js\";import D from\"./LayerSearchSource.js\";import N from\"./LocatorSearchSource.js\";import M from\"./SearchSource.js\";import{getPointFromGeometry as k,getPointWithElevation as V}from\"./support/geometryUtils.js\";import{isArcGISWorldGeocoder as B,meteredArcGISLocatorUrl as J,isProxiedArcGISWorldGeocoder as U,isMeteredArcGISWorldGeocoder as H}from\"./support/locatorUtils.js\";import{supported as z,getCurrentPosition as Q,positionToPoint as Z}from\"../support/geolocationUtils.js\";import{GoToMixin as q}from\"../support/GoTo.js\";function K(e,t){return e.hasOwnProperty(t)&&null!=e[t]&&\"\"!==e[t]}const W=()=>P(\"esri/widgets/Search/t9n/Search\"),X=\"esri.widgets.Search.SearchViewModel\",Y=h.getLogger(X),$=\"highlight\",ee=l.ofType({key:e=>e.layer?\"layer\":\"locator\",base:M,typeMap:{layer:D,locator:N}}),te=j.WGS84,re=\"esri/images/search/search-symbol-32.svg\",se=\"esri/images/search/search-symbol-32.png\",oe=/<(?:.|\\s)*?>/g,ie=-1;let le=class extends(q(n.EventedMixin(i))){constructor(e){super(e),this._handles=new u,this._gotoController=null,this._searching=null,this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new ee,this.defaultSymbol=new E({url:t(c(\"trident\")?se:re),size:24,width:24,height:24}),this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=1,this.popupEnabled=!0,this.popupTemplate=null,this.portal=R.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new ee,this.suggestionDelay=150,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){const e=async()=>{const e=await W();this.messages=e,this.defaultPopupTemplate=new o({title:e.searchResult,content:\"{Match_addr}\"})};e(),this._handles.add([S(this,[\"defaultSources\",\"sources\"],\"change\",(()=>this.notifyChange(\"allSources\"))),v(this,[\"includeDefaultSources\",\"view\",\"portal\"],(()=>this._update())),T(e)])}destroy(){this._abortGoTo(),this.clearGraphics(),this._handles.destroy(),this._handles=null}get activeSource(){return this.allSources.getItemAt(this.activeSourceIndex)||null}get activeSourceIndex(){return 1===this.allSources.length||!this.searchAllEnabled?0:ie}set activeSourceIndex(e){void 0!==e?this._override(\"activeSourceIndex\",e):this._clearOverride(\"activeSourceIndex\")}get allPlaceholder(){var e;return null==(e=this.messages)?void 0:e.allPlaceholder}set allPlaceholder(e){e?this._override(\"allPlaceholder\",e):this._clearOverride(\"allPlaceholder\")}get allSources(){const{sources:e,defaultSources:t,includeDefaultSources:r}=this,s=\"function\"==typeof r?r.call(null,{sources:e,defaultSources:t}):r?t.concat(e):e,o=this._get(\"allSources\")||new ee;return o.removeAll(),o.addMany(s.filter(Boolean)),o}get locationEnabled(){return this._get(\"locationEnabled\")||z()}set locationEnabled(e){if(void 0===e)return void this._clearOverride(\"locationEnabled\");const t=z();if(e&&!t){const e=new a(\"locationEnabled:geolocation-unsupported\",\"Geolocation API is unsupported.\",{geolocation:navigator.geolocation});Y.error(e)}this._override(\"locationEnabled\",e&&t)}get placeholder(){const{allSources:e,activeSourceIndex:t,allPlaceholder:r}=this;if(t===ie)return r;const s=e.getItemAt(t);return s?s.placeholder:\"\"}set searchTerm(e){this._set(\"searchTerm\",e||\"\"),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set(\"selectedSuggestion\",null),\"\"===e&&this._clear()}get searchTerm(){return this._get(\"searchTerm\")||\"\"}get state(){return this._searching?\"searching\":this.updating?\"loading\":0===this.allSources.length?\"disabled\":\"ready\"}get updating(){return null!=this._updatingPromise}clear(){this.searchTerm=\"\"}clearGraphics(){this._removeHighlight(),this._closePopup(),this.view&&this.view.graphics.remove(this.resultGraphic),this._set(\"resultGraphic\",null)}search(e,t){this.emit(\"search-start\"),this.clearGraphics();const r=this._createSuggestionForSearch(e),s=this.when().then((()=>this._getResultsFromSources(r,t).then((e=>{var s;if(null!=(s=p(null==t?void 0:t.signal))&&s.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:r.text,numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(o,e,r);const i=this._getFirstResult(o.results),l=(r.location&&i?i.name:r.text).replace(oe,\"\");return this._set(\"searchTerm\",l),(r.key&&\"number\"==typeof r.sourceIndex||r.location)&&this._set(\"selectedSuggestion\",r),this._set(\"results\",o.results),this._set(\"resultCount\",o.results.reduce(((e,t)=>e+t.results.length),0)),this.emit(\"search-complete\",o),this._selectFirstResult(i).then((()=>o))})))).then((e=>(this._clearSearching(),e)),(e=>{throw this._clearSearching(),e}));return this._searching=s,this.notifyChange(\"state\"),s}searchNearby(e){if(!this.locationEnabled){const e=new a(\"searchNearby:geolocation-unsupported\",\"Geolocation API is unsupported.\",{geolocation:navigator.geolocation});return Y.error(e),Promise.reject(e)}const t=Q().then((t=>Z({position:t,view:this.view},e))).then((t=>this.search(t,e)));return this._searching=t,this.notifyChange(\"state\"),t.catch((()=>{})).then((()=>this._clearSearching())),t}select(e){if(this.clearGraphics(),!e){const t=new a(\"select:missing-parameter\",\"Cannot select without a searchResult.\",{searchResult:e});return Y.error(t),Promise.reject(t)}const{view:t}=this,r=K(e,\"sourceIndex\")?e.sourceIndex:this._getSourceIndexOfResult(e),o=this.allSources.getItemAt(r);if(!o){const e=new a(\"select:missing-source\",\"Cannot select without a source.\",{source:o});return Y.error(e),Promise.reject(e)}const i=o instanceof D?this._getLayerSourcePopupTemplate(o):o.popupTemplate,l=o.resultSymbol||this._getDefaultSymbol(e),n=K(o,\"resultGraphicEnabled\")?o.resultGraphicEnabled:this.resultGraphicEnabled,u=K(o,\"autoNavigate\")?o.autoNavigate:this.autoNavigate,c=K(o,\"popupEnabled\")?o.popupEnabled:this.popupEnabled,h=c?i||this.popupTemplate||this.defaultPopupTemplate:null,{feature:p}=e;if(!p){const e=new a(\"select:missing-feature\",\"Cannot select without a feature.\",{feature:p});return Y.error(e),Promise.reject(e)}const{attributes:g,geometry:y,layer:f,sourceLayer:S}=p,v=k(y),_={layerViewQuery:this._getLayerView(p),elevationQuery:t&&d(v)?V(v,t).catch((()=>v)):Promise.resolve(v)};return m(_).then((i=>{const a=i.layerViewQuery.value,m=i.elevationQuery.value;l instanceof G&&(l.text=e.name);const v=t&&u?e.target||e.extent:null;return(d(v)?this._goToSearchResult(v):Promise.resolve()).then((()=>{var i;const u=a?p:new s({geometry:y,symbol:l,attributes:g,layer:f,sourceLayer:S,popupTemplate:h}),d=c&&(null==(i=this.view)?void 0:i.popup),v=d&&u.getEffectivePopupTemplate(d.defaultPopupTemplateEnabled);return v&&t.popup.open({features:[u],location:m}),a&&A(a)&&!v&&this._highlightFeature({graphic:u,layerView:a}),!a&&n&&t&&t.graphics.push(u),this._set(\"selectedResult\",e),this._set(\"resultGraphic\",u),this.emit(\"select-result\",{result:e,source:o,sourceIndex:r}),e}))}))}suggest(e,t,r){const s=e||this.searchTerm;return this.emit(\"suggest-start\",{searchTerm:s}),this._suggestTimer(t,r).then((()=>this._suggestImmediate(s,r).then((e=>(this._set(\"suggestions\",e.results),this._set(\"suggestionCount\",e.results.reduce(((e,t)=>e+t.results.length),0)),this.emit(\"suggest-complete\",e),e)))))}async when(){await _(this,\"updating\")}async _update(){const{portal:e,view:t}=this;if(this.includeDefaultSources){const r=this._updatingPromise=m([null==e?void 0:e.load(),null==t?void 0:t.when()]);if(this.destroyed)return;if(this.notifyChange(\"updating\"),await r,r!==this._updatingPromise)return}this._updatingPromise=null,this.notifyChange(\"updating\");const r=b(this,\"messages\");this.destroyed||(this._handles.add(r),await r,this._updateDefaultSources())}_clearSearching(){this._searching=null,this.notifyChange(\"state\")}_convertHelperServices(){var e,t;const s=null==(e=this.portal)||null==(t=e.helperServices)?void 0:t.geocode;if(!s)return[];return s.map((e=>{var t;if(!1===e.placefinding)return;const s=r.apiKey&&B(e.url)?{url:J}:null,o=N.fromJSON({...e,...s}),i=null==(t=o.locator)?void 0:t.url;if(B(i)||U(i)||H(i)){const e=o.outFields||[\"Addr_type\",\"Match_addr\",\"StAddr\",\"City\"],t=o.placeholder||this.messages.placeholder,r=\"number\"==typeof o.defaultZoomScale?o.defaultZoomScale:2500;o.set({singleLineFieldName:\"SingleLine\",outFields:e,placeholder:t,defaultZoomScale:r})}return o.singleLineFieldName?o:void 0})).filter(Boolean)}_getLayerSources(e,t){var r;const s=null==(r=this.view)?void 0:r.map;return e.map((e=>{const r=s.findLayerById(e.id);if(!r)return;const o=this._getLayerJSON(e),i=D.fromJSON(o);return i.placeholder=t,this._getLayer(r,o).then((e=>{i.layer=e})),i})).filter(Boolean).toArray()}_getTableSources(e,t){var r;const s=null==(r=this.view)?void 0:r.map;return e.map((e=>{const r=s.findTableById(e.id);if(!r)return;const o=this._getLayerJSON(e),i=D.fromJSON(o);return i.placeholder=t,this._getLayer(r,o).then((e=>{i.layer=e})),i})).filter(Boolean).toArray()}_convertApplicationProperties(){var e,t,r;const s=null==(e=this.view)?void 0:e.map,o=null==s||null==(t=s.applicationProperties)||null==(r=t.viewing)?void 0:r.search;if(!o)return[];const{enabled:i,hintText:l,layers:a,tables:n}=o;if(!i)return[];return[...this._getLayerSources(a,l),...this._getTableSources(n,l)]}_getSubLayer(e,t){return e.load().then((()=>{if(!e.allSublayers)return Promise.reject();const r=e.allSublayers.find((e=>e.id===t.subLayer));return r?r.createFeatureLayer():Promise.reject()}))}async _getBuildingSubLayer(e,t){await e.load();const r=e.allSublayers.find((e=>e.id===t.subLayer));return\"building-component\"!==(null==r?void 0:r.type)?Promise.reject():(await r.load(),null==r.associatedLayer?Promise.reject():(await r.associatedLayer.load(),r))}_getLayer(e,t){return\"feature\"===e.type||\"scene\"===e.type||\"csv\"===e.type||\"geojson\"===e.type||\"ogc-feature\"===e.type?Promise.resolve(e):\"map-image\"===e.type?this._getSubLayer(e,t).catch((()=>{const t=new a(\"search:create-featurelayer\",\"Could not create a FeatureLayer from the MapImageLayer\",{layer:e});return Y.error(t),null})):\"building-scene\"===e.type?this._getBuildingSubLayer(e,t):Promise.resolve(null)}_getLayerJSON(e){return\"function\"==typeof e.toJSON?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:t}=this;e.removeAll(),t&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()]),this.notifyChange(\"allSources\")}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set(\"resultCount\",null),this._set(\"results\",null),this._set(\"suggestions\",null),this._set(\"suggestionCount\",null),this._set(\"selectedResult\",null),this._set(\"selectedSuggestion\",null),this.emit(\"search-clear\")}_closePopup(){var e;const t=null==(e=this.view)?void 0:e.popup,{resultGraphic:r}=this;if(!t||!r)return;const{selectedFeature:s}=t;s&&s===r&&t.close()}_suggestTimer(e,t){const r=null!=e?e:this.suggestionDelay;return y(r,null,t&&t.signal)}_createLocationForSearch(e){return e instanceof s?k(e.geometry):e instanceof I?e:Array.isArray(e)&&2===e.length?new I({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&K(e,\"key\")&&K(e,\"text\")&&K(e,\"sourceIndex\"))return e;const t=this._createLocationForSearch(e),r=\"string\"==typeof e?e:this.searchTerm,{selectedSuggestion:s,selectedResult:o}=this,i=!e&&s&&o,l=i&&s.key===o.key&&s.sourceIndex===o.sourceIndex,a=i&&s.location;return l||a?s:{location:p(t),text:t?\"\":r,sourceIndex:null,key:null}}_getFirstResult(e){let t=null;return e&&e.some((e=>{const{results:r}=e,s=r[0],o=!!s;return o&&(t=s),o})),t}_selectFirstResult(e){return this.autoSelect&&e?this.select(e):Promise.resolve(null)}_suggestImmediate(e,t){return this.when().then((()=>this._getSuggestionsFromSources(e,t))).then((r=>{var s;if(null!=(s=p(null==t?void 0:t.signal))&&s.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:e,numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(o,r),o}))}_formatSourceResponse(e,t,r){const s=t&&t.value||[],o=t&&t.error,i=this.allSources.getItemAt(r);if(o){const t={sourceIndex:r,source:i,error:o};e.errors.push(t),Y.error(o),e.numErrors++}else{const t={sourceIndex:r,source:i,results:s};e.results.push(t),e.numResults+=s.length}}_formatResponse(e,t,r){if(t)if(e.activeSourceIndex===ie){const s=r&&K(r,\"sourceIndex\")&&-1!==r.sourceIndex?r.sourceIndex:void 0;t.forEach(((t,r)=>{const o=void 0!==s?s:r;this._formatSourceResponse(e,t,o)}))}else this._formatSourceResponse(e,t[0],e.activeSourceIndex)}_getResultsFromSources(e,t){const{allSources:r}=this,s=!e.location&&K(e,\"sourceIndex\")?e.sourceIndex:this.activeSourceIndex,o=[];if(!r.length){const e=new a(\"search:no-sources-defined\",\"At least one source is required.\",{allSources:r});return Y.error(e),Promise.reject(e)}return s===ie?r.forEach(((r,s)=>{o.push(this._getResultsFromSource(e,s,t))})):o.push(this._getResultsFromSource(e,s,t)),m(o)}_getSuggestionsFromSources(e,t){const{allSources:r,activeSourceIndex:s}=this,o=[];if(!r.length){const e=new a(\"suggest:no-sources-defined\",\"At least one source is required.\",{allSources:r});return Y.error(e),Promise.reject(e)}return s===ie?r.forEach(((r,s)=>{o.push(this._getSuggestionsFromSource(e,s,t))})):o.push(this._getSuggestionsFromSource(e,s,t)),m(o)}_getResultsFromSource(e,t,r){var s;const o=this.allSources.getItemAt(t),{location:i=null}=e,l=(null==(s=this.view)?void 0:s.spatialReference)||te,a=K(o,\"maxResults\")?o.maxResults:this.maxResults,n=!!(o instanceof D&&K(o,\"exactMatch\"))&&o.exactMatch,{view:u}=this;return o.getResults({view:u,sourceIndex:t,location:i,suggestResult:e,spatialReference:l,exactMatch:n,maxResults:a},r)}_getSuggestionsFromSource(e,t,r){const s=this.allSources.getItemAt(t),o=K(s,\"suggestionsEnabled\")?s.suggestionsEnabled:this.suggestionsEnabled,i=e.length,l=K(s,\"minSuggestCharacters\")?s.minSuggestCharacters:this.minSuggestCharacters;if(o&&e.trim()&&i>=l){var a;const o=(null==(a=this.view)?void 0:a.spatialReference)||te,i=K(s,\"maxSuggestions\")?s.maxSuggestions:this.maxSuggestions,{view:l}=this;return s.getSuggestions({view:l,sourceIndex:t,suggestTerm:e,spatialReference:o,maxSuggestions:i},r)}return Promise.resolve(null)}createDefaultSymbol(e,t){if(\"point\"===t){const t=e;return new O({color:e.color,size:t.size,outline:{color:t.outline.color,width:t.outline.width}})}if(\"polyline\"===t){const t=e;return new F({color:t.color,width:t.width})}if(\"polygon\"===t){const t=e;return new C({color:t.color,outline:{color:t.outline.color,width:t.outline.width}})}}_getLayerSourcePopupTemplate(e){const{layer:t}=e;if(t)return K(e,\"popupTemplate\")?e.popupTemplate:t.popupTemplate}_getSourceIndexOfResult(e){const t=this.results;let r=null;return t.some((t=>t.results.some((s=>s===e&&(r=t.sourceIndex,!0))))),r}async _goToSearchResult(e){const t=!!e;this._abortGoTo();const r=f();this._gotoController=r;const s={target:{target:e},options:{animate:t,signal:r.signal}};await this.callGoTo(s),this._gotoController=null}_getDefaultSymbol(e){var t,r,s;const o=null==(t=this.view)||null==(r=t.map)||null==(s=r.basemap)?void 0:s.id,i=g(e,\"feature\",\"geometry\",\"type\");if(d(i)){const e=L({basemap:o,geometryType:i})||L({basemap:\"topo\",geometryType:i}),t=e&&e.primaryScheme;if(t)return t.color&&K(t,\"opacity\")&&(t.color.a=t.opacity),this.createDefaultSymbol(t,i)}return this.defaultSymbol}_removeHighlight(){this._handles.remove($)}async _getLayerView(e){const{view:t}=this;if(!e||!t||\"building-component\"===e.layer.type||\"subtype-sublayer\"===e.layer.type)return Promise.resolve(null);const{layer:r}=e;return await t.when(),t.whenLayerView(r)}_highlightFeature(e){const{graphic:t,layerView:r}=e,{attributes:s,layer:o}=t,{objectIdField:i}=o,l=s&&s[i],a=r.highlight(l||t);this._handles.add(a,$)}};le.ALL_INDEX=ie,e([w({readOnly:!0,value:null})],le.prototype,\"activeSource\",null),e([w()],le.prototype,\"activeSourceIndex\",null),e([w()],le.prototype,\"allPlaceholder\",null),e([w({readOnly:!0,dependsOn:[\"defaultSources.length\",\"sources.length\",\"includeDefaultSources\"]})],le.prototype,\"allSources\",null),e([w()],le.prototype,\"autoNavigate\",void 0),e([w()],le.prototype,\"autoSelect\",void 0),e([w()],le.prototype,\"defaultPopupTemplate\",void 0),e([w({readOnly:!0})],le.prototype,\"defaultSources\",void 0),e([w()],le.prototype,\"defaultSymbol\",void 0),e([w()],le.prototype,\"includeDefaultSources\",void 0),e([w()],le.prototype,\"locationEnabled\",null),e([w()],le.prototype,\"maxInputLength\",void 0),e([w()],le.prototype,\"maxResults\",void 0),e([w()],le.prototype,\"maxSuggestions\",void 0),e([w()],le.prototype,\"messages\",void 0),e([w()],le.prototype,\"minSuggestCharacters\",void 0),e([w({readOnly:!0})],le.prototype,\"placeholder\",null),e([w()],le.prototype,\"popupEnabled\",void 0),e([w({type:o})],le.prototype,\"popupTemplate\",void 0),e([w({type:R})],le.prototype,\"portal\",void 0),e([w()],le.prototype,\"resultCount\",void 0),e([w()],le.prototype,\"resultGraphicEnabled\",void 0),e([w({readOnly:!0})],le.prototype,\"resultGraphic\",void 0),e([w({readOnly:!0})],le.prototype,\"results\",void 0),e([w({readOnly:!0})],le.prototype,\"selectedSuggestion\",void 0),e([w()],le.prototype,\"searchAllEnabled\",void 0),e([w({readOnly:!0})],le.prototype,\"selectedResult\",void 0),e([w()],le.prototype,\"searchTerm\",null),e([w({type:ee})],le.prototype,\"sources\",void 0),e([w({readOnly:!0,dependsOn:[\"allSources.length\",\"updating\"]})],le.prototype,\"state\",null),e([w()],le.prototype,\"suggestionDelay\",void 0),e([w()],le.prototype,\"suggestionCount\",void 0),e([w({readOnly:!0})],le.prototype,\"suggestions\",void 0),e([w()],le.prototype,\"suggestionsEnabled\",void 0),e([w({readOnly:!0})],le.prototype,\"updating\",null),e([w()],le.prototype,\"view\",void 0),e([w()],le.prototype,\"clear\",null),le=e([x(X)],le);var ae=le;export default ae;\n"]},"metadata":{},"sourceType":"module"}