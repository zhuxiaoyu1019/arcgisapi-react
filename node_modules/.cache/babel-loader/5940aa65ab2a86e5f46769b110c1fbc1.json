{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { f as e } from \"../../../../chunks/vec2f32.js\";\nimport { newLayout as t } from \"../../support/buffer/InterleavedLayout.js\";\nimport i from \"../lib/GLMaterial.js\";\nimport { Material as s, materialParametersDefaults as r } from \"../lib/Material.js\";\nimport { writePosition as n, writeNormal as a, writeBufferVec4 as u } from \"./internal/bufferWriterUtils.js\";\nimport { LineCalloutTechniqueConfiguration as o, LineCalloutTechnique as c } from \"../shaders/LineCalloutTechnique.js\";\n\nclass l extends s {\n  constructor(e) {\n    super(e, f), this.techniqueConfig = new o(), this._uniqueMaterialIdentifier = l.uniqueMaterialIdentifier(this.params);\n  }\n\n  get uniqueMaterialIdentifier() {\n    return this._uniqueMaterialIdentifier;\n  }\n\n  dispose() {}\n\n  getGLMaterial(e) {\n    return 0 === e.output ? new h(e) : void 0;\n  }\n\n  getPassParameters() {\n    return this.params;\n  }\n\n  getTechniqueConfig(e, t) {\n    return this.techniqueConfig.occlusionTestEnabled = this.params.occlusionTest, this.techniqueConfig.verticalOffset = !!this.params.verticalOffset, this.techniqueConfig.screenSizePerspective = !!this.params.screenSizePerspective, this.techniqueConfig.depthHudEnabled = e, this.techniqueConfig.depthHudAlignStartEnabled = !!this.params.depthHUDAlignStart, this.techniqueConfig.screenCenterOffsetUnitsEnabled = \"screen\" === this.params.centerOffsetUnits ? 1 : 0, this.techniqueConfig.slicePlaneEnabled = this.params.slicePlaneEnabled, this.techniqueConfig.multipassGeometryEnabled = !!t && t.multipassGeometryEnabled, this.techniqueConfig;\n  }\n\n  intersect() {}\n\n  createBufferWriter() {\n    return new m();\n  }\n\n  validateParameterValues(e) {\n    const t = l.uniqueMaterialIdentifier(e);\n    t !== this._uniqueMaterialIdentifier && (this._uniqueMaterialIdentifier = t);\n  }\n\n  static uniqueMaterialIdentifier(e) {\n    return JSON.stringify({\n      screenOffset: e.screenOffset || [0, 0],\n      centerOffsetUnits: e.centerOffsetUnits || \"world\"\n    });\n  }\n\n}\n\nclass h extends i {\n  constructor(e) {\n    super(e), this._isRenderSlot = !0, this.updateParameters();\n  }\n\n  updateParameters(e) {\n    this._technique = this._techniqueRep.releaseAndAcquire(c, this._material.getTechniqueConfig(!1, e), this._technique), this._depthTechnique = this._techniqueRep.releaseAndAcquire(c, this._material.getTechniqueConfig(!0, e), this._depthTechnique);\n  }\n\n  beginSlot(e) {\n    switch (e) {\n      case 20:\n        return this._isRenderSlot = !0, !0;\n\n      case 21:\n        return this._isRenderSlot = !1, !0;\n    }\n\n    return !1;\n  }\n\n  get technique() {\n    return this._isRenderSlot ? this._technique : this._depthTechnique;\n  }\n\n  ensureParameters(e) {\n    this.updateParameters(e);\n  }\n\n  bind(e) {\n    this.technique.bindPass(this._material.getPassParameters(), e);\n  }\n\n}\n\nconst f = {\n  verticalOffset: null,\n  screenSizePerspective: null,\n  screenOffset: [0, 0],\n  color: [0, 0, 0, 1],\n  size: 1,\n  borderColor: null,\n  occlusionTest: !1,\n  shaderPolygonOffset: 1e-5,\n  depthHUDAlignStart: !1,\n  centerOffsetUnits: \"world\",\n  slicePlaneEnabled: !1,\n  ...r\n},\n      d = t().vec3f(\"position\").vec3f(\"normal\").vec2f(\"uv0\").vec4f(\"auxpos1\"),\n      p = [e(0, 0), e(1, 0), e(0, 1), e(1, 0), e(1, 1), e(0, 1)];\n\nclass m {\n  constructor() {\n    this.vertexBufferLayout = d;\n  }\n\n  allocate(e) {\n    return this.vertexBufferLayout.createBuffer(e);\n  }\n\n  elementCount(e) {\n    return 6 * e.indices.get(\"position\").length;\n  }\n\n  write(e, t, i, s) {\n    n(t.indices.get(\"position\"), t.vertexAttributes.get(\"position\").data, e.transformation, i.position, s, 6), a(t.indices.get(\"normal\"), t.vertexAttributes.get(\"normal\").data, e.invTranspTransformation, i.normal, s, 6), u(t.indices.get(\"auxpos1\"), t.vertexAttributes.get(\"auxpos1\").data, i.auxpos1, s, 6);\n\n    for (let r = 0; r < p.length; ++r) i.uv0.setVec(s + r, p[r]);\n  }\n\n}\n\nexport { l as LineCalloutMaterial };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/webgl-engine/materials/LineCalloutMaterial.js"],"names":["f","e","newLayout","t","i","Material","s","materialParametersDefaults","r","writePosition","n","writeNormal","a","writeBufferVec4","u","LineCalloutTechniqueConfiguration","o","LineCalloutTechnique","c","l","constructor","techniqueConfig","_uniqueMaterialIdentifier","uniqueMaterialIdentifier","params","dispose","getGLMaterial","output","h","getPassParameters","getTechniqueConfig","occlusionTestEnabled","occlusionTest","verticalOffset","screenSizePerspective","depthHudEnabled","depthHudAlignStartEnabled","depthHUDAlignStart","screenCenterOffsetUnitsEnabled","centerOffsetUnits","slicePlaneEnabled","multipassGeometryEnabled","intersect","createBufferWriter","m","validateParameterValues","JSON","stringify","screenOffset","_isRenderSlot","updateParameters","_technique","_techniqueRep","releaseAndAcquire","_material","_depthTechnique","beginSlot","technique","ensureParameters","bind","bindPass","color","size","borderColor","shaderPolygonOffset","d","vec3f","vec2f","vec4f","p","vertexBufferLayout","allocate","createBuffer","elementCount","indices","get","length","write","vertexAttributes","data","transformation","position","invTranspTransformation","normal","auxpos1","uv0","setVec","LineCalloutMaterial"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{f as e}from\"../../../../chunks/vec2f32.js\";import{newLayout as t}from\"../../support/buffer/InterleavedLayout.js\";import i from\"../lib/GLMaterial.js\";import{Material as s,materialParametersDefaults as r}from\"../lib/Material.js\";import{writePosition as n,writeNormal as a,writeBufferVec4 as u}from\"./internal/bufferWriterUtils.js\";import{LineCalloutTechniqueConfiguration as o,LineCalloutTechnique as c}from\"../shaders/LineCalloutTechnique.js\";class l extends s{constructor(e){super(e,f),this.techniqueConfig=new o,this._uniqueMaterialIdentifier=l.uniqueMaterialIdentifier(this.params)}get uniqueMaterialIdentifier(){return this._uniqueMaterialIdentifier}dispose(){}getGLMaterial(e){return 0===e.output?new h(e):void 0}getPassParameters(){return this.params}getTechniqueConfig(e,t){return this.techniqueConfig.occlusionTestEnabled=this.params.occlusionTest,this.techniqueConfig.verticalOffset=!!this.params.verticalOffset,this.techniqueConfig.screenSizePerspective=!!this.params.screenSizePerspective,this.techniqueConfig.depthHudEnabled=e,this.techniqueConfig.depthHudAlignStartEnabled=!!this.params.depthHUDAlignStart,this.techniqueConfig.screenCenterOffsetUnitsEnabled=\"screen\"===this.params.centerOffsetUnits?1:0,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.multipassGeometryEnabled=!!t&&t.multipassGeometryEnabled,this.techniqueConfig}intersect(){}createBufferWriter(){return new m}validateParameterValues(e){const t=l.uniqueMaterialIdentifier(e);t!==this._uniqueMaterialIdentifier&&(this._uniqueMaterialIdentifier=t)}static uniqueMaterialIdentifier(e){return JSON.stringify({screenOffset:e.screenOffset||[0,0],centerOffsetUnits:e.centerOffsetUnits||\"world\"})}}class h extends i{constructor(e){super(e),this._isRenderSlot=!0,this.updateParameters()}updateParameters(e){this._technique=this._techniqueRep.releaseAndAcquire(c,this._material.getTechniqueConfig(!1,e),this._technique),this._depthTechnique=this._techniqueRep.releaseAndAcquire(c,this._material.getTechniqueConfig(!0,e),this._depthTechnique)}beginSlot(e){switch(e){case 20:return this._isRenderSlot=!0,!0;case 21:return this._isRenderSlot=!1,!0}return!1}get technique(){return this._isRenderSlot?this._technique:this._depthTechnique}ensureParameters(e){this.updateParameters(e)}bind(e){this.technique.bindPass(this._material.getPassParameters(),e)}}const f={verticalOffset:null,screenSizePerspective:null,screenOffset:[0,0],color:[0,0,0,1],size:1,borderColor:null,occlusionTest:!1,shaderPolygonOffset:1e-5,depthHUDAlignStart:!1,centerOffsetUnits:\"world\",slicePlaneEnabled:!1,...r},d=t().vec3f(\"position\").vec3f(\"normal\").vec2f(\"uv0\").vec4f(\"auxpos1\"),p=[e(0,0),e(1,0),e(0,1),e(1,0),e(1,1),e(0,1)];class m{constructor(){this.vertexBufferLayout=d}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 6*e.indices.get(\"position\").length}write(e,t,i,s){n(t.indices.get(\"position\"),t.vertexAttributes.get(\"position\").data,e.transformation,i.position,s,6),a(t.indices.get(\"normal\"),t.vertexAttributes.get(\"normal\").data,e.invTranspTransformation,i.normal,s,6),u(t.indices.get(\"auxpos1\"),t.vertexAttributes.get(\"auxpos1\").data,i.auxpos1,s,6);for(let r=0;r<p.length;++r)i.uv0.setVec(s+r,p[r])}}export{l as LineCalloutMaterial};\n"]},"metadata":{},"sourceType":"module"}