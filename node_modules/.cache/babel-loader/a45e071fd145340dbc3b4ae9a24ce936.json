{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { unwrapOr as t } from \"../../../../../../core/maybe.js\";\nimport { pt2px as e } from \"../../../../../../core/screenUtils.js\";\nimport { c as o } from \"../../../../../../chunks/mat2df32.js\";\nimport { c as i } from \"../../../../../../chunks/vec2f32.js\";\nimport { premultiplyAlphaRGBA as s, premultiplyAlphaRGBAArray as r } from \"../../color.js\";\nimport { MIN_MAX_ZOOM_PRECISION_FACTOR as a, SPRITE_PADDING as n, PICTURE_FILL_COLOR as h } from \"../../definitions.js\";\nimport { i1616to32 as l, i8888to32 as m } from \"../../number.js\";\nimport { MarkerMaterialKey as c } from \"../../materialKey/MaterialKey.js\";\nimport { getMinMaxZoom as f, DEFAULT_MIN_ZOOM as d, DEFAULT_MAX_ZOOM as u } from \"./util.js\";\nimport x from \"./WGLBaseMarkerTemplate.js\";\nimport p from \"./WGLMeshTemplate.js\";\n\nclass M extends x(p) {\n  constructor(t, e, s, r, h, f, d, u, x, p, M, y, _, S, g, V, z, B, k, w, b, L, j) {\n    super(), this.angle = r, this.height = d, this.width = f, this.xOffset = e * k, this.yOffset = s * k, this._markerPlacement = w, this._effects = b, this._anchorX = .5 - (.5 + V) * g.width / g.width, this._anchorY = .5 - (.5 + z) * g.height / g.height, this._minMaxZoom = l(Math.round(L * a), Math.round(j * a));\n    const P = (1 === S ? 1 : 0) | (M ? 1 : 0) << 1 | (_ ? 1 : 0) << 2 | (y ? 1 : 0) << 3,\n          C = g && g.sdf,\n          R = c.load(t);\n    R.sdf = C, R.pattern = !0, R.textureBinding = g.textureBinding, this._materialKey = R.data, this._fillColor = h, this._outlineColor = x, this._sizeOutlineWidth = m(Math.round(Math.min(Math.sqrt(128 * f), 255)), Math.round(Math.min(Math.sqrt(128 * d), 255)), Math.round(Math.min(Math.sqrt(128 * p), 255)), Math.round(Math.min(Math.sqrt(128 * u), 255)));\n    const v = g.rect.x + n,\n          K = g.rect.y + n,\n          U = v + g.width,\n          W = K + g.height;\n    this._offsets.xUpperLeft = v, this._offsets.yUpperLeft = K, this._offsets.xUpperRight = U, this._offsets.yUpperRight = K, this._offsets.xBottomLeft = v, this._offsets.yBottomLeft = W, this._offsets.xBottomRight = U, this._offsets.yBottomRight = W, this._texUpperLeft = l(v, K), this._texUpperRight = l(U, K), this._texBottomLeft = l(v, W), this._texBottomRight = l(U, W), f *= B, d *= B, f *= k, d *= k;\n    const X = Math.round(64 * B);\n    this._bitestAndDistRatio = l(P, X), this._computedWidth = f, this._computedHeight = d;\n    const q = i(),\n          T = o();\n\n    this._applyTransformation(T, q);\n  }\n\n  static fromCIMMarker(o, i, r) {\n    const a = i && i.width || 1,\n          n = i && i.height || 1,\n          h = o.size,\n          l = a / n * o.scaleX,\n          m = o.scaleSymbolsProportionally && o.frameHeight ? h / o.frameHeight : 1,\n          c = s(o.color),\n          d = s(o.outlineColor),\n          u = e(h),\n          x = u * l,\n          p = e(o.offsetX || 0),\n          y = e(o.offsetY || 0),\n          _ = e(o.outlineWidth || 0) * m,\n          S = o.alignment || 0,\n          g = e(o.referenceSize),\n          [V, z] = f(o.scaleInfo, r);\n\n    let B = o.rotation || 0;\n    o.rotateClockwise || (B = -B);\n    let k = 0,\n        w = 0;\n    const b = o.anchorPoint;\n    b && (o.isAbsoluteAnchorPoint ? h && (k = -b.x / (h * l), w = b.y / h) : (k = b.x, w = b.y));\n    const L = new M(o.materialKey, p, y, B, c, x, u, g, d, _, o.colorLocked, o.scaleSymbolsProportionally, !1, S, i, k, w, o.sizeRatio, t(o.scaleFactor, 1), o.markerPlacement, o.effects, V, z);\n    return L._vertexBoundsScaleX = o.maxVVSize ? o.maxVVSize / x : 1, L._vertexBoundsScaleY = o.maxVVSize ? o.maxVVSize / u : 1, L;\n  }\n\n  static fromPictureMarker(t, o) {\n    const i = Math.round(e(t.width)),\n          s = Math.round(e(t.height)),\n          r = h,\n          a = Math.round(e(t.xoffset || 0)),\n          n = Math.round(e(t.yoffset || 0)),\n          l = new M(t.materialKey, a, n, t.angle, r, i, s, s, 0, 0, !1, !1, !1, 0, o, 0, 0, 1, 1, null, null, d, u);\n    return l._vertexBoundsScaleX = t.maxVVSize ? t.maxVVSize / t.width : 1, l._vertexBoundsScaleY = t.maxVVSize ? t.maxVVSize / t.height : 1, l;\n  }\n\n  static fromSimpleMarker(t, o) {\n    const i = r(t.color),\n          s = Math.round(e(t.size)),\n          a = s,\n          n = Math.round(e(t.xoffset || 0)),\n          h = Math.round(e(t.yoffset || 0)),\n          l = t.style,\n          m = t.outline,\n          c = 0 | (m && m.color && r(m.color)),\n          f = 0 | (m && m.width && Math.round(e(m.width))),\n          x = new M(t.materialKey, n, h, t.angle, i, s, a, a, c, f, !1, !1, \"esriSMSCross\" === l || \"esriSMSX\" === l, 0, o, 0, 0, 126 / 64, 1, null, null, d, u);\n    return x.boundsType = \"esriSMSCircle\" === l ? \"circle\" : \"square\", x._vertexBoundsScaleX = t.maxVVSize ? t.maxVVSize / t.size : 1, x._vertexBoundsScaleY = t.maxVVSize ? t.maxVVSize / t.size : 1, x;\n  }\n\n  static fromLineSymbolMarker(t, o) {\n    const i = r(t.color),\n          s = 6,\n          a = Math.round(e(s * t.lineWidth)),\n          n = a,\n          h = \"cross\" === t.style || \"x\" === t.style;\n    let l;\n\n    switch (t.placement) {\n      case \"begin-end\":\n        l = \"Both\";\n        break;\n\n      case \"begin\":\n        l = \"JustBegin\";\n        break;\n\n      case \"end\":\n        l = \"JustEnd\";\n        break;\n\n      default:\n        l = \"None\";\n    }\n\n    const m = {\n      type: \"CIMMarkerPlacementAtExtremities\",\n      angleToLine: !0,\n      offset: 0,\n      extremityPlacement: l,\n      offsetAlongLine: 0\n    },\n          c = new M(t.materialKey, 0, 0, 0, i, a, n, n / s, i, h ? Math.round(e(t.lineWidth)) : 0, !1, !1, h, 1, o, 0, 0, 126 / 64, 1, m, null, d, u);\n    return c.boundsType = \"circle\" === t.style ? \"circle\" : \"square\", c;\n  }\n\n}\n\nexport default M;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate.js"],"names":["unwrapOr","t","pt2px","e","c","o","i","premultiplyAlphaRGBA","s","premultiplyAlphaRGBAArray","r","MIN_MAX_ZOOM_PRECISION_FACTOR","a","SPRITE_PADDING","n","PICTURE_FILL_COLOR","h","i1616to32","l","i8888to32","m","MarkerMaterialKey","getMinMaxZoom","f","DEFAULT_MIN_ZOOM","d","DEFAULT_MAX_ZOOM","u","x","p","M","constructor","y","_","S","g","V","z","B","k","w","b","L","j","angle","height","width","xOffset","yOffset","_markerPlacement","_effects","_anchorX","_anchorY","_minMaxZoom","Math","round","P","C","sdf","R","load","pattern","textureBinding","_materialKey","data","_fillColor","_outlineColor","_sizeOutlineWidth","min","sqrt","v","rect","K","U","W","_offsets","xUpperLeft","yUpperLeft","xUpperRight","yUpperRight","xBottomLeft","yBottomLeft","xBottomRight","yBottomRight","_texUpperLeft","_texUpperRight","_texBottomLeft","_texBottomRight","X","_bitestAndDistRatio","_computedWidth","_computedHeight","q","T","_applyTransformation","fromCIMMarker","size","scaleX","scaleSymbolsProportionally","frameHeight","color","outlineColor","offsetX","offsetY","outlineWidth","alignment","referenceSize","scaleInfo","rotation","rotateClockwise","anchorPoint","isAbsoluteAnchorPoint","materialKey","colorLocked","sizeRatio","scaleFactor","markerPlacement","effects","_vertexBoundsScaleX","maxVVSize","_vertexBoundsScaleY","fromPictureMarker","xoffset","yoffset","fromSimpleMarker","style","outline","boundsType","fromLineSymbolMarker","lineWidth","placement","type","angleToLine","offset","extremityPlacement","offsetAlongLine"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,QAAQ,IAAIC,CAAnB,QAAyB,iCAAzB;AAA2D,SAAOC,KAAK,IAAIC,CAAhB,QAAsB,uCAAtB;AAA8D,SAAOC,CAAC,IAAIC,CAAZ,QAAkB,sCAAlB;AAAyD,SAAOD,CAAC,IAAIE,CAAZ,QAAkB,qCAAlB;AAAwD,SAAOC,oBAAoB,IAAIC,CAA/B,EAAiCC,yBAAyB,IAAIC,CAA9D,QAAoE,gBAApE;AAAqF,SAAOC,6BAA6B,IAAIC,CAAxC,EAA0CC,cAAc,IAAIC,CAA5D,EAA8DC,kBAAkB,IAAIC,CAApF,QAA0F,sBAA1F;AAAiH,SAAOC,SAAS,IAAIC,CAApB,EAAsBC,SAAS,IAAIC,CAAnC,QAAyC,iBAAzC;AAA2D,SAAOC,iBAAiB,IAAIjB,CAA5B,QAAkC,kCAAlC;AAAqE,SAAOkB,aAAa,IAAIC,CAAxB,EAA0BC,gBAAgB,IAAIC,CAA9C,EAAgDC,gBAAgB,IAAIC,CAApE,QAA0E,WAA1E;AAAsF,OAAOC,CAAP,MAAa,4BAAb;AAA0C,OAAOC,CAAP,MAAa,sBAAb;;AAAoC,MAAMC,CAAN,SAAgBF,CAAC,CAACC,CAAD,CAAjB,CAAqB;AAACE,EAAAA,WAAW,CAAC9B,CAAD,EAAGE,CAAH,EAAKK,CAAL,EAAOE,CAAP,EAASM,CAAT,EAAWO,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiBC,CAAjB,EAAmBC,CAAnB,EAAqBC,CAArB,EAAuBE,CAAvB,EAAyBC,CAAzB,EAA2BC,CAA3B,EAA6BC,CAA7B,EAA+BC,CAA/B,EAAiCC,CAAjC,EAAmCC,CAAnC,EAAqCC,CAArC,EAAuCC,CAAvC,EAAyCC,CAAzC,EAA2CC,CAA3C,EAA6CC,CAA7C,EAA+C;AAAC,aAAQ,KAAKC,KAAL,GAAWlC,CAAnB,EAAqB,KAAKmC,MAAL,GAAYpB,CAAjC,EAAmC,KAAKqB,KAAL,GAAWvB,CAA9C,EAAgD,KAAKwB,OAAL,GAAa5C,CAAC,GAACoC,CAA/D,EAAiE,KAAKS,OAAL,GAAaxC,CAAC,GAAC+B,CAAhF,EAAkF,KAAKU,gBAAL,GAAsBT,CAAxG,EAA0G,KAAKU,QAAL,GAAcT,CAAxH,EAA0H,KAAKU,QAAL,GAAc,KAAG,CAAC,KAAGf,CAAJ,IAAOD,CAAC,CAACW,KAAT,GAAeX,CAAC,CAACW,KAA5J,EAAkK,KAAKM,QAAL,GAAc,KAAG,CAAC,KAAGf,CAAJ,IAAOF,CAAC,CAACU,MAAT,GAAgBV,CAAC,CAACU,MAArM,EAA4M,KAAKQ,WAAL,GAAiBnC,CAAC,CAACoC,IAAI,CAACC,KAAL,CAAWb,CAAC,GAAC9B,CAAb,CAAD,EAAiB0C,IAAI,CAACC,KAAL,CAAWZ,CAAC,GAAC/B,CAAb,CAAjB,CAA9N;AAAgQ,UAAM4C,CAAC,GAAC,CAAC,MAAItB,CAAJ,GAAM,CAAN,GAAQ,CAAT,IAAY,CAACJ,CAAC,GAAC,CAAD,GAAG,CAAL,KAAS,CAArB,GAAuB,CAACG,CAAC,GAAC,CAAD,GAAG,CAAL,KAAS,CAAhC,GAAkC,CAACD,CAAC,GAAC,CAAD,GAAG,CAAL,KAAS,CAAnD;AAAA,UAAqDyB,CAAC,GAACtB,CAAC,IAAEA,CAAC,CAACuB,GAA5D;AAAA,UAAgEC,CAAC,GAACvD,CAAC,CAACwD,IAAF,CAAO3D,CAAP,CAAlE;AAA4E0D,IAAAA,CAAC,CAACD,GAAF,GAAMD,CAAN,EAAQE,CAAC,CAACE,OAAF,GAAU,CAAC,CAAnB,EAAqBF,CAAC,CAACG,cAAF,GAAiB3B,CAAC,CAAC2B,cAAxC,EAAuD,KAAKC,YAAL,GAAkBJ,CAAC,CAACK,IAA3E,EAAgF,KAAKC,UAAL,GAAgBjD,CAAhG,EAAkG,KAAKkD,aAAL,GAAmBtC,CAArH,EAAuH,KAAKuC,iBAAL,GAAuB/C,CAAC,CAACkC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACc,GAAL,CAASd,IAAI,CAACe,IAAL,CAAU,MAAI9C,CAAd,CAAT,EAA0B,GAA1B,CAAX,CAAD,EAA4C+B,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACc,GAAL,CAASd,IAAI,CAACe,IAAL,CAAU,MAAI5C,CAAd,CAAT,EAA0B,GAA1B,CAAX,CAA5C,EAAuF6B,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACc,GAAL,CAASd,IAAI,CAACe,IAAL,CAAU,MAAIxC,CAAd,CAAT,EAA0B,GAA1B,CAAX,CAAvF,EAAkIyB,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACc,GAAL,CAASd,IAAI,CAACe,IAAL,CAAU,MAAI1C,CAAd,CAAT,EAA0B,GAA1B,CAAX,CAAlI,CAA/I;AAA6T,UAAM2C,CAAC,GAACnC,CAAC,CAACoC,IAAF,CAAO3C,CAAP,GAASd,CAAjB;AAAA,UAAmB0D,CAAC,GAACrC,CAAC,CAACoC,IAAF,CAAOvC,CAAP,GAASlB,CAA9B;AAAA,UAAgC2D,CAAC,GAACH,CAAC,GAACnC,CAAC,CAACW,KAAtC;AAAA,UAA4C4B,CAAC,GAACF,CAAC,GAACrC,CAAC,CAACU,MAAlD;AAAyD,SAAK8B,QAAL,CAAcC,UAAd,GAAyBN,CAAzB,EAA2B,KAAKK,QAAL,CAAcE,UAAd,GAAyBL,CAApD,EAAsD,KAAKG,QAAL,CAAcG,WAAd,GAA0BL,CAAhF,EAAkF,KAAKE,QAAL,CAAcI,WAAd,GAA0BP,CAA5G,EAA8G,KAAKG,QAAL,CAAcK,WAAd,GAA0BV,CAAxI,EAA0I,KAAKK,QAAL,CAAcM,WAAd,GAA0BP,CAApK,EAAsK,KAAKC,QAAL,CAAcO,YAAd,GAA2BT,CAAjM,EAAmM,KAAKE,QAAL,CAAcQ,YAAd,GAA2BT,CAA9N,EAAgO,KAAKU,aAAL,GAAmBlE,CAAC,CAACoD,CAAD,EAAGE,CAAH,CAApP,EAA0P,KAAKa,cAAL,GAAoBnE,CAAC,CAACuD,CAAD,EAAGD,CAAH,CAA/Q,EAAqR,KAAKc,cAAL,GAAoBpE,CAAC,CAACoD,CAAD,EAAGI,CAAH,CAA1S,EAAgT,KAAKa,eAAL,GAAqBrE,CAAC,CAACuD,CAAD,EAAGC,CAAH,CAAtU,EAA4UnD,CAAC,IAAEe,CAA/U,EAAiVb,CAAC,IAAEa,CAApV,EAAsVf,CAAC,IAAEgB,CAAzV,EAA2Vd,CAAC,IAAEc,CAA9V;AAAgW,UAAMiD,CAAC,GAAClC,IAAI,CAACC,KAAL,CAAW,KAAGjB,CAAd,CAAR;AAAyB,SAAKmD,mBAAL,GAAyBvE,CAAC,CAACsC,CAAD,EAAGgC,CAAH,CAA1B,EAAgC,KAAKE,cAAL,GAAoBnE,CAApD,EAAsD,KAAKoE,eAAL,GAAqBlE,CAA3E;AAA6E,UAAMmE,CAAC,GAACtF,CAAC,EAAT;AAAA,UAAYuF,CAAC,GAACxF,CAAC,EAAf;;AAAkB,SAAKyF,oBAAL,CAA0BD,CAA1B,EAA4BD,CAA5B;AAA+B;;AAAoB,SAAbG,aAAa,CAAC1F,CAAD,EAAGC,CAAH,EAAKI,CAAL,EAAO;AAAC,UAAME,CAAC,GAACN,CAAC,IAAEA,CAAC,CAACwC,KAAL,IAAY,CAApB;AAAA,UAAsBhC,CAAC,GAACR,CAAC,IAAEA,CAAC,CAACuC,MAAL,IAAa,CAArC;AAAA,UAAuC7B,CAAC,GAACX,CAAC,CAAC2F,IAA3C;AAAA,UAAgD9E,CAAC,GAACN,CAAC,GAACE,CAAF,GAAIT,CAAC,CAAC4F,MAAxD;AAAA,UAA+D7E,CAAC,GAACf,CAAC,CAAC6F,0BAAF,IAA8B7F,CAAC,CAAC8F,WAAhC,GAA4CnF,CAAC,GAACX,CAAC,CAAC8F,WAAhD,GAA4D,CAA7H;AAAA,UAA+H/F,CAAC,GAACI,CAAC,CAACH,CAAC,CAAC+F,KAAH,CAAlI;AAAA,UAA4I3E,CAAC,GAACjB,CAAC,CAACH,CAAC,CAACgG,YAAH,CAA/I;AAAA,UAAgK1E,CAAC,GAACxB,CAAC,CAACa,CAAD,CAAnK;AAAA,UAAuKY,CAAC,GAACD,CAAC,GAACT,CAA3K;AAAA,UAA6KW,CAAC,GAAC1B,CAAC,CAACE,CAAC,CAACiG,OAAF,IAAW,CAAZ,CAAhL;AAAA,UAA+LtE,CAAC,GAAC7B,CAAC,CAACE,CAAC,CAACkG,OAAF,IAAW,CAAZ,CAAlM;AAAA,UAAiNtE,CAAC,GAAC9B,CAAC,CAACE,CAAC,CAACmG,YAAF,IAAgB,CAAjB,CAAD,GAAqBpF,CAAxO;AAAA,UAA0Oc,CAAC,GAAC7B,CAAC,CAACoG,SAAF,IAAa,CAAzP;AAAA,UAA2PtE,CAAC,GAAChC,CAAC,CAACE,CAAC,CAACqG,aAAH,CAA9P;AAAA,UAAgR,CAACtE,CAAD,EAAGC,CAAH,IAAMd,CAAC,CAAClB,CAAC,CAACsG,SAAH,EAAajG,CAAb,CAAvR;;AAAuS,QAAI4B,CAAC,GAACjC,CAAC,CAACuG,QAAF,IAAY,CAAlB;AAAoBvG,IAAAA,CAAC,CAACwG,eAAF,KAAoBvE,CAAC,GAAC,CAACA,CAAvB;AAA0B,QAAIC,CAAC,GAAC,CAAN;AAAA,QAAQC,CAAC,GAAC,CAAV;AAAY,UAAMC,CAAC,GAACpC,CAAC,CAACyG,WAAV;AAAsBrE,IAAAA,CAAC,KAAGpC,CAAC,CAAC0G,qBAAF,GAAwB/F,CAAC,KAAGuB,CAAC,GAAC,CAACE,CAAC,CAACb,CAAH,IAAMZ,CAAC,GAACE,CAAR,CAAF,EAAasB,CAAC,GAACC,CAAC,CAACT,CAAF,GAAIhB,CAAtB,CAAzB,IAAmDuB,CAAC,GAACE,CAAC,CAACb,CAAJ,EAAMY,CAAC,GAACC,CAAC,CAACT,CAA7D,CAAH,CAAD;AAAqE,UAAMU,CAAC,GAAC,IAAIZ,CAAJ,CAAMzB,CAAC,CAAC2G,WAAR,EAAoBnF,CAApB,EAAsBG,CAAtB,EAAwBM,CAAxB,EAA0BlC,CAA1B,EAA4BwB,CAA5B,EAA8BD,CAA9B,EAAgCQ,CAAhC,EAAkCV,CAAlC,EAAoCQ,CAApC,EAAsC5B,CAAC,CAAC4G,WAAxC,EAAoD5G,CAAC,CAAC6F,0BAAtD,EAAiF,CAAC,CAAlF,EAAoFhE,CAApF,EAAsF5B,CAAtF,EAAwFiC,CAAxF,EAA0FC,CAA1F,EAA4FnC,CAAC,CAAC6G,SAA9F,EAAwGjH,CAAC,CAACI,CAAC,CAAC8G,WAAH,EAAe,CAAf,CAAzG,EAA2H9G,CAAC,CAAC+G,eAA7H,EAA6I/G,CAAC,CAACgH,OAA/I,EAAuJjF,CAAvJ,EAAyJC,CAAzJ,CAAR;AAAoK,WAAOK,CAAC,CAAC4E,mBAAF,GAAsBjH,CAAC,CAACkH,SAAF,GAAYlH,CAAC,CAACkH,SAAF,GAAY3F,CAAxB,GAA0B,CAAhD,EAAkDc,CAAC,CAAC8E,mBAAF,GAAsBnH,CAAC,CAACkH,SAAF,GAAYlH,CAAC,CAACkH,SAAF,GAAY5F,CAAxB,GAA0B,CAAlG,EAAoGe,CAA3G;AAA6G;;AAAwB,SAAjB+E,iBAAiB,CAACxH,CAAD,EAAGI,CAAH,EAAK;AAAC,UAAMC,CAAC,GAACgD,IAAI,CAACC,KAAL,CAAWpD,CAAC,CAACF,CAAC,CAAC6C,KAAH,CAAZ,CAAR;AAAA,UAA+BtC,CAAC,GAAC8C,IAAI,CAACC,KAAL,CAAWpD,CAAC,CAACF,CAAC,CAAC4C,MAAH,CAAZ,CAAjC;AAAA,UAAyDnC,CAAC,GAACM,CAA3D;AAAA,UAA6DJ,CAAC,GAAC0C,IAAI,CAACC,KAAL,CAAWpD,CAAC,CAACF,CAAC,CAACyH,OAAF,IAAW,CAAZ,CAAZ,CAA/D;AAAA,UAA2F5G,CAAC,GAACwC,IAAI,CAACC,KAAL,CAAWpD,CAAC,CAACF,CAAC,CAAC0H,OAAF,IAAW,CAAZ,CAAZ,CAA7F;AAAA,UAAyHzG,CAAC,GAAC,IAAIY,CAAJ,CAAM7B,CAAC,CAAC+G,WAAR,EAAoBpG,CAApB,EAAsBE,CAAtB,EAAwBb,CAAC,CAAC2C,KAA1B,EAAgClC,CAAhC,EAAkCJ,CAAlC,EAAoCE,CAApC,EAAsCA,CAAtC,EAAwC,CAAxC,EAA0C,CAA1C,EAA4C,CAAC,CAA7C,EAA+C,CAAC,CAAhD,EAAkD,CAAC,CAAnD,EAAqD,CAArD,EAAuDH,CAAvD,EAAyD,CAAzD,EAA2D,CAA3D,EAA6D,CAA7D,EAA+D,CAA/D,EAAiE,IAAjE,EAAsE,IAAtE,EAA2EoB,CAA3E,EAA6EE,CAA7E,CAA3H;AAA2M,WAAOT,CAAC,CAACoG,mBAAF,GAAsBrH,CAAC,CAACsH,SAAF,GAAYtH,CAAC,CAACsH,SAAF,GAAYtH,CAAC,CAAC6C,KAA1B,GAAgC,CAAtD,EAAwD5B,CAAC,CAACsG,mBAAF,GAAsBvH,CAAC,CAACsH,SAAF,GAAYtH,CAAC,CAACsH,SAAF,GAAYtH,CAAC,CAAC4C,MAA1B,GAAiC,CAA/G,EAAiH3B,CAAxH;AAA0H;;AAAuB,SAAhB0G,gBAAgB,CAAC3H,CAAD,EAAGI,CAAH,EAAK;AAAC,UAAMC,CAAC,GAACI,CAAC,CAACT,CAAC,CAACmG,KAAH,CAAT;AAAA,UAAmB5F,CAAC,GAAC8C,IAAI,CAACC,KAAL,CAAWpD,CAAC,CAACF,CAAC,CAAC+F,IAAH,CAAZ,CAArB;AAAA,UAA2CpF,CAAC,GAACJ,CAA7C;AAAA,UAA+CM,CAAC,GAACwC,IAAI,CAACC,KAAL,CAAWpD,CAAC,CAACF,CAAC,CAACyH,OAAF,IAAW,CAAZ,CAAZ,CAAjD;AAAA,UAA6E1G,CAAC,GAACsC,IAAI,CAACC,KAAL,CAAWpD,CAAC,CAACF,CAAC,CAAC0H,OAAF,IAAW,CAAZ,CAAZ,CAA/E;AAAA,UAA2GzG,CAAC,GAACjB,CAAC,CAAC4H,KAA/G;AAAA,UAAqHzG,CAAC,GAACnB,CAAC,CAAC6H,OAAzH;AAAA,UAAiI1H,CAAC,GAAC,KAAGgB,CAAC,IAAEA,CAAC,CAACgF,KAAL,IAAY1F,CAAC,CAACU,CAAC,CAACgF,KAAH,CAAhB,CAAnI;AAAA,UAA8J7E,CAAC,GAAC,KAAGH,CAAC,IAAEA,CAAC,CAAC0B,KAAL,IAAYQ,IAAI,CAACC,KAAL,CAAWpD,CAAC,CAACiB,CAAC,CAAC0B,KAAH,CAAZ,CAAf,CAAhK;AAAA,UAAuMlB,CAAC,GAAC,IAAIE,CAAJ,CAAM7B,CAAC,CAAC+G,WAAR,EAAoBlG,CAApB,EAAsBE,CAAtB,EAAwBf,CAAC,CAAC2C,KAA1B,EAAgCtC,CAAhC,EAAkCE,CAAlC,EAAoCI,CAApC,EAAsCA,CAAtC,EAAwCR,CAAxC,EAA0CmB,CAA1C,EAA4C,CAAC,CAA7C,EAA+C,CAAC,CAAhD,EAAkD,mBAAiBL,CAAjB,IAAoB,eAAaA,CAAnF,EAAqF,CAArF,EAAuFb,CAAvF,EAAyF,CAAzF,EAA2F,CAA3F,EAA6F,MAAI,EAAjG,EAAoG,CAApG,EAAsG,IAAtG,EAA2G,IAA3G,EAAgHoB,CAAhH,EAAkHE,CAAlH,CAAzM;AAA8T,WAAOC,CAAC,CAACmG,UAAF,GAAa,oBAAkB7G,CAAlB,GAAoB,QAApB,GAA6B,QAA1C,EAAmDU,CAAC,CAAC0F,mBAAF,GAAsBrH,CAAC,CAACsH,SAAF,GAAYtH,CAAC,CAACsH,SAAF,GAAYtH,CAAC,CAAC+F,IAA1B,GAA+B,CAAxG,EAA0GpE,CAAC,CAAC4F,mBAAF,GAAsBvH,CAAC,CAACsH,SAAF,GAAYtH,CAAC,CAACsH,SAAF,GAAYtH,CAAC,CAAC+F,IAA1B,GAA+B,CAA/J,EAAiKpE,CAAxK;AAA0K;;AAA2B,SAApBoG,oBAAoB,CAAC/H,CAAD,EAAGI,CAAH,EAAK;AAAC,UAAMC,CAAC,GAACI,CAAC,CAACT,CAAC,CAACmG,KAAH,CAAT;AAAA,UAAmB5F,CAAC,GAAC,CAArB;AAAA,UAAuBI,CAAC,GAAC0C,IAAI,CAACC,KAAL,CAAWpD,CAAC,CAACK,CAAC,GAACP,CAAC,CAACgI,SAAL,CAAZ,CAAzB;AAAA,UAAsDnH,CAAC,GAACF,CAAxD;AAAA,UAA0DI,CAAC,GAAC,YAAUf,CAAC,CAAC4H,KAAZ,IAAmB,QAAM5H,CAAC,CAAC4H,KAAvF;AAA6F,QAAI3G,CAAJ;;AAAM,YAAOjB,CAAC,CAACiI,SAAT;AAAoB,WAAI,WAAJ;AAAgBhH,QAAAA,CAAC,GAAC,MAAF;AAAS;;AAAM,WAAI,OAAJ;AAAYA,QAAAA,CAAC,GAAC,WAAF;AAAc;;AAAM,WAAI,KAAJ;AAAUA,QAAAA,CAAC,GAAC,SAAF;AAAY;;AAAM;AAAQA,QAAAA,CAAC,GAAC,MAAF;AAAvH;;AAAgI,UAAME,CAAC,GAAC;AAAC+G,MAAAA,IAAI,EAAC,iCAAN;AAAwCC,MAAAA,WAAW,EAAC,CAAC,CAArD;AAAuDC,MAAAA,MAAM,EAAC,CAA9D;AAAgEC,MAAAA,kBAAkB,EAACpH,CAAnF;AAAqFqH,MAAAA,eAAe,EAAC;AAArG,KAAR;AAAA,UAAgHnI,CAAC,GAAC,IAAI0B,CAAJ,CAAM7B,CAAC,CAAC+G,WAAR,EAAoB,CAApB,EAAsB,CAAtB,EAAwB,CAAxB,EAA0B1G,CAA1B,EAA4BM,CAA5B,EAA8BE,CAA9B,EAAgCA,CAAC,GAACN,CAAlC,EAAoCF,CAApC,EAAsCU,CAAC,GAACsC,IAAI,CAACC,KAAL,CAAWpD,CAAC,CAACF,CAAC,CAACgI,SAAH,CAAZ,CAAD,GAA4B,CAAnE,EAAqE,CAAC,CAAtE,EAAwE,CAAC,CAAzE,EAA2EjH,CAA3E,EAA6E,CAA7E,EAA+EX,CAA/E,EAAiF,CAAjF,EAAmF,CAAnF,EAAqF,MAAI,EAAzF,EAA4F,CAA5F,EAA8Fe,CAA9F,EAAgG,IAAhG,EAAqGK,CAArG,EAAuGE,CAAvG,CAAlH;AAA4N,WAAOvB,CAAC,CAAC2H,UAAF,GAAa,aAAW9H,CAAC,CAAC4H,KAAb,GAAmB,QAAnB,GAA4B,QAAzC,EAAkDzH,CAAzD;AAA2D;;AAAj2G;;AAAk2G,eAAe0B,CAAf","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{unwrapOr as t}from\"../../../../../../core/maybe.js\";import{pt2px as e}from\"../../../../../../core/screenUtils.js\";import{c as o}from\"../../../../../../chunks/mat2df32.js\";import{c as i}from\"../../../../../../chunks/vec2f32.js\";import{premultiplyAlphaRGBA as s,premultiplyAlphaRGBAArray as r}from\"../../color.js\";import{MIN_MAX_ZOOM_PRECISION_FACTOR as a,SPRITE_PADDING as n,PICTURE_FILL_COLOR as h}from\"../../definitions.js\";import{i1616to32 as l,i8888to32 as m}from\"../../number.js\";import{MarkerMaterialKey as c}from\"../../materialKey/MaterialKey.js\";import{getMinMaxZoom as f,DEFAULT_MIN_ZOOM as d,DEFAULT_MAX_ZOOM as u}from\"./util.js\";import x from\"./WGLBaseMarkerTemplate.js\";import p from\"./WGLMeshTemplate.js\";class M extends(x(p)){constructor(t,e,s,r,h,f,d,u,x,p,M,y,_,S,g,V,z,B,k,w,b,L,j){super(),this.angle=r,this.height=d,this.width=f,this.xOffset=e*k,this.yOffset=s*k,this._markerPlacement=w,this._effects=b,this._anchorX=.5-(.5+V)*g.width/g.width,this._anchorY=.5-(.5+z)*g.height/g.height,this._minMaxZoom=l(Math.round(L*a),Math.round(j*a));const P=(1===S?1:0)|(M?1:0)<<1|(_?1:0)<<2|(y?1:0)<<3,C=g&&g.sdf,R=c.load(t);R.sdf=C,R.pattern=!0,R.textureBinding=g.textureBinding,this._materialKey=R.data,this._fillColor=h,this._outlineColor=x,this._sizeOutlineWidth=m(Math.round(Math.min(Math.sqrt(128*f),255)),Math.round(Math.min(Math.sqrt(128*d),255)),Math.round(Math.min(Math.sqrt(128*p),255)),Math.round(Math.min(Math.sqrt(128*u),255)));const v=g.rect.x+n,K=g.rect.y+n,U=v+g.width,W=K+g.height;this._offsets.xUpperLeft=v,this._offsets.yUpperLeft=K,this._offsets.xUpperRight=U,this._offsets.yUpperRight=K,this._offsets.xBottomLeft=v,this._offsets.yBottomLeft=W,this._offsets.xBottomRight=U,this._offsets.yBottomRight=W,this._texUpperLeft=l(v,K),this._texUpperRight=l(U,K),this._texBottomLeft=l(v,W),this._texBottomRight=l(U,W),f*=B,d*=B,f*=k,d*=k;const X=Math.round(64*B);this._bitestAndDistRatio=l(P,X),this._computedWidth=f,this._computedHeight=d;const q=i(),T=o();this._applyTransformation(T,q)}static fromCIMMarker(o,i,r){const a=i&&i.width||1,n=i&&i.height||1,h=o.size,l=a/n*o.scaleX,m=o.scaleSymbolsProportionally&&o.frameHeight?h/o.frameHeight:1,c=s(o.color),d=s(o.outlineColor),u=e(h),x=u*l,p=e(o.offsetX||0),y=e(o.offsetY||0),_=e(o.outlineWidth||0)*m,S=o.alignment||0,g=e(o.referenceSize),[V,z]=f(o.scaleInfo,r);let B=o.rotation||0;o.rotateClockwise||(B=-B);let k=0,w=0;const b=o.anchorPoint;b&&(o.isAbsoluteAnchorPoint?h&&(k=-b.x/(h*l),w=b.y/h):(k=b.x,w=b.y));const L=new M(o.materialKey,p,y,B,c,x,u,g,d,_,o.colorLocked,o.scaleSymbolsProportionally,!1,S,i,k,w,o.sizeRatio,t(o.scaleFactor,1),o.markerPlacement,o.effects,V,z);return L._vertexBoundsScaleX=o.maxVVSize?o.maxVVSize/x:1,L._vertexBoundsScaleY=o.maxVVSize?o.maxVVSize/u:1,L}static fromPictureMarker(t,o){const i=Math.round(e(t.width)),s=Math.round(e(t.height)),r=h,a=Math.round(e(t.xoffset||0)),n=Math.round(e(t.yoffset||0)),l=new M(t.materialKey,a,n,t.angle,r,i,s,s,0,0,!1,!1,!1,0,o,0,0,1,1,null,null,d,u);return l._vertexBoundsScaleX=t.maxVVSize?t.maxVVSize/t.width:1,l._vertexBoundsScaleY=t.maxVVSize?t.maxVVSize/t.height:1,l}static fromSimpleMarker(t,o){const i=r(t.color),s=Math.round(e(t.size)),a=s,n=Math.round(e(t.xoffset||0)),h=Math.round(e(t.yoffset||0)),l=t.style,m=t.outline,c=0|(m&&m.color&&r(m.color)),f=0|(m&&m.width&&Math.round(e(m.width))),x=new M(t.materialKey,n,h,t.angle,i,s,a,a,c,f,!1,!1,\"esriSMSCross\"===l||\"esriSMSX\"===l,0,o,0,0,126/64,1,null,null,d,u);return x.boundsType=\"esriSMSCircle\"===l?\"circle\":\"square\",x._vertexBoundsScaleX=t.maxVVSize?t.maxVVSize/t.size:1,x._vertexBoundsScaleY=t.maxVVSize?t.maxVVSize/t.size:1,x}static fromLineSymbolMarker(t,o){const i=r(t.color),s=6,a=Math.round(e(s*t.lineWidth)),n=a,h=\"cross\"===t.style||\"x\"===t.style;let l;switch(t.placement){case\"begin-end\":l=\"Both\";break;case\"begin\":l=\"JustBegin\";break;case\"end\":l=\"JustEnd\";break;default:l=\"None\"}const m={type:\"CIMMarkerPlacementAtExtremities\",angleToLine:!0,offset:0,extremityPlacement:l,offsetAlongLine:0},c=new M(t.materialKey,0,0,0,i,a,n,n/s,i,h?Math.round(e(t.lineWidth)):0,!1,!1,h,1,o,0,0,126/64,1,m,null,d,u);return c.boundsType=\"circle\"===t.style?\"circle\":\"square\",c}}export default M;\n"]},"metadata":{},"sourceType":"module"}