{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport \"../../geometry.js\";\nimport t from \"../../Graphic.js\";\nimport { unwrap as r } from \"../../core/maybe.js\";\nimport { property as o } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/has.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport \"../../core/Logger.js\";\nimport { reader as s } from \"../../core/accessorSupport/decorators/reader.js\";\nimport { subclass as a } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport p from \"./FeatureSet.js\";\nimport n from \"../../geometry/SpatialReference.js\";\nimport i from \"../../geometry/Point.js\";\nimport m from \"../../geometry/Polyline.js\";\nimport l from \"../../geometry/Extent.js\";\nlet u = class extends p {\n  constructor(e) {\n    super(e), this.extent = null, this.features = null, this.geometryType = \"polyline\", this.routeId = null, this.routeName = null, this.totalDriveTime = null, this.totalLength = null, this.totalTime = null;\n  }\n\n  readFeatures(e, o) {\n    (e || []).forEach(e => {\n      this._decompressFeatureGeometry(e, o.summary.envelope.spatialReference);\n    });\n    const s = n.fromJSON(o.spatialReference);\n    return e.map(e => {\n      const o = t.fromJSON(e),\n            a = e.geometry && e.geometry.spatialReference;\n      return o.geometry && !a && (r(o.geometry).spatialReference = s), o.strings = e.strings, o.events = (e.events || []).map(r => {\n        const o = new t({\n          geometry: new i({\n            x: r.point.x,\n            y: r.point.y,\n            z: r.point.z,\n            hasZ: void 0 !== r.point.z,\n            spatialReference: e.geometry && e.geometry.spatialReference\n          }),\n          attributes: {\n            ETA: r.ETA,\n            arriveTimeUTC: r.arriveTimeUTC\n          }\n        });\n        return o.strings = r.strings, o;\n      }), o;\n    });\n  }\n\n  get mergedGeometry() {\n    if (!this.features) return null;\n    const e = this.features.map(({\n      geometry: e\n    }) => r(e)),\n          t = this.get(\"extent.spatialReference\");\n    return this._mergePolylinesToSinglePath(e, t);\n  }\n\n  get strings() {\n    return this.features.map(({\n      strings: e\n    }) => e);\n  }\n\n  _decompressFeatureGeometry(e, t) {\n    e.geometry = this._decompressGeometry(e.compressedGeometry, t);\n  }\n\n  _decompressGeometry(e, t) {\n    let r = 0,\n        o = 0,\n        s = 0,\n        a = 0;\n    const p = [];\n    let n,\n        i,\n        m,\n        l,\n        u,\n        c,\n        y,\n        g,\n        h = 0,\n        f = 0,\n        d = 0;\n\n    if (u = e.match(/((\\+|\\-)[^\\+\\-\\|]+|\\|)/g), u || (u = []), 0 === parseInt(u[h], 32)) {\n      h = 2;\n      const e = parseInt(u[h], 32);\n      h++, c = parseInt(u[h], 32), h++, 1 & e && (f = u.indexOf(\"|\") + 1, y = parseInt(u[f], 32), f++), 2 & e && (d = u.indexOf(\"|\", f) + 1, g = parseInt(u[d], 32), d++);\n    } else c = parseInt(u[h], 32), h++;\n\n    for (; h < u.length && \"|\" !== u[h];) {\n      n = parseInt(u[h], 32) + r, h++, r = n, i = parseInt(u[h], 32) + o, h++, o = i;\n      const e = [n / c, i / c];\n      f && (l = parseInt(u[f], 32) + s, f++, s = l, e.push(l / y)), d && (m = parseInt(u[d], 32) + a, d++, a = m, e.push(m / g)), p.push(e);\n    }\n\n    return {\n      paths: [p],\n      hasZ: f > 0,\n      hasM: d > 0,\n      spatialReference: t\n    };\n  }\n\n  _mergePolylinesToSinglePath(e, t) {\n    let r = [];\n    (e || []).forEach(e => {\n      e.paths.forEach(e => {\n        r = r.concat(e);\n      });\n    });\n    const o = [];\n    let s = [0, 0];\n    return r.forEach(e => {\n      e[0] === s[0] && e[1] === s[1] || (o.push(e), s = e);\n    }), new m({\n      paths: [o]\n    }, t);\n  }\n\n};\ne([o({\n  type: l,\n  json: {\n    read: {\n      source: \"summary.envelope\"\n    }\n  }\n})], u.prototype, \"extent\", void 0), e([o()], u.prototype, \"features\", void 0), e([s(\"features\")], u.prototype, \"readFeatures\", null), e([o()], u.prototype, \"geometryType\", void 0), e([o({\n  readOnly: !0\n})], u.prototype, \"mergedGeometry\", null), e([o()], u.prototype, \"routeId\", void 0), e([o()], u.prototype, \"routeName\", void 0), e([o({\n  value: null,\n  readOnly: !0\n})], u.prototype, \"strings\", null), e([o({\n  json: {\n    read: {\n      source: \"summary.totalDriveTime\"\n    }\n  }\n})], u.prototype, \"totalDriveTime\", void 0), e([o({\n  json: {\n    read: {\n      source: \"summary.totalLength\"\n    }\n  }\n})], u.prototype, \"totalLength\", void 0), e([o({\n  json: {\n    read: {\n      source: \"summary.totalTime\"\n    }\n  }\n})], u.prototype, \"totalTime\", void 0), u = e([a(\"esri.rest.support.DirectionsFeatureSet\")], u);\nvar c = u;\nexport default c;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/rest/support/DirectionsFeatureSet.js"],"names":["_","e","t","unwrap","r","property","o","reader","s","subclass","a","p","n","i","m","l","u","constructor","extent","features","geometryType","routeId","routeName","totalDriveTime","totalLength","totalTime","readFeatures","forEach","_decompressFeatureGeometry","summary","envelope","spatialReference","fromJSON","map","geometry","strings","events","x","point","y","z","hasZ","attributes","ETA","arriveTimeUTC","mergedGeometry","get","_mergePolylinesToSinglePath","_decompressGeometry","compressedGeometry","c","g","h","f","d","match","parseInt","indexOf","length","push","paths","hasM","concat","type","json","read","source","prototype","readOnly","value"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import t from\"../../Graphic.js\";import{unwrap as r}from\"../../core/maybe.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{reader as s}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import p from\"./FeatureSet.js\";import n from\"../../geometry/SpatialReference.js\";import i from\"../../geometry/Point.js\";import m from\"../../geometry/Polyline.js\";import l from\"../../geometry/Extent.js\";let u=class extends p{constructor(e){super(e),this.extent=null,this.features=null,this.geometryType=\"polyline\",this.routeId=null,this.routeName=null,this.totalDriveTime=null,this.totalLength=null,this.totalTime=null}readFeatures(e,o){(e||[]).forEach((e=>{this._decompressFeatureGeometry(e,o.summary.envelope.spatialReference)}));const s=n.fromJSON(o.spatialReference);return e.map((e=>{const o=t.fromJSON(e),a=e.geometry&&e.geometry.spatialReference;return o.geometry&&!a&&(r(o.geometry).spatialReference=s),o.strings=e.strings,o.events=(e.events||[]).map((r=>{const o=new t({geometry:new i({x:r.point.x,y:r.point.y,z:r.point.z,hasZ:void 0!==r.point.z,spatialReference:e.geometry&&e.geometry.spatialReference}),attributes:{ETA:r.ETA,arriveTimeUTC:r.arriveTimeUTC}});return o.strings=r.strings,o})),o}))}get mergedGeometry(){if(!this.features)return null;const e=this.features.map((({geometry:e})=>r(e))),t=this.get(\"extent.spatialReference\");return this._mergePolylinesToSinglePath(e,t)}get strings(){return this.features.map((({strings:e})=>e))}_decompressFeatureGeometry(e,t){e.geometry=this._decompressGeometry(e.compressedGeometry,t)}_decompressGeometry(e,t){let r=0,o=0,s=0,a=0;const p=[];let n,i,m,l,u,c,y,g,h=0,f=0,d=0;if(u=e.match(/((\\+|\\-)[^\\+\\-\\|]+|\\|)/g),u||(u=[]),0===parseInt(u[h],32)){h=2;const e=parseInt(u[h],32);h++,c=parseInt(u[h],32),h++,1&e&&(f=u.indexOf(\"|\")+1,y=parseInt(u[f],32),f++),2&e&&(d=u.indexOf(\"|\",f)+1,g=parseInt(u[d],32),d++)}else c=parseInt(u[h],32),h++;for(;h<u.length&&\"|\"!==u[h];){n=parseInt(u[h],32)+r,h++,r=n,i=parseInt(u[h],32)+o,h++,o=i;const e=[n/c,i/c];f&&(l=parseInt(u[f],32)+s,f++,s=l,e.push(l/y)),d&&(m=parseInt(u[d],32)+a,d++,a=m,e.push(m/g)),p.push(e)}return{paths:[p],hasZ:f>0,hasM:d>0,spatialReference:t}}_mergePolylinesToSinglePath(e,t){let r=[];(e||[]).forEach((e=>{e.paths.forEach((e=>{r=r.concat(e)}))}));const o=[];let s=[0,0];return r.forEach((e=>{e[0]===s[0]&&e[1]===s[1]||(o.push(e),s=e)})),new m({paths:[o]},t)}};e([o({type:l,json:{read:{source:\"summary.envelope\"}}})],u.prototype,\"extent\",void 0),e([o()],u.prototype,\"features\",void 0),e([s(\"features\")],u.prototype,\"readFeatures\",null),e([o()],u.prototype,\"geometryType\",void 0),e([o({readOnly:!0})],u.prototype,\"mergedGeometry\",null),e([o()],u.prototype,\"routeId\",void 0),e([o()],u.prototype,\"routeName\",void 0),e([o({value:null,readOnly:!0})],u.prototype,\"strings\",null),e([o({json:{read:{source:\"summary.totalDriveTime\"}}})],u.prototype,\"totalDriveTime\",void 0),e([o({json:{read:{source:\"summary.totalLength\"}}})],u.prototype,\"totalLength\",void 0),e([o({json:{read:{source:\"summary.totalTime\"}}})],u.prototype,\"totalTime\",void 0),u=e([a(\"esri.rest.support.DirectionsFeatureSet\")],u);var c=u;export default c;\n"]},"metadata":{},"sourceType":"module"}