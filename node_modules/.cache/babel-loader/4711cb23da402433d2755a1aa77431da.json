{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { nullifyNonnullableForDispose as t } from \"./maybe.js\";\nimport e from \"./nextTick.js\";\nimport { a as s } from \"../chunks/mat3f64.js\";\nimport { a as i } from \"../chunks/mat4f64.js\";\nimport { c as r } from \"../chunks/quatf64.js\";\nimport { c as f } from \"../chunks/vec2f64.js\";\nimport { b as h } from \"../chunks/vec3f64.js\";\nimport { a as m } from \"../chunks/vec4f64.js\";\n\nclass a {\n  constructor(t, s, i) {\n    this.itemByteSize = t, this.itemCreate = s, this.buffers = [], this.items = [], this.itemsPerBuffer = 0, this.itemsPtr = 0, this.itemsPerBuffer = Math.ceil(i / this.itemByteSize), this.tickHandle = e.before(() => this.reset());\n  }\n\n  destroy() {\n    this.tickHandle && (this.tickHandle.remove(), this.tickHandle = t(this.tickHandle)), this.itemsPtr = 0, this.items = t(this.items), this.buffers = t(this.buffers);\n  }\n\n  get() {\n    0 === this.itemsPtr && e(() => {});\n    const t = Math.floor(this.itemsPtr / this.itemsPerBuffer);\n\n    for (; this.buffers.length <= t;) {\n      const t = new ArrayBuffer(this.itemsPerBuffer * this.itemByteSize);\n\n      for (let e = 0; e < this.itemsPerBuffer; ++e) this.items.push(this.itemCreate(t, e * this.itemByteSize));\n\n      this.buffers.push(t);\n    }\n\n    return this.items[this.itemsPtr++];\n  }\n\n  reset() {\n    const t = 2 * (Math.floor(this.itemsPtr / this.itemsPerBuffer) + 1);\n\n    for (; this.buffers.length > t;) this.buffers.pop(), this.items.length = this.buffers.length * this.itemsPerBuffer;\n\n    this.itemsPtr = 0;\n  }\n\n  static createVec2f64(t = c) {\n    return new a(16, f, t);\n  }\n\n  static createVec3f64(t = c) {\n    return new a(24, h, t);\n  }\n\n  static createVec4f64(t = c) {\n    return new a(32, m, t);\n  }\n\n  static createMat3f64(t = c) {\n    return new a(72, s, t);\n  }\n\n  static createMat4f64(t = c) {\n    return new a(128, i, t);\n  }\n\n  static createQuatf64(t = c) {\n    return new a(32, r, t);\n  }\n\n  get test() {\n    return {\n      size: this.buffers.length * this.itemsPerBuffer * this.itemByteSize\n    };\n  }\n\n}\n\nconst c = 4096;\nexport { a as VectorStack };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/core/VectorStack.js"],"names":["nullifyNonnullableForDispose","t","e","a","s","i","c","r","f","b","h","m","constructor","itemByteSize","itemCreate","buffers","items","itemsPerBuffer","itemsPtr","Math","ceil","tickHandle","before","reset","destroy","remove","get","floor","length","ArrayBuffer","push","pop","createVec2f64","createVec3f64","createVec4f64","createMat3f64","createMat4f64","createQuatf64","test","size","VectorStack"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{nullifyNonnullableForDispose as t}from\"./maybe.js\";import e from\"./nextTick.js\";import{a as s}from\"../chunks/mat3f64.js\";import{a as i}from\"../chunks/mat4f64.js\";import{c as r}from\"../chunks/quatf64.js\";import{c as f}from\"../chunks/vec2f64.js\";import{b as h}from\"../chunks/vec3f64.js\";import{a as m}from\"../chunks/vec4f64.js\";class a{constructor(t,s,i){this.itemByteSize=t,this.itemCreate=s,this.buffers=[],this.items=[],this.itemsPerBuffer=0,this.itemsPtr=0,this.itemsPerBuffer=Math.ceil(i/this.itemByteSize),this.tickHandle=e.before((()=>this.reset()))}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=t(this.tickHandle)),this.itemsPtr=0,this.items=t(this.items),this.buffers=t(this.buffers)}get(){0===this.itemsPtr&&e((()=>{}));const t=Math.floor(this.itemsPtr/this.itemsPerBuffer);for(;this.buffers.length<=t;){const t=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize);for(let e=0;e<this.itemsPerBuffer;++e)this.items.push(this.itemCreate(t,e*this.itemByteSize));this.buffers.push(t)}return this.items[this.itemsPtr++]}reset(){const t=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);for(;this.buffers.length>t;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;this.itemsPtr=0}static createVec2f64(t=c){return new a(16,f,t)}static createVec3f64(t=c){return new a(24,h,t)}static createVec4f64(t=c){return new a(32,m,t)}static createMat3f64(t=c){return new a(72,s,t)}static createMat4f64(t=c){return new a(128,i,t)}static createQuatf64(t=c){return new a(32,r,t)}get test(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}}}const c=4096;export{a as VectorStack};\n"]},"metadata":{},"sourceType":"module"}