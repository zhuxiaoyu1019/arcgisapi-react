{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport r from \"../PopupTemplate.js\";\nimport { read as t, rasterRendererTypes as o, websceneRasterRendererTypes as i } from \"../rasterRenderers.js\";\nimport s from \"../core/Error.js\";\nimport { isSome as a } from \"../core/maybe.js\";\nimport { MultiOriginJSONMixin as p } from \"../core/MultiOriginJSONSupport.js\";\nimport { throwIfAbortError as n } from \"../core/promiseUtils.js\";\nimport { property as l } from \"../core/accessorSupport/decorators/property.js\";\nimport \"../core/has.js\";\nimport { Integer as d } from \"../core/accessorSupport/ensureType.js\";\nimport \"../core/Logger.js\";\nimport { enumeration as m } from \"../core/accessorSupport/decorators/enumeration.js\";\nimport { reader as u } from \"../core/accessorSupport/decorators/reader.js\";\nimport { subclass as c } from \"../core/accessorSupport/decorators/subclass.js\";\nimport y from \"./Layer.js\";\nimport { BlendLayer as h } from \"./mixins/BlendLayer.js\";\nimport { CustomParametersMixin as f } from \"./mixins/CustomParametersMixin.js\";\nimport { ImageryTileMixin as g } from \"./mixins/ImageryTileMixin.js\";\nimport { OperationalLayer as v } from \"./mixins/OperationalLayer.js\";\nimport { PortalLayer as j } from \"./mixins/PortalLayer.js\";\nimport { RefreshableLayer as S } from \"./mixins/RefreshableLayer.js\";\nimport { ScaleRangeLayer as P } from \"./mixins/ScaleRangeLayer.js\";\nimport { legendEnabled as w } from \"./support/commonProperties.js\";\nimport T from \"./support/Field.js\";\nimport { interpolationKebab as b } from \"./support/rasterEnums.js\";\nimport I from \"./support/rasterDatasets/RasterFactory.js\";\nimport { createPopupTemplate as O } from \"../support/popupUtils.js\";\n\nfunction R() {\n  return {\n    enabled: !this.loaded || \"RasterTileServer\" === this.raster.datasetFormat && \"Raster\" === this.raster.tileType\n  };\n}\n\nlet x = class extends h(P(S(v(j(f(g(p(y)))))))) {\n  constructor(...e) {\n    super(...e), this.bandIds = null, this.interpolation = null, this.legendEnabled = !0, this.isReference = null, this.listMode = \"show\", this.sourceJSON = null, this.version = null, this.title = null, this.type = \"imagery-tile\", this.operationalLayerType = \"ArcGISTiledImageServiceLayer\", this.popupEnabled = !0, this.popupTemplate = null, this.fields = null;\n  }\n\n  normalizeCtorArgs(e, r) {\n    return \"string\" == typeof e ? {\n      url: e,\n      ...r\n    } : e;\n  }\n\n  load(e) {\n    const r = a(e) ? e.signal : null;\n    return this.addResolvingPromise(this.loadFromPortal({\n      supportedTypes: [\"Image Service\"]\n    }, e).catch(n).then(() => this._openRaster(r))), Promise.resolve(this);\n  }\n\n  get defaultPopupTemplate() {\n    return this.createPopupTemplate();\n  }\n\n  get rasterFields() {\n    var e, r;\n    let t = [new T({\n      name: \"Raster.ServicePixelValue\",\n      alias: \"Pixel Value\",\n      domain: null,\n      editable: !1,\n      length: 50,\n      type: \"string\"\n    })];\n    const o = null == (e = this.rasterInfo) || null == (r = e.attributeTable) ? void 0 : r.fields,\n          i = \"Raster.\";\n\n    if (o) {\n      const e = o.filter(e => \"oid\" !== e.type && \"value\" !== e.name.toLowerCase()).map(e => {\n        const r = e.clone();\n        return r.name = i + e.name, r;\n      });\n      t = t.concat(e);\n    }\n\n    return t;\n  }\n\n  set renderer(e) {\n    this._set(\"renderer\", e), this.updateRenderer();\n  }\n\n  readRenderer(e, r, o) {\n    const i = r && r.layerDefinition && r.layerDefinition.drawingInfo && r.layerDefinition.drawingInfo.renderer,\n          s = t(i, o) || void 0;\n    if (null != s) return s;\n  }\n\n  createPopupTemplate(e) {\n    return O({\n      fields: this.rasterFields,\n      title: this.title\n    }, e);\n  }\n\n  write(e, r) {\n    const {\n      raster: t\n    } = this;\n    if (this.loaded ? \"RasterTileServer\" === t.datasetFormat && (\"Raster\" === t.tileType || \"Map\" === t.tileType) : this.url && /\\/ImageServer(\\/|\\/?$)/i.test(this.url)) return super.write(e, r);\n\n    if (r && r.messages) {\n      const e = `${r.origin}/${r.layerContainerType || \"operational-layers\"}`;\n      r.messages.push(new s(\"layer:unsupported\", `Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e}'`, {\n        layer: this\n      }));\n    }\n\n    return null;\n  }\n\n  async _openRaster(e) {\n    this.raster ? (this.raster.rasterInfo || (await this.raster.open()), this.url = this.raster.url) : this.raster = await I.open({\n      url: this.url,\n      sourceJSON: this.sourceJSON,\n      ioConfig: {\n        sampling: \"closest\",\n        ...this.ioConfig,\n        customFetchParameters: this.customParameters\n      },\n      signal: e\n    });\n    const {\n      rasterInfo: r\n    } = this.raster;\n    if (!r) throw new s(\"imagery-tile-layer:load\", \"cannot load resources on \" + this.url);\n    this.sourceJSON = this.sourceJSON || this.raster.sourceJSON, null != this.sourceJSON && (this._set(\"version\", this.sourceJSON.currentVersion), this._set(\"copyright\", this.sourceJSON.copyrightText)), null == this.title && (this.title = this.raster.datasetName), \"Map\" === this.raster.tileType && (this.popupEnabled = !1), this._configDefaultSettings(), this.watch(\"customParameters\", e => this.raster.ioConfig.customFetchParameters = e);\n  }\n\n};\ne([l({\n  type: [d],\n  json: {\n    write: {\n      overridePolicy: R\n    }\n  }\n})], x.prototype, \"bandIds\", void 0), e([l({\n  json: {\n    write: {\n      overridePolicy: R\n    }\n  }\n}), m(b)], x.prototype, \"interpolation\", void 0), e([l({\n  json: {\n    write: !0\n  }\n})], x.prototype, \"multidimensionalDefinition\", void 0), e([l(w)], x.prototype, \"legendEnabled\", void 0), e([l({\n  type: Boolean,\n  json: {\n    read: !1,\n    write: {\n      enabled: !0,\n      overridePolicy: () => ({\n        enabled: !1\n      })\n    }\n  }\n})], x.prototype, \"isReference\", void 0), e([l({\n  type: [\"show\", \"hide\"]\n})], x.prototype, \"listMode\", void 0), e([l()], x.prototype, \"sourceJSON\", void 0), e([l({\n  readOnly: !0\n})], x.prototype, \"version\", void 0), e([l()], x.prototype, \"title\", void 0), e([l({\n  readOnly: !0,\n  json: {\n    read: !1\n  }\n})], x.prototype, \"type\", void 0), e([l({\n  type: [\"ArcGISTiledImageServiceLayer\"]\n})], x.prototype, \"operationalLayerType\", void 0), e([l({\n  type: Boolean,\n  value: !0,\n  json: {\n    read: {\n      source: \"disablePopup\",\n      reader: (e, r) => !r.disablePopup\n    },\n    write: {\n      target: \"disablePopup\",\n      overridePolicy: R,\n\n      writer(e, r, t) {\n        r[t] = !e;\n      }\n\n    }\n  }\n})], x.prototype, \"popupEnabled\", void 0), e([l({\n  type: r,\n  json: {\n    read: {\n      source: \"popupInfo\"\n    },\n    write: {\n      target: \"popupInfo\",\n      overridePolicy: R\n    }\n  }\n})], x.prototype, \"popupTemplate\", void 0), e([l({\n  readOnly: !0\n})], x.prototype, \"defaultPopupTemplate\", null), e([l({\n  readOnly: !0,\n  type: [T]\n})], x.prototype, \"fields\", void 0), e([l({\n  readOnly: !0,\n  type: [T]\n})], x.prototype, \"rasterFields\", null), e([l({\n  types: o,\n  json: {\n    name: \"layerDefinition.drawingInfo.renderer\",\n    write: {\n      overridePolicy: R\n    },\n    origins: {\n      \"web-scene\": {\n        types: i,\n        name: \"layerDefinition.drawingInfo.renderer\",\n        write: {\n          overridePolicy: e => ({\n            enabled: e && \"vector-field\" !== e.type\n          })\n        }\n      }\n    }\n  }\n})], x.prototype, \"renderer\", null), e([u(\"renderer\")], x.prototype, \"readRenderer\", null), x = e([c(\"esri.layers.ImageryTileLayer\")], x);\nvar L = x;\nexport default L;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/layers/ImageryTileLayer.js"],"names":["_","e","r","read","t","rasterRendererTypes","o","websceneRasterRendererTypes","i","s","isSome","a","MultiOriginJSONMixin","p","throwIfAbortError","n","property","l","Integer","d","enumeration","m","reader","u","subclass","c","y","BlendLayer","h","CustomParametersMixin","f","ImageryTileMixin","g","OperationalLayer","v","PortalLayer","j","RefreshableLayer","S","ScaleRangeLayer","P","legendEnabled","w","T","interpolationKebab","b","I","createPopupTemplate","O","R","enabled","loaded","raster","datasetFormat","tileType","x","constructor","bandIds","interpolation","isReference","listMode","sourceJSON","version","title","type","operationalLayerType","popupEnabled","popupTemplate","fields","normalizeCtorArgs","url","load","signal","addResolvingPromise","loadFromPortal","supportedTypes","catch","then","_openRaster","Promise","resolve","defaultPopupTemplate","rasterFields","name","alias","domain","editable","length","rasterInfo","attributeTable","filter","toLowerCase","map","clone","concat","renderer","_set","updateRenderer","readRenderer","layerDefinition","drawingInfo","write","test","messages","origin","layerContainerType","push","id","declaredClass","layer","open","ioConfig","sampling","customFetchParameters","customParameters","currentVersion","copyrightText","datasetName","_configDefaultSettings","watch","json","overridePolicy","prototype","Boolean","readOnly","value","source","disablePopup","target","writer","types","origins","L"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import r from\"../PopupTemplate.js\";import{read as t,rasterRendererTypes as o,websceneRasterRendererTypes as i}from\"../rasterRenderers.js\";import s from\"../core/Error.js\";import{isSome as a}from\"../core/maybe.js\";import{MultiOriginJSONMixin as p}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as n}from\"../core/promiseUtils.js\";import{property as l}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import{Integer as d}from\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{enumeration as m}from\"../core/accessorSupport/decorators/enumeration.js\";import{reader as u}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as c}from\"../core/accessorSupport/decorators/subclass.js\";import y from\"./Layer.js\";import{BlendLayer as h}from\"./mixins/BlendLayer.js\";import{CustomParametersMixin as f}from\"./mixins/CustomParametersMixin.js\";import{ImageryTileMixin as g}from\"./mixins/ImageryTileMixin.js\";import{OperationalLayer as v}from\"./mixins/OperationalLayer.js\";import{PortalLayer as j}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as S}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as P}from\"./mixins/ScaleRangeLayer.js\";import{legendEnabled as w}from\"./support/commonProperties.js\";import T from\"./support/Field.js\";import{interpolationKebab as b}from\"./support/rasterEnums.js\";import I from\"./support/rasterDatasets/RasterFactory.js\";import{createPopupTemplate as O}from\"../support/popupUtils.js\";function R(){return{enabled:!this.loaded||\"RasterTileServer\"===this.raster.datasetFormat&&\"Raster\"===this.raster.tileType}}let x=class extends(h(P(S(v(j(f(g(p(y))))))))){constructor(...e){super(...e),this.bandIds=null,this.interpolation=null,this.legendEnabled=!0,this.isReference=null,this.listMode=\"show\",this.sourceJSON=null,this.version=null,this.title=null,this.type=\"imagery-tile\",this.operationalLayerType=\"ArcGISTiledImageServiceLayer\",this.popupEnabled=!0,this.popupTemplate=null,this.fields=null}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const r=a(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Image Service\"]},e).catch(n).then((()=>this._openRaster(r)))),Promise.resolve(this)}get defaultPopupTemplate(){return this.createPopupTemplate()}get rasterFields(){var e,r;let t=[new T({name:\"Raster.ServicePixelValue\",alias:\"Pixel Value\",domain:null,editable:!1,length:50,type:\"string\"})];const o=null==(e=this.rasterInfo)||null==(r=e.attributeTable)?void 0:r.fields,i=\"Raster.\";if(o){const e=o.filter((e=>\"oid\"!==e.type&&\"value\"!==e.name.toLowerCase())).map((e=>{const r=e.clone();return r.name=i+e.name,r}));t=t.concat(e)}return t}set renderer(e){this._set(\"renderer\",e),this.updateRenderer()}readRenderer(e,r,o){const i=r&&r.layerDefinition&&r.layerDefinition.drawingInfo&&r.layerDefinition.drawingInfo.renderer,s=t(i,o)||void 0;if(null!=s)return s}createPopupTemplate(e){return O({fields:this.rasterFields,title:this.title},e)}write(e,r){const{raster:t}=this;if(this.loaded?\"RasterTileServer\"===t.datasetFormat&&(\"Raster\"===t.tileType||\"Map\"===t.tileType):this.url&&/\\/ImageServer(\\/|\\/?$)/i.test(this.url))return super.write(e,r);if(r&&r.messages){const e=`${r.origin}/${r.layerContainerType||\"operational-layers\"}`;r.messages.push(new s(\"layer:unsupported\",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e}'`,{layer:this}))}return null}async _openRaster(e){this.raster?(this.raster.rasterInfo||await this.raster.open(),this.url=this.raster.url):this.raster=await I.open({url:this.url,sourceJSON:this.sourceJSON,ioConfig:{sampling:\"closest\",...this.ioConfig,customFetchParameters:this.customParameters},signal:e});const{rasterInfo:r}=this.raster;if(!r)throw new s(\"imagery-tile-layer:load\",\"cannot load resources on \"+this.url);this.sourceJSON=this.sourceJSON||this.raster.sourceJSON,null!=this.sourceJSON&&(this._set(\"version\",this.sourceJSON.currentVersion),this._set(\"copyright\",this.sourceJSON.copyrightText)),null==this.title&&(this.title=this.raster.datasetName),\"Map\"===this.raster.tileType&&(this.popupEnabled=!1),this._configDefaultSettings(),this.watch(\"customParameters\",(e=>this.raster.ioConfig.customFetchParameters=e))}};e([l({type:[d],json:{write:{overridePolicy:R}}})],x.prototype,\"bandIds\",void 0),e([l({json:{write:{overridePolicy:R}}}),m(b)],x.prototype,\"interpolation\",void 0),e([l({json:{write:!0}})],x.prototype,\"multidimensionalDefinition\",void 0),e([l(w)],x.prototype,\"legendEnabled\",void 0),e([l({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],x.prototype,\"isReference\",void 0),e([l({type:[\"show\",\"hide\"]})],x.prototype,\"listMode\",void 0),e([l()],x.prototype,\"sourceJSON\",void 0),e([l({readOnly:!0})],x.prototype,\"version\",void 0),e([l()],x.prototype,\"title\",void 0),e([l({readOnly:!0,json:{read:!1}})],x.prototype,\"type\",void 0),e([l({type:[\"ArcGISTiledImageServiceLayer\"]})],x.prototype,\"operationalLayerType\",void 0),e([l({type:Boolean,value:!0,json:{read:{source:\"disablePopup\",reader:(e,r)=>!r.disablePopup},write:{target:\"disablePopup\",overridePolicy:R,writer(e,r,t){r[t]=!e}}}})],x.prototype,\"popupEnabled\",void 0),e([l({type:r,json:{read:{source:\"popupInfo\"},write:{target:\"popupInfo\",overridePolicy:R}}})],x.prototype,\"popupTemplate\",void 0),e([l({readOnly:!0})],x.prototype,\"defaultPopupTemplate\",null),e([l({readOnly:!0,type:[T]})],x.prototype,\"fields\",void 0),e([l({readOnly:!0,type:[T]})],x.prototype,\"rasterFields\",null),e([l({types:o,json:{name:\"layerDefinition.drawingInfo.renderer\",write:{overridePolicy:R},origins:{\"web-scene\":{types:i,name:\"layerDefinition.drawingInfo.renderer\",write:{overridePolicy:e=>({enabled:e&&\"vector-field\"!==e.type})}}}}})],x.prototype,\"renderer\",null),e([u(\"renderer\")],x.prototype,\"readRenderer\",null),x=e([c(\"esri.layers.ImageryTileLayer\")],x);var L=x;export default L;\n"]},"metadata":{},"sourceType":"module"}