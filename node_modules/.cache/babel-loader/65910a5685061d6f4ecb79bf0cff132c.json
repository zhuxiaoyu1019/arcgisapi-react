{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { getAssetUrl as e } from \"../../assets.js\";\nimport { toHSV as t, toRGB as s } from \"../../core/colorUtils.js\";\nimport \"../../core/has.js\";\nimport r from \"../../core/Error.js\";\nimport o from \"../../core/Logger.js\";\nimport { isNone as a, isSome as l } from \"../../core/maybe.js\";\nimport { eachAlways as n } from \"../../core/promiseUtils.js\";\nimport { pt2px as i } from \"../../core/screenUtils.js\";\nimport { getPatternUrlWithColor as c, defaultThematicColor as h } from \"./gfxUtils.js\";\nimport { defaultPrimitive as u } from \"./IconSymbol3DLayerResource.js\";\nimport { defaultPrimitive as p } from \"./ObjectSymbol3DLayerResource.js\";\nimport { adjustColorComponentBrightness as m, getPathSymbolShapes as f, shapes as y, getTetrahedronShapes as d, getDiamondShapes as b, getCylinderShapes as v, getCubeShapes as g, getInvertedConeShapes as k, getConeShapes as w, getWaterSymbolShapes as x, getExtrudeSymbolShapes as M } from \"./previewUtils.js\";\nimport { renderSymbol as L, tintImageWithColor as j } from \"./renderUtils.js\";\nimport { resolveWebStyleSymbol as z } from \"./styleUtils.js\";\nimport { isVolumetricSymbol as P, getIconHref as S } from \"./utils.js\";\nconst U = 22,\n      D = 120,\n      O = 80,\n      I = 40,\n      R = 20,\n      E = o.getLogger(\"esri.symbols.support.previewSymbol3D\");\n\nfunction C(e) {\n  const t = e.outline,\n        s = l(e.material) ? e.material.color : null,\n        r = l(s) ? s.toHex() : null;\n  if (a(t)) return \"fill\" === e.type && \"#ffffff\" === r ? {\n    color: \"#bdc3c7\",\n    width: .75\n  } : null;\n  const o = i(t.size) || 0;\n  return {\n    color: \"rgba(\" + (l(t.color) ? t.color.toRgba() : \"255,255,255,1\") + \")\",\n    width: Math.min(o, O)\n  };\n}\n\nfunction Z(t, s) {\n  const r = s && s.resource,\n        o = r && r.href;\n  if (t.thumbnail && t.thumbnail.url) return Promise.resolve(t.thumbnail.url);\n  if (o && \"object\" !== s.type) return Promise.resolve(S(t, s));\n  const a = e(\"esri/images/Legend/legend3dsymboldefault.png\");\n  return t.styleOrigin && (t.styleOrigin.styleName || t.styleOrigin.styleUrl) ? z(t.styleOrigin, {\n    portal: t.styleOrigin.portal\n  }, \"webRef\").catch(e => e).then(e => {\n    var t;\n    return (null == e || null == (t = e.thumbnail) ? void 0 : t.url) || a;\n  }) : Promise.resolve(a);\n}\n\nfunction q(e, r = 1) {\n  const o = e.a,\n        a = t(e),\n        l = a.h,\n        n = a.s / r,\n        i = 100 - (100 - a.v) / r,\n        {\n    r: c,\n    g: h,\n    b: u\n  } = s({\n    h: l,\n    s: n,\n    v: i\n  });\n  return [c, h, u, o];\n}\n\nfunction A(e) {\n  return \"water\" === e.type ? a(e.color) ? null : e.color : a(e.material) || a(e.material.color) ? null : e.material.color;\n}\n\nfunction H(e, t = 0) {\n  const s = A(e);\n\n  if (!s) {\n    if (\"fill\" === e.type) return null;\n    const s = h.r,\n          r = m(s, t);\n    return [r, r, r, 100];\n  }\n\n  const r = s.toRgba();\n\n  for (let o = 0; o < 3; o++) r[o] = m(r[o], t);\n\n  return r;\n}\n\nasync function N(t, s) {\n  const r = t.style;\n  if (\"none\" === r) return null;\n  return {\n    type: \"pattern\",\n    x: 0,\n    y: 0,\n    src: await c(e(`esri/symbols/patterns/${r}.png`), s.toCss(!0)),\n    width: 5,\n    height: 5\n  };\n}\n\nfunction T(e) {\n  return e.outline ? C(e) : {\n    color: \"rgba(0, 0, 0, 1)\",\n    width: 1.5\n  };\n}\n\nfunction $(e, t) {\n  const s = A(e);\n  if (!s) return null;\n  let r = \"rgba(\";\n  return r += m(s.r, t) + \",\", r += m(s.g, t) + \",\", r += m(s.b, t) + \",\", r + s.a + \");\";\n}\n\nfunction B(e, t) {\n  const s = $(e, t);\n  if (!s) return {};\n  return {\n    color: s,\n    width: Math.min(e.size ? i(e.size) : .75, O)\n  };\n}\n\nfunction F(e, t, s) {\n  const r = .75 * s;\n  return {\n    type: \"linear\",\n    x1: r ? .25 * r : 0,\n    y1: r ? .5 * r : 0,\n    x2: r || 4,\n    y2: r ? .5 * r : 4,\n    colors: [{\n      color: e,\n      offset: 0\n    }, {\n      color: t,\n      offset: 1\n    }]\n  };\n}\n\nfunction G(e) {\n  const t = e.depth,\n        s = e.height,\n        r = e.width;\n  return r && t && s && r === t && r < s;\n}\n\nfunction J(e, t, s) {\n  const r = [];\n  if (!e) return r;\n\n  switch (e.type) {\n    case \"icon\":\n      {\n        const s = 0,\n              o = 0,\n              a = t,\n              l = t;\n\n        switch (e.resource && e.resource.primitive || u) {\n          case \"circle\":\n            r.push({\n              shape: {\n                type: \"circle\",\n                cx: 0,\n                cy: 0,\n                r: .5 * t\n              },\n              fill: H(e, 0),\n              stroke: C(e)\n            });\n            break;\n\n          case \"square\":\n            r.push({\n              shape: {\n                type: \"path\",\n                path: [{\n                  command: \"M\",\n                  values: [s, l]\n                }, {\n                  command: \"L\",\n                  values: [s, o]\n                }, {\n                  command: \"L\",\n                  values: [a, o]\n                }, {\n                  command: \"L\",\n                  values: [a, l]\n                }, {\n                  command: \"Z\",\n                  values: []\n                }]\n              },\n              fill: H(e, 0),\n              stroke: C(e)\n            });\n            break;\n\n          case \"triangle\":\n            r.push({\n              shape: {\n                type: \"path\",\n                path: [{\n                  command: \"M\",\n                  values: [s, l]\n                }, {\n                  command: \"L\",\n                  values: [.5 * a, o]\n                }, {\n                  command: \"L\",\n                  values: [a, l]\n                }, {\n                  command: \"Z\",\n                  values: []\n                }]\n              },\n              fill: H(e, 0),\n              stroke: C(e)\n            });\n            break;\n\n          case \"cross\":\n            r.push({\n              shape: {\n                type: \"path\",\n                path: [{\n                  command: \"M\",\n                  values: [.5 * a, o]\n                }, {\n                  command: \"L\",\n                  values: [.5 * a, l]\n                }, {\n                  command: \"M\",\n                  values: [s, .5 * l]\n                }, {\n                  command: \"L\",\n                  values: [a, .5 * l]\n                }]\n              },\n              stroke: T(e)\n            });\n            break;\n\n          case \"x\":\n            r.push({\n              shape: {\n                type: \"path\",\n                path: [{\n                  command: \"M\",\n                  values: [s, o]\n                }, {\n                  command: \"L\",\n                  values: [a, l]\n                }, {\n                  command: \"M\",\n                  values: [a, o]\n                }, {\n                  command: \"L\",\n                  values: [s, l]\n                }]\n              },\n              stroke: T(e)\n            });\n            break;\n\n          case \"kite\":\n            r.push({\n              shape: {\n                type: \"path\",\n                path: [{\n                  command: \"M\",\n                  values: [s, .5 * l]\n                }, {\n                  command: \"L\",\n                  values: [.5 * a, o]\n                }, {\n                  command: \"L\",\n                  values: [a, .5 * l]\n                }, {\n                  command: \"L\",\n                  values: [.5 * a, l]\n                }, {\n                  command: \"Z\",\n                  values: []\n                }]\n              },\n              fill: H(e, 0),\n              stroke: C(e)\n            });\n        }\n\n        break;\n      }\n\n    case \"object\":\n      switch (e.resource && e.resource.primitive || p) {\n        case \"cone\":\n          {\n            const o = F(H(e, 0), H(e, -.6), s ? R : t),\n                  a = w(t, s);\n            r.push({\n              shape: a[0],\n              fill: o\n            }), r.push({\n              shape: a[1],\n              fill: o\n            });\n            break;\n          }\n\n        case \"inverted-cone\":\n          {\n            const s = H(e, 0),\n                  o = F(s, H(e, -.6), t),\n                  a = k(t);\n            r.push({\n              shape: a[0],\n              fill: o\n            }), r.push({\n              shape: a[1],\n              fill: s\n            });\n            break;\n          }\n\n        case \"cube\":\n          {\n            const o = g(t, s);\n            r.push({\n              shape: o[0],\n              fill: H(e, 0)\n            }), r.push({\n              shape: o[1],\n              fill: H(e, -.3)\n            }), r.push({\n              shape: o[2],\n              fill: H(e, -.5)\n            });\n            break;\n          }\n\n        case \"cylinder\":\n          {\n            const o = F(H(e, 0), H(e, -.6), s ? R : t),\n                  a = v(t, s);\n            r.push({\n              shape: a[0],\n              fill: o\n            }), r.push({\n              shape: a[1],\n              fill: o\n            }), r.push({\n              shape: a[2],\n              fill: H(e, 0)\n            });\n            break;\n          }\n\n        case \"diamond\":\n          {\n            const s = b(t);\n            r.push({\n              shape: s[0],\n              fill: H(e, -.3)\n            }), r.push({\n              shape: s[1],\n              fill: H(e, 0)\n            }), r.push({\n              shape: s[2],\n              fill: H(e, -.3)\n            }), r.push({\n              shape: s[3],\n              fill: H(e, -.7)\n            });\n            break;\n          }\n\n        case \"sphere\":\n          {\n            const s = F(H(e, 0), H(e, -.6));\n            s.x1 = 0, s.y1 = 0, s.x2 = .25 * t, s.y2 = .25 * t, r.push({\n              shape: {\n                type: \"circle\",\n                cx: 0,\n                cy: 0,\n                r: .5 * t\n              },\n              fill: s\n            });\n            break;\n          }\n\n        case \"tetrahedron\":\n          {\n            const s = d(t);\n            r.push({\n              shape: s[0],\n              fill: H(e, -.3)\n            }), r.push({\n              shape: s[1],\n              fill: H(e, 0)\n            }), r.push({\n              shape: s[2],\n              fill: H(e, -.6)\n            });\n            break;\n          }\n      }\n\n      break;\n  }\n\n  return r;\n}\n\nfunction K(e) {\n  return \"icon\" === e.type ? \"multiply\" : \"tint\";\n}\n\nfunction Q(e, t) {\n  const s = t && t.size ? i(t.size) : null,\n        r = t && t.maxSize ? i(t.maxSize) : null,\n        o = t && t.disableUpsampling,\n        a = e.symbolLayers,\n        l = [];\n  let c = 0,\n      h = 0;\n  const u = a.getItemAt(a.length - 1);\n  let p;\n  return u && \"icon\" === u.type && (p = u.size && i(u.size)), a.forEach(a => {\n    if (\"icon\" !== a.type && \"object\" !== a.type) return;\n    const n = \"icon\" === a.type ? a.size && i(a.size) : 0,\n          u = s || n ? Math.ceil(Math.min(s || n, r || D)) : U;\n\n    if (a && a.resource && a.resource.href) {\n      const t = Z(e, a).then(function (e) {\n        const t = a.get(\"material.color\"),\n              s = K(a);\n        return j(e, u, t, s, o);\n      }).then(function (e) {\n        const t = e.width,\n              s = e.height;\n        return c = Math.max(c, t), h = Math.max(h, s), [{\n          shape: {\n            type: \"image\",\n            x: 0,\n            y: 0,\n            width: t,\n            height: s,\n            src: e.url\n          },\n          fill: null,\n          stroke: null\n        }];\n      });\n      l.push(t);\n    } else {\n      var m;\n      let e = u;\n      \"icon\" === a.type && p && s && (e = u * (n / p));\n      const r = \"tall\" === (null == t ? void 0 : t.symbolConfig) || (null == t || null == (m = t.symbolConfig) ? void 0 : m.isTall) || \"object\" === a.type && G(a);\n      c = Math.max(c, r ? R : e), h = Math.max(h, e), l.push(Promise.resolve(J(a, e, r)));\n    }\n  }), n(l).then(function (e) {\n    const s = [];\n    return e.forEach(function (e) {\n      e.value ? s.push(e.value) : e.error && E.warn(\"error while building swatchInfo!\", e.error);\n    }), L(s, [c, h], {\n      node: t && t.node,\n      scale: !1,\n      opacity: t && t.opacity\n    });\n  });\n}\n\nfunction V(e, t) {\n  const s = e.symbolLayers,\n        r = [],\n        o = P(e),\n        a = t && t.size ? i(t.size) : null,\n        l = (t && t.maxSize ? i(t.maxSize) : null) || O;\n  let n,\n      c = 0,\n      h = 0;\n  return s.forEach((e, t) => {\n    if (!e) return;\n    if (\"line\" !== e.type && \"path\" !== e.type) return;\n    const s = [];\n\n    switch (e.type) {\n      case \"line\":\n        {\n          const r = B(e, 0),\n                o = r && r.width || 0;\n          0 === t && (n = o);\n          const i = Math.min(a || o, l),\n                u = 0 === t ? i : a ? i * (o / n) : i,\n                p = u > I / 2 ? 2 * u : I;\n          h = Math.max(h, u), c = Math.max(c, p), r.width = u, s.push({\n            shape: {\n              type: \"path\",\n              path: [{\n                command: \"M\",\n                values: [0, .5 * h]\n              }, {\n                command: \"L\",\n                values: [c, .5 * h]\n              }]\n            },\n            stroke: r\n          });\n          break;\n        }\n\n      case \"path\":\n        {\n          const t = Math.min(a || U, l),\n                r = H(e, 0),\n                n = H(e, -.2),\n                u = $(e, -.4),\n                p = u ? {\n            color: u,\n            width: 1\n          } : {};\n\n          if (\"quad\" === e.profile) {\n            var o, i;\n            const t = null != (o = e.width) ? o : e.size,\n                  a = null != (i = e.height) ? i : e.size,\n                  l = f(t && a ? t / a : 1, 0 === a, 0 === t),\n                  c = { ...p,\n              join: \"bevel\"\n            };\n            s.push({\n              shape: l[0],\n              fill: n,\n              stroke: c\n            }), s.push({\n              shape: l[1],\n              fill: n,\n              stroke: c\n            }), s.push({\n              shape: l[2],\n              fill: r,\n              stroke: c\n            });\n          } else s.push({\n            shape: y.pathSymbol3DLayer[0],\n            fill: n,\n            stroke: p\n          }), s.push({\n            shape: y.pathSymbol3DLayer[1],\n            fill: r,\n            stroke: p\n          });\n\n          h = Math.max(h, t), c = h;\n        }\n    }\n\n    r.push(s);\n  }), Promise.resolve(L(r, [c, h], {\n    node: t && t.node,\n    scale: o,\n    opacity: t && t.opacity\n  }));\n}\n\nasync function W(e, t) {\n  const s = \"mesh-3d\" === e.type,\n        r = e.symbolLayers,\n        o = t && t.size ? i(t.size) : null,\n        a = t && t.maxSize ? i(t.maxSize) : null,\n        n = o || U,\n        c = [];\n  let h = 0,\n      u = 0,\n      p = !1;\n\n  for (let i = 0; i < r.length; i++) {\n    const e = r.getItemAt(i),\n          t = [];\n    if (s && \"fill\" !== e.type) continue;\n    const o = y.fill[0];\n\n    switch (e.type) {\n      case \"fill\":\n        {\n          const r = C(e),\n                i = Math.min(n, a || D);\n          h = Math.max(h, i), u = Math.max(u, i), p = !0;\n          let c = H(e, 0);\n          const m = \"pattern\" in e && e.pattern,\n                f = A(e);\n          !s && l(m) && \"style\" === m.type && \"solid\" !== m.style && f && (c = await N(m, f)), t.push({\n            shape: o,\n            fill: c,\n            stroke: r\n          });\n          break;\n        }\n\n      case \"line\":\n        {\n          const s = {\n            stroke: B(e, 0),\n            shape: o\n          };\n          h = Math.max(h, U), u = Math.max(u, U), t.push(s);\n          break;\n        }\n\n      case \"extrude\":\n        {\n          const s = {\n            join: \"round\",\n            ...B(e, -.4)\n          },\n                r = H(e, 0),\n                o = H(e, -.2),\n                l = Math.min(n, a || D),\n                i = M(l);\n          s.width = 1, t.push({\n            shape: i[0],\n            fill: o,\n            stroke: s\n          }), t.push({\n            shape: i[1],\n            fill: o,\n            stroke: s\n          }), t.push({\n            shape: i[2],\n            fill: r,\n            stroke: s\n          });\n          const c = U,\n                p = .7 * U + .5 * l;\n          h = Math.max(h, c), u = Math.max(u, p);\n          break;\n        }\n\n      case \"water\":\n        {\n          const s = A(e),\n                r = q(s),\n                o = q(s, 2),\n                l = q(s, 3),\n                i = x();\n          p = !0, t.push({\n            shape: i[0],\n            fill: r\n          }), t.push({\n            shape: i[1],\n            fill: o\n          }), t.push({\n            shape: i[2],\n            fill: l\n          });\n          const c = Math.min(n, a || D);\n          h = Math.max(h, c), u = Math.max(u, c);\n          break;\n        }\n    }\n\n    c.push(t);\n  }\n\n  return Promise.resolve(L(c, [h, u], {\n    node: t && t.node,\n    scale: p,\n    opacity: t && t.opacity\n  }));\n}\n\nfunction X(e, t) {\n  if (0 === e.symbolLayers.length) return Promise.reject(new r(\"symbolPreview: renderPreviewHTML3D\", \"No symbolLayers in the symbol.\"));\n  let s = null;\n\n  switch (e.type) {\n    case \"point-3d\":\n      s = Q(e, t);\n      break;\n\n    case \"line-3d\":\n      s = V(e, t);\n      break;\n\n    case \"polygon-3d\":\n    case \"mesh-3d\":\n      s = W(e, t);\n  }\n\n  return s || Promise.reject(new r(\"symbolPreview: swatchInfo3D\", \"symbol not supported.\"));\n}\n\nexport { N as getPatternDescriptor, H as getSymbolLayerFill, X as previewSymbol3D };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/symbols/support/previewSymbol3D.js"],"names":["getAssetUrl","e","toHSV","t","toRGB","s","r","o","isNone","a","isSome","l","eachAlways","n","pt2px","i","getPatternUrlWithColor","c","defaultThematicColor","h","defaultPrimitive","u","p","adjustColorComponentBrightness","m","getPathSymbolShapes","f","shapes","y","getTetrahedronShapes","d","getDiamondShapes","b","getCylinderShapes","v","getCubeShapes","g","getInvertedConeShapes","k","getConeShapes","w","getWaterSymbolShapes","x","getExtrudeSymbolShapes","M","renderSymbol","L","tintImageWithColor","j","resolveWebStyleSymbol","z","isVolumetricSymbol","P","getIconHref","S","U","D","O","I","R","E","getLogger","C","outline","material","color","toHex","type","width","size","toRgba","Math","min","Z","resource","href","thumbnail","url","Promise","resolve","styleOrigin","styleName","styleUrl","portal","catch","then","q","A","H","N","style","src","toCss","height","T","$","B","F","x1","y1","x2","y2","colors","offset","G","depth","J","primitive","push","shape","cx","cy","fill","stroke","path","command","values","K","Q","maxSize","disableUpsampling","symbolLayers","getItemAt","length","forEach","ceil","get","max","symbolConfig","isTall","value","error","warn","node","scale","opacity","V","profile","join","pathSymbol3DLayer","W","pattern","X","reject","getPatternDescriptor","getSymbolLayerFill","previewSymbol3D"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{getAssetUrl as e}from\"../../assets.js\";import{toHSV as t,toRGB as s}from\"../../core/colorUtils.js\";import\"../../core/has.js\";import r from\"../../core/Error.js\";import o from\"../../core/Logger.js\";import{isNone as a,isSome as l}from\"../../core/maybe.js\";import{eachAlways as n}from\"../../core/promiseUtils.js\";import{pt2px as i}from\"../../core/screenUtils.js\";import{getPatternUrlWithColor as c,defaultThematicColor as h}from\"./gfxUtils.js\";import{defaultPrimitive as u}from\"./IconSymbol3DLayerResource.js\";import{defaultPrimitive as p}from\"./ObjectSymbol3DLayerResource.js\";import{adjustColorComponentBrightness as m,getPathSymbolShapes as f,shapes as y,getTetrahedronShapes as d,getDiamondShapes as b,getCylinderShapes as v,getCubeShapes as g,getInvertedConeShapes as k,getConeShapes as w,getWaterSymbolShapes as x,getExtrudeSymbolShapes as M}from\"./previewUtils.js\";import{renderSymbol as L,tintImageWithColor as j}from\"./renderUtils.js\";import{resolveWebStyleSymbol as z}from\"./styleUtils.js\";import{isVolumetricSymbol as P,getIconHref as S}from\"./utils.js\";const U=22,D=120,O=80,I=40,R=20,E=o.getLogger(\"esri.symbols.support.previewSymbol3D\");function C(e){const t=e.outline,s=l(e.material)?e.material.color:null,r=l(s)?s.toHex():null;if(a(t))return\"fill\"===e.type&&\"#ffffff\"===r?{color:\"#bdc3c7\",width:.75}:null;const o=i(t.size)||0;return{color:\"rgba(\"+(l(t.color)?t.color.toRgba():\"255,255,255,1\")+\")\",width:Math.min(o,O)}}function Z(t,s){const r=s&&s.resource,o=r&&r.href;if(t.thumbnail&&t.thumbnail.url)return Promise.resolve(t.thumbnail.url);if(o&&\"object\"!==s.type)return Promise.resolve(S(t,s));const a=e(\"esri/images/Legend/legend3dsymboldefault.png\");return t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)?z(t.styleOrigin,{portal:t.styleOrigin.portal},\"webRef\").catch((e=>e)).then((e=>{var t;return(null==e||null==(t=e.thumbnail)?void 0:t.url)||a})):Promise.resolve(a)}function q(e,r=1){const o=e.a,a=t(e),l=a.h,n=a.s/r,i=100-(100-a.v)/r,{r:c,g:h,b:u}=s({h:l,s:n,v:i});return[c,h,u,o]}function A(e){return\"water\"===e.type?a(e.color)?null:e.color:a(e.material)||a(e.material.color)?null:e.material.color}function H(e,t=0){const s=A(e);if(!s){if(\"fill\"===e.type)return null;const s=h.r,r=m(s,t);return[r,r,r,100]}const r=s.toRgba();for(let o=0;o<3;o++)r[o]=m(r[o],t);return r}async function N(t,s){const r=t.style;if(\"none\"===r)return null;return{type:\"pattern\",x:0,y:0,src:await c(e(`esri/symbols/patterns/${r}.png`),s.toCss(!0)),width:5,height:5}}function T(e){return e.outline?C(e):{color:\"rgba(0, 0, 0, 1)\",width:1.5}}function $(e,t){const s=A(e);if(!s)return null;let r=\"rgba(\";return r+=m(s.r,t)+\",\",r+=m(s.g,t)+\",\",r+=m(s.b,t)+\",\",r+s.a+\");\"}function B(e,t){const s=$(e,t);if(!s)return{};return{color:s,width:Math.min(e.size?i(e.size):.75,O)}}function F(e,t,s){const r=.75*s;return{type:\"linear\",x1:r?.25*r:0,y1:r?.5*r:0,x2:r||4,y2:r?.5*r:4,colors:[{color:e,offset:0},{color:t,offset:1}]}}function G(e){const t=e.depth,s=e.height,r=e.width;return r&&t&&s&&r===t&&r<s}function J(e,t,s){const r=[];if(!e)return r;switch(e.type){case\"icon\":{const s=0,o=0,a=t,l=t;switch(e.resource&&e.resource.primitive||u){case\"circle\":r.push({shape:{type:\"circle\",cx:0,cy:0,r:.5*t},fill:H(e,0),stroke:C(e)});break;case\"square\":r.push({shape:{type:\"path\",path:[{command:\"M\",values:[s,l]},{command:\"L\",values:[s,o]},{command:\"L\",values:[a,o]},{command:\"L\",values:[a,l]},{command:\"Z\",values:[]}]},fill:H(e,0),stroke:C(e)});break;case\"triangle\":r.push({shape:{type:\"path\",path:[{command:\"M\",values:[s,l]},{command:\"L\",values:[.5*a,o]},{command:\"L\",values:[a,l]},{command:\"Z\",values:[]}]},fill:H(e,0),stroke:C(e)});break;case\"cross\":r.push({shape:{type:\"path\",path:[{command:\"M\",values:[.5*a,o]},{command:\"L\",values:[.5*a,l]},{command:\"M\",values:[s,.5*l]},{command:\"L\",values:[a,.5*l]}]},stroke:T(e)});break;case\"x\":r.push({shape:{type:\"path\",path:[{command:\"M\",values:[s,o]},{command:\"L\",values:[a,l]},{command:\"M\",values:[a,o]},{command:\"L\",values:[s,l]}]},stroke:T(e)});break;case\"kite\":r.push({shape:{type:\"path\",path:[{command:\"M\",values:[s,.5*l]},{command:\"L\",values:[.5*a,o]},{command:\"L\",values:[a,.5*l]},{command:\"L\",values:[.5*a,l]},{command:\"Z\",values:[]}]},fill:H(e,0),stroke:C(e)})}break}case\"object\":switch(e.resource&&e.resource.primitive||p){case\"cone\":{const o=F(H(e,0),H(e,-.6),s?R:t),a=w(t,s);r.push({shape:a[0],fill:o}),r.push({shape:a[1],fill:o});break}case\"inverted-cone\":{const s=H(e,0),o=F(s,H(e,-.6),t),a=k(t);r.push({shape:a[0],fill:o}),r.push({shape:a[1],fill:s});break}case\"cube\":{const o=g(t,s);r.push({shape:o[0],fill:H(e,0)}),r.push({shape:o[1],fill:H(e,-.3)}),r.push({shape:o[2],fill:H(e,-.5)});break}case\"cylinder\":{const o=F(H(e,0),H(e,-.6),s?R:t),a=v(t,s);r.push({shape:a[0],fill:o}),r.push({shape:a[1],fill:o}),r.push({shape:a[2],fill:H(e,0)});break}case\"diamond\":{const s=b(t);r.push({shape:s[0],fill:H(e,-.3)}),r.push({shape:s[1],fill:H(e,0)}),r.push({shape:s[2],fill:H(e,-.3)}),r.push({shape:s[3],fill:H(e,-.7)});break}case\"sphere\":{const s=F(H(e,0),H(e,-.6));s.x1=0,s.y1=0,s.x2=.25*t,s.y2=.25*t,r.push({shape:{type:\"circle\",cx:0,cy:0,r:.5*t},fill:s});break}case\"tetrahedron\":{const s=d(t);r.push({shape:s[0],fill:H(e,-.3)}),r.push({shape:s[1],fill:H(e,0)}),r.push({shape:s[2],fill:H(e,-.6)});break}}break}return r}function K(e){return\"icon\"===e.type?\"multiply\":\"tint\"}function Q(e,t){const s=t&&t.size?i(t.size):null,r=t&&t.maxSize?i(t.maxSize):null,o=t&&t.disableUpsampling,a=e.symbolLayers,l=[];let c=0,h=0;const u=a.getItemAt(a.length-1);let p;return u&&\"icon\"===u.type&&(p=u.size&&i(u.size)),a.forEach((a=>{if(\"icon\"!==a.type&&\"object\"!==a.type)return;const n=\"icon\"===a.type?a.size&&i(a.size):0,u=s||n?Math.ceil(Math.min(s||n,r||D)):U;if(a&&a.resource&&a.resource.href){const t=Z(e,a).then((function(e){const t=a.get(\"material.color\"),s=K(a);return j(e,u,t,s,o)})).then((function(e){const t=e.width,s=e.height;return c=Math.max(c,t),h=Math.max(h,s),[{shape:{type:\"image\",x:0,y:0,width:t,height:s,src:e.url},fill:null,stroke:null}]}));l.push(t)}else{var m;let e=u;\"icon\"===a.type&&p&&s&&(e=u*(n/p));const r=\"tall\"===(null==t?void 0:t.symbolConfig)||(null==t||null==(m=t.symbolConfig)?void 0:m.isTall)||\"object\"===a.type&&G(a);c=Math.max(c,r?R:e),h=Math.max(h,e),l.push(Promise.resolve(J(a,e,r)))}})),n(l).then((function(e){const s=[];return e.forEach((function(e){e.value?s.push(e.value):e.error&&E.warn(\"error while building swatchInfo!\",e.error)})),L(s,[c,h],{node:t&&t.node,scale:!1,opacity:t&&t.opacity})}))}function V(e,t){const s=e.symbolLayers,r=[],o=P(e),a=t&&t.size?i(t.size):null,l=(t&&t.maxSize?i(t.maxSize):null)||O;let n,c=0,h=0;return s.forEach(((e,t)=>{if(!e)return;if(\"line\"!==e.type&&\"path\"!==e.type)return;const s=[];switch(e.type){case\"line\":{const r=B(e,0),o=r&&r.width||0;0===t&&(n=o);const i=Math.min(a||o,l),u=0===t?i:a?i*(o/n):i,p=u>I/2?2*u:I;h=Math.max(h,u),c=Math.max(c,p),r.width=u,s.push({shape:{type:\"path\",path:[{command:\"M\",values:[0,.5*h]},{command:\"L\",values:[c,.5*h]}]},stroke:r});break}case\"path\":{const t=Math.min(a||U,l),r=H(e,0),n=H(e,-.2),u=$(e,-.4),p=u?{color:u,width:1}:{};if(\"quad\"===e.profile){var o,i;const t=null!=(o=e.width)?o:e.size,a=null!=(i=e.height)?i:e.size,l=f(t&&a?t/a:1,0===a,0===t),c={...p,join:\"bevel\"};s.push({shape:l[0],fill:n,stroke:c}),s.push({shape:l[1],fill:n,stroke:c}),s.push({shape:l[2],fill:r,stroke:c})}else s.push({shape:y.pathSymbol3DLayer[0],fill:n,stroke:p}),s.push({shape:y.pathSymbol3DLayer[1],fill:r,stroke:p});h=Math.max(h,t),c=h}}r.push(s)})),Promise.resolve(L(r,[c,h],{node:t&&t.node,scale:o,opacity:t&&t.opacity}))}async function W(e,t){const s=\"mesh-3d\"===e.type,r=e.symbolLayers,o=t&&t.size?i(t.size):null,a=t&&t.maxSize?i(t.maxSize):null,n=o||U,c=[];let h=0,u=0,p=!1;for(let i=0;i<r.length;i++){const e=r.getItemAt(i),t=[];if(s&&\"fill\"!==e.type)continue;const o=y.fill[0];switch(e.type){case\"fill\":{const r=C(e),i=Math.min(n,a||D);h=Math.max(h,i),u=Math.max(u,i),p=!0;let c=H(e,0);const m=\"pattern\"in e&&e.pattern,f=A(e);!s&&l(m)&&\"style\"===m.type&&\"solid\"!==m.style&&f&&(c=await N(m,f)),t.push({shape:o,fill:c,stroke:r});break}case\"line\":{const s={stroke:B(e,0),shape:o};h=Math.max(h,U),u=Math.max(u,U),t.push(s);break}case\"extrude\":{const s={join:\"round\",...B(e,-.4)},r=H(e,0),o=H(e,-.2),l=Math.min(n,a||D),i=M(l);s.width=1,t.push({shape:i[0],fill:o,stroke:s}),t.push({shape:i[1],fill:o,stroke:s}),t.push({shape:i[2],fill:r,stroke:s});const c=U,p=.7*U+.5*l;h=Math.max(h,c),u=Math.max(u,p);break}case\"water\":{const s=A(e),r=q(s),o=q(s,2),l=q(s,3),i=x();p=!0,t.push({shape:i[0],fill:r}),t.push({shape:i[1],fill:o}),t.push({shape:i[2],fill:l});const c=Math.min(n,a||D);h=Math.max(h,c),u=Math.max(u,c);break}}c.push(t)}return Promise.resolve(L(c,[h,u],{node:t&&t.node,scale:p,opacity:t&&t.opacity}))}function X(e,t){if(0===e.symbolLayers.length)return Promise.reject(new r(\"symbolPreview: renderPreviewHTML3D\",\"No symbolLayers in the symbol.\"));let s=null;switch(e.type){case\"point-3d\":s=Q(e,t);break;case\"line-3d\":s=V(e,t);break;case\"polygon-3d\":case\"mesh-3d\":s=W(e,t)}return s||Promise.reject(new r(\"symbolPreview: swatchInfo3D\",\"symbol not supported.\"))}export{N as getPatternDescriptor,H as getSymbolLayerFill,X as previewSymbol3D};\n"]},"metadata":{},"sourceType":"module"}