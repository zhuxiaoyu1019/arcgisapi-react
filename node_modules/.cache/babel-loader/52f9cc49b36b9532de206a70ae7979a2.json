{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as r } from \"../../chunks/tslib.es6.js\";\nimport { property as a } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/has.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport \"../../core/Logger.js\";\nimport { reader as s } from \"../../core/accessorSupport/decorators/reader.js\";\nimport { subclass as i } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { writer as e } from \"../../core/accessorSupport/decorators/writer.js\";\nimport { collectField as t, collectArcadeFieldNames as o } from \"../../layers/support/fieldUtils.js\";\nimport l from \"../visualVariables/ColorVariable.js\";\nimport u from \"../visualVariables/OpacityVariable.js\";\nimport p from \"../visualVariables/RotationVariable.js\";\nimport V from \"../visualVariables/SizeVariable.js\";\nimport c from \"../visualVariables/VisualVariable.js\";\nimport b from \"../visualVariables/VisualVariableFactory.js\";\n\nconst n = {\n  base: c,\n  key: \"type\",\n  typeMap: {\n    opacity: u,\n    color: l,\n    rotation: p,\n    size: V\n  }\n},\n      v = l => {\n  let u = class extends l {\n    constructor() {\n      super(...arguments), this._vvFactory = new b();\n    }\n\n    set visualVariables(r) {\n      this._vvFactory.visualVariables = r, this._set(\"visualVariables\", this._vvFactory.visualVariables);\n    }\n\n    readVisualVariables(r, a, s) {\n      return this._vvFactory.readVariables(r, a, s);\n    }\n\n    writeVisualVariables(r, a, s, i) {\n      a[s] = this._vvFactory.writeVariables(r, i);\n    }\n\n    get arcadeRequiredForVisualVariables() {\n      if (!this.visualVariables) return !1;\n\n      for (const r of this.visualVariables) if (r.arcadeRequired) return !0;\n\n      return !1;\n    }\n\n    hasVisualVariables(r, a) {\n      return r ? !!this.getVisualVariablesForType(r, a) : !!(this.getVisualVariablesForType(\"size\", a) || this.getVisualVariablesForType(\"color\", a) || this.getVisualVariablesForType(\"opacity\", a) || this.getVisualVariablesForType(\"rotation\", a));\n    }\n\n    getVisualVariablesForType(r, a) {\n      const s = this.visualVariables;\n      if (!s) return;\n      const i = s.filter(s => s.type === r && (\"string\" == typeof a ? s.target === a : !1 !== a || !s.target));\n      return i && 0 === i.length ? void 0 : i;\n    }\n\n    async collectVVRequiredFields(r, a) {\n      let s = [];\n      this.visualVariables && (s = s.concat(this.visualVariables));\n\n      for (const i of s) i && (i.field && t(r, a, i.field), i.normalizationField && t(r, a, i.normalizationField), i.valueExpression && (await o(r, a, i.valueExpression)));\n    }\n\n  };\n  return r([a({\n    types: [n],\n    value: null,\n    json: {\n      write: !0\n    }\n  })], u.prototype, \"visualVariables\", null), r([s(\"visualVariables\", [\"visualVariables\", \"rotationType\", \"rotationExpression\"])], u.prototype, \"readVisualVariables\", null), r([e(\"visualVariables\")], u.prototype, \"writeVisualVariables\", null), u = r([i(\"esri.renderers.mixins.VisualVariablesMixin\")], u), u;\n};\n\nexport { v as VisualVariablesMixin };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/renderers/mixins/VisualVariablesMixin.js"],"names":["_","r","property","a","reader","s","subclass","i","writer","e","collectField","t","collectArcadeFieldNames","o","l","u","p","V","c","b","n","base","key","typeMap","opacity","color","rotation","size","v","constructor","arguments","_vvFactory","visualVariables","_set","readVisualVariables","readVariables","writeVisualVariables","writeVariables","arcadeRequiredForVisualVariables","arcadeRequired","hasVisualVariables","getVisualVariablesForType","filter","type","target","length","collectVVRequiredFields","concat","field","normalizationField","valueExpression","types","value","json","write","prototype","VisualVariablesMixin"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,2BAAlB;AAA8C,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,mDAAzB;AAA6E,OAAM,mBAAN;AAA0B,OAAM,0CAAN;AAAiD,OAAM,sBAAN;AAA6B,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,iDAAvB;AAAyE,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,mDAAzB;AAA6E,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,iDAAvB;AAAyE,SAAOC,YAAY,IAAIC,CAAvB,EAAyBC,uBAAuB,IAAIC,CAApD,QAA0D,oCAA1D;AAA+F,OAAOC,CAAP,MAAa,qCAAb;AAAmD,OAAOC,CAAP,MAAa,uCAAb;AAAqD,OAAOC,CAAP,MAAa,wCAAb;AAAsD,OAAOC,CAAP,MAAa,oCAAb;AAAkD,OAAOC,CAAP,MAAa,sCAAb;AAAoD,OAAOC,CAAP,MAAa,6CAAb;;AAA2D,MAAMC,CAAC,GAAC;AAACC,EAAAA,IAAI,EAACH,CAAN;AAAQI,EAAAA,GAAG,EAAC,MAAZ;AAAmBC,EAAAA,OAAO,EAAC;AAACC,IAAAA,OAAO,EAACT,CAAT;AAAWU,IAAAA,KAAK,EAACX,CAAjB;AAAmBY,IAAAA,QAAQ,EAACV,CAA5B;AAA8BW,IAAAA,IAAI,EAACV;AAAnC;AAA3B,CAAR;AAAA,MAA0EW,CAAC,GAACd,CAAC,IAAE;AAAC,MAAIC,CAAC,GAAC,cAAcD,CAAd,CAAe;AAACe,IAAAA,WAAW,GAAE;AAAC,YAAM,GAAGC,SAAT,GAAoB,KAAKC,UAAL,GAAgB,IAAIZ,CAAJ,EAApC;AAA0C;;AAAmB,QAAfa,eAAe,CAAC/B,CAAD,EAAG;AAAC,WAAK8B,UAAL,CAAgBC,eAAhB,GAAgC/B,CAAhC,EAAkC,KAAKgC,IAAL,CAAU,iBAAV,EAA4B,KAAKF,UAAL,CAAgBC,eAA5C,CAAlC;AAA+F;;AAAAE,IAAAA,mBAAmB,CAACjC,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAO;AAAC,aAAO,KAAK0B,UAAL,CAAgBI,aAAhB,CAA8BlC,CAA9B,EAAgCE,CAAhC,EAAkCE,CAAlC,CAAP;AAA4C;;AAAA+B,IAAAA,oBAAoB,CAACnC,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAOE,CAAP,EAAS;AAACJ,MAAAA,CAAC,CAACE,CAAD,CAAD,GAAK,KAAK0B,UAAL,CAAgBM,cAAhB,CAA+BpC,CAA/B,EAAiCM,CAAjC,CAAL;AAAyC;;AAAoC,QAAhC+B,gCAAgC,GAAE;AAAC,UAAG,CAAC,KAAKN,eAAT,EAAyB,OAAM,CAAC,CAAP;;AAAS,WAAI,MAAM/B,CAAV,IAAe,KAAK+B,eAApB,EAAoC,IAAG/B,CAAC,CAACsC,cAAL,EAAoB,OAAM,CAAC,CAAP;;AAAS,aAAM,CAAC,CAAP;AAAS;;AAAAC,IAAAA,kBAAkB,CAACvC,CAAD,EAAGE,CAAH,EAAK;AAAC,aAAOF,CAAC,GAAC,CAAC,CAAC,KAAKwC,yBAAL,CAA+BxC,CAA/B,EAAiCE,CAAjC,CAAH,GAAuC,CAAC,EAAE,KAAKsC,yBAAL,CAA+B,MAA/B,EAAsCtC,CAAtC,KAA0C,KAAKsC,yBAAL,CAA+B,OAA/B,EAAuCtC,CAAvC,CAA1C,IAAqF,KAAKsC,yBAAL,CAA+B,SAA/B,EAAyCtC,CAAzC,CAArF,IAAkI,KAAKsC,yBAAL,CAA+B,UAA/B,EAA0CtC,CAA1C,CAApI,CAAhD;AAAkO;;AAAAsC,IAAAA,yBAAyB,CAACxC,CAAD,EAAGE,CAAH,EAAK;AAAC,YAAME,CAAC,GAAC,KAAK2B,eAAb;AAA6B,UAAG,CAAC3B,CAAJ,EAAM;AAAO,YAAME,CAAC,GAACF,CAAC,CAACqC,MAAF,CAAUrC,CAAC,IAAEA,CAAC,CAACsC,IAAF,KAAS1C,CAAT,KAAa,YAAU,OAAOE,CAAjB,GAAmBE,CAAC,CAACuC,MAAF,KAAWzC,CAA9B,GAAgC,CAAC,CAAD,KAAKA,CAAL,IAAQ,CAACE,CAAC,CAACuC,MAAxD,CAAb,CAAR;AAAuF,aAAOrC,CAAC,IAAE,MAAIA,CAAC,CAACsC,MAAT,GAAgB,KAAK,CAArB,GAAuBtC,CAA9B;AAAgC;;AAA6B,UAAvBuC,uBAAuB,CAAC7C,CAAD,EAAGE,CAAH,EAAK;AAAC,UAAIE,CAAC,GAAC,EAAN;AAAS,WAAK2B,eAAL,KAAuB3B,CAAC,GAACA,CAAC,CAAC0C,MAAF,CAAS,KAAKf,eAAd,CAAzB;;AAAyD,WAAI,MAAMzB,CAAV,IAAeF,CAAf,EAAiBE,CAAC,KAAGA,CAAC,CAACyC,KAAF,IAASrC,CAAC,CAACV,CAAD,EAAGE,CAAH,EAAKI,CAAC,CAACyC,KAAP,CAAV,EAAwBzC,CAAC,CAAC0C,kBAAF,IAAsBtC,CAAC,CAACV,CAAD,EAAGE,CAAH,EAAKI,CAAC,CAAC0C,kBAAP,CAA/C,EAA0E1C,CAAC,CAAC2C,eAAF,KAAmB,MAAMrC,CAAC,CAACZ,CAAD,EAAGE,CAAH,EAAKI,CAAC,CAAC2C,eAAP,CAA1B,CAA7E,CAAD;AAAiI;;AAAjoC,GAArB;AAAwpC,SAAOjD,CAAC,CAAC,CAACE,CAAC,CAAC;AAACgD,IAAAA,KAAK,EAAC,CAAC/B,CAAD,CAAP;AAAWgC,IAAAA,KAAK,EAAC,IAAjB;AAAsBC,IAAAA,IAAI,EAAC;AAACC,MAAAA,KAAK,EAAC,CAAC;AAAR;AAA3B,GAAD,CAAF,CAAD,EAA6CvC,CAAC,CAACwC,SAA/C,EAAyD,iBAAzD,EAA2E,IAA3E,CAAD,EAAkFtD,CAAC,CAAC,CAACI,CAAC,CAAC,iBAAD,EAAmB,CAAC,iBAAD,EAAmB,cAAnB,EAAkC,oBAAlC,CAAnB,CAAF,CAAD,EAAgFU,CAAC,CAACwC,SAAlF,EAA4F,qBAA5F,EAAkH,IAAlH,CAAnF,EAA2MtD,CAAC,CAAC,CAACQ,CAAC,CAAC,iBAAD,CAAF,CAAD,EAAwBM,CAAC,CAACwC,SAA1B,EAAoC,sBAApC,EAA2D,IAA3D,CAA5M,EAA6QxC,CAAC,GAACd,CAAC,CAAC,CAACM,CAAC,CAAC,4CAAD,CAAF,CAAD,EAAmDQ,CAAnD,CAAhR,EAAsUA,CAA7U;AAA+U,CAAvjD;;AAAwjD,SAAOa,CAAC,IAAI4B,oBAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{reader as s}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as i}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as e}from\"../../core/accessorSupport/decorators/writer.js\";import{collectField as t,collectArcadeFieldNames as o}from\"../../layers/support/fieldUtils.js\";import l from\"../visualVariables/ColorVariable.js\";import u from\"../visualVariables/OpacityVariable.js\";import p from\"../visualVariables/RotationVariable.js\";import V from\"../visualVariables/SizeVariable.js\";import c from\"../visualVariables/VisualVariable.js\";import b from\"../visualVariables/VisualVariableFactory.js\";const n={base:c,key:\"type\",typeMap:{opacity:u,color:l,rotation:p,size:V}},v=l=>{let u=class extends l{constructor(){super(...arguments),this._vvFactory=new b}set visualVariables(r){this._vvFactory.visualVariables=r,this._set(\"visualVariables\",this._vvFactory.visualVariables)}readVisualVariables(r,a,s){return this._vvFactory.readVariables(r,a,s)}writeVisualVariables(r,a,s,i){a[s]=this._vvFactory.writeVariables(r,i)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const r of this.visualVariables)if(r.arcadeRequired)return!0;return!1}hasVisualVariables(r,a){return r?!!this.getVisualVariablesForType(r,a):!!(this.getVisualVariablesForType(\"size\",a)||this.getVisualVariablesForType(\"color\",a)||this.getVisualVariablesForType(\"opacity\",a)||this.getVisualVariablesForType(\"rotation\",a))}getVisualVariablesForType(r,a){const s=this.visualVariables;if(!s)return;const i=s.filter((s=>s.type===r&&(\"string\"==typeof a?s.target===a:!1!==a||!s.target)));return i&&0===i.length?void 0:i}async collectVVRequiredFields(r,a){let s=[];this.visualVariables&&(s=s.concat(this.visualVariables));for(const i of s)i&&(i.field&&t(r,a,i.field),i.normalizationField&&t(r,a,i.normalizationField),i.valueExpression&&await o(r,a,i.valueExpression))}};return r([a({types:[n],value:null,json:{write:!0}})],u.prototype,\"visualVariables\",null),r([s(\"visualVariables\",[\"visualVariables\",\"rotationType\",\"rotationExpression\"])],u.prototype,\"readVisualVariables\",null),r([e(\"visualVariables\")],u.prototype,\"writeVisualVariables\",null),u=r([i(\"esri.renderers.mixins.VisualVariablesMixin\")],u),u};export{v as VisualVariablesMixin};\n"]},"metadata":{},"sourceType":"module"}