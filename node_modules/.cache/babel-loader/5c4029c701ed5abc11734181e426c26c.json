{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { dom as e } from \"../maquette/dom.js\";\nimport \"../maquette/projector.js\";\nimport { defaultAdvancedProjectorOptions as t } from \"./advanced-projector-options.js\";\nimport { applyDefaultProjectionOptions as r } from \"./utils.js\";\n\nconst o = (e, t) => {\n  const r = [];\n\n  for (; e && e !== t;) r.push(e), e = e.parentNode;\n\n  return r;\n},\n      n = (e, t) => e.find(t),\n      d = (e, t, r = !1) => {\n  let o = e;\n  return t.forEach((e, d) => {\n    var s;\n    const i = null != (s = o) && s.children ? n(o.children, t => t.domNode === e) : void 0;\n    r && !i && d !== t.length - 1 || (o = i);\n  }), o;\n},\n      s = n => {\n  let s;\n  const i = { ...t,\n    ...n\n  },\n        c = r(i),\n        a = c.performanceLogger;\n  let l,\n      m = !0,\n      p = !1;\n\n  const u = [],\n        f = [],\n        v = (e, t, r) => {\n    let n;\n    c.eventHandlerInterceptor = (e, t, r, c) => function (e) {\n      let t;\n      a(\"domEvent\", e);\n      const r = o(e.currentTarget, n.domNode),\n            c = r.some(e => {\n        var t;\n        return customElements.get(null == e || null == (t = e.tagName) ? void 0 : t.toLowerCase());\n      });\n      if (e.eventPhase === Event.CAPTURING_PHASE || !c) r.reverse(), t = d(n.getLastRender(), r);else {\n        const r = e.composedPath(),\n              o = r.slice(r.indexOf(e.currentTarget), r.indexOf(n.domNode)).filter(e => e.getRootNode() === e.ownerDocument).reverse();\n        t = d(n.getLastRender(), o, !0);\n      }\n      let l;\n      return t && (l = i.handleInterceptedEvent(s, t, this, e)), a(\"domEventProcessed\", e), l;\n    }, null == i.postProcessProjectionOptions || i.postProcessProjectionOptions(c);\n    const l = r();\n    n = e(t, l, c), u.push(n), f.push(r), i.afterFirstVNodeRendered && i.afterFirstVNodeRendered(n, l);\n  };\n\n  let h = () => {\n    if (l = void 0, m) {\n      m = !1, a(\"renderStart\", void 0);\n\n      for (let e = 0; e < u.length; e++) {\n        const t = f[e]();\n        a(\"rendered\", void 0), u[e].update(t), a(\"patched\", void 0);\n      }\n\n      a(\"renderDone\", void 0), m = !0;\n    }\n  };\n\n  return i.modifyDoRenderImplementation && (h = i.modifyDoRenderImplementation(h, u, f)), s = {\n    renderNow: h,\n    scheduleRender: () => {\n      l || p || (l = requestAnimationFrame(h));\n    },\n    stop: () => {\n      l && (cancelAnimationFrame(l), l = void 0), p = !0;\n    },\n    resume: () => {\n      p = !1, m = !0, s.scheduleRender();\n    },\n    append: (t, r) => {\n      v(e.append, t, r);\n    },\n    insertBefore: (t, r) => {\n      v(e.insertBefore, t, r);\n    },\n    merge: (t, r) => {\n      v(e.merge, t, r);\n    },\n    replace: (t, r) => {\n      v(e.replace, t, r);\n    },\n    detach: e => {\n      for (let t = 0; t < f.length; t++) if (f[t] === e) return f.splice(t, 1), u.splice(t, 1)[0];\n\n      throw new Error(\"renderFunction was not found\");\n    }\n  }, s;\n};\n\nexport { s as createAdvancedProjector };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/libs/maquette-advanced-projector/projector.js"],"names":["dom","e","defaultAdvancedProjectorOptions","t","applyDefaultProjectionOptions","r","o","push","parentNode","n","find","d","forEach","s","i","children","domNode","length","c","a","performanceLogger","l","m","p","u","f","v","eventHandlerInterceptor","currentTarget","some","customElements","get","tagName","toLowerCase","eventPhase","Event","CAPTURING_PHASE","reverse","getLastRender","composedPath","slice","indexOf","filter","getRootNode","ownerDocument","handleInterceptedEvent","postProcessProjectionOptions","afterFirstVNodeRendered","h","update","modifyDoRenderImplementation","renderNow","scheduleRender","requestAnimationFrame","stop","cancelAnimationFrame","resume","append","insertBefore","merge","replace","detach","splice","Error","createAdvancedProjector"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{dom as e}from\"../maquette/dom.js\";import\"../maquette/projector.js\";import{defaultAdvancedProjectorOptions as t}from\"./advanced-projector-options.js\";import{applyDefaultProjectionOptions as r}from\"./utils.js\";const o=(e,t)=>{const r=[];for(;e&&e!==t;)r.push(e),e=e.parentNode;return r},n=(e,t)=>e.find(t),d=(e,t,r=!1)=>{let o=e;return t.forEach(((e,d)=>{var s;const i=null!=(s=o)&&s.children?n(o.children,(t=>t.domNode===e)):void 0;r&&!i&&d!==t.length-1||(o=i)})),o},s=n=>{let s;const i={...t,...n},c=r(i),a=c.performanceLogger;let l,m=!0,p=!1;const u=[],f=[],v=(e,t,r)=>{let n;c.eventHandlerInterceptor=(e,t,r,c)=>function(e){let t;a(\"domEvent\",e);const r=o(e.currentTarget,n.domNode),c=r.some((e=>{var t;return customElements.get(null==e||null==(t=e.tagName)?void 0:t.toLowerCase())}));if(e.eventPhase===Event.CAPTURING_PHASE||!c)r.reverse(),t=d(n.getLastRender(),r);else{const r=e.composedPath(),o=r.slice(r.indexOf(e.currentTarget),r.indexOf(n.domNode)).filter((e=>e.getRootNode()===e.ownerDocument)).reverse();t=d(n.getLastRender(),o,!0)}let l;return t&&(l=i.handleInterceptedEvent(s,t,this,e)),a(\"domEventProcessed\",e),l},null==i.postProcessProjectionOptions||i.postProcessProjectionOptions(c);const l=r();n=e(t,l,c),u.push(n),f.push(r),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(n,l)};let h=()=>{if(l=void 0,m){m=!1,a(\"renderStart\",void 0);for(let e=0;e<u.length;e++){const t=f[e]();a(\"rendered\",void 0),u[e].update(t),a(\"patched\",void 0)}a(\"renderDone\",void 0),m=!0}};return i.modifyDoRenderImplementation&&(h=i.modifyDoRenderImplementation(h,u,f)),s={renderNow:h,scheduleRender:()=>{l||p||(l=requestAnimationFrame(h))},stop:()=>{l&&(cancelAnimationFrame(l),l=void 0),p=!0},resume:()=>{p=!1,m=!0,s.scheduleRender()},append:(t,r)=>{v(e.append,t,r)},insertBefore:(t,r)=>{v(e.insertBefore,t,r)},merge:(t,r)=>{v(e.merge,t,r)},replace:(t,r)=>{v(e.replace,t,r)},detach:e=>{for(let t=0;t<f.length;t++)if(f[t]===e)return f.splice(t,1),u.splice(t,1)[0];throw new Error(\"renderFunction was not found\")}},s};export{s as createAdvancedProjector};\n"]},"metadata":{},"sourceType":"module"}