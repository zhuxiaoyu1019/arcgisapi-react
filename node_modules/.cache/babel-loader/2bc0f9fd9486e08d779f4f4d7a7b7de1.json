{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport { geometryTypes as t } from \"../../geometry.js\";\nimport r from \"../../Graphic.js\";\nimport { JSONMap as o } from \"../../core/jsonMap.js\";\nimport { JSONSupport as s } from \"../../core/JSONSupport.js\";\nimport { isSome as n, unwrap as i } from \"../../core/maybe.js\";\nimport { property as p } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/has.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport \"../../core/Logger.js\";\nimport { reader as l } from \"../../core/accessorSupport/decorators/reader.js\";\nimport { subclass as a } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { writer as y } from \"../../core/accessorSupport/decorators/writer.js\";\nimport m from \"../../geometry/SpatialReference.js\";\nimport { fromJSON as u, isPolygon as c } from \"../../geometry/support/jsonUtils.js\";\nimport f from \"../../layers/support/Field.js\";\nconst h = new o({\n  esriGeometryPoint: \"point\",\n  esriGeometryMultipoint: \"multipoint\",\n  esriGeometryPolyline: \"polyline\",\n  esriGeometryPolygon: \"polygon\",\n  esriGeometryEnvelope: \"extent\",\n  mesh: \"mesh\",\n  \"\": null\n});\nlet d = class extends s {\n  constructor(e) {\n    super(e), this.displayFieldName = null, this.exceededTransferLimit = !1, this.features = [], this.fields = null, this.geometryType = null, this.hasM = !1, this.hasZ = !1, this.queryGeometry = null, this.spatialReference = null;\n  }\n\n  readFeatures(e, t) {\n    const o = m.fromJSON(t.spatialReference),\n          s = [];\n\n    for (let i = 0; i < e.length; i++) {\n      const t = e[i],\n            p = r.fromJSON(t),\n            l = t.geometry && t.geometry.spatialReference;\n      n(p.geometry) && !l && (p.geometry.spatialReference = o), s.push(p);\n    }\n\n    return s;\n  }\n\n  writeGeometryType(e, t, r, o) {\n    if (e) return void h.write(e, t, r, o);\n    const {\n      features: s\n    } = this;\n    if (s) for (const i of s) if (i && n(i.geometry)) return void h.write(i.geometry.type, t, r, o);\n  }\n\n  readQueryGeometry(e, t) {\n    if (!e) return null;\n    const r = !!e.spatialReference,\n          o = u(e);\n    return !r && t.spatialReference && (o.spatialReference = m.fromJSON(t.spatialReference)), o;\n  }\n\n  writeSpatialReference(e, t) {\n    if (e) return void (t.spatialReference = e.toJSON());\n    const {\n      features: r\n    } = this;\n    if (r) for (const o of r) if (o && n(o.geometry) && o.geometry.spatialReference) return void (t.spatialReference = o.geometry.spatialReference.toJSON());\n  }\n\n  toJSON(e) {\n    const t = this.write(null);\n    if (t.features && Array.isArray(e) && e.length > 0) for (let r = 0; r < t.features.length; r++) {\n      const o = t.features[r];\n\n      if (o.geometry) {\n        const t = e && e[r];\n        o.geometry = t && t.toJSON() || o.geometry;\n      }\n    }\n    return t;\n  }\n\n  quantize(e) {\n    const {\n      scale: [t, r],\n      translate: [o, s]\n    } = e,\n          n = e => Math.round((e - o) / t),\n          p = e => Math.round((s - e) / r),\n          l = this.features,\n          a = this._getQuantizationFunction(this.geometryType, n, p);\n\n    for (let y = 0, m = l.length; y < m; y++) a(i(l[y].geometry)) || (l.splice(y, 1), y--, m--);\n\n    return this.transform = e, this;\n  }\n\n  unquantize() {\n    const {\n      geometryType: e,\n      features: t,\n      transform: r\n    } = this;\n    if (!r) return this;\n\n    const {\n      translate: [o, s],\n      scale: [i, p]\n    } = r,\n          l = e => e * i + o,\n          a = e => s - e * p,\n          y = this._getHydrationFunction(e, l, a);\n\n    for (const {\n      geometry: m\n    } of t) n(m) && y(m);\n\n    return this.transform = null, this;\n  }\n\n  _quantizePoints(e, t, r) {\n    let o, s;\n    const n = [];\n\n    for (let i = 0, p = e.length; i < p; i++) {\n      const p = e[i];\n\n      if (i > 0) {\n        const e = t(p[0]),\n              i = r(p[1]);\n        e === o && i === s || (n.push([e - o, i - s]), o = e, s = i);\n      } else o = t(p[0]), s = r(p[1]), n.push([o, s]);\n    }\n\n    return n.length > 0 ? n : null;\n  }\n\n  _getQuantizationFunction(e, t, r) {\n    return \"point\" === e ? e => (e.x = t(e.x), e.y = r(e.y), e) : \"polyline\" === e || \"polygon\" === e ? e => {\n      const o = c(e) ? e.rings : e.paths,\n            s = [];\n\n      for (let n = 0, i = o.length; n < i; n++) {\n        const e = o[n],\n              i = this._quantizePoints(e, t, r);\n\n        i && s.push(i);\n      }\n\n      return s.length > 0 ? (c(e) ? e.rings = s : e.paths = s, e) : null;\n    } : \"multipoint\" === e ? e => {\n      const o = this._quantizePoints(e.points, t, r);\n\n      return o.length > 0 ? (e.points = o, e) : null;\n    } : \"extent\" === e ? e => e : null;\n  }\n\n  _getHydrationFunction(e, t, r) {\n    return \"point\" === e ? e => {\n      e.x = t(e.x), e.y = r(e.y);\n    } : \"polyline\" === e || \"polygon\" === e ? e => {\n      const o = c(e) ? e.rings : e.paths;\n      let s, n;\n\n      for (let i = 0, p = o.length; i < p; i++) {\n        const e = o[i];\n\n        for (let o = 0, i = e.length; o < i; o++) {\n          const i = e[o];\n          o > 0 ? (s += i[0], n += i[1]) : (s = i[0], n = i[1]), i[0] = t(s), i[1] = r(n);\n        }\n      }\n    } : \"extent\" === e ? e => {\n      e.xmin = t(e.xmin), e.ymin = r(e.ymin), e.xmax = t(e.xmax), e.ymax = r(e.ymax);\n    } : \"multipoint\" === e ? e => {\n      const o = e.points;\n      let s, n;\n\n      for (let i = 0, p = o.length; i < p; i++) {\n        const e = o[i];\n        i > 0 ? (s += e[0], n += e[1]) : (s = e[0], n = e[1]), e[0] = t(s), e[1] = r(n);\n      }\n    } : void 0;\n  }\n\n};\ne([p({\n  type: String,\n  json: {\n    write: !0\n  }\n})], d.prototype, \"displayFieldName\", void 0), e([p({\n  type: Boolean,\n  json: {\n    write: {\n      overridePolicy: e => ({\n        enabled: e\n      })\n    }\n  }\n})], d.prototype, \"exceededTransferLimit\", void 0), e([p({\n  type: [r],\n  json: {\n    write: !0\n  }\n})], d.prototype, \"features\", void 0), e([l(\"features\")], d.prototype, \"readFeatures\", null), e([p({\n  type: [f],\n  json: {\n    write: !0\n  }\n})], d.prototype, \"fields\", void 0), e([p({\n  type: [\"point\", \"multipoint\", \"polyline\", \"polygon\", \"extent\", \"mesh\"],\n  json: {\n    read: {\n      reader: h.read\n    }\n  }\n})], d.prototype, \"geometryType\", void 0), e([y(\"geometryType\")], d.prototype, \"writeGeometryType\", null), e([p({\n  type: Boolean,\n  json: {\n    write: {\n      overridePolicy: e => ({\n        enabled: e\n      })\n    }\n  }\n})], d.prototype, \"hasM\", void 0), e([p({\n  type: Boolean,\n  json: {\n    write: {\n      overridePolicy: e => ({\n        enabled: e\n      })\n    }\n  }\n})], d.prototype, \"hasZ\", void 0), e([p({\n  types: t,\n  json: {\n    write: !0\n  }\n})], d.prototype, \"queryGeometry\", void 0), e([l(\"queryGeometry\")], d.prototype, \"readQueryGeometry\", null), e([p({\n  type: m,\n  json: {\n    write: !0\n  }\n})], d.prototype, \"spatialReference\", void 0), e([y(\"spatialReference\")], d.prototype, \"writeSpatialReference\", null), e([p({\n  json: {\n    write: !0\n  }\n})], d.prototype, \"transform\", void 0), d = e([a(\"esri.rest.support.FeatureSet\")], d), d.prototype.toJSON.isDefaultToJSON = !0, d || (d = {});\nvar g = d;\nexport default g;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/rest/support/FeatureSet.js"],"names":["_","e","geometryTypes","t","r","JSONMap","o","JSONSupport","s","isSome","n","unwrap","i","property","p","reader","l","subclass","a","writer","y","m","fromJSON","u","isPolygon","c","f","h","esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryEnvelope","mesh","d","constructor","displayFieldName","exceededTransferLimit","features","fields","geometryType","hasM","hasZ","queryGeometry","spatialReference","readFeatures","length","geometry","push","writeGeometryType","write","type","readQueryGeometry","writeSpatialReference","toJSON","Array","isArray","quantize","scale","translate","Math","round","_getQuantizationFunction","splice","transform","unquantize","_getHydrationFunction","_quantizePoints","x","rings","paths","points","xmin","ymin","xmax","ymax","String","json","prototype","Boolean","overridePolicy","enabled","read","types","isDefaultToJSON","g"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,2BAAlB;AAA8C,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,mBAA9B;AAAkD,OAAOC,CAAP,MAAa,kBAAb;AAAgC,SAAOC,OAAO,IAAIC,CAAlB,QAAwB,uBAAxB;AAAgD,SAAOC,WAAW,IAAIC,CAAtB,QAA4B,2BAA5B;AAAwD,SAAOC,MAAM,IAAIC,CAAjB,EAAmBC,MAAM,IAAIC,CAA7B,QAAmC,qBAAnC;AAAyD,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,mDAAzB;AAA6E,OAAM,mBAAN;AAA0B,OAAM,0CAAN;AAAiD,OAAM,sBAAN;AAA6B,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,iDAAvB;AAAyE,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,mDAAzB;AAA6E,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,iDAAvB;AAAyE,OAAOC,CAAP,MAAa,oCAAb;AAAkD,SAAOC,QAAQ,IAAIC,CAAnB,EAAqBC,SAAS,IAAIC,CAAlC,QAAwC,qCAAxC;AAA8E,OAAOC,CAAP,MAAa,+BAAb;AAA6C,MAAMC,CAAC,GAAC,IAAIrB,CAAJ,CAAM;AAACsB,EAAAA,iBAAiB,EAAC,OAAnB;AAA2BC,EAAAA,sBAAsB,EAAC,YAAlD;AAA+DC,EAAAA,oBAAoB,EAAC,UAApF;AAA+FC,EAAAA,mBAAmB,EAAC,SAAnH;AAA6HC,EAAAA,oBAAoB,EAAC,QAAlJ;AAA2JC,EAAAA,IAAI,EAAC,MAAhK;AAAuK,MAAG;AAA1K,CAAN,CAAR;AAA+L,IAAIC,CAAC,GAAC,cAAc1B,CAAd,CAAe;AAAC2B,EAAAA,WAAW,CAAClC,CAAD,EAAG;AAAC,UAAMA,CAAN,GAAS,KAAKmC,gBAAL,GAAsB,IAA/B,EAAoC,KAAKC,qBAAL,GAA2B,CAAC,CAAhE,EAAkE,KAAKC,QAAL,GAAc,EAAhF,EAAmF,KAAKC,MAAL,GAAY,IAA/F,EAAoG,KAAKC,YAAL,GAAkB,IAAtH,EAA2H,KAAKC,IAAL,GAAU,CAAC,CAAtI,EAAwI,KAAKC,IAAL,GAAU,CAAC,CAAnJ,EAAqJ,KAAKC,aAAL,GAAmB,IAAxK,EAA6K,KAAKC,gBAAL,GAAsB,IAAnM;AAAwM;;AAAAC,EAAAA,YAAY,CAAC5C,CAAD,EAAGE,CAAH,EAAK;AAAC,UAAMG,CAAC,GAACe,CAAC,CAACC,QAAF,CAAWnB,CAAC,CAACyC,gBAAb,CAAR;AAAA,UAAuCpC,CAAC,GAAC,EAAzC;;AAA4C,SAAI,IAAII,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACX,CAAC,CAAC6C,MAAhB,EAAuBlC,CAAC,EAAxB,EAA2B;AAAC,YAAMT,CAAC,GAACF,CAAC,CAACW,CAAD,CAAT;AAAA,YAAaE,CAAC,GAACV,CAAC,CAACkB,QAAF,CAAWnB,CAAX,CAAf;AAAA,YAA6Ba,CAAC,GAACb,CAAC,CAAC4C,QAAF,IAAY5C,CAAC,CAAC4C,QAAF,CAAWH,gBAAtD;AAAuElC,MAAAA,CAAC,CAACI,CAAC,CAACiC,QAAH,CAAD,IAAe,CAAC/B,CAAhB,KAAoBF,CAAC,CAACiC,QAAF,CAAWH,gBAAX,GAA4BtC,CAAhD,GAAmDE,CAAC,CAACwC,IAAF,CAAOlC,CAAP,CAAnD;AAA6D;;AAAA,WAAON,CAAP;AAAS;;AAAAyC,EAAAA,iBAAiB,CAAChD,CAAD,EAAGE,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAAS;AAAC,QAAGL,CAAH,EAAK,OAAO,KAAK0B,CAAC,CAACuB,KAAF,CAAQjD,CAAR,EAAUE,CAAV,EAAYC,CAAZ,EAAcE,CAAd,CAAZ;AAA6B,UAAK;AAACgC,MAAAA,QAAQ,EAAC9B;AAAV,QAAa,IAAlB;AAAuB,QAAGA,CAAH,EAAK,KAAI,MAAMI,CAAV,IAAeJ,CAAf,EAAiB,IAAGI,CAAC,IAAEF,CAAC,CAACE,CAAC,CAACmC,QAAH,CAAP,EAAoB,OAAO,KAAKpB,CAAC,CAACuB,KAAF,CAAQtC,CAAC,CAACmC,QAAF,CAAWI,IAAnB,EAAwBhD,CAAxB,EAA0BC,CAA1B,EAA4BE,CAA5B,CAAZ;AAA2C;;AAAA8C,EAAAA,iBAAiB,CAACnD,CAAD,EAAGE,CAAH,EAAK;AAAC,QAAG,CAACF,CAAJ,EAAM,OAAO,IAAP;AAAY,UAAMG,CAAC,GAAC,CAAC,CAACH,CAAC,CAAC2C,gBAAZ;AAAA,UAA6BtC,CAAC,GAACiB,CAAC,CAACtB,CAAD,CAAhC;AAAoC,WAAM,CAACG,CAAD,IAAID,CAAC,CAACyC,gBAAN,KAAyBtC,CAAC,CAACsC,gBAAF,GAAmBvB,CAAC,CAACC,QAAF,CAAWnB,CAAC,CAACyC,gBAAb,CAA5C,GAA4EtC,CAAlF;AAAoF;;AAAA+C,EAAAA,qBAAqB,CAACpD,CAAD,EAAGE,CAAH,EAAK;AAAC,QAAGF,CAAH,EAAK,OAAO,MAAKE,CAAC,CAACyC,gBAAF,GAAmB3C,CAAC,CAACqD,MAAF,EAAxB,CAAP;AAA2C,UAAK;AAAChB,MAAAA,QAAQ,EAAClC;AAAV,QAAa,IAAlB;AAAuB,QAAGA,CAAH,EAAK,KAAI,MAAME,CAAV,IAAeF,CAAf,EAAiB,IAAGE,CAAC,IAAEI,CAAC,CAACJ,CAAC,CAACyC,QAAH,CAAJ,IAAkBzC,CAAC,CAACyC,QAAF,CAAWH,gBAAhC,EAAiD,OAAO,MAAKzC,CAAC,CAACyC,gBAAF,GAAmBtC,CAAC,CAACyC,QAAF,CAAWH,gBAAX,CAA4BU,MAA5B,EAAxB,CAAP;AAAqE;;AAAAA,EAAAA,MAAM,CAACrD,CAAD,EAAG;AAAC,UAAME,CAAC,GAAC,KAAK+C,KAAL,CAAW,IAAX,CAAR;AAAyB,QAAG/C,CAAC,CAACmC,QAAF,IAAYiB,KAAK,CAACC,OAAN,CAAcvD,CAAd,CAAZ,IAA8BA,CAAC,CAAC6C,MAAF,GAAS,CAA1C,EAA4C,KAAI,IAAI1C,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACD,CAAC,CAACmC,QAAF,CAAWQ,MAAzB,EAAgC1C,CAAC,EAAjC,EAAoC;AAAC,YAAME,CAAC,GAACH,CAAC,CAACmC,QAAF,CAAWlC,CAAX,CAAR;;AAAsB,UAAGE,CAAC,CAACyC,QAAL,EAAc;AAAC,cAAM5C,CAAC,GAACF,CAAC,IAAEA,CAAC,CAACG,CAAD,CAAZ;AAAgBE,QAAAA,CAAC,CAACyC,QAAF,GAAW5C,CAAC,IAAEA,CAAC,CAACmD,MAAF,EAAH,IAAehD,CAAC,CAACyC,QAA5B;AAAqC;AAAC;AAAA,WAAO5C,CAAP;AAAS;;AAAAsD,EAAAA,QAAQ,CAACxD,CAAD,EAAG;AAAC,UAAK;AAACyD,MAAAA,KAAK,EAAC,CAACvD,CAAD,EAAGC,CAAH,CAAP;AAAauD,MAAAA,SAAS,EAAC,CAACrD,CAAD,EAAGE,CAAH;AAAvB,QAA8BP,CAAnC;AAAA,UAAqCS,CAAC,GAACT,CAAC,IAAE2D,IAAI,CAACC,KAAL,CAAW,CAAC5D,CAAC,GAACK,CAAH,IAAMH,CAAjB,CAA1C;AAAA,UAA8DW,CAAC,GAACb,CAAC,IAAE2D,IAAI,CAACC,KAAL,CAAW,CAACrD,CAAC,GAACP,CAAH,IAAMG,CAAjB,CAAnE;AAAA,UAAuFY,CAAC,GAAC,KAAKsB,QAA9F;AAAA,UAAuGpB,CAAC,GAAC,KAAK4C,wBAAL,CAA8B,KAAKtB,YAAnC,EAAgD9B,CAAhD,EAAkDI,CAAlD,CAAzG;;AAA8J,SAAI,IAAIM,CAAC,GAAC,CAAN,EAAQC,CAAC,GAACL,CAAC,CAAC8B,MAAhB,EAAuB1B,CAAC,GAACC,CAAzB,EAA2BD,CAAC,EAA5B,EAA+BF,CAAC,CAACN,CAAC,CAACI,CAAC,CAACI,CAAD,CAAD,CAAK2B,QAAN,CAAF,CAAD,KAAsB/B,CAAC,CAAC+C,MAAF,CAAS3C,CAAT,EAAW,CAAX,GAAcA,CAAC,EAAf,EAAkBC,CAAC,EAAzC;;AAA6C,WAAO,KAAK2C,SAAL,GAAe/D,CAAf,EAAiB,IAAxB;AAA6B;;AAAAgE,EAAAA,UAAU,GAAE;AAAC,UAAK;AAACzB,MAAAA,YAAY,EAACvC,CAAd;AAAgBqC,MAAAA,QAAQ,EAACnC,CAAzB;AAA2B6D,MAAAA,SAAS,EAAC5D;AAArC,QAAwC,IAA7C;AAAkD,QAAG,CAACA,CAAJ,EAAM,OAAO,IAAP;;AAAY,UAAK;AAACuD,MAAAA,SAAS,EAAC,CAACrD,CAAD,EAAGE,CAAH,CAAX;AAAiBkD,MAAAA,KAAK,EAAC,CAAC9C,CAAD,EAAGE,CAAH;AAAvB,QAA8BV,CAAnC;AAAA,UAAqCY,CAAC,GAACf,CAAC,IAAEA,CAAC,GAACW,CAAF,GAAIN,CAA9C;AAAA,UAAgDY,CAAC,GAACjB,CAAC,IAAEO,CAAC,GAACP,CAAC,GAACa,CAAzD;AAAA,UAA2DM,CAAC,GAAC,KAAK8C,qBAAL,CAA2BjE,CAA3B,EAA6Be,CAA7B,EAA+BE,CAA/B,CAA7D;;AAA+F,SAAI,MAAK;AAAC6B,MAAAA,QAAQ,EAAC1B;AAAV,KAAT,IAAwBlB,CAAxB,EAA0BO,CAAC,CAACW,CAAD,CAAD,IAAMD,CAAC,CAACC,CAAD,CAAP;;AAAW,WAAO,KAAK2C,SAAL,GAAe,IAAf,EAAoB,IAA3B;AAAgC;;AAAAG,EAAAA,eAAe,CAAClE,CAAD,EAAGE,CAAH,EAAKC,CAAL,EAAO;AAAC,QAAIE,CAAJ,EAAME,CAAN;AAAQ,UAAME,CAAC,GAAC,EAAR;;AAAW,SAAI,IAAIE,CAAC,GAAC,CAAN,EAAQE,CAAC,GAACb,CAAC,CAAC6C,MAAhB,EAAuBlC,CAAC,GAACE,CAAzB,EAA2BF,CAAC,EAA5B,EAA+B;AAAC,YAAME,CAAC,GAACb,CAAC,CAACW,CAAD,CAAT;;AAAa,UAAGA,CAAC,GAAC,CAAL,EAAO;AAAC,cAAMX,CAAC,GAACE,CAAC,CAACW,CAAC,CAAC,CAAD,CAAF,CAAT;AAAA,cAAgBF,CAAC,GAACR,CAAC,CAACU,CAAC,CAAC,CAAD,CAAF,CAAnB;AAA0Bb,QAAAA,CAAC,KAAGK,CAAJ,IAAOM,CAAC,KAAGJ,CAAX,KAAeE,CAAC,CAACsC,IAAF,CAAO,CAAC/C,CAAC,GAACK,CAAH,EAAKM,CAAC,GAACJ,CAAP,CAAP,GAAkBF,CAAC,GAACL,CAApB,EAAsBO,CAAC,GAACI,CAAvC;AAA0C,OAA5E,MAAiFN,CAAC,GAACH,CAAC,CAACW,CAAC,CAAC,CAAD,CAAF,CAAH,EAAUN,CAAC,GAACJ,CAAC,CAACU,CAAC,CAAC,CAAD,CAAF,CAAb,EAAoBJ,CAAC,CAACsC,IAAF,CAAO,CAAC1C,CAAD,EAAGE,CAAH,CAAP,CAApB;AAAkC;;AAAA,WAAOE,CAAC,CAACoC,MAAF,GAAS,CAAT,GAAWpC,CAAX,GAAa,IAApB;AAAyB;;AAAAoD,EAAAA,wBAAwB,CAAC7D,CAAD,EAAGE,CAAH,EAAKC,CAAL,EAAO;AAAC,WAAM,YAAUH,CAAV,GAAYA,CAAC,KAAGA,CAAC,CAACmE,CAAF,GAAIjE,CAAC,CAACF,CAAC,CAACmE,CAAH,CAAL,EAAWnE,CAAC,CAACmB,CAAF,GAAIhB,CAAC,CAACH,CAAC,CAACmB,CAAH,CAAhB,EAAsBnB,CAAzB,CAAb,GAAyC,eAAaA,CAAb,IAAgB,cAAYA,CAA5B,GAA8BA,CAAC,IAAE;AAAC,YAAMK,CAAC,GAACmB,CAAC,CAACxB,CAAD,CAAD,GAAKA,CAAC,CAACoE,KAAP,GAAapE,CAAC,CAACqE,KAAvB;AAAA,YAA6B9D,CAAC,GAAC,EAA/B;;AAAkC,WAAI,IAAIE,CAAC,GAAC,CAAN,EAAQE,CAAC,GAACN,CAAC,CAACwC,MAAhB,EAAuBpC,CAAC,GAACE,CAAzB,EAA2BF,CAAC,EAA5B,EAA+B;AAAC,cAAMT,CAAC,GAACK,CAAC,CAACI,CAAD,CAAT;AAAA,cAAaE,CAAC,GAAC,KAAKuD,eAAL,CAAqBlE,CAArB,EAAuBE,CAAvB,EAAyBC,CAAzB,CAAf;;AAA2CQ,QAAAA,CAAC,IAAEJ,CAAC,CAACwC,IAAF,CAAOpC,CAAP,CAAH;AAAa;;AAAA,aAAOJ,CAAC,CAACsC,MAAF,GAAS,CAAT,IAAYrB,CAAC,CAACxB,CAAD,CAAD,GAAKA,CAAC,CAACoE,KAAF,GAAQ7D,CAAb,GAAeP,CAAC,CAACqE,KAAF,GAAQ9D,CAAvB,EAAyBP,CAArC,IAAwC,IAA/C;AAAoD,KAAhN,GAAiN,iBAAeA,CAAf,GAAiBA,CAAC,IAAE;AAAC,YAAMK,CAAC,GAAC,KAAK6D,eAAL,CAAqBlE,CAAC,CAACsE,MAAvB,EAA8BpE,CAA9B,EAAgCC,CAAhC,CAAR;;AAA2C,aAAOE,CAAC,CAACwC,MAAF,GAAS,CAAT,IAAY7C,CAAC,CAACsE,MAAF,GAASjE,CAAT,EAAWL,CAAvB,IAA0B,IAAjC;AAAsC,KAAtG,GAAuG,aAAWA,CAAX,GAAaA,CAAC,IAAEA,CAAhB,GAAkB,IAAzX;AAA8X;;AAAAiE,EAAAA,qBAAqB,CAACjE,CAAD,EAAGE,CAAH,EAAKC,CAAL,EAAO;AAAC,WAAM,YAAUH,CAAV,GAAYA,CAAC,IAAE;AAACA,MAAAA,CAAC,CAACmE,CAAF,GAAIjE,CAAC,CAACF,CAAC,CAACmE,CAAH,CAAL,EAAWnE,CAAC,CAACmB,CAAF,GAAIhB,CAAC,CAACH,CAAC,CAACmB,CAAH,CAAhB;AAAsB,KAAtC,GAAuC,eAAanB,CAAb,IAAgB,cAAYA,CAA5B,GAA8BA,CAAC,IAAE;AAAC,YAAMK,CAAC,GAACmB,CAAC,CAACxB,CAAD,CAAD,GAAKA,CAAC,CAACoE,KAAP,GAAapE,CAAC,CAACqE,KAAvB;AAA6B,UAAI9D,CAAJ,EAAME,CAAN;;AAAQ,WAAI,IAAIE,CAAC,GAAC,CAAN,EAAQE,CAAC,GAACR,CAAC,CAACwC,MAAhB,EAAuBlC,CAAC,GAACE,CAAzB,EAA2BF,CAAC,EAA5B,EAA+B;AAAC,cAAMX,CAAC,GAACK,CAAC,CAACM,CAAD,CAAT;;AAAa,aAAI,IAAIN,CAAC,GAAC,CAAN,EAAQM,CAAC,GAACX,CAAC,CAAC6C,MAAhB,EAAuBxC,CAAC,GAACM,CAAzB,EAA2BN,CAAC,EAA5B,EAA+B;AAAC,gBAAMM,CAAC,GAACX,CAAC,CAACK,CAAD,CAAT;AAAaA,UAAAA,CAAC,GAAC,CAAF,IAAKE,CAAC,IAAEI,CAAC,CAAC,CAAD,CAAJ,EAAQF,CAAC,IAAEE,CAAC,CAAC,CAAD,CAAjB,KAAuBJ,CAAC,GAACI,CAAC,CAAC,CAAD,CAAH,EAAOF,CAAC,GAACE,CAAC,CAAC,CAAD,CAAjC,GAAsCA,CAAC,CAAC,CAAD,CAAD,GAAKT,CAAC,CAACK,CAAD,CAA5C,EAAgDI,CAAC,CAAC,CAAD,CAAD,GAAKR,CAAC,CAACM,CAAD,CAAtD;AAA0D;AAAC;AAAC,KAA7N,GAA8N,aAAWT,CAAX,GAAaA,CAAC,IAAE;AAACA,MAAAA,CAAC,CAACuE,IAAF,GAAOrE,CAAC,CAACF,CAAC,CAACuE,IAAH,CAAR,EAAiBvE,CAAC,CAACwE,IAAF,GAAOrE,CAAC,CAACH,CAAC,CAACwE,IAAH,CAAzB,EAAkCxE,CAAC,CAACyE,IAAF,GAAOvE,CAAC,CAACF,CAAC,CAACyE,IAAH,CAA1C,EAAmDzE,CAAC,CAAC0E,IAAF,GAAOvE,CAAC,CAACH,CAAC,CAAC0E,IAAH,CAA3D;AAAoE,KAArF,GAAsF,iBAAe1E,CAAf,GAAiBA,CAAC,IAAE;AAAC,YAAMK,CAAC,GAACL,CAAC,CAACsE,MAAV;AAAiB,UAAI/D,CAAJ,EAAME,CAAN;;AAAQ,WAAI,IAAIE,CAAC,GAAC,CAAN,EAAQE,CAAC,GAACR,CAAC,CAACwC,MAAhB,EAAuBlC,CAAC,GAACE,CAAzB,EAA2BF,CAAC,EAA5B,EAA+B;AAAC,cAAMX,CAAC,GAACK,CAAC,CAACM,CAAD,CAAT;AAAaA,QAAAA,CAAC,GAAC,CAAF,IAAKJ,CAAC,IAAEP,CAAC,CAAC,CAAD,CAAJ,EAAQS,CAAC,IAAET,CAAC,CAAC,CAAD,CAAjB,KAAuBO,CAAC,GAACP,CAAC,CAAC,CAAD,CAAH,EAAOS,CAAC,GAACT,CAAC,CAAC,CAAD,CAAjC,GAAsCA,CAAC,CAAC,CAAD,CAAD,GAAKE,CAAC,CAACK,CAAD,CAA5C,EAAgDP,CAAC,CAAC,CAAD,CAAD,GAAKG,CAAC,CAACM,CAAD,CAAtD;AAA0D;AAAC,KAAtJ,GAAuJ,KAAK,CAA7f;AAA+f;;AAAp3F,CAArB;AAA24FT,CAAC,CAAC,CAACa,CAAC,CAAC;AAACqC,EAAAA,IAAI,EAACyB,MAAN;AAAaC,EAAAA,IAAI,EAAC;AAAC3B,IAAAA,KAAK,EAAC,CAAC;AAAR;AAAlB,CAAD,CAAF,CAAD,EAAoChB,CAAC,CAAC4C,SAAtC,EAAgD,kBAAhD,EAAmE,KAAK,CAAxE,CAAD,EAA4E7E,CAAC,CAAC,CAACa,CAAC,CAAC;AAACqC,EAAAA,IAAI,EAAC4B,OAAN;AAAcF,EAAAA,IAAI,EAAC;AAAC3B,IAAAA,KAAK,EAAC;AAAC8B,MAAAA,cAAc,EAAC/E,CAAC,KAAG;AAACgF,QAAAA,OAAO,EAAChF;AAAT,OAAH;AAAjB;AAAP;AAAnB,CAAD,CAAF,CAAD,EAAoEiC,CAAC,CAAC4C,SAAtE,EAAgF,uBAAhF,EAAwG,KAAK,CAA7G,CAA7E,EAA6L7E,CAAC,CAAC,CAACa,CAAC,CAAC;AAACqC,EAAAA,IAAI,EAAC,CAAC/C,CAAD,CAAN;AAAUyE,EAAAA,IAAI,EAAC;AAAC3B,IAAAA,KAAK,EAAC,CAAC;AAAR;AAAf,CAAD,CAAF,CAAD,EAAiChB,CAAC,CAAC4C,SAAnC,EAA6C,UAA7C,EAAwD,KAAK,CAA7D,CAA9L,EAA8P7E,CAAC,CAAC,CAACe,CAAC,CAAC,UAAD,CAAF,CAAD,EAAiBkB,CAAC,CAAC4C,SAAnB,EAA6B,cAA7B,EAA4C,IAA5C,CAA/P,EAAiT7E,CAAC,CAAC,CAACa,CAAC,CAAC;AAACqC,EAAAA,IAAI,EAAC,CAACzB,CAAD,CAAN;AAAUmD,EAAAA,IAAI,EAAC;AAAC3B,IAAAA,KAAK,EAAC,CAAC;AAAR;AAAf,CAAD,CAAF,CAAD,EAAiChB,CAAC,CAAC4C,SAAnC,EAA6C,QAA7C,EAAsD,KAAK,CAA3D,CAAlT,EAAgX7E,CAAC,CAAC,CAACa,CAAC,CAAC;AAACqC,EAAAA,IAAI,EAAC,CAAC,OAAD,EAAS,YAAT,EAAsB,UAAtB,EAAiC,SAAjC,EAA2C,QAA3C,EAAoD,MAApD,CAAN;AAAkE0B,EAAAA,IAAI,EAAC;AAACK,IAAAA,IAAI,EAAC;AAACnE,MAAAA,MAAM,EAACY,CAAC,CAACuD;AAAV;AAAN;AAAvE,CAAD,CAAF,CAAD,EAAqGhD,CAAC,CAAC4C,SAAvG,EAAiH,cAAjH,EAAgI,KAAK,CAArI,CAAjX,EAAyf7E,CAAC,CAAC,CAACmB,CAAC,CAAC,cAAD,CAAF,CAAD,EAAqBc,CAAC,CAAC4C,SAAvB,EAAiC,mBAAjC,EAAqD,IAArD,CAA1f,EAAqjB7E,CAAC,CAAC,CAACa,CAAC,CAAC;AAACqC,EAAAA,IAAI,EAAC4B,OAAN;AAAcF,EAAAA,IAAI,EAAC;AAAC3B,IAAAA,KAAK,EAAC;AAAC8B,MAAAA,cAAc,EAAC/E,CAAC,KAAG;AAACgF,QAAAA,OAAO,EAAChF;AAAT,OAAH;AAAjB;AAAP;AAAnB,CAAD,CAAF,CAAD,EAAoEiC,CAAC,CAAC4C,SAAtE,EAAgF,MAAhF,EAAuF,KAAK,CAA5F,CAAtjB,EAAqpB7E,CAAC,CAAC,CAACa,CAAC,CAAC;AAACqC,EAAAA,IAAI,EAAC4B,OAAN;AAAcF,EAAAA,IAAI,EAAC;AAAC3B,IAAAA,KAAK,EAAC;AAAC8B,MAAAA,cAAc,EAAC/E,CAAC,KAAG;AAACgF,QAAAA,OAAO,EAAChF;AAAT,OAAH;AAAjB;AAAP;AAAnB,CAAD,CAAF,CAAD,EAAoEiC,CAAC,CAAC4C,SAAtE,EAAgF,MAAhF,EAAuF,KAAK,CAA5F,CAAtpB,EAAqvB7E,CAAC,CAAC,CAACa,CAAC,CAAC;AAACqE,EAAAA,KAAK,EAAChF,CAAP;AAAS0E,EAAAA,IAAI,EAAC;AAAC3B,IAAAA,KAAK,EAAC,CAAC;AAAR;AAAd,CAAD,CAAF,CAAD,EAAgChB,CAAC,CAAC4C,SAAlC,EAA4C,eAA5C,EAA4D,KAAK,CAAjE,CAAtvB,EAA0zB7E,CAAC,CAAC,CAACe,CAAC,CAAC,eAAD,CAAF,CAAD,EAAsBkB,CAAC,CAAC4C,SAAxB,EAAkC,mBAAlC,EAAsD,IAAtD,CAA3zB,EAAu3B7E,CAAC,CAAC,CAACa,CAAC,CAAC;AAACqC,EAAAA,IAAI,EAAC9B,CAAN;AAAQwD,EAAAA,IAAI,EAAC;AAAC3B,IAAAA,KAAK,EAAC,CAAC;AAAR;AAAb,CAAD,CAAF,CAAD,EAA+BhB,CAAC,CAAC4C,SAAjC,EAA2C,kBAA3C,EAA8D,KAAK,CAAnE,CAAx3B,EAA87B7E,CAAC,CAAC,CAACmB,CAAC,CAAC,kBAAD,CAAF,CAAD,EAAyBc,CAAC,CAAC4C,SAA3B,EAAqC,uBAArC,EAA6D,IAA7D,CAA/7B,EAAkgC7E,CAAC,CAAC,CAACa,CAAC,CAAC;AAAC+D,EAAAA,IAAI,EAAC;AAAC3B,IAAAA,KAAK,EAAC,CAAC;AAAR;AAAN,CAAD,CAAF,CAAD,EAAwBhB,CAAC,CAAC4C,SAA1B,EAAoC,WAApC,EAAgD,KAAK,CAArD,CAAngC,EAA2jC5C,CAAC,GAACjC,CAAC,CAAC,CAACiB,CAAC,CAAC,8BAAD,CAAF,CAAD,EAAqCgB,CAArC,CAA9jC,EAAsmCA,CAAC,CAAC4C,SAAF,CAAYxB,MAAZ,CAAmB8B,eAAnB,GAAmC,CAAC,CAA1oC,EAA4oClD,CAAC,KAAGA,CAAC,GAAC,EAAL,CAA7oC;AAAspC,IAAImD,CAAC,GAACnD,CAAN;AAAQ,eAAemD,CAAf","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{geometryTypes as t}from\"../../geometry.js\";import r from\"../../Graphic.js\";import{JSONMap as o}from\"../../core/jsonMap.js\";import{JSONSupport as s}from\"../../core/JSONSupport.js\";import{isSome as n,unwrap as i}from\"../../core/maybe.js\";import{property as p}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{reader as l}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as y}from\"../../core/accessorSupport/decorators/writer.js\";import m from\"../../geometry/SpatialReference.js\";import{fromJSON as u,isPolygon as c}from\"../../geometry/support/jsonUtils.js\";import f from\"../../layers/support/Field.js\";const h=new o({esriGeometryPoint:\"point\",esriGeometryMultipoint:\"multipoint\",esriGeometryPolyline:\"polyline\",esriGeometryPolygon:\"polygon\",esriGeometryEnvelope:\"extent\",mesh:\"mesh\",\"\":null});let d=class extends s{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){const o=m.fromJSON(t.spatialReference),s=[];for(let i=0;i<e.length;i++){const t=e[i],p=r.fromJSON(t),l=t.geometry&&t.geometry.spatialReference;n(p.geometry)&&!l&&(p.geometry.spatialReference=o),s.push(p)}return s}writeGeometryType(e,t,r,o){if(e)return void h.write(e,t,r,o);const{features:s}=this;if(s)for(const i of s)if(i&&n(i.geometry))return void h.write(i.geometry.type,t,r,o)}readQueryGeometry(e,t){if(!e)return null;const r=!!e.spatialReference,o=u(e);return!r&&t.spatialReference&&(o.spatialReference=m.fromJSON(t.spatialReference)),o}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:r}=this;if(r)for(const o of r)if(o&&n(o.geometry)&&o.geometry.spatialReference)return void(t.spatialReference=o.geometry.spatialReference.toJSON())}toJSON(e){const t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(let r=0;r<t.features.length;r++){const o=t.features[r];if(o.geometry){const t=e&&e[r];o.geometry=t&&t.toJSON()||o.geometry}}return t}quantize(e){const{scale:[t,r],translate:[o,s]}=e,n=e=>Math.round((e-o)/t),p=e=>Math.round((s-e)/r),l=this.features,a=this._getQuantizationFunction(this.geometryType,n,p);for(let y=0,m=l.length;y<m;y++)a(i(l[y].geometry))||(l.splice(y,1),y--,m--);return this.transform=e,this}unquantize(){const{geometryType:e,features:t,transform:r}=this;if(!r)return this;const{translate:[o,s],scale:[i,p]}=r,l=e=>e*i+o,a=e=>s-e*p,y=this._getHydrationFunction(e,l,a);for(const{geometry:m}of t)n(m)&&y(m);return this.transform=null,this}_quantizePoints(e,t,r){let o,s;const n=[];for(let i=0,p=e.length;i<p;i++){const p=e[i];if(i>0){const e=t(p[0]),i=r(p[1]);e===o&&i===s||(n.push([e-o,i-s]),o=e,s=i)}else o=t(p[0]),s=r(p[1]),n.push([o,s])}return n.length>0?n:null}_getQuantizationFunction(e,t,r){return\"point\"===e?e=>(e.x=t(e.x),e.y=r(e.y),e):\"polyline\"===e||\"polygon\"===e?e=>{const o=c(e)?e.rings:e.paths,s=[];for(let n=0,i=o.length;n<i;n++){const e=o[n],i=this._quantizePoints(e,t,r);i&&s.push(i)}return s.length>0?(c(e)?e.rings=s:e.paths=s,e):null}:\"multipoint\"===e?e=>{const o=this._quantizePoints(e.points,t,r);return o.length>0?(e.points=o,e):null}:\"extent\"===e?e=>e:null}_getHydrationFunction(e,t,r){return\"point\"===e?e=>{e.x=t(e.x),e.y=r(e.y)}:\"polyline\"===e||\"polygon\"===e?e=>{const o=c(e)?e.rings:e.paths;let s,n;for(let i=0,p=o.length;i<p;i++){const e=o[i];for(let o=0,i=e.length;o<i;o++){const i=e[o];o>0?(s+=i[0],n+=i[1]):(s=i[0],n=i[1]),i[0]=t(s),i[1]=r(n)}}}:\"extent\"===e?e=>{e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:\"multipoint\"===e?e=>{const o=e.points;let s,n;for(let i=0,p=o.length;i<p;i++){const e=o[i];i>0?(s+=e[0],n+=e[1]):(s=e[0],n=e[1]),e[0]=t(s),e[1]=r(n)}}:void 0}};e([p({type:String,json:{write:!0}})],d.prototype,\"displayFieldName\",void 0),e([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],d.prototype,\"exceededTransferLimit\",void 0),e([p({type:[r],json:{write:!0}})],d.prototype,\"features\",void 0),e([l(\"features\")],d.prototype,\"readFeatures\",null),e([p({type:[f],json:{write:!0}})],d.prototype,\"fields\",void 0),e([p({type:[\"point\",\"multipoint\",\"polyline\",\"polygon\",\"extent\",\"mesh\"],json:{read:{reader:h.read}}})],d.prototype,\"geometryType\",void 0),e([y(\"geometryType\")],d.prototype,\"writeGeometryType\",null),e([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],d.prototype,\"hasM\",void 0),e([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],d.prototype,\"hasZ\",void 0),e([p({types:t,json:{write:!0}})],d.prototype,\"queryGeometry\",void 0),e([l(\"queryGeometry\")],d.prototype,\"readQueryGeometry\",null),e([p({type:m,json:{write:!0}})],d.prototype,\"spatialReference\",void 0),e([y(\"spatialReference\")],d.prototype,\"writeSpatialReference\",null),e([p({json:{write:!0}})],d.prototype,\"transform\",void 0),d=e([a(\"esri.rest.support.FeatureSet\")],d),d.prototype.toJSON.isDefaultToJSON=!0,d||(d={});var g=d;export default g;\n"]},"metadata":{},"sourceType":"module"}