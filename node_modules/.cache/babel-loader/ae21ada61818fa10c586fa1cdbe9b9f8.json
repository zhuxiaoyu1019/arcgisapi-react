{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../../Graphic.js\";\nimport { unwrap as o, isSome as t } from \"../../../core/maybe.js\";\nimport r from \"../../../geometry/Polygon.js\";\nimport s from \"../../../rest/support/AddressToLocationsParameters.js\";\nimport n from \"../../../rest/support/LocationToAddressParameters.js\";\nimport i from \"../../../rest/support/SuggestLocationsParameters.js\";\nimport { createExtentFromGeometry as c, scaleExtent as a } from \"./geometryUtils.js\";\nconst u = \"Single Line Input\",\n      l = 3e5;\n\nfunction m(e, o) {\n  return e.location ? v(e, o) : w(e, o);\n}\n\nfunction d(e) {\n  const o = null == e ? void 0 : e.scale;\n  return \"number\" == typeof o && o <= l ? e.get(\"extent.center\") : null;\n}\n\nfunction f(e, t) {\n  const {\n    source: r,\n    spatialReference: s,\n    view: n,\n    suggestTerm: c,\n    maxSuggestions: a,\n    sourceIndex: u\n  } = e,\n        l = new i(),\n        {\n    apiKey: m,\n    locator: f\n  } = r,\n        g = S(r, n),\n        p = t && t.signal;\n  if (!f) return Promise.resolve(null);\n  m && (l.apiKey = m), r.categories && (l.categories = r.categories), s && (l.outSpatialReference = s);\n  const y = d(n);\n  y && (l.location = y);\n  if (!c.trim()) return Promise.resolve(null);\n  const {\n    prefix: x = \"\",\n    suffix: v = \"\"\n  } = r,\n        w = `${x}${c}${v}`;\n  return l.text = w, g && (l.searchExtent = o(g)), l.maxSuggestions = a, r.countryCode && (l.countryCode = r.countryCode), f.suggestLocations(l, {\n    signal: p\n  }).then(e => $(e, u));\n}\n\nfunction g(e) {\n  return !!e && /(?:geocode\\-api\\.arcgis\\.com\\/arcgis\\/rest\\/services\\/world\\/geocodeserver).*/gi.test(e);\n}\n\nfunction p(e) {\n  return !!e && /(?:\\/servers\\/[\\da-z\\.-]+\\/rest\\/services\\/world\\/geocodeserver).*/gi.test(e);\n}\n\nfunction y(e) {\n  return !!e && /(?:arcgis\\.com\\/arcgis\\/rest\\/services\\/world\\/geocodeserver).*/gi.test(e);\n}\n\nconst x = \"https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer\";\n\nfunction v(e, o) {\n  const {\n    source: t,\n    spatialReference: r,\n    location: s,\n    sourceIndex: i,\n    view: c\n  } = e,\n        {\n    apiKey: a,\n    locator: u,\n    zoomScale: l,\n    defaultZoomScale: m\n  } = t,\n        d = c && c.scale,\n        f = o && o.signal,\n        g = new n();\n  return g.location = s, a && (g.apiKey = a), r && (g.outSpatialReference = r), u.locationToAddress(g, {\n    signal: f\n  }).then(e => K([e], {\n    sourceIndex: i,\n    scale: d,\n    view: c,\n    zoomScale: l,\n    defaultZoomScale: m\n  }));\n}\n\nfunction S(e, o) {\n  const {\n    filter: t,\n    withinViewEnabled: r\n  } = e,\n        s = o && o.scale,\n        n = o && o.extent,\n        i = t && t.geometry;\n  return c(i, o, s) || (r && n ? n : void 0);\n}\n\nfunction w(e, t) {\n  const {\n    source: r,\n    suggestResult: n,\n    spatialReference: i,\n    view: c,\n    maxResults: a,\n    sourceIndex: l\n  } = e,\n        m = r && r.zoomScale,\n        f = r && r.defaultZoomScale;\n  if (!n.text.trim()) return Promise.resolve(null);\n  const g = !n.key && r.prefix ? r.prefix : \"\",\n        p = !n.key && r.suffix ? r.suffix : \"\",\n        y = `${g}${n.text}${p}`,\n        x = new s(),\n        {\n    apiKey: v,\n    locator: w\n  } = r,\n        I = c && c.scale,\n        $ = S(r, c),\n        h = t && t.signal;\n  if (v && (x.apiKey = v), !w) return Promise.resolve(null);\n  r.categories && (x.categories = r.categories), r.locationType && (x.locationType = r.locationType), i && (x.outSpatialReference = i);\n  const L = d(c);\n  L && (x.location = L), x.maxLocations = a, $ && (x.searchExtent = o($)), r.countryCode && (x.countryCode = r.countryCode);\n  const {\n    key: P\n  } = n,\n        R = `${P}`;\n  return P && (x.magicKey = R), x.address = {}, x.address[r.singleLineFieldName || u] = y, r.outFields && (x.outFields = r.outFields), w.addressToLocations(x, {\n    signal: h\n  }).then(e => K(e, {\n    key: R,\n    scale: I,\n    sourceIndex: l,\n    view: c,\n    zoomScale: m,\n    defaultZoomScale: f\n  }));\n}\n\nfunction I(e, o) {\n  return {\n    text: e.text,\n    key: e.magicKey,\n    sourceIndex: o\n  };\n}\n\nfunction $(e, o) {\n  return e.map(e => I(e, o));\n}\n\nfunction h(o, s) {\n  const {\n    key: n,\n    scale: i,\n    sourceIndex: u,\n    view: l,\n    zoomScale: m,\n    defaultZoomScale: d\n  } = s,\n        {\n    attributes: f,\n    extent: g,\n    location: p,\n    address: y\n  } = o,\n        x = new e({\n    geometry: p,\n    attributes: f\n  }),\n        v = g || p,\n        S = c(v, l, i),\n        w = \"number\" == typeof m ? a(S, l, m) : \"number\" == typeof d && \"point\" === v.type ? a(S, l, d) : S,\n        I = p ? `${p.x},${p.y}` : \"\",\n        $ = y || I,\n        h = x.clone();\n  return t(w) && (h.geometry = r.fromExtent(w)), {\n    extent: w,\n    feature: x,\n    target: h,\n    key: n,\n    name: $,\n    sourceIndex: u\n  };\n}\n\nfunction K(e, o) {\n  return e.map(e => h(e, o));\n}\n\nexport { d as getLocation, m as getResults, f as getSuggestions, y as isArcGISWorldGeocoder, g as isMeteredArcGISWorldGeocoder, p as isProxiedArcGISWorldGeocoder, x as meteredArcGISLocatorUrl };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/widgets/Search/support/locatorUtils.js"],"names":["e","unwrap","o","isSome","t","r","s","n","i","createExtentFromGeometry","c","scaleExtent","a","u","l","m","location","v","w","d","scale","get","f","source","spatialReference","view","suggestTerm","maxSuggestions","sourceIndex","apiKey","locator","g","S","p","signal","Promise","resolve","categories","outSpatialReference","y","trim","prefix","x","suffix","text","searchExtent","countryCode","suggestLocations","then","$","test","zoomScale","defaultZoomScale","locationToAddress","K","filter","withinViewEnabled","extent","geometry","suggestResult","maxResults","key","I","h","locationType","L","maxLocations","P","R","magicKey","address","singleLineFieldName","outFields","addressToLocations","map","attributes","type","clone","fromExtent","feature","target","name","getLocation","getResults","getSuggestions","isArcGISWorldGeocoder","isMeteredArcGISWorldGeocoder","isProxiedArcGISWorldGeocoder","meteredArcGISLocatorUrl"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../Graphic.js\";import{unwrap as o,isSome as t}from\"../../../core/maybe.js\";import r from\"../../../geometry/Polygon.js\";import s from\"../../../rest/support/AddressToLocationsParameters.js\";import n from\"../../../rest/support/LocationToAddressParameters.js\";import i from\"../../../rest/support/SuggestLocationsParameters.js\";import{createExtentFromGeometry as c,scaleExtent as a}from\"./geometryUtils.js\";const u=\"Single Line Input\",l=3e5;function m(e,o){return e.location?v(e,o):w(e,o)}function d(e){const o=null==e?void 0:e.scale;return\"number\"==typeof o&&o<=l?e.get(\"extent.center\"):null}function f(e,t){const{source:r,spatialReference:s,view:n,suggestTerm:c,maxSuggestions:a,sourceIndex:u}=e,l=new i,{apiKey:m,locator:f}=r,g=S(r,n),p=t&&t.signal;if(!f)return Promise.resolve(null);m&&(l.apiKey=m),r.categories&&(l.categories=r.categories),s&&(l.outSpatialReference=s);const y=d(n);y&&(l.location=y);if(!c.trim())return Promise.resolve(null);const{prefix:x=\"\",suffix:v=\"\"}=r,w=`${x}${c}${v}`;return l.text=w,g&&(l.searchExtent=o(g)),l.maxSuggestions=a,r.countryCode&&(l.countryCode=r.countryCode),f.suggestLocations(l,{signal:p}).then((e=>$(e,u)))}function g(e){return!!e&&/(?:geocode\\-api\\.arcgis\\.com\\/arcgis\\/rest\\/services\\/world\\/geocodeserver).*/gi.test(e)}function p(e){return!!e&&/(?:\\/servers\\/[\\da-z\\.-]+\\/rest\\/services\\/world\\/geocodeserver).*/gi.test(e)}function y(e){return!!e&&/(?:arcgis\\.com\\/arcgis\\/rest\\/services\\/world\\/geocodeserver).*/gi.test(e)}const x=\"https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer\";function v(e,o){const{source:t,spatialReference:r,location:s,sourceIndex:i,view:c}=e,{apiKey:a,locator:u,zoomScale:l,defaultZoomScale:m}=t,d=c&&c.scale,f=o&&o.signal,g=new n;return g.location=s,a&&(g.apiKey=a),r&&(g.outSpatialReference=r),u.locationToAddress(g,{signal:f}).then((e=>K([e],{sourceIndex:i,scale:d,view:c,zoomScale:l,defaultZoomScale:m})))}function S(e,o){const{filter:t,withinViewEnabled:r}=e,s=o&&o.scale,n=o&&o.extent,i=t&&t.geometry;return c(i,o,s)||(r&&n?n:void 0)}function w(e,t){const{source:r,suggestResult:n,spatialReference:i,view:c,maxResults:a,sourceIndex:l}=e,m=r&&r.zoomScale,f=r&&r.defaultZoomScale;if(!n.text.trim())return Promise.resolve(null);const g=!n.key&&r.prefix?r.prefix:\"\",p=!n.key&&r.suffix?r.suffix:\"\",y=`${g}${n.text}${p}`,x=new s,{apiKey:v,locator:w}=r,I=c&&c.scale,$=S(r,c),h=t&&t.signal;if(v&&(x.apiKey=v),!w)return Promise.resolve(null);r.categories&&(x.categories=r.categories),r.locationType&&(x.locationType=r.locationType),i&&(x.outSpatialReference=i);const L=d(c);L&&(x.location=L),x.maxLocations=a,$&&(x.searchExtent=o($)),r.countryCode&&(x.countryCode=r.countryCode);const{key:P}=n,R=`${P}`;return P&&(x.magicKey=R),x.address={},x.address[r.singleLineFieldName||u]=y,r.outFields&&(x.outFields=r.outFields),w.addressToLocations(x,{signal:h}).then((e=>K(e,{key:R,scale:I,sourceIndex:l,view:c,zoomScale:m,defaultZoomScale:f})))}function I(e,o){return{text:e.text,key:e.magicKey,sourceIndex:o}}function $(e,o){return e.map((e=>I(e,o)))}function h(o,s){const{key:n,scale:i,sourceIndex:u,view:l,zoomScale:m,defaultZoomScale:d}=s,{attributes:f,extent:g,location:p,address:y}=o,x=new e({geometry:p,attributes:f}),v=g||p,S=c(v,l,i),w=\"number\"==typeof m?a(S,l,m):\"number\"==typeof d&&\"point\"===v.type?a(S,l,d):S,I=p?`${p.x},${p.y}`:\"\",$=y||I,h=x.clone();return t(w)&&(h.geometry=r.fromExtent(w)),{extent:w,feature:x,target:h,key:n,name:$,sourceIndex:u}}function K(e,o){return e.map((e=>h(e,o)))}export{d as getLocation,m as getResults,f as getSuggestions,y as isArcGISWorldGeocoder,g as isMeteredArcGISWorldGeocoder,p as isProxiedArcGISWorldGeocoder,x as meteredArcGISLocatorUrl};\n"]},"metadata":{},"sourceType":"module"}