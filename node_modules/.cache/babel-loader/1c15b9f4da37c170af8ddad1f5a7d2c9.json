{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { ScreenSpacePass as e } from \"../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.js\";\nimport { glsl as r } from \"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";\nimport { ShaderBuilder as a } from \"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";\n\nfunction o(o) {\n  const t = new a();\n  return t.include(e), t.fragment.uniforms.add(\"tex\", \"sampler2D\"), 0 === o.function && (o.hasOpacityFactor ? (t.fragment.uniforms.add(\"opacity\", \"float\"), t.fragment.code.add(r`void main() {\ngl_FragColor = texture2D(tex, uv) * opacity;\n}`)) : t.fragment.code.add(r`void main() {\ngl_FragColor = texture2D(tex, uv);\n}`)), 3 === o.function && (t.fragment.uniforms.add(\"overlayIdx\", \"int\"), o.hasOpacityFactor && t.fragment.uniforms.add(\"opacity\", \"float\"), t.fragment.code.add(r`\n      void main() {\n        vec2 overlayUV = overlayIdx == 0 ? vec2(uv.x * 0.5, uv.y) : vec2(uv.x * 0.5+ 0.5, uv.y);\n        gl_FragColor = texture2D(tex, overlayUV) ${o.hasOpacityFactor ? \"* opacity\" : \"\"};\n      }`)), 1 === o.function && t.fragment.code.add(r`void main() {\ngl_FragColor = vec4(1.0 - texture2D(tex, uv).a);\n}`), 2 === o.function && (t.fragment.uniforms.add(\"colorTexture\", \"sampler2D\"), t.fragment.uniforms.add(\"alphaTexture\", \"sampler2D\"), t.fragment.uniforms.add(\"frontFaceTexture\", \"sampler2D\"), t.fragment.code.add(r`void main() {\nvec4 srcColor = texture2D(colorTexture, uv);\nfloat srcAlpha = texture2D(alphaTexture, uv).r;\nvec4 frontFace = texture2D(frontFaceTexture, uv);\nif(srcColor.a <= 1e-5){\ndiscard;\n}\ngl_FragColor = vec4(mix(srcColor.rgb/srcColor.a, frontFace.rgb, frontFace.a), 1.0 - srcAlpha);\n}`)), t;\n}\n\nvar t = Object.freeze({\n  __proto__: null,\n  build: o\n});\nexport { t as C, o as b };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/chunks/Compositing.glsl.js"],"names":["ScreenSpacePass","e","glsl","r","ShaderBuilder","a","o","t","include","fragment","uniforms","add","function","hasOpacityFactor","code","Object","freeze","__proto__","build","C","b"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,eAAe,IAAIC,CAA1B,QAAgC,gEAAhC;AAAiG,SAAOC,IAAI,IAAIC,CAAf,QAAqB,2DAArB;AAAiF,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,8DAA9B;;AAA6F,SAASC,CAAT,CAAWA,CAAX,EAAa;AAAC,QAAMC,CAAC,GAAC,IAAIF,CAAJ,EAAR;AAAc,SAAOE,CAAC,CAACC,OAAF,CAAUP,CAAV,GAAaM,CAAC,CAACE,QAAF,CAAWC,QAAX,CAAoBC,GAApB,CAAwB,KAAxB,EAA8B,WAA9B,CAAb,EAAwD,MAAIL,CAAC,CAACM,QAAN,KAAiBN,CAAC,CAACO,gBAAF,IAAoBN,CAAC,CAACE,QAAF,CAAWC,QAAX,CAAoBC,GAApB,CAAwB,SAAxB,EAAkC,OAAlC,GAA2CJ,CAAC,CAACE,QAAF,CAAWK,IAAX,CAAgBH,GAAhB,CAAoBR,CAAE;AAChd;AACA,EAF0b,CAA/D,IAEtXI,CAAC,CAACE,QAAF,CAAWK,IAAX,CAAgBH,GAAhB,CAAoBR,CAAE;AAC3B;AACA,EAFK,CAFqW,CAAxD,EAI7S,MAAIG,CAAC,CAACM,QAAN,KAAiBL,CAAC,CAACE,QAAF,CAAWC,QAAX,CAAoBC,GAApB,CAAwB,YAAxB,EAAqC,KAArC,GAA4CL,CAAC,CAACO,gBAAF,IAAoBN,CAAC,CAACE,QAAF,CAAWC,QAAX,CAAoBC,GAApB,CAAwB,SAAxB,EAAkC,OAAlC,CAAhE,EAA2GJ,CAAC,CAACE,QAAF,CAAWK,IAAX,CAAgBH,GAAhB,CAAoBR,CAAE;AACvJ;AACA;AACA,mDAAmDG,CAAC,CAACO,gBAAF,GAAmB,WAAnB,GAA+B,EAAG;AACrF,QAJiI,CAA5H,CAJ6S,EAQvS,MAAIP,CAAC,CAACM,QAAN,IAAgBL,CAAC,CAACE,QAAF,CAAWK,IAAX,CAAgBH,GAAhB,CAAoBR,CAAE;AACjD;AACA,EAF2B,CARuR,EAU9S,MAAIG,CAAC,CAACM,QAAN,KAAiBL,CAAC,CAACE,QAAF,CAAWC,QAAX,CAAoBC,GAApB,CAAwB,cAAxB,EAAuC,WAAvC,GAAoDJ,CAAC,CAACE,QAAF,CAAWC,QAAX,CAAoBC,GAApB,CAAwB,cAAxB,EAAuC,WAAvC,CAApD,EAAwGJ,CAAC,CAACE,QAAF,CAAWC,QAAX,CAAoBC,GAApB,CAAwB,kBAAxB,EAA2C,WAA3C,CAAxG,EAAgKJ,CAAC,CAACE,QAAF,CAAWK,IAAX,CAAgBH,GAAhB,CAAoBR,CAAE;AAC3M;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EARqL,CAAjL,CAV8S,EAkB7SI,CAlBsS;AAkBpS;;AAAA,IAAIA,CAAC,GAACQ,MAAM,CAACC,MAAP,CAAc;AAACC,EAAAA,SAAS,EAAC,IAAX;AAAgBC,EAAAA,KAAK,EAACZ;AAAtB,CAAd,CAAN;AAA8C,SAAOC,CAAC,IAAIY,CAAZ,EAAcb,CAAC,IAAIc,CAAnB","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{ScreenSpacePass as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.js\";import{glsl as r}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as a}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function o(o){const t=new a;return t.include(e),t.fragment.uniforms.add(\"tex\",\"sampler2D\"),0===o.function&&(o.hasOpacityFactor?(t.fragment.uniforms.add(\"opacity\",\"float\"),t.fragment.code.add(r`void main() {\ngl_FragColor = texture2D(tex, uv) * opacity;\n}`)):t.fragment.code.add(r`void main() {\ngl_FragColor = texture2D(tex, uv);\n}`)),3===o.function&&(t.fragment.uniforms.add(\"overlayIdx\",\"int\"),o.hasOpacityFactor&&t.fragment.uniforms.add(\"opacity\",\"float\"),t.fragment.code.add(r`\n      void main() {\n        vec2 overlayUV = overlayIdx == 0 ? vec2(uv.x * 0.5, uv.y) : vec2(uv.x * 0.5+ 0.5, uv.y);\n        gl_FragColor = texture2D(tex, overlayUV) ${o.hasOpacityFactor?\"* opacity\":\"\"};\n      }`)),1===o.function&&t.fragment.code.add(r`void main() {\ngl_FragColor = vec4(1.0 - texture2D(tex, uv).a);\n}`),2===o.function&&(t.fragment.uniforms.add(\"colorTexture\",\"sampler2D\"),t.fragment.uniforms.add(\"alphaTexture\",\"sampler2D\"),t.fragment.uniforms.add(\"frontFaceTexture\",\"sampler2D\"),t.fragment.code.add(r`void main() {\nvec4 srcColor = texture2D(colorTexture, uv);\nfloat srcAlpha = texture2D(alphaTexture, uv).r;\nvec4 frontFace = texture2D(frontFaceTexture, uv);\nif(srcColor.a <= 1e-5){\ndiscard;\n}\ngl_FragColor = vec4(mix(srcColor.rgb/srcColor.a, frontFace.rgb, frontFace.a), 1.0 - srcAlpha);\n}`)),t}var t=Object.freeze({__proto__:null,build:o});export{t as C,o as b};\n"]},"metadata":{},"sourceType":"module"}