{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../request.js\";\nimport { createQueryParamsHelper as r } from \"../core/queryUtils.js\";\nimport { normalizeCentralMeridian as t } from \"../geometry/support/normalizeUtils.js\";\nimport { collectGeometries as s, isInputGeometryZAware as o, fetchServiceDescription as i, dropZValuesOffInputGeometry as a, handleSolveResponse as n } from \"./networkService.js\";\nimport { parseUrl as u } from \"./utils.js\";\nconst p = r({\n  accumulateAttributes: {\n    name: \"accumulateAttributeNames\"\n  },\n  attributeParameterValues: !0,\n  directionsTimeAttribute: {\n    name: \"directionsTimeAttributeName\"\n  },\n  impedanceAttribute: {\n    name: \"impedanceAttributeName\"\n  },\n  outSpatialReference: {\n    name: \"outSR\",\n    getter: e => e.outSpatialReference.wkid\n  },\n  pointBarriers: {\n    name: \"barriers\"\n  },\n  polylineBarriers: !0,\n  polygonBarriers: !0,\n  restrictionAttributes: {\n    name: \"restrictionAttributeNames\"\n  },\n  stops: !0,\n  travelMode: !0\n});\n\nasync function m(r, m, l) {\n  const c = [],\n        f = [],\n        y = {},\n        B = {},\n        h = u(r);\n  return m.stops && m.stops.features && s(m.stops.features, f, \"stops.features\", y), m.pointBarriers && m.pointBarriers.features && s(m.pointBarriers.features, f, \"pointBarriers.features\", y), m.polylineBarriers && m.polylineBarriers.features && s(m.polylineBarriers.features, f, \"polylineBarriers.features\", y), m.polygonBarriers && m.polygonBarriers.features && s(m.polygonBarriers.features, f, \"polygonBarriers.features\", y), t(f).then(e => {\n    for (const r in y) {\n      const t = y[r];\n      c.push(r), B[r] = e.slice(t[0], t[1]);\n    }\n\n    return o(B, c) ? i(h.path) : Promise.resolve({\n      dontCheck: !0\n    });\n  }).then(r => {\n    (\"dontCheck\" in r ? r.dontCheck : r.hasZ) || a(B, c);\n\n    for (const e in B) B[e].forEach((r, t) => {\n      m.get(e)[t].geometry = r;\n    });\n\n    const t = { ...l,\n      query: { ...h.query,\n        ...p.toQueryParams(m),\n        f: \"json\"\n      }\n    },\n          {\n      path: s\n    } = h,\n          o = \"/solve\",\n          i = s.endsWith(o) ? s : s + o;\n    return e(i, t);\n  }).then(e => n(e));\n}\n\nexport { m as solve };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/rest/route.js"],"names":["e","createQueryParamsHelper","r","normalizeCentralMeridian","t","collectGeometries","s","isInputGeometryZAware","o","fetchServiceDescription","i","dropZValuesOffInputGeometry","a","handleSolveResponse","n","parseUrl","u","p","accumulateAttributes","name","attributeParameterValues","directionsTimeAttribute","impedanceAttribute","outSpatialReference","getter","wkid","pointBarriers","polylineBarriers","polygonBarriers","restrictionAttributes","stops","travelMode","m","l","c","f","y","B","h","features","then","push","slice","path","Promise","resolve","dontCheck","hasZ","forEach","get","geometry","query","toQueryParams","endsWith","solve"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../request.js\";import{createQueryParamsHelper as r}from\"../core/queryUtils.js\";import{normalizeCentralMeridian as t}from\"../geometry/support/normalizeUtils.js\";import{collectGeometries as s,isInputGeometryZAware as o,fetchServiceDescription as i,dropZValuesOffInputGeometry as a,handleSolveResponse as n}from\"./networkService.js\";import{parseUrl as u}from\"./utils.js\";const p=r({accumulateAttributes:{name:\"accumulateAttributeNames\"},attributeParameterValues:!0,directionsTimeAttribute:{name:\"directionsTimeAttributeName\"},impedanceAttribute:{name:\"impedanceAttributeName\"},outSpatialReference:{name:\"outSR\",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:\"barriers\"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:\"restrictionAttributeNames\"},stops:!0,travelMode:!0});async function m(r,m,l){const c=[],f=[],y={},B={},h=u(r);return m.stops&&m.stops.features&&s(m.stops.features,f,\"stops.features\",y),m.pointBarriers&&m.pointBarriers.features&&s(m.pointBarriers.features,f,\"pointBarriers.features\",y),m.polylineBarriers&&m.polylineBarriers.features&&s(m.polylineBarriers.features,f,\"polylineBarriers.features\",y),m.polygonBarriers&&m.polygonBarriers.features&&s(m.polygonBarriers.features,f,\"polygonBarriers.features\",y),t(f).then((e=>{for(const r in y){const t=y[r];c.push(r),B[r]=e.slice(t[0],t[1])}return o(B,c)?i(h.path):Promise.resolve({dontCheck:!0})})).then((r=>{(\"dontCheck\"in r?r.dontCheck:r.hasZ)||a(B,c);for(const e in B)B[e].forEach(((r,t)=>{m.get(e)[t].geometry=r}));const t={...l,query:{...h.query,...p.toQueryParams(m),f:\"json\"}},{path:s}=h,o=\"/solve\",i=s.endsWith(o)?s:s+o;return e(i,t)})).then((e=>n(e)))}export{m as solve};\n"]},"metadata":{},"sourceType":"module"}