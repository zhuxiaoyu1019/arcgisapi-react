{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { PathTransformationCursor as t } from \"../CIMCursor.js\";\nimport { PlacementEndings as e } from \"../enums.js\";\nimport { GeometryWalker as s, DashPattern as i } from \"../GeometryWalker.js\";\n\nclass n {\n  static local() {\n    return null === n.instance && (n.instance = new n()), n.instance;\n  }\n\n  execute(t, e, s) {\n    return new a(t, e, s);\n  }\n\n}\n\nn.instance = null;\n\nclass a extends t {\n  constructor(t, e, n) {\n    super(t, !0, !0), this._grometryWalker = new s(), this._grometryWalker.updateTolerance(n), this._angleToLine = void 0 === e.angleToLine || e.angleToLine, this._offset = void 0 !== e.offset ? e.offset * n : 0, this._originalEndings = e.endings, this._offsetAtEnd = void 0 !== e.customEndingOffset ? e.customEndingOffset * n : 0, this._position = void 0 !== e.offsetAlongLine ? e.offsetAlongLine * n : 0, this._pattern = new i(), this._pattern.init(e.placementTemplate, !1), this._pattern.scale(n), this._endings = this._originalEndings;\n  }\n\n  processPath(t) {\n    if (this._pattern.isEmpty()) return null;\n    let s;\n    if (this.iteratePath) s = this._pattern.nextValue();else {\n      this._originalEndings === e.WithFullGap && this.isClosed ? this._endings = e.WithMarkers : this._endings = this._originalEndings, this._pattern.extPtGap = 0;\n      let i,\n          n = !0;\n\n      switch (this._endings) {\n        case e.NoConstraint:\n          i = -this._position, i = this._adjustPosition(i), n = !1;\n          break;\n\n        case e.WithHalfGap:\n        default:\n          i = -this._pattern.lastValue() / 2;\n          break;\n\n        case e.WithFullGap:\n          i = -this._pattern.lastValue(), this._pattern.extPtGap = this._pattern.lastValue();\n          break;\n\n        case e.WithMarkers:\n          i = 0;\n          break;\n\n        case e.Custom:\n          i = -this._position, i = this._adjustPosition(i), this._pattern.extPtGap = .5 * this._offsetAtEnd;\n      }\n\n      if (!this._grometryWalker.init(t, this._pattern, n)) return null;\n\n      this._pattern.reset();\n\n      let a = 0;\n\n      for (; i > a;) i -= a, a = this._pattern.nextValue();\n\n      a -= i, s = a, this.iteratePath = !0;\n    }\n    const i = {};\n    return this._grometryWalker.nextPointAndAngle(s, i) ? this._endings === e.WithFullGap && this._grometryWalker.isPathEnd() ? (this.iteratePath = !1, null) : this._endings === e.WithMarkers && this._grometryWalker.isPathEnd() && (this.iteratePath = !1, this.isClosed) ? null : (this.internalPlacement.setTranslate(i.pt[0] + this._offset * i.sa, i.pt[1] - this._offset * i.ca), this._angleToLine && this.internalPlacement.setRotateCS(i.ca, i.sa), this.internalPlacement) : (this.iteratePath = !1, null);\n  }\n\n  _adjustPosition(t) {\n    let e = t / this._pattern.length();\n\n    return e -= Math.floor(e), e * this._pattern.length();\n  }\n\n}\n\nexport { n as PlacementAlongLineSameSize };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/symbols/cim/placements/PlacementAlongLineSameSize.js"],"names":["PathTransformationCursor","t","PlacementEndings","e","GeometryWalker","s","DashPattern","i","n","local","instance","execute","a","constructor","_grometryWalker","updateTolerance","_angleToLine","angleToLine","_offset","offset","_originalEndings","endings","_offsetAtEnd","customEndingOffset","_position","offsetAlongLine","_pattern","init","placementTemplate","scale","_endings","processPath","isEmpty","iteratePath","nextValue","WithFullGap","isClosed","WithMarkers","extPtGap","NoConstraint","_adjustPosition","WithHalfGap","lastValue","Custom","reset","nextPointAndAngle","isPathEnd","internalPlacement","setTranslate","pt","sa","ca","setRotateCS","length","Math","floor","PlacementAlongLineSameSize"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{PathTransformationCursor as t}from\"../CIMCursor.js\";import{PlacementEndings as e}from\"../enums.js\";import{GeometryWalker as s,DashPattern as i}from\"../GeometryWalker.js\";class n{static local(){return null===n.instance&&(n.instance=new n),n.instance}execute(t,e,s){return new a(t,e,s)}}n.instance=null;class a extends t{constructor(t,e,n){super(t,!0,!0),this._grometryWalker=new s,this._grometryWalker.updateTolerance(n),this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*n:0,this._originalEndings=e.endings,this._offsetAtEnd=void 0!==e.customEndingOffset?e.customEndingOffset*n:0,this._position=void 0!==e.offsetAlongLine?e.offsetAlongLine*n:0,this._pattern=new i,this._pattern.init(e.placementTemplate,!1),this._pattern.scale(n),this._endings=this._originalEndings}processPath(t){if(this._pattern.isEmpty())return null;let s;if(this.iteratePath)s=this._pattern.nextValue();else{this._originalEndings===e.WithFullGap&&this.isClosed?this._endings=e.WithMarkers:this._endings=this._originalEndings,this._pattern.extPtGap=0;let i,n=!0;switch(this._endings){case e.NoConstraint:i=-this._position,i=this._adjustPosition(i),n=!1;break;case e.WithHalfGap:default:i=-this._pattern.lastValue()/2;break;case e.WithFullGap:i=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case e.WithMarkers:i=0;break;case e.Custom:i=-this._position,i=this._adjustPosition(i),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._grometryWalker.init(t,this._pattern,n))return null;this._pattern.reset();let a=0;for(;i>a;)i-=a,a=this._pattern.nextValue();a-=i,s=a,this.iteratePath=!0}const i={};return this._grometryWalker.nextPointAndAngle(s,i)?this._endings===e.WithFullGap&&this._grometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===e.WithMarkers&&this._grometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(i.pt[0]+this._offset*i.sa,i.pt[1]-this._offset*i.ca),this._angleToLine&&this.internalPlacement.setRotateCS(i.ca,i.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(t){let e=t/this._pattern.length();return e-=Math.floor(e),e*this._pattern.length()}}export{n as PlacementAlongLineSameSize};\n"]},"metadata":{},"sourceType":"module"}