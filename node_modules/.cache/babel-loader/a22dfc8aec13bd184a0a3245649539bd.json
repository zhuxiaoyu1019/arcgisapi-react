{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../../../../core/Error.js\";\nimport { parseTransform as t, parseFieldType as s } from \"../../../../../rest/query/operations/pbfFeatureServiceParser.js\";\nconst r = 268435455;\n\nclass n {\n  constructor() {\n    this.fieldMap = new Map(), this.fields = [], this.hasFeatures = !1, this.fieldCount = 0, this.featureCount = 0, this.objectIdFieldIndex = 0, this.offsets = {\n      attributes: new Array(),\n      geometry: new Array()\n    }, this.centroid = new Array();\n  }\n\n  hasField(e) {\n    return this.fieldMap.has(e);\n  }\n\n  isDateField(e) {\n    var t;\n    return null == (t = this.fieldMap.get(e)) ? void 0 : t.isDate;\n  }\n\n  getFieldIndex(e) {\n    var t;\n    return null == (t = this.fieldMap.get(e)) ? void 0 : t.index;\n  }\n\n}\n\nfunction a(e) {\n  const t = 1,\n        r = 2,\n        n = e.getLength(),\n        a = e.pos() + n,\n        i = {\n    name: \"\",\n    isDate: !1\n  };\n\n  for (; e.pos() < a && e.next();) switch (e.tag()) {\n    case t:\n      i.name = e.getString();\n      break;\n\n    case r:\n      \"esriFieldTypeDate\" === s(e.getEnum()) && (i.isDate = !0);\n      break;\n\n    default:\n      e.skip();\n  }\n\n  return i;\n}\n\nfunction i(e) {\n  return e.toLowerCase().trim();\n}\n\nfunction o(s, o, c = !1) {\n  const f = 1,\n        d = 3,\n        l = 9,\n        u = 12,\n        g = 13,\n        p = 15,\n        h = s.pos(),\n        m = new n();\n  let b = 0,\n      w = 0;\n  const k = 1,\n        y = 2,\n        I = 4,\n        x = 3;\n  let F = null,\n      L = null,\n      A = null,\n      S = !1;\n\n  for (; s.next();) switch (s.tag()) {\n    case f:\n      F = s.getString();\n      break;\n\n    case d:\n      L = s.getString();\n      break;\n\n    case u:\n      A = s.processMessage(t);\n      break;\n\n    case l:\n      if (m.exceededTransferLimit = s.getBool(), m.exceededTransferLimit) {\n        m.offsets.geometry = c ? new Float64Array(8e3) : new Int32Array(8e3), m.centroid = c ? new Float64Array(16e3) : new Int32Array(16e3);\n\n        for (let e = 0; e < m.centroid.length; e++) m.centroid[e] = r;\n      }\n\n      break;\n\n    case g:\n      {\n        const e = a(s),\n              t = e.name,\n              r = i(e.name),\n              n = {\n          fieldName: t,\n          index: b++,\n          isDate: e.isDate\n        };\n        m.fields.push(n), m.fieldMap.set(e.name, n), m.fieldMap.set(r, n);\n        break;\n      }\n\n    case p:\n      {\n        const e = s.getLength(),\n              t = s.pos() + e;\n\n        if (!m.exceededTransferLimit) {\n          const e = m.offsets.geometry,\n                t = m.centroid;\n          e.push(0), t.push(r), t.push(r);\n        }\n\n        !S && m.exceededTransferLimit && (S = !0, m.offsets.attributes = c ? new Float64Array(8e3 * b) : new Uint32Array(8e3 * b));\n        let n = w * b;\n\n        for (; s.pos() < t && s.next();) switch (s.tag()) {\n          case k:\n            {\n              if (S) m.offsets.attributes[n++] = s.pos();else {\n                m.offsets.attributes.push(s.pos());\n              }\n              const e = s.getLength();\n              s.skipLen(e);\n              break;\n            }\n\n          case y:\n            if (o) {\n              const e = s.getLength(),\n                    t = s.pos() + e;\n\n              for (; s.pos() < t && s.next();) switch (s.tag()) {\n                case x:\n                  {\n                    s.getUInt32();\n                    const e = s.getSInt64(),\n                          t = s.getSInt64();\n                    m.centroid[2 * w] = e, m.centroid[2 * w + 1] = t;\n                    break;\n                  }\n\n                default:\n                  s.skip();\n              }\n            } else {\n              m.offsets.geometry[w] = s.pos();\n              const e = s.getLength();\n              s.skipLen(e);\n            }\n\n            break;\n\n          case I:\n            {\n              const e = s.getLength(),\n                    t = s.pos() + e;\n\n              for (; s.pos() < t && s.next();) switch (s.tag()) {\n                case x:\n                  {\n                    s.getUInt32();\n                    const e = s.getSInt64(),\n                          t = s.getSInt64();\n                    m.centroid[2 * w] = e, m.centroid[2 * w + 1] = t;\n                    break;\n                  }\n\n                default:\n                  s.skip();\n              }\n\n              break;\n            }\n\n          default:\n            s.skip();\n        }\n\n        w++, m.hasFeatures = !0;\n        break;\n      }\n\n    default:\n      s.skip();\n  }\n\n  const M = F || L;\n  if (!M) throw new e(\"FeatureSet has no objectId or globalId field name\");\n  return m.featureCount = w, m.fieldCount = b, m.objectIdFieldIndex = m.getFieldIndex(M), m.transform = A, m.displayIds = new Uint32Array(m.featureCount), m.groupIds = new Uint16Array(m.featureCount), s.move(h), m;\n}\n\nexport { n as FeatureSetHeader, o as parseHeader };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBFHeader.js"],"names":["e","parseTransform","t","parseFieldType","s","r","n","constructor","fieldMap","Map","fields","hasFeatures","fieldCount","featureCount","objectIdFieldIndex","offsets","attributes","Array","geometry","centroid","hasField","has","isDateField","get","isDate","getFieldIndex","index","a","getLength","pos","i","name","next","tag","getString","getEnum","skip","toLowerCase","trim","o","c","f","d","l","u","g","p","h","m","b","w","k","y","I","x","F","L","A","S","processMessage","exceededTransferLimit","getBool","Float64Array","Int32Array","length","fieldName","push","set","Uint32Array","skipLen","getUInt32","getSInt64","M","transform","displayIds","groupIds","Uint16Array","move","FeatureSetHeader","parseHeader"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../core/Error.js\";import{parseTransform as t,parseFieldType as s}from\"../../../../../rest/query/operations/pbfFeatureServiceParser.js\";const r=268435455;class n{constructor(){this.fieldMap=new Map,this.fields=[],this.hasFeatures=!1,this.fieldCount=0,this.featureCount=0,this.objectIdFieldIndex=0,this.offsets={attributes:new Array,geometry:new Array},this.centroid=new Array}hasField(e){return this.fieldMap.has(e)}isDateField(e){var t;return null==(t=this.fieldMap.get(e))?void 0:t.isDate}getFieldIndex(e){var t;return null==(t=this.fieldMap.get(e))?void 0:t.index}}function a(e){const t=1,r=2,n=e.getLength(),a=e.pos()+n,i={name:\"\",isDate:!1};for(;e.pos()<a&&e.next();)switch(e.tag()){case t:i.name=e.getString();break;case r:\"esriFieldTypeDate\"===s(e.getEnum())&&(i.isDate=!0);break;default:e.skip()}return i}function i(e){return e.toLowerCase().trim()}function o(s,o,c=!1){const f=1,d=3,l=9,u=12,g=13,p=15,h=s.pos(),m=new n;let b=0,w=0;const k=1,y=2,I=4,x=3;let F=null,L=null,A=null,S=!1;for(;s.next();)switch(s.tag()){case f:F=s.getString();break;case d:L=s.getString();break;case u:A=s.processMessage(t);break;case l:if(m.exceededTransferLimit=s.getBool(),m.exceededTransferLimit){m.offsets.geometry=c?new Float64Array(8e3):new Int32Array(8e3),m.centroid=c?new Float64Array(16e3):new Int32Array(16e3);for(let e=0;e<m.centroid.length;e++)m.centroid[e]=r}break;case g:{const e=a(s),t=e.name,r=i(e.name),n={fieldName:t,index:b++,isDate:e.isDate};m.fields.push(n),m.fieldMap.set(e.name,n),m.fieldMap.set(r,n);break}case p:{const e=s.getLength(),t=s.pos()+e;if(!m.exceededTransferLimit){const e=m.offsets.geometry,t=m.centroid;e.push(0),t.push(r),t.push(r)}!S&&m.exceededTransferLimit&&(S=!0,m.offsets.attributes=c?new Float64Array(8e3*b):new Uint32Array(8e3*b));let n=w*b;for(;s.pos()<t&&s.next();)switch(s.tag()){case k:{if(S)m.offsets.attributes[n++]=s.pos();else{m.offsets.attributes.push(s.pos())}const e=s.getLength();s.skipLen(e);break}case y:if(o){const e=s.getLength(),t=s.pos()+e;for(;s.pos()<t&&s.next();)switch(s.tag()){case x:{s.getUInt32();const e=s.getSInt64(),t=s.getSInt64();m.centroid[2*w]=e,m.centroid[2*w+1]=t;break}default:s.skip()}}else{m.offsets.geometry[w]=s.pos();const e=s.getLength();s.skipLen(e)}break;case I:{const e=s.getLength(),t=s.pos()+e;for(;s.pos()<t&&s.next();)switch(s.tag()){case x:{s.getUInt32();const e=s.getSInt64(),t=s.getSInt64();m.centroid[2*w]=e,m.centroid[2*w+1]=t;break}default:s.skip()}break}default:s.skip()}w++,m.hasFeatures=!0;break}default:s.skip()}const M=F||L;if(!M)throw new e(\"FeatureSet has no objectId or globalId field name\");return m.featureCount=w,m.fieldCount=b,m.objectIdFieldIndex=m.getFieldIndex(M),m.transform=A,m.displayIds=new Uint32Array(m.featureCount),m.groupIds=new Uint16Array(m.featureCount),s.move(h),m}export{n as FeatureSetHeader,o as parseHeader};\n"]},"metadata":{},"sourceType":"module"}