{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { Slice as e } from \"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";\nimport { Transform as i } from \"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";\nimport { VertexColor as o } from \"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl.js\";\nimport { OutputHighlight as r } from \"../views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl.js\";\nimport { LineStipple as t } from \"../views/3d/webgl-engine/core/shaderLibrary/shading/LineStipple.glsl.js\";\nimport { symbolAlphaCutoff as l } from \"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";\nimport { glsl as a } from \"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";\nimport { ShaderBuilder as s } from \"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";\n\nfunction n(n) {\n  const p = new s();\n  return p.include(i, {\n    linearDepth: !1\n  }), p.include(o, n), p.include(t, n), p.vertex.uniforms.add(\"proj\", \"mat4\").add(\"view\", \"mat4\"), p.attributes.add(\"position\", \"vec3\"), p.varyings.add(\"vpos\", \"vec3\"), p.vertex.code.add(a`void main(void) {\nvpos = position;\nforwardNormalizedVertexColor();\ngl_Position = transformPosition(proj, view, vpos);`), n.stippleEnabled && (p.attributes.add(\"auxpos1\", \"vec3\"), p.vertex.uniforms.add(\"ndcToPixel\", \"vec2\"), p.vertex.code.add(a`\n    vec4 vpos2 = transformPosition(proj, view, auxpos1);\n    float lineSegmentPixelSize = length((vpos2.xy / vpos2.w - gl_Position.xy / gl_Position.w) * ndcToPixel);\n\n    stipplePatternUv = lineSegmentPixelSize * stipplePatternPixelSizeInv;\n    ${n.stippleIntegerRepeatsEnabled ? \"stipplePatternUv = floor(stipplePatternUv + 0.5);\" : \"\"}\n\n    // Cancel out perspective correct interpolation because we want this length the really represent\n    // the screen distance\n    stipplePatternUv *= gl_Position.w;\n    `)), p.vertex.code.add(a`}`), 4 === n.output && p.include(r), p.include(e, n), p.fragment.uniforms.add(\"constantColor\", \"vec4\").add(\"alphaCoverage\", \"float\"), p.fragment.code.add(a`\n  void main() {\n    discardBySlice(vpos);\n\n    vec4 color = ${n.attributeColor ? \"vColor\" : \"constantColor\"};\n\n    float stippleAlpha = getStippleAlpha();\n    discardByStippleAlpha(stippleAlpha, stippleAlphaColorDiscard);\n\n    vec4 finalColor = blendStipple(vec4(color.rgb, color.a * alphaCoverage), stippleAlpha);\n\n    if (finalColor.a < ${a.float(l)}) {\n      discard;\n    }\n\n    ${0 === n.output ? a`gl_FragColor = highlightSlice(finalColor, vpos);` : \"\"}\n    ${4 === n.output ? a`outputHighlight();` : \"\"}\n  }\n  `), p;\n}\n\nvar p = Object.freeze({\n  __proto__: null,\n  build: n\n});\nexport { p as N, n as b };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/chunks/NativeLine.glsl.js"],"names":["Slice","e","Transform","i","VertexColor","o","OutputHighlight","r","LineStipple","t","symbolAlphaCutoff","l","glsl","a","ShaderBuilder","s","n","p","include","linearDepth","vertex","uniforms","add","attributes","varyings","code","stippleEnabled","stippleIntegerRepeatsEnabled","output","fragment","attributeColor","float","Object","freeze","__proto__","build","N","b"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{Slice as e}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as i}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{VertexColor as o}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl.js\";import{OutputHighlight as r}from\"../views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl.js\";import{LineStipple as t}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/LineStipple.glsl.js\";import{symbolAlphaCutoff as l}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{glsl as a}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as s}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function n(n){const p=new s;return p.include(i,{linearDepth:!1}),p.include(o,n),p.include(t,n),p.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),p.attributes.add(\"position\",\"vec3\"),p.varyings.add(\"vpos\",\"vec3\"),p.vertex.code.add(a`void main(void) {\nvpos = position;\nforwardNormalizedVertexColor();\ngl_Position = transformPosition(proj, view, vpos);`),n.stippleEnabled&&(p.attributes.add(\"auxpos1\",\"vec3\"),p.vertex.uniforms.add(\"ndcToPixel\",\"vec2\"),p.vertex.code.add(a`\n    vec4 vpos2 = transformPosition(proj, view, auxpos1);\n    float lineSegmentPixelSize = length((vpos2.xy / vpos2.w - gl_Position.xy / gl_Position.w) * ndcToPixel);\n\n    stipplePatternUv = lineSegmentPixelSize * stipplePatternPixelSizeInv;\n    ${n.stippleIntegerRepeatsEnabled?\"stipplePatternUv = floor(stipplePatternUv + 0.5);\":\"\"}\n\n    // Cancel out perspective correct interpolation because we want this length the really represent\n    // the screen distance\n    stipplePatternUv *= gl_Position.w;\n    `)),p.vertex.code.add(a`}`),4===n.output&&p.include(r),p.include(e,n),p.fragment.uniforms.add(\"constantColor\",\"vec4\").add(\"alphaCoverage\",\"float\"),p.fragment.code.add(a`\n  void main() {\n    discardBySlice(vpos);\n\n    vec4 color = ${n.attributeColor?\"vColor\":\"constantColor\"};\n\n    float stippleAlpha = getStippleAlpha();\n    discardByStippleAlpha(stippleAlpha, stippleAlphaColorDiscard);\n\n    vec4 finalColor = blendStipple(vec4(color.rgb, color.a * alphaCoverage), stippleAlpha);\n\n    if (finalColor.a < ${a.float(l)}) {\n      discard;\n    }\n\n    ${0===n.output?a`gl_FragColor = highlightSlice(finalColor, vpos);`:\"\"}\n    ${4===n.output?a`outputHighlight();`:\"\"}\n  }\n  `),p}var p=Object.freeze({__proto__:null,build:n});export{p as N,n as b};\n"]},"metadata":{},"sourceType":"module"}