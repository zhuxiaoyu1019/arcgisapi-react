{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { Seconds as t } from \"../../../core/time.js\";\n\nclass i {\n  constructor(t) {\n    t && this.update(t);\n  }\n\n  get time() {\n    return this._time;\n  }\n\n  update(t) {\n    t && (this.definition ? this.definition.copyFrom(t) : this.definition = t.clone()), this._updatePrecomputedVariables(), this._updatePixelFlow();\n  }\n\n  _updatePrecomputedVariables() {\n    const t = this.definition,\n          i = t.compared,\n          o = i.sourceZoom,\n          e = i.targetZoom;\n    this._zoomSign = o > e ? 1 : -1, this._panPixelsAtSource = i.pan * t.source.pixelsPerPanAtZoom(o);\n    const n = (t.source.pixelsPerRotateAtZoom(o) + t.target.pixelsPerRotateAtZoom(e)) / 2;\n    this._rotatePixels = i.rotate * n;\n  }\n\n  _updatePixelFlow() {\n    const i = this.definition.compared.sourceZoom,\n          o = this.definition.compared.targetZoom,\n          {\n      hasZoom: e,\n      hasPan: n,\n      hasRotate: s\n    } = this.definition;\n    let a = 0,\n        h = 0;\n    e && (n && (a = (o / i - 1) / (-1 / (this._zoomSign * this.definition.halfWindowSize) * Math.LN2 * this._panPixelsAtSource)), s && (h = this._zoomSign * (Math.log(i / o) / Math.LN2) * this.definition.halfWindowSize / this._rotatePixels)), this._zoomPixelFlow = 0, this._panPixelFlow = 0, this._rotatePixelFlow = 0;\n    const l = this.definition.desiredPixelFlow;\n\n    if (e && n && s) {\n      const t = a + h + a * h;\n      this._zoomPixelFlow = a * h / t * l, this._panPixelFlow = h / t * l, this._rotatePixelFlow = a / t * l;\n    } else if (e && n) {\n      const t = 1 + a;\n      this._zoomPixelFlow = a / t * l, this._panPixelFlow = 1 / t * l;\n    } else if (e && s) {\n      const t = 1 + h;\n      this._zoomPixelFlow = h / t * l, this._rotatePixelFlow = 1 / t * l;\n    } else if (n && s) {\n      const t = this._panPixelsAtSource / this._rotatePixels,\n            i = 1 + t;\n      this._panPixelFlow = t / i * l, this._rotatePixelFlow = 1 / i * l;\n    } else n ? this._panPixelFlow = l : e ? this._zoomPixelFlow = l : s && (this._rotatePixelFlow = l);\n\n    this._time = s ? this.rotateTime : e ? this.zoomTime : n ? this.panTime : t(0);\n  }\n\n  get rotateTime() {\n    return this.definition.hasRotate ? t(this._rotatePixels / this._rotatePixelFlow) : t(0);\n  }\n\n  get zoomTime() {\n    return this.definition.hasZoom ? t(this._zoomSign * (Math.log(this.definition.compared.sourceZoom / this.definition.compared.targetZoom) / Math.LN2) * this.definition.halfWindowSize / this._zoomPixelFlow) : t(0);\n  }\n\n  get panTime() {\n    if (this.definition.hasPan) {\n      if (this.definition.hasZoom) {\n        const i = -1 / (this._zoomSign * this.definition.halfWindowSize) * Math.LN2,\n              o = i * this._panPixelsAtSource;\n        return t(Math.log(o * (this._zoomPixelFlow / this._panPixelFlow) + 1) / (i * this._zoomPixelFlow));\n      }\n\n      return t(this._panPixelsAtSource / this._panPixelFlow);\n    }\n\n    return t(0);\n  }\n\n  _interpolateComponentsZoom(t) {\n    if (0 === t || 1 === t) return t;\n\n    if (this.definition.hasZoom) {\n      const i = this.definition.compared.sourceZoom,\n            o = this.definition.compared.targetZoom;\n      return (i * (i / o) ** -t - i) / (o - i);\n    }\n\n    return t;\n  }\n\n  _interpolateComponentsPan(t) {\n    if (0 === t || 1 === t) return t;\n\n    if (this.definition.hasPan && this.definition.hasZoom) {\n      const i = -1 / (this._zoomSign * this.definition.halfWindowSize) * this._zoomPixelFlow;\n      return 1 / this._panPixelsAtSource * (this._panPixelFlow * (2 ** (i * t * this._time) - 1)) / (i * Math.LN2);\n    }\n\n    return t;\n  }\n\n  _interpolateComponentsRotate(t) {\n    return t;\n  }\n\n  interpolateComponentsAt(t, i) {\n    t = Math.min(Math.max(t, 0), 1);\n\n    const o = this._interpolateComponentsZoom(t),\n          e = this._interpolateComponentsPan(t),\n          n = this._interpolateComponentsRotate(t);\n\n    return i ? (i.zoom = o, i.pan = e, i.rotate = n) : i = {\n      zoom: o,\n      pan: e,\n      rotate: n\n    }, i;\n  }\n\n}\n\nexport default i;\nexport { i as Segment };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/animation/pointToPoint/Segment.js"],"names":["Seconds","t","i","constructor","update","time","_time","definition","copyFrom","clone","_updatePrecomputedVariables","_updatePixelFlow","compared","o","sourceZoom","e","targetZoom","_zoomSign","_panPixelsAtSource","pan","source","pixelsPerPanAtZoom","n","pixelsPerRotateAtZoom","target","_rotatePixels","rotate","hasZoom","hasPan","hasRotate","s","a","h","halfWindowSize","Math","LN2","log","_zoomPixelFlow","_panPixelFlow","_rotatePixelFlow","l","desiredPixelFlow","rotateTime","zoomTime","panTime","_interpolateComponentsZoom","_interpolateComponentsPan","_interpolateComponentsRotate","interpolateComponentsAt","min","max","zoom","Segment"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{Seconds as t}from\"../../../core/time.js\";class i{constructor(t){t&&this.update(t)}get time(){return this._time}update(t){t&&(this.definition?this.definition.copyFrom(t):this.definition=t.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const t=this.definition,i=t.compared,o=i.sourceZoom,e=i.targetZoom;this._zoomSign=o>e?1:-1,this._panPixelsAtSource=i.pan*t.source.pixelsPerPanAtZoom(o);const n=(t.source.pixelsPerRotateAtZoom(o)+t.target.pixelsPerRotateAtZoom(e))/2;this._rotatePixels=i.rotate*n}_updatePixelFlow(){const i=this.definition.compared.sourceZoom,o=this.definition.compared.targetZoom,{hasZoom:e,hasPan:n,hasRotate:s}=this.definition;let a=0,h=0;e&&(n&&(a=(o/i-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),s&&(h=this._zoomSign*(Math.log(i/o)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(e&&n&&s){const t=a+h+a*h;this._zoomPixelFlow=a*h/t*l,this._panPixelFlow=h/t*l,this._rotatePixelFlow=a/t*l}else if(e&&n){const t=1+a;this._zoomPixelFlow=a/t*l,this._panPixelFlow=1/t*l}else if(e&&s){const t=1+h;this._zoomPixelFlow=h/t*l,this._rotatePixelFlow=1/t*l}else if(n&&s){const t=this._panPixelsAtSource/this._rotatePixels,i=1+t;this._panPixelFlow=t/i*l,this._rotatePixelFlow=1/i*l}else n?this._panPixelFlow=l:e?this._zoomPixelFlow=l:s&&(this._rotatePixelFlow=l);this._time=s?this.rotateTime:e?this.zoomTime:n?this.panTime:t(0)}get rotateTime(){return this.definition.hasRotate?t(this._rotatePixels/this._rotatePixelFlow):t(0)}get zoomTime(){return this.definition.hasZoom?t(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):t(0)}get panTime(){if(this.definition.hasPan){if(this.definition.hasZoom){const i=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,o=i*this._panPixelsAtSource;return t(Math.log(o*(this._zoomPixelFlow/this._panPixelFlow)+1)/(i*this._zoomPixelFlow))}return t(this._panPixelsAtSource/this._panPixelFlow)}return t(0)}_interpolateComponentsZoom(t){if(0===t||1===t)return t;if(this.definition.hasZoom){const i=this.definition.compared.sourceZoom,o=this.definition.compared.targetZoom;return(i*(i/o)**-t-i)/(o-i)}return t}_interpolateComponentsPan(t){if(0===t||1===t)return t;if(this.definition.hasPan&&this.definition.hasZoom){const i=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(i*t*this._time)-1))/(i*Math.LN2)}return t}_interpolateComponentsRotate(t){return t}interpolateComponentsAt(t,i){t=Math.min(Math.max(t,0),1);const o=this._interpolateComponentsZoom(t),e=this._interpolateComponentsPan(t),n=this._interpolateComponentsRotate(t);return i?(i.zoom=o,i.pan=e,i.rotate=n):i={zoom:o,pan:e,rotate:n},i}}export default i;export{i as Segment};\n"]},"metadata":{},"sourceType":"module"}