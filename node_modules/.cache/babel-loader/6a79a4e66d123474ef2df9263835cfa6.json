{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../core/Error.js\";\nimport { isSome as t } from \"../../core/maybe.js\";\nimport i from \"../../geometry/Extent.js\";\nimport n from \"../../geometry/Point.js\";\nimport { getReferenceEllipsoidFromWKID as r } from \"../../geometry/projectionEllipsoid.js\";\nimport l from \"../../geometry/SpatialReference.js\";\nimport o from \"../../geometry/support/WKIDUnitConversion.js\";\nimport s from \"./TileInfo.js\";\nconst a = 90.71428571428571,\n      c = [[3819, 3819], [3821, 3824], [3889, 3889], [3906, 3906], [4001, 4025], [4027, 4036], [4039, 4047], [4052, 4055], [4074, 4075], [4080, 4081], [4120, 4176], [4178, 4185], [4188, 4216], [4218, 4289], [4291, 4304], [4306, 4319], [4322, 4326], [4463, 4463], [4470, 4470], [4475, 4475], [4483, 4483], [4490, 4490], [4555, 4558], [4600, 4646], [4657, 4765], [4801, 4811], [4813, 4821], [4823, 4824], [4901, 4904], [5013, 5013], [5132, 5132], [5228, 5229], [5233, 5233], [5246, 5246], [5252, 5252], [5264, 5264], [5324, 5340], [5354, 5354], [5360, 5360], [5365, 5365], [5370, 5373], [5381, 5381], [5393, 5393], [5451, 5451], [5464, 5464], [5467, 5467], [5489, 5489], [5524, 5524], [5527, 5527], [5546, 5546], [2044, 2045], [2081, 2083], [2085, 2086], [2093, 2093], [2096, 2098], [2105, 2132], [2169, 2170], [2176, 2180], [2193, 2193], [2200, 2200], [2206, 2212], [2319, 2319], [2320, 2462], [2523, 2549], [2551, 2735], [2738, 2758], [2935, 2941], [2953, 2953], [3006, 3030], [3034, 3035], [3038, 3051], [3058, 3059], [3068, 3068], [3114, 3118], [3126, 3138], [3150, 3151], [3300, 3301], [3328, 3335], [3346, 3346], [3350, 3352], [3366, 3366], [3389, 3390], [3416, 3417], [3833, 3841], [3844, 3850], [3854, 3854], [3873, 3885], [3907, 3910], [4026, 4026], [4037, 4038], [4417, 4417], [4434, 4434], [4491, 4554], [4839, 4839], [5048, 5048], [5105, 5130], [5253, 5259], [5269, 5275], [5343, 5349], [5479, 5482], [5518, 5519], [5520, 5520], [20004, 20032], [20064, 20092], [21413, 21423], [21473, 21483], [21896, 21899], [22171, 22177], [22181, 22187], [22191, 22197], [25884, 25884], [27205, 27232], [27391, 27398], [27492, 27492], [28402, 28432], [28462, 28492], [30161, 30179], [30800, 30800], [31251, 31259], [31275, 31279], [31281, 31290], [31466, 31700]];\n\nfunction u(t, i) {\n  var n, r;\n  t = t.replace(/ows:/gi, \"\");\n  const l = new DOMParser().parseFromString(t, \"text/xml\").documentElement,\n        o = new Map(),\n        s = new Map(),\n        a = f(\"Contents\", l);\n  if (!a) throw new e(\"wmtslayer:wmts-capabilities-xml-is-not-valid\");\n  const c = f(\"OperationsMetadata\", l),\n        u = null == c ? void 0 : c.querySelector(\"[name='GetTile']\"),\n        p = null == u ? void 0 : u.getElementsByTagName(\"Get\"),\n        d = p && Array.prototype.slice.call(p),\n        g = null != (n = (null == i || null == (r = i.url) ? void 0 : r.indexOf(\"https\")) > -1) && n;\n  let T,\n      y,\n      M = i.serviceMode,\n      S = i && i.url;\n  if (d && d.length && d.some(e => {\n    const t = f(\"Constraint\", e);\n    return !t || x(\"AllowedValues\", \"Value\", M, t) ? (S = e.attributes[0].nodeValue, !0) : (!t || x(\"AllowedValues\", \"Value\", \"RESTful\", t) || x(\"AllowedValues\", \"Value\", \"REST\", t) ? y = e.attributes[0].nodeValue : t && !x(\"AllowedValues\", \"Value\", \"KVP\", t) || (T = e.attributes[0].nodeValue), !1);\n  }), !S) if (y) S = y, M = \"RESTful\";else if (T) S = T, M = \"KVP\";else {\n    const e = f(\"ServiceMetadataURL\", l);\n    S = e && e.getAttribute(\"xlink:href\");\n  }\n  const V = S.indexOf(\"1.0.0/\");\n  -1 === V && \"RESTful\" === M ? S += \"/\" : V > -1 && (S = S.substring(0, V)), \"KVP\" === M && (S += V > -1 ? \"\" : \"?\"), g && (S = S.replace(/^http:/i, \"https:\"));\n  const E = h(\"ServiceIdentification>ServiceTypeVersion\", l),\n        b = h(\"ServiceIdentification>AccessConstraints\", l),\n        C = m(\"Layer\", a),\n        N = m(\"TileMatrixSet\", a);\n  return {\n    copyright: b,\n    layers: C.map(e => {\n      const t = h(\"Identifier\", e);\n      return o.set(t, e), w(t, e, N, g, E);\n    }),\n    tileUrl: S,\n    serviceMode: M,\n    layerMap: o,\n    dimensionMap: s\n  };\n}\n\nfunction p(e) {\n  return e.layers.forEach(e => {\n    e.tileMatrixSets.forEach(e => {\n      const t = e.tileInfo;\n      96 !== t.dpi && (t.lods.forEach(i => {\n        i.scale = 96 * i.scale / t.dpi, i.resolution = A(t.spatialReference.wkid, i.scale * a / 96, e.id);\n      }), t.dpi = 96);\n    });\n  }), e;\n}\n\nfunction d(e) {\n  return e.nodeType === Node.ELEMENT_NODE;\n}\n\nfunction f(e, t) {\n  for (let i = 0; i < t.childNodes.length; i++) {\n    const n = t.childNodes[i];\n    if (d(n) && n.nodeName === e) return n;\n  }\n\n  return null;\n}\n\nfunction m(e, t) {\n  const i = [];\n\n  for (let n = 0; n < t.childNodes.length; n++) {\n    const r = t.childNodes[n];\n    d(r) && r.nodeName === e && i.push(r);\n  }\n\n  return i;\n}\n\nfunction g(e, t) {\n  const i = [];\n\n  for (let n = 0; n < t.childNodes.length; n++) {\n    const r = t.childNodes[n];\n    d(r) && r.nodeName === e && i.push(r);\n  }\n\n  return i.map(e => e.textContent);\n}\n\nfunction h(e, t) {\n  return e.split(\">\").forEach(e => {\n    t && (t = f(e, t));\n  }), t && t.textContent;\n}\n\nfunction x(e, t, i, n) {\n  let r;\n  return Array.prototype.slice.call(n.childNodes).some(n => {\n    if (n.nodeName.indexOf(e) > -1) {\n      const e = f(t, n),\n            l = e && e.textContent;\n      if (l === i || i.split(\":\") && i.split(\":\")[1] === l) return r = n, !0;\n    }\n\n    return !1;\n  }), r;\n}\n\nfunction w(e, t, i, n, r) {\n  const l = h(\"Abstract\", t),\n        o = g(\"Format\", t);\n  return {\n    id: e,\n    fullExtent: S(t),\n    description: l,\n    formats: o,\n    styles: V(t, n),\n    title: h(\"Title\", t),\n    tileMatrixSets: E(r, t, i)\n  };\n}\n\nfunction T(e, t) {\n  var i;\n  const n = [],\n        r = null == (i = e.layerMap) ? void 0 : i.get(t);\n  if (!r) return;\n  const l = m(\"ResourceURL\", r),\n        o = m(\"Dimension\", r);\n  let s, a, c, u;\n  return o.length && (s = h(\"Identifier\", o[0]), a = g(\"Default\", o[0]) || g(\"Value\", o[0])), o.length > 1 && (c = h(\"Identifier\", o[1]), u = g(\"Default\", o[1]) || g(\"Value\", o[1])), e.dimensionMap.set(t, {\n    dimensions: a,\n    dimensions2: u\n  }), l.forEach(e => {\n    let t = e.getAttribute(\"template\");\n\n    if (\"tile\" === e.getAttribute(\"resourceType\")) {\n      if (s && a.length) if (t.indexOf(\"{\" + s + \"}\") > -1) t = t.replace(\"{\" + s + \"}\", \"{dimensionValue}\");else {\n        const e = t.toLowerCase().indexOf(\"{\" + s.toLowerCase() + \"}\");\n        e > -1 && (t = t.substring(0, e) + \"{dimensionValue}\" + t.substring(e + s.length + 2));\n      }\n      if (c && u.length) if (t.indexOf(\"{\" + c + \"}\") > -1) t = t.replace(\"{\" + c + \"}\", \"{dimensionValue2}\");else {\n        const e = t.toLowerCase().indexOf(\"{\" + c.toLowerCase() + \"}\");\n        e > -1 && (t = t.substring(0, e) + \"{dimensionValue2}\" + t.substring(e + c.length + 2));\n      }\n      n.push({\n        template: t,\n        format: e.getAttribute(\"format\"),\n        resourceType: \"tile\"\n      });\n    }\n  }), n;\n}\n\nfunction y(e, t, i, n, r, l, o, s) {\n  const {\n    dimensionMap: a\n  } = e,\n        c = T(e, t),\n        u = a.get(t).dimensions && a.get(t).dimensions[0],\n        p = a.get(t).dimensions2 && a.get(t).dimensions2[0];\n  let d = \"\";\n\n  if (c && c.length > 0) {\n    let e = null;\n    c.some(t => t.format === n && (e = t, !0)), e || (e = c[o % c.length]), d = e.template.replace(/\\{Style\\}/gi, r).replace(/\\{TileMatrixSet\\}/gi, i).replace(/\\{TileMatrix\\}/gi, l).replace(/\\{TileRow\\}/gi, \"\" + o).replace(/\\{TileCol\\}/gi, \"\" + s).replace(/\\{dimensionValue\\}/gi, u).replace(/\\{dimensionValue2\\}/gi, p);\n  }\n\n  return d;\n}\n\nfunction M(e, t, i, n) {\n  const {\n    dimensionMap: r\n  } = e,\n        l = T(e, t);\n  let o = \"\";\n\n  if (l && l.length > 0) {\n    const e = r.get(t).dimensions && r.get(t).dimensions[0],\n          s = r.get(t).dimensions2 && r.get(t).dimensions2[0];\n    o = l[0].template, o.indexOf(\".xxx\") === o.length - 4 && (o = o.slice(0, o.length - 4)), o = o.replace(/\\{Style\\}/gi, n), o = o.replace(/\\{TileMatrixSet\\}/gi, i), o = o.replace(/\\{TileMatrix\\}/gi, \"{level}\"), o = o.replace(/\\{TileRow\\}/gi, \"{row}\"), o = o.replace(/\\{TileCol\\}/gi, \"{col}\"), o = o.replace(/\\{dimensionValue\\}/gi, e), o = o.replace(/\\{dimensionValue2\\}/gi, s);\n  }\n\n  return o;\n}\n\nfunction S(e) {\n  const t = f(\"WGS84BoundingBox\", e),\n        i = t ? h(\"LowerCorner\", t).split(\" \") : [\"-180\", \"-90\"],\n        n = t ? h(\"UpperCorner\", t).split(\" \") : [\"180\", \"90\"];\n  return {\n    xmin: parseFloat(i[0]),\n    ymin: parseFloat(i[1]),\n    xmax: parseFloat(n[0]),\n    ymax: parseFloat(n[1]),\n    spatialReference: {\n      wkid: 4326\n    }\n  };\n}\n\nfunction V(e, t) {\n  return m(\"Style\", e).map(e => {\n    const i = f(\"LegendURL\", e),\n          n = f(\"Keywords\", e),\n          r = n && g(\"Keyword\", n);\n    let l = i && i.getAttribute(\"xlink:href\");\n    t && (l = l && l.replace(/^http:/i, \"https:\"));\n    return {\n      abstract: h(\"Abstract\", e),\n      id: h(\"Identifier\", e),\n      isDefault: \"true\" === e.getAttribute(\"isDefault\"),\n      keywords: r,\n      legendUrl: l,\n      title: h(\"Title\", e)\n    };\n  });\n}\n\nfunction E(e, t, i) {\n  return m(\"TileMatrixSetLink\", t).map(e => f(\"TileMatrixSet\", e).textContent).map(n => b(e, n, t, i));\n}\n\nfunction b(e, t, i, n) {\n  const r = g(\"TileMatrix\", x(\"TileMatrixSetLink\", \"TileMatrixSet\", t, i)),\n        l = n.find(e => {\n    const i = f(\"Identifier\", e),\n          n = i && i.textContent;\n    return !!(n === t || t.split(\":\") && t.split(\":\")[1] === n);\n  }),\n        o = C(l),\n        a = o.spatialReference,\n        c = a.wkid,\n        u = f(\"TileMatrix\", l),\n        p = [parseInt(h(\"TileWidth\", u), 10), parseInt(h(\"TileHeight\", u), 10)],\n        d = [];\n  if (r.length) r.forEach((e, i) => {\n    const n = x(\"TileMatrix\", \"Identifier\", e, l);\n    d.push(L(n, c, i, t));\n  });else {\n    m(\"TileMatrix\", l).forEach((e, i) => {\n      d.push(L(e, c, i, t));\n    });\n  }\n  const w = N(e, l, o, p, d[0]);\n  return {\n    id: t,\n    fullExtent: w.toJSON(),\n    tileInfo: new s({\n      dpi: 96,\n      spatialReference: a,\n      size: p,\n      origin: o,\n      lods: d\n    }).toJSON()\n  };\n}\n\nfunction C(e) {\n  let i = h(\"SupportedCRS\", e);\n  i && (i = i.toLowerCase());\n  let r = parseInt(i.split(\":\").pop(), 10);\n  900913 !== r && 3857 !== r || (r = 102100);\n  const o = I(i);\n  t(o) && (r = o);\n  const s = new l({\n    wkid: r\n  }),\n        a = h(\"TopLeftCorner\", f(\"TileMatrix\", e)).split(\" \"),\n        c = a[0].split(\"E\").map(e => Number(e)),\n        u = a[1].split(\"E\").map(e => Number(e)),\n        p = c.length > 1 ? c[0] * 10 ** c[1] : c[0],\n        d = u.length > 1 ? u[0] * 10 ** u[1] : u[0];\n  return i.includes(\"epsg\") && v(r) ? new n(d, p, s) : new n(p, d, s);\n}\n\nfunction N(e, t, n, r, l) {\n  const o = f(\"BoundingBox\", t);\n  let s, a, c, u, p, d;\n  if (o && (s = h(\"LowerCorner\", o).split(\" \"), a = h(\"UpperCorner\", o).split(\" \")), s && s.length > 1 && a && a.length > 1) c = parseFloat(s[0]), p = parseFloat(s[1]), u = parseFloat(a[0]), d = parseFloat(a[1]);else {\n    const e = f(\"TileMatrix\", t),\n          i = parseFloat(h(\"MatrixWidth\", e)),\n          o = parseFloat(h(\"MatrixHeight\", e));\n    c = n.x, d = n.y, u = c + i * r[0] * l.resolution, p = d - o * r[1] * l.resolution;\n  }\n  return R(e, n.spatialReference) ? new i(p, c, d, u, n.spatialReference) : new i(c, p, u, d, n.spatialReference);\n}\n\nfunction R(e, t) {\n  return \"1.0.0\" === e && v(t.wkid);\n}\n\nfunction v(e) {\n  return c.some(([t, i]) => e >= t && e <= i);\n}\n\nfunction I(e) {\n  return e.includes(\"crs84\") || e.includes(\"crs:84\") ? 4326 : e.includes(\"crs83\") || e.includes(\"crs:83\") ? 4269 : e.includes(\"crs27\") || e.includes(\"crs:27\") ? 4267 : null;\n}\n\nfunction L(e, t, i, n) {\n  const r = h(\"Identifier\", e),\n        l = h(\"ScaleDenominator\", e).split(\"E\").map(e => Number(e));\n  let o;\n  o = l.length > 1 ? l[0] * 10 ** l[1] : l[0];\n  const s = A(t, o, n);\n  return o *= 96 / a, {\n    level: i,\n    levelValue: r,\n    scale: o,\n    resolution: s\n  };\n}\n\nfunction A(e, t, i) {\n  let n;\n  return n = o.hasOwnProperty(String(e)) ? o.values[o[e]] : \"default028mm\" === i ? 6370997 * Math.PI / 180 : r(e).metersPerDegree, 7 * t / 25e3 / n;\n}\n\nexport { y as getTileUrlFromResourceUrls, M as getTileUrlTemplateFromResourceUrls, u as parseCapabilities, p as parseResourceInfo };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/layers/support/wmtsUtils.js"],"names":["e","isSome","t","i","n","getReferenceEllipsoidFromWKID","r","l","o","s","a","c","u","replace","DOMParser","parseFromString","documentElement","Map","f","querySelector","p","getElementsByTagName","d","Array","prototype","slice","call","g","url","indexOf","T","y","M","serviceMode","S","length","some","x","attributes","nodeValue","getAttribute","V","substring","E","h","b","C","m","N","copyright","layers","map","set","w","tileUrl","layerMap","dimensionMap","forEach","tileMatrixSets","tileInfo","dpi","lods","scale","resolution","A","spatialReference","wkid","id","nodeType","Node","ELEMENT_NODE","childNodes","nodeName","push","textContent","split","fullExtent","description","formats","styles","title","get","dimensions","dimensions2","toLowerCase","template","format","resourceType","xmin","parseFloat","ymin","xmax","ymax","abstract","isDefault","keywords","legendUrl","find","parseInt","L","toJSON","size","origin","pop","I","Number","includes","v","R","level","levelValue","hasOwnProperty","String","values","Math","PI","metersPerDegree","getTileUrlFromResourceUrls","getTileUrlTemplateFromResourceUrls","parseCapabilities","parseResourceInfo"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{isSome as t}from\"../../core/maybe.js\";import i from\"../../geometry/Extent.js\";import n from\"../../geometry/Point.js\";import{getReferenceEllipsoidFromWKID as r}from\"../../geometry/projectionEllipsoid.js\";import l from\"../../geometry/SpatialReference.js\";import o from\"../../geometry/support/WKIDUnitConversion.js\";import s from\"./TileInfo.js\";const a=90.71428571428571,c=[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]];function u(t,i){var n,r;t=t.replace(/ows:/gi,\"\");const l=(new DOMParser).parseFromString(t,\"text/xml\").documentElement,o=new Map,s=new Map,a=f(\"Contents\",l);if(!a)throw new e(\"wmtslayer:wmts-capabilities-xml-is-not-valid\");const c=f(\"OperationsMetadata\",l),u=null==c?void 0:c.querySelector(\"[name='GetTile']\"),p=null==u?void 0:u.getElementsByTagName(\"Get\"),d=p&&Array.prototype.slice.call(p),g=null!=(n=(null==i||null==(r=i.url)?void 0:r.indexOf(\"https\"))>-1)&&n;let T,y,M=i.serviceMode,S=i&&i.url;if(d&&d.length&&d.some((e=>{const t=f(\"Constraint\",e);return!t||x(\"AllowedValues\",\"Value\",M,t)?(S=e.attributes[0].nodeValue,!0):(!t||x(\"AllowedValues\",\"Value\",\"RESTful\",t)||x(\"AllowedValues\",\"Value\",\"REST\",t)?y=e.attributes[0].nodeValue:t&&!x(\"AllowedValues\",\"Value\",\"KVP\",t)||(T=e.attributes[0].nodeValue),!1)})),!S)if(y)S=y,M=\"RESTful\";else if(T)S=T,M=\"KVP\";else{const e=f(\"ServiceMetadataURL\",l);S=e&&e.getAttribute(\"xlink:href\")}const V=S.indexOf(\"1.0.0/\");-1===V&&\"RESTful\"===M?S+=\"/\":V>-1&&(S=S.substring(0,V)),\"KVP\"===M&&(S+=V>-1?\"\":\"?\"),g&&(S=S.replace(/^http:/i,\"https:\"));const E=h(\"ServiceIdentification>ServiceTypeVersion\",l),b=h(\"ServiceIdentification>AccessConstraints\",l),C=m(\"Layer\",a),N=m(\"TileMatrixSet\",a);return{copyright:b,layers:C.map((e=>{const t=h(\"Identifier\",e);return o.set(t,e),w(t,e,N,g,E)})),tileUrl:S,serviceMode:M,layerMap:o,dimensionMap:s}}function p(e){return e.layers.forEach((e=>{e.tileMatrixSets.forEach((e=>{const t=e.tileInfo;96!==t.dpi&&(t.lods.forEach((i=>{i.scale=96*i.scale/t.dpi,i.resolution=A(t.spatialReference.wkid,i.scale*a/96,e.id)})),t.dpi=96)}))})),e}function d(e){return e.nodeType===Node.ELEMENT_NODE}function f(e,t){for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(d(n)&&n.nodeName===e)return n}return null}function m(e,t){const i=[];for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];d(r)&&r.nodeName===e&&i.push(r)}return i}function g(e,t){const i=[];for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];d(r)&&r.nodeName===e&&i.push(r)}return i.map((e=>e.textContent))}function h(e,t){return e.split(\">\").forEach((e=>{t&&(t=f(e,t))})),t&&t.textContent}function x(e,t,i,n){let r;return Array.prototype.slice.call(n.childNodes).some((n=>{if(n.nodeName.indexOf(e)>-1){const e=f(t,n),l=e&&e.textContent;if(l===i||i.split(\":\")&&i.split(\":\")[1]===l)return r=n,!0}return!1})),r}function w(e,t,i,n,r){const l=h(\"Abstract\",t),o=g(\"Format\",t);return{id:e,fullExtent:S(t),description:l,formats:o,styles:V(t,n),title:h(\"Title\",t),tileMatrixSets:E(r,t,i)}}function T(e,t){var i;const n=[],r=null==(i=e.layerMap)?void 0:i.get(t);if(!r)return;const l=m(\"ResourceURL\",r),o=m(\"Dimension\",r);let s,a,c,u;return o.length&&(s=h(\"Identifier\",o[0]),a=g(\"Default\",o[0])||g(\"Value\",o[0])),o.length>1&&(c=h(\"Identifier\",o[1]),u=g(\"Default\",o[1])||g(\"Value\",o[1])),e.dimensionMap.set(t,{dimensions:a,dimensions2:u}),l.forEach((e=>{let t=e.getAttribute(\"template\");if(\"tile\"===e.getAttribute(\"resourceType\")){if(s&&a.length)if(t.indexOf(\"{\"+s+\"}\")>-1)t=t.replace(\"{\"+s+\"}\",\"{dimensionValue}\");else{const e=t.toLowerCase().indexOf(\"{\"+s.toLowerCase()+\"}\");e>-1&&(t=t.substring(0,e)+\"{dimensionValue}\"+t.substring(e+s.length+2))}if(c&&u.length)if(t.indexOf(\"{\"+c+\"}\")>-1)t=t.replace(\"{\"+c+\"}\",\"{dimensionValue2}\");else{const e=t.toLowerCase().indexOf(\"{\"+c.toLowerCase()+\"}\");e>-1&&(t=t.substring(0,e)+\"{dimensionValue2}\"+t.substring(e+c.length+2))}n.push({template:t,format:e.getAttribute(\"format\"),resourceType:\"tile\"})}})),n}function y(e,t,i,n,r,l,o,s){const{dimensionMap:a}=e,c=T(e,t),u=a.get(t).dimensions&&a.get(t).dimensions[0],p=a.get(t).dimensions2&&a.get(t).dimensions2[0];let d=\"\";if(c&&c.length>0){let e=null;c.some((t=>t.format===n&&(e=t,!0))),e||(e=c[o%c.length]),d=e.template.replace(/\\{Style\\}/gi,r).replace(/\\{TileMatrixSet\\}/gi,i).replace(/\\{TileMatrix\\}/gi,l).replace(/\\{TileRow\\}/gi,\"\"+o).replace(/\\{TileCol\\}/gi,\"\"+s).replace(/\\{dimensionValue\\}/gi,u).replace(/\\{dimensionValue2\\}/gi,p)}return d}function M(e,t,i,n){const{dimensionMap:r}=e,l=T(e,t);let o=\"\";if(l&&l.length>0){const e=r.get(t).dimensions&&r.get(t).dimensions[0],s=r.get(t).dimensions2&&r.get(t).dimensions2[0];o=l[0].template,o.indexOf(\".xxx\")===o.length-4&&(o=o.slice(0,o.length-4)),o=o.replace(/\\{Style\\}/gi,n),o=o.replace(/\\{TileMatrixSet\\}/gi,i),o=o.replace(/\\{TileMatrix\\}/gi,\"{level}\"),o=o.replace(/\\{TileRow\\}/gi,\"{row}\"),o=o.replace(/\\{TileCol\\}/gi,\"{col}\"),o=o.replace(/\\{dimensionValue\\}/gi,e),o=o.replace(/\\{dimensionValue2\\}/gi,s)}return o}function S(e){const t=f(\"WGS84BoundingBox\",e),i=t?h(\"LowerCorner\",t).split(\" \"):[\"-180\",\"-90\"],n=t?h(\"UpperCorner\",t).split(\" \"):[\"180\",\"90\"];return{xmin:parseFloat(i[0]),ymin:parseFloat(i[1]),xmax:parseFloat(n[0]),ymax:parseFloat(n[1]),spatialReference:{wkid:4326}}}function V(e,t){return m(\"Style\",e).map((e=>{const i=f(\"LegendURL\",e),n=f(\"Keywords\",e),r=n&&g(\"Keyword\",n);let l=i&&i.getAttribute(\"xlink:href\");t&&(l=l&&l.replace(/^http:/i,\"https:\"));return{abstract:h(\"Abstract\",e),id:h(\"Identifier\",e),isDefault:\"true\"===e.getAttribute(\"isDefault\"),keywords:r,legendUrl:l,title:h(\"Title\",e)}}))}function E(e,t,i){return m(\"TileMatrixSetLink\",t).map((e=>f(\"TileMatrixSet\",e).textContent)).map((n=>b(e,n,t,i)))}function b(e,t,i,n){const r=g(\"TileMatrix\",x(\"TileMatrixSetLink\",\"TileMatrixSet\",t,i)),l=n.find((e=>{const i=f(\"Identifier\",e),n=i&&i.textContent;return!!(n===t||t.split(\":\")&&t.split(\":\")[1]===n)})),o=C(l),a=o.spatialReference,c=a.wkid,u=f(\"TileMatrix\",l),p=[parseInt(h(\"TileWidth\",u),10),parseInt(h(\"TileHeight\",u),10)],d=[];if(r.length)r.forEach(((e,i)=>{const n=x(\"TileMatrix\",\"Identifier\",e,l);d.push(L(n,c,i,t))}));else{m(\"TileMatrix\",l).forEach(((e,i)=>{d.push(L(e,c,i,t))}))}const w=N(e,l,o,p,d[0]);return{id:t,fullExtent:w.toJSON(),tileInfo:new s({dpi:96,spatialReference:a,size:p,origin:o,lods:d}).toJSON()}}function C(e){let i=h(\"SupportedCRS\",e);i&&(i=i.toLowerCase());let r=parseInt(i.split(\":\").pop(),10);900913!==r&&3857!==r||(r=102100);const o=I(i);t(o)&&(r=o);const s=new l({wkid:r}),a=h(\"TopLeftCorner\",f(\"TileMatrix\",e)).split(\" \"),c=a[0].split(\"E\").map((e=>Number(e))),u=a[1].split(\"E\").map((e=>Number(e))),p=c.length>1?c[0]*10**c[1]:c[0],d=u.length>1?u[0]*10**u[1]:u[0];return i.includes(\"epsg\")&&v(r)?new n(d,p,s):new n(p,d,s)}function N(e,t,n,r,l){const o=f(\"BoundingBox\",t);let s,a,c,u,p,d;if(o&&(s=h(\"LowerCorner\",o).split(\" \"),a=h(\"UpperCorner\",o).split(\" \")),s&&s.length>1&&a&&a.length>1)c=parseFloat(s[0]),p=parseFloat(s[1]),u=parseFloat(a[0]),d=parseFloat(a[1]);else{const e=f(\"TileMatrix\",t),i=parseFloat(h(\"MatrixWidth\",e)),o=parseFloat(h(\"MatrixHeight\",e));c=n.x,d=n.y,u=c+i*r[0]*l.resolution,p=d-o*r[1]*l.resolution}return R(e,n.spatialReference)?new i(p,c,d,u,n.spatialReference):new i(c,p,u,d,n.spatialReference)}function R(e,t){return\"1.0.0\"===e&&v(t.wkid)}function v(e){return c.some((([t,i])=>e>=t&&e<=i))}function I(e){return e.includes(\"crs84\")||e.includes(\"crs:84\")?4326:e.includes(\"crs83\")||e.includes(\"crs:83\")?4269:e.includes(\"crs27\")||e.includes(\"crs:27\")?4267:null}function L(e,t,i,n){const r=h(\"Identifier\",e),l=h(\"ScaleDenominator\",e).split(\"E\").map((e=>Number(e)));let o;o=l.length>1?l[0]*10**l[1]:l[0];const s=A(t,o,n);return o*=96/a,{level:i,levelValue:r,scale:o,resolution:s}}function A(e,t,i){let n;return n=o.hasOwnProperty(String(e))?o.values[o[e]]:\"default028mm\"===i?6370997*Math.PI/180:r(e).metersPerDegree,7*t/25e3/n}export{y as getTileUrlFromResourceUrls,M as getTileUrlTemplateFromResourceUrls,u as parseCapabilities,p as parseResourceInfo};\n"]},"metadata":{},"sourceType":"module"}