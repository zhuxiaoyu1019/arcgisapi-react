{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../core/Handles.js\";\nimport { property as r } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../core/Logger.js\";\nimport { subclass as o } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport \"../../../../core/mathUtils.js\";\nimport \"../../../../geometry/support/ray.js\";\nimport \"../../../../chunks/sphere.js\";\nimport \"../../../../geometry/support/vectorStacks.js\";\nimport { applySurfaceCollisionConstraint as s } from \"../../camera/constraintUtils/surfaceCollision.js\";\nimport \"../../../../geometry/projectionEllipsoid.js\";\nimport { eyeWithinExtent as i } from \"../../camera/intersectionUtils.js\";\nimport { CameraController as a, State as n } from \"./CameraController.js\";\nlet p = class extends a {\n  constructor(e) {\n    super(e), this.handles = new t();\n  }\n\n  set desiredCamera(e) {\n    this._set(\"desiredCamera\", e.clone());\n  }\n\n  get canStop() {\n    return !0;\n  }\n\n  get constraintEnabled() {\n    return this.view.state.constraints.collision.enabled;\n  }\n\n  onControllerStart() {\n    this.state = n.Running, this.handles.add(this.view.basemapTerrain.on(\"elevation-change\", e => this.handleElevationChangeEvent(e))), this.applyCorrection();\n  }\n\n  onControllerEnd() {\n    this.handles.removeAll();\n  }\n\n  stepController() {}\n\n  handleElevationChangeEvent(e) {\n    i(this.view, this.desiredCamera, e.extent, e.spatialReference) && this.applyCorrection();\n  }\n\n  applyCorrection() {\n    this.view.state.updateCamera(e => {\n      e.copyViewFrom(this.desiredCamera), s(this.view, e, 1) || this.constraintEnabled || (this.state = n.Stopped);\n    });\n  }\n\n};\ne([r({\n  constructOnly: !0\n})], p.prototype, \"view\", void 0), e([r({\n  constructOnly: !0\n})], p.prototype, \"desiredCamera\", null), p = e([o(\"esri.views.3d.state.controllers.SurfaceCollisionCorrectionController\")], p);\nexport { p as SurfaceCollisionCorrectionController };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/state/controllers/SurfaceCollisionCorrectionController.js"],"names":["_","e","t","property","r","subclass","o","applySurfaceCollisionConstraint","s","eyeWithinExtent","i","CameraController","a","State","n","p","constructor","handles","desiredCamera","_set","clone","canStop","constraintEnabled","view","state","constraints","collision","enabled","onControllerStart","Running","add","basemapTerrain","on","handleElevationChangeEvent","applyCorrection","onControllerEnd","removeAll","stepController","extent","spatialReference","updateCamera","copyViewFrom","Stopped","constructOnly","prototype","SurfaceCollisionCorrectionController"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Handles.js\";import{property as r}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";import\"../../../../core/mathUtils.js\";import\"../../../../geometry/support/ray.js\";import\"../../../../chunks/sphere.js\";import\"../../../../geometry/support/vectorStacks.js\";import{applySurfaceCollisionConstraint as s}from\"../../camera/constraintUtils/surfaceCollision.js\";import\"../../../../geometry/projectionEllipsoid.js\";import{eyeWithinExtent as i}from\"../../camera/intersectionUtils.js\";import{CameraController as a,State as n}from\"./CameraController.js\";let p=class extends a{constructor(e){super(e),this.handles=new t}set desiredCamera(e){this._set(\"desiredCamera\",e.clone())}get canStop(){return!0}get constraintEnabled(){return this.view.state.constraints.collision.enabled}onControllerStart(){this.state=n.Running,this.handles.add(this.view.basemapTerrain.on(\"elevation-change\",(e=>this.handleElevationChangeEvent(e)))),this.applyCorrection()}onControllerEnd(){this.handles.removeAll()}stepController(){}handleElevationChangeEvent(e){i(this.view,this.desiredCamera,e.extent,e.spatialReference)&&this.applyCorrection()}applyCorrection(){this.view.state.updateCamera((e=>{e.copyViewFrom(this.desiredCamera),s(this.view,e,1)||this.constraintEnabled||(this.state=n.Stopped)}))}};e([r({constructOnly:!0})],p.prototype,\"view\",void 0),e([r({constructOnly:!0})],p.prototype,\"desiredCamera\",null),p=e([o(\"esri.views.3d.state.controllers.SurfaceCollisionCorrectionController\")],p);export{p as SurfaceCollisionCorrectionController};\n"]},"metadata":{},"sourceType":"module"}