{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../has.js\";\nimport { isAggregate as t, aggregateFunction as a } from \"./AggregateFunctions.js\";\nimport { SqlInterval as r, isStandardized as s, evaluateFunction as n } from \"./StandardizedFunctions.js\";\nimport { WhereGrammar as i } from \"./WhereGrammar.js\";\nconst l = /^(\\d{4})-(\\d{1,2})-(\\d{1,2})$/,\n      u = /^(\\d{4})-(\\d{1,2})-(\\d{1,2}) (\\d{1,2}):(\\d{1,2}):(\\d{1,2}(\\.[0-9]+)?)$/,\n      o = /^(\\d{4})-(\\d{1,2})-(\\d{1,2}) (\\d{1,2}):(\\d{1,2}):(\\d{1,2}(\\.[0-9]+)?)(\\+|\\-)(\\d{1,2}):(\\d{1,2})$/,\n      c = /^(\\d{4})-(\\d{1,2})-(\\d{1,2}) (\\d{1,2}):(\\d{1,2})(\\+|\\-)(\\d{1,2}):(\\d{1,2})$/,\n      h = /^(\\d{4})-(\\d{1,2})-(\\d{1,2}) (\\d{1,2}):(\\d{1,2})$/;\n\nfunction p(e, t) {\n  return (e += \"\").length >= t ? e : new Array(t - e.length + 1).join(\"0\") + e;\n}\n\nfunction d(e, t, a = \"0\", r = \"0\", s = \"0\", n = \"0\", i = \"\", l = \"0\", u = \"0\") {\n  if (\"+\" === i || \"-\" === i) {\n    const o = `${p(parseInt(e, 10), 4)}-${p(parseInt(t, 10), 2)}-${p(parseInt(a, 10), 2)}`;\n    let c = \"\";\n    parseFloat(n) < 10 && (c = \"0\");\n    const h = `${p(parseInt(r, 10), 2)}:${p(parseInt(s, 10), 2)}:${c + parseFloat(n).toString()}`,\n          d = `${i}${p(parseInt(l, 10), 2)}:${p(parseInt(u, 10), 2)}`;\n    return new Date(o + \"T\" + h + d);\n  }\n\n  return new Date(parseInt(e, 10), parseInt(t, 10) - 1, parseInt(a, 10), parseInt(r, 10), parseInt(s, 10), parseFloat(n));\n}\n\nclass v {\n  static makeBool(e) {\n    return g(e);\n  }\n\n  static featureValue(e, t, a, r) {\n    return _(e, t, a, r);\n  }\n\n  static equalsNull(e) {\n    return null === e;\n  }\n\n  static applyLike(e, t, a) {\n    return J(e, t, a);\n  }\n\n  static ensureArray(e) {\n    return T(e);\n  }\n\n  static applyIn(e, t) {\n    return y(e, t);\n  }\n\n  static currentDate() {\n    const e = new Date();\n    return e.setHours(0, 0, 0, 0), e;\n  }\n\n  static makeSqlInterval(e, t, a) {\n    return r.createFromValueAndQualifer(e, t, a);\n  }\n\n  static convertInterval(e) {\n    return e instanceof r ? e.valueInMilliseconds() : e;\n  }\n\n  static currentTimestamp() {\n    return new Date();\n  }\n\n  static compare(e, t, a) {\n    return b(e, t, a);\n  }\n\n  static calculate(e, t, a) {\n    return D(e, t, a);\n  }\n\n  static makeComparable(e) {\n    return A(e);\n  }\n\n  static evaluateFunction(e, t) {\n    return n(e, t);\n  }\n\n  static lookup(e, t) {\n    const a = t[e];\n    return void 0 === a ? null : a;\n  }\n\n  static between(e, t) {\n    return null == e || null == t[0] || null == t[1] ? null : e >= t[0] && e <= t[1];\n  }\n\n  static notbetween(e, t) {\n    return null == e || null == t[0] || null == t[1] ? null : e < t[0] || e > t[1];\n  }\n\n  static ternaryNot(e) {\n    return S(e);\n  }\n\n  static ternaryAnd(e, t) {\n    return w(e, t);\n  }\n\n  static ternaryOr(e, t) {\n    return I(e, t);\n  }\n\n}\n\nclass f {\n  constructor(e, t) {\n    this.fieldsIndex = t, this.datefields = {}, this.parameters = {}, this.parseTree = i.parse(e);\n    const {\n      isStandardized: a,\n      isAggregate: r,\n      referencedFieldNames: s\n    } = this.extractExpressionInfo(t);\n    this.referencedFieldNames = s, this.isStandardized = a, this.isAggregate = r;\n  }\n\n  static create(e, t) {\n    return new f(e, t);\n  }\n\n  get fieldNames() {\n    return this.referencedFieldNames;\n  }\n\n  testSet(e, t = M) {\n    const a = {};\n\n    for (const r of this.fieldNames) a[r] = e.map(e => t.getAttribute(e, r));\n\n    return !!this.evaluateNode(this.parseTree, {\n      attributes: a\n    }, M);\n  }\n\n  calculateValue(e, t = M) {\n    const a = this.evaluateNode(this.parseTree, e, t);\n    return a instanceof r ? a.valueInMilliseconds() / 864e5 : a;\n  }\n\n  calculateValueCompiled(t, a = M) {\n    return null != this.parseTree._compiledVersion ? this.parseTree._compiledVersion(t, this.parameters, a, this.datefields) : e(\"csp-restrictions\") ? this.calculateValue(t, a) : (this.compileMe(), this.parseTree._compiledVersion(t, this.parameters, a, this.datefields));\n  }\n\n  testFeature(e, t = M) {\n    return !!this.evaluateNode(this.parseTree, e, t);\n  }\n\n  testFeatureCompiled(t, a = M) {\n    return null != this.parseTree._compiledVersion ? !!this.parseTree._compiledVersion(t, this.parameters, a, this.datefields) : e(\"csp-restrictions\") ? this.testFeature(t, a) : (this.compileMe(), !!this.parseTree._compiledVersion(t, this.parameters, a, this.datefields));\n  }\n\n  getFunctions() {\n    const e = [];\n    return this.visitAll(this.parseTree, t => {\n      \"function\" === t.type && e.push(t.name.toLowerCase());\n    }), x(e);\n  }\n\n  getExpressions() {\n    const e = new Map();\n    return this.visitAll(this.parseTree, t => {\n      if (\"function\" === t.type) {\n        const a = t.name.toLowerCase(),\n              r = t.args.value[0];\n\n        if (\"column_ref\" === r.type) {\n          const t = r.column,\n                s = `${a}-${t}`;\n          e.has(s) || e.set(s, {\n            aggregateType: a,\n            field: t\n          });\n        }\n      }\n    }), [...e.values()];\n  }\n\n  getVariables() {\n    const e = [];\n    return this.visitAll(this.parseTree, t => {\n      \"param\" === t.type && e.push(t.value.toLowerCase());\n    }), x(e);\n  }\n\n  compileMe() {\n    const e = \"return this.convertInterval(\" + this.evaluateNodeToJavaScript(this.parseTree) + \")\";\n    this.parseTree._compiledVersion = new Function(\"feature\", \"lookups\", \"attributeAdapter\", \"datefields\", e).bind(v);\n  }\n\n  extractExpressionInfo(e) {\n    const a = [];\n    let r = !0,\n        n = !0;\n    return this.visitAll(this.parseTree, i => {\n      switch (i.type) {\n        case \"column_ref\":\n          {\n            const t = e.get(i.column),\n                  r = t && t.name;\n            !t || \"date\" !== t.type && \"esriFieldTypeDate\" !== t.type || (this.datefields[t.name] = 1), void 0 !== r ? (a.push(r), i.column = r) : a.push(i.column);\n            break;\n          }\n\n        case \"function\":\n          {\n            const {\n              name: e,\n              args: a\n            } = i,\n                  l = a.value.length;\n            r && (r = s(e, l)), n && (n = t(e, l));\n            break;\n          }\n      }\n    }), {\n      referencedFieldNames: x(a),\n      isStandardized: r,\n      isAggregate: n\n    };\n  }\n\n  visitAll(e, t) {\n    if (null != e) switch (t(e), e.type) {\n      case \"when_clause\":\n        this.visitAll(e.operand, t), this.visitAll(e.value, t);\n        break;\n\n      case \"case_expression\":\n        for (const a of e.clauses) this.visitAll(a, t);\n\n        \"simple\" === e.format && this.visitAll(e.operand, t), null !== e.else && this.visitAll(e.else, t);\n        break;\n\n      case \"expr_list\":\n        for (const a of e.value) this.visitAll(a, t);\n\n        break;\n\n      case \"unary_expr\":\n        this.visitAll(e.expr, t);\n        break;\n\n      case \"binary_expr\":\n        this.visitAll(e.left, t), this.visitAll(e.right, t);\n        break;\n\n      case \"function\":\n        this.visitAll(e.args, t);\n    }\n  }\n\n  evaluateNodeToJavaScript(e) {\n    switch (e.type) {\n      case \"interval\":\n        return \"this.makeSqlInterval(\" + this.evaluateNodeToJavaScript(e.value) + \", \" + JSON.stringify(e.qualifier) + \",\" + JSON.stringify(e.op) + \")\";\n\n      case \"case_expression\":\n        {\n          let t = \"\";\n\n          if (\"simple\" === e.format) {\n            const a = \"this.makeComparable(\" + this.evaluateNodeToJavaScript(e.operand) + \")\";\n            t = \"( \";\n\n            for (let r = 0; r < e.clauses.length; r++) t += \" (\" + a + \" === this.makeComparable(\" + this.evaluateNodeToJavaScript(e.clauses[r].operand) + \")) ? (\" + this.evaluateNodeToJavaScript(e.clauses[r].value) + \") : \";\n\n            null !== e.else ? t += this.evaluateNodeToJavaScript(e.else) : t += \"null\", t += \" )\";\n          } else {\n            t = \"( \";\n\n            for (let a = 0; a < e.clauses.length; a++) t += \" this.makeBool(\" + this.evaluateNodeToJavaScript(e.clauses[a].operand) + \")===true ? (\" + this.evaluateNodeToJavaScript(e.clauses[a].value) + \") : \";\n\n            null !== e.else ? t += this.evaluateNodeToJavaScript(e.else) : t += \"null\", t += \" )\";\n          }\n\n          return t;\n        }\n\n      case \"param\":\n        return \"this.lookup(\" + JSON.stringify(e.value.toLowerCase()) + \",lookups)\";\n\n      case \"expr_list\":\n        {\n          let t = \"[\";\n\n          for (const a of e.value) \"[\" !== t && (t += \",\"), t += this.evaluateNodeToJavaScript(a);\n\n          return t += \"]\", t;\n        }\n\n      case \"unary_expr\":\n        return \"this.ternaryNot(\" + this.evaluateNodeToJavaScript(e.expr) + \")\";\n\n      case \"binary_expr\":\n        switch (e.operator) {\n          case \"AND\":\n            return \"this.ternaryAnd(\" + this.evaluateNodeToJavaScript(e.left) + \",\" + this.evaluateNodeToJavaScript(e.right) + \" )\";\n\n          case \"OR\":\n            return \"this.ternaryOr(\" + this.evaluateNodeToJavaScript(e.left) + \",\" + this.evaluateNodeToJavaScript(e.right) + \" )\";\n\n          case \"IS\":\n            if (\"null\" !== e.right.type) throw new Error(\"Unsupported RHS for IS\");\n            return \"this.equalsNull(\" + this.evaluateNodeToJavaScript(e.left) + \")\";\n\n          case \"ISNOT\":\n            if (\"null\" !== e.right.type) throw new Error(\"Unsupported RHS for IS\");\n            return \"(!(this.equalsNull(\" + this.evaluateNodeToJavaScript(e.left) + \")))\";\n\n          case \"IN\":\n            return \"this.applyIn(\" + this.evaluateNodeToJavaScript(e.left) + \",this.ensureArray(\" + this.evaluateNodeToJavaScript(e.right) + \"))\";\n\n          case \"NOT IN\":\n            return \"this.ternaryNot(this.applyIn(\" + this.evaluateNodeToJavaScript(e.left) + \",this.ensureArray(\" + this.evaluateNodeToJavaScript(e.right) + \")))\";\n\n          case \"BETWEEN\":\n            return \"this.between(\" + this.evaluateNodeToJavaScript(e.left) + \",\" + this.evaluateNodeToJavaScript(e.right) + \")\";\n\n          case \"NOTBETWEEN\":\n            return \"this.notbetween(\" + this.evaluateNodeToJavaScript(e.left) + \",\" + this.evaluateNodeToJavaScript(e.right) + \")\";\n\n          case \"LIKE\":\n            return \"this.applyLike(\" + this.evaluateNodeToJavaScript(e.left) + \",\" + this.evaluateNodeToJavaScript(e.right) + \",\" + JSON.stringify(e.escape) + \")\";\n\n          case \"NOT LIKE\":\n            return \"this.ternaryNot(this.applyLike(\" + this.evaluateNodeToJavaScript(e.left) + \",\" + this.evaluateNodeToJavaScript(e.right) + \",\" + JSON.stringify(e.escape) + \"))\";\n\n          case \"<>\":\n          case \"<\":\n          case \">\":\n          case \">=\":\n          case \"<=\":\n          case \"=\":\n            return \"this.compare(\" + JSON.stringify(e.operator) + \",\" + this.evaluateNodeToJavaScript(e.left) + \",\" + this.evaluateNodeToJavaScript(e.right) + \")\";\n\n          case \"*\":\n          case \"-\":\n          case \"+\":\n          case \"/\":\n            return \"this.calculate(\" + JSON.stringify(e.operator) + \",\" + this.evaluateNodeToJavaScript(e.left) + \",\" + this.evaluateNodeToJavaScript(e.right) + \")\";\n        }\n\n        throw new Error(\"Not Supported Operator \" + e.operator);\n\n      case \"null\":\n      case \"bool\":\n      case \"string\":\n      case \"number\":\n        return JSON.stringify(e.value);\n\n      case \"date\":\n        return \"(new Date(\" + m(e.value).getTime().toString() + \"))\";\n\n      case \"timestamp\":\n        return \"(new Date(\" + N(e.value).getTime().toString() + \"))\";\n\n      case \"current_time\":\n        return \"date\" === e.mode ? \"this.currentDate()\" : \"this.currentTimestamp()\";\n\n      case \"column_ref\":\n        return \"this.featureValue(feature,\" + JSON.stringify(e.column) + \",datefields,attributeAdapter)\";\n\n      case \"function\":\n        return \"this.evaluateFunction(\" + JSON.stringify(e.name) + \",\" + this.evaluateNodeToJavaScript(e.args) + \")\";\n    }\n\n    throw new Error(\"Unsupported sql syntax \" + e.type);\n  }\n\n  evaluateNode(e, t, s) {\n    switch (e.type) {\n      case \"interval\":\n        {\n          const a = this.evaluateNode(e.value, t, s);\n          return r.createFromValueAndQualifer(a, e.qualifier, e.op);\n        }\n\n      case \"case_expression\":\n        if (\"simple\" === e.format) {\n          const a = A(this.evaluateNode(e.operand, t, s));\n\n          for (let r = 0; r < e.clauses.length; r++) if (a === A(this.evaluateNode(e.clauses[r].operand, t, s))) return this.evaluateNode(e.clauses[r].value, t, s);\n\n          if (null !== e.else) return this.evaluateNode(e.else, t, s);\n        } else {\n          for (let a = 0; a < e.clauses.length; a++) if (g(this.evaluateNode(e.clauses[a].operand, t, s))) return this.evaluateNode(e.clauses[a].value, t, s);\n\n          if (null !== e.else) return this.evaluateNode(e.else, t, s);\n        }\n\n        return null;\n\n      case \"param\":\n        return this.parameters[e.value.toLowerCase()];\n\n      case \"expr_list\":\n        {\n          const a = [];\n\n          for (const r of e.value) a.push(this.evaluateNode(r, t, s));\n\n          return a;\n        }\n\n      case \"unary_expr\":\n        return S(this.evaluateNode(e.expr, t, s));\n\n      case \"binary_expr\":\n        switch (e.operator) {\n          case \"AND\":\n            return w(this.evaluateNode(e.left, t, s), this.evaluateNode(e.right, t, s));\n\n          case \"OR\":\n            return I(this.evaluateNode(e.left, t, s), this.evaluateNode(e.right, t, s));\n\n          case \"IS\":\n            if (\"null\" !== e.right.type) throw new Error(\"Unsupported RHS for IS\");\n            return null === this.evaluateNode(e.left, t, s);\n\n          case \"ISNOT\":\n            if (\"null\" !== e.right.type) throw new Error(\"Unsupported RHS for IS\");\n            return null !== this.evaluateNode(e.left, t, s);\n\n          case \"IN\":\n            {\n              const a = T(this.evaluateNode(e.right, t, s));\n              return y(this.evaluateNode(e.left, t, s), a);\n            }\n\n          case \"NOT IN\":\n            {\n              const a = T(this.evaluateNode(e.right, t, s));\n              return S(y(this.evaluateNode(e.left, t, s), a));\n            }\n\n          case \"BETWEEN\":\n            {\n              const a = this.evaluateNode(e.left, t, s),\n                    r = this.evaluateNode(e.right, t, s);\n              return null == a || null == r[0] || null == r[1] ? null : a >= A(r[0]) && a <= A(r[1]);\n            }\n\n          case \"NOTBETWEEN\":\n            {\n              const a = this.evaluateNode(e.left, t, s),\n                    r = this.evaluateNode(e.right, t, s);\n              return null == a || null == r[0] || null == r[1] ? null : a < A(r[0]) || a > A(r[1]);\n            }\n\n          case \"LIKE\":\n            return J(this.evaluateNode(e.left, t, s), this.evaluateNode(e.right, t, s), e.escape);\n\n          case \"NOT LIKE\":\n            return S(J(this.evaluateNode(e.left, t, s), this.evaluateNode(e.right, t, s), e.escape));\n\n          case \"<>\":\n          case \"<\":\n          case \">\":\n          case \">=\":\n          case \"<=\":\n          case \"=\":\n            return b(e.operator, this.evaluateNode(e.left, t, s), this.evaluateNode(e.right, t, s));\n\n          case \"-\":\n          case \"+\":\n          case \"*\":\n          case \"/\":\n            return D(e.operator, this.evaluateNode(e.left, t, s), this.evaluateNode(e.right, t, s));\n        }\n\n      case \"null\":\n      case \"bool\":\n      case \"string\":\n      case \"number\":\n        return e.value;\n\n      case \"date\":\n        return m(e.value);\n\n      case \"timestamp\":\n        return N(e.value);\n\n      case \"current_time\":\n        {\n          const t = new Date();\n          return \"date\" === e.mode && t.setHours(0, 0, 0, 0), t;\n        }\n\n      case \"column_ref\":\n        return _(t, e.column, this.datefields, s);\n\n      case \"function\":\n        {\n          const r = this.evaluateNode(e.args, t, s);\n          return this.isAggregate ? a(e.name, r) : n(e.name, r);\n        }\n    }\n\n    throw new Error(\"Unsupported sql syntax \" + e.type);\n  }\n\n}\n\nfunction N(e) {\n  let t = u.exec(e);\n\n  if (null !== t) {\n    const [, e, a, r, s, n, i] = t;\n    return d(e, a, r, s, n, i);\n  }\n\n  if (t = o.exec(e), null !== t) {\n    const [, e, a, r, s, n, i, l, u, o] = t;\n    return d(e, a, r, s, n, i, l, u, o);\n  }\n\n  if (t = c.exec(e), null !== t) {\n    const [, e, a, r, s, n, i, l, u] = t;\n    return d(e, a, r, s, n, \"0\", i, l, u);\n  }\n\n  if (t = h.exec(e), null !== t) {\n    const [, e, a, r, s, n] = t;\n    return d(e, a, r, s, n);\n  }\n\n  if (t = l.exec(e), null !== t) {\n    const [, e, a, r] = t;\n    return d(e, a, r);\n  }\n\n  throw new Error(\"SQL Invalid Timestamp\");\n}\n\nfunction m(e) {\n  const t = l.exec(e);\n  if (null === t) throw new Error(\"SQL Invalid Date\");\n  const [, a, r, s] = t;\n  return new Date(parseInt(a, 10), parseInt(r, 10) - 1, parseInt(s, 10));\n}\n\nfunction g(e) {\n  return !0 === e;\n}\n\nfunction T(e) {\n  return Array.isArray(e) ? e : [e];\n}\n\nfunction S(e) {\n  return null !== e ? !0 !== e : null;\n}\n\nfunction w(e, t) {\n  return null != e && null != t ? !0 === e && !0 === t : !1 !== e && !1 !== t && null;\n}\n\nfunction I(e, t) {\n  return null != e && null != t ? !0 === e || !0 === t : !0 === e || !0 === t || null;\n}\n\nfunction y(e, t) {\n  if (null == e) return null;\n  let a = !1;\n\n  for (const r of t) if (null == r) a = null;else if (e === r) {\n    a = !0;\n    break;\n  }\n\n  return a;\n}\n\nfunction J(e, t, a) {\n  if (null == e) return null;\n  const r = t,\n        s = a;\n  let n = \"\";\n  const i = \"-[]/{}()*+?.\\\\^$|\";\n  let l = 0;\n\n  for (let u = 0; u < r.length; u++) {\n    const e = r.charAt(u);\n\n    switch (l) {\n      case 0:\n        e === s ? l = 1 : i.indexOf(e) >= 0 ? n += \"\\\\\" + e : n += \"%\" === e ? \".*\" : \"_\" === e ? \".\" : e;\n        break;\n\n      case 1:\n        i.indexOf(e) >= 0 ? n += \"\\\\\" + e : n += e, l = 0;\n    }\n  }\n\n  return new RegExp(\"^\" + n + \"$\").test(e);\n}\n\nfunction A(e) {\n  return e instanceof Date ? e.valueOf() : e;\n}\n\nfunction b(e, t, a) {\n  if (null == t || null == a) return null;\n  const r = A(t),\n        s = A(a);\n\n  switch (e) {\n    case \"<>\":\n      return r !== s;\n\n    case \"=\":\n      return r === s;\n\n    case \">\":\n      return r > s;\n\n    case \"<\":\n      return r < s;\n\n    case \">=\":\n      return r >= s;\n\n    case \"<=\":\n      return r <= s;\n  }\n}\n\nfunction x(e) {\n  const t = [],\n        a = {};\n\n  for (const r of e) {\n    const e = r.toLowerCase();\n    void 0 === a[e] && (t.push(r), a[e] = 1);\n  }\n\n  return t;\n}\n\nfunction D(e, t, a) {\n  if (t instanceof r) {\n    if (a instanceof Date) switch (e) {\n      case \"+\":\n        return new Date(t.valueInMilliseconds() + a.getTime());\n\n      case \"-\":\n        return t.valueInMilliseconds() - a.getTime();\n\n      case \"*\":\n        return t.valueInMilliseconds() * a.getTime();\n\n      case \"/\":\n        return t.valueInMilliseconds() / a.getTime();\n    } else if (a instanceof r) switch (e) {\n      case \"+\":\n        return r.createFromMilliseconds(t.valueInMilliseconds() + a.valueInMilliseconds());\n\n      case \"-\":\n        return r.createFromMilliseconds(t.valueInMilliseconds() - a.valueInMilliseconds());\n\n      case \"*\":\n        return t.valueInMilliseconds() * a.valueInMilliseconds();\n\n      case \"/\":\n        return t.valueInMilliseconds() / a.valueInMilliseconds();\n    } else t = t.valueInMilliseconds();\n  } else if (a instanceof r) {\n    if (t instanceof Date) switch (e) {\n      case \"+\":\n        return new Date(a.valueInMilliseconds() + t.getTime());\n\n      case \"-\":\n        return new Date(t.getTime() - a.valueInMilliseconds());\n\n      case \"*\":\n        return t.getTime() * a.valueInMilliseconds();\n\n      case \"/\":\n        return t.getTime() / a.valueInMilliseconds();\n    } else a = a.valueInMilliseconds();\n  } else if (t instanceof Date && \"number\" == typeof a) switch (a = 24 * a * 60 * 60 * 1e3, t = t.getTime(), e) {\n    case \"+\":\n      return new Date(t + a);\n\n    case \"-\":\n      return new Date(t - a);\n\n    case \"*\":\n      return new Date(t * a);\n\n    case \"/\":\n      return new Date(t / a);\n  } else if (a instanceof Date && \"number\" == typeof t) switch (t = 24 * t * 60 * 60 * 1e3, a = a.getTime(), e) {\n    case \"+\":\n      return new Date(t + a);\n\n    case \"-\":\n      return new Date(t - a);\n\n    case \"*\":\n      return new Date(t * a);\n\n    case \"/\":\n      return new Date(t / a);\n  }\n\n  switch (e) {\n    case \"+\":\n      return t + a;\n\n    case \"-\":\n      return t - a;\n\n    case \"*\":\n      return t * a;\n\n    case \"/\":\n      return t / a;\n  }\n}\n\nfunction E(e) {\n  return e && \"object\" == typeof e.attributes;\n}\n\nfunction _(e, t, a, r) {\n  const s = r.getAttribute(e, t);\n  return null != s && 1 === a[t] ? new Date(s) : s;\n}\n\nconst M = {\n  getAttribute: (e, t) => (E(e) ? e.attributes : e)[t]\n};\nexport { f as WhereClause, M as defaultAttributeAdapter };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/core/sql/WhereClause.js"],"names":["e","isAggregate","t","aggregateFunction","a","SqlInterval","r","isStandardized","s","evaluateFunction","n","WhereGrammar","i","l","u","o","c","h","p","length","Array","join","d","parseInt","parseFloat","toString","Date","v","makeBool","g","featureValue","_","equalsNull","applyLike","J","ensureArray","T","applyIn","y","currentDate","setHours","makeSqlInterval","createFromValueAndQualifer","convertInterval","valueInMilliseconds","currentTimestamp","compare","b","calculate","D","makeComparable","A","lookup","between","notbetween","ternaryNot","S","ternaryAnd","w","ternaryOr","I","f","constructor","fieldsIndex","datefields","parameters","parseTree","parse","referencedFieldNames","extractExpressionInfo","create","fieldNames","testSet","M","map","getAttribute","evaluateNode","attributes","calculateValue","calculateValueCompiled","_compiledVersion","compileMe","testFeature","testFeatureCompiled","getFunctions","visitAll","type","push","name","toLowerCase","x","getExpressions","Map","args","value","column","has","set","aggregateType","field","values","getVariables","evaluateNodeToJavaScript","Function","bind","get","operand","clauses","format","else","expr","left","right","JSON","stringify","qualifier","op","operator","Error","escape","m","getTime","N","mode","exec","isArray","charAt","indexOf","RegExp","test","valueOf","createFromMilliseconds","E","WhereClause","defaultAttributeAdapter"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../has.js\";import{isAggregate as t,aggregateFunction as a}from\"./AggregateFunctions.js\";import{SqlInterval as r,isStandardized as s,evaluateFunction as n}from\"./StandardizedFunctions.js\";import{WhereGrammar as i}from\"./WhereGrammar.js\";const l=/^(\\d{4})-(\\d{1,2})-(\\d{1,2})$/,u=/^(\\d{4})-(\\d{1,2})-(\\d{1,2}) (\\d{1,2}):(\\d{1,2}):(\\d{1,2}(\\.[0-9]+)?)$/,o=/^(\\d{4})-(\\d{1,2})-(\\d{1,2}) (\\d{1,2}):(\\d{1,2}):(\\d{1,2}(\\.[0-9]+)?)(\\+|\\-)(\\d{1,2}):(\\d{1,2})$/,c=/^(\\d{4})-(\\d{1,2})-(\\d{1,2}) (\\d{1,2}):(\\d{1,2})(\\+|\\-)(\\d{1,2}):(\\d{1,2})$/,h=/^(\\d{4})-(\\d{1,2})-(\\d{1,2}) (\\d{1,2}):(\\d{1,2})$/;function p(e,t){return(e+=\"\").length>=t?e:new Array(t-e.length+1).join(\"0\")+e}function d(e,t,a=\"0\",r=\"0\",s=\"0\",n=\"0\",i=\"\",l=\"0\",u=\"0\"){if(\"+\"===i||\"-\"===i){const o=`${p(parseInt(e,10),4)}-${p(parseInt(t,10),2)}-${p(parseInt(a,10),2)}`;let c=\"\";parseFloat(n)<10&&(c=\"0\");const h=`${p(parseInt(r,10),2)}:${p(parseInt(s,10),2)}:${c+parseFloat(n).toString()}`,d=`${i}${p(parseInt(l,10),2)}:${p(parseInt(u,10),2)}`;return new Date(o+\"T\"+h+d)}return new Date(parseInt(e,10),parseInt(t,10)-1,parseInt(a,10),parseInt(r,10),parseInt(s,10),parseFloat(n))}class v{static makeBool(e){return g(e)}static featureValue(e,t,a,r){return _(e,t,a,r)}static equalsNull(e){return null===e}static applyLike(e,t,a){return J(e,t,a)}static ensureArray(e){return T(e)}static applyIn(e,t){return y(e,t)}static currentDate(){const e=new Date;return e.setHours(0,0,0,0),e}static makeSqlInterval(e,t,a){return r.createFromValueAndQualifer(e,t,a)}static convertInterval(e){return e instanceof r?e.valueInMilliseconds():e}static currentTimestamp(){return new Date}static compare(e,t,a){return b(e,t,a)}static calculate(e,t,a){return D(e,t,a)}static makeComparable(e){return A(e)}static evaluateFunction(e,t){return n(e,t)}static lookup(e,t){const a=t[e];return void 0===a?null:a}static between(e,t){return null==e||null==t[0]||null==t[1]?null:e>=t[0]&&e<=t[1]}static notbetween(e,t){return null==e||null==t[0]||null==t[1]?null:e<t[0]||e>t[1]}static ternaryNot(e){return S(e)}static ternaryAnd(e,t){return w(e,t)}static ternaryOr(e,t){return I(e,t)}}class f{constructor(e,t){this.fieldsIndex=t,this.datefields={},this.parameters={},this.parseTree=i.parse(e);const{isStandardized:a,isAggregate:r,referencedFieldNames:s}=this.extractExpressionInfo(t);this.referencedFieldNames=s,this.isStandardized=a,this.isAggregate=r}static create(e,t){return new f(e,t)}get fieldNames(){return this.referencedFieldNames}testSet(e,t=M){const a={};for(const r of this.fieldNames)a[r]=e.map((e=>t.getAttribute(e,r)));return!!this.evaluateNode(this.parseTree,{attributes:a},M)}calculateValue(e,t=M){const a=this.evaluateNode(this.parseTree,e,t);return a instanceof r?a.valueInMilliseconds()/864e5:a}calculateValueCompiled(t,a=M){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(t,this.parameters,a,this.datefields):e(\"csp-restrictions\")?this.calculateValue(t,a):(this.compileMe(),this.parseTree._compiledVersion(t,this.parameters,a,this.datefields))}testFeature(e,t=M){return!!this.evaluateNode(this.parseTree,e,t)}testFeatureCompiled(t,a=M){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(t,this.parameters,a,this.datefields):e(\"csp-restrictions\")?this.testFeature(t,a):(this.compileMe(),!!this.parseTree._compiledVersion(t,this.parameters,a,this.datefields))}getFunctions(){const e=[];return this.visitAll(this.parseTree,(t=>{\"function\"===t.type&&e.push(t.name.toLowerCase())})),x(e)}getExpressions(){const e=new Map;return this.visitAll(this.parseTree,(t=>{if(\"function\"===t.type){const a=t.name.toLowerCase(),r=t.args.value[0];if(\"column_ref\"===r.type){const t=r.column,s=`${a}-${t}`;e.has(s)||e.set(s,{aggregateType:a,field:t})}}})),[...e.values()]}getVariables(){const e=[];return this.visitAll(this.parseTree,(t=>{\"param\"===t.type&&e.push(t.value.toLowerCase())})),x(e)}compileMe(){const e=\"return this.convertInterval(\"+this.evaluateNodeToJavaScript(this.parseTree)+\")\";this.parseTree._compiledVersion=new Function(\"feature\",\"lookups\",\"attributeAdapter\",\"datefields\",e).bind(v)}extractExpressionInfo(e){const a=[];let r=!0,n=!0;return this.visitAll(this.parseTree,(i=>{switch(i.type){case\"column_ref\":{const t=e.get(i.column),r=t&&t.name;!t||\"date\"!==t.type&&\"esriFieldTypeDate\"!==t.type||(this.datefields[t.name]=1),void 0!==r?(a.push(r),i.column=r):a.push(i.column);break}case\"function\":{const{name:e,args:a}=i,l=a.value.length;r&&(r=s(e,l)),n&&(n=t(e,l));break}}})),{referencedFieldNames:x(a),isStandardized:r,isAggregate:n}}visitAll(e,t){if(null!=e)switch(t(e),e.type){case\"when_clause\":this.visitAll(e.operand,t),this.visitAll(e.value,t);break;case\"case_expression\":for(const a of e.clauses)this.visitAll(a,t);\"simple\"===e.format&&this.visitAll(e.operand,t),null!==e.else&&this.visitAll(e.else,t);break;case\"expr_list\":for(const a of e.value)this.visitAll(a,t);break;case\"unary_expr\":this.visitAll(e.expr,t);break;case\"binary_expr\":this.visitAll(e.left,t),this.visitAll(e.right,t);break;case\"function\":this.visitAll(e.args,t)}}evaluateNodeToJavaScript(e){switch(e.type){case\"interval\":return\"this.makeSqlInterval(\"+this.evaluateNodeToJavaScript(e.value)+\", \"+JSON.stringify(e.qualifier)+\",\"+JSON.stringify(e.op)+\")\";case\"case_expression\":{let t=\"\";if(\"simple\"===e.format){const a=\"this.makeComparable(\"+this.evaluateNodeToJavaScript(e.operand)+\")\";t=\"( \";for(let r=0;r<e.clauses.length;r++)t+=\" (\"+a+\" === this.makeComparable(\"+this.evaluateNodeToJavaScript(e.clauses[r].operand)+\")) ? (\"+this.evaluateNodeToJavaScript(e.clauses[r].value)+\") : \";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+=\"null\",t+=\" )\"}else{t=\"( \";for(let a=0;a<e.clauses.length;a++)t+=\" this.makeBool(\"+this.evaluateNodeToJavaScript(e.clauses[a].operand)+\")===true ? (\"+this.evaluateNodeToJavaScript(e.clauses[a].value)+\") : \";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+=\"null\",t+=\" )\"}return t}case\"param\":return\"this.lookup(\"+JSON.stringify(e.value.toLowerCase())+\",lookups)\";case\"expr_list\":{let t=\"[\";for(const a of e.value)\"[\"!==t&&(t+=\",\"),t+=this.evaluateNodeToJavaScript(a);return t+=\"]\",t}case\"unary_expr\":return\"this.ternaryNot(\"+this.evaluateNodeToJavaScript(e.expr)+\")\";case\"binary_expr\":switch(e.operator){case\"AND\":return\"this.ternaryAnd(\"+this.evaluateNodeToJavaScript(e.left)+\",\"+this.evaluateNodeToJavaScript(e.right)+\" )\";case\"OR\":return\"this.ternaryOr(\"+this.evaluateNodeToJavaScript(e.left)+\",\"+this.evaluateNodeToJavaScript(e.right)+\" )\";case\"IS\":if(\"null\"!==e.right.type)throw new Error(\"Unsupported RHS for IS\");return\"this.equalsNull(\"+this.evaluateNodeToJavaScript(e.left)+\")\";case\"ISNOT\":if(\"null\"!==e.right.type)throw new Error(\"Unsupported RHS for IS\");return\"(!(this.equalsNull(\"+this.evaluateNodeToJavaScript(e.left)+\")))\";case\"IN\":return\"this.applyIn(\"+this.evaluateNodeToJavaScript(e.left)+\",this.ensureArray(\"+this.evaluateNodeToJavaScript(e.right)+\"))\";case\"NOT IN\":return\"this.ternaryNot(this.applyIn(\"+this.evaluateNodeToJavaScript(e.left)+\",this.ensureArray(\"+this.evaluateNodeToJavaScript(e.right)+\")))\";case\"BETWEEN\":return\"this.between(\"+this.evaluateNodeToJavaScript(e.left)+\",\"+this.evaluateNodeToJavaScript(e.right)+\")\";case\"NOTBETWEEN\":return\"this.notbetween(\"+this.evaluateNodeToJavaScript(e.left)+\",\"+this.evaluateNodeToJavaScript(e.right)+\")\";case\"LIKE\":return\"this.applyLike(\"+this.evaluateNodeToJavaScript(e.left)+\",\"+this.evaluateNodeToJavaScript(e.right)+\",\"+JSON.stringify(e.escape)+\")\";case\"NOT LIKE\":return\"this.ternaryNot(this.applyLike(\"+this.evaluateNodeToJavaScript(e.left)+\",\"+this.evaluateNodeToJavaScript(e.right)+\",\"+JSON.stringify(e.escape)+\"))\";case\"<>\":case\"<\":case\">\":case\">=\":case\"<=\":case\"=\":return\"this.compare(\"+JSON.stringify(e.operator)+\",\"+this.evaluateNodeToJavaScript(e.left)+\",\"+this.evaluateNodeToJavaScript(e.right)+\")\";case\"*\":case\"-\":case\"+\":case\"/\":return\"this.calculate(\"+JSON.stringify(e.operator)+\",\"+this.evaluateNodeToJavaScript(e.left)+\",\"+this.evaluateNodeToJavaScript(e.right)+\")\"}throw new Error(\"Not Supported Operator \"+e.operator);case\"null\":case\"bool\":case\"string\":case\"number\":return JSON.stringify(e.value);case\"date\":return\"(new Date(\"+m(e.value).getTime().toString()+\"))\";case\"timestamp\":return\"(new Date(\"+N(e.value).getTime().toString()+\"))\";case\"current_time\":return\"date\"===e.mode?\"this.currentDate()\":\"this.currentTimestamp()\";case\"column_ref\":return\"this.featureValue(feature,\"+JSON.stringify(e.column)+\",datefields,attributeAdapter)\";case\"function\":return\"this.evaluateFunction(\"+JSON.stringify(e.name)+\",\"+this.evaluateNodeToJavaScript(e.args)+\")\"}throw new Error(\"Unsupported sql syntax \"+e.type)}evaluateNode(e,t,s){switch(e.type){case\"interval\":{const a=this.evaluateNode(e.value,t,s);return r.createFromValueAndQualifer(a,e.qualifier,e.op)}case\"case_expression\":if(\"simple\"===e.format){const a=A(this.evaluateNode(e.operand,t,s));for(let r=0;r<e.clauses.length;r++)if(a===A(this.evaluateNode(e.clauses[r].operand,t,s)))return this.evaluateNode(e.clauses[r].value,t,s);if(null!==e.else)return this.evaluateNode(e.else,t,s)}else{for(let a=0;a<e.clauses.length;a++)if(g(this.evaluateNode(e.clauses[a].operand,t,s)))return this.evaluateNode(e.clauses[a].value,t,s);if(null!==e.else)return this.evaluateNode(e.else,t,s)}return null;case\"param\":return this.parameters[e.value.toLowerCase()];case\"expr_list\":{const a=[];for(const r of e.value)a.push(this.evaluateNode(r,t,s));return a}case\"unary_expr\":return S(this.evaluateNode(e.expr,t,s));case\"binary_expr\":switch(e.operator){case\"AND\":return w(this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s));case\"OR\":return I(this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s));case\"IS\":if(\"null\"!==e.right.type)throw new Error(\"Unsupported RHS for IS\");return null===this.evaluateNode(e.left,t,s);case\"ISNOT\":if(\"null\"!==e.right.type)throw new Error(\"Unsupported RHS for IS\");return null!==this.evaluateNode(e.left,t,s);case\"IN\":{const a=T(this.evaluateNode(e.right,t,s));return y(this.evaluateNode(e.left,t,s),a)}case\"NOT IN\":{const a=T(this.evaluateNode(e.right,t,s));return S(y(this.evaluateNode(e.left,t,s),a))}case\"BETWEEN\":{const a=this.evaluateNode(e.left,t,s),r=this.evaluateNode(e.right,t,s);return null==a||null==r[0]||null==r[1]?null:a>=A(r[0])&&a<=A(r[1])}case\"NOTBETWEEN\":{const a=this.evaluateNode(e.left,t,s),r=this.evaluateNode(e.right,t,s);return null==a||null==r[0]||null==r[1]?null:a<A(r[0])||a>A(r[1])}case\"LIKE\":return J(this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s),e.escape);case\"NOT LIKE\":return S(J(this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s),e.escape));case\"<>\":case\"<\":case\">\":case\">=\":case\"<=\":case\"=\":return b(e.operator,this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s));case\"-\":case\"+\":case\"*\":case\"/\":return D(e.operator,this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s))}case\"null\":case\"bool\":case\"string\":case\"number\":return e.value;case\"date\":return m(e.value);case\"timestamp\":return N(e.value);case\"current_time\":{const t=new Date;return\"date\"===e.mode&&t.setHours(0,0,0,0),t}case\"column_ref\":return _(t,e.column,this.datefields,s);case\"function\":{const r=this.evaluateNode(e.args,t,s);return this.isAggregate?a(e.name,r):n(e.name,r)}}throw new Error(\"Unsupported sql syntax \"+e.type)}}function N(e){let t=u.exec(e);if(null!==t){const[,e,a,r,s,n,i]=t;return d(e,a,r,s,n,i)}if(t=o.exec(e),null!==t){const[,e,a,r,s,n,i,l,u,o]=t;return d(e,a,r,s,n,i,l,u,o)}if(t=c.exec(e),null!==t){const[,e,a,r,s,n,i,l,u]=t;return d(e,a,r,s,n,\"0\",i,l,u)}if(t=h.exec(e),null!==t){const[,e,a,r,s,n]=t;return d(e,a,r,s,n)}if(t=l.exec(e),null!==t){const[,e,a,r]=t;return d(e,a,r)}throw new Error(\"SQL Invalid Timestamp\")}function m(e){const t=l.exec(e);if(null===t)throw new Error(\"SQL Invalid Date\");const[,a,r,s]=t;return new Date(parseInt(a,10),parseInt(r,10)-1,parseInt(s,10))}function g(e){return!0===e}function T(e){return Array.isArray(e)?e:[e]}function S(e){return null!==e?!0!==e:null}function w(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function I(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function y(e,t){if(null==e)return null;let a=!1;for(const r of t)if(null==r)a=null;else if(e===r){a=!0;break}return a}function J(e,t,a){if(null==e)return null;const r=t,s=a;let n=\"\";const i=\"-[]/{}()*+?.\\\\^$|\";let l=0;for(let u=0;u<r.length;u++){const e=r.charAt(u);switch(l){case 0:e===s?l=1:i.indexOf(e)>=0?n+=\"\\\\\"+e:n+=\"%\"===e?\".*\":\"_\"===e?\".\":e;break;case 1:i.indexOf(e)>=0?n+=\"\\\\\"+e:n+=e,l=0}}return new RegExp(\"^\"+n+\"$\").test(e)}function A(e){return e instanceof Date?e.valueOf():e}function b(e,t,a){if(null==t||null==a)return null;const r=A(t),s=A(a);switch(e){case\"<>\":return r!==s;case\"=\":return r===s;case\">\":return r>s;case\"<\":return r<s;case\">=\":return r>=s;case\"<=\":return r<=s}}function x(e){const t=[],a={};for(const r of e){const e=r.toLowerCase();void 0===a[e]&&(t.push(r),a[e]=1)}return t}function D(e,t,a){if(t instanceof r)if(a instanceof Date)switch(e){case\"+\":return new Date(t.valueInMilliseconds()+a.getTime());case\"-\":return t.valueInMilliseconds()-a.getTime();case\"*\":return t.valueInMilliseconds()*a.getTime();case\"/\":return t.valueInMilliseconds()/a.getTime()}else if(a instanceof r)switch(e){case\"+\":return r.createFromMilliseconds(t.valueInMilliseconds()+a.valueInMilliseconds());case\"-\":return r.createFromMilliseconds(t.valueInMilliseconds()-a.valueInMilliseconds());case\"*\":return t.valueInMilliseconds()*a.valueInMilliseconds();case\"/\":return t.valueInMilliseconds()/a.valueInMilliseconds()}else t=t.valueInMilliseconds();else if(a instanceof r)if(t instanceof Date)switch(e){case\"+\":return new Date(a.valueInMilliseconds()+t.getTime());case\"-\":return new Date(t.getTime()-a.valueInMilliseconds());case\"*\":return t.getTime()*a.valueInMilliseconds();case\"/\":return t.getTime()/a.valueInMilliseconds()}else a=a.valueInMilliseconds();else if(t instanceof Date&&\"number\"==typeof a)switch(a=24*a*60*60*1e3,t=t.getTime(),e){case\"+\":return new Date(t+a);case\"-\":return new Date(t-a);case\"*\":return new Date(t*a);case\"/\":return new Date(t/a)}else if(a instanceof Date&&\"number\"==typeof t)switch(t=24*t*60*60*1e3,a=a.getTime(),e){case\"+\":return new Date(t+a);case\"-\":return new Date(t-a);case\"*\":return new Date(t*a);case\"/\":return new Date(t/a)}switch(e){case\"+\":return t+a;case\"-\":return t-a;case\"*\":return t*a;case\"/\":return t/a}}function E(e){return e&&\"object\"==typeof e.attributes}function _(e,t,a,r){const s=r.getAttribute(e,t);return null!=s&&1===a[t]?new Date(s):s}const M={getAttribute:(e,t)=>(E(e)?e.attributes:e)[t]};export{f as WhereClause,M as defaultAttributeAdapter};\n"]},"metadata":{},"sourceType":"module"}