{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../../core/Error.js\";\nimport { isSome as t } from \"../../../core/maybe.js\";\nimport s from \"../../../core/pbf.js\";\nimport r from \"../../../layers/graphics/OptimizedGeometry.js\";\nimport { OPTIMIZED_GEOMETRY_TYPES as a } from \"./pbfOptimizedFeatureSet.js\";\nconst n = [\"esriFieldTypeSmallInteger\", \"esriFieldTypeInteger\", \"esriFieldTypeSingle\", \"esriFieldTypeDouble\", \"esriFieldTypeString\", \"esriFieldTypeDate\", \"esriFieldTypeOID\", \"esriFieldTypeGeometry\", \"esriFieldTypeBlob\", \"esriFieldTypeRaster\", \"esriFieldTypeGUID\", \"esriFieldTypeGlobalID\", \"esriFieldTypeXML\"],\n      o = [\"sqlTypeBigInt\", \"sqlTypeBinary\", \"sqlTypeBit\", \"sqlTypeChar\", \"sqlTypeDate\", \"sqlTypeDecimal\", \"sqlTypeDouble\", \"sqlTypeFloat\", \"sqlTypeGeometry\", \"sqlTypeGUID\", \"sqlTypeInteger\", \"sqlTypeLongNVarchar\", \"sqlTypeLongVarbinary\", \"sqlTypeLongVarchar\", \"sqlTypeNChar\", \"sqlTypeNVarchar\", \"sqlTypeOther\", \"sqlTypeReal\", \"sqlTypeSmallInt\", \"sqlTypeSqlXml\", \"sqlTypeTime\", \"sqlTypeTimestamp\", \"sqlTypeTimestamp2\", \"sqlTypeTinyInt\", \"sqlTypeVarbinary\", \"sqlTypeVarchar\"],\n      c = [\"upperLeft\", \"lowerLeft\"];\n\nfunction i(e) {\n  return e >= n.length ? null : n[e];\n}\n\nfunction l(e) {\n  return e >= o.length ? null : o[e];\n}\n\nfunction g(e) {\n  return e >= c.length ? null : c[e];\n}\n\nfunction p(e, t) {\n  return t >= e.geometryTypes.length ? null : e.geometryTypes[t];\n}\n\nfunction u(e, t, s) {\n  const r = 1,\n        a = 2,\n        n = 3,\n        o = t.createPointGeometry(s);\n\n  for (; e.next();) switch (e.tag()) {\n    case n:\n      {\n        const s = e.getUInt32(),\n              r = e.pos() + s;\n        let a = 0;\n\n        for (; e.pos() < r;) t.addCoordinatePoint(o, e.getSInt64(), a++);\n\n        break;\n      }\n\n    case r:\n    case a:\n    default:\n      e.skip();\n  }\n\n  return o;\n}\n\nfunction y(e, t, s) {\n  const r = 1,\n        a = 2,\n        n = 3,\n        o = t.createGeometry(s),\n        c = 2 + (s.hasZ ? 1 : 0) + (s.hasM ? 1 : 0);\n\n  for (; e.next();) switch (e.tag()) {\n    case a:\n      {\n        const s = e.getUInt32(),\n              r = e.pos() + s;\n        let a = 0;\n\n        for (; e.pos() < r;) t.addLength(o, e.getUInt32(), a++);\n\n        break;\n      }\n\n    case n:\n      {\n        const s = e.getUInt32(),\n              r = e.pos() + s;\n        let a = 0;\n\n        for (t.allocateCoordinates(o); e.pos() < r;) t.addCoordinate(o, e.getSInt64(), a), a++, a === c && (a = 0);\n\n        break;\n      }\n\n    case r:\n    default:\n      e.skip();\n  }\n\n  return o;\n}\n\nfunction b(e) {\n  const t = 1,\n        s = 2,\n        n = 3,\n        o = new r();\n  let c = \"esriGeometryPoint\";\n\n  for (; e.next();) switch (e.tag()) {\n    case s:\n      {\n        const t = e.getUInt32(),\n              s = e.pos() + t;\n\n        for (; e.pos() < s;) o.lengths.push(e.getUInt32());\n\n        break;\n      }\n\n    case n:\n      {\n        const t = e.getUInt32(),\n              s = e.pos() + t;\n\n        for (; e.pos() < s;) o.coords.push(e.getSInt64());\n\n        break;\n      }\n\n    case t:\n      c = a[e.getEnum()];\n      break;\n\n    default:\n      e.skip();\n  }\n\n  return {\n    queryGeometry: o,\n    queryGeometryType: c\n  };\n}\n\nfunction f(e) {\n  const t = 1,\n        s = 2,\n        r = 3,\n        a = 4,\n        n = 5,\n        o = 6,\n        c = 7,\n        i = 8,\n        l = 9;\n\n  for (; e.next();) switch (e.tag()) {\n    case t:\n      return e.getString();\n\n    case s:\n      return e.getFloat();\n\n    case r:\n      return e.getDouble();\n\n    case a:\n      return e.getSInt32();\n\n    case n:\n      return e.getUInt32();\n\n    case o:\n      return e.getInt64();\n\n    case c:\n      return e.getUInt64();\n\n    case i:\n      return e.getSInt64();\n\n    case l:\n      return e.getBool();\n\n    default:\n      return e.skip(), null;\n  }\n\n  return null;\n}\n\nfunction k(e) {\n  const t = 1,\n        s = 2,\n        r = 3,\n        a = 4,\n        n = 5,\n        o = 6,\n        c = {\n    type: i(0)\n  };\n\n  for (; e.next();) switch (e.tag()) {\n    case t:\n      c.name = e.getString();\n      break;\n\n    case s:\n      c.type = i(e.getEnum());\n      break;\n\n    case r:\n      c.alias = e.getString();\n      break;\n\n    case a:\n      c.sqlType = l(e.getEnum());\n      break;\n\n    case n:\n      e.skip();\n      break;\n\n    case o:\n      c.defaultValue = e.getString();\n      break;\n\n    default:\n      e.skip();\n  }\n\n  return c;\n}\n\nfunction d(e) {\n  const t = 1,\n        s = 2,\n        r = {};\n\n  for (; e.next();) switch (e.tag()) {\n    case t:\n      r.name = e.getString();\n      break;\n\n    case s:\n      r.isSystemMaintained = e.getBool();\n      break;\n\n    default:\n      e.skip();\n  }\n\n  return r;\n}\n\nfunction m(e, t, s, r) {\n  const a = 1,\n        n = 2,\n        o = 4,\n        c = t.createFeature(s);\n  let i = 0;\n\n  for (; e.next();) switch (e.tag()) {\n    case a:\n      {\n        const t = r[i++].name;\n        c.attributes[t] = e.processMessage(f);\n        break;\n      }\n\n    case n:\n      c.geometry = e.processMessageWithArgs(y, t, s);\n      break;\n\n    case o:\n      c.centroid = e.processMessageWithArgs(u, t, s);\n      break;\n\n    default:\n      e.skip();\n  }\n\n  return c;\n}\n\nfunction h(e) {\n  const t = 1,\n        s = 2,\n        r = 3,\n        a = 4,\n        n = [1, 1, 1, 1];\n\n  for (; e.next();) switch (e.tag()) {\n    case t:\n      n[0] = e.getDouble();\n      break;\n\n    case s:\n      n[1] = e.getDouble();\n      break;\n\n    case a:\n      n[2] = e.getDouble();\n      break;\n\n    case r:\n      n[3] = e.getDouble();\n      break;\n\n    default:\n      e.skip();\n  }\n\n  return n;\n}\n\nfunction T(e) {\n  const t = 1,\n        s = 2,\n        r = 3,\n        a = 4,\n        n = [0, 0, 0, 0];\n\n  for (; e.next();) switch (e.tag()) {\n    case t:\n      n[0] = e.getDouble();\n      break;\n\n    case s:\n      n[1] = e.getDouble();\n      break;\n\n    case a:\n      n[2] = e.getDouble();\n      break;\n\n    case r:\n      n[3] = e.getDouble();\n      break;\n\n    default:\n      e.skip();\n  }\n\n  return n;\n}\n\nfunction q(e) {\n  const t = 1,\n        s = 2,\n        r = 3,\n        a = {\n    originPosition: g(0)\n  };\n\n  for (; e.next();) switch (e.tag()) {\n    case t:\n      a.originPosition = g(e.getEnum());\n      break;\n\n    case s:\n      a.scale = e.processMessage(h);\n      break;\n\n    case r:\n      a.translate = e.processMessage(T);\n      break;\n\n    default:\n      e.skip();\n  }\n\n  return a;\n}\n\nfunction I(e) {\n  const t = 1,\n        s = 2,\n        r = 3,\n        a = {};\n\n  for (; e.next();) switch (e.tag()) {\n    case t:\n      a.shapeAreaFieldName = e.getString();\n      break;\n\n    case s:\n      a.shapeLengthFieldName = e.getString();\n      break;\n\n    case r:\n      a.units = e.getString();\n      break;\n\n    default:\n      e.skip();\n  }\n\n  return a;\n}\n\nfunction F(e, t) {\n  const s = 1,\n        r = 2,\n        a = 3,\n        n = 4,\n        o = 5,\n        c = t.createSpatialReference();\n\n  for (; e.next();) switch (e.tag()) {\n    case s:\n      c.wkid = e.getUInt32();\n      break;\n\n    case o:\n      c.wkt = e.getString();\n      break;\n\n    case r:\n      c.latestWkid = e.getUInt32();\n      break;\n\n    case a:\n      c.vcsWkid = e.getUInt32();\n      break;\n\n    case n:\n      c.latestVcsWkid = e.getUInt32();\n      break;\n\n    default:\n      e.skip();\n  }\n\n  return c;\n}\n\nfunction w(e, t) {\n  const s = 1,\n        r = 2,\n        a = 3,\n        n = 4,\n        o = 5,\n        c = 6,\n        i = 7,\n        l = 8,\n        g = 9,\n        u = 10,\n        y = 11,\n        b = 12,\n        f = 13,\n        h = 15,\n        T = t.createFeatureResult();\n  T.geometryType = p(t, 0);\n  let w = !1;\n\n  for (; e.next();) switch (e.tag()) {\n    case s:\n      T.objectIdFieldName = e.getString();\n      break;\n\n    case a:\n      T.globalIdFieldName = e.getString();\n      break;\n\n    case n:\n      T.geohashFieldName = e.getString();\n      break;\n\n    case o:\n      T.geometryProperties = e.processMessage(I);\n      break;\n\n    case i:\n      T.geometryType = p(t, e.getEnum());\n      break;\n\n    case l:\n      T.spatialReference = e.processMessageWithArgs(F, t);\n      break;\n\n    case u:\n      T.hasZ = e.getBool();\n      break;\n\n    case y:\n      T.hasM = e.getBool();\n      break;\n\n    case b:\n      T.transform = e.processMessage(q);\n      break;\n\n    case g:\n      {\n        const t = e.getBool();\n        T.exceededTransferLimit = t;\n        break;\n      }\n\n    case f:\n      t.addField(T, e.processMessage(k));\n      break;\n\n    case h:\n      w || (t.prepareFeatures(T), w = !0), t.addFeature(T, e.processMessageWithArgs(m, t, T, T.fields));\n      break;\n\n    case r:\n      T.uniqueIdField = e.processMessage(d);\n      break;\n\n    case c:\n    default:\n      e.skip();\n  }\n\n  return t.finishFeatureResult(T), T;\n}\n\nfunction S(e, s) {\n  const r = 1,\n        a = 2,\n        n = 3,\n        o = 4,\n        c = {};\n  let i = null;\n\n  for (; e.next();) switch (e.tag()) {\n    case o:\n      i = e.processMessageWithArgs(b);\n      break;\n\n    case r:\n      c.featureResult = e.processMessageWithArgs(w, s);\n      break;\n\n    case a:\n    case n:\n    default:\n      e.skip();\n  }\n\n  return t(i) && c.featureResult && s.addQueryGeometry(c, i), c;\n}\n\nfunction D(t, r) {\n  try {\n    const e = 2,\n          a = new s(new Uint8Array(t), new DataView(t)),\n          n = {};\n\n    for (; a.next();) switch (a.tag()) {\n      case e:\n        n.queryResult = a.processMessageWithArgs(S, r);\n        break;\n\n      default:\n        a.skip();\n    }\n\n    return n;\n  } catch (a) {\n    throw new e(\"query:parsing-pbf\", \"Error while parsing FeatureSet PBF payload\", {\n      error: a\n    });\n  }\n}\n\nexport { D as parseFeatureQuery, i as parseFieldType, q as parseTransform };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/rest/query/operations/pbfFeatureServiceParser.js"],"names":["e","isSome","t","s","r","OPTIMIZED_GEOMETRY_TYPES","a","n","o","c","i","length","l","g","p","geometryTypes","u","createPointGeometry","next","tag","getUInt32","pos","addCoordinatePoint","getSInt64","skip","y","createGeometry","hasZ","hasM","addLength","allocateCoordinates","addCoordinate","b","lengths","push","coords","getEnum","queryGeometry","queryGeometryType","f","getString","getFloat","getDouble","getSInt32","getInt64","getUInt64","getBool","k","type","name","alias","sqlType","defaultValue","d","isSystemMaintained","m","createFeature","attributes","processMessage","geometry","processMessageWithArgs","centroid","h","T","q","originPosition","scale","translate","I","shapeAreaFieldName","shapeLengthFieldName","units","F","createSpatialReference","wkid","wkt","latestWkid","vcsWkid","latestVcsWkid","w","createFeatureResult","geometryType","objectIdFieldName","globalIdFieldName","geohashFieldName","geometryProperties","spatialReference","transform","exceededTransferLimit","addField","prepareFeatures","addFeature","fields","uniqueIdField","finishFeatureResult","S","featureResult","addQueryGeometry","D","Uint8Array","DataView","queryResult","error","parseFeatureQuery","parseFieldType","parseTransform"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{isSome as t}from\"../../../core/maybe.js\";import s from\"../../../core/pbf.js\";import r from\"../../../layers/graphics/OptimizedGeometry.js\";import{OPTIMIZED_GEOMETRY_TYPES as a}from\"./pbfOptimizedFeatureSet.js\";const n=[\"esriFieldTypeSmallInteger\",\"esriFieldTypeInteger\",\"esriFieldTypeSingle\",\"esriFieldTypeDouble\",\"esriFieldTypeString\",\"esriFieldTypeDate\",\"esriFieldTypeOID\",\"esriFieldTypeGeometry\",\"esriFieldTypeBlob\",\"esriFieldTypeRaster\",\"esriFieldTypeGUID\",\"esriFieldTypeGlobalID\",\"esriFieldTypeXML\"],o=[\"sqlTypeBigInt\",\"sqlTypeBinary\",\"sqlTypeBit\",\"sqlTypeChar\",\"sqlTypeDate\",\"sqlTypeDecimal\",\"sqlTypeDouble\",\"sqlTypeFloat\",\"sqlTypeGeometry\",\"sqlTypeGUID\",\"sqlTypeInteger\",\"sqlTypeLongNVarchar\",\"sqlTypeLongVarbinary\",\"sqlTypeLongVarchar\",\"sqlTypeNChar\",\"sqlTypeNVarchar\",\"sqlTypeOther\",\"sqlTypeReal\",\"sqlTypeSmallInt\",\"sqlTypeSqlXml\",\"sqlTypeTime\",\"sqlTypeTimestamp\",\"sqlTypeTimestamp2\",\"sqlTypeTinyInt\",\"sqlTypeVarbinary\",\"sqlTypeVarchar\"],c=[\"upperLeft\",\"lowerLeft\"];function i(e){return e>=n.length?null:n[e]}function l(e){return e>=o.length?null:o[e]}function g(e){return e>=c.length?null:c[e]}function p(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function u(e,t,s){const r=1,a=2,n=3,o=t.createPointGeometry(s);for(;e.next();)switch(e.tag()){case n:{const s=e.getUInt32(),r=e.pos()+s;let a=0;for(;e.pos()<r;)t.addCoordinatePoint(o,e.getSInt64(),a++);break}case r:case a:default:e.skip()}return o}function y(e,t,s){const r=1,a=2,n=3,o=t.createGeometry(s),c=2+(s.hasZ?1:0)+(s.hasM?1:0);for(;e.next();)switch(e.tag()){case a:{const s=e.getUInt32(),r=e.pos()+s;let a=0;for(;e.pos()<r;)t.addLength(o,e.getUInt32(),a++);break}case n:{const s=e.getUInt32(),r=e.pos()+s;let a=0;for(t.allocateCoordinates(o);e.pos()<r;)t.addCoordinate(o,e.getSInt64(),a),a++,a===c&&(a=0);break}case r:default:e.skip()}return o}function b(e){const t=1,s=2,n=3,o=new r;let c=\"esriGeometryPoint\";for(;e.next();)switch(e.tag()){case s:{const t=e.getUInt32(),s=e.pos()+t;for(;e.pos()<s;)o.lengths.push(e.getUInt32());break}case n:{const t=e.getUInt32(),s=e.pos()+t;for(;e.pos()<s;)o.coords.push(e.getSInt64());break}case t:c=a[e.getEnum()];break;default:e.skip()}return{queryGeometry:o,queryGeometryType:c}}function f(e){const t=1,s=2,r=3,a=4,n=5,o=6,c=7,i=8,l=9;for(;e.next();)switch(e.tag()){case t:return e.getString();case s:return e.getFloat();case r:return e.getDouble();case a:return e.getSInt32();case n:return e.getUInt32();case o:return e.getInt64();case c:return e.getUInt64();case i:return e.getSInt64();case l:return e.getBool();default:return e.skip(),null}return null}function k(e){const t=1,s=2,r=3,a=4,n=5,o=6,c={type:i(0)};for(;e.next();)switch(e.tag()){case t:c.name=e.getString();break;case s:c.type=i(e.getEnum());break;case r:c.alias=e.getString();break;case a:c.sqlType=l(e.getEnum());break;case n:e.skip();break;case o:c.defaultValue=e.getString();break;default:e.skip()}return c}function d(e){const t=1,s=2,r={};for(;e.next();)switch(e.tag()){case t:r.name=e.getString();break;case s:r.isSystemMaintained=e.getBool();break;default:e.skip()}return r}function m(e,t,s,r){const a=1,n=2,o=4,c=t.createFeature(s);let i=0;for(;e.next();)switch(e.tag()){case a:{const t=r[i++].name;c.attributes[t]=e.processMessage(f);break}case n:c.geometry=e.processMessageWithArgs(y,t,s);break;case o:c.centroid=e.processMessageWithArgs(u,t,s);break;default:e.skip()}return c}function h(e){const t=1,s=2,r=3,a=4,n=[1,1,1,1];for(;e.next();)switch(e.tag()){case t:n[0]=e.getDouble();break;case s:n[1]=e.getDouble();break;case a:n[2]=e.getDouble();break;case r:n[3]=e.getDouble();break;default:e.skip()}return n}function T(e){const t=1,s=2,r=3,a=4,n=[0,0,0,0];for(;e.next();)switch(e.tag()){case t:n[0]=e.getDouble();break;case s:n[1]=e.getDouble();break;case a:n[2]=e.getDouble();break;case r:n[3]=e.getDouble();break;default:e.skip()}return n}function q(e){const t=1,s=2,r=3,a={originPosition:g(0)};for(;e.next();)switch(e.tag()){case t:a.originPosition=g(e.getEnum());break;case s:a.scale=e.processMessage(h);break;case r:a.translate=e.processMessage(T);break;default:e.skip()}return a}function I(e){const t=1,s=2,r=3,a={};for(;e.next();)switch(e.tag()){case t:a.shapeAreaFieldName=e.getString();break;case s:a.shapeLengthFieldName=e.getString();break;case r:a.units=e.getString();break;default:e.skip()}return a}function F(e,t){const s=1,r=2,a=3,n=4,o=5,c=t.createSpatialReference();for(;e.next();)switch(e.tag()){case s:c.wkid=e.getUInt32();break;case o:c.wkt=e.getString();break;case r:c.latestWkid=e.getUInt32();break;case a:c.vcsWkid=e.getUInt32();break;case n:c.latestVcsWkid=e.getUInt32();break;default:e.skip()}return c}function w(e,t){const s=1,r=2,a=3,n=4,o=5,c=6,i=7,l=8,g=9,u=10,y=11,b=12,f=13,h=15,T=t.createFeatureResult();T.geometryType=p(t,0);let w=!1;for(;e.next();)switch(e.tag()){case s:T.objectIdFieldName=e.getString();break;case a:T.globalIdFieldName=e.getString();break;case n:T.geohashFieldName=e.getString();break;case o:T.geometryProperties=e.processMessage(I);break;case i:T.geometryType=p(t,e.getEnum());break;case l:T.spatialReference=e.processMessageWithArgs(F,t);break;case u:T.hasZ=e.getBool();break;case y:T.hasM=e.getBool();break;case b:T.transform=e.processMessage(q);break;case g:{const t=e.getBool();T.exceededTransferLimit=t;break}case f:t.addField(T,e.processMessage(k));break;case h:w||(t.prepareFeatures(T),w=!0),t.addFeature(T,e.processMessageWithArgs(m,t,T,T.fields));break;case r:T.uniqueIdField=e.processMessage(d);break;case c:default:e.skip()}return t.finishFeatureResult(T),T}function S(e,s){const r=1,a=2,n=3,o=4,c={};let i=null;for(;e.next();)switch(e.tag()){case o:i=e.processMessageWithArgs(b);break;case r:c.featureResult=e.processMessageWithArgs(w,s);break;case a:case n:default:e.skip()}return t(i)&&c.featureResult&&s.addQueryGeometry(c,i),c}function D(t,r){try{const e=2,a=new s(new Uint8Array(t),new DataView(t)),n={};for(;a.next();)switch(a.tag()){case e:n.queryResult=a.processMessageWithArgs(S,r);break;default:a.skip()}return n}catch(a){throw new e(\"query:parsing-pbf\",\"Error while parsing FeatureSet PBF payload\",{error:a})}}export{D as parseFeatureQuery,i as parseFieldType,q as parseTransform};\n"]},"metadata":{},"sourceType":"module"}