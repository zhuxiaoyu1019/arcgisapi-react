{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../../../chunks/tslib.es6.js\";\nimport { sign as i } from \"../../../../../core/mathUtils.js\";\nimport { createScreenPointArray as r } from \"../../../../../core/screenUtils.js\";\nimport { property as s } from \"../../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../../core/has.js\";\nimport \"../../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../../core/Logger.js\";\nimport { subclass as e } from \"../../../../../core/accessorSupport/decorators/subclass.js\";\nimport { c as a } from \"../../../../../chunks/vec2.js\";\nimport { a as o } from \"../../../../../chunks/vec2f64.js\";\nimport { f as n, n as h, a as m, b as c, o as p, g as l, l as u, e as P } from \"../../../../../chunks/vec3.js\";\nimport { c as C } from \"../../../../../chunks/vec3f64.js\";\nimport { create as v, fromPositionAndNormal as D } from \"../../../../../geometry/support/plane.js\";\nimport { pixelDistanceToInteractionFactor as f, applyAll as y } from \"../../../camera/constraintUtils.js\";\nimport { InteractiveController as d } from \"../InteractiveController.js\";\nimport { normalizeCoordinate as g, intersectPlaneFromScreenPoint as j } from \"../../utils/navigationUtils.js\";\nconst w = 30,\n      N = 70;\nlet O = class extends d {\n  constructor(t) {\n    super(t), this.view = null, this.tmpP = C(), this.tmpDir = C(), this.tmpN = C(), this.tmpP0 = o(), this.tmpPoi = C(), this.tmpRayDir = C(), this.dragBeginPoint = r(), this.normalizedAnchorPoint = o(), this.constraintOptions = {\n      selection: 15,\n      interactionType: 1,\n      interactionFactor: 0,\n      interactionStartCamera: null,\n      interactionDirection: C(),\n      tiltMode: 0\n    }, this.plane = v();\n  }\n\n  get intersectionHelper() {\n    return this.view.sceneIntersectionHelper;\n  }\n\n  begin(t) {\n    if (!this.active) return;\n    let i;\n    a(this.dragBeginPoint, t), g(this.startCamera, t, this.normalizedAnchorPoint), this.intersectionHelper.intersectScreenFreePointFallback(t, this.tmpP), n(this.tmpDir, this.tmpP, this.startCamera.eye), h(this.tmpDir, this.tmpDir), this.view.camera.position.hasZ && (i = Math.abs(this.view.camera.position.z));\n    let r = w * i;\n\n    const s = this.view._stage.renderView.getMinimalDepthForArea(t[0], t[1], this.view.state.camera, N);\n\n    r = r > s ? s : r, m(this.tmpDir, this.tmpDir, r), c(this.tmpP, this.startCamera.eye, this.tmpDir), n(this.tmpN, this.startCamera.eye, this.startCamera.center), h(this.tmpN, this.tmpN), this.tmpN[1] < 0 && p(this.tmpN, this.tmpN), D(this.tmpP, this.tmpN, this.plane), this.constraintOptions.interactionStartCamera = this.startCamera;\n  }\n\n  update(t) {\n    if (!this.active) return;\n    j(this.plane, this.currentCamera, this.dragBeginPoint, this.tmpPoi) || l(this.tmpPoi, this.currentCamera.center), g(this.currentCamera, t, this.tmpP0);\n    let r = 4 * (this.tmpP0[1] - this.normalizedAnchorPoint[1]);\n    a(this.normalizedAnchorPoint, this.tmpP0), n(this.tmpRayDir, this.tmpPoi, this.currentCamera.eye);\n    const s = u(this.tmpRayDir);\n    let e = s * (1 - r);\n    l(this.constraintOptions.interactionDirection, this.tmpRayDir), m(this.constraintOptions.interactionDirection, this.constraintOptions.interactionDirection, i(r) / s);\n    const o = this.view.state.constraints.minimumPoiDistance;\n    r >= 0 && e < o && (e = o, r = -(e - s) / s), Math.abs(s - e) < 1e-6 || (m(this.tmpRayDir, this.tmpRayDir, r), this.currentCamera.eye = c(b, this.currentCamera.eye, this.tmpRayDir), P(b, this.currentCamera.center, this.tmpPoi, r), this.tmpPoi[2] > this.startCamera.center[2] ? b[2] = Math.max(this.startCamera.center[2], b[2]) : b[2] = Math.min(this.startCamera.center[2], b[2]), this.currentCamera.center = b, this.constraintOptions.interactionFactor = f(this.dragBeginPoint, t), y(this.view, this.currentCamera, this.constraintOptions));\n  }\n\n  end() {\n    this.active && this.finishController();\n  }\n\n};\nt([s({\n  constructOnly: !0\n})], O.prototype, \"view\", void 0), O = t([e(\"esri.views.3d.state.controllers.local.ZoomController\")], O);\nconst b = C();\nexport { O as ZoomController };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/state/controllers/local/ZoomController.js"],"names":["_","t","sign","i","createScreenPointArray","r","property","s","subclass","e","c","a","o","f","n","h","m","b","p","g","l","u","P","C","create","v","fromPositionAndNormal","D","pixelDistanceToInteractionFactor","applyAll","y","InteractiveController","d","normalizeCoordinate","intersectPlaneFromScreenPoint","j","w","N","O","constructor","view","tmpP","tmpDir","tmpN","tmpP0","tmpPoi","tmpRayDir","dragBeginPoint","normalizedAnchorPoint","constraintOptions","selection","interactionType","interactionFactor","interactionStartCamera","interactionDirection","tiltMode","plane","intersectionHelper","sceneIntersectionHelper","begin","active","startCamera","intersectScreenFreePointFallback","eye","camera","position","hasZ","Math","abs","z","_stage","renderView","getMinimalDepthForArea","state","center","update","currentCamera","constraints","minimumPoiDistance","max","min","end","finishController","constructOnly","prototype","ZoomController"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../../chunks/tslib.es6.js\";import{sign as i}from\"../../../../../core/mathUtils.js\";import{createScreenPointArray as r}from\"../../../../../core/screenUtils.js\";import{property as s}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as e}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{c as a}from\"../../../../../chunks/vec2.js\";import{a as o}from\"../../../../../chunks/vec2f64.js\";import{f as n,n as h,a as m,b as c,o as p,g as l,l as u,e as P}from\"../../../../../chunks/vec3.js\";import{c as C}from\"../../../../../chunks/vec3f64.js\";import{create as v,fromPositionAndNormal as D}from\"../../../../../geometry/support/plane.js\";import{pixelDistanceToInteractionFactor as f,applyAll as y}from\"../../../camera/constraintUtils.js\";import{InteractiveController as d}from\"../InteractiveController.js\";import{normalizeCoordinate as g,intersectPlaneFromScreenPoint as j}from\"../../utils/navigationUtils.js\";const w=30,N=70;let O=class extends d{constructor(t){super(t),this.view=null,this.tmpP=C(),this.tmpDir=C(),this.tmpN=C(),this.tmpP0=o(),this.tmpPoi=C(),this.tmpRayDir=C(),this.dragBeginPoint=r(),this.normalizedAnchorPoint=o(),this.constraintOptions={selection:15,interactionType:1,interactionFactor:0,interactionStartCamera:null,interactionDirection:C(),tiltMode:0},this.plane=v()}get intersectionHelper(){return this.view.sceneIntersectionHelper}begin(t){if(!this.active)return;let i;a(this.dragBeginPoint,t),g(this.startCamera,t,this.normalizedAnchorPoint),this.intersectionHelper.intersectScreenFreePointFallback(t,this.tmpP),n(this.tmpDir,this.tmpP,this.startCamera.eye),h(this.tmpDir,this.tmpDir),this.view.camera.position.hasZ&&(i=Math.abs(this.view.camera.position.z));let r=w*i;const s=this.view._stage.renderView.getMinimalDepthForArea(t[0],t[1],this.view.state.camera,N);r=r>s?s:r,m(this.tmpDir,this.tmpDir,r),c(this.tmpP,this.startCamera.eye,this.tmpDir),n(this.tmpN,this.startCamera.eye,this.startCamera.center),h(this.tmpN,this.tmpN),this.tmpN[1]<0&&p(this.tmpN,this.tmpN),D(this.tmpP,this.tmpN,this.plane),this.constraintOptions.interactionStartCamera=this.startCamera}update(t){if(!this.active)return;j(this.plane,this.currentCamera,this.dragBeginPoint,this.tmpPoi)||l(this.tmpPoi,this.currentCamera.center),g(this.currentCamera,t,this.tmpP0);let r=4*(this.tmpP0[1]-this.normalizedAnchorPoint[1]);a(this.normalizedAnchorPoint,this.tmpP0),n(this.tmpRayDir,this.tmpPoi,this.currentCamera.eye);const s=u(this.tmpRayDir);let e=s*(1-r);l(this.constraintOptions.interactionDirection,this.tmpRayDir),m(this.constraintOptions.interactionDirection,this.constraintOptions.interactionDirection,i(r)/s);const o=this.view.state.constraints.minimumPoiDistance;r>=0&&e<o&&(e=o,r=-(e-s)/s),Math.abs(s-e)<1e-6||(m(this.tmpRayDir,this.tmpRayDir,r),this.currentCamera.eye=c(b,this.currentCamera.eye,this.tmpRayDir),P(b,this.currentCamera.center,this.tmpPoi,r),this.tmpPoi[2]>this.startCamera.center[2]?b[2]=Math.max(this.startCamera.center[2],b[2]):b[2]=Math.min(this.startCamera.center[2],b[2]),this.currentCamera.center=b,this.constraintOptions.interactionFactor=f(this.dragBeginPoint,t),y(this.view,this.currentCamera,this.constraintOptions))}end(){this.active&&this.finishController()}};t([s({constructOnly:!0})],O.prototype,\"view\",void 0),O=t([e(\"esri.views.3d.state.controllers.local.ZoomController\")],O);const b=C();export{O as ZoomController};\n"]},"metadata":{},"sourceType":"module"}