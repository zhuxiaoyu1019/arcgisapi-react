{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { AsyncUpdateMixin as r } from \"../../../../core/AsyncUpdate.js\";\nimport { HandleOwner as s } from \"../../../../core/HandleOwner.js\";\nimport t from \"../../../../core/Logger.js\";\nimport { unwrapOr as i } from \"../../../../core/maybe.js\";\nimport { property as o } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as l } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { fixFields as d, collectLabelingFields as n, collectFilterFields as a } from \"../../../../layers/support/fieldUtils.js\";\nconst p = t.getLogger(\"esri.views.3d.layers.support.SceneLayerViewRequiredFields\");\nlet c = class extends r(s) {\n  constructor(e) {\n    super(e);\n  }\n\n  get requiredFields() {\n    const {\n      layerView: {\n        layer: {\n          fieldsIndex: e\n        },\n        definitionExpressionFields: r\n      },\n      rendererFields: s,\n      labelingFields: t,\n      viewFilterFields: o\n    } = this;\n    return d(e, [...i(r, []), ...i(s, []), ...i(t, []), ...i(o, [])]);\n  }\n\n  initialize() {\n    const e = this.layerView.layer;\n    this.layer = e, this.handles.add([this.autoUpdateAsync(\"rendererFields\", () => {\n      const {\n        fieldsIndex: e,\n        renderer: r\n      } = this.layer;\n      return r ? y(s => r.collectRequiredFields(s, e)) : null;\n    }), this.autoUpdateAsync(\"labelingFields\", () => {\n      const {\n        layer: e\n      } = this;\n      return e.labelsVisible ? y(r => n(r, e)) : null;\n    }), this.autoUpdateAsync(\"viewFilterFields\", () => {\n      const {\n        layer: e,\n        filter: r\n      } = this.layerView;\n      return y(s => a(s, e, r));\n    })]);\n  }\n\n};\n\nasync function y(e) {\n  const r = new Set();\n\n  try {\n    return await e(r), Array.from(r).sort();\n  } catch (s) {\n    return p.error(s), null;\n  }\n}\n\ne([o()], c.prototype, \"layerView\", void 0), e([o()], c.prototype, \"layer\", void 0), e([o()], c.prototype, \"requiredFields\", null), e([o()], c.prototype, \"rendererFields\", void 0), e([o()], c.prototype, \"labelingFields\", void 0), e([o()], c.prototype, \"viewFilterFields\", void 0), c = e([l(\"esri.views.3d.layers.support.SceneLayerViewRequiredFields\")], c);\nexport { c as SceneLayerViewRequiredFields };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/layers/support/SceneLayerViewRequiredFields.js"],"names":["_","e","AsyncUpdateMixin","r","HandleOwner","s","t","unwrapOr","i","property","o","subclass","l","fixFields","d","collectLabelingFields","n","collectFilterFields","a","p","getLogger","c","constructor","requiredFields","layerView","layer","fieldsIndex","definitionExpressionFields","rendererFields","labelingFields","viewFilterFields","initialize","handles","add","autoUpdateAsync","renderer","y","collectRequiredFields","labelsVisible","filter","Set","Array","from","sort","error","prototype","SceneLayerViewRequiredFields"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{AsyncUpdateMixin as r}from\"../../../../core/AsyncUpdate.js\";import{HandleOwner as s}from\"../../../../core/HandleOwner.js\";import t from\"../../../../core/Logger.js\";import{unwrapOr as i}from\"../../../../core/maybe.js\";import{property as o}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{fixFields as d,collectLabelingFields as n,collectFilterFields as a}from\"../../../../layers/support/fieldUtils.js\";const p=t.getLogger(\"esri.views.3d.layers.support.SceneLayerViewRequiredFields\");let c=class extends(r(s)){constructor(e){super(e)}get requiredFields(){const{layerView:{layer:{fieldsIndex:e},definitionExpressionFields:r},rendererFields:s,labelingFields:t,viewFilterFields:o}=this;return d(e,[...i(r,[]),...i(s,[]),...i(t,[]),...i(o,[])])}initialize(){const e=this.layerView.layer;this.layer=e,this.handles.add([this.autoUpdateAsync(\"rendererFields\",(()=>{const{fieldsIndex:e,renderer:r}=this.layer;return r?y((s=>r.collectRequiredFields(s,e))):null})),this.autoUpdateAsync(\"labelingFields\",(()=>{const{layer:e}=this;return e.labelsVisible?y((r=>n(r,e))):null})),this.autoUpdateAsync(\"viewFilterFields\",(()=>{const{layer:e,filter:r}=this.layerView;return y((s=>a(s,e,r)))}))])}};async function y(e){const r=new Set;try{return await e(r),Array.from(r).sort()}catch(s){return p.error(s),null}}e([o()],c.prototype,\"layerView\",void 0),e([o()],c.prototype,\"layer\",void 0),e([o()],c.prototype,\"requiredFields\",null),e([o()],c.prototype,\"rendererFields\",void 0),e([o()],c.prototype,\"labelingFields\",void 0),e([o()],c.prototype,\"viewFilterFields\",void 0),c=e([l(\"esri.views.3d.layers.support.SceneLayerViewRequiredFields\")],c);export{c as SceneLayerViewRequiredFields};\n"]},"metadata":{},"sourceType":"module"}