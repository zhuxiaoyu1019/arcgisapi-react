{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport t from \"../core/Error.js\";\nimport r from \"../core/Handles.js\";\nimport { get as o, isSome as i, isNone as s } from \"../core/maybe.js\";\nimport { MultiOriginJSONMixin as a } from \"../core/MultiOriginJSONSupport.js\";\nimport { throwIfAbortError as n } from \"../core/promiseUtils.js\";\nimport { on as p } from \"../core/watchUtils.js\";\nimport { property as d } from \"../core/accessorSupport/decorators/property.js\";\nimport \"../core/has.js\";\nimport \"../core/accessorSupport/ensureType.js\";\nimport \"../core/Logger.js\";\nimport { reader as m } from \"../core/accessorSupport/decorators/reader.js\";\nimport { subclass as c } from \"../core/accessorSupport/decorators/subclass.js\";\nimport { persistable as y } from \"../core/accessorSupport/decorators/persistable.js\";\nimport l from \"./Layer.js\";\nimport { APIKeyMixin as h } from \"./mixins/APIKeyMixin.js\";\nimport { ArcGISService as f } from \"./mixins/ArcGISService.js\";\nimport { OperationalLayer as u } from \"./mixins/OperationalLayer.js\";\nimport { PortalLayer as v } from \"./mixins/PortalLayer.js\";\nimport { ScaleRangeLayer as g } from \"./mixins/ScaleRangeLayer.js\";\nimport { SceneService as S } from \"./mixins/SceneService.js\";\nimport { elevationInfo as j } from \"./support/commonProperties.js\";\nimport { I3SNodePageDefinition as w, I3SMaterialDefinition as T, I3STextureSetDefinition as x, I3SGeometryDefinition as L } from \"./support/I3SLayerDefinitions.js\";\nimport _ from \"./support/SceneModifications.js\";\nimport { f as I } from \"../chunks/persistableUrlUtils.js\";\nlet O = class extends S(f(u(v(g(a(h(l))))))) {\n  constructor(...e) {\n    super(...e), this.handles = new r(), this.geometryType = \"mesh\", this.operationalLayerType = \"IntegratedMeshLayer\", this.type = \"integrated-mesh\", this.nodePages = null, this.materialDefinitions = null, this.textureSetDefinitions = null, this.geometryDefinitions = null, this.serviceUpdateTimeStamp = null, this.profile = \"mesh-pyramids\", this.modifications = null, this._modificationsSource = null, this.elevationInfo = null, this.path = null;\n  }\n\n  destroy() {\n    this.handles.destroy();\n  }\n\n  initialize() {\n    this.handles.add(p(this, \"modifications\", \"after-changes\", () => this.modifications = this.modifications, null, null, !0));\n  }\n\n  normalizeCtorArgs(e, t) {\n    return \"string\" == typeof e ? {\n      url: e,\n      ...t\n    } : e;\n  }\n\n  readModifications(e, t, r) {\n    this._modificationsSource = {\n      url: I(e, r),\n      context: r\n    };\n  }\n\n  async load(e) {\n    return this.addResolvingPromise(this._doLoad(e)), this;\n  }\n\n  async _doLoad(e) {\n    const t = o(e, \"signal\");\n\n    try {\n      await this.loadFromPortal({\n        supportedTypes: [\"Scene Service\"]\n      }, e);\n    } catch (r) {\n      n(r);\n    }\n\n    if (await this._fetchService(t), i(this._modificationsSource)) {\n      const t = await _.fromUrl(this._modificationsSource.url, this.spatialReference, e);\n      this.setAtOrigin(\"modifications\", t, this._modificationsSource.context.origin), this._modificationsSource = null;\n    }\n\n    await this._fetchIndexAndUpdateExtent(this.nodePages, t);\n  }\n\n  beforeSave() {\n    if (!s(this._modificationsSource)) return this.load().then(() => {}, () => {});\n  }\n\n  async saveAs(e, t) {\n    return this._debouncedSaveOperations(1, { ...t,\n      getTypeKeywords: () => this._getTypeKeywords(),\n      portalItemLayerType: \"integrated-mesh\"\n    }, e);\n  }\n\n  async save() {\n    const e = {\n      getTypeKeywords: () => this._getTypeKeywords(),\n      portalItemLayerType: \"integrated-mesh\"\n    };\n    return this._debouncedSaveOperations(0, e);\n  }\n\n  validateLayer(e) {\n    if (e.layerType && \"IntegratedMesh\" !== e.layerType) throw new t(\"integrated-mesh-layer:layer-type-not-supported\", \"IntegratedMeshLayer does not support this layer type\", {\n      layerType: e.layerType\n    });\n    if (isNaN(this.version.major) || isNaN(this.version.minor)) throw new t(\"layer:service-version-not-supported\", \"Service version is not supported.\", {\n      serviceVersion: this.version.versionString,\n      supportedVersions: \"1.x\"\n    });\n    if (this.version.major > 1) throw new t(\"layer:service-version-too-new\", \"Service version is too new.\", {\n      serviceVersion: this.version.versionString,\n      supportedVersions: \"1.x\"\n    });\n  }\n\n  _getTypeKeywords() {\n    return [\"IntegratedMeshLayer\"];\n  }\n\n};\ne([d({\n  type: String,\n  readOnly: !0\n})], O.prototype, \"geometryType\", void 0), e([d({\n  type: [\"show\", \"hide\"]\n})], O.prototype, \"listMode\", void 0), e([d({\n  type: [\"IntegratedMeshLayer\"]\n})], O.prototype, \"operationalLayerType\", void 0), e([d({\n  json: {\n    read: !1\n  },\n  readOnly: !0\n})], O.prototype, \"type\", void 0), e([d({\n  type: w,\n  readOnly: !0\n})], O.prototype, \"nodePages\", void 0), e([d({\n  type: [T],\n  readOnly: !0\n})], O.prototype, \"materialDefinitions\", void 0), e([d({\n  type: [x],\n  readOnly: !0\n})], O.prototype, \"textureSetDefinitions\", void 0), e([d({\n  type: [L],\n  readOnly: !0\n})], O.prototype, \"geometryDefinitions\", void 0), e([d({\n  readOnly: !0\n})], O.prototype, \"serviceUpdateTimeStamp\", void 0), e([d({\n  type: _\n}), y({\n  origins: [\"web-scene\", \"portal-item\"],\n  type: \"resource\",\n  prefix: \"modifications\"\n})], O.prototype, \"modifications\", void 0), e([m([\"web-scene\", \"portal-item\"], \"modifications\")], O.prototype, \"readModifications\", null), e([d(j)], O.prototype, \"elevationInfo\", void 0), e([d({\n  type: String,\n  json: {\n    origins: {\n      \"web-scene\": {\n        read: !0,\n        write: !0\n      },\n      \"portal-item\": {\n        read: !0,\n        write: !0\n      }\n    },\n    read: !1\n  }\n})], O.prototype, \"path\", void 0), O = e([c(\"esri.layers.IntegratedMeshLayer\")], O);\nvar M = O;\nexport default M;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/layers/IntegratedMeshLayer.js"],"names":["_","e","t","r","get","o","isSome","i","isNone","s","MultiOriginJSONMixin","a","throwIfAbortError","n","on","p","property","d","reader","m","subclass","c","persistable","y","l","APIKeyMixin","h","ArcGISService","f","OperationalLayer","u","PortalLayer","v","ScaleRangeLayer","g","SceneService","S","elevationInfo","j","I3SNodePageDefinition","w","I3SMaterialDefinition","T","I3STextureSetDefinition","x","I3SGeometryDefinition","L","I","O","constructor","handles","geometryType","operationalLayerType","type","nodePages","materialDefinitions","textureSetDefinitions","geometryDefinitions","serviceUpdateTimeStamp","profile","modifications","_modificationsSource","path","destroy","initialize","add","normalizeCtorArgs","url","readModifications","context","load","addResolvingPromise","_doLoad","loadFromPortal","supportedTypes","_fetchService","fromUrl","spatialReference","setAtOrigin","origin","_fetchIndexAndUpdateExtent","beforeSave","then","saveAs","_debouncedSaveOperations","getTypeKeywords","_getTypeKeywords","portalItemLayerType","save","validateLayer","layerType","isNaN","version","major","minor","serviceVersion","versionString","supportedVersions","String","readOnly","prototype","json","read","origins","prefix","write","M"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import t from\"../core/Error.js\";import r from\"../core/Handles.js\";import{get as o,isSome as i,isNone as s}from\"../core/maybe.js\";import{MultiOriginJSONMixin as a}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as n}from\"../core/promiseUtils.js\";import{on as p}from\"../core/watchUtils.js\";import{property as d}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{reader as m}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as c}from\"../core/accessorSupport/decorators/subclass.js\";import{persistable as y}from\"../core/accessorSupport/decorators/persistable.js\";import l from\"./Layer.js\";import{APIKeyMixin as h}from\"./mixins/APIKeyMixin.js\";import{ArcGISService as f}from\"./mixins/ArcGISService.js\";import{OperationalLayer as u}from\"./mixins/OperationalLayer.js\";import{PortalLayer as v}from\"./mixins/PortalLayer.js\";import{ScaleRangeLayer as g}from\"./mixins/ScaleRangeLayer.js\";import{SceneService as S}from\"./mixins/SceneService.js\";import{elevationInfo as j}from\"./support/commonProperties.js\";import{I3SNodePageDefinition as w,I3SMaterialDefinition as T,I3STextureSetDefinition as x,I3SGeometryDefinition as L}from\"./support/I3SLayerDefinitions.js\";import _ from\"./support/SceneModifications.js\";import{f as I}from\"../chunks/persistableUrlUtils.js\";let O=class extends(S(f(u(v(g(a(h(l)))))))){constructor(...e){super(...e),this.handles=new r,this.geometryType=\"mesh\",this.operationalLayerType=\"IntegratedMeshLayer\",this.type=\"integrated-mesh\",this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.profile=\"mesh-pyramids\",this.modifications=null,this._modificationsSource=null,this.elevationInfo=null,this.path=null}destroy(){this.handles.destroy()}initialize(){this.handles.add(p(this,\"modifications\",\"after-changes\",(()=>this.modifications=this.modifications),null,null,!0))}normalizeCtorArgs(e,t){return\"string\"==typeof e?{url:e,...t}:e}readModifications(e,t,r){this._modificationsSource={url:I(e,r),context:r}}async load(e){return this.addResolvingPromise(this._doLoad(e)),this}async _doLoad(e){const t=o(e,\"signal\");try{await this.loadFromPortal({supportedTypes:[\"Scene Service\"]},e)}catch(r){n(r)}if(await this._fetchService(t),i(this._modificationsSource)){const t=await _.fromUrl(this._modificationsSource.url,this.spatialReference,e);this.setAtOrigin(\"modifications\",t,this._modificationsSource.context.origin),this._modificationsSource=null}await this._fetchIndexAndUpdateExtent(this.nodePages,t)}beforeSave(){if(!s(this._modificationsSource))return this.load().then((()=>{}),(()=>{}))}async saveAs(e,t){return this._debouncedSaveOperations(1,{...t,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:\"integrated-mesh\"},e)}async save(){const e={getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:\"integrated-mesh\"};return this._debouncedSaveOperations(0,e)}validateLayer(e){if(e.layerType&&\"IntegratedMesh\"!==e.layerType)throw new t(\"integrated-mesh-layer:layer-type-not-supported\",\"IntegratedMeshLayer does not support this layer type\",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new t(\"layer:service-version-not-supported\",\"Service version is not supported.\",{serviceVersion:this.version.versionString,supportedVersions:\"1.x\"});if(this.version.major>1)throw new t(\"layer:service-version-too-new\",\"Service version is too new.\",{serviceVersion:this.version.versionString,supportedVersions:\"1.x\"})}_getTypeKeywords(){return[\"IntegratedMeshLayer\"]}};e([d({type:String,readOnly:!0})],O.prototype,\"geometryType\",void 0),e([d({type:[\"show\",\"hide\"]})],O.prototype,\"listMode\",void 0),e([d({type:[\"IntegratedMeshLayer\"]})],O.prototype,\"operationalLayerType\",void 0),e([d({json:{read:!1},readOnly:!0})],O.prototype,\"type\",void 0),e([d({type:w,readOnly:!0})],O.prototype,\"nodePages\",void 0),e([d({type:[T],readOnly:!0})],O.prototype,\"materialDefinitions\",void 0),e([d({type:[x],readOnly:!0})],O.prototype,\"textureSetDefinitions\",void 0),e([d({type:[L],readOnly:!0})],O.prototype,\"geometryDefinitions\",void 0),e([d({readOnly:!0})],O.prototype,\"serviceUpdateTimeStamp\",void 0),e([d({type:_}),y({origins:[\"web-scene\",\"portal-item\"],type:\"resource\",prefix:\"modifications\"})],O.prototype,\"modifications\",void 0),e([m([\"web-scene\",\"portal-item\"],\"modifications\")],O.prototype,\"readModifications\",null),e([d(j)],O.prototype,\"elevationInfo\",void 0),e([d({type:String,json:{origins:{\"web-scene\":{read:!0,write:!0},\"portal-item\":{read:!0,write:!0}},read:!1}})],O.prototype,\"path\",void 0),O=e([c(\"esri.layers.IntegratedMeshLayer\")],O);var M=O;export default M;\n"]},"metadata":{},"sourceType":"module"}