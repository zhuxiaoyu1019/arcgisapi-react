{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../../../../core/RandomLCG.js\";\nimport \"../../../../webgl/BufferObject.js\";\nimport \"../../../../webgl/FramebufferObject.js\";\nimport \"../../../../../core/has.js\";\nimport \"../../../../webgl/enums.js\";\nimport \"../../../../webgl/RenderingContext.js\";\nimport \"../../../../../chunks/builtins.js\";\nimport t from \"../../../../webgl/Texture.js\";\nimport \"../../../../webgl/VertexArrayObject.js\";\nimport { TEXTURE_BINDING_RENDERER_0 as o, TEXTURE_BINDING_RENDERER_1 as i, TILE_SIZE as r } from \"../definitions.js\";\nimport { WGLGeometryType as s } from \"../enums.js\";\nimport { createProgramDescriptor as a } from \"../Utils.js\";\nimport n from \"./WGLGeometryBrush.js\";\nimport { FillMaterialKey as l } from \"../materialKey/MaterialKey.js\";\n\nconst u = e => a(e.data, {\n  geometry: [{\n    location: 0,\n    name: \"a_pos\",\n    count: 2,\n    type: 5122\n  }, {\n    location: 1,\n    name: \"a_id\",\n    count: 4,\n    type: 5121\n  }, ...(e.dotDensity ? [] : [{\n    location: 2,\n    name: \"a_color\",\n    count: 4,\n    type: 5121,\n    normalized: !0\n  }, {\n    location: 3,\n    name: \"a_tlbr\",\n    count: 4,\n    type: 5123\n  }, {\n    location: 4,\n    name: \"a_aux1\",\n    count: 4,\n    type: 5121\n  }, {\n    location: 5,\n    name: \"a_aux2\",\n    count: 2,\n    type: 5123\n  }, {\n    location: 6,\n    name: \"a_aux3\",\n    count: 4,\n    type: 5121\n  }, {\n    location: 7,\n    name: \"a_zoomRange\",\n    count: 2,\n    type: 5123\n  }]), ...(e.dotDensity ? [{\n    location: 2,\n    name: \"a_inverseArea\",\n    count: 1,\n    type: 5126\n  }] : [])]\n});\n\nclass d extends n {\n  constructor() {\n    super(...arguments), this._dotTextureSize = 0, this._dotTextures = null, this._dotSamplers = new Int32Array([o, i]);\n  }\n\n  dispose() {\n    this._disposeTextures();\n  }\n\n  getGeometryType() {\n    return s.FILL;\n  }\n\n  drawGeometry(e, t, o, i) {\n    const {\n      context: s,\n      painter: a,\n      rendererInfo: n,\n      requiredLevel: d\n    } = e,\n          m = l.load(o.materialKey),\n          {\n      bufferLayouts: c,\n      attributes: f\n    } = u(m),\n          _ = a.materialManager.getMaterialProgram(e, m, \"materials/fill\", f, i);\n\n    if (s.useProgram(_), this._setSharedUniforms(_, e, t), m.textureBinding) {\n      a.textureManager.bindTextures(s, _, m);\n      const o = 1 / 2 ** (d - t.key.level) / e.pixelRatio;\n\n      _.setUniform1f(\"u_zoomFactor\", o);\n    }\n\n    if (m.vvColor && (_.setUniform1fv(\"u_vvColorValues\", n.vvColorValues), _.setUniform4fv(\"u_vvColors\", n.vvColors)), m.vvOpacity && (_.setUniform1fv(\"u_vvOpacityValues\", n.vvOpacityValues), _.setUniform1fv(\"u_vvOpacities\", n.vvOpacities)), m.dotDensity) {\n      const o = r / n.ddDotSize,\n            i = o * window.devicePixelRatio * o * window.devicePixelRatio,\n            a = 1 / 2 ** (d - t.key.level),\n            l = 1 / a * (1 / a),\n            u = n.ddDotScale ? e.state.scale / n.ddDotScale : 1;\n      _.setUniform1f(\"u_tileZoomFactor\", a), _.setUniform1f(\"u_tileDotsOverArea\", i / (r * window.devicePixelRatio * r * window.devicePixelRatio)), _.setUniformMatrix4fv(\"u_dotColors\", n.ddColors), _.setUniform4fv(\"u_isActive\", n.ddActiveDots), _.setUniform4fv(\"u_dotBackgroundColor\", n.ddBackgroundColor), _.setUniform1f(\"u_dotValue\", Math.max(1, n.ddDotValue * u * l)), this._bindDotDensityTextures(s, _, n, o);\n    }\n\n    o.draw(s, c, f);\n  }\n\n  _disposeTextures() {\n    if (this._dotTextures) {\n      for (let e = 0; e < this._dotTextures.length; e++) this._dotTextures[e].dispose();\n\n      this._dotTextures = null;\n    }\n  }\n\n  _bindDotDensityTextures(e, t, o, i) {\n    const r = this._createDotDensityTextures(e, i, o.ddSeed);\n\n    t.setUniform1iv(\"u_dotTextures\", this._dotSamplers);\n\n    for (let s = 0; s < r.length; s++) e.bindTexture(r[s], this._dotSamplers[s]);\n  }\n\n  _createDotDensityTextures(t, o, i) {\n    if (this._dotTextureSize === o && this._seed === i || (this._disposeTextures(), this._dotTextureSize = o, this._seed = i), null === this._dotTextures) {\n      const r = new e(i);\n      this._dotTextures = [this._allocDotDensityTexture(t, o, r), this._allocDotDensityTexture(t, o, r)];\n    }\n\n    return this._dotTextures;\n  }\n\n  _allocDotDensityTexture(e, o, i) {\n    const r = new Float32Array(o * o * 4);\n\n    for (let t = 0; t < r.length; t++) r[t] = i.getFloat();\n\n    return new t(e, {\n      wrapMode: 10497,\n      pixelFormat: 6408,\n      dataType: 5126,\n      samplingMode: 9728,\n      width: o,\n      height: o\n    }, r);\n  }\n\n}\n\nexport default d;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/WGLGeometryBrushFill.js"],"names":["e","t","TEXTURE_BINDING_RENDERER_0","o","TEXTURE_BINDING_RENDERER_1","i","TILE_SIZE","r","WGLGeometryType","s","createProgramDescriptor","a","n","FillMaterialKey","l","u","data","geometry","location","name","count","type","dotDensity","normalized","d","constructor","arguments","_dotTextureSize","_dotTextures","_dotSamplers","Int32Array","dispose","_disposeTextures","getGeometryType","FILL","drawGeometry","context","painter","rendererInfo","requiredLevel","m","load","materialKey","bufferLayouts","c","attributes","f","_","materialManager","getMaterialProgram","useProgram","_setSharedUniforms","textureBinding","textureManager","bindTextures","key","level","pixelRatio","setUniform1f","vvColor","setUniform1fv","vvColorValues","setUniform4fv","vvColors","vvOpacity","vvOpacityValues","vvOpacities","ddDotSize","window","devicePixelRatio","ddDotScale","state","scale","setUniformMatrix4fv","ddColors","ddActiveDots","ddBackgroundColor","Math","max","ddDotValue","_bindDotDensityTextures","draw","length","_createDotDensityTextures","ddSeed","setUniform1iv","bindTexture","_seed","_allocDotDensityTexture","Float32Array","getFloat","wrapMode","pixelFormat","dataType","samplingMode","width","height"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../core/RandomLCG.js\";import\"../../../../webgl/BufferObject.js\";import\"../../../../webgl/FramebufferObject.js\";import\"../../../../../core/has.js\";import\"../../../../webgl/enums.js\";import\"../../../../webgl/RenderingContext.js\";import\"../../../../../chunks/builtins.js\";import t from\"../../../../webgl/Texture.js\";import\"../../../../webgl/VertexArrayObject.js\";import{TEXTURE_BINDING_RENDERER_0 as o,TEXTURE_BINDING_RENDERER_1 as i,TILE_SIZE as r}from\"../definitions.js\";import{WGLGeometryType as s}from\"../enums.js\";import{createProgramDescriptor as a}from\"../Utils.js\";import n from\"./WGLGeometryBrush.js\";import{FillMaterialKey as l}from\"../materialKey/MaterialKey.js\";const u=e=>a(e.data,{geometry:[{location:0,name:\"a_pos\",count:2,type:5122},{location:1,name:\"a_id\",count:4,type:5121},...e.dotDensity?[]:[{location:2,name:\"a_color\",count:4,type:5121,normalized:!0},{location:3,name:\"a_tlbr\",count:4,type:5123},{location:4,name:\"a_aux1\",count:4,type:5121},{location:5,name:\"a_aux2\",count:2,type:5123},{location:6,name:\"a_aux3\",count:4,type:5121},{location:7,name:\"a_zoomRange\",count:2,type:5123}],...e.dotDensity?[{location:2,name:\"a_inverseArea\",count:1,type:5126}]:[]]});class d extends n{constructor(){super(...arguments),this._dotTextureSize=0,this._dotTextures=null,this._dotSamplers=new Int32Array([o,i])}dispose(){this._disposeTextures()}getGeometryType(){return s.FILL}drawGeometry(e,t,o,i){const{context:s,painter:a,rendererInfo:n,requiredLevel:d}=e,m=l.load(o.materialKey),{bufferLayouts:c,attributes:f}=u(m),_=a.materialManager.getMaterialProgram(e,m,\"materials/fill\",f,i);if(s.useProgram(_),this._setSharedUniforms(_,e,t),m.textureBinding){a.textureManager.bindTextures(s,_,m);const o=1/2**(d-t.key.level)/e.pixelRatio;_.setUniform1f(\"u_zoomFactor\",o)}if(m.vvColor&&(_.setUniform1fv(\"u_vvColorValues\",n.vvColorValues),_.setUniform4fv(\"u_vvColors\",n.vvColors)),m.vvOpacity&&(_.setUniform1fv(\"u_vvOpacityValues\",n.vvOpacityValues),_.setUniform1fv(\"u_vvOpacities\",n.vvOpacities)),m.dotDensity){const o=r/n.ddDotSize,i=o*window.devicePixelRatio*o*window.devicePixelRatio,a=1/2**(d-t.key.level),l=1/a*(1/a),u=n.ddDotScale?e.state.scale/n.ddDotScale:1;_.setUniform1f(\"u_tileZoomFactor\",a),_.setUniform1f(\"u_tileDotsOverArea\",i/(r*window.devicePixelRatio*r*window.devicePixelRatio)),_.setUniformMatrix4fv(\"u_dotColors\",n.ddColors),_.setUniform4fv(\"u_isActive\",n.ddActiveDots),_.setUniform4fv(\"u_dotBackgroundColor\",n.ddBackgroundColor),_.setUniform1f(\"u_dotValue\",Math.max(1,n.ddDotValue*u*l)),this._bindDotDensityTextures(s,_,n,o)}o.draw(s,c,f)}_disposeTextures(){if(this._dotTextures){for(let e=0;e<this._dotTextures.length;e++)this._dotTextures[e].dispose();this._dotTextures=null}}_bindDotDensityTextures(e,t,o,i){const r=this._createDotDensityTextures(e,i,o.ddSeed);t.setUniform1iv(\"u_dotTextures\",this._dotSamplers);for(let s=0;s<r.length;s++)e.bindTexture(r[s],this._dotSamplers[s])}_createDotDensityTextures(t,o,i){if(this._dotTextureSize===o&&this._seed===i||(this._disposeTextures(),this._dotTextureSize=o,this._seed=i),null===this._dotTextures){const r=new e(i);this._dotTextures=[this._allocDotDensityTexture(t,o,r),this._allocDotDensityTexture(t,o,r)]}return this._dotTextures}_allocDotDensityTexture(e,o,i){const r=new Float32Array(o*o*4);for(let t=0;t<r.length;t++)r[t]=i.getFloat();return new t(e,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:o,height:o},r)}}export default d;\n"]},"metadata":{},"sourceType":"module"}