{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport \"../intl.js\";\nimport { init as t } from \"../core/watchUtils.js\";\nimport { aliasOf as i } from \"../core/accessorSupport/decorators/aliasOf.js\";\nimport \"../core/has.js\";\nimport { cast as s } from \"../core/accessorSupport/decorators/cast.js\";\nimport \"../core/Logger.js\";\nimport { property as n } from \"../core/accessorSupport/decorators/property.js\";\nimport { subclass as r } from \"../core/accessorSupport/decorators/subclass.js\";\nimport o from \"./Widget.js\";\nimport d from \"./Feature/FeatureAttachments.js\";\nimport l from \"./Feature/FeatureContent.js\";\nimport a from \"./Feature/FeatureFields.js\";\nimport c from \"./Feature/FeatureMedia.js\";\nimport u from \"./Feature/FeatureViewModel.js\";\nimport { FeatureContentMixin as p } from \"./Feature/support/FeatureContentMixin.js\";\nimport { Heading as h } from \"./support/Heading.js\";\nimport \"./support/widgetUtils.js\";\nimport { messageBundle as m } from \"./support/decorators/messageBundle.js\";\nimport { tsx as f } from \"./support/jsxFactory.js\";\nimport { substitute as v } from \"../intl/substitute.js\";\nconst g = {\n  iconText: \"esri-icon-font-fallback-text\",\n  iconLoading: \"esri-icon-loading-indicator esri-rotating\",\n  esriTable: \"esri-widget__table\",\n  esriWidget: \"esri-widget\",\n  base: \"esri-feature\",\n  container: \"esri-feature__size-container\",\n  title: \"esri-feature__title\",\n  main: \"esri-feature__main-container\",\n  btn: \"esri-feature__button\",\n  icon: \"esri-feature__icon\",\n  content: \"esri-feature__content\",\n  contentElement: \"esri-feature__content-element\",\n  text: \"esri-feature__text\",\n  lastEditedInfo: \"esri-feature__last-edited-info\",\n  fields: \"esri-feature__fields\",\n  fieldHeader: \"esri-feature__field-header\",\n  fieldData: \"esri-feature__field-data\",\n  fieldDataDate: \"esri-feature__field-data--date\",\n  loadingSpinnerContainer: \"esri-feature__loading-container\",\n  spinner: \"esri-feature__loading-spinner\"\n},\n      y = {\n  title: !0,\n  content: !0,\n  lastEditedInfo: !0\n};\n\nlet _ = class extends p(o) {\n  constructor(e, t) {\n    super(e, t), this._contentWidgets = [], this.graphic = null, this.defaultPopupTemplateEnabled = !1, this.headingLevel = 2, this.label = void 0, this.messages = null, this.messagesURIUtils = null, this.spatialReference = null, this.title = null, this.visibleElements = { ...y\n    }, this.map = null, this.view = null, this.viewModel = new u();\n  }\n\n  initialize() {\n    this.own(t(this, \"viewModel.contentViewModels\", () => this._setupContentWidgets()));\n  }\n\n  destroy() {\n    this._destroyContentWidgets();\n  }\n\n  castVisibleElements(e) {\n    return { ...y,\n      ...e\n    };\n  }\n\n  render() {\n    const {\n      waitingForContent: e\n    } = this.viewModel;\n    return f(\"div\", {\n      class: this.classes(g.base, g.esriWidget)\n    }, f(\"div\", {\n      class: g.container\n    }, this.renderTitle(), e ? this.renderLoading() : this.renderContentContainer()));\n  }\n\n  setActiveMedia(e, t) {\n    this.viewModel.setActiveMedia(e, t);\n  }\n\n  nextMedia(e) {\n    this.viewModel.nextMedia(e);\n  }\n\n  previousMedia(e) {\n    this.viewModel.previousMedia(e);\n  }\n\n  renderLoading() {\n    return f(\"div\", {\n      key: \"loading-container\",\n      class: g.loadingSpinnerContainer\n    }, f(\"span\", {\n      class: this.classes(g.iconLoading, g.spinner)\n    }));\n  }\n\n  renderContentContainer() {\n    const {\n      visibleElements: e\n    } = this;\n    return e.content ? f(\"div\", {\n      class: g.main\n    }, [this.renderContent(), this.renderLastEditInfo()]) : null;\n  }\n\n  renderTitle() {\n    const {\n      visibleElements: e,\n      title: t\n    } = this;\n    return e.title ? f(h, {\n      level: this.headingLevel,\n      class: g.title,\n      innerHTML: t\n    }) : null;\n  }\n\n  renderContent() {\n    const e = this.viewModel.content,\n          t = \"content\";\n    if (!e) return null;\n    if (Array.isArray(e)) return e.length ? f(\"div\", {\n      key: `${t}-content-elements`\n    }, e.map(this.renderContentElement, this)) : null;\n\n    if (\"string\" == typeof e) {\n      const e = this._contentWidgets[0];\n      return !e || e.destroyed ? null : f(\"div\", {\n        key: `${t}-content`\n      }, e.render());\n    }\n\n    return this.renderNodeContent(e);\n  }\n\n  renderContentElement(e, t) {\n    const {\n      visibleElements: i\n    } = this;\n    if (\"boolean\" != typeof i.content && !i.content[e.type]) return null;\n\n    switch (e.type) {\n      case \"attachments\":\n        return this.renderAttachments(t);\n\n      case \"custom\":\n        return this.renderCustom(e, t);\n\n      case \"fields\":\n        return this.renderFields(t);\n\n      case \"media\":\n        return this.renderMedia(t);\n\n      case \"text\":\n        return this.renderText(e, t);\n\n      default:\n        return null;\n    }\n  }\n\n  renderAttachments(e) {\n    const t = this._contentWidgets[e];\n    if (!t || t.destroyed) return null;\n    const {\n      state: i,\n      attachmentInfos: s\n    } = t.viewModel;\n    return \"loading\" === i || s.length > 0 ? f(\"div\", {\n      key: this._buildKey(\"attachments-element\", e),\n      class: this.classes(g.contentElement)\n    }, t.render()) : null;\n  }\n\n  renderCustom(e, t) {\n    const {\n      creator: i\n    } = e,\n          s = this._contentWidgets[t];\n    return !s || s.destroyed ? null : i ? f(\"div\", {\n      key: this._buildKey(\"custom-element\", t),\n      class: g.contentElement\n    }, s.render()) : null;\n  }\n\n  renderFields(e) {\n    const t = this._contentWidgets[e];\n    return !t || t.destroyed ? null : f(\"div\", {\n      key: this._buildKey(\"fields-element\", e),\n      class: g.contentElement\n    }, t.render());\n  }\n\n  renderMedia(e) {\n    const t = this._contentWidgets[e];\n    return !t || t.destroyed ? null : f(\"div\", {\n      key: this._buildKey(\"media-element\", e),\n      class: g.contentElement\n    }, t.render());\n  }\n\n  renderLastEditInfo() {\n    const {\n      visibleElements: e,\n      messages: t\n    } = this,\n          {\n      lastEditInfo: i\n    } = this.viewModel;\n    if (!i || !e.lastEditedInfo) return null;\n    const {\n      date: s,\n      user: n\n    } = i,\n          r = \"edit\" === i.type ? n ? t.lastEditedByUser : t.lastEdited : n ? t.lastCreatedByUser : t.lastCreated,\n          o = v(r, {\n      date: s,\n      user: n\n    });\n    return f(\"div\", {\n      key: \"edit-info-element\",\n      class: this.classes(g.lastEditedInfo, g.contentElement)\n    }, o);\n  }\n\n  renderText(e, t) {\n    const i = e.text,\n          s = this._contentWidgets[t];\n    return !s || s.destroyed ? null : i ? f(\"div\", {\n      key: this._buildKey(\"text-element\", t),\n      class: this.classes(g.contentElement, g.text)\n    }, s.render()) : null;\n  }\n\n  _buildKey(e, ...t) {\n    return `${e}__${this.get(\"viewModel.graphic.uid\") || \"0\"}-${t.join(\"-\")}`;\n  }\n\n  _destroyContentWidgets() {\n    this._contentWidgets.forEach(e => {\n      e.viewModel = null, e && !e.destroyed && e.destroy();\n    }), this._contentWidgets = [];\n  }\n\n  _setupContentWidgets() {\n    this._destroyContentWidgets();\n\n    const {\n      headingLevel: e,\n      visibleElements: t\n    } = this,\n          i = this.get(\"viewModel.content\"),\n          {\n      contentViewModels: s\n    } = this.viewModel;\n    if (Array.isArray(i)) i.forEach((i, n) => {\n      \"attachments\" === i.type && (this._contentWidgets[n] = new d({\n        displayType: i.displayType,\n        headingLevel: t.title ? e + 1 : e,\n        viewModel: s[n]\n      })), \"fields\" === i.type && (this._contentWidgets[n] = new a({\n        viewModel: s[n]\n      })), \"media\" === i.type && (this._contentWidgets[n] = new c({\n        viewModel: s[n]\n      })), \"text\" === i.type && (this._contentWidgets[n] = new l({\n        viewModel: s[n]\n      })), \"custom\" === i.type && (this._contentWidgets[n] = new l({\n        viewModel: s[n]\n      }));\n    }, this);else {\n      const e = s[0];\n      e && !e.destroyed && (this._contentWidgets[0] = new l({\n        viewModel: e\n      }));\n    }\n    this.scheduleRender();\n  }\n\n};\n\ne([i(\"viewModel.graphic\")], _.prototype, \"graphic\", void 0), e([i(\"viewModel.defaultPopupTemplateEnabled\")], _.prototype, \"defaultPopupTemplateEnabled\", void 0), e([n()], _.prototype, \"headingLevel\", void 0), e([n({\n  aliasOf: {\n    source: \"messages.widgetLabel\",\n    overridable: !0\n  }\n})], _.prototype, \"label\", void 0), e([n(), m(\"esri/widgets/Feature/t9n/Feature\")], _.prototype, \"messages\", void 0), e([n(), m(\"esri/widgets/support/t9n/uriUtils\")], _.prototype, \"messagesURIUtils\", void 0), e([i(\"viewModel.spatialReference\")], _.prototype, \"spatialReference\", void 0), e([i(\"viewModel.title\")], _.prototype, \"title\", void 0), e([n()], _.prototype, \"visibleElements\", void 0), e([s(\"visibleElements\")], _.prototype, \"castVisibleElements\", null), e([i(\"viewModel.map\")], _.prototype, \"map\", void 0), e([i(\"viewModel.view\")], _.prototype, \"view\", void 0), e([n({\n  type: u\n})], _.prototype, \"viewModel\", void 0), _ = e([r(\"esri.widgets.Feature\")], _);\nvar w = _;\nexport default w;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/widgets/Feature.js"],"names":["_","e","init","t","aliasOf","i","cast","s","property","n","subclass","r","o","d","l","a","c","u","FeatureContentMixin","p","Heading","h","messageBundle","m","tsx","f","substitute","v","g","iconText","iconLoading","esriTable","esriWidget","base","container","title","main","btn","icon","content","contentElement","text","lastEditedInfo","fields","fieldHeader","fieldData","fieldDataDate","loadingSpinnerContainer","spinner","y","constructor","_contentWidgets","graphic","defaultPopupTemplateEnabled","headingLevel","label","messages","messagesURIUtils","spatialReference","visibleElements","map","view","viewModel","initialize","own","_setupContentWidgets","destroy","_destroyContentWidgets","castVisibleElements","render","waitingForContent","class","classes","renderTitle","renderLoading","renderContentContainer","setActiveMedia","nextMedia","previousMedia","key","renderContent","renderLastEditInfo","level","innerHTML","Array","isArray","length","renderContentElement","destroyed","renderNodeContent","type","renderAttachments","renderCustom","renderFields","renderMedia","renderText","state","attachmentInfos","_buildKey","creator","lastEditInfo","date","user","lastEditedByUser","lastEdited","lastCreatedByUser","lastCreated","get","join","forEach","contentViewModels","displayType","scheduleRender","prototype","source","overridable","w"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../intl.js\";import{init as t}from\"../core/watchUtils.js\";import{aliasOf as i}from\"../core/accessorSupport/decorators/aliasOf.js\";import\"../core/has.js\";import{cast as s}from\"../core/accessorSupport/decorators/cast.js\";import\"../core/Logger.js\";import{property as n}from\"../core/accessorSupport/decorators/property.js\";import{subclass as r}from\"../core/accessorSupport/decorators/subclass.js\";import o from\"./Widget.js\";import d from\"./Feature/FeatureAttachments.js\";import l from\"./Feature/FeatureContent.js\";import a from\"./Feature/FeatureFields.js\";import c from\"./Feature/FeatureMedia.js\";import u from\"./Feature/FeatureViewModel.js\";import{FeatureContentMixin as p}from\"./Feature/support/FeatureContentMixin.js\";import{Heading as h}from\"./support/Heading.js\";import\"./support/widgetUtils.js\";import{messageBundle as m}from\"./support/decorators/messageBundle.js\";import{tsx as f}from\"./support/jsxFactory.js\";import{substitute as v}from\"../intl/substitute.js\";const g={iconText:\"esri-icon-font-fallback-text\",iconLoading:\"esri-icon-loading-indicator esri-rotating\",esriTable:\"esri-widget__table\",esriWidget:\"esri-widget\",base:\"esri-feature\",container:\"esri-feature__size-container\",title:\"esri-feature__title\",main:\"esri-feature__main-container\",btn:\"esri-feature__button\",icon:\"esri-feature__icon\",content:\"esri-feature__content\",contentElement:\"esri-feature__content-element\",text:\"esri-feature__text\",lastEditedInfo:\"esri-feature__last-edited-info\",fields:\"esri-feature__fields\",fieldHeader:\"esri-feature__field-header\",fieldData:\"esri-feature__field-data\",fieldDataDate:\"esri-feature__field-data--date\",loadingSpinnerContainer:\"esri-feature__loading-container\",spinner:\"esri-feature__loading-spinner\"},y={title:!0,content:!0,lastEditedInfo:!0};let _=class extends(p(o)){constructor(e,t){super(e,t),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.headingLevel=2,this.label=void 0,this.messages=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements={...y},this.map=null,this.view=null,this.viewModel=new u}initialize(){this.own(t(this,\"viewModel.contentViewModels\",(()=>this._setupContentWidgets())))}destroy(){this._destroyContentWidgets()}castVisibleElements(e){return{...y,...e}}render(){const{waitingForContent:e}=this.viewModel;return f(\"div\",{class:this.classes(g.base,g.esriWidget)},f(\"div\",{class:g.container},this.renderTitle(),e?this.renderLoading():this.renderContentContainer()))}setActiveMedia(e,t){this.viewModel.setActiveMedia(e,t)}nextMedia(e){this.viewModel.nextMedia(e)}previousMedia(e){this.viewModel.previousMedia(e)}renderLoading(){return f(\"div\",{key:\"loading-container\",class:g.loadingSpinnerContainer},f(\"span\",{class:this.classes(g.iconLoading,g.spinner)}))}renderContentContainer(){const{visibleElements:e}=this;return e.content?f(\"div\",{class:g.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:e,title:t}=this;return e.title?f(h,{level:this.headingLevel,class:g.title,innerHTML:t}):null}renderContent(){const e=this.viewModel.content,t=\"content\";if(!e)return null;if(Array.isArray(e))return e.length?f(\"div\",{key:`${t}-content-elements`},e.map(this.renderContentElement,this)):null;if(\"string\"==typeof e){const e=this._contentWidgets[0];return!e||e.destroyed?null:f(\"div\",{key:`${t}-content`},e.render())}return this.renderNodeContent(e)}renderContentElement(e,t){const{visibleElements:i}=this;if(\"boolean\"!=typeof i.content&&!i.content[e.type])return null;switch(e.type){case\"attachments\":return this.renderAttachments(t);case\"custom\":return this.renderCustom(e,t);case\"fields\":return this.renderFields(t);case\"media\":return this.renderMedia(t);case\"text\":return this.renderText(e,t);default:return null}}renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:i,attachmentInfos:s}=t.viewModel;return\"loading\"===i||s.length>0?f(\"div\",{key:this._buildKey(\"attachments-element\",e),class:this.classes(g.contentElement)},t.render()):null}renderCustom(e,t){const{creator:i}=e,s=this._contentWidgets[t];return!s||s.destroyed?null:i?f(\"div\",{key:this._buildKey(\"custom-element\",t),class:g.contentElement},s.render()):null}renderFields(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:f(\"div\",{key:this._buildKey(\"fields-element\",e),class:g.contentElement},t.render())}renderMedia(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:f(\"div\",{key:this._buildKey(\"media-element\",e),class:g.contentElement},t.render())}renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:i}=this.viewModel;if(!i||!e.lastEditedInfo)return null;const{date:s,user:n}=i,r=\"edit\"===i.type?n?t.lastEditedByUser:t.lastEdited:n?t.lastCreatedByUser:t.lastCreated,o=v(r,{date:s,user:n});return f(\"div\",{key:\"edit-info-element\",class:this.classes(g.lastEditedInfo,g.contentElement)},o)}renderText(e,t){const i=e.text,s=this._contentWidgets[t];return!s||s.destroyed?null:i?f(\"div\",{key:this._buildKey(\"text-element\",t),class:this.classes(g.contentElement,g.text)},s.render()):null}_buildKey(e,...t){return`${e}__${this.get(\"viewModel.graphic.uid\")||\"0\"}-${t.join(\"-\")}`}_destroyContentWidgets(){this._contentWidgets.forEach((e=>{e.viewModel=null,e&&!e.destroyed&&e.destroy()})),this._contentWidgets=[]}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:e,visibleElements:t}=this,i=this.get(\"viewModel.content\"),{contentViewModels:s}=this.viewModel;if(Array.isArray(i))i.forEach(((i,n)=>{\"attachments\"===i.type&&(this._contentWidgets[n]=new d({displayType:i.displayType,headingLevel:t.title?e+1:e,viewModel:s[n]})),\"fields\"===i.type&&(this._contentWidgets[n]=new a({viewModel:s[n]})),\"media\"===i.type&&(this._contentWidgets[n]=new c({viewModel:s[n]})),\"text\"===i.type&&(this._contentWidgets[n]=new l({viewModel:s[n]})),\"custom\"===i.type&&(this._contentWidgets[n]=new l({viewModel:s[n]}))}),this);else{const e=s[0];e&&!e.destroyed&&(this._contentWidgets[0]=new l({viewModel:e}))}this.scheduleRender()}};e([i(\"viewModel.graphic\")],_.prototype,\"graphic\",void 0),e([i(\"viewModel.defaultPopupTemplateEnabled\")],_.prototype,\"defaultPopupTemplateEnabled\",void 0),e([n()],_.prototype,\"headingLevel\",void 0),e([n({aliasOf:{source:\"messages.widgetLabel\",overridable:!0}})],_.prototype,\"label\",void 0),e([n(),m(\"esri/widgets/Feature/t9n/Feature\")],_.prototype,\"messages\",void 0),e([n(),m(\"esri/widgets/support/t9n/uriUtils\")],_.prototype,\"messagesURIUtils\",void 0),e([i(\"viewModel.spatialReference\")],_.prototype,\"spatialReference\",void 0),e([i(\"viewModel.title\")],_.prototype,\"title\",void 0),e([n()],_.prototype,\"visibleElements\",void 0),e([s(\"visibleElements\")],_.prototype,\"castVisibleElements\",null),e([i(\"viewModel.map\")],_.prototype,\"map\",void 0),e([i(\"viewModel.view\")],_.prototype,\"view\",void 0),e([n({type:u})],_.prototype,\"viewModel\",void 0),_=e([r(\"esri.widgets.Feature\")],_);var w=_;export default w;\n"]},"metadata":{},"sourceType":"module"}