{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { clamp as t } from \"../../../../../core/mathUtils.js\";\nimport { isNone as n, isSome as e } from \"../../../../../core/maybe.js\";\nimport { s as i, c as o, n as r } from \"../../../../../chunks/vec3.js\";\nimport { c as s } from \"../../../../../chunks/vec3f64.js\";\nimport { create as c, setMin as f, setMax as a } from \"../../../../../geometry/support/aaBoundingBox.js\";\nimport { scale as l } from \"../../lib/screenSizePerspectiveUtils.js\";\nimport { assert as u } from \"../../lib/Util.js\";\nimport { isInstanceHidden as m } from \"../renderers/utils.js\";\nconst p = c();\n\nfunction h(t, n, e, i, o, r, s) {\n  if (!m(n)) if (t.boundingInfo) {\n    u(0 === t.primitiveType);\n    const n = e.tolerance;\n    g(t.boundingInfo, i, o, n, r, s);\n  } else {\n    const n = t.indices.get(\"position\"),\n          e = t.vertexAttributes.get(\"position\");\n    M(i, o, 0, n.length / 3, n, e, void 0, r, s);\n  }\n}\n\nconst d = s();\n\nfunction g(t, i, o, r, s, c) {\n  if (n(t)) return;\n  const l = j(i, o, d);\n\n  if (f(p, t.getBBMin()), a(p, t.getBBMax()), e(s) && s.applyToAabb(p), A(p, i, l, r)) {\n    const {\n      primitiveIndices: n,\n      indices: e,\n      position: f\n    } = t,\n          a = n ? n.length : e.length / 3;\n\n    if (a > U) {\n      const n = t.getChildren();\n\n      if (void 0 !== n) {\n        for (let t = 0; t < 8; ++t) void 0 !== n[t] && g(n[t], i, o, r, s, c);\n\n        return;\n      }\n    }\n\n    M(i, o, 0, a, e, f, n, s, c);\n  }\n}\n\nconst x = s();\n\nfunction M(t, n, i, o, r, s, c, f, a) {\n  if (c) return b(t, n, i, o, r, s, c, f, a);\n  const l = s.data,\n        u = s.stride || s.size,\n        m = t[0],\n        p = t[1],\n        h = t[2],\n        d = n[0] - m,\n        g = n[1] - p,\n        M = n[2] - h;\n\n  for (let b = i, v = 3 * i; b < o; ++b) {\n    let t = u * r[v++],\n        n = l[t++],\n        i = l[t++],\n        o = l[t];\n    t = u * r[v++];\n    let s = l[t++],\n        c = l[t++],\n        y = l[t];\n    t = u * r[v++];\n    let j = l[t++],\n        A = l[t++],\n        L = l[t];\n    e(f) && ([n, i, o] = f.applyToVertex(n, i, o, b), [s, c, y] = f.applyToVertex(s, c, y, b), [j, A, L] = f.applyToVertex(j, A, L, b));\n    const V = s - n,\n          B = c - i,\n          z = y - o,\n          E = j - n,\n          I = A - i,\n          N = L - o,\n          P = g * N - I * M,\n          U = M * E - N * d,\n          S = d * I - E * g,\n          W = V * P + B * U + z * S;\n    if (Math.abs(W) <= Number.EPSILON) continue;\n    const O = m - n,\n          k = p - i,\n          R = h - o,\n          C = O * P + k * U + R * S;\n\n    if (W > 0) {\n      if (C < 0 || C > W) continue;\n    } else if (C > 0 || C < W) continue;\n\n    const H = k * z - B * R,\n          X = R * V - z * O,\n          Y = O * B - V * k,\n          _ = d * H + g * X + M * Y;\n\n    if (W > 0) {\n      if (_ < 0 || C + _ > W) continue;\n    } else if (_ > 0 || C + _ < W) continue;\n\n    const q = (E * H + I * X + N * Y) / W;\n\n    if (q >= 0) {\n      a(q, T(V, B, z, E, I, N, x), b);\n    }\n  }\n}\n\nfunction b(t, n, i, o, r, s, c, f, a) {\n  const l = s.data,\n        u = s.stride || s.size,\n        m = t[0],\n        p = t[1],\n        h = t[2],\n        d = n[0] - m,\n        g = n[1] - p,\n        M = n[2] - h;\n\n  for (let b = i; b < o; ++b) {\n    const t = c[b];\n    let n = 3 * t,\n        i = u * r[n++],\n        o = l[i++],\n        s = l[i++],\n        v = l[i];\n    i = u * r[n++];\n    let y = l[i++],\n        j = l[i++],\n        A = l[i];\n    i = u * r[n];\n    let L = l[i++],\n        V = l[i++],\n        B = l[i];\n    e(f) && ([o, s, v] = f.applyToVertex(o, s, v, b), [y, j, A] = f.applyToVertex(y, j, A, b), [L, V, B] = f.applyToVertex(L, V, B, b));\n    const z = y - o,\n          E = j - s,\n          I = A - v,\n          N = L - o,\n          P = V - s,\n          U = B - v,\n          S = g * U - P * M,\n          W = M * N - U * d,\n          O = d * P - N * g,\n          k = z * S + E * W + I * O;\n    if (Math.abs(k) <= Number.EPSILON) continue;\n    const R = m - o,\n          C = p - s,\n          H = h - v,\n          X = R * S + C * W + H * O;\n\n    if (k > 0) {\n      if (X < 0 || X > k) continue;\n    } else if (X > 0 || X < k) continue;\n\n    const Y = C * I - E * H,\n          _ = H * z - I * R,\n          q = R * E - z * C,\n          w = d * Y + g * _ + M * q;\n\n    if (k > 0) {\n      if (w < 0 || X + w > k) continue;\n    } else if (w > 0 || X + w < k) continue;\n\n    const D = (N * Y + P * _ + U * q) / k;\n\n    if (D >= 0) {\n      a(D, T(z, E, I, N, P, U, x), t);\n    }\n  }\n}\n\nconst v = s(),\n      y = s();\n\nfunction T(t, n, e, s, c, f, a) {\n  return i(v, t, n, e), i(y, s, c, f), o(a, v, y), r(a, a), a;\n}\n\nfunction j(t, n, e) {\n  return i(e, 1 / (n[0] - t[0]), 1 / (n[1] - t[1]), 1 / (n[2] - t[2]));\n}\n\nfunction A(t, n, e, i) {\n  return L(t, n, e, i, 1 / 0);\n}\n\nfunction L(t, n, e, i, o) {\n  const r = (t[0] - i - n[0]) * e[0],\n        s = (t[3] + i - n[0]) * e[0];\n  let c = Math.min(r, s),\n      f = Math.max(r, s);\n  const a = (t[1] - i - n[1]) * e[1],\n        l = (t[4] + i - n[1]) * e[1];\n  if (f = Math.min(f, Math.max(a, l)), f < 0) return !1;\n  if (c = Math.max(c, Math.min(a, l)), c > f) return !1;\n  const u = (t[2] - i - n[2]) * e[2],\n        m = (t[5] + i - n[2]) * e[2];\n  return f = Math.min(f, Math.max(u, m)), !(f < 0) && (c = Math.max(c, Math.min(u, m)), !(c > f) && c < o);\n}\n\nfunction V(n, e, i, o, r) {\n  let s = (i.screenLength || 0) * n.pixelRatio;\n  r && (s = l(s, o, e, r));\n  const c = s * Math.tan(.5 * n.fovY) / (.5 * n.fullHeight);\n  return t(c * e, i.minWorldLength || 0, null != i.maxWorldLength ? i.maxWorldLength : 1 / 0);\n}\n\nfunction B(t, n, e) {\n  if (!t) return;\n  const i = t.parameters,\n        o = t.paddingPixelsOverride;\n  n.setUniform4f(e, i.divisor, i.offset, i.minPixelSize, o);\n}\n\nfunction z(t, n) {\n  const e = n ? z(n) : {};\n\n  for (const i in t) {\n    let n = t[i];\n    n && n.forEach && (n = N(n)), null == n && i in e || (e[i] = n);\n  }\n\n  return e;\n}\n\nfunction E(t, n) {\n  let e = !1;\n\n  for (const i in n) {\n    const o = n[i];\n    void 0 !== o && (e = !0, Array.isArray(o) ? t[i] = o.slice() : t[i] = o);\n  }\n\n  return e;\n}\n\nfunction I(n, e, i, o, r) {\n  if (!e.options.selectionMode) return;\n  const s = n.vertexAttributes.get(\"position\").data,\n        c = n.vertexAttributes.get(\"size\"),\n        f = c && c.data[0],\n        a = i[0],\n        l = i[1],\n        u = ((f + o) / 2 + 4) * n.screenToWorldRatio;\n  let m = Number.MAX_VALUE;\n\n  for (let p = 0; p < s.length - 5; p += 3) {\n    const n = s[p],\n          e = s[p + 1],\n          i = a - n,\n          o = l - e,\n          r = s[p + 3] - n,\n          c = s[p + 4] - e,\n          f = t((r * i + c * o) / (r * r + c * c), 0, 1),\n          u = r * f - i,\n          h = c * f - o,\n          d = u * u + h * h;\n    d < m && (m = d);\n  }\n\n  m < u * u && r();\n}\n\nfunction N(t) {\n  const n = [];\n  return t.forEach(t => n.push(t)), n;\n}\n\nconst P = {\n  multiply: 1,\n  ignore: 2,\n  replace: 3,\n  tint: 4\n},\n      U = 1e3;\nexport { B as bindScreenSizePerspective, P as colorMixModes, j as computeInvDir, T as computeNormal, z as copyParameters, A as intersectAabbInvDir, L as intersectAabbInvDirBefore, I as intersectDrapedRenderLineGeometry, h as intersectTriangleGeometry, M as intersectTriangles, E as updateParameters, V as verticalOffsetAtDistance };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/MaterialUtil.js"],"names":["clamp","t","isNone","n","isSome","e","s","i","c","o","r","create","setMin","f","setMax","a","scale","l","assert","u","isInstanceHidden","m","p","h","boundingInfo","primitiveType","tolerance","g","indices","get","vertexAttributes","M","length","d","j","getBBMin","getBBMax","applyToAabb","A","primitiveIndices","position","U","getChildren","x","b","data","stride","size","v","y","L","applyToVertex","V","B","z","E","I","N","P","S","W","Math","abs","Number","EPSILON","O","k","R","C","H","X","Y","_","q","T","w","D","min","max","screenLength","pixelRatio","tan","fovY","fullHeight","minWorldLength","maxWorldLength","parameters","paddingPixelsOverride","setUniform4f","divisor","offset","minPixelSize","forEach","Array","isArray","slice","options","selectionMode","screenToWorldRatio","MAX_VALUE","push","multiply","ignore","replace","tint","bindScreenSizePerspective","colorMixModes","computeInvDir","computeNormal","copyParameters","intersectAabbInvDir","intersectAabbInvDirBefore","intersectDrapedRenderLineGeometry","intersectTriangleGeometry","intersectTriangles","updateParameters","verticalOffsetAtDistance"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{clamp as t}from\"../../../../../core/mathUtils.js\";import{isNone as n,isSome as e}from\"../../../../../core/maybe.js\";import{s as i,c as o,n as r}from\"../../../../../chunks/vec3.js\";import{c as s}from\"../../../../../chunks/vec3f64.js\";import{create as c,setMin as f,setMax as a}from\"../../../../../geometry/support/aaBoundingBox.js\";import{scale as l}from\"../../lib/screenSizePerspectiveUtils.js\";import{assert as u}from\"../../lib/Util.js\";import{isInstanceHidden as m}from\"../renderers/utils.js\";const p=c();function h(t,n,e,i,o,r,s){if(!m(n))if(t.boundingInfo){u(0===t.primitiveType);const n=e.tolerance;g(t.boundingInfo,i,o,n,r,s)}else{const n=t.indices.get(\"position\"),e=t.vertexAttributes.get(\"position\");M(i,o,0,n.length/3,n,e,void 0,r,s)}}const d=s();function g(t,i,o,r,s,c){if(n(t))return;const l=j(i,o,d);if(f(p,t.getBBMin()),a(p,t.getBBMax()),e(s)&&s.applyToAabb(p),A(p,i,l,r)){const{primitiveIndices:n,indices:e,position:f}=t,a=n?n.length:e.length/3;if(a>U){const n=t.getChildren();if(void 0!==n){for(let t=0;t<8;++t)void 0!==n[t]&&g(n[t],i,o,r,s,c);return}}M(i,o,0,a,e,f,n,s,c)}}const x=s();function M(t,n,i,o,r,s,c,f,a){if(c)return b(t,n,i,o,r,s,c,f,a);const l=s.data,u=s.stride||s.size,m=t[0],p=t[1],h=t[2],d=n[0]-m,g=n[1]-p,M=n[2]-h;for(let b=i,v=3*i;b<o;++b){let t=u*r[v++],n=l[t++],i=l[t++],o=l[t];t=u*r[v++];let s=l[t++],c=l[t++],y=l[t];t=u*r[v++];let j=l[t++],A=l[t++],L=l[t];e(f)&&([n,i,o]=f.applyToVertex(n,i,o,b),[s,c,y]=f.applyToVertex(s,c,y,b),[j,A,L]=f.applyToVertex(j,A,L,b));const V=s-n,B=c-i,z=y-o,E=j-n,I=A-i,N=L-o,P=g*N-I*M,U=M*E-N*d,S=d*I-E*g,W=V*P+B*U+z*S;if(Math.abs(W)<=Number.EPSILON)continue;const O=m-n,k=p-i,R=h-o,C=O*P+k*U+R*S;if(W>0){if(C<0||C>W)continue}else if(C>0||C<W)continue;const H=k*z-B*R,X=R*V-z*O,Y=O*B-V*k,_=d*H+g*X+M*Y;if(W>0){if(_<0||C+_>W)continue}else if(_>0||C+_<W)continue;const q=(E*H+I*X+N*Y)/W;if(q>=0){a(q,T(V,B,z,E,I,N,x),b)}}}function b(t,n,i,o,r,s,c,f,a){const l=s.data,u=s.stride||s.size,m=t[0],p=t[1],h=t[2],d=n[0]-m,g=n[1]-p,M=n[2]-h;for(let b=i;b<o;++b){const t=c[b];let n=3*t,i=u*r[n++],o=l[i++],s=l[i++],v=l[i];i=u*r[n++];let y=l[i++],j=l[i++],A=l[i];i=u*r[n];let L=l[i++],V=l[i++],B=l[i];e(f)&&([o,s,v]=f.applyToVertex(o,s,v,b),[y,j,A]=f.applyToVertex(y,j,A,b),[L,V,B]=f.applyToVertex(L,V,B,b));const z=y-o,E=j-s,I=A-v,N=L-o,P=V-s,U=B-v,S=g*U-P*M,W=M*N-U*d,O=d*P-N*g,k=z*S+E*W+I*O;if(Math.abs(k)<=Number.EPSILON)continue;const R=m-o,C=p-s,H=h-v,X=R*S+C*W+H*O;if(k>0){if(X<0||X>k)continue}else if(X>0||X<k)continue;const Y=C*I-E*H,_=H*z-I*R,q=R*E-z*C,w=d*Y+g*_+M*q;if(k>0){if(w<0||X+w>k)continue}else if(w>0||X+w<k)continue;const D=(N*Y+P*_+U*q)/k;if(D>=0){a(D,T(z,E,I,N,P,U,x),t)}}}const v=s(),y=s();function T(t,n,e,s,c,f,a){return i(v,t,n,e),i(y,s,c,f),o(a,v,y),r(a,a),a}function j(t,n,e){return i(e,1/(n[0]-t[0]),1/(n[1]-t[1]),1/(n[2]-t[2]))}function A(t,n,e,i){return L(t,n,e,i,1/0)}function L(t,n,e,i,o){const r=(t[0]-i-n[0])*e[0],s=(t[3]+i-n[0])*e[0];let c=Math.min(r,s),f=Math.max(r,s);const a=(t[1]-i-n[1])*e[1],l=(t[4]+i-n[1])*e[1];if(f=Math.min(f,Math.max(a,l)),f<0)return!1;if(c=Math.max(c,Math.min(a,l)),c>f)return!1;const u=(t[2]-i-n[2])*e[2],m=(t[5]+i-n[2])*e[2];return f=Math.min(f,Math.max(u,m)),!(f<0)&&(c=Math.max(c,Math.min(u,m)),!(c>f)&&c<o)}function V(n,e,i,o,r){let s=(i.screenLength||0)*n.pixelRatio;r&&(s=l(s,o,e,r));const c=s*Math.tan(.5*n.fovY)/(.5*n.fullHeight);return t(c*e,i.minWorldLength||0,null!=i.maxWorldLength?i.maxWorldLength:1/0)}function B(t,n,e){if(!t)return;const i=t.parameters,o=t.paddingPixelsOverride;n.setUniform4f(e,i.divisor,i.offset,i.minPixelSize,o)}function z(t,n){const e=n?z(n):{};for(const i in t){let n=t[i];n&&n.forEach&&(n=N(n)),null==n&&i in e||(e[i]=n)}return e}function E(t,n){let e=!1;for(const i in n){const o=n[i];void 0!==o&&(e=!0,Array.isArray(o)?t[i]=o.slice():t[i]=o)}return e}function I(n,e,i,o,r){if(!e.options.selectionMode)return;const s=n.vertexAttributes.get(\"position\").data,c=n.vertexAttributes.get(\"size\"),f=c&&c.data[0],a=i[0],l=i[1],u=((f+o)/2+4)*n.screenToWorldRatio;let m=Number.MAX_VALUE;for(let p=0;p<s.length-5;p+=3){const n=s[p],e=s[p+1],i=a-n,o=l-e,r=s[p+3]-n,c=s[p+4]-e,f=t((r*i+c*o)/(r*r+c*c),0,1),u=r*f-i,h=c*f-o,d=u*u+h*h;d<m&&(m=d)}m<u*u&&r()}function N(t){const n=[];return t.forEach((t=>n.push(t))),n}const P={multiply:1,ignore:2,replace:3,tint:4},U=1e3;export{B as bindScreenSizePerspective,P as colorMixModes,j as computeInvDir,T as computeNormal,z as copyParameters,A as intersectAabbInvDir,L as intersectAabbInvDirBefore,I as intersectDrapedRenderLineGeometry,h as intersectTriangleGeometry,M as intersectTriangles,E as updateParameters,V as verticalOffsetAtDistance};\n"]},"metadata":{},"sourceType":"module"}