{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../Color.js\";\nimport t from \"../../core/Logger.js\";\nimport { pt2px as i } from \"../../core/screenUtils.js\";\nimport { numericHash as o } from \"../../core/string.js\";\nimport { createRendererExpression as r, ArcadeExpression as n } from \"../../support/arcadeOnDemand.js\";\nimport { CIMSymbolHelper as a, OverrideHelper as l } from \"./CIMSymbolHelper.js\";\nimport { getExtent as s, getSDFMetrics as c } from \"./SDFHelper.js\";\nimport { fromCIMColor as f, _adjustTextCase as m } from \"./utils.js\";\nimport p from \"../../views/2d/arcade/callExpressionWithFeature.js\";\nconst u = t.getLogger(\"esri.symbols.cim.cimAnalyzer\");\n\nfunction y(e) {\n  switch (e) {\n    case \"Butt\":\n      return 0;\n\n    case \"Square\":\n      return 2;\n\n    case \"Round\":\n    default:\n      return 1;\n  }\n}\n\nfunction h(e) {\n  switch (e) {\n    case \"Bevel\":\n      return 0;\n\n    case \"Miter\":\n      return 2;\n\n    case \"Round\":\n    default:\n      return 1;\n  }\n}\n\nfunction g(e) {\n  switch (e) {\n    case \"Left\":\n    default:\n      return \"left\";\n\n    case \"Right\":\n      return \"right\";\n\n    case \"Center\":\n      return \"center\";\n\n    case \"Justify\":\n      return \"justify\";\n  }\n}\n\nfunction d(e) {\n  switch (e) {\n    case \"Top\":\n    default:\n      return \"top\";\n\n    case \"Center\":\n      return \"middle\";\n\n    case \"Baseline\":\n      return \"baseline\";\n\n    case \"Bottom\":\n      return \"bottom\";\n  }\n}\n\nfunction S(e) {\n  let t = \"normal\",\n      i = \"normal\";\n\n  if (e) {\n    const o = e.toLowerCase();\n    -1 !== o.indexOf(\"italic\") ? t = \"italic\" : -1 !== o.indexOf(\"oblique\") && (t = \"oblique\"), -1 !== o.indexOf(\"bold\") ? i = \"bold\" : -1 !== o.indexOf(\"light\") && (i = \"lighter\");\n  }\n\n  return {\n    style: t,\n    weight: i\n  };\n}\n\nfunction v(e) {\n  return e.underline ? \"underline\" : e.strikethrough ? \"line-through\" : \"none\";\n}\n\nfunction N(e, t, i, o) {\n  let r;\n  e[t] ? r = e[t] : (r = {}, e[t] = r), r[i] = o;\n}\n\nfunction b(e) {\n  const t = e.markerPlacement;\n  return t && t.angleToLine ? 1 : 0;\n}\n\nasync function k(e, t, i, o) {\n  const n = null != i ? i : [];\n  if (!e) return n;\n  let a, l;\n  const s = {};\n  if (\"CIMSymbolReference\" !== e.type) return u.error(\"Expect cim type to be 'CIMSymbolReference'\"), n;\n\n  if (a = e.symbol, l = e.primitiveOverrides, l) {\n    const e = [];\n\n    for (const i of l) {\n      const o = i.valueExpressionInfo;\n\n      if (o && t) {\n        const n = o.expression,\n              a = r(n, t.spatialReference, t.fields).then(e => {\n          e && N(s, i.primitiveName, i.propertyName, e);\n        });\n        e.push(a);\n      } else null != i.value && N(s, i.primitiveName, i.propertyName, i.value);\n    }\n\n    await Promise.all(e);\n  }\n\n  switch (a.type) {\n    case \"CIMPointSymbol\":\n    case \"CIMLineSymbol\":\n    case \"CIMPolygonSymbol\":\n      O(a, l, s, t, n, o);\n  }\n\n  return n;\n}\n\nfunction O(e, t, i, o, r, n) {\n  if (!e) return;\n  const s = e.symbolLayers;\n  if (!s) return;\n  let c;\n  const f = a.getSize(e);\n  \"CIMPointSymbol\" === e.type && \"Map\" === e.angleAlignment && (c = 1);\n  let m = s.length;\n\n  for (; m--;) {\n    const a = s[m];\n    if (!a || !1 === a.enable) continue;\n    const p = [];\n\n    switch (l.findApplicableOverrides(a, t, p), a.type) {\n      case \"CIMSolidFill\":\n        C(a, i, p, o, r);\n        break;\n\n      case \"CIMPictureFill\":\n        P(a, i, p, o, r);\n        break;\n\n      case \"CIMHatchFill\":\n        L(a, i, p, o, r);\n        break;\n\n      case \"CIMGradientFill\":\n        M(a, i, p, o, r);\n        break;\n\n      case \"CIMSolidStroke\":\n        X(a, i, p, o, r, \"CIMPolygonSymbol\" === e.type, f);\n        break;\n\n      case \"CIMPictureStroke\":\n        I(a, i, p, o, r, \"CIMPolygonSymbol\" === e.type, f);\n        break;\n\n      case \"CIMGradientStroke\":\n        x(a, i, p, o, r, \"CIMPolygonSymbol\" === e.type, f);\n        break;\n\n      case \"CIMCharacterMarker\":\n        if (w(a, i, p, o, r)) break;\n        break;\n\n      case \"CIMPictureMarker\":\n        if (w(a, i, p, o, r)) break;\n        \"CIMLineSymbol\" === e.type && (c = b(a)), z(a, i, p, o, r, c, f);\n        break;\n\n      case \"CIMVectorMarker\":\n        if (w(a, i, p, o, r)) break;\n        \"CIMLineSymbol\" === e.type && (c = b(a)), J(a, i, p, o, r, c, f, n);\n        break;\n\n      default:\n        u.error(\"Cannot analyze CIM layer\", a.type);\n    }\n  }\n}\n\nfunction C(e, t, i, r, n) {\n  const a = e.primitiveName,\n        l = f(e.color),\n        [s, c] = D(i, a),\n        m = o(JSON.stringify(e) + c).toString();\n  n.push({\n    type: \"fill\",\n    templateHash: m,\n    materialHash: s ? () => m : m,\n    cim: e,\n    materialOverrides: null,\n    colorLocked: e.colorLocked,\n    color: F(a, t, \"Color\", r, l, j),\n    height: 0,\n    angle: 0,\n    offsetX: 0,\n    offsetY: 0,\n    scaleX: 1,\n    effects: e.effects\n  });\n}\n\nfunction P(e, t, i, r, n) {\n  const a = e.primitiveName,\n        l = e.tintColor ? f(e.tintColor) : {\n    r: 255,\n    g: 255,\n    b: 255,\n    a: 1\n  },\n        [s, c] = D(i, a),\n        m = o(JSON.stringify(e) + c).toString(),\n        p = o(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString();\n  n.push({\n    type: \"fill\",\n    templateHash: m,\n    materialHash: s ? () => p : p,\n    cim: e,\n    materialOverrides: null,\n    colorLocked: e.colorLocked,\n    effects: e.effects,\n    color: F(a, t, \"TintColor\", r, l, j),\n    height: F(a, t, \"Height\", r, e.height),\n    scaleX: F(a, t, \"ScaleX\", r, e.scaleX),\n    angle: F(a, t, \"Rotation\", r, e.rotation),\n    offsetX: F(a, t, \"OffsetX\", r, e.offsetX),\n    offsetY: F(a, t, \"OffsetY\", r, e.offsetY)\n  });\n}\n\nfunction L(e, t, i, r, n) {\n  const a = [\"Rotation\", \"OffsetX\", \"OffsetY\"],\n        l = i.filter(t => t.primitiveName !== e.primitiveName && -1 === a.indexOf(t.propertyName)),\n        s = e.primitiveName,\n        [c, f] = D(i, s),\n        m = o(JSON.stringify(e) + f).toString(),\n        p = o(`${e.separation}${JSON.stringify(e.lineSymbol)}`).toString();\n  n.push({\n    type: \"fill\",\n    templateHash: m,\n    materialHash: c ? W(p, t, l, r) : p,\n    cim: e,\n    materialOverrides: l,\n    colorLocked: e.colorLocked,\n    effects: e.effects,\n    color: {\n      r: 255,\n      g: 255,\n      b: 255,\n      a: 1\n    },\n    height: F(s, t, \"Separation\", r, e.separation),\n    scaleX: 1,\n    angle: F(s, t, \"Rotation\", r, e.rotation),\n    offsetX: F(s, t, \"OffsetX\", r, e.offsetX),\n    offsetY: F(s, t, \"OffsetY\", r, e.offsetY)\n  });\n}\n\nfunction M(e, t, i, r, n) {\n  const a = e.primitiveName,\n        [l, s] = D(i, a),\n        c = o(JSON.stringify(e) + s).toString();\n  n.push({\n    type: \"fill\",\n    templateHash: c,\n    materialHash: l ? W(c, t, i, r) : c,\n    cim: e,\n    materialOverrides: null,\n    colorLocked: e.colorLocked,\n    effects: e.effects,\n    color: {\n      r: 128,\n      g: 128,\n      b: 128,\n      a: 1\n    },\n    height: 0,\n    angle: 0,\n    offsetX: 0,\n    offsetY: 0,\n    scaleX: 1\n  });\n}\n\nfunction X(e, t, i, r, n, a, l) {\n  const s = e.primitiveName,\n        c = f(e.color),\n        m = void 0 !== e.width ? e.width : 4,\n        p = y(e.capStyle),\n        u = h(e.joinStyle),\n        g = e.miterLimit,\n        [d, S] = D(i, s),\n        v = o(JSON.stringify(e) + S).toString();\n  n.push({\n    type: \"line\",\n    templateHash: v,\n    materialHash: d ? () => v : v,\n    cim: e,\n    materialOverrides: null,\n    isOutline: a,\n    colorLocked: e.colorLocked,\n    effects: e.effects,\n    color: F(s, t, \"Color\", r, c, j),\n    width: F(s, t, \"Width\", r, m),\n    cap: F(s, t, \"CapStyle\", r, p),\n    join: F(s, t, \"JoinStyle\", r, u),\n    miterLimit: F(s, t, \"MiterLimit\", r, g),\n    referenceWidth: l,\n    zOrder: A(e.name),\n    isDashed: !1\n  });\n}\n\nfunction I(e, t, i, r, n, a, l) {\n  const s = o(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),\n        c = e.primitiveName,\n        m = f(e.tintColor),\n        p = void 0 !== e.width ? e.width : 4,\n        u = y(e.capStyle),\n        g = h(e.joinStyle),\n        d = e.miterLimit,\n        [S, v] = D(i, c),\n        N = o(JSON.stringify(e) + v).toString();\n  n.push({\n    type: \"line\",\n    templateHash: N,\n    materialHash: S ? () => s : s,\n    cim: e,\n    materialOverrides: null,\n    isOutline: a,\n    colorLocked: e.colorLocked,\n    effects: e.effects,\n    color: F(c, t, \"TintColor\", r, m, j),\n    width: F(c, t, \"Width\", r, p),\n    cap: F(c, t, \"CapStyle\", r, u),\n    join: F(c, t, \"JoinStyle\", r, g),\n    miterLimit: F(c, t, \"MiterLimit\", r, d),\n    referenceWidth: l,\n    zOrder: A(e.name),\n    isDashed: !1\n  });\n}\n\nfunction x(e, t, i, r, n, a, l) {\n  const s = e.primitiveName,\n        c = void 0 !== e.width ? e.width : 4,\n        f = y(e.capStyle),\n        m = h(e.joinStyle),\n        p = e.miterLimit,\n        [u, g] = D(i, s),\n        d = o(JSON.stringify(e) + g).toString();\n  n.push({\n    type: \"line\",\n    templateHash: d,\n    materialHash: u ? W(d, t, i, r) : d,\n    cim: e,\n    materialOverrides: null,\n    isOutline: a,\n    colorLocked: e.colorLocked,\n    effects: e.effects,\n    color: {\n      r: 128,\n      g: 128,\n      b: 128,\n      a: 1\n    },\n    width: F(s, t, \"Width\", r, c),\n    cap: F(s, t, \"CapStyle\", r, f),\n    join: F(s, t, \"JoinStyle\", r, m),\n    miterLimit: F(s, t, \"MiterLimit\", r, p),\n    referenceWidth: l,\n    zOrder: A(e.name),\n    isDashed: !1\n  });\n}\n\nfunction w(e, t, i, r, n) {\n  const a = e.markerPlacement;\n  if (!a || \"CIMMarkerPlacementInsidePolygon\" !== a.type) return !1;\n  const l = a,\n        s = [\"Rotation\", \"OffsetX\", \"OffsetY\"],\n        c = i.filter(t => t.primitiveName !== e.primitiveName && -1 === s.indexOf(t.propertyName)),\n        [f, m] = D(i, l.primitiveName),\n        p = o(JSON.stringify(e) + m).toString();\n  return n.push({\n    type: \"fill\",\n    templateHash: p,\n    materialHash: f ? W(p, t, c, r) : p,\n    cim: e,\n    materialOverrides: c,\n    colorLocked: e.colorLocked,\n    effects: e.effects,\n    color: {\n      r: 255,\n      g: 255,\n      b: 255,\n      a: 1\n    },\n    height: F(l.primitiveName, t, \"StepY\", r, l.stepY),\n    scaleX: 1,\n    angle: F(l.primitiveName, t, \"GridAngle\", r, l.gridAngle),\n    offsetX: F(l.primitiveName, t, \"OffsetX\", r, l.offsetX),\n    offsetY: F(l.primitiveName, t, \"OffsetY\", r, l.offsetY)\n  }), !0;\n}\n\nfunction z(e, t, i, r, n, a, l) {\n  const s = e.primitiveName,\n        c = e.size,\n        m = e.scaleX,\n        p = e.rotation,\n        u = e.offsetX,\n        y = e.offsetY,\n        h = f(e.tintColor),\n        g = o(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),\n        [d, S] = D(i, s),\n        v = o(JSON.stringify(e) + S).toString();\n  n.push({\n    type: \"marker\",\n    templateHash: v,\n    materialHash: d ? () => g : g,\n    cim: e,\n    materialOverrides: null,\n    colorLocked: e.colorLocked,\n    effects: e.effects,\n    scaleSymbolsProportionally: !1,\n    alignment: a,\n    size: F(s, t, \"Size\", r, c),\n    scaleX: F(s, t, \"ScaleX\", r, m),\n    rotation: F(s, t, \"Rotation\", r, p),\n    offsetX: F(s, t, \"OffsetX\", r, u),\n    offsetY: F(s, t, \"OffsetY\", r, y),\n    color: F(s, t, \"TintColor\", r, h, j),\n    anchorPoint: e.anchorPoint,\n    isAbsoluteAnchorPoint: \"Relative\" !== e.anchorPointUnits,\n    outlineColor: {\n      r: 0,\n      g: 0,\n      b: 0,\n      a: 0\n    },\n    outlineWidth: 0,\n    frameHeight: 0,\n    rotateClockwise: e.rotateClockwise,\n    referenceSize: l,\n    sizeRatio: 1,\n    markerPlacement: e.markerPlacement\n  });\n}\n\nfunction J(e, t, i, o, r, n, a, l) {\n  const s = e.markerGraphics;\n  if (!s) return;\n  let c = 0;\n\n  if (e.scaleSymbolsProportionally) {\n    const t = e.frame;\n    t && (c = t.ymax - t.ymin);\n  }\n\n  for (const f of s) if (f) {\n    const s = f.symbol;\n    if (!s) continue;\n\n    switch (s.type) {\n      case \"CIMPointSymbol\":\n      case \"CIMLineSymbol\":\n      case \"CIMPolygonSymbol\":\n        Y(e, f, i, t, o, r, n, a, c, l);\n        break;\n\n      case \"CIMTextSymbol\":\n        H(e, f, t, i, o, r, n, a, c);\n    }\n  }\n}\n\nfunction H(e, t, i, r, n, s, c, p, u) {\n  const y = [];\n  l.findApplicableOverrides(t, r, y);\n  const h = t.geometry;\n  if (!(\"x\" in h) || !(\"y\" in h)) return;\n  const N = t.symbol,\n        b = v(N),\n        k = S(N.fontStyleName);\n  N.font = {\n    family: N.fontFamilyName,\n    decoration: b,\n    ...k\n  };\n  const O = e.frame,\n        C = h.x - .5 * (O.xmin + O.xmax),\n        P = h.y - .5 * (O.ymin + O.ymax),\n        L = e.size / u,\n        M = e.primitiveName,\n        X = (N.height || 0) * L,\n        I = N.angle || 0,\n        x = ((N.offsetX || 0) + C) * L,\n        w = ((N.offsetY || 0) + P) * L,\n        z = f(a.getFillColor(N));\n  let J = f(a.getStrokeColor(N)),\n      H = a.getStrokeWidth(N);\n  H || (J = f(a.getFillColor(N.haloSymbol)), H = N.haloSize * L);\n  let Y = \"\";\n\n  for (const o of r) o.primitiveName === M && void 0 !== o.value && (Y += `-${o.primitiveName}-${o.propertyName}-${JSON.stringify(o.value)}`);\n\n  const R = JSON.stringify(e.effects) + Number(e.colorLocked) + JSON.stringify(e.anchorPoint) + e.anchorPointUnits + JSON.stringify(e.markerPlacement),\n        $ = o(JSON.stringify(t) + R + Y).toString();\n  s.push({\n    type: \"text\",\n    templateHash: $,\n    materialHash: () => o(JSON.stringify(N.font)).toString(),\n    cim: N,\n    materialOverrides: null,\n    colorLocked: e.colorLocked,\n    effects: e.effects,\n    alignment: c,\n    anchorPoint: {\n      x: e.anchorPoint ? e.anchorPoint.x : 0,\n      y: e.anchorPoint ? e.anchorPoint.y : 0\n    },\n    isAbsoluteAnchorPoint: \"Relative\" !== e.anchorPointUnits,\n    fontName: N.fontFamilyName,\n    decoration: \"none\",\n    weight: \"normal\",\n    style: \"normal\",\n    size: F(M, i, \"Size\", n, X),\n    angle: F(M, i, \"Rotation\", n, I),\n    offsetX: F(M, i, \"OffsetX\", n, x),\n    offsetY: F(M, i, \"OffsetY\", n, w),\n    horizontalAlignment: g(N.horizontalAlignment),\n    verticalAlignment: d(N.verticalAlignment),\n    text: F(t.primitiveName, i, \"TextString\", n, t.textString, m, N.textCase),\n    color: z,\n    outlineColor: J,\n    outlineSize: H,\n    referenceSize: p,\n    sizeRatio: 1,\n    markerPlacement: e.markerPlacement\n  });\n}\n\nfunction Y(e, t, i, r, n, l, m, p, u, y) {\n  const h = t.symbol,\n        g = t.geometry;\n  if (!g) return;\n  const d = h.symbolLayers;\n  if (!d) return;\n  if (y) return void R(e, t, r, i, n, l, m, p, u);\n  let S = d.length;\n\n  for (; S--;) {\n    const y = d[S];\n    if (y && !1 !== y.enable) switch (y.type) {\n      case \"CIMSolidFill\":\n      case \"CIMSolidStroke\":\n        {\n          const h = s(g);\n          if (!h) continue;\n          const [d, S, v] = c(h, e.frame, e.size, e.anchorPoint, \"Relative\" !== e.anchorPointUnits),\n                N = \"CIMSolidFill\" === y.type,\n                b = {\n            type: \"sdf\",\n            geom: g,\n            asFill: N\n          },\n                k = e.primitiveName,\n                O = e.size,\n                C = e.rotation || 0,\n                P = e.offsetX,\n                L = e.offsetY,\n                M = y.primitiveName,\n                X = f(N ? a.getFillColor(y) : a.getStrokeColor(y)),\n                I = N ? {\n            r: 0,\n            g: 0,\n            b: 0,\n            a: 0\n          } : f(a.getStrokeColor(y)),\n                x = a.getStrokeWidth(y);\n          if (!N && !x) break;\n          let w = !1,\n              z = \"\";\n\n          for (const e of i) e.primitiveName !== M && e.primitiveName !== k || (void 0 !== e.value ? z += `-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}` : e.valueExpressionInfo && (w = !0));\n\n          const J = JSON.stringify({ ...e,\n            markerGraphics: null\n          }),\n                H = o(JSON.stringify(b)).toString(),\n                Y = {\n            type: \"marker\",\n            templateHash: o(JSON.stringify(t) + JSON.stringify(y) + J + z).toString(),\n            materialHash: w ? () => H : H,\n            cim: b,\n            materialOverrides: null,\n            colorLocked: e.colorLocked,\n            effects: e.effects,\n            scaleSymbolsProportionally: e.scaleSymbolsProportionally,\n            alignment: m,\n            anchorPoint: {\n              x: S,\n              y: v\n            },\n            isAbsoluteAnchorPoint: !1,\n            size: F(e.primitiveName, r, \"Size\", n, O),\n            rotation: F(e.primitiveName, r, \"Rotation\", n, C),\n            offsetX: F(e.primitiveName, r, \"OffsetX\", n, P),\n            offsetY: F(e.primitiveName, r, \"OffsetY\", n, L),\n            scaleX: 1,\n            frameHeight: u,\n            rotateClockwise: e.rotateClockwise,\n            referenceSize: p,\n            sizeRatio: d,\n            color: F(M, r, \"Color\", n, X, j),\n            outlineColor: F(M, r, \"Color\", n, I, j),\n            outlineWidth: F(M, r, \"Width\", n, x),\n            markerPlacement: e.markerPlacement\n          };\n          l.push(Y);\n          break;\n        }\n\n      default:\n        R(e, t, r, i, n, l, m, p, u);\n    }\n  }\n}\n\nfunction R(e, t, r, n, l, s, c, f, m) {\n  const p = $(e, t);\n  let u = [];\n  const y = [\"Rotation\", \"OffsetX\", \"OffsetY\"];\n  u = n.filter(t => t.primitiveName !== e.primitiveName || -1 === y.indexOf(t.propertyName));\n  let h = \"\";\n\n  for (const i of n) void 0 !== i.value && (h += `-${i.primitiveName}-${i.propertyName}-${JSON.stringify(i.value)}`);\n\n  const [g, d, S] = a.getTextureAnchor(p),\n        v = e.primitiveName,\n        N = e.rotation || 0,\n        b = e.offsetX || 0,\n        k = e.offsetY || 0,\n        O = o(JSON.stringify(p) + h).toString(),\n        C = {\n    type: \"marker\",\n    templateHash: O,\n    materialHash: 0 === u.length ? O : W(O, r, u, l),\n    cim: p,\n    materialOverrides: u,\n    colorLocked: e.colorLocked,\n    effects: e.effects,\n    scaleSymbolsProportionally: e.scaleSymbolsProportionally,\n    alignment: c,\n    anchorPoint: {\n      x: g,\n      y: d\n    },\n    isAbsoluteAnchorPoint: !1,\n    size: e.size,\n    rotation: F(v, r, \"Rotation\", l, N),\n    offsetX: F(v, r, \"OffsetX\", l, b),\n    offsetY: F(v, r, \"OffsetY\", l, k),\n    color: {\n      r: 0,\n      g: 0,\n      b: 0,\n      a: 0\n    },\n    outlineColor: {\n      r: 0,\n      g: 0,\n      b: 0,\n      a: 0\n    },\n    outlineWidth: 0,\n    scaleX: 1,\n    frameHeight: m,\n    rotateClockwise: e.rotateClockwise,\n    referenceSize: f,\n    sizeRatio: S / i(e.size),\n    markerPlacement: e.markerPlacement\n  };\n  s.push(C);\n}\n\nfunction $(e, t) {\n  return {\n    type: e.type,\n    enable: !0,\n    name: e.name,\n    colorLocked: e.colorLocked,\n    primitiveName: e.primitiveName,\n    anchorPoint: e.anchorPoint,\n    anchorPointUnits: e.anchorPointUnits,\n    offsetX: 0,\n    offsetY: 0,\n    rotateClockwise: e.rotateClockwise,\n    rotation: 0,\n    size: e.size,\n    billboardMode3D: e.billboardMode3D,\n    depth3D: e.depth3D,\n    frame: e.frame,\n    markerGraphics: [t],\n    scaleSymbolsProportionally: e.scaleSymbolsProportionally,\n    respectFrame: e.respectFrame,\n    clippingPath: e.clippingPath,\n    effects: e.effects\n  };\n}\n\nfunction A(e) {\n  if (e && 0 === e.indexOf(\"Level_\")) {\n    const t = parseInt(e.substr(6), 10);\n    if (NaN !== t) return t;\n  }\n\n  return 0;\n}\n\nfunction j(t) {\n  if (!t || 0 === t.length) return null;\n  const i = new e(t).toRgba();\n  return {\n    r: i[0],\n    g: i[1],\n    b: i[2],\n    a: i[3]\n  };\n}\n\nfunction F(e, t, i, o, r, a, l) {\n  const s = t[e];\n\n  if (s) {\n    const e = s[i];\n    if (\"string\" == typeof e || \"number\" == typeof e || e instanceof Array) return a ? a.call(null, e, l) : e;\n    if (null != e && e instanceof n) return (t, i, n) => {\n      let s = p(e, t, {\n        $view: n\n      }, o.geometryType, i);\n      return null !== s && a && (s = a.call(null, s, l)), null !== s ? s : r;\n    };\n  }\n\n  return r;\n}\n\nfunction W(e, t, i, r) {\n  for (const o of i) {\n    if (o.valueExpressionInfo) {\n      const e = t[o.primitiveName] && t[o.primitiveName][o.propertyName];\n      e instanceof n && (o.fn = (t, i, o) => p(e, t, {\n        $view: o\n      }, r.geometryType, i));\n    }\n  }\n\n  return (t, r, n) => {\n    for (const e of i) e.fn && (e.value = e.fn(t, r, n));\n\n    return o(e + l.buildOverrideKey(i)).toString();\n  };\n}\n\nfunction T(e, t) {\n  if (!t || 0 === t.length) return e;\n  const i = JSON.parse(JSON.stringify(e));\n  return l.applyOverrides(i, t), i;\n}\n\nfunction D(e, t) {\n  let i = !1,\n      o = \"\";\n\n  for (const r of e) r.primitiveName === t && (void 0 !== r.value ? o += `-${r.primitiveName}-${r.propertyName}-${JSON.stringify(r.value)}` : r.valueExpressionInfo && (i = !0));\n\n  return [i, o];\n}\n\nexport { T as analyzeCIMResource, k as analyzeCIMSymbol };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/symbols/cim/cimAnalyzer.js"],"names":["e","t","pt2px","i","numericHash","o","createRendererExpression","r","ArcadeExpression","n","CIMSymbolHelper","a","OverrideHelper","l","getExtent","s","getSDFMetrics","c","fromCIMColor","f","_adjustTextCase","m","p","u","getLogger","y","h","g","d","S","toLowerCase","indexOf","style","weight","v","underline","strikethrough","N","b","markerPlacement","angleToLine","k","type","error","symbol","primitiveOverrides","valueExpressionInfo","expression","spatialReference","fields","then","primitiveName","propertyName","push","value","Promise","all","O","symbolLayers","getSize","angleAlignment","length","enable","findApplicableOverrides","C","P","L","M","X","I","x","w","z","J","color","D","JSON","stringify","toString","templateHash","materialHash","cim","materialOverrides","colorLocked","F","j","height","angle","offsetX","offsetY","scaleX","effects","tintColor","url","colorSubstitutions","rotation","filter","separation","lineSymbol","W","width","capStyle","joinStyle","miterLimit","isOutline","cap","join","referenceWidth","zOrder","A","name","isDashed","stepY","gridAngle","size","scaleSymbolsProportionally","alignment","anchorPoint","isAbsoluteAnchorPoint","anchorPointUnits","outlineColor","outlineWidth","frameHeight","rotateClockwise","referenceSize","sizeRatio","markerGraphics","frame","ymax","ymin","Y","H","geometry","fontStyleName","font","family","fontFamilyName","decoration","xmin","xmax","getFillColor","getStrokeColor","getStrokeWidth","haloSymbol","haloSize","R","Number","$","fontName","horizontalAlignment","verticalAlignment","text","textString","textCase","outlineSize","geom","asFill","getTextureAnchor","billboardMode3D","depth3D","respectFrame","clippingPath","parseInt","substr","NaN","toRgba","Array","call","$view","geometryType","fn","buildOverrideKey","T","parse","applyOverrides","analyzeCIMResource","analyzeCIMSymbol"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../Color.js\";import t from\"../../core/Logger.js\";import{pt2px as i}from\"../../core/screenUtils.js\";import{numericHash as o}from\"../../core/string.js\";import{createRendererExpression as r,ArcadeExpression as n}from\"../../support/arcadeOnDemand.js\";import{CIMSymbolHelper as a,OverrideHelper as l}from\"./CIMSymbolHelper.js\";import{getExtent as s,getSDFMetrics as c}from\"./SDFHelper.js\";import{fromCIMColor as f,_adjustTextCase as m}from\"./utils.js\";import p from\"../../views/2d/arcade/callExpressionWithFeature.js\";const u=t.getLogger(\"esri.symbols.cim.cimAnalyzer\");function y(e){switch(e){case\"Butt\":return 0;case\"Square\":return 2;case\"Round\":default:return 1}}function h(e){switch(e){case\"Bevel\":return 0;case\"Miter\":return 2;case\"Round\":default:return 1}}function g(e){switch(e){case\"Left\":default:return\"left\";case\"Right\":return\"right\";case\"Center\":return\"center\";case\"Justify\":return\"justify\"}}function d(e){switch(e){case\"Top\":default:return\"top\";case\"Center\":return\"middle\";case\"Baseline\":return\"baseline\";case\"Bottom\":return\"bottom\"}}function S(e){let t=\"normal\",i=\"normal\";if(e){const o=e.toLowerCase();-1!==o.indexOf(\"italic\")?t=\"italic\":-1!==o.indexOf(\"oblique\")&&(t=\"oblique\"),-1!==o.indexOf(\"bold\")?i=\"bold\":-1!==o.indexOf(\"light\")&&(i=\"lighter\")}return{style:t,weight:i}}function v(e){return e.underline?\"underline\":e.strikethrough?\"line-through\":\"none\"}function N(e,t,i,o){let r;e[t]?r=e[t]:(r={},e[t]=r),r[i]=o}function b(e){const t=e.markerPlacement;return t&&t.angleToLine?1:0}async function k(e,t,i,o){const n=null!=i?i:[];if(!e)return n;let a,l;const s={};if(\"CIMSymbolReference\"!==e.type)return u.error(\"Expect cim type to be 'CIMSymbolReference'\"),n;if(a=e.symbol,l=e.primitiveOverrides,l){const e=[];for(const i of l){const o=i.valueExpressionInfo;if(o&&t){const n=o.expression,a=r(n,t.spatialReference,t.fields).then((e=>{e&&N(s,i.primitiveName,i.propertyName,e)}));e.push(a)}else null!=i.value&&N(s,i.primitiveName,i.propertyName,i.value)}await Promise.all(e)}switch(a.type){case\"CIMPointSymbol\":case\"CIMLineSymbol\":case\"CIMPolygonSymbol\":O(a,l,s,t,n,o)}return n}function O(e,t,i,o,r,n){if(!e)return;const s=e.symbolLayers;if(!s)return;let c;const f=a.getSize(e);\"CIMPointSymbol\"===e.type&&\"Map\"===e.angleAlignment&&(c=1);let m=s.length;for(;m--;){const a=s[m];if(!a||!1===a.enable)continue;const p=[];switch(l.findApplicableOverrides(a,t,p),a.type){case\"CIMSolidFill\":C(a,i,p,o,r);break;case\"CIMPictureFill\":P(a,i,p,o,r);break;case\"CIMHatchFill\":L(a,i,p,o,r);break;case\"CIMGradientFill\":M(a,i,p,o,r);break;case\"CIMSolidStroke\":X(a,i,p,o,r,\"CIMPolygonSymbol\"===e.type,f);break;case\"CIMPictureStroke\":I(a,i,p,o,r,\"CIMPolygonSymbol\"===e.type,f);break;case\"CIMGradientStroke\":x(a,i,p,o,r,\"CIMPolygonSymbol\"===e.type,f);break;case\"CIMCharacterMarker\":if(w(a,i,p,o,r))break;break;case\"CIMPictureMarker\":if(w(a,i,p,o,r))break;\"CIMLineSymbol\"===e.type&&(c=b(a)),z(a,i,p,o,r,c,f);break;case\"CIMVectorMarker\":if(w(a,i,p,o,r))break;\"CIMLineSymbol\"===e.type&&(c=b(a)),J(a,i,p,o,r,c,f,n);break;default:u.error(\"Cannot analyze CIM layer\",a.type)}}}function C(e,t,i,r,n){const a=e.primitiveName,l=f(e.color),[s,c]=D(i,a),m=o(JSON.stringify(e)+c).toString();n.push({type:\"fill\",templateHash:m,materialHash:s?()=>m:m,cim:e,materialOverrides:null,colorLocked:e.colorLocked,color:F(a,t,\"Color\",r,l,j),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:e.effects})}function P(e,t,i,r,n){const a=e.primitiveName,l=e.tintColor?f(e.tintColor):{r:255,g:255,b:255,a:1},[s,c]=D(i,a),m=o(JSON.stringify(e)+c).toString(),p=o(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString();n.push({type:\"fill\",templateHash:m,materialHash:s?()=>p:p,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:F(a,t,\"TintColor\",r,l,j),height:F(a,t,\"Height\",r,e.height),scaleX:F(a,t,\"ScaleX\",r,e.scaleX),angle:F(a,t,\"Rotation\",r,e.rotation),offsetX:F(a,t,\"OffsetX\",r,e.offsetX),offsetY:F(a,t,\"OffsetY\",r,e.offsetY)})}function L(e,t,i,r,n){const a=[\"Rotation\",\"OffsetX\",\"OffsetY\"],l=i.filter((t=>t.primitiveName!==e.primitiveName&&-1===a.indexOf(t.propertyName))),s=e.primitiveName,[c,f]=D(i,s),m=o(JSON.stringify(e)+f).toString(),p=o(`${e.separation}${JSON.stringify(e.lineSymbol)}`).toString();n.push({type:\"fill\",templateHash:m,materialHash:c?W(p,t,l,r):p,cim:e,materialOverrides:l,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:F(s,t,\"Separation\",r,e.separation),scaleX:1,angle:F(s,t,\"Rotation\",r,e.rotation),offsetX:F(s,t,\"OffsetX\",r,e.offsetX),offsetY:F(s,t,\"OffsetY\",r,e.offsetY)})}function M(e,t,i,r,n){const a=e.primitiveName,[l,s]=D(i,a),c=o(JSON.stringify(e)+s).toString();n.push({type:\"fill\",templateHash:c,materialHash:l?W(c,t,i,r):c,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function X(e,t,i,r,n,a,l){const s=e.primitiveName,c=f(e.color),m=void 0!==e.width?e.width:4,p=y(e.capStyle),u=h(e.joinStyle),g=e.miterLimit,[d,S]=D(i,s),v=o(JSON.stringify(e)+S).toString();n.push({type:\"line\",templateHash:v,materialHash:d?()=>v:v,cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:e.effects,color:F(s,t,\"Color\",r,c,j),width:F(s,t,\"Width\",r,m),cap:F(s,t,\"CapStyle\",r,p),join:F(s,t,\"JoinStyle\",r,u),miterLimit:F(s,t,\"MiterLimit\",r,g),referenceWidth:l,zOrder:A(e.name),isDashed:!1})}function I(e,t,i,r,n,a,l){const s=o(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),c=e.primitiveName,m=f(e.tintColor),p=void 0!==e.width?e.width:4,u=y(e.capStyle),g=h(e.joinStyle),d=e.miterLimit,[S,v]=D(i,c),N=o(JSON.stringify(e)+v).toString();n.push({type:\"line\",templateHash:N,materialHash:S?()=>s:s,cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:e.effects,color:F(c,t,\"TintColor\",r,m,j),width:F(c,t,\"Width\",r,p),cap:F(c,t,\"CapStyle\",r,u),join:F(c,t,\"JoinStyle\",r,g),miterLimit:F(c,t,\"MiterLimit\",r,d),referenceWidth:l,zOrder:A(e.name),isDashed:!1})}function x(e,t,i,r,n,a,l){const s=e.primitiveName,c=void 0!==e.width?e.width:4,f=y(e.capStyle),m=h(e.joinStyle),p=e.miterLimit,[u,g]=D(i,s),d=o(JSON.stringify(e)+g).toString();n.push({type:\"line\",templateHash:d,materialHash:u?W(d,t,i,r):d,cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},width:F(s,t,\"Width\",r,c),cap:F(s,t,\"CapStyle\",r,f),join:F(s,t,\"JoinStyle\",r,m),miterLimit:F(s,t,\"MiterLimit\",r,p),referenceWidth:l,zOrder:A(e.name),isDashed:!1})}function w(e,t,i,r,n){const a=e.markerPlacement;if(!a||\"CIMMarkerPlacementInsidePolygon\"!==a.type)return!1;const l=a,s=[\"Rotation\",\"OffsetX\",\"OffsetY\"],c=i.filter((t=>t.primitiveName!==e.primitiveName&&-1===s.indexOf(t.propertyName))),[f,m]=D(i,l.primitiveName),p=o(JSON.stringify(e)+m).toString();return n.push({type:\"fill\",templateHash:p,materialHash:f?W(p,t,c,r):p,cim:e,materialOverrides:c,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:F(l.primitiveName,t,\"StepY\",r,l.stepY),scaleX:1,angle:F(l.primitiveName,t,\"GridAngle\",r,l.gridAngle),offsetX:F(l.primitiveName,t,\"OffsetX\",r,l.offsetX),offsetY:F(l.primitiveName,t,\"OffsetY\",r,l.offsetY)}),!0}function z(e,t,i,r,n,a,l){const s=e.primitiveName,c=e.size,m=e.scaleX,p=e.rotation,u=e.offsetX,y=e.offsetY,h=f(e.tintColor),g=o(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),[d,S]=D(i,s),v=o(JSON.stringify(e)+S).toString();n.push({type:\"marker\",templateHash:v,materialHash:d?()=>g:g,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:!1,alignment:a,size:F(s,t,\"Size\",r,c),scaleX:F(s,t,\"ScaleX\",r,m),rotation:F(s,t,\"Rotation\",r,p),offsetX:F(s,t,\"OffsetX\",r,u),offsetY:F(s,t,\"OffsetY\",r,y),color:F(s,t,\"TintColor\",r,h,j),anchorPoint:e.anchorPoint,isAbsoluteAnchorPoint:\"Relative\"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:e.rotateClockwise,referenceSize:l,sizeRatio:1,markerPlacement:e.markerPlacement})}function J(e,t,i,o,r,n,a,l){const s=e.markerGraphics;if(!s)return;let c=0;if(e.scaleSymbolsProportionally){const t=e.frame;t&&(c=t.ymax-t.ymin)}for(const f of s)if(f){const s=f.symbol;if(!s)continue;switch(s.type){case\"CIMPointSymbol\":case\"CIMLineSymbol\":case\"CIMPolygonSymbol\":Y(e,f,i,t,o,r,n,a,c,l);break;case\"CIMTextSymbol\":H(e,f,t,i,o,r,n,a,c)}}}function H(e,t,i,r,n,s,c,p,u){const y=[];l.findApplicableOverrides(t,r,y);const h=t.geometry;if(!(\"x\"in h)||!(\"y\"in h))return;const N=t.symbol,b=v(N),k=S(N.fontStyleName);N.font={family:N.fontFamilyName,decoration:b,...k};const O=e.frame,C=h.x-.5*(O.xmin+O.xmax),P=h.y-.5*(O.ymin+O.ymax),L=e.size/u,M=e.primitiveName,X=(N.height||0)*L,I=N.angle||0,x=((N.offsetX||0)+C)*L,w=((N.offsetY||0)+P)*L,z=f(a.getFillColor(N));let J=f(a.getStrokeColor(N)),H=a.getStrokeWidth(N);H||(J=f(a.getFillColor(N.haloSymbol)),H=N.haloSize*L);let Y=\"\";for(const o of r)o.primitiveName===M&&void 0!==o.value&&(Y+=`-${o.primitiveName}-${o.propertyName}-${JSON.stringify(o.value)}`);const R=JSON.stringify(e.effects)+Number(e.colorLocked)+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement),$=o(JSON.stringify(t)+R+Y).toString();s.push({type:\"text\",templateHash:$,materialHash:()=>o(JSON.stringify(N.font)).toString(),cim:N,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,alignment:c,anchorPoint:{x:e.anchorPoint?e.anchorPoint.x:0,y:e.anchorPoint?e.anchorPoint.y:0},isAbsoluteAnchorPoint:\"Relative\"!==e.anchorPointUnits,fontName:N.fontFamilyName,decoration:\"none\",weight:\"normal\",style:\"normal\",size:F(M,i,\"Size\",n,X),angle:F(M,i,\"Rotation\",n,I),offsetX:F(M,i,\"OffsetX\",n,x),offsetY:F(M,i,\"OffsetY\",n,w),horizontalAlignment:g(N.horizontalAlignment),verticalAlignment:d(N.verticalAlignment),text:F(t.primitiveName,i,\"TextString\",n,t.textString,m,N.textCase),color:z,outlineColor:J,outlineSize:H,referenceSize:p,sizeRatio:1,markerPlacement:e.markerPlacement})}function Y(e,t,i,r,n,l,m,p,u,y){const h=t.symbol,g=t.geometry;if(!g)return;const d=h.symbolLayers;if(!d)return;if(y)return void R(e,t,r,i,n,l,m,p,u);let S=d.length;for(;S--;){const y=d[S];if(y&&!1!==y.enable)switch(y.type){case\"CIMSolidFill\":case\"CIMSolidStroke\":{const h=s(g);if(!h)continue;const[d,S,v]=c(h,e.frame,e.size,e.anchorPoint,\"Relative\"!==e.anchorPointUnits),N=\"CIMSolidFill\"===y.type,b={type:\"sdf\",geom:g,asFill:N},k=e.primitiveName,O=e.size,C=e.rotation||0,P=e.offsetX,L=e.offsetY,M=y.primitiveName,X=f(N?a.getFillColor(y):a.getStrokeColor(y)),I=N?{r:0,g:0,b:0,a:0}:f(a.getStrokeColor(y)),x=a.getStrokeWidth(y);if(!N&&!x)break;let w=!1,z=\"\";for(const e of i)e.primitiveName!==M&&e.primitiveName!==k||(void 0!==e.value?z+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`:e.valueExpressionInfo&&(w=!0));const J=JSON.stringify({...e,markerGraphics:null}),H=o(JSON.stringify(b)).toString(),Y={type:\"marker\",templateHash:o(JSON.stringify(t)+JSON.stringify(y)+J+z).toString(),materialHash:w?()=>H:H,cim:b,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:m,anchorPoint:{x:S,y:v},isAbsoluteAnchorPoint:!1,size:F(e.primitiveName,r,\"Size\",n,O),rotation:F(e.primitiveName,r,\"Rotation\",n,C),offsetX:F(e.primitiveName,r,\"OffsetX\",n,P),offsetY:F(e.primitiveName,r,\"OffsetY\",n,L),scaleX:1,frameHeight:u,rotateClockwise:e.rotateClockwise,referenceSize:p,sizeRatio:d,color:F(M,r,\"Color\",n,X,j),outlineColor:F(M,r,\"Color\",n,I,j),outlineWidth:F(M,r,\"Width\",n,x),markerPlacement:e.markerPlacement};l.push(Y);break}default:R(e,t,r,i,n,l,m,p,u)}}}function R(e,t,r,n,l,s,c,f,m){const p=$(e,t);let u=[];const y=[\"Rotation\",\"OffsetX\",\"OffsetY\"];u=n.filter((t=>t.primitiveName!==e.primitiveName||-1===y.indexOf(t.propertyName)));let h=\"\";for(const i of n)void 0!==i.value&&(h+=`-${i.primitiveName}-${i.propertyName}-${JSON.stringify(i.value)}`);const[g,d,S]=a.getTextureAnchor(p),v=e.primitiveName,N=e.rotation||0,b=e.offsetX||0,k=e.offsetY||0,O=o(JSON.stringify(p)+h).toString(),C={type:\"marker\",templateHash:O,materialHash:0===u.length?O:W(O,r,u,l),cim:p,materialOverrides:u,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:c,anchorPoint:{x:g,y:d},isAbsoluteAnchorPoint:!1,size:e.size,rotation:F(v,r,\"Rotation\",l,N),offsetX:F(v,r,\"OffsetX\",l,b),offsetY:F(v,r,\"OffsetY\",l,k),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:m,rotateClockwise:e.rotateClockwise,referenceSize:f,sizeRatio:S/i(e.size),markerPlacement:e.markerPlacement};s.push(C)}function $(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath,effects:e.effects}}function A(e){if(e&&0===e.indexOf(\"Level_\")){const t=parseInt(e.substr(6),10);if(NaN!==t)return t}return 0}function j(t){if(!t||0===t.length)return null;const i=new e(t).toRgba();return{r:i[0],g:i[1],b:i[2],a:i[3]}}function F(e,t,i,o,r,a,l){const s=t[e];if(s){const e=s[i];if(\"string\"==typeof e||\"number\"==typeof e||e instanceof Array)return a?a.call(null,e,l):e;if(null!=e&&e instanceof n)return(t,i,n)=>{let s=p(e,t,{$view:n},o.geometryType,i);return null!==s&&a&&(s=a.call(null,s,l)),null!==s?s:r}}return r}function W(e,t,i,r){for(const o of i){if(o.valueExpressionInfo){const e=t[o.primitiveName]&&t[o.primitiveName][o.propertyName];e instanceof n&&(o.fn=(t,i,o)=>p(e,t,{$view:o},r.geometryType,i))}}return(t,r,n)=>{for(const e of i)e.fn&&(e.value=e.fn(t,r,n));return o(e+l.buildOverrideKey(i)).toString()}}function T(e,t){if(!t||0===t.length)return e;const i=JSON.parse(JSON.stringify(e));return l.applyOverrides(i,t),i}function D(e,t){let i=!1,o=\"\";for(const r of e)r.primitiveName===t&&(void 0!==r.value?o+=`-${r.primitiveName}-${r.propertyName}-${JSON.stringify(r.value)}`:r.valueExpressionInfo&&(i=!0));return[i,o]}export{T as analyzeCIMResource,k as analyzeCIMSymbol};\n"]},"metadata":{},"sourceType":"module"}