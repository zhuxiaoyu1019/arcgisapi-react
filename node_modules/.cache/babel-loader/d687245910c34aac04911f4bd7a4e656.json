{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { deg2rad as t, rad2deg as e, asinClamped as a } from \"../core/mathUtils.js\";\nimport { i, c as o } from \"./mat4.js\";\nimport { c as s } from \"./mat4f64.js\";\nimport { n, c as r, d as c, m as l, o as m, l as f, a as p } from \"./vec3.js\";\nimport { f as h, c as u } from \"./vec3f64.js\";\nimport y from \"../geometry/Extent.js\";\nimport { getReferenceEllipsoid as M } from \"../geometry/projectionEllipsoid.js\";\nimport d from \"../geometry/SpatialReference.js\";\nimport { geographicToWebMercator as j } from \"../geometry/support/webMercatorUtils.js\";\nimport { createDirectionUp as T, directionToHeadingTilt as g } from \"../views/3d/support/cameraUtilsInternal.js\";\nimport { getLonDeltaForDistance as R } from \"../views/3d/support/earthUtils.js\";\nimport { Cyclical as x, cyclical2PI as b } from \"../views/3d/support/mathUtils.js\";\nconst v = h(0, 0, 1),\n      w = n(u(), h(1, 1, 1)),\n      I = new x(-180, 180),\n      U = s(),\n      P = u(),\n      q = u();\n\nfunction E(e, a, s, f = T()) {\n  r(P, e, v), 0 === c(P, P) && r(P, e, w), i(U), o(U, U, -t(a), e), o(U, U, -t(s), P);\n  const {\n    up: p,\n    direction: h\n  } = f;\n  return r(p, P, e), n(p, p), l(p, p, U), n(h, e), m(h, h), l(h, h, U), f;\n}\n\nfunction _(t, e, a, i) {\n  const o = P,\n        s = q;\n  return n(o, t), r(q, o, v), 0 === c(q, q) && r(q, o, w), r(s, q, o), g(e, a, i, o, s);\n}\n\nfunction H(e, i, o, s) {\n  const n = {\n    eye: u(),\n    up: null,\n    tilt: s,\n    heading: o\n  },\n        r = P;\n  r[0] = e[0], r[1] = e[2], r[2] = -e[1];\n  const c = i,\n        l = t(o),\n        m = t(s),\n        h = Math.sin(l),\n        y = Math.cos(l),\n        M = Math.sin(m),\n        d = Math.cos(m),\n        j = f(r);\n  let T;\n  if (Math.abs(m) < 1e-8) T = c + j;else {\n    const t = j / M,\n          e = a(c / t),\n          i = Math.PI - m - e;\n    T = t * Math.sin(i);\n  }\n  const g = d * c,\n        R = c * c * (M * M),\n        x = y * y * R,\n        b = T - g,\n        v = b * b,\n        w = x * (x + v - r[1] * r[1]);\n  if (w < 0) return p(n.eye, r, T / j), n.tilt = 0, n;\n  const I = Math.sqrt(w),\n        U = r[1] * b,\n        q = x + v;\n  let E;\n  if (E = y > 0 ? -I + U : I + U, Math.abs(q) < 1e-8) return j < 1e-8 ? (n.eye[0] = 0, n.eye[1] = 0, n.eye[2] = c) : p(n.eye, r, T / j), n.tilt = 0, W(n.eye), k(n, e);\n  n.eye[1] = E / q;\n\n  const _ = h * h * R,\n        H = M * c,\n        z = y * H * n.eye[1],\n        A = n.eye[1] * n.eye[1],\n        G = 1 - A,\n        S = Math.sqrt(G),\n        C = x * A + _ - 2 * z * S * b + G * v;\n\n  return Math.abs(C) < 1e-8 ? (p(n.eye, r, T / j), n.tilt = 0, W(n.eye), k(n, e)) : (n.eye[0] = (G * (T * r[0] - g * r[0]) - H * S * (r[0] * n.eye[1] * y + r[2] * h)) / C, n.eye[2] = (G * (T * r[2] - g * r[2]) - H * S * (r[2] * n.eye[1] * y - r[0] * h)) / C, p(n.eye, n.eye, T), W(n.eye), k(n, e));\n}\n\nfunction W(t) {\n  const e = t[1];\n  t[1] = -t[2], t[2] = e;\n}\n\nfunction k(t, e) {\n  const a = E(e, t.heading, t.tilt);\n  return t.up = a.up, t;\n}\n\nfunction z(t, i, o) {\n  const s = f(i),\n        n = Math.sqrt(o * o + s * s - 2 * o * s * Math.cos(Math.PI - t)),\n        r = a(o / (n / Math.sin(t)));\n  return e(t - r);\n}\n\nfunction A(e, i, o) {\n  const s = t(e),\n        n = f(i);\n  return a(o / (n / Math.sin(s))) + s;\n}\n\nfunction G(a, i, o, s, n) {\n  let r, c, l, m;\n  const f = i.latitude,\n        p = i.longitude,\n        h = R(f, o, M(a.spatialReference).radius) / 2;\n  r = p - h, c = p + h;\n  const u = t(f),\n        T = M(a.spatialReference).radius,\n        g = (1 + Math.sin(u)) / (1 - Math.sin(u)),\n        x = (g + 1) * Math.tan(s / T / 2),\n        v = x * x;\n\n  function w(t) {\n    const e = Math.PI / 2;\n    return (t = b.normalize(t, -e)) > e && (t = Math.PI - t), t;\n  }\n\n  if (l = 1.5 * Math.PI - 2 * Math.atan(.5 * (x + Math.sqrt(4 * g + v))), m = l + s / T, l = w(l), m = w(m), m < l) {\n    const t = m;\n    m = l, l = t;\n  }\n\n  if (l = Math.max(e(l), -90), m = Math.min(e(m), 90), c = I.monotonic(r, c), c - r > 180) {\n    const t = (c - r - 180) / 2;\n    r += t, c -= t;\n  }\n\n  const U = a.spatialReference && a.spatialReference.isGeographic ? a.spatialReference : d.WGS84;\n  return n ? (n.xmin = r, n.ymin = l, n.xmax = c, n.ymax = m, n.spatialReference = U) : n = new y(r, l, c, m, U), a.spatialReference && a.spatialReference.isWebMercator && j(n, !1, n), n;\n}\n\nvar S = Object.freeze({\n  __proto__: null,\n  headingTiltToDirectionUp: E,\n  directionToHeadingTilt: _,\n  eyeForCenterWithHeadingTilt: H,\n  lookAtTiltToEyeTilt: z,\n  eyeTiltToLookAtTilt: A,\n  toExtent: G\n});\nexport { A as a, S as c, _ as d, H as e, E as h, z as l, G as t };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/chunks/cameraUtilsSpherical.js"],"names":["deg2rad","t","rad2deg","e","asinClamped","a","i","c","o","s","n","r","d","m","l","f","p","h","u","y","getReferenceEllipsoid","M","geographicToWebMercator","j","createDirectionUp","T","directionToHeadingTilt","g","getLonDeltaForDistance","R","Cyclical","x","cyclical2PI","b","v","w","I","U","P","q","E","up","direction","_","H","eye","tilt","heading","Math","sin","cos","abs","PI","sqrt","W","k","z","A","G","S","C","latitude","longitude","spatialReference","radius","tan","normalize","atan","max","min","monotonic","isGeographic","WGS84","xmin","ymin","xmax","ymax","isWebMercator","Object","freeze","__proto__","headingTiltToDirectionUp","eyeForCenterWithHeadingTilt","lookAtTiltToEyeTilt","eyeTiltToLookAtTilt","toExtent"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{deg2rad as t,rad2deg as e,asinClamped as a}from\"../core/mathUtils.js\";import{i,c as o}from\"./mat4.js\";import{c as s}from\"./mat4f64.js\";import{n,c as r,d as c,m as l,o as m,l as f,a as p}from\"./vec3.js\";import{f as h,c as u}from\"./vec3f64.js\";import y from\"../geometry/Extent.js\";import{getReferenceEllipsoid as M}from\"../geometry/projectionEllipsoid.js\";import d from\"../geometry/SpatialReference.js\";import{geographicToWebMercator as j}from\"../geometry/support/webMercatorUtils.js\";import{createDirectionUp as T,directionToHeadingTilt as g}from\"../views/3d/support/cameraUtilsInternal.js\";import{getLonDeltaForDistance as R}from\"../views/3d/support/earthUtils.js\";import{Cyclical as x,cyclical2PI as b}from\"../views/3d/support/mathUtils.js\";const v=h(0,0,1),w=n(u(),h(1,1,1)),I=new x(-180,180),U=s(),P=u(),q=u();function E(e,a,s,f=T()){r(P,e,v),0===c(P,P)&&r(P,e,w),i(U),o(U,U,-t(a),e),o(U,U,-t(s),P);const{up:p,direction:h}=f;return r(p,P,e),n(p,p),l(p,p,U),n(h,e),m(h,h),l(h,h,U),f}function _(t,e,a,i){const o=P,s=q;return n(o,t),r(q,o,v),0===c(q,q)&&r(q,o,w),r(s,q,o),g(e,a,i,o,s)}function H(e,i,o,s){const n={eye:u(),up:null,tilt:s,heading:o},r=P;r[0]=e[0],r[1]=e[2],r[2]=-e[1];const c=i,l=t(o),m=t(s),h=Math.sin(l),y=Math.cos(l),M=Math.sin(m),d=Math.cos(m),j=f(r);let T;if(Math.abs(m)<1e-8)T=c+j;else{const t=j/M,e=a(c/t),i=Math.PI-m-e;T=t*Math.sin(i)}const g=d*c,R=c*c*(M*M),x=y*y*R,b=T-g,v=b*b,w=x*(x+v-r[1]*r[1]);if(w<0)return p(n.eye,r,T/j),n.tilt=0,n;const I=Math.sqrt(w),U=r[1]*b,q=x+v;let E;if(E=y>0?-I+U:I+U,Math.abs(q)<1e-8)return j<1e-8?(n.eye[0]=0,n.eye[1]=0,n.eye[2]=c):p(n.eye,r,T/j),n.tilt=0,W(n.eye),k(n,e);n.eye[1]=E/q;const _=h*h*R,H=M*c,z=y*H*n.eye[1],A=n.eye[1]*n.eye[1],G=1-A,S=Math.sqrt(G),C=x*A+_-2*z*S*b+G*v;return Math.abs(C)<1e-8?(p(n.eye,r,T/j),n.tilt=0,W(n.eye),k(n,e)):(n.eye[0]=(G*(T*r[0]-g*r[0])-H*S*(r[0]*n.eye[1]*y+r[2]*h))/C,n.eye[2]=(G*(T*r[2]-g*r[2])-H*S*(r[2]*n.eye[1]*y-r[0]*h))/C,p(n.eye,n.eye,T),W(n.eye),k(n,e))}function W(t){const e=t[1];t[1]=-t[2],t[2]=e}function k(t,e){const a=E(e,t.heading,t.tilt);return t.up=a.up,t}function z(t,i,o){const s=f(i),n=Math.sqrt(o*o+s*s-2*o*s*Math.cos(Math.PI-t)),r=a(o/(n/Math.sin(t)));return e(t-r)}function A(e,i,o){const s=t(e),n=f(i);return a(o/(n/Math.sin(s)))+s}function G(a,i,o,s,n){let r,c,l,m;const f=i.latitude,p=i.longitude,h=R(f,o,M(a.spatialReference).radius)/2;r=p-h,c=p+h;const u=t(f),T=M(a.spatialReference).radius,g=(1+Math.sin(u))/(1-Math.sin(u)),x=(g+1)*Math.tan(s/T/2),v=x*x;function w(t){const e=Math.PI/2;return(t=b.normalize(t,-e))>e&&(t=Math.PI-t),t}if(l=1.5*Math.PI-2*Math.atan(.5*(x+Math.sqrt(4*g+v))),m=l+s/T,l=w(l),m=w(m),m<l){const t=m;m=l,l=t}if(l=Math.max(e(l),-90),m=Math.min(e(m),90),c=I.monotonic(r,c),c-r>180){const t=(c-r-180)/2;r+=t,c-=t}const U=a.spatialReference&&a.spatialReference.isGeographic?a.spatialReference:d.WGS84;return n?(n.xmin=r,n.ymin=l,n.xmax=c,n.ymax=m,n.spatialReference=U):n=new y(r,l,c,m,U),a.spatialReference&&a.spatialReference.isWebMercator&&j(n,!1,n),n}var S=Object.freeze({__proto__:null,headingTiltToDirectionUp:E,directionToHeadingTilt:_,eyeForCenterWithHeadingTilt:H,lookAtTiltToEyeTilt:z,eyeTiltToLookAtTilt:A,toExtent:G});export{A as a,S as c,_ as d,H as e,E as h,z as l,G as t};\n"]},"metadata":{},"sourceType":"module"}