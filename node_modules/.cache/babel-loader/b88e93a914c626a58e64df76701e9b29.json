{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../core/Error.js\";\nimport { g as t, f as o, d as n, b as r, a as s } from \"./vec3.js\";\nimport { c as i } from \"./vec3f64.js\";\nimport { containsPoint as a, containsPointWithMargin as l, fromExtent as c, create as u } from \"../geometry/support/aaBoundingRect.js\";\nimport { MAX_ROOT_TILES as f } from \"../views/3d/terrain/TerrainConst.js\";\nimport m from \"../views/3d/terrain/TilingScheme.js\";\nconst h = i(),\n      p = i(),\n      g = i(),\n      d = i();\n\nfunction M(e, t, o = 0) {\n  const n = e.extent;\n  if (0 === o) return a(n, t);\n  const r = Math.min(n[2] - n[0], n[3] - n[1]);\n  return l(n, t, o * r);\n}\n\nfunction v(e, i, a, l) {\n  t(h, a), h[l] = i[l];\n  const c = o(h, h, i),\n        u = o(p, e, i),\n        f = n(u, c),\n        m = n(c, c);\n  let g;\n  g = f <= 0 ? i : m <= f ? a : r(h, i, s(c, c, f / m));\n  const d = o(h, e, g);\n  return Math.PI / 2 - Math.atan(d[2] / Math.sqrt(d[0] * d[0] + d[1] * d[1]));\n}\n\nfunction x(e, t, o) {\n  const n = e.extent;\n  g[0] = n[0], g[1] = n[1], g[2] = o, d[0] = n[2], d[1] = n[3], d[2] = o;\n  let r = 1 / 0,\n      s = 1 / 0;\n  return t[0] < g[0] ? r = v(t, g, d, 0) : t[0] > d[0] && (r = v(t, d, g, 0)), t[1] < g[1] ? s = v(t, g, d, 1) : t[1] > d[1] && (s = v(t, d, g, 1)), Math.min(r, s);\n}\n\nfunction S(t, o, n) {\n  if (t.spatialReference.isGeographic) return new e(\"tilingscheme:local-gcs-not-supported\", \"Geographic coordinate systems are not supported in local scenes\");\n  const r = m.checkUnsupported(t);\n  if (r) return r;\n  const s = w(t, n);\n  return s || (o && !t.spatialReference.equals(o) ? new e(\"tilingscheme:spatial-reference-mismatch\", \"The tiling scheme does not match the spatial reference of the local scene\") : null);\n}\n\nfunction w(t, o) {\n  const n = t.lods,\n        r = n[0].resolution * 2 ** n[0].level,\n        s = [r * t.size[0], r * t.size[1]],\n        i = [t.origin.x, t.origin.y],\n        a = c(o),\n        l = u();\n  m.computeRowColExtent(a, s, i, l);\n  const h = (l[2] - l[0]) * (l[3] - l[1]);\n\n  if (h > f) {\n    const o = n[0].scale * 2 ** n[0].level;\n    let s = Math.max((a[3] - a[1]) / t.size[1], (a[2] - a[0]) / t.size[0]) * o / r;\n    const i = Math.floor(Math.log(s) / Math.log(10));\n    return s = Math.ceil(s / 10 ** i) * 10 ** i, new e(\"tilingscheme:too-many-root-tiles\", \"Scale of level 0 of the tiling scheme (1:\" + Math.floor(o).toLocaleString() + \") is too large for the layer's extent. Suggested scale: 1:\" + s.toLocaleString() + \".\", {\n      level0Scale: o,\n      suggestedLevel0Scale: s,\n      requiredNumRootTiles: h,\n      allowedNumRootTiles: f\n    });\n  }\n\n  return null;\n}\n\nvar j = Object.freeze({\n  __proto__: null,\n  isInsideExtent: M,\n  tiltToExtentEdge: x,\n  checkIfTileInfoSupportedForViewSR: S\n});\nexport { x as a, S as c, M as i, j as t };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/chunks/terrainUtilsPlanar.js"],"names":["e","g","t","f","o","d","n","b","r","a","s","c","i","containsPoint","containsPointWithMargin","l","fromExtent","create","u","MAX_ROOT_TILES","m","h","p","M","extent","Math","min","v","PI","atan","sqrt","x","S","spatialReference","isGeographic","checkUnsupported","w","equals","lods","resolution","level","size","origin","y","computeRowColExtent","scale","max","floor","log","ceil","toLocaleString","level0Scale","suggestedLevel0Scale","requiredNumRootTiles","allowedNumRootTiles","j","Object","freeze","__proto__","isInsideExtent","tiltToExtentEdge","checkIfTileInfoSupportedForViewSR"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../core/Error.js\";import{g as t,f as o,d as n,b as r,a as s}from\"./vec3.js\";import{c as i}from\"./vec3f64.js\";import{containsPoint as a,containsPointWithMargin as l,fromExtent as c,create as u}from\"../geometry/support/aaBoundingRect.js\";import{MAX_ROOT_TILES as f}from\"../views/3d/terrain/TerrainConst.js\";import m from\"../views/3d/terrain/TilingScheme.js\";const h=i(),p=i(),g=i(),d=i();function M(e,t,o=0){const n=e.extent;if(0===o)return a(n,t);const r=Math.min(n[2]-n[0],n[3]-n[1]);return l(n,t,o*r)}function v(e,i,a,l){t(h,a),h[l]=i[l];const c=o(h,h,i),u=o(p,e,i),f=n(u,c),m=n(c,c);let g;g=f<=0?i:m<=f?a:r(h,i,s(c,c,f/m));const d=o(h,e,g);return Math.PI/2-Math.atan(d[2]/Math.sqrt(d[0]*d[0]+d[1]*d[1]))}function x(e,t,o){const n=e.extent;g[0]=n[0],g[1]=n[1],g[2]=o,d[0]=n[2],d[1]=n[3],d[2]=o;let r=1/0,s=1/0;return t[0]<g[0]?r=v(t,g,d,0):t[0]>d[0]&&(r=v(t,d,g,0)),t[1]<g[1]?s=v(t,g,d,1):t[1]>d[1]&&(s=v(t,d,g,1)),Math.min(r,s)}function S(t,o,n){if(t.spatialReference.isGeographic)return new e(\"tilingscheme:local-gcs-not-supported\",\"Geographic coordinate systems are not supported in local scenes\");const r=m.checkUnsupported(t);if(r)return r;const s=w(t,n);return s||(o&&!t.spatialReference.equals(o)?new e(\"tilingscheme:spatial-reference-mismatch\",\"The tiling scheme does not match the spatial reference of the local scene\"):null)}function w(t,o){const n=t.lods,r=n[0].resolution*2**n[0].level,s=[r*t.size[0],r*t.size[1]],i=[t.origin.x,t.origin.y],a=c(o),l=u();m.computeRowColExtent(a,s,i,l);const h=(l[2]-l[0])*(l[3]-l[1]);if(h>f){const o=n[0].scale*2**n[0].level;let s=Math.max((a[3]-a[1])/t.size[1],(a[2]-a[0])/t.size[0])*o/r;const i=Math.floor(Math.log(s)/Math.log(10));return s=Math.ceil(s/10**i)*10**i,new e(\"tilingscheme:too-many-root-tiles\",\"Scale of level 0 of the tiling scheme (1:\"+Math.floor(o).toLocaleString()+\") is too large for the layer's extent. Suggested scale: 1:\"+s.toLocaleString()+\".\",{level0Scale:o,suggestedLevel0Scale:s,requiredNumRootTiles:h,allowedNumRootTiles:f})}return null}var j=Object.freeze({__proto__:null,isInsideExtent:M,tiltToExtentEdge:x,checkIfTileInfoSupportedForViewSR:S});export{x as a,S as c,M as i,j as t};\n"]},"metadata":{},"sourceType":"module"}