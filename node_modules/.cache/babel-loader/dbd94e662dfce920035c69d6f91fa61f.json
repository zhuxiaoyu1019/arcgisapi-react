{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from \"../../../request.js\";\nimport { isSome as e } from \"../../../core/maybe.js\";\nimport { join as r, urlToObject as n } from \"../../../core/urlUtils.js\";\nimport { getJsonType as i } from \"../../../geometry/support/jsonUtils.js\";\nimport { normalizeCentralMeridian as o } from \"../../../geometry/support/normalizeUtils.js\";\nimport { parsePBFFeatureQuery as s } from \"./pbfQueryUtils.js\";\nimport { applyFeatureSetZUnitScaling as u } from \"./queryZScale.js\";\nimport { mapParameters as a } from \"../../../tasks/operations/urlUtils.js\";\nconst l = \"Layer does not support extent calculation.\";\n\nfunction m(t, r) {\n  const n = t.geometry,\n        o = t.toJSON(),\n        s = o;\n\n  if (e(n) && (s.geometry = JSON.stringify(n), s.geometryType = i(n), s.inSR = n.spatialReference.wkid || JSON.stringify(n.spatialReference)), o.groupByFieldsForStatistics && (s.groupByFieldsForStatistics = o.groupByFieldsForStatistics.join(\",\")), o.objectIds && (s.objectIds = o.objectIds.join(\",\")), o.orderByFields && (s.orderByFields = o.orderByFields.join(\",\")), !o.outFields || !o.returnDistinctValues && (null != r && r.returnCountOnly || null != r && r.returnExtentOnly || null != r && r.returnIdsOnly) ? delete s.outFields : -1 !== o.outFields.indexOf(\"*\") ? s.outFields = \"*\" : s.outFields = o.outFields.join(\",\"), o.outSR ? s.outSR = o.outSR.wkid || JSON.stringify(o.outSR) : n && (o.returnGeometry || o.returnCentroid) && (s.outSR = s.inSR), o.returnGeometry && delete o.returnGeometry, o.outStatistics && (s.outStatistics = JSON.stringify(o.outStatistics)), o.pixelSize && (s.pixelSize = JSON.stringify(o.pixelSize)), o.quantizationParameters && (s.quantizationParameters = JSON.stringify(o.quantizationParameters)), o.parameterValues && (s.parameterValues = JSON.stringify(o.parameterValues)), o.rangeValues && (s.rangeValues = JSON.stringify(o.rangeValues)), o.dynamicDataSource && (s.layer = JSON.stringify({\n    source: o.dynamicDataSource\n  }), delete o.dynamicDataSource), o.timeExtent) {\n    const t = o.timeExtent,\n          {\n      start: e,\n      end: r\n    } = t;\n    null == e && null == r || (s.time = e === r ? e : `${null == e ? \"null\" : e},${null == r ? \"null\" : r}`), delete o.timeExtent;\n  }\n\n  return s;\n}\n\nasync function y(t, r, n, i) {\n  const o = e(r.timeExtent) && r.timeExtent.isEmpty ? {\n    data: {\n      features: []\n    }\n  } : await g(t, r, \"json\", i);\n  return u(r, n, o.data), o;\n}\n\nasync function c(t, r, n, i) {\n  if (e(r.timeExtent) && r.timeExtent.isEmpty) return Promise.resolve({\n    data: n.createFeatureResult()\n  });\n  const o = await d(t, r, i),\n        u = o;\n  return u.data = s(o.data, n), u;\n}\n\nfunction d(t, e, r) {\n  return g(t, e, \"pbf\", r);\n}\n\nfunction f(t, r, n) {\n  return e(r.timeExtent) && r.timeExtent.isEmpty ? Promise.resolve({\n    data: {\n      objectIds: []\n    }\n  }) : g(t, r, \"json\", n, {\n    returnIdsOnly: !0\n  });\n}\n\nfunction p(t, r, n) {\n  return e(r.timeExtent) && r.timeExtent.isEmpty ? Promise.resolve({\n    data: {\n      count: 0\n    }\n  }) : g(t, r, \"json\", n, {\n    returnIdsOnly: !0,\n    returnCountOnly: !0\n  });\n}\n\nfunction S(t, r, n) {\n  return e(r.timeExtent) && r.timeExtent.isEmpty ? Promise.resolve({\n    data: {\n      count: 0,\n      extent: null\n    }\n  }) : g(t, r, \"json\", n, {\n    returnExtentOnly: !0,\n    returnCountOnly: !0\n  }).then(t => {\n    const e = t.data;\n    if (e.hasOwnProperty(\"extent\")) return t;\n    if (e.features) throw new Error(l);\n    if (e.hasOwnProperty(\"count\")) throw new Error(l);\n    return t;\n  });\n}\n\nfunction g(i, s, u, l = {}, y = {}) {\n  const c = \"string\" == typeof i ? n(i) : i,\n        d = s.geometry ? [s.geometry] : [];\n  return l.responseType = \"pbf\" === u ? \"array-buffer\" : \"json\", o(d, null, l).then(n => {\n    const i = n && n[0];\n    e(i) && ((s = s.clone()).geometry = i);\n    const o = a({ ...c.query,\n      f: u,\n      ...y,\n      ...m(s, y)\n    });\n    return t(r(c.path, \"query\"), { ...l,\n      query: { ...o,\n        ...l.query\n      }\n    });\n  });\n}\n\nexport { y as executeQuery, p as executeQueryForCount, S as executeQueryForExtent, f as executeQueryForIds, c as executeQueryPBF, d as executeQueryPBFBuffer, m as queryToQueryStringParameters, g as runQuery };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/rest/query/operations/query.js"],"names":["t","isSome","e","join","r","urlToObject","n","getJsonType","i","normalizeCentralMeridian","o","parsePBFFeatureQuery","s","applyFeatureSetZUnitScaling","u","mapParameters","a","l","m","geometry","toJSON","JSON","stringify","geometryType","inSR","spatialReference","wkid","groupByFieldsForStatistics","objectIds","orderByFields","outFields","returnDistinctValues","returnCountOnly","returnExtentOnly","returnIdsOnly","indexOf","outSR","returnGeometry","returnCentroid","outStatistics","pixelSize","quantizationParameters","parameterValues","rangeValues","dynamicDataSource","layer","source","timeExtent","start","end","time","y","isEmpty","data","features","g","c","Promise","resolve","createFeatureResult","d","f","p","count","S","extent","then","hasOwnProperty","Error","responseType","clone","query","path","executeQuery","executeQueryForCount","executeQueryForExtent","executeQueryForIds","executeQueryPBF","executeQueryPBFBuffer","queryToQueryStringParameters","runQuery"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from\"../../../request.js\";import{isSome as e}from\"../../../core/maybe.js\";import{join as r,urlToObject as n}from\"../../../core/urlUtils.js\";import{getJsonType as i}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as o}from\"../../../geometry/support/normalizeUtils.js\";import{parsePBFFeatureQuery as s}from\"./pbfQueryUtils.js\";import{applyFeatureSetZUnitScaling as u}from\"./queryZScale.js\";import{mapParameters as a}from\"../../../tasks/operations/urlUtils.js\";const l=\"Layer does not support extent calculation.\";function m(t,r){const n=t.geometry,o=t.toJSON(),s=o;if(e(n)&&(s.geometry=JSON.stringify(n),s.geometryType=i(n),s.inSR=n.spatialReference.wkid||JSON.stringify(n.spatialReference)),o.groupByFieldsForStatistics&&(s.groupByFieldsForStatistics=o.groupByFieldsForStatistics.join(\",\")),o.objectIds&&(s.objectIds=o.objectIds.join(\",\")),o.orderByFields&&(s.orderByFields=o.orderByFields.join(\",\")),!o.outFields||!o.returnDistinctValues&&(null!=r&&r.returnCountOnly||null!=r&&r.returnExtentOnly||null!=r&&r.returnIdsOnly)?delete s.outFields:-1!==o.outFields.indexOf(\"*\")?s.outFields=\"*\":s.outFields=o.outFields.join(\",\"),o.outSR?s.outSR=o.outSR.wkid||JSON.stringify(o.outSR):n&&(o.returnGeometry||o.returnCentroid)&&(s.outSR=s.inSR),o.returnGeometry&&delete o.returnGeometry,o.outStatistics&&(s.outStatistics=JSON.stringify(o.outStatistics)),o.pixelSize&&(s.pixelSize=JSON.stringify(o.pixelSize)),o.quantizationParameters&&(s.quantizationParameters=JSON.stringify(o.quantizationParameters)),o.parameterValues&&(s.parameterValues=JSON.stringify(o.parameterValues)),o.rangeValues&&(s.rangeValues=JSON.stringify(o.rangeValues)),o.dynamicDataSource&&(s.layer=JSON.stringify({source:o.dynamicDataSource}),delete o.dynamicDataSource),o.timeExtent){const t=o.timeExtent,{start:e,end:r}=t;null==e&&null==r||(s.time=e===r?e:`${null==e?\"null\":e},${null==r?\"null\":r}`),delete o.timeExtent}return s}async function y(t,r,n,i){const o=e(r.timeExtent)&&r.timeExtent.isEmpty?{data:{features:[]}}:await g(t,r,\"json\",i);return u(r,n,o.data),o}async function c(t,r,n,i){if(e(r.timeExtent)&&r.timeExtent.isEmpty)return Promise.resolve({data:n.createFeatureResult()});const o=await d(t,r,i),u=o;return u.data=s(o.data,n),u}function d(t,e,r){return g(t,e,\"pbf\",r)}function f(t,r,n){return e(r.timeExtent)&&r.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):g(t,r,\"json\",n,{returnIdsOnly:!0})}function p(t,r,n){return e(r.timeExtent)&&r.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):g(t,r,\"json\",n,{returnIdsOnly:!0,returnCountOnly:!0})}function S(t,r,n){return e(r.timeExtent)&&r.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):g(t,r,\"json\",n,{returnExtentOnly:!0,returnCountOnly:!0}).then((t=>{const e=t.data;if(e.hasOwnProperty(\"extent\"))return t;if(e.features)throw new Error(l);if(e.hasOwnProperty(\"count\"))throw new Error(l);return t}))}function g(i,s,u,l={},y={}){const c=\"string\"==typeof i?n(i):i,d=s.geometry?[s.geometry]:[];return l.responseType=\"pbf\"===u?\"array-buffer\":\"json\",o(d,null,l).then((n=>{const i=n&&n[0];e(i)&&((s=s.clone()).geometry=i);const o=a({...c.query,f:u,...y,...m(s,y)});return t(r(c.path,\"query\"),{...l,query:{...o,...l.query}})}))}export{y as executeQuery,p as executeQueryForCount,S as executeQueryForExtent,f as executeQueryForIds,c as executeQueryPBF,d as executeQueryPBFBuffer,m as queryToQueryStringParameters,g as runQuery};\n"]},"metadata":{},"sourceType":"module"}