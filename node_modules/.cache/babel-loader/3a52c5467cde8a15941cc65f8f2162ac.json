{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isSome as t, isNone as e } from \"../../../core/maybe.js\";\nimport n from \"../../../core/PooledArray.js\";\n\nclass r {\n  constructor() {\n    this._queue = new n(), this._last = null, this.remove = () => {};\n  }\n\n  get done() {\n    return 0 === this._queue.length && (!this._last || this._last.isLeaf);\n  }\n\n  resetOne(t) {\n    this._queue.clear(), this._queue.push(t), this._last = null;\n  }\n\n  reset(e = null) {\n    this._queue.clear(), t(e) && this._queue.pushArray(e), this._last = null;\n  }\n\n  skipSubtree() {\n    this._last = null;\n  }\n\n  next() {\n    return this._last && !this._last.isLeaf && this._queue.pushArray(this._last.children), this._last = this._queue.pop(), this._last;\n  }\n\n}\n\nclass s {\n  constructor() {\n    this.q = new n();\n  }\n\n  get done() {\n    return 0 === this.q.length;\n  }\n\n  reset(t) {\n    if (this.q.clear(), t) {\n      this.q.pushArray(t);\n\n      for (let t = 0; t < this.q.length; ++t) {\n        const e = this.q.data[t];\n        e.isLeaf || this.q.pushArray(e.children);\n      }\n    }\n  }\n\n  next() {\n    return this.q.pop();\n  }\n\n}\n\nfunction i(e) {\n  return t(e) ? e.lij.toString() : \"null\";\n}\n\nfunction l(t, e) {\n  if (Array.isArray(t)) for (let n = 0; n < t.length; n++) u(t[n], e);else u(t, e);\n}\n\nfunction u(t, e) {\n  if (e(t), !t.isLeaf) for (const n of t.children) u(n, e);\n}\n\nfunction o(t, n, r) {\n  if (e(n)) return !1;\n  const s = n.fullExtent,\n        i = t.extent;\n\n  if (r) {\n    if (i[0] < s.xmin || i[1] < s.ymin || i[2] > s.xmax || i[3] > s.ymax) return !1;\n  } else if (s.xmin > i[2] || s.ymin > i[3] || s.xmax < i[0] || s.ymax < i[1]) return !1;\n\n  const l = t.surface.tilingScheme.levels[t.lij[0]].scale;\n  return !(n.minScale > 0 && l > 1.00000001 * n.minScale) && !(n.maxScale > 0 && l < .99999999 * n.maxScale);\n}\n\nfunction a(t, e) {\n  e.sort((e, n) => h(e, n, t));\n}\n\nfunction h(t, e, n) {\n  const r = t.screenDepth,\n        s = e.screenDepth;\n  return r < s ? -n : r > s ? n : 0;\n}\n\nfunction c(t, e) {\n  const n = new Map();\n  t.forAll(t => n.set(t, t.distanceToSquared(e))), t.sort((t, e) => n.get(t) - n.get(e));\n}\n\nfunction f(t, e, n) {\n  let r = 1,\n      s = 0,\n      i = 0;\n\n  for (; t !== e;) if (r *= .5, s *= .5, i *= .5, 1 & t.lij[2] && (s += .5), 0 == (1 & t.lij[1]) && (i += .5), null == (t = t.parent)) throw new Error(\"tile was not a descendant of upsampleTile\");\n\n  n.init(e, s, i, r);\n}\n\nfunction m(t) {\n  for (let e = 0; e < t.length; e++) {\n    const n = t[e],\n          r = n.parent;\n    if (r) for (let t = 0; t < 4; t++) {\n      const e = r.children[t];\n      if (e && e !== n && e.loadable) return !0;\n    }\n  }\n\n  return !1;\n}\n\nfunction p(t, e) {\n  if (!t || !e || t[0] === e[0]) return !1;\n  const n = t[0] < e[0],\n        r = n ? t : e,\n        s = n ? e : t,\n        i = 1 << s[0] - r[0];\n  return Math.floor(s[1] / i) === r[1] && Math.floor(s[2] / i) === r[2];\n}\n\nexport { s as IteratorPostorder, r as IteratorPreorder, h as compareTiles, f as computeUpsampleInfo, o as fallsWithinLayer, m as hasLoadableSiblings, a as sortTiles, c as sortTilesByPOI, i as tile2str, p as tilesAreRelated, l as traverseTilesPreorder };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/terrain/tileUtils.js"],"names":["isSome","t","isNone","e","n","r","constructor","_queue","_last","remove","done","length","isLeaf","resetOne","clear","push","reset","pushArray","skipSubtree","next","children","pop","s","q","data","i","lij","toString","l","Array","isArray","u","o","fullExtent","extent","xmin","ymin","xmax","ymax","surface","tilingScheme","levels","scale","minScale","maxScale","a","sort","h","screenDepth","c","Map","forAll","set","distanceToSquared","get","f","parent","Error","init","m","loadable","p","Math","floor","IteratorPostorder","IteratorPreorder","compareTiles","computeUpsampleInfo","fallsWithinLayer","hasLoadableSiblings","sortTiles","sortTilesByPOI","tile2str","tilesAreRelated","traverseTilesPreorder"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as t,isNone as e}from\"../../../core/maybe.js\";import n from\"../../../core/PooledArray.js\";class r{constructor(){this._queue=new n,this._last=null,this.remove=()=>{}}get done(){return 0===this._queue.length&&(!this._last||this._last.isLeaf)}resetOne(t){this._queue.clear(),this._queue.push(t),this._last=null}reset(e=null){this._queue.clear(),t(e)&&this._queue.pushArray(e),this._last=null}skipSubtree(){this._last=null}next(){return this._last&&!this._last.isLeaf&&this._queue.pushArray(this._last.children),this._last=this._queue.pop(),this._last}}class s{constructor(){this.q=new n}get done(){return 0===this.q.length}reset(t){if(this.q.clear(),t){this.q.pushArray(t);for(let t=0;t<this.q.length;++t){const e=this.q.data[t];e.isLeaf||this.q.pushArray(e.children)}}}next(){return this.q.pop()}}function i(e){return t(e)?e.lij.toString():\"null\"}function l(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)u(t[n],e);else u(t,e)}function u(t,e){if(e(t),!t.isLeaf)for(const n of t.children)u(n,e)}function o(t,n,r){if(e(n))return!1;const s=n.fullExtent,i=t.extent;if(r){if(i[0]<s.xmin||i[1]<s.ymin||i[2]>s.xmax||i[3]>s.ymax)return!1}else if(s.xmin>i[2]||s.ymin>i[3]||s.xmax<i[0]||s.ymax<i[1])return!1;const l=t.surface.tilingScheme.levels[t.lij[0]].scale;return!(n.minScale>0&&l>1.00000001*n.minScale)&&!(n.maxScale>0&&l<.99999999*n.maxScale)}function a(t,e){e.sort(((e,n)=>h(e,n,t)))}function h(t,e,n){const r=t.screenDepth,s=e.screenDepth;return r<s?-n:r>s?n:0}function c(t,e){const n=new Map;t.forAll((t=>n.set(t,t.distanceToSquared(e)))),t.sort(((t,e)=>n.get(t)-n.get(e)))}function f(t,e,n){let r=1,s=0,i=0;for(;t!==e;)if(r*=.5,s*=.5,i*=.5,1&t.lij[2]&&(s+=.5),0==(1&t.lij[1])&&(i+=.5),null==(t=t.parent))throw new Error(\"tile was not a descendant of upsampleTile\");n.init(e,s,i,r)}function m(t){for(let e=0;e<t.length;e++){const n=t[e],r=n.parent;if(r)for(let t=0;t<4;t++){const e=r.children[t];if(e&&e!==n&&e.loadable)return!0}}return!1}function p(t,e){if(!t||!e||t[0]===e[0])return!1;const n=t[0]<e[0],r=n?t:e,s=n?e:t,i=1<<s[0]-r[0];return Math.floor(s[1]/i)===r[1]&&Math.floor(s[2]/i)===r[2]}export{s as IteratorPostorder,r as IteratorPreorder,h as compareTiles,f as computeUpsampleInfo,o as fallsWithinLayer,m as hasLoadableSiblings,a as sortTiles,c as sortTilesByPOI,i as tile2str,p as tilesAreRelated,l as traverseTilesPreorder};\n"]},"metadata":{},"sourceType":"module"}