{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { lerp as t } from \"../../../../core/mathUtils.js\";\nimport { t as e } from \"../../../../chunks/mat3.js\";\nimport { c as i } from \"../../../../chunks/mat3f64.js\";\nimport { l as s, i as a, e as o, g as h, f as r, t as n, a as c, c as p, d as m, b as d, n as w } from \"../../../../chunks/vec3.js\";\nimport { c as u, a as l, f as y } from \"../../../../chunks/vec3f64.js\";\nimport { angle as M, slerp as A } from \"../../support/mathUtils.js\";\n\nconst f = u(),\n      P = u(),\n      _ = u(),\n      g = u(),\n      k = u(),\n      v = u(),\n      x = {\n  upward: y(0, 0, 1),\n  forward: y(0, 1, 0),\n  sideway: y(1, 0, 0)\n},\n      z = i();\n\nclass T {\n  constructor(t = 1) {\n    this.viewingMode = t, this.center = u(), this.pitch = 0, this.yaw = 0, this.distance = 0, this.lookAtDirection = l(x.forward);\n  }\n\n  pixelsPerPanAtZoom(t) {\n    return this.size / 2 / (this._zoomToPanScale * t);\n  }\n\n  zoomAtPixelsPerPan(t) {\n    return this.size / 2 / (this._zoomToPanScale * t);\n  }\n\n  pixelsPerRotateAtZoom() {\n    const t = Math.max(Math.cos(Math.abs(this.pitch)), .5);\n    return this.size / 2 / t;\n  }\n\n  compareTo(t, e) {\n    if (e || (e = {\n      pan: 0,\n      rotate: 0,\n      sourceZoom: 0,\n      targetZoom: 0\n    }), 1 === this.viewingMode) {\n      const i = (s(this.center) + s(t.center)) / 2;\n      e.pan = M(this.center, t.center) * i;\n    } else e.pan = a(this.center, t.center);\n\n    let i = Math.abs(t.yaw - this.yaw);\n    i >= Math.PI && (i = 2 * Math.PI - i);\n    const o = Math.abs(t.pitch - this.pitch);\n    return e.rotate = Math.max(i, o), e.sourceZoom = this.distance, e.targetZoom = t.distance, e;\n  }\n\n  interpolate(e, i, s) {\n    1 === this.viewingMode ? A(e.center, i.center, s.pan, this.center) : o(this.center, e.center, i.center, s.pan), this.distance = t(e.distance, i.distance, s.zoom), this.pitch = t(e.pitch, i.pitch, s.rotate);\n    let a = e.yaw;\n    const h = i.yaw;\n    Math.abs(h - a) >= Math.PI && (a += 2 * (a < h ? 1 : -1) * Math.PI), this.yaw = t(a, h, s.rotate);\n  }\n\n  copyFrom(t) {\n    h(this.center, t.center), this.pitch = t.pitch, this.yaw = t.yaw, this.distance = t.distance, h(this.lookAtDirection, t.lookAtDirection), this.size = t.size, this.copyFromCommon(t), this.viewingMode = t.viewingMode;\n  }\n\n  copyFromRenderCamera(t) {\n    const e = this._lookAtOrientation(t.center, z);\n\n    h(this.center, t.center), r(g, t.center, t.eye), n(g, g, e), n(k, t.up, e), this.distance = s(g), g[0] /= this.distance, g[1] /= this.distance, g[2] /= this.distance, this.pitch = this._eyeUpToPitch(g), this.yaw = this._eyeUpToYaw(g, k), this.size = Math.sqrt(t.width * t.width + t.height * t.height), this.copyFromCommon(t);\n  }\n\n  copyFromCommon(t) {\n    this.fov = t.fov, this._zoomToPanScale = Math.atan(.5 * this.fov);\n  }\n\n  copyToRenderCamera(t) {\n    const i = this._lookAtOrientation(this.center, z);\n\n    e(i, i), this._axisAngleVec3(x.sideway, this.pitch - Math.PI / 2, x.forward, g), this._axisAngleVec3(x.upward, this.yaw, g), this._axisAngleVec3(x.sideway, this.pitch - Math.PI / 2, x.upward, k), this._axisAngleVec3(x.upward, this.yaw, k), c(g, g, this.distance), n(g, g, i), n(k, k, i), t.center = this.center, t.eye = r(g, this.center, g), t.up = k;\n  }\n\n  _axisAngleVec3(t, e, i, s = i) {\n    const a = Math.cos(e),\n          o = Math.sin(e);\n    return c(f, i, a), p(P, t, i), c(P, P, o), c(_, t, (1 - a) * m(t, i)), d(s, d(s, f, P), _);\n  }\n\n  _lookAtOrientation(t, e = i()) {\n    return this._upAtLookAt(t, _), p(f, this.lookAtDirection, _), w(f, f), 0 === f[0] && 0 === f[1] && 0 === f[2] && h(f, x.sideway), p(P, _, f), w(P, P), e[0] = f[0], e[1] = P[0], e[2] = _[0], e[3] = f[1], e[4] = P[1], e[5] = _[1], e[6] = f[2], e[7] = P[2], e[8] = _[2], e;\n  }\n\n  _upAtLookAt(t, e) {\n    return 2 === this.viewingMode ? h(e, x.upward) : w(e, t);\n  }\n\n  _eyeUpToPitch(t) {\n    return Math.PI - M(x.upward, t);\n  }\n\n  _eyeUpToYaw(t, e) {\n    const i = v;\n    return Math.abs(e[2]) < .5 ? (h(i, e), t[2] > 0 && c(i, i, -1)) : h(i, t), p(P, i, x.upward), w(P, P), M(x.sideway, P, x.upward);\n  }\n\n}\n\nexport default T;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/animation/pointToPoint/Camera.js"],"names":["lerp","t","e","c","i","l","s","a","o","g","h","f","r","n","p","d","m","b","w","u","y","angle","M","slerp","A","P","_","k","v","x","upward","forward","sideway","z","T","constructor","viewingMode","center","pitch","yaw","distance","lookAtDirection","pixelsPerPanAtZoom","size","_zoomToPanScale","zoomAtPixelsPerPan","pixelsPerRotateAtZoom","Math","max","cos","abs","compareTo","pan","rotate","sourceZoom","targetZoom","PI","interpolate","zoom","copyFrom","copyFromCommon","copyFromRenderCamera","_lookAtOrientation","eye","up","_eyeUpToPitch","_eyeUpToYaw","sqrt","width","height","fov","atan","copyToRenderCamera","_axisAngleVec3","sin","_upAtLookAt"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{lerp as t}from\"../../../../core/mathUtils.js\";import{t as e}from\"../../../../chunks/mat3.js\";import{c as i}from\"../../../../chunks/mat3f64.js\";import{l as s,i as a,e as o,g as h,f as r,t as n,a as c,c as p,d as m,b as d,n as w}from\"../../../../chunks/vec3.js\";import{c as u,a as l,f as y}from\"../../../../chunks/vec3f64.js\";import{angle as M,slerp as A}from\"../../support/mathUtils.js\";const f=u(),P=u(),_=u(),g=u(),k=u(),v=u(),x={upward:y(0,0,1),forward:y(0,1,0),sideway:y(1,0,0)},z=i();class T{constructor(t=1){this.viewingMode=t,this.center=u(),this.pitch=0,this.yaw=0,this.distance=0,this.lookAtDirection=l(x.forward)}pixelsPerPanAtZoom(t){return this.size/2/(this._zoomToPanScale*t)}zoomAtPixelsPerPan(t){return this.size/2/(this._zoomToPanScale*t)}pixelsPerRotateAtZoom(){const t=Math.max(Math.cos(Math.abs(this.pitch)),.5);return this.size/2/t}compareTo(t,e){if(e||(e={pan:0,rotate:0,sourceZoom:0,targetZoom:0}),1===this.viewingMode){const i=(s(this.center)+s(t.center))/2;e.pan=M(this.center,t.center)*i}else e.pan=a(this.center,t.center);let i=Math.abs(t.yaw-this.yaw);i>=Math.PI&&(i=2*Math.PI-i);const o=Math.abs(t.pitch-this.pitch);return e.rotate=Math.max(i,o),e.sourceZoom=this.distance,e.targetZoom=t.distance,e}interpolate(e,i,s){1===this.viewingMode?A(e.center,i.center,s.pan,this.center):o(this.center,e.center,i.center,s.pan),this.distance=t(e.distance,i.distance,s.zoom),this.pitch=t(e.pitch,i.pitch,s.rotate);let a=e.yaw;const h=i.yaw;Math.abs(h-a)>=Math.PI&&(a+=2*(a<h?1:-1)*Math.PI),this.yaw=t(a,h,s.rotate)}copyFrom(t){h(this.center,t.center),this.pitch=t.pitch,this.yaw=t.yaw,this.distance=t.distance,h(this.lookAtDirection,t.lookAtDirection),this.size=t.size,this.copyFromCommon(t),this.viewingMode=t.viewingMode}copyFromRenderCamera(t){const e=this._lookAtOrientation(t.center,z);h(this.center,t.center),r(g,t.center,t.eye),n(g,g,e),n(k,t.up,e),this.distance=s(g),g[0]/=this.distance,g[1]/=this.distance,g[2]/=this.distance,this.pitch=this._eyeUpToPitch(g),this.yaw=this._eyeUpToYaw(g,k),this.size=Math.sqrt(t.width*t.width+t.height*t.height),this.copyFromCommon(t)}copyFromCommon(t){this.fov=t.fov,this._zoomToPanScale=Math.atan(.5*this.fov)}copyToRenderCamera(t){const i=this._lookAtOrientation(this.center,z);e(i,i),this._axisAngleVec3(x.sideway,this.pitch-Math.PI/2,x.forward,g),this._axisAngleVec3(x.upward,this.yaw,g),this._axisAngleVec3(x.sideway,this.pitch-Math.PI/2,x.upward,k),this._axisAngleVec3(x.upward,this.yaw,k),c(g,g,this.distance),n(g,g,i),n(k,k,i),t.center=this.center,t.eye=r(g,this.center,g),t.up=k}_axisAngleVec3(t,e,i,s=i){const a=Math.cos(e),o=Math.sin(e);return c(f,i,a),p(P,t,i),c(P,P,o),c(_,t,(1-a)*m(t,i)),d(s,d(s,f,P),_)}_lookAtOrientation(t,e=i()){return this._upAtLookAt(t,_),p(f,this.lookAtDirection,_),w(f,f),0===f[0]&&0===f[1]&&0===f[2]&&h(f,x.sideway),p(P,_,f),w(P,P),e[0]=f[0],e[1]=P[0],e[2]=_[0],e[3]=f[1],e[4]=P[1],e[5]=_[1],e[6]=f[2],e[7]=P[2],e[8]=_[2],e}_upAtLookAt(t,e){return 2===this.viewingMode?h(e,x.upward):w(e,t)}_eyeUpToPitch(t){return Math.PI-M(x.upward,t)}_eyeUpToYaw(t,e){const i=v;return Math.abs(e[2])<.5?(h(i,e),t[2]>0&&c(i,i,-1)):h(i,t),p(P,i,x.upward),w(P,P),M(x.sideway,P,x.upward)}}export default T;\n"]},"metadata":{},"sourceType":"module"}