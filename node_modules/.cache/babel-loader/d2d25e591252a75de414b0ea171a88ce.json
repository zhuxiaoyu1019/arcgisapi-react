{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../Basemap.js\";\nimport r from \"../core/Collection.js\";\nimport n from \"../core/Logger.js\";\nimport { normalize as t, Url as a, makeAbsolute as l } from \"../core/urlUtils.js\";\nimport { ensureType as s } from \"../core/accessorSupport/ensureType.js\";\nimport { esriBasemapDefinitions as i } from \"./basemapDefinitions.js\";\nconst o = n.getLogger(\"esri.support.basemapUtils\");\n\nfunction c() {\n  return {};\n}\n\nfunction u(e) {\n  for (const r in e) {\n    const n = e[r];\n    !1 === (null == n ? void 0 : n.destroyed) && n.destroy(), delete e[r];\n  }\n}\n\nfunction f(r, n) {\n  var t;\n  let a;\n\n  if (\"string\" == typeof r) {\n    if (!(r in i)) {\n      const e = Object.keys(i).map(e => `\"${e}\"`).join(\", \");\n      return o.warn(`Unable to find basemap definition for: ${r}. Try one of these: ${e}`), null;\n    }\n\n    n && (a = n[r]), a || (a = e.fromId(r), n && (n[r] = a));\n  } else a = s(e, r);\n\n  return null != (t = a) && t.destroyed && (o.warn(\"The provided basemap is already destroyed\", {\n    basemap: a\n  }), a = null), a;\n}\n\nfunction y(r, n = null) {\n  const t = f(r);\n  if (!t) return null;\n  const a = new e({\n    id: t.id,\n    title: t.title,\n    baseLayers: t.baseLayers.slice(),\n    referenceLayers: t.referenceLayers.slice()\n  });\n  return n && (a.baseLayers = b(a.baseLayers, n.baseLayers), a.referenceLayers = b(a.referenceLayers, n.referenceLayers)), a.load().catch(() => {}), a.portalItem = t.portalItem, a;\n}\n\nfunction m(e) {\n  let r = null;\n  const n = v(e),\n        t = !n.baseLayers.length;\n\n  for (const a in i) {\n    const e = w(n, x(i[a]), {\n      mustMatchReferences: t\n    });\n\n    if (\"equal\" === e) {\n      r = a;\n      break;\n    }\n\n    \"base-layers-equal\" === e && (r = a);\n  }\n\n  return r;\n}\n\nfunction p(e, r) {\n  if (e === r) return !0;\n  return \"equal\" === w(v(e), v(r), {\n    mustMatchReferences: !0\n  });\n}\n\nfunction b(e, n) {\n  const t = new r();\n  return e.forEach(e => {\n    const r = n.find(r => I(g(e), g(r))) || e;\n    t.some(e => e === r) ? t.push(e) : t.push(r);\n  }), t;\n}\n\nfunction L(e) {\n  return !(null == e || !e.baseLayers.concat(e.referenceLayers).some(d));\n}\n\nfunction d(e) {\n  if (h(e.url)) return !0;\n  if (\"vector-tile\" === e.type) for (const r in e.sourceNameToSource) {\n    const n = e.sourceNameToSource[r];\n    if (h(null == n ? void 0 : n.sourceUrl)) return !0;\n  }\n  return !1;\n}\n\nconst S = /^(basemaps|ibasemaps).*-api\\.arcgis\\.com$/i;\n\nfunction h(e) {\n  if (!e) return !1;\n  const r = new a(l(e));\n  return S.test(r.authority);\n}\n\nfunction v(e) {\n  return e ? !e.loaded && e.resourceInfo ? x(e.resourceInfo.data) : {\n    baseLayers: T(e.baseLayers),\n    referenceLayers: T(e.referenceLayers)\n  } : null;\n}\n\nfunction T(e) {\n  return (r.isCollection(e) ? e.toArray() : e).map(g);\n}\n\nfunction g(e) {\n  return {\n    type: e.type,\n    url: M(\"urlTemplate\" in e && e.urlTemplate || e.url || \"styleUrl\" in e && e.styleUrl),\n    minScale: \"minScale\" in e && null != e.minScale ? e.minScale : 0,\n    maxScale: \"maxScale\" in e && null != e.maxScale ? e.maxScale : 0,\n    opacity: null != e.opacity ? e.opacity : 1,\n    visible: null == e.visible || !!e.visible\n  };\n}\n\nfunction x(e) {\n  return e ? {\n    baseLayers: q(e.baseMapLayers.filter(e => !e.isReference)),\n    referenceLayers: q(e.baseMapLayers.filter(e => e.isReference))\n  } : null;\n}\n\nfunction q(e) {\n  return e.map(e => j(e));\n}\n\nfunction j(e) {\n  let r;\n\n  switch (e.layerType) {\n    case \"VectorTileLayer\":\n      r = \"vector-tile\";\n      break;\n\n    case \"ArcGISTiledMapServiceLayer\":\n      r = \"tile\";\n      break;\n\n    default:\n      r = \"unknown\";\n  }\n\n  return {\n    type: r,\n    url: M(e.templateUrl || e.urlTemplate || e.styleUrl || e.url),\n    minScale: null != e.minScale ? e.minScale : 0,\n    maxScale: null != e.maxScale ? e.maxScale : 0,\n    opacity: null != e.opacity ? e.opacity : 1,\n    visible: null == e.visibility || !!e.visibility\n  };\n}\n\nfunction w(e, r, n) {\n  if (null != e != (null != r)) return \"not-equal\";\n  if (!e) return \"equal\";\n  if (!U(e.baseLayers, r.baseLayers)) return \"not-equal\";\n  return U(e.referenceLayers, r.referenceLayers) ? \"equal\" : n.mustMatchReferences ? \"not-equal\" : \"base-layers-equal\";\n}\n\nfunction U(e, r) {\n  if (e.length !== r.length) return !1;\n\n  for (let n = 0; n < e.length; n++) if (!I(e[n], r[n])) return !1;\n\n  return !0;\n}\n\nfunction I(e, r) {\n  return e.type === r.type && e.url === r.url && e.minScale === r.minScale && e.maxScale === r.maxScale && e.visible === r.visible && e.opacity === r.opacity;\n}\n\nfunction M(e) {\n  return e ? t(e).replace(/^\\s*https?:/i, \"\").toLowerCase() : \"\";\n}\n\nexport { y as clonePreservingTiledLayers, p as contentEquals, c as createCache, u as destroyCache, f as ensureType, m as getWellKnownBasemapId, L as hasDeveloperBasemapLayer, d as isDeveloperBasemapLayer };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/support/basemapUtils.js"],"names":["e","r","n","normalize","t","Url","a","makeAbsolute","l","ensureType","s","esriBasemapDefinitions","i","o","getLogger","c","u","destroyed","destroy","f","Object","keys","map","join","warn","fromId","basemap","y","id","title","baseLayers","slice","referenceLayers","b","load","catch","portalItem","m","v","length","w","x","mustMatchReferences","p","forEach","find","I","g","some","push","L","concat","d","h","url","type","sourceNameToSource","sourceUrl","S","test","authority","loaded","resourceInfo","data","T","isCollection","toArray","M","urlTemplate","styleUrl","minScale","maxScale","opacity","visible","q","baseMapLayers","filter","isReference","j","layerType","templateUrl","visibility","U","replace","toLowerCase","clonePreservingTiledLayers","contentEquals","createCache","destroyCache","getWellKnownBasemapId","hasDeveloperBasemapLayer","isDeveloperBasemapLayer"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../Basemap.js\";import r from\"../core/Collection.js\";import n from\"../core/Logger.js\";import{normalize as t,Url as a,makeAbsolute as l}from\"../core/urlUtils.js\";import{ensureType as s}from\"../core/accessorSupport/ensureType.js\";import{esriBasemapDefinitions as i}from\"./basemapDefinitions.js\";const o=n.getLogger(\"esri.support.basemapUtils\");function c(){return{}}function u(e){for(const r in e){const n=e[r];!1===(null==n?void 0:n.destroyed)&&n.destroy(),delete e[r]}}function f(r,n){var t;let a;if(\"string\"==typeof r){if(!(r in i)){const e=Object.keys(i).map((e=>`\"${e}\"`)).join(\", \");return o.warn(`Unable to find basemap definition for: ${r}. Try one of these: ${e}`),null}n&&(a=n[r]),a||(a=e.fromId(r),n&&(n[r]=a))}else a=s(e,r);return null!=(t=a)&&t.destroyed&&(o.warn(\"The provided basemap is already destroyed\",{basemap:a}),a=null),a}function y(r,n=null){const t=f(r);if(!t)return null;const a=new e({id:t.id,title:t.title,baseLayers:t.baseLayers.slice(),referenceLayers:t.referenceLayers.slice()});return n&&(a.baseLayers=b(a.baseLayers,n.baseLayers),a.referenceLayers=b(a.referenceLayers,n.referenceLayers)),a.load().catch((()=>{})),a.portalItem=t.portalItem,a}function m(e){let r=null;const n=v(e),t=!n.baseLayers.length;for(const a in i){const e=w(n,x(i[a]),{mustMatchReferences:t});if(\"equal\"===e){r=a;break}\"base-layers-equal\"===e&&(r=a)}return r}function p(e,r){if(e===r)return!0;return\"equal\"===w(v(e),v(r),{mustMatchReferences:!0})}function b(e,n){const t=new r;return e.forEach((e=>{const r=n.find((r=>I(g(e),g(r))))||e;t.some((e=>e===r))?t.push(e):t.push(r)})),t}function L(e){return!(null==e||!e.baseLayers.concat(e.referenceLayers).some(d))}function d(e){if(h(e.url))return!0;if(\"vector-tile\"===e.type)for(const r in e.sourceNameToSource){const n=e.sourceNameToSource[r];if(h(null==n?void 0:n.sourceUrl))return!0}return!1}const S=/^(basemaps|ibasemaps).*-api\\.arcgis\\.com$/i;function h(e){if(!e)return!1;const r=new a(l(e));return S.test(r.authority)}function v(e){return e?!e.loaded&&e.resourceInfo?x(e.resourceInfo.data):{baseLayers:T(e.baseLayers),referenceLayers:T(e.referenceLayers)}:null}function T(e){return(r.isCollection(e)?e.toArray():e).map(g)}function g(e){return{type:e.type,url:M(\"urlTemplate\"in e&&e.urlTemplate||e.url||\"styleUrl\"in e&&e.styleUrl),minScale:\"minScale\"in e&&null!=e.minScale?e.minScale:0,maxScale:\"maxScale\"in e&&null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible}}function x(e){return e?{baseLayers:q(e.baseMapLayers.filter((e=>!e.isReference))),referenceLayers:q(e.baseMapLayers.filter((e=>e.isReference)))}:null}function q(e){return e.map((e=>j(e)))}function j(e){let r;switch(e.layerType){case\"VectorTileLayer\":r=\"vector-tile\";break;case\"ArcGISTiledMapServiceLayer\":r=\"tile\";break;default:r=\"unknown\"}return{type:r,url:M(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:null!=e.minScale?e.minScale:0,maxScale:null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visibility||!!e.visibility}}function w(e,r,n){if(null!=e!=(null!=r))return\"not-equal\";if(!e)return\"equal\";if(!U(e.baseLayers,r.baseLayers))return\"not-equal\";return U(e.referenceLayers,r.referenceLayers)?\"equal\":n.mustMatchReferences?\"not-equal\":\"base-layers-equal\"}function U(e,r){if(e.length!==r.length)return!1;for(let n=0;n<e.length;n++)if(!I(e[n],r[n]))return!1;return!0}function I(e,r){return e.type===r.type&&e.url===r.url&&e.minScale===r.minScale&&e.maxScale===r.maxScale&&e.visible===r.visible&&e.opacity===r.opacity}function M(e){return e?t(e).replace(/^\\s*https?:/i,\"\").toLowerCase():\"\"}export{y as clonePreservingTiledLayers,p as contentEquals,c as createCache,u as destroyCache,f as ensureType,m as getWellKnownBasemapId,L as hasDeveloperBasemapLayer,d as isDeveloperBasemapLayer};\n"]},"metadata":{},"sourceType":"module"}