{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../core/Logger.js\";\nimport { EventMatch as t } from \"./EventMatch.js\";\nconst n = e.getLogger(\"esri.views.input.InputHandler\");\n\nclass i {\n  constructor(e) {\n    this._manager = null, this._incoming = {}, this._outgoing = {}, this._incomingEventMatches = null, this._incomingEventTypes = null, this._outgoingEventTypes = null, this._hasSideEffects = e;\n  }\n\n  get incomingEventMatches() {\n    if (!this._incomingEventMatches) {\n      this._incomingEventMatches = [];\n\n      for (const e in this._incoming) {\n        const t = this._incoming[e];\n\n        for (const e of t) this._incomingEventMatches.push(e.match);\n      }\n    }\n\n    return this._incomingEventMatches;\n  }\n\n  get incomingEventTypes() {\n    return this._incomingEventTypes || (this._incomingEventTypes = this.incomingEventMatches.map(e => e.eventType)), this._incomingEventTypes;\n  }\n\n  get outgoingEventTypes() {\n    return this._outgoingEventTypes || (this._outgoingEventTypes = Object.keys(this._outgoing)), this._outgoingEventTypes;\n  }\n\n  get hasSideEffects() {\n    return this._hasSideEffects;\n  }\n\n  get hasPendingInputs() {\n    return !1;\n  }\n\n  onInstall(e) {\n    this._manager ? n.error(\"This InputHandler has already been registered with an InputManager\") : (e.setEventCallback(e => this._handleEvent(e)), e.setUninstallCallback(() => this._onUninstall()), this._manager = e);\n  }\n\n  onUninstall() {}\n\n  registerIncoming(e, n, i) {\n    let a;\n    \"function\" == typeof n ? (i = n, a = []) : a = n || [];\n\n    const o = \"string\" == typeof e ? new t(e, a) : e,\n          h = () => {\n      this._incomingEventTypes = null, this._incomingEventMatches = null;\n    },\n          r = e => {\n      const t = this._incoming[e.match.eventType];\n\n      if (t) {\n        const n = t.indexOf(e);\n        t.splice(n, 1), h(), this._manager && this._manager.updateDependencies();\n      }\n    },\n          g = new s(o, i, {\n      onPause: r,\n      onRemove: r,\n      onResume: e => {\n        const t = this._incoming[e.match.eventType];\n        t && -1 === t.indexOf(e) && (t.push(e), h(), this._manager && this._manager.updateDependencies());\n      }\n    });\n\n    let c = this._incoming[o.eventType];\n    return c || (c = [], this._incoming[o.eventType] = c), c.push(g), h(), this._manager && this._manager.updateDependencies(), g;\n  }\n\n  registerOutgoing(e) {\n    if (this._outgoing[e]) throw Error(\"There is already a callback registered for this outgoing InputEvent: \" + e);\n    const t = new a(e, {\n      onEmit: (e, t, n, i) => {\n        this._manager.emit(e.eventType, t, n, i);\n      },\n      onRemove: e => {\n        delete this._outgoing[e.eventType], this._manager.updateDependencies();\n      }\n    });\n    return this._outgoing[e] = t, this._outgoingEventTypes = null, this._manager && this._manager.updateDependencies(), t;\n  }\n\n  startCapturingPointer(e) {\n    this._manager.setPointerCapture(e, !0);\n  }\n\n  stopCapturingPointer(e) {\n    this._manager.setPointerCapture(e, !1);\n  }\n\n  refreshHasPendingInputs() {\n    this._manager.refreshHasPendingInputs();\n  }\n\n  _onUninstall() {\n    this._manager ? (this.onUninstall(), this._manager = null) : n.error(\"This InputHandler is not registered with an InputManager\");\n  }\n\n  _handleEvent(e) {\n    const t = this._incoming[e.type];\n    if (t) for (const n of t) if (n.match.matches(e) && (n.callback(e), e.shouldStopPropagation())) break;\n  }\n\n}\n\nclass s {\n  constructor(e, t, n) {\n    this.match = e, this._callback = t, this._handler = n;\n  }\n\n  pause() {\n    this._handler.onPause(this);\n  }\n\n  resume() {\n    this._handler.onResume(this);\n  }\n\n  remove() {\n    this._handler.onRemove(this);\n  }\n\n  get callback() {\n    return this._callback;\n  }\n\n}\n\nclass a {\n  constructor(e, t) {\n    this.eventType = e, this._removed = !1, this._handler = t;\n  }\n\n  emit(e, t, n) {\n    this._removed || this._handler.onEmit(this, e, t, n);\n  }\n\n  remove() {\n    this._removed = !0, this._handler.onRemove(this);\n  }\n\n}\n\nexport { i as InputHandler };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/input/InputHandler.js"],"names":["e","EventMatch","t","n","getLogger","i","constructor","_manager","_incoming","_outgoing","_incomingEventMatches","_incomingEventTypes","_outgoingEventTypes","_hasSideEffects","incomingEventMatches","push","match","incomingEventTypes","map","eventType","outgoingEventTypes","Object","keys","hasSideEffects","hasPendingInputs","onInstall","error","setEventCallback","_handleEvent","setUninstallCallback","_onUninstall","onUninstall","registerIncoming","a","o","h","r","indexOf","splice","updateDependencies","g","s","onPause","onRemove","onResume","c","registerOutgoing","Error","onEmit","emit","startCapturingPointer","setPointerCapture","stopCapturingPointer","refreshHasPendingInputs","type","matches","callback","shouldStopPropagation","_callback","_handler","pause","resume","remove","_removed","InputHandler"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Logger.js\";import{EventMatch as t}from\"./EventMatch.js\";const n=e.getLogger(\"esri.views.input.InputHandler\");class i{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const e of t)this._incomingEventMatches.push(e.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((e=>e.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?n.error(\"This InputHandler has already been registered with an InputManager\"):(e.setEventCallback((e=>this._handleEvent(e))),e.setUninstallCallback((()=>this._onUninstall())),this._manager=e)}onUninstall(){}registerIncoming(e,n,i){let a;\"function\"==typeof n?(i=n,a=[]):a=n||[];const o=\"string\"==typeof e?new t(e,a):e,h=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},r=e=>{const t=this._incoming[e.match.eventType];if(t){const n=t.indexOf(e);t.splice(n,1),h(),this._manager&&this._manager.updateDependencies()}},g=new s(o,i,{onPause:r,onRemove:r,onResume:e=>{const t=this._incoming[e.match.eventType];t&&-1===t.indexOf(e)&&(t.push(e),h(),this._manager&&this._manager.updateDependencies())}});let c=this._incoming[o.eventType];return c||(c=[],this._incoming[o.eventType]=c),c.push(g),h(),this._manager&&this._manager.updateDependencies(),g}registerOutgoing(e){if(this._outgoing[e])throw Error(\"There is already a callback registered for this outgoing InputEvent: \"+e);const t=new a(e,{onEmit:(e,t,n,i)=>{this._manager.emit(e.eventType,t,n,i)},onRemove:e=>{delete this._outgoing[e.eventType],this._manager.updateDependencies()}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){this._manager.setPointerCapture(e,!0)}stopCapturingPointer(e){this._manager.setPointerCapture(e,!1)}refreshHasPendingInputs(){this._manager.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):n.error(\"This InputHandler is not registered with an InputManager\")}_handleEvent(e){const t=this._incoming[e.type];if(t)for(const n of t)if(n.match.matches(e)&&(n.callback(e),e.shouldStopPropagation()))break}}class s{constructor(e,t,n){this.match=e,this._callback=t,this._handler=n}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}}class a{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t}emit(e,t,n){this._removed||this._handler.onEmit(this,e,t,n)}remove(){this._removed=!0,this._handler.onRemove(this)}}export{i as InputHandler};\n"]},"metadata":{},"sourceType":"module"}