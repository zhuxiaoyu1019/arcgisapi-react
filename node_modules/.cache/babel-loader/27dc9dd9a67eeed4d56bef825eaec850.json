{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport t from \"../../Graphic.js\";\nimport r from \"../../core/Error.js\";\nimport { isSome as i } from \"../../core/maybe.js\";\nimport { property as o } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/has.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport \"../../core/Logger.js\";\nimport { subclass as s } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { getDefaultDatumTransformationForDataset as a, projectExtent as n } from \"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";\nimport { getFetchPopupTemplate as l } from \"./support/popupUtils.js\";\n\nconst p = p => {\n  let u = class extends p {\n    constructor() {\n      super(...arguments), this._rasterFieldPrefix = \"Raster.\", this.layer = null, this.view = null, this.fullExtent = null, this.tileInfo = null, this.datumTransformation = null;\n    }\n\n    get hasTilingEffects() {\n      return this.layer.renderer && \"dynamicRangeAdjustment\" in this.layer.renderer && this.layer.renderer.dynamicRangeAdjustment;\n    }\n\n    async fetchPopupFeatures(e, o) {\n      const {\n        layer: s\n      } = this;\n      if (!e) return Promise.reject(new r(\"imageryTileLayerView:fetchPopupFeatures\", \"Nothing to fetch without area\", {\n        layer: s\n      }));\n      const {\n        popupEnabled: a\n      } = s,\n            n = l(s, o);\n      if (!a || !i(n)) throw new r(\"imageryTileLayerView:fetchPopupFeatures\", \"Missing required popupTemplate or popupEnabled\", {\n        popupEnabled: a,\n        popupTemplate: n\n      });\n      const p = [],\n            {\n        value: u\n      } = await s.identify(e);\n      let f = \"\";\n\n      if (u && u.length) {\n        var m, c;\n        f = \"imagery-tile\" === s.type && s.hasStandardTime() && null != u[0] ? u.map(e => s.getStandardTimeValue(e)).join(\", \") : u.join(\", \");\n        const e = {\n          ObjectId: 0\n        },\n              r = \"Raster.ServicePixelValue\";\n        e[r] = this._formatAttributeValue(f, r);\n        const i = null == (m = s.rasterInfo) || null == (c = m.attributeTable) ? void 0 : c.features;\n\n        if (i && i.length > 0) {\n          const t = i.filter(e => {\n            const t = e.attributes.value || e.attributes.Value || e.attributes.VALUE;\n            return String(t) === f;\n          });\n\n          if (t.length > 0) {\n            const r = t[0];\n            if (r) for (const t in r.attributes) if (r.attributes.hasOwnProperty(t)) {\n              const i = this._rasterFieldPrefix + t;\n              e[i] = this._formatAttributeValue(r.attributes[t], i);\n            }\n          }\n        }\n\n        const o = new t(this.fullExtent.clone(), null, e);\n        o.layer = s, o.sourceLayer = o.layer, p.push(o);\n      }\n\n      return p;\n    }\n\n    updateFullExtent() {\n      const e = this.layer.tileInfo;\n      let t;\n      e && e.spatialReference || (t = new r(\"layerview:tiling-information-missing\", \"The layer doesn't provide tiling information\", {\n        layer: this.layer\n      }));\n      const i = a(this.layer.fullExtent, this.view.spatialReference, !1),\n            o = n(this.layer.fullExtent, this.view.spatialReference, i);\n      return null == o && (t = new r(\"layerview:projection-not-supported\", \"The layer extent cannot be projected to the view's spatial reference\", {\n        layer: this.layer\n      })), this._set(\"fullExtent\", o), this.datumTransformation || (this.datumTransformation = a(this.layer.fullExtent, this.view.spatialReference, !0)), t ? Promise.reject(t) : Promise.resolve();\n    }\n\n    _formatAttributeValue(e, t) {\n      if (\"string\" == typeof e) {\n        const r = this.layer.popupTemplate && this.layer.popupTemplate.fieldInfos,\n              i = this._getFieldInfo(r, t),\n              o = i && i.format;\n\n        if (o) {\n          let t, r;\n          return e.trim().indexOf(\",\") > -1 ? (t = \",\", r = t + \" \", this._formatDelimitedString(e, t, r, o)) : e.trim().indexOf(\" \") > -1 ? (t = r = \" \", this._formatDelimitedString(e, t, r, o)) : this._formatNumberFromString(e, o);\n        }\n      }\n\n      return e;\n    }\n\n    _getFieldInfo(e, t) {\n      if (!e || !e.length || !t) return;\n      const r = t.toLowerCase();\n      let i;\n      return e.some(e => !(!e.fieldName || e.fieldName.toLowerCase() !== r && e.fieldName.toLowerCase() !== r.replace(/ /g, \"_\")) && (i = e, !0)), i;\n    }\n\n    _formatDelimitedString(e, t, r, i) {\n      return e && t && r && i ? e.trim().split(t).map(e => this._formatNumberFromString(e, i)).join(r) : e;\n    }\n\n    _formatNumberFromString(e, t) {\n      if (!e || !t) return e;\n      const r = Number(e);\n      return isNaN(r) ? e : t.format(r);\n    }\n\n  };\n  return e([o()], u.prototype, \"layer\", void 0), e([o()], u.prototype, \"view\", void 0), e([o()], u.prototype, \"fullExtent\", void 0), e([o()], u.prototype, \"tileInfo\", void 0), e([o({\n    readOnly: !0\n  })], u.prototype, \"hasTilingEffects\", null), u = e([s(\"esri.views.layers.ImageryTileLayerView\")], u), u;\n};\n\nexport default p;\nexport { p as ImageryTileLayerView };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/layers/ImageryTileLayerView.js"],"names":["_","e","t","r","isSome","i","property","o","subclass","s","getDefaultDatumTransformationForDataset","a","projectExtent","n","getFetchPopupTemplate","l","p","u","constructor","arguments","_rasterFieldPrefix","layer","view","fullExtent","tileInfo","datumTransformation","hasTilingEffects","renderer","dynamicRangeAdjustment","fetchPopupFeatures","Promise","reject","popupEnabled","popupTemplate","value","identify","f","length","m","c","type","hasStandardTime","map","getStandardTimeValue","join","ObjectId","_formatAttributeValue","rasterInfo","attributeTable","features","filter","attributes","Value","VALUE","String","hasOwnProperty","clone","sourceLayer","push","updateFullExtent","spatialReference","_set","resolve","fieldInfos","_getFieldInfo","format","trim","indexOf","_formatDelimitedString","_formatNumberFromString","toLowerCase","some","fieldName","replace","split","Number","isNaN","prototype","readOnly","ImageryTileLayerView"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../Graphic.js\";import r from\"../../core/Error.js\";import{isSome as i}from\"../../core/maybe.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import{getDefaultDatumTransformationForDataset as a,projectExtent as n}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import{getFetchPopupTemplate as l}from\"./support/popupUtils.js\";const p=p=>{let u=class extends p{constructor(){super(...arguments),this._rasterFieldPrefix=\"Raster.\",this.layer=null,this.view=null,this.fullExtent=null,this.tileInfo=null,this.datumTransformation=null}get hasTilingEffects(){return this.layer.renderer&&\"dynamicRangeAdjustment\"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}async fetchPopupFeatures(e,o){const{layer:s}=this;if(!e)return Promise.reject(new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s}));const{popupEnabled:a}=s,n=l(s,o);if(!a||!i(n))throw new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:a,popupTemplate:n});const p=[],{value:u}=await s.identify(e);let f=\"\";if(u&&u.length){var m,c;f=\"imagery-tile\"===s.type&&s.hasStandardTime()&&null!=u[0]?u.map((e=>s.getStandardTimeValue(e))).join(\", \"):u.join(\", \");const e={ObjectId:0},r=\"Raster.ServicePixelValue\";e[r]=this._formatAttributeValue(f,r);const i=null==(m=s.rasterInfo)||null==(c=m.attributeTable)?void 0:c.features;if(i&&i.length>0){const t=i.filter((e=>{const t=e.attributes.value||e.attributes.Value||e.attributes.VALUE;return String(t)===f}));if(t.length>0){const r=t[0];if(r)for(const t in r.attributes)if(r.attributes.hasOwnProperty(t)){const i=this._rasterFieldPrefix+t;e[i]=this._formatAttributeValue(r.attributes[t],i)}}}const o=new t(this.fullExtent.clone(),null,e);o.layer=s,o.sourceLayer=o.layer,p.push(o)}return p}updateFullExtent(){const e=this.layer.tileInfo;let t;e&&e.spatialReference||(t=new r(\"layerview:tiling-information-missing\",\"The layer doesn't provide tiling information\",{layer:this.layer}));const i=a(this.layer.fullExtent,this.view.spatialReference,!1),o=n(this.layer.fullExtent,this.view.spatialReference,i);return null==o&&(t=new r(\"layerview:projection-not-supported\",\"The layer extent cannot be projected to the view's spatial reference\",{layer:this.layer})),this._set(\"fullExtent\",o),this.datumTransformation||(this.datumTransformation=a(this.layer.fullExtent,this.view.spatialReference,!0)),t?Promise.reject(t):Promise.resolve()}_formatAttributeValue(e,t){if(\"string\"==typeof e){const r=this.layer.popupTemplate&&this.layer.popupTemplate.fieldInfos,i=this._getFieldInfo(r,t),o=i&&i.format;if(o){let t,r;return e.trim().indexOf(\",\")>-1?(t=\",\",r=t+\" \",this._formatDelimitedString(e,t,r,o)):e.trim().indexOf(\" \")>-1?(t=r=\" \",this._formatDelimitedString(e,t,r,o)):this._formatNumberFromString(e,o)}}return e}_getFieldInfo(e,t){if(!e||!e.length||!t)return;const r=t.toLowerCase();let i;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==r&&e.fieldName.toLowerCase()!==r.replace(/ /g,\"_\"))&&(i=e,!0))),i}_formatDelimitedString(e,t,r,i){return e&&t&&r&&i?e.trim().split(t).map((e=>this._formatNumberFromString(e,i))).join(r):e}_formatNumberFromString(e,t){if(!e||!t)return e;const r=Number(e);return isNaN(r)?e:t.format(r)}};return e([o()],u.prototype,\"layer\",void 0),e([o()],u.prototype,\"view\",void 0),e([o()],u.prototype,\"fullExtent\",void 0),e([o()],u.prototype,\"tileInfo\",void 0),e([o({readOnly:!0})],u.prototype,\"hasTilingEffects\",null),u=e([s(\"esri.views.layers.ImageryTileLayerView\")],u),u};export default p;export{p as ImageryTileLayerView};\n"]},"metadata":{},"sourceType":"module"}