{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from \"../../../../core/Logger.js\";\nimport { lerp as i } from \"../../../../core/mathUtils.js\";\nimport { isSome as e } from \"../../../../core/maybe.js\";\nimport { createScreenPointArray as r, createRenderScreenPointArray3 as s } from \"../../../../core/screenUtils.js\";\nimport { d as h, m as n, k as o, a, e as _, l as p } from \"../../../../chunks/mat4.js\";\nimport { c as u } from \"../../../../chunks/mat4f64.js\";\nimport { c as v, k as c } from \"../../../../chunks/vec2.js\";\nimport { f as w } from \"../../../../chunks/vec2f64.js\";\nimport { g as d, f as l, i as g, k as y, w as m, d as f, x, y as D, a as j, l as M, s as R, c as P, n as F, r as V } from \"../../../../chunks/vec3.js\";\nimport { c as S, a as T, f as I } from \"../../../../chunks/vec3f64.js\";\nimport { c as b, g as k, i as U, t as A } from \"../../../../chunks/vec4.js\";\nimport { f as C, c as E } from \"../../../../chunks/vec4f64.js\";\nimport { create as z, copy as H, fromMatrix as W } from \"../../../../geometry/support/frustum.js\";\nimport { create as L } from \"../../../../geometry/support/ray.js\";\nimport { projectPointSignedLength as G } from \"../../../../geometry/support/vector.js\";\nimport { fovd2fovx as X, fovx2fovd as Y, fovd2fovy as q, fovy2fovd as N } from \"./Util.js\";\nconst B = t.getLogger(\"esri.views.3d.webgl-engine.lib.Camera\");\n\nclass J {\n  constructor(t = null, i = null, r = null) {\n    this._viewUp = S(), this._viewForward = S(), this._viewRight = S(), this._ray = L(), this._viewport = C(0, 0, 1, 1), this._padding = C(0, 0, 0, 0), this._fov = 55 / 180 * Math.PI, this._nearFar = w(1, 1e3), this._viewDirty = !0, this._viewMatrix = u(), this._projectionDirty = !0, this._projectionMatrix = u(), this._viewProjectionDirty = !0, this._viewProjectionMatrix = u(), this._viewInverseTransposeMatrixDirty = !0, this._viewInverseTransposeMatrix = u(), this._frustumDirty = !0, this._frustum = z(), this._fullViewport = E(), this.pixelRatio = 1, this.relativeElevation = 0, e(t) && d(this._ray.origin, t), this._center = e(i) ? T(i) : S(), this._up = e(r) ? T(r) : I(0, 0, 1);\n  }\n\n  get eye() {\n    return this._ray.origin;\n  }\n\n  set eye(t) {\n    this._compareAndSetView(t, this._ray.origin);\n  }\n\n  get center() {\n    return this._center;\n  }\n\n  set center(t) {\n    this._compareAndSetView(t, this._center);\n  }\n\n  get ray() {\n    return l(this._ray.direction, this.center, this.eye), this._ray;\n  }\n\n  get up() {\n    return this._up;\n  }\n\n  set up(t) {\n    this._compareAndSetView(t, this._up);\n  }\n\n  get viewMatrix() {\n    return this._ensureViewClean(), this._viewMatrix;\n  }\n\n  set viewMatrix(t) {\n    h(this._viewMatrix, t), this._viewDirty = !1, this._viewInverseTransposeMatrixDirty = !0, this._viewProjectionDirty = !0, this._frustumDirty = !0;\n  }\n\n  get viewForward() {\n    return this._ensureViewClean(), this._viewForward;\n  }\n\n  get viewUp() {\n    return this._ensureViewClean(), this._viewUp;\n  }\n\n  get viewRight() {\n    return this._ensureViewClean(), this._viewRight;\n  }\n\n  get nearFar() {\n    return this._nearFar;\n  }\n\n  get near() {\n    return this._nearFar[0];\n  }\n\n  set near(t) {\n    this._nearFar[0] !== t && (this._nearFar[0] = t, this._projectionDirty = !0, this._viewProjectionDirty = !0, this._frustumDirty = !0);\n  }\n\n  get far() {\n    return this._nearFar[1];\n  }\n\n  set far(t) {\n    this._nearFar[1] !== t && (this._nearFar[1] = t, this._projectionDirty = !0, this._viewProjectionDirty = !0, this._frustumDirty = !0);\n  }\n\n  get viewport() {\n    return this._viewport;\n  }\n\n  set viewport(t) {\n    this.x = t[0], this.y = t[1], this.width = t[2], this.height = t[3];\n  }\n\n  get x() {\n    return this._viewport[0];\n  }\n\n  set x(t) {\n    t += this._padding[3], this._viewport[0] !== t && (this._viewport[0] = t, this._projectionDirty = !0, this._viewProjectionDirty = !0, this._frustumDirty = !0);\n  }\n\n  get y() {\n    return this._viewport[1];\n  }\n\n  set y(t) {\n    t += this._padding[2], this._viewport[1] !== t && (this._viewport[1] = t, this._projectionDirty = !0, this._viewProjectionDirty = !0, this._frustumDirty = !0);\n  }\n\n  get width() {\n    return this._viewport[2];\n  }\n\n  set width(t) {\n    this._viewport[2] !== t && (this._viewport[2] = t, this._projectionDirty = !0, this._viewProjectionDirty = !0, this._frustumDirty = !0);\n  }\n\n  get height() {\n    return this._viewport[3];\n  }\n\n  set height(t) {\n    this._viewport[3] !== t && (this._viewport[3] = t, this._projectionDirty = !0, this._viewProjectionDirty = !0, this._frustumDirty = !0);\n  }\n\n  get fullWidth() {\n    return this._viewport[2] + this._padding[1] + this._padding[3];\n  }\n\n  set fullWidth(t) {\n    this.width = t - (this._padding[1] + this._padding[3]);\n  }\n\n  get fullHeight() {\n    return this._viewport[3] + this._padding[0] + this._padding[2];\n  }\n\n  set fullHeight(t) {\n    this.height = t - (this._padding[0] + this._padding[2]);\n  }\n\n  get fullViewport() {\n    return this._fullViewport[0] = this._viewport[0] - this._padding[3], this._fullViewport[1] = this._viewport[1] - this._padding[2], this._fullViewport[2] = this.fullWidth, this._fullViewport[3] = this.fullHeight, this._fullViewport;\n  }\n\n  get aspect() {\n    return this.width / this.height;\n  }\n\n  get padding() {\n    return this._padding;\n  }\n\n  set padding(t) {\n    this._padding[0] === t[0] && this._padding[1] === t[1] && this._padding[2] === t[2] && this._padding[3] === t[3] || (this._viewport[0] += t[3] - this._padding[3], this._viewport[1] += t[2] - this._padding[2], this._viewport[2] -= t[1] + t[3] - (this._padding[1] + this._padding[3]), this._viewport[3] -= t[0] + t[2] - (this._padding[0] + this._padding[2]), b(this._padding, t), this._projectionDirty = !0, this._viewProjectionDirty = !0, this._frustumDirty = !0);\n  }\n\n  get viewProjectionMatrix() {\n    return this._viewProjectionDirty && (n(this._viewProjectionMatrix, this.projectionMatrix, this.viewMatrix), this._viewProjectionDirty = !1), this._viewProjectionMatrix;\n  }\n\n  get projectionMatrix() {\n    if (this._projectionDirty) {\n      const t = this.width,\n            i = this.height,\n            e = this.near * Math.tan(this.fovY / 2),\n            r = e * this.aspect;\n      o(this._projectionMatrix, -r * (1 + 2 * this._padding[3] / t), r * (1 + 2 * this._padding[1] / t), -e * (1 + 2 * this._padding[2] / i), e * (1 + 2 * this._padding[0] / i), this.near, this.far), this._projectionDirty = !1;\n    }\n\n    return this._projectionMatrix;\n  }\n\n  set projectionMatrix(t) {\n    h(this._projectionMatrix, t), this._projectionDirty = !1, this._viewProjectionDirty = !0, this._frustumDirty = !0;\n  }\n\n  get fov() {\n    return this._fov;\n  }\n\n  set fov(t) {\n    this._fov = t, this._projectionDirty = !0, this._viewProjectionDirty = !0, this._frustumDirty = !0;\n  }\n\n  get fovX() {\n    return X(this._fov, this.width, this.height);\n  }\n\n  set fovX(t) {\n    this._fov = Y(t, this.width, this.height), this._projectionDirty = !0, this._viewProjectionDirty = !0, this._frustumDirty = !0;\n  }\n\n  get fovY() {\n    return q(this._fov, this.width, this.height);\n  }\n\n  set fovY(t) {\n    this._fov = N(t, this.width, this.height), this._projectionDirty = !0, this._viewProjectionDirty = !0, this._frustumDirty = !0;\n  }\n\n  get distance() {\n    return g(this._center, this.eye);\n  }\n\n  get frustum() {\n    return this._recomputeFrustum(), this._frustum;\n  }\n\n  get viewInverseTransposeMatrix() {\n    return (this._viewInverseTransposeMatrixDirty || this._viewDirty) && (a(this._viewInverseTransposeMatrix, this.viewMatrix), _(this._viewInverseTransposeMatrix, this._viewInverseTransposeMatrix), this._viewInverseTransposeMatrixDirty = !1), this._viewInverseTransposeMatrix;\n  }\n\n  depthNDCToWorld(t) {\n    const i = 2 * t - 1;\n    return 2 * this.near * this.far / (this.far + this.near - i * (this.far - this.near));\n  }\n\n  get perRenderPixelRatio() {\n    return Math.tan(this.fovX / 2) / (this.width / 2);\n  }\n\n  get perScreenPixelRatio() {\n    return this.perRenderPixelRatio * this.pixelRatio;\n  }\n\n  get aboveGround() {\n    return this.relativeElevation && this.relativeElevation >= 0;\n  }\n\n  copyFrom(t) {\n    d(this._ray.origin, t.eye), d(this._center, t.center), d(this._up, t.up), b(this._viewport, t.viewport), b(this._padding, t.padding), v(this._nearFar, t.nearFar), this._fov = t.fov, this.relativeElevation = t.relativeElevation;\n    const i = t;\n    return this._viewDirty = i._viewDirty, this._viewDirty || (h(this._viewMatrix, t.viewMatrix), d(this._viewRight, t.viewRight), d(this._viewUp, t.viewUp), d(this._viewForward, t.viewForward)), i._projectionDirty ? this._projectionDirty = !0 : (h(this._projectionMatrix, t.projectionMatrix), this._projectionDirty = !1), this._viewProjectionDirty = !0, this._frustumDirty = i._frustumDirty, this._frustumDirty || (H(t.frustum, this._frustum), this._frustumDirty = !1), i._viewInverseTransposeMatrixDirty ? this._viewInverseTransposeMatrixDirty = !0 : (h(this._viewInverseTransposeMatrix, t.viewInverseTransposeMatrix), this._viewInverseTransposeMatrixDirty = !1), b(this._fullViewport, t.fullViewport), this.pixelRatio = t.pixelRatio, this;\n  }\n\n  copyViewFrom(t) {\n    this.eye = t.eye, this.center = t.center, this.up = t.up;\n  }\n\n  clone() {\n    return new J().copyFrom(this);\n  }\n\n  equals(t) {\n    return y(this.eye, t.eye) && y(this._center, t.center) && y(this._up, t.up) && k(this._viewport, t.viewport) && k(this._padding, t.padding) && c(this._nearFar, t.nearFar) && this._fov === t.fov && this.pixelRatio === t.pixelRatio && this.relativeElevation === t.relativeElevation;\n  }\n\n  almostEquals(t) {\n    if (this.pixelRatio !== t.pixelRatio || Math.abs(t.fov - this._fov) >= .001) return !1;\n    const i = 5e-4,\n          e = 1 - 1e-10;\n    m(Q, t.eye, t.center), m(Z, this.eye, this._center);\n    const r = f(Q, Z),\n          s = x(Q),\n          h = x(Z);\n    return r * r >= e * s * h && D(t.eye, this.eye) < Math.max(s, h) * i * i && U(t.padding, this._padding) < .5 && U(t.viewport, this._viewport) < .5;\n  }\n\n  computeRenderPixelSizeAt(t) {\n    return this.computeRenderPixelSizeAtDist(this.viewDirectionDistance(t));\n  }\n\n  computeRenderPixelSizeAtDist(t) {\n    return t * this.perRenderPixelRatio;\n  }\n\n  computeScreenPixelSizeAt(t) {\n    return this.computeScreenPixelSizeAtDist(this.viewDirectionDistance(t));\n  }\n\n  viewDirectionDistance(t) {\n    return Math.abs(G(this.viewForward, l(Q, t, this.eye)));\n  }\n\n  computeScreenPixelSizeAtDist(t) {\n    return t * this.perScreenPixelRatio;\n  }\n\n  computeDistanceFromRadius(t, i) {\n    return t / Math.tan(Math.min(this.fovX, this.fovY) / (2 * (i || 1)));\n  }\n\n  getScreenCenter(t = r()) {\n    return t[0] = (this.padding[3] + this.width / 2) / this.pixelRatio, t[1] = (this.padding[0] + this.height / 2) / this.pixelRatio, t;\n  }\n\n  getRenderCenter(t, i = .5, e = .5) {\n    return t || (t = s()), t[0] = this.padding[3] + this.width * i, t[1] = this.padding[2] + this.height * e, t.length > 2 && (t[2] = .5), t;\n  }\n\n  setGLViewport(t) {\n    const i = this.viewport,\n          e = this.padding;\n    t.setViewport(i[0] - e[3], i[1] - e[2], i[2] + e[1] + e[3], i[3] + e[0] + e[2]);\n  }\n\n  applyProjection(t, e, r = !1) {\n    t !== K && d(K, t), K[3] = 1, r && (e[2] = -K[2]), A(K, K, this.projectionMatrix), j(K, K, 1 / Math.abs(K[3]));\n    const s = this.fullViewport;\n    return e[0] = i(0, s[0] + s[2], .5 + .5 * K[0]), e[1] = i(0, s[1] + s[3], .5 + .5 * K[1]), r || (e[2] = .5 * (K[2] + 1)), e;\n  }\n\n  projectToScreen(t, i) {\n    this.projectToRenderScreen(t, $), this.renderToScreen($, i);\n  }\n\n  projectToRenderScreen(t, e) {\n    if (K[0] = t[0], K[1] = t[1], K[2] = t[2], K[3] = 1, A(K, K, this.viewProjectionMatrix), 0 === K[3]) return null;\n    j(K, K, 1 / Math.abs(K[3]));\n    const r = this.fullViewport;\n    return \"x\" in e ? (e.x = i(0, r[0] + r[2], .5 + .5 * K[0]), e.y = i(0, r[1] + r[3], .5 + .5 * K[1])) : (e[0] = i(0, r[0] + r[2], .5 + .5 * K[0]), e[1] = i(0, r[1] + r[3], .5 + .5 * K[1]), e.length > 2 && (e[2] = .5 * (K[2] + 1))), e;\n  }\n\n  unprojectFromScreen(t, i) {\n    return this.unprojectFromRenderScreen(this.screenToRender(t, $), i);\n  }\n\n  unprojectFromRenderScreen(t, i) {\n    if (n(O, this.projectionMatrix, this.viewMatrix), !a(O, O)) return null;\n    const e = this.fullViewport;\n    return K[0] = 2 * (t[0] - e[0]) / e[2] - 1, K[1] = 2 * (t[1] - e[1]) / e[3] - 1, K[2] = 2 * t[2] - 1, K[3] = 1, A(K, K, O), 0 === K[3] ? null : (i[0] = K[0] / K[3], i[1] = K[1] / K[3], i[2] = K[2] / K[3], i);\n  }\n\n  constrainWindowSize(t, i, e, r = e) {\n    const s = t * this.pixelRatio,\n          h = i * this.pixelRatio,\n          n = Math.max(s - e / 2, 0),\n          o = Math.max(this.fullHeight - h - r / 2, 0),\n          a = -Math.min(s - e / 2, 0),\n          _ = -Math.min(this.fullHeight - h - r / 2, 0);\n\n    return [n, o, e - a - -Math.min(this.fullWidth - s - e / 2, 0), r - _ - -Math.min(h - r / 2, 0)];\n  }\n\n  computeUp(t) {\n    1 === t ? this.computeUpGlobal() : this.computeUpLocal();\n  }\n\n  screenToRender(t, i) {\n    const e = t[0] * this.pixelRatio,\n          r = this.fullHeight - t[1] * this.pixelRatio;\n    return i[0] = e, i[1] = r, i;\n  }\n\n  renderToScreen(t, i) {\n    const e = t[0] / this.pixelRatio,\n          r = (this.fullHeight - t[1]) / this.pixelRatio;\n    i[0] = e, i[1] = r;\n  }\n\n  computeUpGlobal() {\n    l(Q, this.center, this.eye);\n    const t = M(this.center);\n    t < 1 ? (R(this._up, 0, 0, 1), this._markViewDirty()) : Math.abs(f(Q, this.center)) > .9999 * M(Q) * t || (P(this._up, Q, this.center), P(this._up, this._up, Q), F(this._up, this._up), this._markViewDirty());\n  }\n\n  computeUpLocal() {\n    V(Q, this.eye, this.center), Math.abs(Q[2]) <= .9999 && (j(Q, Q, Q[2]), R(this._up, -Q[0], -Q[1], 1 - Q[2]), F(this._up, this._up), this._markViewDirty());\n  }\n\n  _compareAndSetView(t, i) {\n    \"number\" == typeof t[0] && isFinite(t[0]) && \"number\" == typeof t[1] && isFinite(t[1]) && \"number\" == typeof t[2] && isFinite(t[2]) ? y(t, i) || (d(i, t), this._markViewDirty()) : B.warn(\"Camera vector contains invalid number, ignoring value\");\n  }\n\n  _markViewDirty() {\n    this._viewDirty = !0, this._frustumDirty = !0, this._viewProjectionDirty = !0;\n  }\n\n  _recomputeFrustum() {\n    this._frustumDirty && (W(this.viewMatrix, this.projectionMatrix, this._frustum), this._frustumDirty = !1);\n  }\n\n  _ensureViewClean() {\n    this._viewDirty && (p(this._viewMatrix, this.eye, this._center, this._up), R(this._viewForward, -this._viewMatrix[2], -this._viewMatrix[6], -this._viewMatrix[10]), R(this._viewUp, this._viewMatrix[1], this._viewMatrix[5], this._viewMatrix[9]), R(this._viewRight, this._viewMatrix[0], this._viewMatrix[4], this._viewMatrix[8]), this._viewDirty = !1, this._viewInverseTransposeMatrixDirty = !0);\n  }\n\n}\n\nconst K = E(),\n      O = u(),\n      Q = S(),\n      Z = S(),\n      $ = s();\nexport default J;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/webgl-engine/lib/Camera.js"],"names":["t","lerp","i","isSome","e","createScreenPointArray","r","createRenderScreenPointArray3","s","d","h","m","n","k","o","a","_","l","p","c","u","v","f","w","g","y","x","D","j","M","R","P","F","V","S","T","I","b","U","A","C","E","create","z","copy","H","fromMatrix","W","L","projectPointSignedLength","G","fovd2fovx","X","fovx2fovd","Y","fovd2fovy","q","fovy2fovd","N","B","getLogger","J","constructor","_viewUp","_viewForward","_viewRight","_ray","_viewport","_padding","_fov","Math","PI","_nearFar","_viewDirty","_viewMatrix","_projectionDirty","_projectionMatrix","_viewProjectionDirty","_viewProjectionMatrix","_viewInverseTransposeMatrixDirty","_viewInverseTransposeMatrix","_frustumDirty","_frustum","_fullViewport","pixelRatio","relativeElevation","origin","_center","_up","eye","_compareAndSetView","center","ray","direction","up","viewMatrix","_ensureViewClean","viewForward","viewUp","viewRight","nearFar","near","far","viewport","width","height","fullWidth","fullHeight","fullViewport","aspect","padding","viewProjectionMatrix","projectionMatrix","tan","fovY","fov","fovX","distance","frustum","_recomputeFrustum","viewInverseTransposeMatrix","depthNDCToWorld","perRenderPixelRatio","perScreenPixelRatio","aboveGround","copyFrom","copyViewFrom","clone","equals","almostEquals","abs","Q","Z","max","computeRenderPixelSizeAt","computeRenderPixelSizeAtDist","viewDirectionDistance","computeScreenPixelSizeAt","computeScreenPixelSizeAtDist","computeDistanceFromRadius","min","getScreenCenter","getRenderCenter","length","setGLViewport","setViewport","applyProjection","K","projectToScreen","projectToRenderScreen","$","renderToScreen","unprojectFromScreen","unprojectFromRenderScreen","screenToRender","O","constrainWindowSize","computeUp","computeUpGlobal","computeUpLocal","_markViewDirty","isFinite","warn"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/Logger.js\";import{lerp as i}from\"../../../../core/mathUtils.js\";import{isSome as e}from\"../../../../core/maybe.js\";import{createScreenPointArray as r,createRenderScreenPointArray3 as s}from\"../../../../core/screenUtils.js\";import{d as h,m as n,k as o,a,e as _,l as p}from\"../../../../chunks/mat4.js\";import{c as u}from\"../../../../chunks/mat4f64.js\";import{c as v,k as c}from\"../../../../chunks/vec2.js\";import{f as w}from\"../../../../chunks/vec2f64.js\";import{g as d,f as l,i as g,k as y,w as m,d as f,x,y as D,a as j,l as M,s as R,c as P,n as F,r as V}from\"../../../../chunks/vec3.js\";import{c as S,a as T,f as I}from\"../../../../chunks/vec3f64.js\";import{c as b,g as k,i as U,t as A}from\"../../../../chunks/vec4.js\";import{f as C,c as E}from\"../../../../chunks/vec4f64.js\";import{create as z,copy as H,fromMatrix as W}from\"../../../../geometry/support/frustum.js\";import{create as L}from\"../../../../geometry/support/ray.js\";import{projectPointSignedLength as G}from\"../../../../geometry/support/vector.js\";import{fovd2fovx as X,fovx2fovd as Y,fovd2fovy as q,fovy2fovd as N}from\"./Util.js\";const B=t.getLogger(\"esri.views.3d.webgl-engine.lib.Camera\");class J{constructor(t=null,i=null,r=null){this._viewUp=S(),this._viewForward=S(),this._viewRight=S(),this._ray=L(),this._viewport=C(0,0,1,1),this._padding=C(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=w(1,1e3),this._viewDirty=!0,this._viewMatrix=u(),this._projectionDirty=!0,this._projectionMatrix=u(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=u(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=u(),this._frustumDirty=!0,this._frustum=z(),this._fullViewport=E(),this.pixelRatio=1,this.relativeElevation=0,e(t)&&d(this._ray.origin,t),this._center=e(i)?T(i):S(),this._up=e(r)?T(r):I(0,0,1)}get eye(){return this._ray.origin}set eye(t){this._compareAndSetView(t,this._ray.origin)}get center(){return this._center}set center(t){this._compareAndSetView(t,this._center)}get ray(){return l(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(t){this._compareAndSetView(t,this._up)}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(t){h(this._viewMatrix,t),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),this._viewForward}get viewUp(){return this._ensureViewClean(),this._viewUp}get viewRight(){return this._ensureViewClean(),this._viewRight}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(t){this._nearFar[0]!==t&&(this._nearFar[0]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get far(){return this._nearFar[1]}set far(t){this._nearFar[1]!==t&&(this._nearFar[1]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewport(){return this._viewport}set viewport(t){this.x=t[0],this.y=t[1],this.width=t[2],this.height=t[3]}get x(){return this._viewport[0]}set x(t){t+=this._padding[3],this._viewport[0]!==t&&(this._viewport[0]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get y(){return this._viewport[1]}set y(t){t+=this._padding[2],this._viewport[1]!==t&&(this._viewport[1]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get width(){return this._viewport[2]}set width(t){this._viewport[2]!==t&&(this._viewport[2]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get height(){return this._viewport[3]}set height(t){this._viewport[3]!==t&&(this._viewport[3]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get fullWidth(){return this._viewport[2]+this._padding[1]+this._padding[3]}set fullWidth(t){this.width=t-(this._padding[1]+this._padding[3])}get fullHeight(){return this._viewport[3]+this._padding[0]+this._padding[2]}set fullHeight(t){this.height=t-(this._padding[0]+this._padding[2])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[3],this._fullViewport[1]=this._viewport[1]-this._padding[2],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get aspect(){return this.width/this.height}get padding(){return this._padding}set padding(t){this._padding[0]===t[0]&&this._padding[1]===t[1]&&this._padding[2]===t[2]&&this._padding[3]===t[3]||(this._viewport[0]+=t[3]-this._padding[3],this._viewport[1]+=t[2]-this._padding[2],this._viewport[2]-=t[1]+t[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=t[0]+t[2]-(this._padding[0]+this._padding[2]),b(this._padding,t),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewProjectionMatrix(){return this._viewProjectionDirty&&(n(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){if(this._projectionDirty){const t=this.width,i=this.height,e=this.near*Math.tan(this.fovY/2),r=e*this.aspect;o(this._projectionMatrix,-r*(1+2*this._padding[3]/t),r*(1+2*this._padding[1]/t),-e*(1+2*this._padding[2]/i),e*(1+2*this._padding[0]/i),this.near,this.far),this._projectionDirty=!1}return this._projectionMatrix}set projectionMatrix(t){h(this._projectionMatrix,t),this._projectionDirty=!1,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fov(){return this._fov}set fov(t){this._fov=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return X(this._fov,this.width,this.height)}set fovX(t){this._fov=Y(t,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return q(this._fov,this.width,this.height)}set fovY(t){this._fov=N(t,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return g(this._center,this.eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(a(this._viewInverseTransposeMatrix,this.viewMatrix),_(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(t){const i=2*t-1;return 2*this.near*this.far/(this.far+this.near-i*(this.far-this.near))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this.pixelRatio}get aboveGround(){return this.relativeElevation&&this.relativeElevation>=0}copyFrom(t){d(this._ray.origin,t.eye),d(this._center,t.center),d(this._up,t.up),b(this._viewport,t.viewport),b(this._padding,t.padding),v(this._nearFar,t.nearFar),this._fov=t.fov,this.relativeElevation=t.relativeElevation;const i=t;return this._viewDirty=i._viewDirty,this._viewDirty||(h(this._viewMatrix,t.viewMatrix),d(this._viewRight,t.viewRight),d(this._viewUp,t.viewUp),d(this._viewForward,t.viewForward)),i._projectionDirty?this._projectionDirty=!0:(h(this._projectionMatrix,t.projectionMatrix),this._projectionDirty=!1),this._viewProjectionDirty=!0,this._frustumDirty=i._frustumDirty,this._frustumDirty||(H(t.frustum,this._frustum),this._frustumDirty=!1),i._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(h(this._viewInverseTransposeMatrix,t.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),b(this._fullViewport,t.fullViewport),this.pixelRatio=t.pixelRatio,this}copyViewFrom(t){this.eye=t.eye,this.center=t.center,this.up=t.up}clone(){return(new J).copyFrom(this)}equals(t){return y(this.eye,t.eye)&&y(this._center,t.center)&&y(this._up,t.up)&&k(this._viewport,t.viewport)&&k(this._padding,t.padding)&&c(this._nearFar,t.nearFar)&&this._fov===t.fov&&this.pixelRatio===t.pixelRatio&&this.relativeElevation===t.relativeElevation}almostEquals(t){if(this.pixelRatio!==t.pixelRatio||Math.abs(t.fov-this._fov)>=.001)return!1;const i=5e-4,e=1-1e-10;m(Q,t.eye,t.center),m(Z,this.eye,this._center);const r=f(Q,Z),s=x(Q),h=x(Z);return r*r>=e*s*h&&D(t.eye,this.eye)<Math.max(s,h)*i*i&&U(t.padding,this._padding)<.5&&U(t.viewport,this._viewport)<.5}computeRenderPixelSizeAt(t){return this.computeRenderPixelSizeAtDist(this.viewDirectionDistance(t))}computeRenderPixelSizeAtDist(t){return t*this.perRenderPixelRatio}computeScreenPixelSizeAt(t){return this.computeScreenPixelSizeAtDist(this.viewDirectionDistance(t))}viewDirectionDistance(t){return Math.abs(G(this.viewForward,l(Q,t,this.eye)))}computeScreenPixelSizeAtDist(t){return t*this.perScreenPixelRatio}computeDistanceFromRadius(t,i){return t/Math.tan(Math.min(this.fovX,this.fovY)/(2*(i||1)))}getScreenCenter(t=r()){return t[0]=(this.padding[3]+this.width/2)/this.pixelRatio,t[1]=(this.padding[0]+this.height/2)/this.pixelRatio,t}getRenderCenter(t,i=.5,e=.5){return t||(t=s()),t[0]=this.padding[3]+this.width*i,t[1]=this.padding[2]+this.height*e,t.length>2&&(t[2]=.5),t}setGLViewport(t){const i=this.viewport,e=this.padding;t.setViewport(i[0]-e[3],i[1]-e[2],i[2]+e[1]+e[3],i[3]+e[0]+e[2])}applyProjection(t,e,r=!1){t!==K&&d(K,t),K[3]=1,r&&(e[2]=-K[2]),A(K,K,this.projectionMatrix),j(K,K,1/Math.abs(K[3]));const s=this.fullViewport;return e[0]=i(0,s[0]+s[2],.5+.5*K[0]),e[1]=i(0,s[1]+s[3],.5+.5*K[1]),r||(e[2]=.5*(K[2]+1)),e}projectToScreen(t,i){this.projectToRenderScreen(t,$),this.renderToScreen($,i)}projectToRenderScreen(t,e){if(K[0]=t[0],K[1]=t[1],K[2]=t[2],K[3]=1,A(K,K,this.viewProjectionMatrix),0===K[3])return null;j(K,K,1/Math.abs(K[3]));const r=this.fullViewport;return\"x\"in e?(e.x=i(0,r[0]+r[2],.5+.5*K[0]),e.y=i(0,r[1]+r[3],.5+.5*K[1])):(e[0]=i(0,r[0]+r[2],.5+.5*K[0]),e[1]=i(0,r[1]+r[3],.5+.5*K[1]),e.length>2&&(e[2]=.5*(K[2]+1))),e}unprojectFromScreen(t,i){return this.unprojectFromRenderScreen(this.screenToRender(t,$),i)}unprojectFromRenderScreen(t,i){if(n(O,this.projectionMatrix,this.viewMatrix),!a(O,O))return null;const e=this.fullViewport;return K[0]=2*(t[0]-e[0])/e[2]-1,K[1]=2*(t[1]-e[1])/e[3]-1,K[2]=2*t[2]-1,K[3]=1,A(K,K,O),0===K[3]?null:(i[0]=K[0]/K[3],i[1]=K[1]/K[3],i[2]=K[2]/K[3],i)}constrainWindowSize(t,i,e,r=e){const s=t*this.pixelRatio,h=i*this.pixelRatio,n=Math.max(s-e/2,0),o=Math.max(this.fullHeight-h-r/2,0),a=-Math.min(s-e/2,0),_=-Math.min(this.fullHeight-h-r/2,0);return[n,o,e-a- -Math.min(this.fullWidth-s-e/2,0),r-_- -Math.min(h-r/2,0)]}computeUp(t){1===t?this.computeUpGlobal():this.computeUpLocal()}screenToRender(t,i){const e=t[0]*this.pixelRatio,r=this.fullHeight-t[1]*this.pixelRatio;return i[0]=e,i[1]=r,i}renderToScreen(t,i){const e=t[0]/this.pixelRatio,r=(this.fullHeight-t[1])/this.pixelRatio;i[0]=e,i[1]=r}computeUpGlobal(){l(Q,this.center,this.eye);const t=M(this.center);t<1?(R(this._up,0,0,1),this._markViewDirty()):Math.abs(f(Q,this.center))>.9999*M(Q)*t||(P(this._up,Q,this.center),P(this._up,this._up,Q),F(this._up,this._up),this._markViewDirty())}computeUpLocal(){V(Q,this.eye,this.center),Math.abs(Q[2])<=.9999&&(j(Q,Q,Q[2]),R(this._up,-Q[0],-Q[1],1-Q[2]),F(this._up,this._up),this._markViewDirty())}_compareAndSetView(t,i){\"number\"==typeof t[0]&&isFinite(t[0])&&\"number\"==typeof t[1]&&isFinite(t[1])&&\"number\"==typeof t[2]&&isFinite(t[2])?y(t,i)||(d(i,t),this._markViewDirty()):B.warn(\"Camera vector contains invalid number, ignoring value\")}_markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}_recomputeFrustum(){this._frustumDirty&&(W(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&(p(this._viewMatrix,this.eye,this._center,this._up),R(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),R(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),R(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}}const K=E(),O=u(),Q=S(),Z=S(),$=s();export default J;\n"]},"metadata":{},"sourceType":"module"}