{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { f as t } from \"../../../../chunks/vec3f64.js\";\nimport { bindSliceUniforms as i } from \"../core/shaderLibrary/Slice.glsl.js\";\nimport { InstancedDoublePrecision as r } from \"../core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js\";\nimport { bindVerticalOffsetUniforms as o } from \"../core/shaderLibrary/attributes/VerticalOffset.glsl.js\";\nimport { bindOutputHighlight as s } from \"../core/shaderLibrary/output/OutputHighlight.glsl.js\";\nimport { bindMultipassTerrainTexture as a } from \"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";\nimport { bindPBRUniforms as n } from \"../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";\nimport { bindReadShadowMapViewCustomOrigin as l } from \"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";\nimport { bindVisualVariablesUniformsForSymbols as p } from \"../core/shaderLibrary/shading/VisualVariables.glsl.js\";\nimport { doublePrecisionRequiresObfuscation as c } from \"../core/shaderLibrary/util/DoublePrecision.glsl.js\";\nimport { bindProjectionMatrix as u, bindViewCustomOrigin as h, bindCameraPosition as d } from \"../core/shaderLibrary/util/View.glsl.js\";\nimport { ReloadableShaderModule as m } from \"../core/shaderTechnique/ReloadableShaderModule.js\";\nimport { ShaderTechnique as f } from \"../core/shaderTechnique/ShaderTechnique.js\";\nimport { ShaderTechniqueConfiguration as v, parameter as g } from \"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";\nimport { Default3D as b } from \"../lib/DefaultVertexAttributeLocations.js\";\nimport { blendingDefault as y, OITBlending as x, OITDepthTest as T, getOITPolygonOffset as P } from \"../lib/OrderIndependentTransparency.js\";\nimport { Program as M } from \"../lib/Program.js\";\nimport { stencilWriteMaskOn as S, stencilToolMaskBaseParams as C, stencilBaseAllZerosParams as O } from \"../lib/StencilUtils.js\";\nimport { colorMixModes as D, bindScreenSizePerspective as w } from \"../materials/internal/MaterialUtil.js\";\nimport { D as j } from \"../../../../chunks/DefaultMaterial.glsl.js\";\nimport { makePipelineState as A, cullingParams as E, defaultDepthWriteParams as U, defaultColorWriteParams as z } from \"../../../webgl/renderState.js\";\n\nclass R extends f {\n  initializeProgram(e) {\n    const t = R.shader.get(),\n          i = this.configuration,\n          r = t.build({\n      OITEnabled: 0 === i.transparencyPassType,\n      output: i.output,\n      viewingMode: e.viewingMode,\n      receiveShadows: i.receiveShadows,\n      slicePlaneEnabled: i.slicePlaneEnabled,\n      sliceHighlightDisabled: i.sliceHighlightDisabled,\n      sliceEnabledForVertexPrograms: !1,\n      symbolColor: i.symbolColors,\n      vvSize: i.vvSize,\n      vvColor: i.vvColor,\n      vvInstancingEnabled: !0,\n      instanced: i.instanced,\n      instancedColor: i.instancedColor,\n      instancedDoublePrecision: i.instancedDoublePrecision,\n      pbrMode: i.usePBR ? i.isSchematic ? 2 : 1 : 0,\n      hasMetalnessAndRoughnessTexture: i.hasMetalnessAndRoughnessTexture,\n      hasEmissionTexture: i.hasEmissionTexture,\n      hasOcclusionTexture: i.hasOcclusionTexture,\n      hasNormalTexture: i.hasNormalTexture,\n      hasColorTexture: i.hasColorTexture,\n      receiveAmbientOcclusion: i.receiveAmbientOcclusion,\n      useCustomDTRExponentForWater: !1,\n      normalType: i.normalsTypeDerivate ? 3 : 0,\n      doubleSidedMode: i.doubleSidedMode,\n      vertexTangents: i.vertexTangents,\n      attributeTextureCoordinates: i.hasMetalnessAndRoughnessTexture || i.hasEmissionTexture || i.hasOcclusionTexture || i.hasNormalTexture || i.hasColorTexture ? 1 : 0,\n      textureAlphaPremultiplied: i.textureAlphaPremultiplied,\n      attributeColor: i.vertexColors,\n      screenSizePerspectiveEnabled: i.screenSizePerspective,\n      verticalOffsetEnabled: i.verticalOffset,\n      offsetBackfaces: i.offsetBackfaces,\n      doublePrecisionRequiresObfuscation: c(e.rctx),\n      alphaDiscardMode: i.alphaDiscardMode,\n      supportsTextureAtlas: !1,\n      multipassTerrainEnabled: i.multipassTerrainEnabled,\n      cullAboveGround: i.cullAboveGround\n    });\n    return new M(e.rctx, r, b);\n  }\n\n  bindPass(e, t) {\n    var i, r;\n    u(this.program, t.camera.projectionMatrix);\n    const l = this.configuration.output;\n    (1 === this.configuration.output || t.multipassTerrainEnabled || 3 === l) && this.program.setUniform2fv(\"cameraNearFar\", t.camera.nearFar), t.multipassTerrainEnabled && (this.program.setUniform2fv(\"inverseViewport\", t.inverseViewport), a(this.program, t)), 7 === l && (this.program.setUniform1f(\"opacity\", e.opacity), this.program.setUniform1f(\"layerOpacity\", e.layerOpacity), this.program.setUniform4fv(\"externalColor\", e.externalColor), this.program.setUniform1i(\"colorMixMode\", D[e.colorMixMode])), 0 === l ? (t.lighting.setUniforms(this.program, !1), this.program.setUniform3fv(\"ambient\", e.ambient), this.program.setUniform3fv(\"diffuse\", e.diffuse), this.program.setUniform4fv(\"externalColor\", e.externalColor), this.program.setUniform1i(\"colorMixMode\", D[e.colorMixMode]), this.program.setUniform1f(\"opacity\", e.opacity), this.program.setUniform1f(\"layerOpacity\", e.layerOpacity), this.configuration.usePBR && n(this.program, e, this.configuration.isSchematic)) : 4 === l && s(this.program, t), p(this.program, e), o(this.program, e, t), w(e.screenSizePerspective, this.program, \"screenSizePerspectiveAlignment\"), 2 !== e.textureAlphaMode && 3 !== e.textureAlphaMode || this.program.setUniform1f(\"textureAlphaCutoff\", e.textureAlphaCutoff), null == (i = t.shadowMap) || i.bind(this.program), null == (r = t.ssaoHelper) || r.bind(this.program);\n  }\n\n  bindDraw(e) {\n    const o = this.configuration.instancedDoublePrecision ? t(e.camera.viewInverseTransposeMatrix[3], e.camera.viewInverseTransposeMatrix[7], e.camera.viewInverseTransposeMatrix[11]) : e.origin;\n    h(this.program, o, e.camera.viewMatrix), this.program.rebindTextures(), (0 === this.configuration.output || 7 === this.configuration.output || 1 === this.configuration.output && this.configuration.screenSizePerspective || 2 === this.configuration.output && this.configuration.screenSizePerspective || 4 === this.configuration.output && this.configuration.screenSizePerspective) && d(this.program, o, e.camera.viewInverseTransposeMatrix), 2 === this.configuration.output && this.program.setUniformMatrix4fv(\"viewNormal\", e.camera.viewInverseTransposeMatrix), this.configuration.instancedDoublePrecision && r.bindCustomOrigin(this.program, o), i(this.program, this.configuration, e.slicePlane, o), 0 === this.configuration.output && l(this.program, e, o);\n  }\n\n  setPipeline(e, t) {\n    const i = this.configuration,\n          r = 3 === e,\n          o = 2 === e;\n    return A({\n      blending: 0 !== i.output && 7 !== i.output || !i.transparent ? null : r ? y : x(e),\n      culling: L(i) && E(i.cullFace),\n      depthTest: {\n        func: T(e)\n      },\n      depthWrite: r || o ? i.writeDepth && U : null,\n      colorWrite: z,\n      stencilWrite: i.sceneHasOcludees ? S : null,\n      stencilTest: i.sceneHasOcludees ? t ? C : O : null,\n      polygonOffset: r || o ? null : P(i.enableOffset)\n    });\n  }\n\n  initializePipeline() {\n    return this._occludeePipelineState = this.setPipeline(this.configuration.transparencyPassType, !0), this.setPipeline(this.configuration.transparencyPassType, !1);\n  }\n\n  getPipelineState(e) {\n    return e ? this._occludeePipelineState : this.pipeline;\n  }\n\n}\n\nfunction L(e) {\n  return e.cullFace ? 0 !== e.cullFace : !e.slicePlaneEnabled && !e.transparent && !e.doubleSidedMode;\n}\n\nR.shader = new m(j, () => import(\"./DefaultMaterial.glsl.js\"));\n\nclass H extends v {\n  constructor() {\n    super(...arguments), this.output = 0, this.alphaDiscardMode = 1, this.doubleSidedMode = 0, this.isSchematic = !1, this.vertexColors = !1, this.offsetBackfaces = !1, this.symbolColors = !1, this.vvSize = !1, this.vvColor = !1, this.verticalOffset = !1, this.receiveShadows = !1, this.slicePlaneEnabled = !1, this.sliceHighlightDisabled = !1, this.receiveAmbientOcclusion = !1, this.screenSizePerspective = !1, this.textureAlphaPremultiplied = !1, this.hasColorTexture = !1, this.usePBR = !1, this.hasMetalnessAndRoughnessTexture = !1, this.hasEmissionTexture = !1, this.hasOcclusionTexture = !1, this.hasNormalTexture = !1, this.instanced = !1, this.instancedColor = !1, this.instancedDoublePrecision = !1, this.vertexTangents = !1, this.normalsTypeDerivate = !1, this.writeDepth = !0, this.sceneHasOcludees = !1, this.transparent = !1, this.enableOffset = !0, this.cullFace = 0, this.transparencyPassType = 3, this.multipassTerrainEnabled = !1, this.cullAboveGround = !1;\n  }\n\n}\n\ne([g({\n  count: 8\n})], H.prototype, \"output\", void 0), e([g({\n  count: 4\n})], H.prototype, \"alphaDiscardMode\", void 0), e([g({\n  count: 3\n})], H.prototype, \"doubleSidedMode\", void 0), e([g()], H.prototype, \"isSchematic\", void 0), e([g()], H.prototype, \"vertexColors\", void 0), e([g()], H.prototype, \"offsetBackfaces\", void 0), e([g()], H.prototype, \"symbolColors\", void 0), e([g()], H.prototype, \"vvSize\", void 0), e([g()], H.prototype, \"vvColor\", void 0), e([g()], H.prototype, \"verticalOffset\", void 0), e([g()], H.prototype, \"receiveShadows\", void 0), e([g()], H.prototype, \"slicePlaneEnabled\", void 0), e([g()], H.prototype, \"sliceHighlightDisabled\", void 0), e([g()], H.prototype, \"receiveAmbientOcclusion\", void 0), e([g()], H.prototype, \"screenSizePerspective\", void 0), e([g()], H.prototype, \"textureAlphaPremultiplied\", void 0), e([g()], H.prototype, \"hasColorTexture\", void 0), e([g()], H.prototype, \"usePBR\", void 0), e([g()], H.prototype, \"hasMetalnessAndRoughnessTexture\", void 0), e([g()], H.prototype, \"hasEmissionTexture\", void 0), e([g()], H.prototype, \"hasOcclusionTexture\", void 0), e([g()], H.prototype, \"hasNormalTexture\", void 0), e([g()], H.prototype, \"instanced\", void 0), e([g()], H.prototype, \"instancedColor\", void 0), e([g()], H.prototype, \"instancedDoublePrecision\", void 0), e([g()], H.prototype, \"vertexTangents\", void 0), e([g()], H.prototype, \"normalsTypeDerivate\", void 0), e([g()], H.prototype, \"writeDepth\", void 0), e([g()], H.prototype, \"sceneHasOcludees\", void 0), e([g()], H.prototype, \"transparent\", void 0), e([g()], H.prototype, \"enableOffset\", void 0), e([g({\n  count: 3\n})], H.prototype, \"cullFace\", void 0), e([g({\n  count: 4\n})], H.prototype, \"transparencyPassType\", void 0), e([g()], H.prototype, \"multipassTerrainEnabled\", void 0), e([g()], H.prototype, \"cullAboveGround\", void 0);\nexport { R as DefaultMaterialTechnique, H as DefaultMaterialTechniqueConfiguration };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/webgl-engine/shaders/DefaultMaterialTechnique.js"],"names":["_","e","f","t","bindSliceUniforms","i","InstancedDoublePrecision","r","bindVerticalOffsetUniforms","o","bindOutputHighlight","s","bindMultipassTerrainTexture","a","bindPBRUniforms","n","bindReadShadowMapViewCustomOrigin","l","bindVisualVariablesUniformsForSymbols","p","doublePrecisionRequiresObfuscation","c","bindProjectionMatrix","u","bindViewCustomOrigin","h","bindCameraPosition","d","ReloadableShaderModule","m","ShaderTechnique","ShaderTechniqueConfiguration","v","parameter","g","Default3D","b","blendingDefault","y","OITBlending","x","OITDepthTest","T","getOITPolygonOffset","P","Program","M","stencilWriteMaskOn","S","stencilToolMaskBaseParams","C","stencilBaseAllZerosParams","O","colorMixModes","D","bindScreenSizePerspective","w","j","makePipelineState","A","cullingParams","E","defaultDepthWriteParams","U","defaultColorWriteParams","z","R","initializeProgram","shader","get","configuration","build","OITEnabled","transparencyPassType","output","viewingMode","receiveShadows","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","symbolColor","symbolColors","vvSize","vvColor","vvInstancingEnabled","instanced","instancedColor","instancedDoublePrecision","pbrMode","usePBR","isSchematic","hasMetalnessAndRoughnessTexture","hasEmissionTexture","hasOcclusionTexture","hasNormalTexture","hasColorTexture","receiveAmbientOcclusion","useCustomDTRExponentForWater","normalType","normalsTypeDerivate","doubleSidedMode","vertexTangents","attributeTextureCoordinates","textureAlphaPremultiplied","attributeColor","vertexColors","screenSizePerspectiveEnabled","screenSizePerspective","verticalOffsetEnabled","verticalOffset","offsetBackfaces","rctx","alphaDiscardMode","supportsTextureAtlas","multipassTerrainEnabled","cullAboveGround","bindPass","program","camera","projectionMatrix","setUniform2fv","nearFar","inverseViewport","setUniform1f","opacity","layerOpacity","setUniform4fv","externalColor","setUniform1i","colorMixMode","lighting","setUniforms","setUniform3fv","ambient","diffuse","textureAlphaMode","textureAlphaCutoff","shadowMap","bind","ssaoHelper","bindDraw","viewInverseTransposeMatrix","origin","viewMatrix","rebindTextures","setUniformMatrix4fv","bindCustomOrigin","slicePlane","setPipeline","blending","transparent","culling","L","cullFace","depthTest","func","depthWrite","writeDepth","colorWrite","stencilWrite","sceneHasOcludees","stencilTest","polygonOffset","enableOffset","initializePipeline","_occludeePipelineState","getPipelineState","pipeline","H","constructor","arguments","count","prototype","DefaultMaterialTechnique","DefaultMaterialTechniqueConfiguration"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,iCAAlB;AAAoD,SAAOC,CAAC,IAAIC,CAAZ,QAAkB,+BAAlB;AAAkD,SAAOC,iBAAiB,IAAIC,CAA5B,QAAkC,qCAAlC;AAAwE,SAAOC,wBAAwB,IAAIC,CAAnC,QAAyC,mEAAzC;AAA6G,SAAOC,0BAA0B,IAAIC,CAArC,QAA2C,yDAA3C;AAAqG,SAAOC,mBAAmB,IAAIC,CAA9B,QAAoC,sDAApC;AAA2F,SAAOC,2BAA2B,IAAIC,CAAtC,QAA4C,4DAA5C;AAAyG,SAAOC,eAAe,IAAIC,CAA1B,QAAgC,0EAAhC;AAA2G,SAAOC,iCAAiC,IAAIC,CAA5C,QAAkD,qDAAlD;AAAwG,SAAOC,qCAAqC,IAAIC,CAAhD,QAAsD,uDAAtD;AAA8G,SAAOC,kCAAkC,IAAIC,CAA7C,QAAmD,oDAAnD;AAAwG,SAAOC,oBAAoB,IAAIC,CAA/B,EAAiCC,oBAAoB,IAAIC,CAAzD,EAA2DC,kBAAkB,IAAIC,CAAjF,QAAuF,yCAAvF;AAAiI,SAAOC,sBAAsB,IAAIC,CAAjC,QAAuC,mDAAvC;AAA2F,SAAOC,eAAe,IAAI5B,CAA1B,QAAgC,4CAAhC;AAA6E,SAAO6B,4BAA4B,IAAIC,CAAvC,EAAyCC,SAAS,IAAIC,CAAtD,QAA4D,yDAA5D;AAAsH,SAAOC,SAAS,IAAIC,CAApB,QAA0B,2CAA1B;AAAsE,SAAOC,eAAe,IAAIC,CAA1B,EAA4BC,WAAW,IAAIC,CAA3C,EAA6CC,YAAY,IAAIC,CAA7D,EAA+DC,mBAAmB,IAAIC,CAAtF,QAA4F,wCAA5F;AAAqI,SAAOC,OAAO,IAAIC,CAAlB,QAAwB,mBAAxB;AAA4C,SAAOC,kBAAkB,IAAIC,CAA7B,EAA+BC,yBAAyB,IAAIC,CAA5D,EAA8DC,yBAAyB,IAAIC,CAA3F,QAAiG,wBAAjG;AAA0H,SAAOC,aAAa,IAAIC,CAAxB,EAA0BC,yBAAyB,IAAIC,CAAvD,QAA6D,uCAA7D;AAAqG,SAAOF,CAAC,IAAIG,CAAZ,QAAkB,4CAAlB;AAA+D,SAAOC,iBAAiB,IAAIC,CAA5B,EAA8BC,aAAa,IAAIC,CAA/C,EAAiDC,uBAAuB,IAAIC,CAA5E,EAA8EC,uBAAuB,IAAIC,CAAzG,QAA+G,+BAA/G;;AAA+I,MAAMC,CAAN,SAAgBhE,CAAhB,CAAiB;AAACiE,EAAAA,iBAAiB,CAAClE,CAAD,EAAG;AAAC,UAAME,CAAC,GAAC+D,CAAC,CAACE,MAAF,CAASC,GAAT,EAAR;AAAA,UAAuBhE,CAAC,GAAC,KAAKiE,aAA9B;AAAA,UAA4C/D,CAAC,GAACJ,CAAC,CAACoE,KAAF,CAAQ;AAACC,MAAAA,UAAU,EAAC,MAAInE,CAAC,CAACoE,oBAAlB;AAAuCC,MAAAA,MAAM,EAACrE,CAAC,CAACqE,MAAhD;AAAuDC,MAAAA,WAAW,EAAC1E,CAAC,CAAC0E,WAArE;AAAiFC,MAAAA,cAAc,EAACvE,CAAC,CAACuE,cAAlG;AAAiHC,MAAAA,iBAAiB,EAACxE,CAAC,CAACwE,iBAArI;AAAuJC,MAAAA,sBAAsB,EAACzE,CAAC,CAACyE,sBAAhL;AAAuMC,MAAAA,6BAA6B,EAAC,CAAC,CAAtO;AAAwOC,MAAAA,WAAW,EAAC3E,CAAC,CAAC4E,YAAtP;AAAmQC,MAAAA,MAAM,EAAC7E,CAAC,CAAC6E,MAA5Q;AAAmRC,MAAAA,OAAO,EAAC9E,CAAC,CAAC8E,OAA7R;AAAqSC,MAAAA,mBAAmB,EAAC,CAAC,CAA1T;AAA4TC,MAAAA,SAAS,EAAChF,CAAC,CAACgF,SAAxU;AAAkVC,MAAAA,cAAc,EAACjF,CAAC,CAACiF,cAAnW;AAAkXC,MAAAA,wBAAwB,EAAClF,CAAC,CAACkF,wBAA7Y;AAAsaC,MAAAA,OAAO,EAACnF,CAAC,CAACoF,MAAF,GAASpF,CAAC,CAACqF,WAAF,GAAc,CAAd,GAAgB,CAAzB,GAA2B,CAAzc;AAA2cC,MAAAA,+BAA+B,EAACtF,CAAC,CAACsF,+BAA7e;AAA6gBC,MAAAA,kBAAkB,EAACvF,CAAC,CAACuF,kBAAliB;AAAqjBC,MAAAA,mBAAmB,EAACxF,CAAC,CAACwF,mBAA3kB;AAA+lBC,MAAAA,gBAAgB,EAACzF,CAAC,CAACyF,gBAAlnB;AAAmoBC,MAAAA,eAAe,EAAC1F,CAAC,CAAC0F,eAArpB;AAAqqBC,MAAAA,uBAAuB,EAAC3F,CAAC,CAAC2F,uBAA/rB;AAAutBC,MAAAA,4BAA4B,EAAC,CAAC,CAArvB;AAAuvBC,MAAAA,UAAU,EAAC7F,CAAC,CAAC8F,mBAAF,GAAsB,CAAtB,GAAwB,CAA1xB;AAA4xBC,MAAAA,eAAe,EAAC/F,CAAC,CAAC+F,eAA9yB;AAA8zBC,MAAAA,cAAc,EAAChG,CAAC,CAACgG,cAA/0B;AAA81BC,MAAAA,2BAA2B,EAACjG,CAAC,CAACsF,+BAAF,IAAmCtF,CAAC,CAACuF,kBAArC,IAAyDvF,CAAC,CAACwF,mBAA3D,IAAgFxF,CAAC,CAACyF,gBAAlF,IAAoGzF,CAAC,CAAC0F,eAAtG,GAAsH,CAAtH,GAAwH,CAAl/B;AAAo/BQ,MAAAA,yBAAyB,EAAClG,CAAC,CAACkG,yBAAhhC;AAA0iCC,MAAAA,cAAc,EAACnG,CAAC,CAACoG,YAA3jC;AAAwkCC,MAAAA,4BAA4B,EAACrG,CAAC,CAACsG,qBAAvmC;AAA6nCC,MAAAA,qBAAqB,EAACvG,CAAC,CAACwG,cAArpC;AAAoqCC,MAAAA,eAAe,EAACzG,CAAC,CAACyG,eAAtrC;AAAssC1F,MAAAA,kCAAkC,EAACC,CAAC,CAACpB,CAAC,CAAC8G,IAAH,CAA1uC;AAAmvCC,MAAAA,gBAAgB,EAAC3G,CAAC,CAAC2G,gBAAtwC;AAAuxCC,MAAAA,oBAAoB,EAAC,CAAC,CAA7yC;AAA+yCC,MAAAA,uBAAuB,EAAC7G,CAAC,CAAC6G,uBAAz0C;AAAi2CC,MAAAA,eAAe,EAAC9G,CAAC,CAAC8G;AAAn3C,KAAR,CAA9C;AAA27C,WAAO,IAAIrE,CAAJ,CAAM7C,CAAC,CAAC8G,IAAR,EAAaxG,CAAb,EAAe6B,CAAf,CAAP;AAAyB;;AAAAgF,EAAAA,QAAQ,CAACnH,CAAD,EAAGE,CAAH,EAAK;AAAC,QAAIE,CAAJ,EAAME,CAAN;AAAQgB,IAAAA,CAAC,CAAC,KAAK8F,OAAN,EAAclH,CAAC,CAACmH,MAAF,CAASC,gBAAvB,CAAD;AAA0C,UAAMtG,CAAC,GAAC,KAAKqD,aAAL,CAAmBI,MAA3B;AAAkC,KAAC,MAAI,KAAKJ,aAAL,CAAmBI,MAAvB,IAA+BvE,CAAC,CAAC+G,uBAAjC,IAA0D,MAAIjG,CAA/D,KAAmE,KAAKoG,OAAL,CAAaG,aAAb,CAA2B,eAA3B,EAA2CrH,CAAC,CAACmH,MAAF,CAASG,OAApD,CAAnE,EAAgItH,CAAC,CAAC+G,uBAAF,KAA4B,KAAKG,OAAL,CAAaG,aAAb,CAA2B,iBAA3B,EAA6CrH,CAAC,CAACuH,eAA/C,GAAgE7G,CAAC,CAAC,KAAKwG,OAAN,EAAclH,CAAd,CAA7F,CAAhI,EAA+O,MAAIc,CAAJ,KAAQ,KAAKoG,OAAL,CAAaM,YAAb,CAA0B,SAA1B,EAAoC1H,CAAC,CAAC2H,OAAtC,GAA+C,KAAKP,OAAL,CAAaM,YAAb,CAA0B,cAA1B,EAAyC1H,CAAC,CAAC4H,YAA3C,CAA/C,EAAwG,KAAKR,OAAL,CAAaS,aAAb,CAA2B,eAA3B,EAA2C7H,CAAC,CAAC8H,aAA7C,CAAxG,EAAoK,KAAKV,OAAL,CAAaW,YAAb,CAA0B,cAA1B,EAAyC1E,CAAC,CAACrD,CAAC,CAACgI,YAAH,CAA1C,CAA5K,CAA/O,EAAwd,MAAIhH,CAAJ,IAAOd,CAAC,CAAC+H,QAAF,CAAWC,WAAX,CAAuB,KAAKd,OAA5B,EAAoC,CAAC,CAArC,GAAwC,KAAKA,OAAL,CAAae,aAAb,CAA2B,SAA3B,EAAqCnI,CAAC,CAACoI,OAAvC,CAAxC,EAAwF,KAAKhB,OAAL,CAAae,aAAb,CAA2B,SAA3B,EAAqCnI,CAAC,CAACqI,OAAvC,CAAxF,EAAwI,KAAKjB,OAAL,CAAaS,aAAb,CAA2B,eAA3B,EAA2C7H,CAAC,CAAC8H,aAA7C,CAAxI,EAAoM,KAAKV,OAAL,CAAaW,YAAb,CAA0B,cAA1B,EAAyC1E,CAAC,CAACrD,CAAC,CAACgI,YAAH,CAA1C,CAApM,EAAgQ,KAAKZ,OAAL,CAAaM,YAAb,CAA0B,SAA1B,EAAoC1H,CAAC,CAAC2H,OAAtC,CAAhQ,EAA+S,KAAKP,OAAL,CAAaM,YAAb,CAA0B,cAA1B,EAAyC1H,CAAC,CAAC4H,YAA3C,CAA/S,EAAwW,KAAKvD,aAAL,CAAmBmB,MAAnB,IAA2B1E,CAAC,CAAC,KAAKsG,OAAN,EAAcpH,CAAd,EAAgB,KAAKqE,aAAL,CAAmBoB,WAAnC,CAA3Y,IAA4b,MAAIzE,CAAJ,IAAON,CAAC,CAAC,KAAK0G,OAAN,EAAclH,CAAd,CAA55B,EAA66BgB,CAAC,CAAC,KAAKkG,OAAN,EAAcpH,CAAd,CAA96B,EAA+7BQ,CAAC,CAAC,KAAK4G,OAAN,EAAcpH,CAAd,EAAgBE,CAAhB,CAAh8B,EAAm9BqD,CAAC,CAACvD,CAAC,CAAC0G,qBAAH,EAAyB,KAAKU,OAA9B,EAAsC,gCAAtC,CAAp9B,EAA4hC,MAAIpH,CAAC,CAACsI,gBAAN,IAAwB,MAAItI,CAAC,CAACsI,gBAA9B,IAAgD,KAAKlB,OAAL,CAAaM,YAAb,CAA0B,oBAA1B,EAA+C1H,CAAC,CAACuI,kBAAjD,CAA5kC,EAAipC,SAAOnI,CAAC,GAACF,CAAC,CAACsI,SAAX,KAAuBpI,CAAC,CAACqI,IAAF,CAAO,KAAKrB,OAAZ,CAAxqC,EAA6rC,SAAO9G,CAAC,GAACJ,CAAC,CAACwI,UAAX,KAAwBpI,CAAC,CAACmI,IAAF,CAAO,KAAKrB,OAAZ,CAArtC;AAA0uC;;AAAAuB,EAAAA,QAAQ,CAAC3I,CAAD,EAAG;AAAC,UAAMQ,CAAC,GAAC,KAAK6D,aAAL,CAAmBiB,wBAAnB,GAA4CpF,CAAC,CAACF,CAAC,CAACqH,MAAF,CAASuB,0BAAT,CAAoC,CAApC,CAAD,EAAwC5I,CAAC,CAACqH,MAAF,CAASuB,0BAAT,CAAoC,CAApC,CAAxC,EAA+E5I,CAAC,CAACqH,MAAF,CAASuB,0BAAT,CAAoC,EAApC,CAA/E,CAA7C,GAAqK5I,CAAC,CAAC6I,MAA/K;AAAsLrH,IAAAA,CAAC,CAAC,KAAK4F,OAAN,EAAc5G,CAAd,EAAgBR,CAAC,CAACqH,MAAF,CAASyB,UAAzB,CAAD,EAAsC,KAAK1B,OAAL,CAAa2B,cAAb,EAAtC,EAAoE,CAAC,MAAI,KAAK1E,aAAL,CAAmBI,MAAvB,IAA+B,MAAI,KAAKJ,aAAL,CAAmBI,MAAtD,IAA8D,MAAI,KAAKJ,aAAL,CAAmBI,MAAvB,IAA+B,KAAKJ,aAAL,CAAmBqC,qBAAhH,IAAuI,MAAI,KAAKrC,aAAL,CAAmBI,MAAvB,IAA+B,KAAKJ,aAAL,CAAmBqC,qBAAzL,IAAgN,MAAI,KAAKrC,aAAL,CAAmBI,MAAvB,IAA+B,KAAKJ,aAAL,CAAmBqC,qBAAnQ,KAA2RhF,CAAC,CAAC,KAAK0F,OAAN,EAAc5G,CAAd,EAAgBR,CAAC,CAACqH,MAAF,CAASuB,0BAAzB,CAAhW,EAAqZ,MAAI,KAAKvE,aAAL,CAAmBI,MAAvB,IAA+B,KAAK2C,OAAL,CAAa4B,mBAAb,CAAiC,YAAjC,EAA8ChJ,CAAC,CAACqH,MAAF,CAASuB,0BAAvD,CAApb,EAAugB,KAAKvE,aAAL,CAAmBiB,wBAAnB,IAA6ChF,CAAC,CAAC2I,gBAAF,CAAmB,KAAK7B,OAAxB,EAAgC5G,CAAhC,CAApjB,EAAulBJ,CAAC,CAAC,KAAKgH,OAAN,EAAc,KAAK/C,aAAnB,EAAiCrE,CAAC,CAACkJ,UAAnC,EAA8C1I,CAA9C,CAAxlB,EAAyoB,MAAI,KAAK6D,aAAL,CAAmBI,MAAvB,IAA+BzD,CAAC,CAAC,KAAKoG,OAAN,EAAcpH,CAAd,EAAgBQ,CAAhB,CAAzqB;AAA4rB;;AAAA2I,EAAAA,WAAW,CAACnJ,CAAD,EAAGE,CAAH,EAAK;AAAC,UAAME,CAAC,GAAC,KAAKiE,aAAb;AAAA,UAA2B/D,CAAC,GAAC,MAAIN,CAAjC;AAAA,UAAmCQ,CAAC,GAAC,MAAIR,CAAzC;AAA2C,WAAO0D,CAAC,CAAC;AAAC0F,MAAAA,QAAQ,EAAC,MAAIhJ,CAAC,CAACqE,MAAN,IAAc,MAAIrE,CAAC,CAACqE,MAApB,IAA4B,CAACrE,CAAC,CAACiJ,WAA/B,GAA2C,IAA3C,GAAgD/I,CAAC,GAAC+B,CAAD,GAAGE,CAAC,CAACvC,CAAD,CAA/D;AAAmEsJ,MAAAA,OAAO,EAACC,CAAC,CAACnJ,CAAD,CAAD,IAAMwD,CAAC,CAACxD,CAAC,CAACoJ,QAAH,CAAlF;AAA+FC,MAAAA,SAAS,EAAC;AAACC,QAAAA,IAAI,EAACjH,CAAC,CAACzC,CAAD;AAAP,OAAzG;AAAqH2J,MAAAA,UAAU,EAACrJ,CAAC,IAAEE,CAAH,GAAKJ,CAAC,CAACwJ,UAAF,IAAc9F,CAAnB,GAAqB,IAArJ;AAA0J+F,MAAAA,UAAU,EAAC7F,CAArK;AAAuK8F,MAAAA,YAAY,EAAC1J,CAAC,CAAC2J,gBAAF,GAAmBhH,CAAnB,GAAqB,IAAzM;AAA8MiH,MAAAA,WAAW,EAAC5J,CAAC,CAAC2J,gBAAF,GAAmB7J,CAAC,GAAC+C,CAAD,GAAGE,CAAvB,GAAyB,IAAnP;AAAwP8G,MAAAA,aAAa,EAAC3J,CAAC,IAAEE,CAAH,GAAK,IAAL,GAAUmC,CAAC,CAACvC,CAAC,CAAC8J,YAAH;AAAjR,KAAD,CAAR;AAA6S;;AAAAC,EAAAA,kBAAkB,GAAE;AAAC,WAAO,KAAKC,sBAAL,GAA4B,KAAKjB,WAAL,CAAiB,KAAK9E,aAAL,CAAmBG,oBAApC,EAAyD,CAAC,CAA1D,CAA5B,EAAyF,KAAK2E,WAAL,CAAiB,KAAK9E,aAAL,CAAmBG,oBAApC,EAAyD,CAAC,CAA1D,CAAhG;AAA6J;;AAAA6F,EAAAA,gBAAgB,CAACrK,CAAD,EAAG;AAAC,WAAOA,CAAC,GAAC,KAAKoK,sBAAN,GAA6B,KAAKE,QAA1C;AAAmD;;AAAtxI;;AAAuxI,SAASf,CAAT,CAAWvJ,CAAX,EAAa;AAAC,SAAOA,CAAC,CAACwJ,QAAF,GAAW,MAAIxJ,CAAC,CAACwJ,QAAjB,GAA0B,CAACxJ,CAAC,CAAC4E,iBAAH,IAAuB,CAAC5E,CAAC,CAACqJ,WAAH,IAAgB,CAACrJ,CAAC,CAACmG,eAA3E;AAA4F;;AAAAlC,CAAC,CAACE,MAAF,GAAS,IAAIvC,CAAJ,CAAM4B,CAAN,EAAS,MAAI,OAAO,2BAAP,CAAb,CAAT;;AAA4D,MAAM+G,CAAN,SAAgBxI,CAAhB,CAAiB;AAACyI,EAAAA,WAAW,GAAE;AAAC,UAAM,GAAGC,SAAT,GAAoB,KAAKhG,MAAL,GAAY,CAAhC,EAAkC,KAAKsC,gBAAL,GAAsB,CAAxD,EAA0D,KAAKZ,eAAL,GAAqB,CAA/E,EAAiF,KAAKV,WAAL,GAAiB,CAAC,CAAnG,EAAqG,KAAKe,YAAL,GAAkB,CAAC,CAAxH,EAA0H,KAAKK,eAAL,GAAqB,CAAC,CAAhJ,EAAkJ,KAAK7B,YAAL,GAAkB,CAAC,CAArK,EAAuK,KAAKC,MAAL,GAAY,CAAC,CAApL,EAAsL,KAAKC,OAAL,GAAa,CAAC,CAApM,EAAsM,KAAK0B,cAAL,GAAoB,CAAC,CAA3N,EAA6N,KAAKjC,cAAL,GAAoB,CAAC,CAAlP,EAAoP,KAAKC,iBAAL,GAAuB,CAAC,CAA5Q,EAA8Q,KAAKC,sBAAL,GAA4B,CAAC,CAA3S,EAA6S,KAAKkB,uBAAL,GAA6B,CAAC,CAA3U,EAA6U,KAAKW,qBAAL,GAA2B,CAAC,CAAzW,EAA2W,KAAKJ,yBAAL,GAA+B,CAAC,CAA3Y,EAA6Y,KAAKR,eAAL,GAAqB,CAAC,CAAna,EAAqa,KAAKN,MAAL,GAAY,CAAC,CAAlb,EAAob,KAAKE,+BAAL,GAAqC,CAAC,CAA1d,EAA4d,KAAKC,kBAAL,GAAwB,CAAC,CAArf,EAAuf,KAAKC,mBAAL,GAAyB,CAAC,CAAjhB,EAAmhB,KAAKC,gBAAL,GAAsB,CAAC,CAA1iB,EAA4iB,KAAKT,SAAL,GAAe,CAAC,CAA5jB,EAA8jB,KAAKC,cAAL,GAAoB,CAAC,CAAnlB,EAAqlB,KAAKC,wBAAL,GAA8B,CAAC,CAApnB,EAAsnB,KAAKc,cAAL,GAAoB,CAAC,CAA3oB,EAA6oB,KAAKF,mBAAL,GAAyB,CAAC,CAAvqB,EAAyqB,KAAK0D,UAAL,GAAgB,CAAC,CAA1rB,EAA4rB,KAAKG,gBAAL,GAAsB,CAAC,CAAntB,EAAqtB,KAAKV,WAAL,GAAiB,CAAC,CAAvuB,EAAyuB,KAAKa,YAAL,GAAkB,CAAC,CAA5vB,EAA8vB,KAAKV,QAAL,GAAc,CAA5wB,EAA8wB,KAAKhF,oBAAL,GAA0B,CAAxyB,EAA0yB,KAAKyC,uBAAL,GAA6B,CAAC,CAAx0B,EAA00B,KAAKC,eAAL,GAAqB,CAAC,CAAh2B;AAAk2B;;AAAj3B;;AAAk3BlH,CAAC,CAAC,CAACiC,CAAC,CAAC;AAACyI,EAAAA,KAAK,EAAC;AAAP,CAAD,CAAF,CAAD,EAAgBH,CAAC,CAACI,SAAlB,EAA4B,QAA5B,EAAqC,KAAK,CAA1C,CAAD,EAA8C3K,CAAC,CAAC,CAACiC,CAAC,CAAC;AAACyI,EAAAA,KAAK,EAAC;AAAP,CAAD,CAAF,CAAD,EAAgBH,CAAC,CAACI,SAAlB,EAA4B,kBAA5B,EAA+C,KAAK,CAApD,CAA/C,EAAsG3K,CAAC,CAAC,CAACiC,CAAC,CAAC;AAACyI,EAAAA,KAAK,EAAC;AAAP,CAAD,CAAF,CAAD,EAAgBH,CAAC,CAACI,SAAlB,EAA4B,iBAA5B,EAA8C,KAAK,CAAnD,CAAvG,EAA6J3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,aAAnB,EAAiC,KAAK,CAAtC,CAA9J,EAAuM3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,cAAnB,EAAkC,KAAK,CAAvC,CAAxM,EAAkP3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,iBAAnB,EAAqC,KAAK,CAA1C,CAAnP,EAAgS3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,cAAnB,EAAkC,KAAK,CAAvC,CAAjS,EAA2U3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,QAAnB,EAA4B,KAAK,CAAjC,CAA5U,EAAgX3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,SAAnB,EAA6B,KAAK,CAAlC,CAAjX,EAAsZ3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,gBAAnB,EAAoC,KAAK,CAAzC,CAAvZ,EAAmc3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,gBAAnB,EAAoC,KAAK,CAAzC,CAApc,EAAgf3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,mBAAnB,EAAuC,KAAK,CAA5C,CAAjf,EAAgiB3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,wBAAnB,EAA4C,KAAK,CAAjD,CAAjiB,EAAqlB3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,yBAAnB,EAA6C,KAAK,CAAlD,CAAtlB,EAA2oB3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,uBAAnB,EAA2C,KAAK,CAAhD,CAA5oB,EAA+rB3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,2BAAnB,EAA+C,KAAK,CAApD,CAAhsB,EAAuvB3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,iBAAnB,EAAqC,KAAK,CAA1C,CAAxvB,EAAqyB3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,QAAnB,EAA4B,KAAK,CAAjC,CAAtyB,EAA00B3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,iCAAnB,EAAqD,KAAK,CAA1D,CAA30B,EAAw4B3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,oBAAnB,EAAwC,KAAK,CAA7C,CAAz4B,EAAy7B3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,qBAAnB,EAAyC,KAAK,CAA9C,CAA17B,EAA2+B3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,kBAAnB,EAAsC,KAAK,CAA3C,CAA5+B,EAA0hC3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,WAAnB,EAA+B,KAAK,CAApC,CAA3hC,EAAkkC3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,gBAAnB,EAAoC,KAAK,CAAzC,CAAnkC,EAA+mC3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,0BAAnB,EAA8C,KAAK,CAAnD,CAAhnC,EAAsqC3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,gBAAnB,EAAoC,KAAK,CAAzC,CAAvqC,EAAmtC3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,qBAAnB,EAAyC,KAAK,CAA9C,CAAptC,EAAqwC3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,YAAnB,EAAgC,KAAK,CAArC,CAAtwC,EAA8yC3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,kBAAnB,EAAsC,KAAK,CAA3C,CAA/yC,EAA61C3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,aAAnB,EAAiC,KAAK,CAAtC,CAA91C,EAAu4C3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,cAAnB,EAAkC,KAAK,CAAvC,CAAx4C,EAAk7C3K,CAAC,CAAC,CAACiC,CAAC,CAAC;AAACyI,EAAAA,KAAK,EAAC;AAAP,CAAD,CAAF,CAAD,EAAgBH,CAAC,CAACI,SAAlB,EAA4B,UAA5B,EAAuC,KAAK,CAA5C,CAAn7C,EAAk+C3K,CAAC,CAAC,CAACiC,CAAC,CAAC;AAACyI,EAAAA,KAAK,EAAC;AAAP,CAAD,CAAF,CAAD,EAAgBH,CAAC,CAACI,SAAlB,EAA4B,sBAA5B,EAAmD,KAAK,CAAxD,CAAn+C,EAA8hD3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,yBAAnB,EAA6C,KAAK,CAAlD,CAA/hD,EAAolD3K,CAAC,CAAC,CAACiC,CAAC,EAAF,CAAD,EAAOsI,CAAC,CAACI,SAAT,EAAmB,iBAAnB,EAAqC,KAAK,CAA1C,CAArlD;AAAkoD,SAAO1G,CAAC,IAAI2G,wBAAZ,EAAqCL,CAAC,IAAIM,qCAA1C","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{f as t}from\"../../../../chunks/vec3f64.js\";import{bindSliceUniforms as i}from\"../core/shaderLibrary/Slice.glsl.js\";import{InstancedDoublePrecision as r}from\"../core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js\";import{bindVerticalOffsetUniforms as o}from\"../core/shaderLibrary/attributes/VerticalOffset.glsl.js\";import{bindOutputHighlight as s}from\"../core/shaderLibrary/output/OutputHighlight.glsl.js\";import{bindMultipassTerrainTexture as a}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindPBRUniforms as n}from\"../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";import{bindReadShadowMapViewCustomOrigin as l}from\"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{bindVisualVariablesUniformsForSymbols as p}from\"../core/shaderLibrary/shading/VisualVariables.glsl.js\";import{doublePrecisionRequiresObfuscation as c}from\"../core/shaderLibrary/util/DoublePrecision.glsl.js\";import{bindProjectionMatrix as u,bindViewCustomOrigin as h,bindCameraPosition as d}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as m}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as f}from\"../core/shaderTechnique/ShaderTechnique.js\";import{ShaderTechniqueConfiguration as v,parameter as g}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as b}from\"../lib/DefaultVertexAttributeLocations.js\";import{blendingDefault as y,OITBlending as x,OITDepthTest as T,getOITPolygonOffset as P}from\"../lib/OrderIndependentTransparency.js\";import{Program as M}from\"../lib/Program.js\";import{stencilWriteMaskOn as S,stencilToolMaskBaseParams as C,stencilBaseAllZerosParams as O}from\"../lib/StencilUtils.js\";import{colorMixModes as D,bindScreenSizePerspective as w}from\"../materials/internal/MaterialUtil.js\";import{D as j}from\"../../../../chunks/DefaultMaterial.glsl.js\";import{makePipelineState as A,cullingParams as E,defaultDepthWriteParams as U,defaultColorWriteParams as z}from\"../../../webgl/renderState.js\";class R extends f{initializeProgram(e){const t=R.shader.get(),i=this.configuration,r=t.build({OITEnabled:0===i.transparencyPassType,output:i.output,viewingMode:e.viewingMode,receiveShadows:i.receiveShadows,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:i.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:i.symbolColors,vvSize:i.vvSize,vvColor:i.vvColor,vvInstancingEnabled:!0,instanced:i.instanced,instancedColor:i.instancedColor,instancedDoublePrecision:i.instancedDoublePrecision,pbrMode:i.usePBR?i.isSchematic?2:1:0,hasMetalnessAndRoughnessTexture:i.hasMetalnessAndRoughnessTexture,hasEmissionTexture:i.hasEmissionTexture,hasOcclusionTexture:i.hasOcclusionTexture,hasNormalTexture:i.hasNormalTexture,hasColorTexture:i.hasColorTexture,receiveAmbientOcclusion:i.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:i.normalsTypeDerivate?3:0,doubleSidedMode:i.doubleSidedMode,vertexTangents:i.vertexTangents,attributeTextureCoordinates:i.hasMetalnessAndRoughnessTexture||i.hasEmissionTexture||i.hasOcclusionTexture||i.hasNormalTexture||i.hasColorTexture?1:0,textureAlphaPremultiplied:i.textureAlphaPremultiplied,attributeColor:i.vertexColors,screenSizePerspectiveEnabled:i.screenSizePerspective,verticalOffsetEnabled:i.verticalOffset,offsetBackfaces:i.offsetBackfaces,doublePrecisionRequiresObfuscation:c(e.rctx),alphaDiscardMode:i.alphaDiscardMode,supportsTextureAtlas:!1,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new M(e.rctx,r,b)}bindPass(e,t){var i,r;u(this.program,t.camera.projectionMatrix);const l=this.configuration.output;(1===this.configuration.output||t.multipassTerrainEnabled||3===l)&&this.program.setUniform2fv(\"cameraNearFar\",t.camera.nearFar),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),a(this.program,t)),7===l&&(this.program.setUniform1f(\"opacity\",e.opacity),this.program.setUniform1f(\"layerOpacity\",e.layerOpacity),this.program.setUniform4fv(\"externalColor\",e.externalColor),this.program.setUniform1i(\"colorMixMode\",D[e.colorMixMode])),0===l?(t.lighting.setUniforms(this.program,!1),this.program.setUniform3fv(\"ambient\",e.ambient),this.program.setUniform3fv(\"diffuse\",e.diffuse),this.program.setUniform4fv(\"externalColor\",e.externalColor),this.program.setUniform1i(\"colorMixMode\",D[e.colorMixMode]),this.program.setUniform1f(\"opacity\",e.opacity),this.program.setUniform1f(\"layerOpacity\",e.layerOpacity),this.configuration.usePBR&&n(this.program,e,this.configuration.isSchematic)):4===l&&s(this.program,t),p(this.program,e),o(this.program,e,t),w(e.screenSizePerspective,this.program,\"screenSizePerspectiveAlignment\"),2!==e.textureAlphaMode&&3!==e.textureAlphaMode||this.program.setUniform1f(\"textureAlphaCutoff\",e.textureAlphaCutoff),null==(i=t.shadowMap)||i.bind(this.program),null==(r=t.ssaoHelper)||r.bind(this.program)}bindDraw(e){const o=this.configuration.instancedDoublePrecision?t(e.camera.viewInverseTransposeMatrix[3],e.camera.viewInverseTransposeMatrix[7],e.camera.viewInverseTransposeMatrix[11]):e.origin;h(this.program,o,e.camera.viewMatrix),this.program.rebindTextures(),(0===this.configuration.output||7===this.configuration.output||1===this.configuration.output&&this.configuration.screenSizePerspective||2===this.configuration.output&&this.configuration.screenSizePerspective||4===this.configuration.output&&this.configuration.screenSizePerspective)&&d(this.program,o,e.camera.viewInverseTransposeMatrix),2===this.configuration.output&&this.program.setUniformMatrix4fv(\"viewNormal\",e.camera.viewInverseTransposeMatrix),this.configuration.instancedDoublePrecision&&r.bindCustomOrigin(this.program,o),i(this.program,this.configuration,e.slicePlane,o),0===this.configuration.output&&l(this.program,e,o)}setPipeline(e,t){const i=this.configuration,r=3===e,o=2===e;return A({blending:0!==i.output&&7!==i.output||!i.transparent?null:r?y:x(e),culling:L(i)&&E(i.cullFace),depthTest:{func:T(e)},depthWrite:r||o?i.writeDepth&&U:null,colorWrite:z,stencilWrite:i.sceneHasOcludees?S:null,stencilTest:i.sceneHasOcludees?t?C:O:null,polygonOffset:r||o?null:P(i.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipeline(this.configuration.transparencyPassType,!0),this.setPipeline(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}function L(e){return e.cullFace?0!==e.cullFace:!e.slicePlaneEnabled&&(!e.transparent&&!e.doubleSidedMode)}R.shader=new m(j,(()=>import(\"./DefaultMaterial.glsl.js\")));class H extends v{constructor(){super(...arguments),this.output=0,this.alphaDiscardMode=1,this.doubleSidedMode=0,this.isSchematic=!1,this.vertexColors=!1,this.offsetBackfaces=!1,this.symbolColors=!1,this.vvSize=!1,this.vvColor=!1,this.verticalOffset=!1,this.receiveShadows=!1,this.slicePlaneEnabled=!1,this.sliceHighlightDisabled=!1,this.receiveAmbientOcclusion=!1,this.screenSizePerspective=!1,this.textureAlphaPremultiplied=!1,this.hasColorTexture=!1,this.usePBR=!1,this.hasMetalnessAndRoughnessTexture=!1,this.hasEmissionTexture=!1,this.hasOcclusionTexture=!1,this.hasNormalTexture=!1,this.instanced=!1,this.instancedColor=!1,this.instancedDoublePrecision=!1,this.vertexTangents=!1,this.normalsTypeDerivate=!1,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparent=!1,this.enableOffset=!0,this.cullFace=0,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([g({count:8})],H.prototype,\"output\",void 0),e([g({count:4})],H.prototype,\"alphaDiscardMode\",void 0),e([g({count:3})],H.prototype,\"doubleSidedMode\",void 0),e([g()],H.prototype,\"isSchematic\",void 0),e([g()],H.prototype,\"vertexColors\",void 0),e([g()],H.prototype,\"offsetBackfaces\",void 0),e([g()],H.prototype,\"symbolColors\",void 0),e([g()],H.prototype,\"vvSize\",void 0),e([g()],H.prototype,\"vvColor\",void 0),e([g()],H.prototype,\"verticalOffset\",void 0),e([g()],H.prototype,\"receiveShadows\",void 0),e([g()],H.prototype,\"slicePlaneEnabled\",void 0),e([g()],H.prototype,\"sliceHighlightDisabled\",void 0),e([g()],H.prototype,\"receiveAmbientOcclusion\",void 0),e([g()],H.prototype,\"screenSizePerspective\",void 0),e([g()],H.prototype,\"textureAlphaPremultiplied\",void 0),e([g()],H.prototype,\"hasColorTexture\",void 0),e([g()],H.prototype,\"usePBR\",void 0),e([g()],H.prototype,\"hasMetalnessAndRoughnessTexture\",void 0),e([g()],H.prototype,\"hasEmissionTexture\",void 0),e([g()],H.prototype,\"hasOcclusionTexture\",void 0),e([g()],H.prototype,\"hasNormalTexture\",void 0),e([g()],H.prototype,\"instanced\",void 0),e([g()],H.prototype,\"instancedColor\",void 0),e([g()],H.prototype,\"instancedDoublePrecision\",void 0),e([g()],H.prototype,\"vertexTangents\",void 0),e([g()],H.prototype,\"normalsTypeDerivate\",void 0),e([g()],H.prototype,\"writeDepth\",void 0),e([g()],H.prototype,\"sceneHasOcludees\",void 0),e([g()],H.prototype,\"transparent\",void 0),e([g()],H.prototype,\"enableOffset\",void 0),e([g({count:3})],H.prototype,\"cullFace\",void 0),e([g({count:4})],H.prototype,\"transparencyPassType\",void 0),e([g()],H.prototype,\"multipassTerrainEnabled\",void 0),e([g()],H.prototype,\"cullAboveGround\",void 0);export{R as DefaultMaterialTechnique,H as DefaultMaterialTechniqueConfiguration};\n"]},"metadata":{},"sourceType":"module"}