{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../chunks/tslib.es6.js\";\nimport \"../../core/has.js\";\nimport { JSONSupport as e } from \"../../core/JSONSupport.js\";\nimport { property as a } from \"../../core/accessorSupport/decorators/property.js\";\nimport { ensureClass as r } from \"../../core/accessorSupport/ensureType.js\";\nimport \"../../core/Logger.js\";\nimport { reader as s } from \"../../core/accessorSupport/decorators/reader.js\";\nimport { subclass as n } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { writer as o } from \"../../core/accessorSupport/decorators/writer.js\";\nimport { t as i, w as l } from \"../../chunks/persistableUrlUtils.js\";\nimport { wrapImageData as c } from \"../../views/support/screenshotUtils.js\";\nvar p;\nconst d = new WeakMap();\nlet h = 0,\n    u = p = class extends e {\n  constructor(t) {\n    super(t), this.wrap = \"repeat\";\n  }\n\n  get url() {\n    return this._get(\"url\") || null;\n  }\n\n  set url(t) {\n    this._set(\"url\", t), t && this._set(\"data\", null);\n  }\n\n  get data() {\n    return this._get(\"data\") || null;\n  }\n\n  set data(t) {\n    this._set(\"data\", t), t && this._set(\"url\", null);\n  }\n\n  writeData(t, e, a, r) {\n    if (t instanceof HTMLImageElement) {\n      const s = {\n        type: \"image-element\",\n        src: i(t.src, r),\n        crossOrigin: t.crossOrigin\n      };\n      e[a] = s;\n    } else if (t instanceof HTMLCanvasElement) {\n      const r = t.getContext(\"2d\").getImageData(0, 0, t.width, t.height),\n            s = {\n        type: \"canvas-element\",\n        imageData: this.encodeImageData(r)\n      };\n      e[a] = s;\n    } else if (t instanceof HTMLVideoElement) {\n      const s = {\n        type: \"video-element\",\n        src: i(t.src, r),\n        autoplay: t.autoplay,\n        loop: t.loop,\n        muted: t.muted,\n        crossOrigin: t.crossOrigin,\n        preload: t.preload\n      };\n      e[a] = s;\n    } else {\n      const r = {\n        type: \"image-data\",\n        imageData: this.encodeImageData(t)\n      };\n      e[a] = r;\n    }\n  }\n\n  readData(t) {\n    switch (t.type) {\n      case \"image-element\":\n        {\n          const e = new Image();\n          return e.src = t.src, e.crossOrigin = t.crossOrigin, e;\n        }\n\n      case \"canvas-element\":\n        {\n          const e = this.decodeImageData(t.imageData),\n                a = document.createElement(\"canvas\");\n          return a.width = e.width, a.height = e.height, a.getContext(\"2d\").putImageData(e, 0, 0), a;\n        }\n\n      case \"image-data\":\n        return this.decodeImageData(t.imageData);\n\n      case \"video-element\":\n        {\n          const e = document.createElement(\"video\");\n          return e.src = t.src, e.crossOrigin = t.crossOrigin, e.autoplay = t.autoplay, e.loop = t.loop, e.muted = t.muted, e.preload = t.preload, e;\n        }\n\n      default:\n        return;\n    }\n  }\n\n  get transparent() {\n    const t = this.data,\n          e = this.url;\n    if (t instanceof HTMLCanvasElement) return this.imageDataContainsTransparent(t.getContext(\"2d\").getImageData(0, 0, t.width, t.height));\n    if (t instanceof ImageData) return this.imageDataContainsTransparent(t);\n\n    if (e) {\n      const t = e.substr(e.length - 4, 4).toLowerCase(),\n            a = e.substr(0, 15).toLocaleLowerCase();\n      if (\".png\" === t || \"data:image/png;\" === a) return !0;\n    }\n\n    return !1;\n  }\n\n  set transparent(t) {\n    null != t ? this._override(\"transparent\", t) : this._clearOverride(\"transparent\");\n  }\n\n  get contentHash() {\n    const t = \"string\" == typeof this.wrap ? this.wrap : \"object\" == typeof this.wrap ? `${this.wrap.horizontal}/${this.wrap.vertical}` : \"\",\n          e = (e = \"\") => `d:${e},t:${this.transparent},w:${t}`;\n\n    return null != this.url ? e(this.url) : null != this.data ? this.data instanceof HTMLImageElement || this.data instanceof HTMLVideoElement ? e(this.data.src) : (d.has(this.data) || d.set(this.data, ++h), e(d.get(this.data))) : e();\n  }\n\n  clone() {\n    const t = {\n      url: this.url,\n      data: this.data,\n      wrap: this.cloneWrap()\n    };\n    return new p(t);\n  }\n\n  cloneWithDeduplication(t) {\n    const e = t.get(this);\n    if (e) return e;\n    const a = this.clone();\n    return t.set(this, a), a;\n  }\n\n  cloneWrap() {\n    return \"string\" == typeof this.wrap ? this.wrap : {\n      horizontal: this.wrap.horizontal,\n      vertical: this.wrap.vertical\n    };\n  }\n\n  encodeImageData(t) {\n    let e = \"\";\n\n    for (let a = 0; a < t.data.length; a++) e += String.fromCharCode(t.data[a]);\n\n    return {\n      data: btoa(e),\n      width: t.width,\n      height: t.height\n    };\n  }\n\n  decodeImageData(t) {\n    const e = atob(t.data),\n          a = new Uint8ClampedArray(e.length);\n\n    for (let r = 0; r < e.length; r++) a[r] = e.charCodeAt(r);\n\n    return c(a, t.width, t.height);\n  }\n\n  imageDataContainsTransparent(t) {\n    for (let e = 3; e < t.data.length; e += 4) if (255 !== t.data[e]) return !0;\n\n    return !1;\n  }\n\n  static from(t) {\n    return \"string\" == typeof t ? new p({\n      url: t\n    }) : t instanceof HTMLImageElement || t instanceof HTMLCanvasElement || t instanceof ImageData || t instanceof HTMLVideoElement ? new p({\n      data: t\n    }) : r(p, t);\n  }\n\n};\nt([a({\n  type: String,\n  json: {\n    write: l\n  }\n})], u.prototype, \"url\", null), t([a({\n  json: {\n    write: {\n      overridePolicy() {\n        return {\n          enabled: !this.url\n        };\n      }\n\n    }\n  }\n}), a()], u.prototype, \"data\", null), t([o(\"data\")], u.prototype, \"writeData\", null), t([s(\"data\")], u.prototype, \"readData\", null), t([a({\n  type: Boolean,\n  json: {\n    write: {\n      overridePolicy() {\n        return {\n          enabled: this._isOverridden(\"transparent\")\n        };\n      }\n\n    }\n  }\n})], u.prototype, \"transparent\", null), t([a({\n  json: {\n    write: !0\n  }\n})], u.prototype, \"wrap\", void 0), t([a({\n  readOnly: !0\n})], u.prototype, \"contentHash\", null), u = p = t([n(\"esri.geometry.support.MeshTexture\")], u);\nvar m = u;\nexport default m;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/geometry/support/MeshTexture.js"],"names":["_","t","JSONSupport","e","property","a","ensureClass","r","reader","s","subclass","n","writer","o","i","w","l","wrapImageData","c","p","d","WeakMap","h","u","constructor","wrap","url","_get","_set","data","writeData","HTMLImageElement","type","src","crossOrigin","HTMLCanvasElement","getContext","getImageData","width","height","imageData","encodeImageData","HTMLVideoElement","autoplay","loop","muted","preload","readData","Image","decodeImageData","document","createElement","putImageData","transparent","imageDataContainsTransparent","ImageData","substr","length","toLowerCase","toLocaleLowerCase","_override","_clearOverride","contentHash","horizontal","vertical","has","set","get","clone","cloneWrap","cloneWithDeduplication","String","fromCharCode","btoa","atob","Uint8ClampedArray","charCodeAt","from","json","write","prototype","overridePolicy","enabled","Boolean","_isOverridden","readOnly","m"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import{JSONSupport as e}from\"../../core/JSONSupport.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import{ensureClass as r}from\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{reader as s}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as n}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as o}from\"../../core/accessorSupport/decorators/writer.js\";import{t as i,w as l}from\"../../chunks/persistableUrlUtils.js\";import{wrapImageData as c}from\"../../views/support/screenshotUtils.js\";var p;const d=new WeakMap;let h=0,u=p=class extends e{constructor(t){super(t),this.wrap=\"repeat\"}get url(){return this._get(\"url\")||null}set url(t){this._set(\"url\",t),t&&this._set(\"data\",null)}get data(){return this._get(\"data\")||null}set data(t){this._set(\"data\",t),t&&this._set(\"url\",null)}writeData(t,e,a,r){if(t instanceof HTMLImageElement){const s={type:\"image-element\",src:i(t.src,r),crossOrigin:t.crossOrigin};e[a]=s}else if(t instanceof HTMLCanvasElement){const r=t.getContext(\"2d\").getImageData(0,0,t.width,t.height),s={type:\"canvas-element\",imageData:this.encodeImageData(r)};e[a]=s}else if(t instanceof HTMLVideoElement){const s={type:\"video-element\",src:i(t.src,r),autoplay:t.autoplay,loop:t.loop,muted:t.muted,crossOrigin:t.crossOrigin,preload:t.preload};e[a]=s}else{const r={type:\"image-data\",imageData:this.encodeImageData(t)};e[a]=r}}readData(t){switch(t.type){case\"image-element\":{const e=new Image;return e.src=t.src,e.crossOrigin=t.crossOrigin,e}case\"canvas-element\":{const e=this.decodeImageData(t.imageData),a=document.createElement(\"canvas\");return a.width=e.width,a.height=e.height,a.getContext(\"2d\").putImageData(e,0,0),a}case\"image-data\":return this.decodeImageData(t.imageData);case\"video-element\":{const e=document.createElement(\"video\");return e.src=t.src,e.crossOrigin=t.crossOrigin,e.autoplay=t.autoplay,e.loop=t.loop,e.muted=t.muted,e.preload=t.preload,e}default:return}}get transparent(){const t=this.data,e=this.url;if(t instanceof HTMLCanvasElement)return this.imageDataContainsTransparent(t.getContext(\"2d\").getImageData(0,0,t.width,t.height));if(t instanceof ImageData)return this.imageDataContainsTransparent(t);if(e){const t=e.substr(e.length-4,4).toLowerCase(),a=e.substr(0,15).toLocaleLowerCase();if(\".png\"===t||\"data:image/png;\"===a)return!0}return!1}set transparent(t){null!=t?this._override(\"transparent\",t):this._clearOverride(\"transparent\")}get contentHash(){const t=\"string\"==typeof this.wrap?this.wrap:\"object\"==typeof this.wrap?`${this.wrap.horizontal}/${this.wrap.vertical}`:\"\",e=(e=\"\")=>`d:${e},t:${this.transparent},w:${t}`;return null!=this.url?e(this.url):null!=this.data?this.data instanceof HTMLImageElement||this.data instanceof HTMLVideoElement?e(this.data.src):(d.has(this.data)||d.set(this.data,++h),e(d.get(this.data))):e()}clone(){const t={url:this.url,data:this.data,wrap:this.cloneWrap()};return new p(t)}cloneWithDeduplication(t){const e=t.get(this);if(e)return e;const a=this.clone();return t.set(this,a),a}cloneWrap(){return\"string\"==typeof this.wrap?this.wrap:{horizontal:this.wrap.horizontal,vertical:this.wrap.vertical}}encodeImageData(t){let e=\"\";for(let a=0;a<t.data.length;a++)e+=String.fromCharCode(t.data[a]);return{data:btoa(e),width:t.width,height:t.height}}decodeImageData(t){const e=atob(t.data),a=new Uint8ClampedArray(e.length);for(let r=0;r<e.length;r++)a[r]=e.charCodeAt(r);return c(a,t.width,t.height)}imageDataContainsTransparent(t){for(let e=3;e<t.data.length;e+=4)if(255!==t.data[e])return!0;return!1}static from(t){return\"string\"==typeof t?new p({url:t}):t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageData||t instanceof HTMLVideoElement?new p({data:t}):r(p,t)}};t([a({type:String,json:{write:l}})],u.prototype,\"url\",null),t([a({json:{write:{overridePolicy(){return{enabled:!this.url}}}}}),a()],u.prototype,\"data\",null),t([o(\"data\")],u.prototype,\"writeData\",null),t([s(\"data\")],u.prototype,\"readData\",null),t([a({type:Boolean,json:{write:{overridePolicy(){return{enabled:this._isOverridden(\"transparent\")}}}}})],u.prototype,\"transparent\",null),t([a({json:{write:!0}})],u.prototype,\"wrap\",void 0),t([a({readOnly:!0})],u.prototype,\"contentHash\",null),u=p=t([n(\"esri.geometry.support.MeshTexture\")],u);var m=u;export default m;\n"]},"metadata":{},"sourceType":"module"}