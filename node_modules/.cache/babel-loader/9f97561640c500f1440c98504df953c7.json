{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { createScreenPoint as t } from \"../../../core/screenUtils.js\";\nimport { Milliseconds as e } from \"../../../core/time.js\";\nimport { InputHandler as i } from \"../InputHandler.js\";\nimport { fitCircleLSQ as n } from \"./support.js\";\n\nclass s extends i {\n  constructor(t) {\n    super(!1), this.navigationTouch = t, this.startStateModifiers = new Set(), this.activePointerMap = new Map(), this.isDragging = !1, this.isCurrentDragSuppressed = !1, this.drag = this.registerOutgoing(\"drag\"), this.registerIncoming(\"pointer-drag\", this.handlePointerDrag.bind(this)), this.registerIncoming(\"pointer-up\", this.handlePointerUpAndPointerLost.bind(this)), this.registerIncoming(\"pointer-capture-lost\", this.handlePointerUpAndPointerLost.bind(this)), this.registerIncoming(\"pointer-cancel\", this.handlePointerUpAndPointerLost.bind(this));\n  }\n\n  createPayload(t, e, i, n) {\n    return {\n      action: t,\n      pointerType: this.pointerType,\n      button: this.mouseButton,\n      buttons: e.buttons,\n      timestamp: n,\n      pointers: o(this.activePointerMap),\n      pointer: e,\n      angle: i.angle,\n      radius: i.radius,\n      center: i.center\n    };\n  }\n\n  addPointer(t) {\n    const e = t.native.pointerId,\n          i = a(this.activePointerMap).angle,\n          n = {\n      event: t,\n      initialAngle: 0,\n      lastAngle: 0\n    };\n    this.activePointerMap.set(e, n);\n    const s = h(n, r(this.activePointerMap));\n    n.initialAngle = s, n.lastAngle = s, this.updatePointerAngles(i);\n  }\n\n  updatePointer(t) {\n    if (t && null == t.x && null == t.y) return;\n    const e = t.native.pointerId,\n          i = this.activePointerMap.get(e);\n    i ? i.event = t : this.addPointer(t);\n  }\n\n  removePointer(t) {\n    const e = a(this.activePointerMap).angle;\n    this.activePointerMap.delete(t), this.updatePointerAngles(e);\n  }\n\n  updatePointerAngles(t) {\n    const e = a(this.activePointerMap);\n    this.activePointerMap.forEach(i => {\n      i.initialAngle = h(i, e) - t, i.lastAngle = h(i, e) - t;\n    });\n  }\n\n  emitEvent(t, e, i) {\n    const n = a(this.activePointerMap);\n    this.drag.emit(this.createPayload(t, e, n, i), void 0, this.startStateModifiers);\n  }\n\n  handlePointerUpAndPointerLost(t) {\n    const i = t.data.native.pointerId,\n          n = e(t.timestamp);\n    this.activePointerMap.get(i) && (1 === this.activePointerMap.size ? (this.updatePointer(t.data), !this.isCurrentDragSuppressed && this.emitEvent(\"end\", t.data, n), this.isDragging = !1, this.isCurrentDragSuppressed = !1, this.removePointer(i)) : (this.removePointer(i), this.emitEvent(\"removed\", t.data, e(t.timestamp))));\n  }\n\n  handlePointerDrag(t) {\n    const i = t.data,\n          n = i.currentEvent,\n          s = e(t.timestamp);\n\n    switch (i.action) {\n      case \"start\":\n      case \"update\":\n        this.isDragging ? this.activePointerMap.has(n.native.pointerId) ? (this.updatePointer(n), !this.isCurrentDragSuppressed && this.emitEvent(\"update\", n, s)) : (this.addPointer(n), this.emitEvent(\"added\", n, s), this.isCurrentDragSuppressed = this.isSuppressed) : (this.updatePointer(n), this.pointerType = t.data.startEvent.pointerType, this.mouseButton = t.data.startEvent.button, this.startStateModifiers = t.modifiers, this.isDragging = !0, this.isCurrentDragSuppressed = this.isSuppressed, !this.isCurrentDragSuppressed && this.emitEvent(\"start\", n, s));\n    }\n  }\n\n  get isSuppressed() {\n    return this.navigationTouch && !this.navigationTouch.browserTouchPanEnabled && \"touch\" === this.pointerType && 1 === this.activePointerMap.size;\n  }\n\n}\n\nfunction r(e) {\n  const i = [];\n  return e.forEach(e => {\n    i.push(t(e.event.x, e.event.y));\n  }), n(i);\n}\n\nfunction a(t) {\n  const e = r(t);\n  let i = 0;\n  return t.forEach(t => {\n    let n = h(t, e),\n        s = n - t.lastAngle;\n\n    for (; s > Math.PI;) s -= 2 * Math.PI;\n\n    for (; s < -Math.PI;) s += 2 * Math.PI;\n\n    n = t.lastAngle + s, t.lastAngle = n;\n    const r = n - t.initialAngle;\n    i += r;\n  }), i /= t.size || 1, {\n    angle: i,\n    radius: e.radius,\n    center: e.center\n  };\n}\n\nfunction o(t) {\n  const e = new Map();\n  return t.forEach((t, i) => e.set(i, t.event)), e;\n}\n\nfunction h(t, e) {\n  const i = t.event,\n        n = i.x - e.center.x,\n        s = i.y - e.center.y;\n  return Math.atan2(s, n);\n}\n\nvar p;\n!function (t) {\n  t[t.Left = 0] = \"Left\", t[t.Middle = 1] = \"Middle\", t[t.Right = 2] = \"Right\", t[t.Back = 3] = \"Back\", t[t.Forward = 4] = \"Forward\", t[t.Undefined = -1] = \"Undefined\";\n}(p || (p = {}));\nexport { p as Button, s as Drag };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/input/recognizers/Drag.js"],"names":["createScreenPoint","t","Milliseconds","e","InputHandler","i","fitCircleLSQ","n","s","constructor","navigationTouch","startStateModifiers","Set","activePointerMap","Map","isDragging","isCurrentDragSuppressed","drag","registerOutgoing","registerIncoming","handlePointerDrag","bind","handlePointerUpAndPointerLost","createPayload","action","pointerType","button","mouseButton","buttons","timestamp","pointers","o","pointer","angle","radius","center","addPointer","native","pointerId","a","event","initialAngle","lastAngle","set","h","r","updatePointerAngles","updatePointer","x","y","get","removePointer","delete","forEach","emitEvent","emit","data","size","currentEvent","has","isSuppressed","startEvent","modifiers","browserTouchPanEnabled","push","Math","PI","atan2","p","Left","Middle","Right","Back","Forward","Undefined","Button","Drag"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{createScreenPoint as t}from\"../../../core/screenUtils.js\";import{Milliseconds as e}from\"../../../core/time.js\";import{InputHandler as i}from\"../InputHandler.js\";import{fitCircleLSQ as n}from\"./support.js\";class s extends i{constructor(t){super(!1),this.navigationTouch=t,this.startStateModifiers=new Set,this.activePointerMap=new Map,this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.drag=this.registerOutgoing(\"drag\"),this.registerIncoming(\"pointer-drag\",this.handlePointerDrag.bind(this)),this.registerIncoming(\"pointer-up\",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming(\"pointer-capture-lost\",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming(\"pointer-cancel\",this.handlePointerUpAndPointerLost.bind(this))}createPayload(t,e,i,n){return{action:t,pointerType:this.pointerType,button:this.mouseButton,buttons:e.buttons,timestamp:n,pointers:o(this.activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}addPointer(t){const e=t.native.pointerId,i=a(this.activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this.activePointerMap.set(e,n);const s=h(n,r(this.activePointerMap));n.initialAngle=s,n.lastAngle=s,this.updatePointerAngles(i)}updatePointer(t){if(t&&null==t.x&&null==t.y)return;const e=t.native.pointerId,i=this.activePointerMap.get(e);i?i.event=t:this.addPointer(t)}removePointer(t){const e=a(this.activePointerMap).angle;this.activePointerMap.delete(t),this.updatePointerAngles(e)}updatePointerAngles(t){const e=a(this.activePointerMap);this.activePointerMap.forEach((i=>{i.initialAngle=h(i,e)-t,i.lastAngle=h(i,e)-t}))}emitEvent(t,e,i){const n=a(this.activePointerMap);this.drag.emit(this.createPayload(t,e,n,i),void 0,this.startStateModifiers)}handlePointerUpAndPointerLost(t){const i=t.data.native.pointerId,n=e(t.timestamp);this.activePointerMap.get(i)&&(1===this.activePointerMap.size?(this.updatePointer(t.data),!this.isCurrentDragSuppressed&&this.emitEvent(\"end\",t.data,n),this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.removePointer(i)):(this.removePointer(i),this.emitEvent(\"removed\",t.data,e(t.timestamp))))}handlePointerDrag(t){const i=t.data,n=i.currentEvent,s=e(t.timestamp);switch(i.action){case\"start\":case\"update\":this.isDragging?this.activePointerMap.has(n.native.pointerId)?(this.updatePointer(n),!this.isCurrentDragSuppressed&&this.emitEvent(\"update\",n,s)):(this.addPointer(n),this.emitEvent(\"added\",n,s),this.isCurrentDragSuppressed=this.isSuppressed):(this.updatePointer(n),this.pointerType=t.data.startEvent.pointerType,this.mouseButton=t.data.startEvent.button,this.startStateModifiers=t.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this.emitEvent(\"start\",n,s))}}get isSuppressed(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&\"touch\"===this.pointerType&&1===this.activePointerMap.size}}function r(e){const i=[];return e.forEach((e=>{i.push(t(e.event.x,e.event.y))})),n(i)}function a(t){const e=r(t);let i=0;return t.forEach((t=>{let n=h(t,e),s=n-t.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=t.lastAngle+s,t.lastAngle=n;const r=n-t.initialAngle;i+=r})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function o(t){const e=new Map;return t.forEach(((t,i)=>e.set(i,t.event))),e}function h(t,e){const i=t.event,n=i.x-e.center.x,s=i.y-e.center.y;return Math.atan2(s,n)}var p;!function(t){t[t.Left=0]=\"Left\",t[t.Middle=1]=\"Middle\",t[t.Right=2]=\"Right\",t[t.Back=3]=\"Back\",t[t.Forward=4]=\"Forward\",t[t.Undefined=-1]=\"Undefined\"}(p||(p={}));export{p as Button,s as Drag};\n"]},"metadata":{},"sourceType":"module"}