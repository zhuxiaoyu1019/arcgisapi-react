{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { eachAlways as e } from \"../../../../../core/promiseUtils.js\";\nimport t from \"../../../../Point.js\";\nimport { GLB as r } from \"./glb.js\";\nimport { GLTF as o } from \"./gltf.js\";\nimport { ImageOutputType as n, BufferOutputType as s } from \"./types.js\";\nexport { AlphaMode, AttributeType, BufferOutputType, ColorMode, ImageOutputType, MeshMode } from \"./types.js\";\nimport { isArrayBufferPNG as i, encodeBase64DataUri as u } from \"./imageutils.js\";\nexport { Asset } from \"./asset.js\";\nexport { Scene } from \"./scene.js\";\nexport { Node } from \"./node.js\";\nconst f = \"model.gltf\",\n      p = \"model.glb\";\n\nfunction a(a, m, c) {\n  const l = new o(a, m = m || {}, c);\n  let g = l.params;\n  g ? g.origin || (g.origin = new t({\n    x: -1,\n    y: -1,\n    z: -1\n  })) : g = {\n    origin: new t({\n      x: -1,\n      y: -1,\n      z: -1\n    })\n  };\n  const y = g.origin,\n        d = l.gltf,\n        j = d.extras.promises;\n  let x = 1,\n      b = 1,\n      B = null;\n  return e(j).then(() => {\n    const e = {\n      origin: y\n    };\n    delete d.extras;\n    const t = \"number\" == typeof m.jsonSpacing ? m.jsonSpacing : 4,\n          o = JSON.stringify(d, (t, r) => {\n      if (\"extras\" !== t) {\n        if (r instanceof ArrayBuffer) {\n          if (i(r)) switch (m.imageOutputType) {\n            case n.DataURI:\n            case n.GLB:\n              break;\n\n            case n.External:\n            default:\n              {\n                const t = `img${b}.png`;\n                return b++, e[t] = r, t;\n              }\n          }\n\n          switch (m.bufferOutputType) {\n            case s.DataURI:\n              return u(r);\n\n            case s.GLB:\n              if (B) throw new Error(\"Already encountered an ArrayBuffer, there should only be one in the GLB format.\");\n              return void (B = r);\n\n            case s.External:\n            default:\n              {\n                const t = `data${x}.bin`;\n                return x++, e[t] = r, t;\n              }\n          }\n        }\n\n        return r;\n      }\n    }, t);\n    return m.bufferOutputType === s.GLB || m.imageOutputType === n.GLB ? e[p] = new r(o, B).buffer : e[f] = o, e;\n  });\n}\n\nfunction m(e, t) {\n  return a(e, {\n    bufferOutputType: s.GLB,\n    imageOutputType: n.GLB,\n    jsonSpacing: 0\n  }, t);\n}\n\nexport { p as MODEL_NAME_GLB, f as MODEL_NAME_GLTF, m as exportGLB, a as exportGLTF };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/geometry/support/meshUtils/exporters/gltf/index.js"],"names":["eachAlways","e","t","GLB","r","GLTF","o","ImageOutputType","n","BufferOutputType","s","AlphaMode","AttributeType","ColorMode","MeshMode","isArrayBufferPNG","i","encodeBase64DataUri","u","Asset","Scene","Node","f","p","a","m","c","l","g","params","origin","x","y","z","d","gltf","j","extras","promises","b","B","then","jsonSpacing","JSON","stringify","ArrayBuffer","imageOutputType","DataURI","External","bufferOutputType","Error","buffer","MODEL_NAME_GLB","MODEL_NAME_GLTF","exportGLB","exportGLTF"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{eachAlways as e}from\"../../../../../core/promiseUtils.js\";import t from\"../../../../Point.js\";import{GLB as r}from\"./glb.js\";import{GLTF as o}from\"./gltf.js\";import{ImageOutputType as n,BufferOutputType as s}from\"./types.js\";export{AlphaMode,AttributeType,BufferOutputType,ColorMode,ImageOutputType,MeshMode}from\"./types.js\";import{isArrayBufferPNG as i,encodeBase64DataUri as u}from\"./imageutils.js\";export{Asset}from\"./asset.js\";export{Scene}from\"./scene.js\";export{Node}from\"./node.js\";const f=\"model.gltf\",p=\"model.glb\";function a(a,m,c){const l=new o(a,m=m||{},c);let g=l.params;g?g.origin||(g.origin=new t({x:-1,y:-1,z:-1})):g={origin:new t({x:-1,y:-1,z:-1})};const y=g.origin,d=l.gltf,j=d.extras.promises;let x=1,b=1,B=null;return e(j).then((()=>{const e={origin:y};delete d.extras;const t=\"number\"==typeof m.jsonSpacing?m.jsonSpacing:4,o=JSON.stringify(d,((t,r)=>{if(\"extras\"!==t){if(r instanceof ArrayBuffer){if(i(r))switch(m.imageOutputType){case n.DataURI:case n.GLB:break;case n.External:default:{const t=`img${b}.png`;return b++,e[t]=r,t}}switch(m.bufferOutputType){case s.DataURI:return u(r);case s.GLB:if(B)throw new Error(\"Already encountered an ArrayBuffer, there should only be one in the GLB format.\");return void(B=r);case s.External:default:{const t=`data${x}.bin`;return x++,e[t]=r,t}}}return r}}),t);return m.bufferOutputType===s.GLB||m.imageOutputType===n.GLB?e[p]=new r(o,B).buffer:e[f]=o,e}))}function m(e,t){return a(e,{bufferOutputType:s.GLB,imageOutputType:n.GLB,jsonSpacing:0},t)}export{p as MODEL_NAME_GLB,f as MODEL_NAME_GLTF,m as exportGLB,a as exportGLTF};\n"]},"metadata":{},"sourceType":"module"}