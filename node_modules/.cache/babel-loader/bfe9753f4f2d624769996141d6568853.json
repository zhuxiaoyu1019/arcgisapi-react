{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport t from \"../Map.js\";\nimport i from \"../TimeExtent.js\";\nimport r from \"../core/Accessor.js\";\nimport o from \"../core/Collection.js\";\nimport a from \"../core/CollectionFlattener.js\";\nimport s from \"../core/Error.js\";\nimport n from \"../core/Evented.js\";\nimport { HandleOwnerMixin as l } from \"../core/HandleOwner.js\";\nimport p from \"../core/Loadable.js\";\nimport h from \"../core/Logger.js\";\nimport { isSome as d } from \"../core/maybe.js\";\nimport { EsriPromiseMixin as u } from \"../core/Promise.js\";\nimport { after as y } from \"../core/promiseUtils.js\";\nimport { schedule as m } from \"../core/scheduling.js\";\nimport { whenOnce as c, init as f, whenFalseOnce as w, watch as g } from \"../core/watchUtils.js\";\nimport { aliasOf as v } from \"../core/accessorSupport/decorators/aliasOf.js\";\nimport \"../core/has.js\";\nimport \"../core/accessorSupport/ensureType.js\";\nimport { property as M } from \"../core/accessorSupport/decorators/property.js\";\nimport { subclass as V } from \"../core/accessorSupport/decorators/subclass.js\";\nimport R from \"../geometry/Extent.js\";\nimport _ from \"../geometry/HeightModelInfo.js\";\nimport F from \"../geometry/SpatialReference.js\";\nimport { equals as j } from \"../geometry/support/spatialReferenceUtils.js\";\nimport E, { graphicsCollectionProperty as S } from \"../support/GraphicsCollection.js\";\nimport { BasemapView as O } from \"./BasemapView.js\";\nimport C from \"./LayerViewManager.js\";\nimport b from \"./Magnifier.js\";\nimport x from \"./RefreshManager.js\";\nimport L from \"./ToolViewManager.js\";\nimport I from \"./input/Input.js\";\nimport { ViewEvents as D } from \"./input/ViewEvents.js\";\nimport T from \"./navigation/Navigation.js\";\nimport q from \"./support/DefaultsFromMap.js\";\nvar z;\nconst H = h.getLogger(\"esri.views.View\");\nlet W = z = class extends l(n.EventedMixin(u(r))) {\n  constructor(e) {\n    super(e), this._userSpatialReference = null, this._cursor = null, this.allLayerViews = new a({\n      getCollections: () => {\n        var e, t, i;\n        return [null == (e = this.basemapView) ? void 0 : e.baseLayerViews, null == (t = this.groundView) ? void 0 : t.layerViews, this.layerViews, null == (i = this.basemapView) ? void 0 : i.referenceLayerViews];\n      },\n      getChildrenFunction: e => e.layerViews\n    }), this.groundView = null, this.animation = null, this.basemapView = null, this.defaultsFromMap = new q({\n      view: this\n    }), this.fatalError = null, this.extent = null, this.graphics = new E(), this.navigating = !1, this.layerViews = new o(), this.magnifier = new b(), this.padding = {\n      left: 0,\n      top: 0,\n      right: 0,\n      bottom: 0\n    }, this.ready = !1, this.spatialReferenceWarningDelay = 1e3, this.supportsGround = !0, this.timeExtent = null, this.type = null, this.scale = null, this.updating = !1, this.initialExtentRequired = !0, this.renderContext = null, this.input = new I(), this.navigation = new T(), this.layerViewManager = null, this.refreshManager = null, this.isHeightModelInfoRequired = !1, this.width = null, this.height = null, this.resizing = !1, this.suspended = !1, this.viewEvents = new D(this), this.persistableViewModels = new o(), this._isValid = !1, this._readyCycleForced = !1, this.handles.add(this.watch(\"preconditionsReady\", e => {\n      e ? (this._currentSpatialReference = this.spatialReference, z.views.add(this)) : (this._currentSpatialReference = null, z.views.remove(this)), this.notifyChange(\"spatialReference\"), !e && this.ready ? (this.layerViewManager.clear(), this.toolViewManager.detach(), this._teardown()) : e && !this.ready && (this._startup(), this.toolViewManager.attach());\n    }, !0));\n  }\n\n  initialize() {\n    let e;\n    this.addResolvingPromise(this.validate().then(() => (this._isValid = !0, c(this, \"ready\")))), this.basemapView = new O({\n      view: this\n    }), this.layerViewManager = new C({\n      view: this,\n      layerViewImporter: {\n        importLayerView: e => this.importLayerView(e),\n        hasLayerViewModule: e => this.hasLayerViewModule(e)\n      },\n      supportsGround: this.supportsGround\n    }), this.refreshManager = new x({\n      view: this\n    }), this.toolViewManager = new L({\n      view: this\n    }), this._resetInitialViewPropertiesFromContent(), f(this.defaultsFromMap, \"isSpatialReferenceDone\", t => {\n      const i = !!(this.map && this.map.allLayers.length > 0);\n\n      if (t && !this.spatialReference && i || !e) {\n        if (t && !this.spatialReference && i && !e) {\n          const t = e = y(this.spatialReferenceWarningDelay);\n          e.then(() => {\n            t === e && H.warn(\"#spatialReference\", \"no spatial reference could be derived from the currently added map layers\");\n          }).catch(() => {});\n        }\n      } else e = null;\n    }, !0);\n  }\n\n  destroy() {\n    if (this.destroyed) return;\n    this.viewEvents.destroy(), this.allLayerViews.destroy(), this.navigation && (this.navigation.destroy(), this._set(\"navigation\", null)), this.graphics.destroy(), this.graphics = null, this.handles.remove(\"defaultsFromMap\"), this.defaultsFromMap.destroy(), this._set(\"defaultsFromMap\", null), this.toolViewManager.destroy(), this.toolViewManager = null, this.refreshManager.destroy(), this.refreshManager = null, this.layerViewManager.destroy(), this.layerViewManager = null, this.basemapView.destroy(), this.basemapView = null, this.invalidate(), this._emitter.clear(), this.handles.removeAll();\n    const e = this.map;\n    this.map = null, null == e || e.destroy();\n  }\n\n  _startup() {\n    this._set(\"ready\", !0);\n  }\n\n  _teardown() {\n    this._set(\"ready\", !1);\n  }\n\n  whenReady() {\n    return Promise.resolve(this);\n  }\n\n  toMap() {\n    return H.error(\"#toMap()\", \"Not implemented on this instance of View\"), null;\n  }\n\n  get heightModelInfo() {\n    return this.getDefaultHeightModelInfo();\n  }\n\n  get interacting() {\n    return this.navigating;\n  }\n\n  get preconditionsReady() {\n    return !!(!this.fatalError && this._isValid && !this._readyCycleForced && this.map && (!p.isLoadable(this.map) || this.map.loaded) && 0 !== this.width && 0 !== this.height && this.spatialReference && this.isSpatialReferenceSupported(this.spatialReference) && (this._currentSpatialReference || !this.initialExtentRequired || this.initialExtent || this.defaultsFromMap && this.defaultsFromMap.isSpatialReferenceDone) && this.defaultsFromMap && this.defaultsFromMap.isTileInfoDone);\n  }\n\n  set map(e) {\n    var t;\n    e !== this._get(\"map\") && (null != (t = e) && t.destroyed && (H.warn(\"#map\", \"The provided map is already destroyed\", {\n      map: e\n    }), e = null), p.isLoadable(e) && e.load().catch(() => {}), this.initialized && (this.forceReadyCycle(), this._resetInitialViewPropertiesFromContent()), this._set(\"map\", e));\n  }\n\n  get spatialReference() {\n    let e = this._userSpatialReference || this._currentSpatialReference || this.getDefaultSpatialReference() || null;\n    return e && this.isHeightModelInfoRequired && this.defaultsFromMap && (e = e.clone(), e.vcsWkid = this.defaultsFromMap.vcsWkid, e.latestVcsWkid = this.defaultsFromMap.latestVcsWkid), e;\n  }\n\n  set spatialReference(e) {\n    this._userSpatialReference = e, this._set(\"spatialReference\", e);\n  }\n\n  get stationary() {\n    return !this.animation && !this.navigating && !this.resizing;\n  }\n\n  get initialExtent() {\n    return this.defaultsFromMap && this.defaultsFromMap.extent;\n  }\n\n  get cursor() {\n    const e = this.toolViewManager ? this.toolViewManager.cursor : null;\n    return d(e) ? e : this._cursor || \"default\";\n  }\n\n  set cursor(e) {\n    this._cursor = e, this.notifyChange(\"cursor\");\n  }\n\n  get size() {\n    return [this.width, this.height];\n  }\n\n  whenLayerView(e) {\n    return this.layerViewManager.whenLayerView(e);\n  }\n\n  getDefaultSpatialReference() {\n    return this.get(\"defaultsFromMap.spatialReference\");\n  }\n\n  getDefaultHeightModelInfo() {\n    return this.get(\"map.supportsHeightModelInfo\") && this.get(\"map.heightModelInfo\") || this.get(\"defaultsFromMap.heightModelInfo\") || null;\n  }\n\n  importLayerView(e) {\n    throw new s(\"importLayerView() not implemented\");\n  }\n\n  hasLayerViewModule(e) {\n    return !1;\n  }\n\n  async validate() {}\n\n  invalidate() {\n    this._isValid = !1;\n  }\n\n  isSpatialReferenceSupported(e, t, i) {\n    return !0;\n  }\n\n  isTileInfoRequired() {\n    return !1;\n  }\n\n  when(e, t) {\n    return this.isResolved() && !this.ready && H.warn(\"#when()\", 'Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use watchUtils.whenOnce(view, \"ready\").then(...) instead.'), super.when(e, t);\n  }\n\n  forceReadyCycle() {\n    this.ready && (this._readyCycleForced = !0, w(this, \"preconditionsReady\", () => this._readyCycleForced = !1));\n  }\n\n  createTool(e, t, i) {\n    return this.toolViewManager.createTool(e, t, i);\n  }\n\n  tryFatalErrorRecovery() {\n    this.fatalError = null;\n  }\n\n  _resetInitialViewPropertiesFromContent() {\n    if (!this.defaultsFromMap) return;\n\n    const e = () => this.defaultsFromMap && this.defaultsFromMap.start();\n\n    this.defaultsFromMap.reset(), this._currentSpatialReference = null, this.notifyChange(\"spatialReference\"), this.handles.remove(\"defaultsFromMap\"), this.handles.add([g(this, \"spatialReference\", (t, i) => {\n      j(t, i) || e();\n    }), g(this, \"initialExtentRequired\", e), m(e)], \"defaultsFromMap\");\n  }\n\n};\nW.views = new o(), e([v(\"toolViewManager.activeTool\")], W.prototype, \"activeTool\", void 0), e([M({\n  readOnly: !0\n})], W.prototype, \"allLayerViews\", void 0), e([M()], W.prototype, \"groundView\", void 0), e([M()], W.prototype, \"animation\", void 0), e([M()], W.prototype, \"basemapView\", void 0), e([M()], W.prototype, \"defaultsFromMap\", void 0), e([M()], W.prototype, \"fatalError\", void 0), e([M({\n  type: R\n})], W.prototype, \"extent\", void 0), e([M(S())], W.prototype, \"graphics\", void 0), e([M({\n  readOnly: !0,\n  type: _,\n  dependsOn: [\"map.heightModelInfo?\", \"defaultsFromMap.heightModelInfo\"]\n})], W.prototype, \"heightModelInfo\", null), e([M({\n  readOnly: !0\n})], W.prototype, \"interacting\", null), e([M({\n  readOnly: !0\n})], W.prototype, \"navigating\", void 0), e([M({\n  readOnly: !0,\n  dependsOn: [\"fatalError\", \"_isValid\", \"_readyCycleForced\", \"map\", \"map.loaded?\", \"width\", \"height\", \"spatialReference\", \"_currentSpatialReference\", \"initialExtentRequired\", \"initialExtent\", \"defaultsFromMap.isSpatialReferenceDone\", \"defaultsFromMap.isTileInfoDone\"]\n})], W.prototype, \"preconditionsReady\", null), e([M({\n  type: o,\n  readOnly: !0\n})], W.prototype, \"layerViews\", void 0), e([M({\n  type: b\n})], W.prototype, \"magnifier\", void 0), e([M({\n  value: null,\n  type: t\n})], W.prototype, \"map\", null), e([M()], W.prototype, \"padding\", void 0), e([M({\n  readOnly: !0\n})], W.prototype, \"ready\", void 0), e([M({\n  type: F\n})], W.prototype, \"spatialReference\", null), e([M()], W.prototype, \"spatialReferenceWarningDelay\", void 0), e([M()], W.prototype, \"stationary\", null), e([M({\n  readOnly: !0\n})], W.prototype, \"supportsGround\", void 0), e([M({\n  type: i\n})], W.prototype, \"timeExtent\", void 0), e([v(\"toolViewManager.tools\")], W.prototype, \"tools\", void 0), e([M()], W.prototype, \"toolViewManager\", void 0), e([M({\n  readOnly: !0\n})], W.prototype, \"type\", void 0), e([M({\n  type: Number\n})], W.prototype, \"scale\", void 0), e([M({\n  readOnly: !0\n})], W.prototype, \"updating\", void 0), e([M({\n  readOnly: !0\n})], W.prototype, \"initialExtentRequired\", void 0), e([M({\n  readOnly: !0,\n  type: R\n})], W.prototype, \"initialExtent\", null), e([M()], W.prototype, \"cursor\", null), e([M()], W.prototype, \"renderContext\", void 0), e([M({\n  readOnly: !0\n})], W.prototype, \"input\", void 0), e([M({\n  type: T,\n  nonNullable: !0\n})], W.prototype, \"navigation\", void 0), e([M()], W.prototype, \"layerViewManager\", void 0), e([M()], W.prototype, \"width\", void 0), e([M()], W.prototype, \"height\", void 0), e([M({\n  readOnly: !0\n})], W.prototype, \"resizing\", void 0), e([M({\n  value: null,\n  readOnly: !0\n})], W.prototype, \"size\", null), e([M({\n  readOnly: !0\n})], W.prototype, \"suspended\", void 0), e([M({\n  readOnly: !0\n})], W.prototype, \"viewEvents\", void 0), e([M({\n  readOnly: !0\n})], W.prototype, \"persistableViewModels\", void 0), e([M()], W.prototype, \"_isValid\", void 0), e([M()], W.prototype, \"_readyCycleForced\", void 0), e([M()], W.prototype, \"_currentSpatialReference\", void 0), W = z = e([V(\"esri.views.View\")], W);\nvar P = W;\nexport default P;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/View.js"],"names":["_","e","t","i","r","o","a","s","n","HandleOwnerMixin","l","p","h","isSome","d","EsriPromiseMixin","u","after","y","schedule","m","whenOnce","c","init","f","whenFalseOnce","w","watch","g","aliasOf","v","property","M","subclass","V","R","F","equals","j","E","graphicsCollectionProperty","S","BasemapView","O","C","b","x","L","I","ViewEvents","D","T","q","z","H","getLogger","W","EventedMixin","constructor","_userSpatialReference","_cursor","allLayerViews","getCollections","basemapView","baseLayerViews","groundView","layerViews","referenceLayerViews","getChildrenFunction","animation","defaultsFromMap","view","fatalError","extent","graphics","navigating","magnifier","padding","left","top","right","bottom","ready","spatialReferenceWarningDelay","supportsGround","timeExtent","type","scale","updating","initialExtentRequired","renderContext","input","navigation","layerViewManager","refreshManager","isHeightModelInfoRequired","width","height","resizing","suspended","viewEvents","persistableViewModels","_isValid","_readyCycleForced","handles","add","_currentSpatialReference","spatialReference","views","remove","notifyChange","clear","toolViewManager","detach","_teardown","_startup","attach","initialize","addResolvingPromise","validate","then","layerViewImporter","importLayerView","hasLayerViewModule","_resetInitialViewPropertiesFromContent","map","allLayers","length","warn","catch","destroy","destroyed","_set","invalidate","_emitter","removeAll","whenReady","Promise","resolve","toMap","error","heightModelInfo","getDefaultHeightModelInfo","interacting","preconditionsReady","isLoadable","loaded","isSpatialReferenceSupported","initialExtent","isSpatialReferenceDone","isTileInfoDone","_get","load","initialized","forceReadyCycle","getDefaultSpatialReference","clone","vcsWkid","latestVcsWkid","stationary","cursor","size","whenLayerView","get","isTileInfoRequired","when","isResolved","createTool","tryFatalErrorRecovery","start","reset","prototype","readOnly","dependsOn","value","Number","nonNullable","P"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import t from\"../Map.js\";import i from\"../TimeExtent.js\";import r from\"../core/Accessor.js\";import o from\"../core/Collection.js\";import a from\"../core/CollectionFlattener.js\";import s from\"../core/Error.js\";import n from\"../core/Evented.js\";import{HandleOwnerMixin as l}from\"../core/HandleOwner.js\";import p from\"../core/Loadable.js\";import h from\"../core/Logger.js\";import{isSome as d}from\"../core/maybe.js\";import{EsriPromiseMixin as u}from\"../core/Promise.js\";import{after as y}from\"../core/promiseUtils.js\";import{schedule as m}from\"../core/scheduling.js\";import{whenOnce as c,init as f,whenFalseOnce as w,watch as g}from\"../core/watchUtils.js\";import{aliasOf as v}from\"../core/accessorSupport/decorators/aliasOf.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import{property as M}from\"../core/accessorSupport/decorators/property.js\";import{subclass as V}from\"../core/accessorSupport/decorators/subclass.js\";import R from\"../geometry/Extent.js\";import _ from\"../geometry/HeightModelInfo.js\";import F from\"../geometry/SpatialReference.js\";import{equals as j}from\"../geometry/support/spatialReferenceUtils.js\";import E,{graphicsCollectionProperty as S}from\"../support/GraphicsCollection.js\";import{BasemapView as O}from\"./BasemapView.js\";import C from\"./LayerViewManager.js\";import b from\"./Magnifier.js\";import x from\"./RefreshManager.js\";import L from\"./ToolViewManager.js\";import I from\"./input/Input.js\";import{ViewEvents as D}from\"./input/ViewEvents.js\";import T from\"./navigation/Navigation.js\";import q from\"./support/DefaultsFromMap.js\";var z;const H=h.getLogger(\"esri.views.View\");let W=z=class extends(l(n.EventedMixin(u(r)))){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new a({getCollections:()=>{var e,t,i;return[null==(e=this.basemapView)?void 0:e.baseLayerViews,null==(t=this.groundView)?void 0:t.layerViews,this.layerViews,null==(i=this.basemapView)?void 0:i.referenceLayerViews]},getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.animation=null,this.basemapView=null,this.defaultsFromMap=new q({view:this}),this.fatalError=null,this.extent=null,this.graphics=new E,this.navigating=!1,this.layerViews=new o,this.magnifier=new b,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.renderContext=null,this.input=new I,this.navigation=new T,this.layerViewManager=null,this.refreshManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new D(this),this.persistableViewModels=new o,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(this.watch(\"preconditionsReady\",(e=>{e?(this._currentSpatialReference=this.spatialReference,z.views.add(this)):(this._currentSpatialReference=null,z.views.remove(this)),this.notifyChange(\"spatialReference\"),!e&&this.ready?(this.layerViewManager.clear(),this.toolViewManager.detach(),this._teardown()):e&&!this.ready&&(this._startup(),this.toolViewManager.attach())}),!0))}initialize(){let e;this.addResolvingPromise(this.validate().then((()=>(this._isValid=!0,c(this,\"ready\"))))),this.basemapView=new O({view:this}),this.layerViewManager=new C({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.refreshManager=new x({view:this}),this.toolViewManager=new L({view:this}),this._resetInitialViewPropertiesFromContent(),f(this.defaultsFromMap,\"isSpatialReferenceDone\",(t=>{const i=!!(this.map&&this.map.allLayers.length>0);if(t&&!this.spatialReference&&i||!e){if(t&&!this.spatialReference&&i&&!e){const t=e=y(this.spatialReferenceWarningDelay);e.then((()=>{t===e&&H.warn(\"#spatialReference\",\"no spatial reference could be derived from the currently added map layers\")})).catch((()=>{}))}}else e=null}),!0)}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set(\"navigation\",null)),this.graphics.destroy(),this.graphics=null,this.handles.remove(\"defaultsFromMap\"),this.defaultsFromMap.destroy(),this._set(\"defaultsFromMap\",null),this.toolViewManager.destroy(),this.toolViewManager=null,this.refreshManager.destroy(),this.refreshManager=null,this.layerViewManager.destroy(),this.layerViewManager=null,this.basemapView.destroy(),this.basemapView=null,this.invalidate(),this._emitter.clear(),this.handles.removeAll();const e=this.map;this.map=null,null==e||e.destroy()}_startup(){this._set(\"ready\",!0)}_teardown(){this._set(\"ready\",!1)}whenReady(){return Promise.resolve(this)}toMap(){return H.error(\"#toMap()\",\"Not implemented on this instance of View\"),null}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get preconditionsReady(){return!!(!this.fatalError&&this._isValid&&!this._readyCycleForced&&this.map&&(!p.isLoadable(this.map)||this.map.loaded)&&0!==this.width&&0!==this.height&&this.spatialReference&&this.isSpatialReferenceSupported(this.spatialReference)&&(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isSpatialReferenceDone)&&this.defaultsFromMap&&this.defaultsFromMap.isTileInfoDone)}set map(e){var t;e!==this._get(\"map\")&&(null!=(t=e)&&t.destroyed&&(H.warn(\"#map\",\"The provided map is already destroyed\",{map:e}),e=null),p.isLoadable(e)&&e.load().catch((()=>{})),this.initialized&&(this.forceReadyCycle(),this._resetInitialViewPropertiesFromContent()),this._set(\"map\",e))}get spatialReference(){let e=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return e&&this.isHeightModelInfoRequired&&this.defaultsFromMap&&(e=e.clone(),e.vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),e}set spatialReference(e){this._userSpatialReference=e,this._set(\"spatialReference\",e)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get initialExtent(){return this.defaultsFromMap&&this.defaultsFromMap.extent}get cursor(){const e=this.toolViewManager?this.toolViewManager.cursor:null;return d(e)?e:this._cursor||\"default\"}set cursor(e){this._cursor=e,this.notifyChange(\"cursor\")}get size(){return[this.width,this.height]}whenLayerView(e){return this.layerViewManager.whenLayerView(e)}getDefaultSpatialReference(){return this.get(\"defaultsFromMap.spatialReference\")}getDefaultHeightModelInfo(){return this.get(\"map.supportsHeightModelInfo\")&&this.get(\"map.heightModelInfo\")||this.get(\"defaultsFromMap.heightModelInfo\")||null}importLayerView(e){throw new s(\"importLayerView() not implemented\")}hasLayerViewModule(e){return!1}async validate(){}invalidate(){this._isValid=!1}isSpatialReferenceSupported(e,t,i){return!0}isTileInfoRequired(){return!1}when(e,t){return this.isResolved()&&!this.ready&&H.warn(\"#when()\",'Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use watchUtils.whenOnce(view, \"ready\").then(...) instead.'),super.when(e,t)}forceReadyCycle(){this.ready&&(this._readyCycleForced=!0,w(this,\"preconditionsReady\",(()=>this._readyCycleForced=!1)))}createTool(e,t,i){return this.toolViewManager.createTool(e,t,i)}tryFatalErrorRecovery(){this.fatalError=null}_resetInitialViewPropertiesFromContent(){if(!this.defaultsFromMap)return;const e=()=>this.defaultsFromMap&&this.defaultsFromMap.start();this.defaultsFromMap.reset(),this._currentSpatialReference=null,this.notifyChange(\"spatialReference\"),this.handles.remove(\"defaultsFromMap\"),this.handles.add([g(this,\"spatialReference\",((t,i)=>{j(t,i)||e()})),g(this,\"initialExtentRequired\",e),m(e)],\"defaultsFromMap\")}};W.views=new o,e([v(\"toolViewManager.activeTool\")],W.prototype,\"activeTool\",void 0),e([M({readOnly:!0})],W.prototype,\"allLayerViews\",void 0),e([M()],W.prototype,\"groundView\",void 0),e([M()],W.prototype,\"animation\",void 0),e([M()],W.prototype,\"basemapView\",void 0),e([M()],W.prototype,\"defaultsFromMap\",void 0),e([M()],W.prototype,\"fatalError\",void 0),e([M({type:R})],W.prototype,\"extent\",void 0),e([M(S())],W.prototype,\"graphics\",void 0),e([M({readOnly:!0,type:_,dependsOn:[\"map.heightModelInfo?\",\"defaultsFromMap.heightModelInfo\"]})],W.prototype,\"heightModelInfo\",null),e([M({readOnly:!0})],W.prototype,\"interacting\",null),e([M({readOnly:!0})],W.prototype,\"navigating\",void 0),e([M({readOnly:!0,dependsOn:[\"fatalError\",\"_isValid\",\"_readyCycleForced\",\"map\",\"map.loaded?\",\"width\",\"height\",\"spatialReference\",\"_currentSpatialReference\",\"initialExtentRequired\",\"initialExtent\",\"defaultsFromMap.isSpatialReferenceDone\",\"defaultsFromMap.isTileInfoDone\"]})],W.prototype,\"preconditionsReady\",null),e([M({type:o,readOnly:!0})],W.prototype,\"layerViews\",void 0),e([M({type:b})],W.prototype,\"magnifier\",void 0),e([M({value:null,type:t})],W.prototype,\"map\",null),e([M()],W.prototype,\"padding\",void 0),e([M({readOnly:!0})],W.prototype,\"ready\",void 0),e([M({type:F})],W.prototype,\"spatialReference\",null),e([M()],W.prototype,\"spatialReferenceWarningDelay\",void 0),e([M()],W.prototype,\"stationary\",null),e([M({readOnly:!0})],W.prototype,\"supportsGround\",void 0),e([M({type:i})],W.prototype,\"timeExtent\",void 0),e([v(\"toolViewManager.tools\")],W.prototype,\"tools\",void 0),e([M()],W.prototype,\"toolViewManager\",void 0),e([M({readOnly:!0})],W.prototype,\"type\",void 0),e([M({type:Number})],W.prototype,\"scale\",void 0),e([M({readOnly:!0})],W.prototype,\"updating\",void 0),e([M({readOnly:!0})],W.prototype,\"initialExtentRequired\",void 0),e([M({readOnly:!0,type:R})],W.prototype,\"initialExtent\",null),e([M()],W.prototype,\"cursor\",null),e([M()],W.prototype,\"renderContext\",void 0),e([M({readOnly:!0})],W.prototype,\"input\",void 0),e([M({type:T,nonNullable:!0})],W.prototype,\"navigation\",void 0),e([M()],W.prototype,\"layerViewManager\",void 0),e([M()],W.prototype,\"width\",void 0),e([M()],W.prototype,\"height\",void 0),e([M({readOnly:!0})],W.prototype,\"resizing\",void 0),e([M({value:null,readOnly:!0})],W.prototype,\"size\",null),e([M({readOnly:!0})],W.prototype,\"suspended\",void 0),e([M({readOnly:!0})],W.prototype,\"viewEvents\",void 0),e([M({readOnly:!0})],W.prototype,\"persistableViewModels\",void 0),e([M()],W.prototype,\"_isValid\",void 0),e([M()],W.prototype,\"_readyCycleForced\",void 0),e([M()],W.prototype,\"_currentSpatialReference\",void 0),W=z=e([V(\"esri.views.View\")],W);var P=W;export default P;\n"]},"metadata":{},"sourceType":"module"}