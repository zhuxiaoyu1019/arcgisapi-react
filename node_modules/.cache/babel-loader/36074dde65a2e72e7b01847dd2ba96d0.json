{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport t from \"../../request.js\";\nimport \"../../core/has.js\";\nimport { JSONMap as s } from \"../../core/jsonMap.js\";\nimport { JSONSupport as r } from \"../../core/JSONSupport.js\";\nimport { onAbort as o, createAbortError as i } from \"../../core/promiseUtils.js\";\nimport { property as a } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport \"../../core/Logger.js\";\nimport { subclass as c } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { parseUrl as n } from \"../utils.js\";\nimport u from \"../geoprocessor/GPOptions.js\";\nimport { gpEncode as l, decode as b } from \"../geoprocessor/utils.js\";\nimport j from \"./GPMessage.js\";\nvar p;\nconst h = new s({\n  esriJobCancelled: \"job-cancelled\",\n  esriJobCancelling: \"job-cancelling\",\n  esriJobDeleted: \"job-deleted\",\n  esriJobDeleting: \"job-deleting\",\n  esriJobTimedOut: \"job-timed-out\",\n  esriJobExecuting: \"job-executing\",\n  esriJobFailed: \"job-failed\",\n  esriJobNew: \"job-new\",\n  esriJobSubmitted: \"job-submitted\",\n  esriJobSucceeded: \"job-succeeded\",\n  esriJobWaiting: \"job-waiting\"\n});\nlet m = p = class extends r {\n  constructor(e) {\n    super(e), this.jobId = null, this.jobStatus = null, this.messages = null, this.requestOptions = null, this.sourceUrl = null, this._timer = null;\n  }\n\n  cancelJob(e) {\n    const {\n      jobId: s,\n      sourceUrl: r\n    } = this,\n          {\n      path: o\n    } = n(r),\n          i = { ...this.requestOptions,\n      ...e,\n      query: {\n        f: \"json\"\n      }\n    };\n\n    this._clearTimer();\n\n    return t(`${o}/jobs/${s}/cancel`, i).then(e => {\n      const t = p.fromJSON(e.data);\n      return this.messages = t.messages, this.jobStatus = t.jobStatus, this;\n    });\n  }\n\n  destroy() {\n    clearInterval(this._timer);\n  }\n\n  checkJobStatus(e) {\n    const {\n      path: s\n    } = n(this.sourceUrl),\n          r = { ...this.requestOptions,\n      ...e,\n      query: {\n        f: \"json\"\n      }\n    },\n          o = `${s}/jobs/${this.jobId}`;\n    return t(o, r).then(({\n      data: e\n    }) => {\n      const t = p.fromJSON(e);\n      return this.messages = t.messages, this.jobStatus = t.jobStatus, this;\n    });\n  }\n\n  fetchResultData(e, s, r) {\n    s = u.from(s || {});\n    const {\n      returnFeatureCollection: o,\n      returnM: i,\n      returnZ: a,\n      outSpatialReference: c\n    } = s,\n          {\n      path: j\n    } = n(this.sourceUrl),\n          p = l({\n      returnFeatureCollection: o,\n      returnM: i,\n      returnZ: a,\n      outSR: c,\n      returnType: \"data\",\n      f: \"json\"\n    }, null),\n          h = { ...this.requestOptions,\n      ...r,\n      query: p\n    },\n          m = `${j}/jobs/${this.jobId}/results/${e}`;\n    return t(m, h).then(e => b(e.data));\n  }\n\n  fetchResultImage(e, s, r) {\n    const {\n      path: o\n    } = n(this.sourceUrl),\n          i = { ...s.toJSON(),\n      f: \"json\"\n    },\n          a = l(i),\n          c = { ...this.requestOptions,\n      ...r,\n      query: a\n    },\n          u = `${o}/jobs/${this.jobId}/results/${e}`;\n    return t(u, c).then(e => b(e.data));\n  }\n\n  async fetchResultMapImageLayer() {\n    const {\n      path: e\n    } = n(this.sourceUrl),\n          t = e.indexOf(\"/GPServer/\"),\n          s = `${e.substring(0, t)}/MapServer/jobs/${this.jobId}`;\n    return new (0, (await import(\"../../layers/MapImageLayer.js\")).default)({\n      url: s\n    });\n  }\n\n  async waitForJobCompletion(e = {}) {\n    const {\n      interval: t = 1e3,\n      signal: s,\n      statusCallback: r\n    } = e;\n    return new Promise((e, a) => {\n      o(s, () => {\n        this._clearTimer(), a(i());\n      }), this._clearTimer();\n      const c = setInterval(() => {\n        this._timer || a(i()), this.checkJobStatus(this.requestOptions).then(t => {\n          const {\n            jobStatus: s\n          } = t;\n\n          switch (this.jobStatus = s, s) {\n            case \"job-succeeded\":\n              this._clearTimer(), e(this);\n              break;\n\n            case \"job-submitted\":\n            case \"job-executing\":\n            case \"job-waiting\":\n            case \"job-new\":\n              r && r(this);\n              break;\n\n            case \"job-cancelled\":\n            case \"job-cancelling\":\n            case \"job-deleted\":\n            case \"job-deleting\":\n            case \"job-timed-out\":\n            case \"job-failed\":\n              this._clearTimer(), a(this);\n          }\n        });\n      }, t);\n      this._timer = c;\n    });\n  }\n\n  _clearTimer() {\n    this._timer && (clearInterval(this._timer), this._timer = null);\n  }\n\n};\ne([a()], m.prototype, \"jobId\", void 0), e([a({\n  json: {\n    read: h.read\n  }\n})], m.prototype, \"jobStatus\", void 0), e([a({\n  type: [j]\n})], m.prototype, \"messages\", void 0), e([a()], m.prototype, \"requestOptions\", void 0), e([a({\n  json: {\n    write: !0\n  }\n})], m.prototype, \"sourceUrl\", void 0), m = p = e([c(\"esri.rest.support.JobInfo\")], m);\nvar d = m;\nexport default d;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/rest/support/JobInfo.js"],"names":["_","e","t","JSONMap","s","JSONSupport","r","onAbort","o","createAbortError","i","property","a","subclass","c","parseUrl","n","u","gpEncode","l","decode","b","j","p","h","esriJobCancelled","esriJobCancelling","esriJobDeleted","esriJobDeleting","esriJobTimedOut","esriJobExecuting","esriJobFailed","esriJobNew","esriJobSubmitted","esriJobSucceeded","esriJobWaiting","m","constructor","jobId","jobStatus","messages","requestOptions","sourceUrl","_timer","cancelJob","path","query","f","_clearTimer","then","fromJSON","data","destroy","clearInterval","checkJobStatus","fetchResultData","from","returnFeatureCollection","returnM","returnZ","outSpatialReference","outSR","returnType","fetchResultImage","toJSON","fetchResultMapImageLayer","indexOf","substring","default","url","waitForJobCompletion","interval","signal","statusCallback","Promise","setInterval","prototype","json","read","type","write","d"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../request.js\";import\"../../core/has.js\";import{JSONMap as s}from\"../../core/jsonMap.js\";import{JSONSupport as r}from\"../../core/JSONSupport.js\";import{onAbort as o,createAbortError as i}from\"../../core/promiseUtils.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as c}from\"../../core/accessorSupport/decorators/subclass.js\";import{parseUrl as n}from\"../utils.js\";import u from\"../geoprocessor/GPOptions.js\";import{gpEncode as l,decode as b}from\"../geoprocessor/utils.js\";import j from\"./GPMessage.js\";var p;const h=new s({esriJobCancelled:\"job-cancelled\",esriJobCancelling:\"job-cancelling\",esriJobDeleted:\"job-deleted\",esriJobDeleting:\"job-deleting\",esriJobTimedOut:\"job-timed-out\",esriJobExecuting:\"job-executing\",esriJobFailed:\"job-failed\",esriJobNew:\"job-new\",esriJobSubmitted:\"job-submitted\",esriJobSucceeded:\"job-succeeded\",esriJobWaiting:\"job-waiting\"});let m=p=class extends r{constructor(e){super(e),this.jobId=null,this.jobStatus=null,this.messages=null,this.requestOptions=null,this.sourceUrl=null,this._timer=null}cancelJob(e){const{jobId:s,sourceUrl:r}=this,{path:o}=n(r),i={...this.requestOptions,...e,query:{f:\"json\"}};this._clearTimer();return t(`${o}/jobs/${s}/cancel`,i).then((e=>{const t=p.fromJSON(e.data);return this.messages=t.messages,this.jobStatus=t.jobStatus,this}))}destroy(){clearInterval(this._timer)}checkJobStatus(e){const{path:s}=n(this.sourceUrl),r={...this.requestOptions,...e,query:{f:\"json\"}},o=`${s}/jobs/${this.jobId}`;return t(o,r).then((({data:e})=>{const t=p.fromJSON(e);return this.messages=t.messages,this.jobStatus=t.jobStatus,this}))}fetchResultData(e,s,r){s=u.from(s||{});const{returnFeatureCollection:o,returnM:i,returnZ:a,outSpatialReference:c}=s,{path:j}=n(this.sourceUrl),p=l({returnFeatureCollection:o,returnM:i,returnZ:a,outSR:c,returnType:\"data\",f:\"json\"},null),h={...this.requestOptions,...r,query:p},m=`${j}/jobs/${this.jobId}/results/${e}`;return t(m,h).then((e=>b(e.data)))}fetchResultImage(e,s,r){const{path:o}=n(this.sourceUrl),i={...s.toJSON(),f:\"json\"},a=l(i),c={...this.requestOptions,...r,query:a},u=`${o}/jobs/${this.jobId}/results/${e}`;return t(u,c).then((e=>b(e.data)))}async fetchResultMapImageLayer(){const{path:e}=n(this.sourceUrl),t=e.indexOf(\"/GPServer/\"),s=`${e.substring(0,t)}/MapServer/jobs/${this.jobId}`;return new(0,(await import(\"../../layers/MapImageLayer.js\")).default)({url:s})}async waitForJobCompletion(e={}){const{interval:t=1e3,signal:s,statusCallback:r}=e;return new Promise(((e,a)=>{o(s,(()=>{this._clearTimer(),a(i())})),this._clearTimer();const c=setInterval((()=>{this._timer||a(i()),this.checkJobStatus(this.requestOptions).then((t=>{const{jobStatus:s}=t;switch(this.jobStatus=s,s){case\"job-succeeded\":this._clearTimer(),e(this);break;case\"job-submitted\":case\"job-executing\":case\"job-waiting\":case\"job-new\":r&&r(this);break;case\"job-cancelled\":case\"job-cancelling\":case\"job-deleted\":case\"job-deleting\":case\"job-timed-out\":case\"job-failed\":this._clearTimer(),a(this)}}))}),t);this._timer=c}))}_clearTimer(){this._timer&&(clearInterval(this._timer),this._timer=null)}};e([a()],m.prototype,\"jobId\",void 0),e([a({json:{read:h.read}})],m.prototype,\"jobStatus\",void 0),e([a({type:[j]})],m.prototype,\"messages\",void 0),e([a()],m.prototype,\"requestOptions\",void 0),e([a({json:{write:!0}})],m.prototype,\"sourceUrl\",void 0),m=p=e([c(\"esri.rest.support.JobInfo\")],m);var d=m;export default d;\n"]},"metadata":{},"sourceType":"module"}