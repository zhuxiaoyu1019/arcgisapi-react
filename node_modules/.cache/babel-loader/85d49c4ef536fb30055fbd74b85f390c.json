{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { isSome as e, isNone as s } from \"../../../../core/maybe.js\";\nimport { d as r } from \"../../../../chunks/mat4.js\";\nimport { c as t } from \"../../../../chunks/mat4f64.js\";\nimport { VisualElement as o } from \"./VisualElement.js\";\nimport { Object3D as i } from \"../../webgl-engine/lib/Object3D.js\";\nimport { WebGLLayer as a } from \"../../webgl-engine/lib/WebGLLayer.js\";\n\nclass c extends o {\n  constructor(e) {\n    super(e.view), this._resources = null, this._transform = t();\n  }\n\n  get object() {\n    return e(this._resources) ? this._resources.object : null;\n  }\n\n  get transform() {\n    return this._transform;\n  }\n\n  set transform(s) {\n    r(this._transform, s), e(this._resources) && (this._resources.object.transformation = this._transform);\n  }\n\n  recreate() {\n    this.attached && this.createResources();\n  }\n\n  recreateGeometry() {\n    if (s(this._resources)) return;\n    const e = this._resources.object,\n          r = this.view._stage;\n    r.removeMany(e.geometries), e.removeAllGeometries(), this.createGeometries(e), this.visible || e.setVisible(this.visible), r.addMany(e.geometries);\n  }\n\n  createResources() {\n    this.destroyResources();\n    const e = this.view._stage;\n    if (!e) return;\n    const s = new a({\n      isPickable: !1,\n      updatePolicy: 1\n    });\n    e.add(s);\n    const r = new i({\n      castShadow: !1\n    });\n    r.transformation = this._transform, this.createExternalResources(), this.createGeometries(r), e.addMany(r.geometries), this.forEachExternalMaterial(s => e.add(s)), e.add(r), s.add(r), this.visible || r.setVisible(!1), this._resources = {\n      layer: s,\n      object: r\n    };\n  }\n\n  destroyResources() {\n    const e = this.view._stage;\n    !s(this._resources) && e && (e.remove(this._resources.object), e.remove(this._resources.layer), this.forEachExternalMaterial(s => {\n      e.remove(s), s.dispose();\n    }), e.removeMany(this._resources.object.geometries), this._resources.object.dispose(), this.destroyExternalResources(), this._resources = null);\n  }\n\n  updateVisibility(e) {\n    s(this._resources) || this._resources.object.setVisible(e);\n  }\n\n}\n\nexport { c as Object3DVisualElement };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js"],"names":["isSome","e","isNone","s","d","r","c","t","VisualElement","o","Object3D","i","WebGLLayer","a","constructor","view","_resources","_transform","object","transform","transformation","recreate","attached","createResources","recreateGeometry","_stage","removeMany","geometries","removeAllGeometries","createGeometries","visible","setVisible","addMany","destroyResources","isPickable","updatePolicy","add","castShadow","createExternalResources","forEachExternalMaterial","layer","remove","dispose","destroyExternalResources","updateVisibility","Object3DVisualElement"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as s}from\"../../../../core/maybe.js\";import{d as r}from\"../../../../chunks/mat4.js\";import{c as t}from\"../../../../chunks/mat4f64.js\";import{VisualElement as o}from\"./VisualElement.js\";import{Object3D as i}from\"../../webgl-engine/lib/Object3D.js\";import{WebGLLayer as a}from\"../../webgl-engine/lib/WebGLLayer.js\";class c extends o{constructor(e){super(e.view),this._resources=null,this._transform=t()}get object(){return e(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(s){r(this._transform,s),e(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(s(this._resources))return;const e=this._resources.object,r=this.view._stage;r.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),r.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new a({isPickable:!1,updatePolicy:1});e.add(s);const r=new i({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),this.visible||r.setVisible(!1),this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;!s(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((s=>{e.remove(s),s.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){s(this._resources)||this._resources.object.setVisible(e)}}export{c as Object3DVisualElement};\n"]},"metadata":{},"sourceType":"module"}