{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../request.js\";\nimport o from \"../../core/Error.js\";\nimport { isSome as r } from \"../../core/maybe.js\";\n\nasync function n(n, t, s, a, i, d) {\n  let l = null;\n\n  if (r(s)) {\n    const o = `${n}/nodepages/`,\n          t = o + Math.floor(s.rootIndex / s.nodesPerPage);\n\n    try {\n      return {\n        type: \"page\",\n        rootPage: (await e(t, {\n          query: {\n            f: \"json\",\n            token: a\n          },\n          responseType: \"json\",\n          signal: d\n        })).data,\n        rootIndex: s.rootIndex,\n        pageSize: s.nodesPerPage,\n        lodMetric: s.lodSelectionMetricType,\n        urlPrefix: o\n      };\n    } catch (f) {\n      r(i) && i.warn(\"#fetchIndexInfo()\", \"Failed to load root node page. Falling back to node documents.\", t, f), l = f;\n    }\n  }\n\n  if (!t) return null;\n  const p = `${n}/nodes/`,\n        c = p + (t && t.split(\"/\").pop());\n\n  try {\n    return {\n      type: \"node\",\n      rootNode: (await e(c, {\n        query: {\n          f: \"json\",\n          token: a\n        },\n        responseType: \"json\",\n        signal: d\n      })).data,\n      urlPrefix: p\n    };\n  } catch (f) {\n    throw new o(\"sceneservice:root-node-missing\", \"Root node missing.\", {\n      pageError: l,\n      nodeError: f,\n      url: c\n    });\n  }\n}\n\nexport { n as fetchIndexInfo };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/layers/support/I3SIndexInfo.js"],"names":["e","o","isSome","r","n","t","s","a","i","d","l","Math","floor","rootIndex","nodesPerPage","type","rootPage","query","f","token","responseType","signal","data","pageSize","lodMetric","lodSelectionMetricType","urlPrefix","warn","p","c","split","pop","rootNode","pageError","nodeError","url","fetchIndexInfo"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAa,kBAAb;AAAgC,OAAOC,CAAP,MAAa,qBAAb;AAAmC,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,qBAAvB;;AAA6C,eAAeC,CAAf,CAAiBA,CAAjB,EAAmBC,CAAnB,EAAqBC,CAArB,EAAuBC,CAAvB,EAAyBC,CAAzB,EAA2BC,CAA3B,EAA6B;AAAC,MAAIC,CAAC,GAAC,IAAN;;AAAW,MAAGP,CAAC,CAACG,CAAD,CAAJ,EAAQ;AAAC,UAAML,CAAC,GAAE,GAAEG,CAAE,aAAb;AAAA,UAA0BC,CAAC,GAACJ,CAAC,GAACU,IAAI,CAACC,KAAL,CAAWN,CAAC,CAACO,SAAF,GAAYP,CAAC,CAACQ,YAAzB,CAA9B;;AAAqE,QAAG;AAAC,aAAM;AAACC,QAAAA,IAAI,EAAC,MAAN;AAAaC,QAAAA,QAAQ,EAAC,CAAC,MAAMhB,CAAC,CAACK,CAAD,EAAG;AAACY,UAAAA,KAAK,EAAC;AAACC,YAAAA,CAAC,EAAC,MAAH;AAAUC,YAAAA,KAAK,EAACZ;AAAhB,WAAP;AAA0Ba,UAAAA,YAAY,EAAC,MAAvC;AAA8CC,UAAAA,MAAM,EAACZ;AAArD,SAAH,CAAR,EAAqEa,IAA3F;AAAgGT,QAAAA,SAAS,EAACP,CAAC,CAACO,SAA5G;AAAsHU,QAAAA,QAAQ,EAACjB,CAAC,CAACQ,YAAjI;AAA8IU,QAAAA,SAAS,EAAClB,CAAC,CAACmB,sBAA1J;AAAiLC,QAAAA,SAAS,EAACzB;AAA3L,OAAN;AAAoM,KAAxM,CAAwM,OAAMiB,CAAN,EAAQ;AAACf,MAAAA,CAAC,CAACK,CAAD,CAAD,IAAMA,CAAC,CAACmB,IAAF,CAAO,mBAAP,EAA2B,gEAA3B,EAA4FtB,CAA5F,EAA8Fa,CAA9F,CAAN,EAAuGR,CAAC,GAACQ,CAAzG;AAA2G;AAAC;;AAAA,MAAG,CAACb,CAAJ,EAAM,OAAO,IAAP;AAAY,QAAMuB,CAAC,GAAE,GAAExB,CAAE,SAAb;AAAA,QAAsByB,CAAC,GAACD,CAAC,IAAEvB,CAAC,IAAEA,CAAC,CAACyB,KAAF,CAAQ,GAAR,EAAaC,GAAb,EAAL,CAAzB;;AAAkD,MAAG;AAAC,WAAM;AAAChB,MAAAA,IAAI,EAAC,MAAN;AAAaiB,MAAAA,QAAQ,EAAC,CAAC,MAAMhC,CAAC,CAAC6B,CAAD,EAAG;AAACZ,QAAAA,KAAK,EAAC;AAACC,UAAAA,CAAC,EAAC,MAAH;AAAUC,UAAAA,KAAK,EAACZ;AAAhB,SAAP;AAA0Ba,QAAAA,YAAY,EAAC,MAAvC;AAA8CC,QAAAA,MAAM,EAACZ;AAArD,OAAH,CAAR,EAAqEa,IAA3F;AAAgGI,MAAAA,SAAS,EAACE;AAA1G,KAAN;AAAmH,GAAvH,CAAuH,OAAMV,CAAN,EAAQ;AAAC,UAAM,IAAIjB,CAAJ,CAAM,gCAAN,EAAuC,oBAAvC,EAA4D;AAACgC,MAAAA,SAAS,EAACvB,CAAX;AAAawB,MAAAA,SAAS,EAAChB,CAAvB;AAAyBiB,MAAAA,GAAG,EAACN;AAA7B,KAA5D,CAAN;AAAmG;AAAC;;AAAA,SAAOzB,CAAC,IAAIgC,cAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import o from\"../../core/Error.js\";import{isSome as r}from\"../../core/maybe.js\";async function n(n,t,s,a,i,d){let l=null;if(r(s)){const o=`${n}/nodepages/`,t=o+Math.floor(s.rootIndex/s.nodesPerPage);try{return{type:\"page\",rootPage:(await e(t,{query:{f:\"json\",token:a},responseType:\"json\",signal:d})).data,rootIndex:s.rootIndex,pageSize:s.nodesPerPage,lodMetric:s.lodSelectionMetricType,urlPrefix:o}}catch(f){r(i)&&i.warn(\"#fetchIndexInfo()\",\"Failed to load root node page. Falling back to node documents.\",t,f),l=f}}if(!t)return null;const p=`${n}/nodes/`,c=p+(t&&t.split(\"/\").pop());try{return{type:\"node\",rootNode:(await e(c,{query:{f:\"json\",token:a},responseType:\"json\",signal:d})).data,urlPrefix:p}}catch(f){throw new o(\"sceneservice:root-node-missing\",\"Root node missing.\",{pageError:l,nodeError:f,url:c})}}export{n as fetchIndexInfo};\n"]},"metadata":{},"sourceType":"module"}