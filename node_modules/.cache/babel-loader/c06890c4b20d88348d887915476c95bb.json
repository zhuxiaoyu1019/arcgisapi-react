{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { e as t } from \"../../../../../../chunks/earcut.js\";\nimport o from \"../../../../../../layers/graphics/OptimizedGeometry.js\";\nimport { TILE_SIZE as e } from \"../../definitions.js\";\nimport { TileClipper as n } from \"../../TileClipper.js\";\nimport { bufcut as r } from \"../bufcut.js\";\nimport s from \"../Tesselator.js\";\nconst l = 1e-5,\n      c = new s(),\n      i = new n(0, 0, 0, 1, 0),\n      f = new n(0, 0, 0, 1, 0);\n\nfunction u(t, o, e) {\n  let n = 0;\n\n  for (let r = 1; r < e; r++) {\n    const e = t[2 * (o + r - 1)],\n          s = t[2 * (o + r - 1) + 1];\n    n += (t[2 * (o + r)] - e) * (t[2 * (o + r) + 1] + s);\n  }\n\n  return n;\n}\n\nfunction h(t, o, e, n, r) {\n  let s = 0;\n  const l = 2;\n\n  for (let c = e; c < n; c += 3) {\n    const e = (t.getValue(c) - r) * l,\n          n = (t.getValue(c + 1) - r) * l,\n          i = (t.getValue(c + 2) - r) * l;\n    s += Math.abs((o[e] - o[i]) * (o[n + 1] - o[e + 1]) - (o[e] - o[n]) * (o[i + 1] - o[e + 1]));\n  }\n\n  return s;\n}\n\nfunction d(t, o) {\n  const {\n    coords: e,\n    lengths: n,\n    hasIndeterminateRingOrder: s\n  } = o,\n        c = t.indexWriter(),\n        i = t.vertexCount();\n  if (s) return !1;\n  const f = c.length;\n  let d = 0;\n\n  for (let g = 0; g < n.length;) {\n    let t = g,\n        o = n[g],\n        s = u(e, d, o);\n    const a = [];\n\n    for (; ++t < n.length;) {\n      const r = n[t],\n            l = u(e, d + o, r);\n      if (!(l > 0)) break;\n      s += l, a.push(d + o), o += r;\n    }\n\n    const p = c.length;\n    r(c, e, d, d + o, a, 2, i);\n    const m = h(c, e, p, c.length, i),\n          x = Math.abs(s);\n    if (Math.abs((m - x) / Math.max(1e-7, x)) > l) return c.seek(f), !1;\n    g = t, d += o;\n  }\n\n  return !0;\n}\n\nfunction g(o, e, n) {\n  const {\n    coords: r,\n    lengths: s,\n    hasIndeterminateRingOrder: l\n  } = e;\n  if (l) return !1;\n  let c = 0;\n\n  for (let i = 0; i < s.length;) {\n    let l = i,\n        f = s[i];\n    const h = [];\n\n    for (; ++l < s.length;) {\n      const t = s[l];\n      if (!(u(r, c + f, t) > 0)) break;\n      h.push(c + f - c), f += t;\n    }\n\n    const d = c + f,\n          g = e.coords.slice(2 * c, 2 * d),\n          a = t(g, h, 2);\n\n    for (const t of a) o.push(t + n + c);\n\n    i = l, c += f;\n  }\n\n  return !0;\n}\n\nfunction a(t, o) {\n  const e = [],\n        n = [],\n        r = t.indexWriter(),\n        s = t.vertexCount(),\n        {\n    coords: l,\n    lengths: i\n  } = o;\n  c.beginPolygon(e, n);\n  let f = 0;\n\n  for (let u = 0; u < i.length; u++) {\n    const t = o.lengths[u];\n    c.beginContour();\n\n    for (let o = 0; o < t; o++) {\n      const t = [l[2 * (f + o)], l[2 * (f + o) + 1], 0];\n      c.addVertex(t, t);\n    }\n\n    c.endContour(), f += t;\n  }\n\n  c.endPolygon();\n\n  for (let c = 0; c < n.length; c++) r.push(n[c] + s);\n\n  return e;\n}\n\nfunction p(t, o, e, n, r, s, l, c) {\n  const i = ((t - r) * (s - c) - (o - c) * (r - l)) / ((t - e) * (s - c) - (o - n) * (r - l));\n  if (i < 0 || i > 1) return null;\n  return {\n    x: Math.round(t + i * (e - t)),\n    y: Math.round(o + i * (n - o))\n  };\n}\n\nfunction m(t, o, e) {\n  let n = 0;\n\n  for (let r = 0; r < t.lengths.length; r++) {\n    const s = t.lengths[r];\n\n    for (let r = 0; r < s; r++) {\n      const s = t.coords[2 * (r + n)],\n            l = t.coords[2 * (r + n) + 1];\n      if (s < o || s > e || l < o || l > e) return !0;\n    }\n\n    n += s;\n  }\n\n  return !1;\n}\n\nfunction x(t, n) {\n  if (!m(t, -128, e + 128)) return t;\n  i.setPixelMargin(n), i.reset(3);\n  let r = 0;\n\n  for (let o = 0; o < t.lengths.length; o++) {\n    const e = t.lengths[o];\n    let n = t.coords[2 * (0 + r)],\n        s = t.coords[2 * (0 + r) + 1];\n    i.moveTo(n, s);\n\n    for (let o = 1; o < e; o++) n = t.coords[2 * (o + r)], s = t.coords[2 * (o + r) + 1], i.lineTo(n, s);\n\n    i.close(), r += e;\n  }\n\n  const s = i.result(!1);\n  if (!s) return null;\n  const l = [],\n        c = [];\n\n  for (const o of s) {\n    let t = 0;\n\n    for (const e of o) c.push(e.x), c.push(e.y), t++;\n\n    l.push(t);\n  }\n\n  return new o(l, c);\n}\n\nfunction y(t, o) {\n  f.setPixelMargin(o);\n  const n = f,\n        r = -o,\n        s = e + o;\n  let l = [],\n      c = !1,\n      i = 0;\n\n  for (; i < t.length;) {\n    const o = [],\n          e = t[i];\n    n.reset(2);\n    let [f, u] = e[0];\n    if (c) n.moveTo(f, u);else {\n      if (f < r || f > s || u < r || u > s) {\n        c = !0;\n        continue;\n      }\n\n      o.push({\n        x: f,\n        y: u\n      });\n    }\n    let h = !1;\n    const d = e.length;\n\n    for (let t = 1; t < d; ++t) if (f += e[t][0], u += e[t][1], c) n.lineTo(f, u);else {\n      if (f < r || f > s || u < r || u > s) {\n        h = !0;\n        break;\n      }\n\n      o.push({\n        x: f,\n        y: u\n      });\n    }\n\n    if (h) c = !0;else {\n      if (c) {\n        const t = n.resultWithStarts();\n        if (t) for (const o of t) l.push(o);\n      } else l.push({\n        line: o,\n        start: 0\n      });\n\n      i++, c = !1;\n    }\n  }\n\n  return l = l.filter(t => t.line.length > 1), 0 === l.length ? null : l;\n}\n\nfunction b(t, o, e = 0) {\n  const n = -e,\n        r = o + e;\n  let s = 0,\n      l = 0,\n      c = 0;\n\n  for (let i = 0; i < t.lengths.length; i++) {\n    const o = t.lengths[i],\n          e = c + o;\n    let f = 0,\n        u = null;\n\n    for (; s !== e;) {\n      let o = t.coords[2 * s],\n          c = t.coords[2 * s++ + 1],\n          i = o < n || o >= r || c < n || c >= r;\n      const h = i;\n\n      for (; s !== e && i === h;) i || (t.coords[2 * l] = o, t.coords[2 * l++ + 1] = c, f++), o = t.coords[2 * s], c = t.coords[2 * s++ + 1], i = o < n || o >= r || c < n || c >= r;\n\n      if (s === e) {\n        i ? u && (t.coords[2 * l] = u.x, t.coords[2 * l++ + 1] = u.y, f++) : (t.coords[2 * l] = o, t.coords[2 * l++ + 1] = c, f++);\n        continue;\n      }\n\n      const d = t.coords[2 * (s - 2)],\n            g = t.coords[2 * (s - 2) + 1],\n            a = p(d, g, o, c, n, n, r, n) || p(d, g, o, c, r, n, r, r) || p(d, g, o, c, r, r, n, r) || p(d, g, o, c, n, n, n, r);\n      a && (t.coords[2 * l] = a.x, t.coords[2 * l++ + 1] = a.y, f++, u || (u = a)), i || (t.coords[2 * l] = o, t.coords[2 * l++ + 1] = c, f++);\n    }\n\n    t.lengths[i] = f, c += o;\n  }\n}\n\ni.setExtent(e), f.setExtent(e);\nexport { u as area, b as clip, y as clipLinesMarshall, x as clipMarshall, h as triangleArea, d as triangulate, g as triangulateEarcut, a as triangulateLibtess };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/templateUtils.js"],"names":["e","t","o","TILE_SIZE","TileClipper","n","bufcut","r","s","l","c","i","f","u","h","getValue","Math","abs","d","coords","lengths","hasIndeterminateRingOrder","indexWriter","vertexCount","length","g","a","push","p","m","x","max","seek","slice","beginPolygon","beginContour","addVertex","endContour","endPolygon","round","y","setPixelMargin","reset","moveTo","lineTo","close","result","resultWithStarts","line","start","filter","b","setExtent","area","clip","clipLinesMarshall","clipMarshall","triangleArea","triangulate","triangulateEarcut","triangulateLibtess"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{e as t}from\"../../../../../../chunks/earcut.js\";import o from\"../../../../../../layers/graphics/OptimizedGeometry.js\";import{TILE_SIZE as e}from\"../../definitions.js\";import{TileClipper as n}from\"../../TileClipper.js\";import{bufcut as r}from\"../bufcut.js\";import s from\"../Tesselator.js\";const l=1e-5,c=new s,i=new n(0,0,0,1,0),f=new n(0,0,0,1,0);function u(t,o,e){let n=0;for(let r=1;r<e;r++){const e=t[2*(o+r-1)],s=t[2*(o+r-1)+1];n+=(t[2*(o+r)]-e)*(t[2*(o+r)+1]+s)}return n}function h(t,o,e,n,r){let s=0;const l=2;for(let c=e;c<n;c+=3){const e=(t.getValue(c)-r)*l,n=(t.getValue(c+1)-r)*l,i=(t.getValue(c+2)-r)*l;s+=Math.abs((o[e]-o[i])*(o[n+1]-o[e+1])-(o[e]-o[n])*(o[i+1]-o[e+1]))}return s}function d(t,o){const{coords:e,lengths:n,hasIndeterminateRingOrder:s}=o,c=t.indexWriter(),i=t.vertexCount();if(s)return!1;const f=c.length;let d=0;for(let g=0;g<n.length;){let t=g,o=n[g],s=u(e,d,o);const a=[];for(;++t<n.length;){const r=n[t],l=u(e,d+o,r);if(!(l>0))break;s+=l,a.push(d+o),o+=r}const p=c.length;r(c,e,d,d+o,a,2,i);const m=h(c,e,p,c.length,i),x=Math.abs(s);if(Math.abs((m-x)/Math.max(1e-7,x))>l)return c.seek(f),!1;g=t,d+=o}return!0}function g(o,e,n){const{coords:r,lengths:s,hasIndeterminateRingOrder:l}=e;if(l)return!1;let c=0;for(let i=0;i<s.length;){let l=i,f=s[i];const h=[];for(;++l<s.length;){const t=s[l];if(!(u(r,c+f,t)>0))break;h.push(c+f-c),f+=t}const d=c+f,g=e.coords.slice(2*c,2*d),a=t(g,h,2);for(const t of a)o.push(t+n+c);i=l,c+=f}return!0}function a(t,o){const e=[],n=[],r=t.indexWriter(),s=t.vertexCount(),{coords:l,lengths:i}=o;c.beginPolygon(e,n);let f=0;for(let u=0;u<i.length;u++){const t=o.lengths[u];c.beginContour();for(let o=0;o<t;o++){const t=[l[2*(f+o)],l[2*(f+o)+1],0];c.addVertex(t,t)}c.endContour(),f+=t}c.endPolygon();for(let c=0;c<n.length;c++)r.push(n[c]+s);return e}function p(t,o,e,n,r,s,l,c){const i=((t-r)*(s-c)-(o-c)*(r-l))/((t-e)*(s-c)-(o-n)*(r-l));if(i<0||i>1)return null;return{x:Math.round(t+i*(e-t)),y:Math.round(o+i*(n-o))}}function m(t,o,e){let n=0;for(let r=0;r<t.lengths.length;r++){const s=t.lengths[r];for(let r=0;r<s;r++){const s=t.coords[2*(r+n)],l=t.coords[2*(r+n)+1];if(s<o||s>e||l<o||l>e)return!0}n+=s}return!1}function x(t,n){if(!m(t,-128,e+128))return t;i.setPixelMargin(n),i.reset(3);let r=0;for(let o=0;o<t.lengths.length;o++){const e=t.lengths[o];let n=t.coords[2*(0+r)],s=t.coords[2*(0+r)+1];i.moveTo(n,s);for(let o=1;o<e;o++)n=t.coords[2*(o+r)],s=t.coords[2*(o+r)+1],i.lineTo(n,s);i.close(),r+=e}const s=i.result(!1);if(!s)return null;const l=[],c=[];for(const o of s){let t=0;for(const e of o)c.push(e.x),c.push(e.y),t++;l.push(t)}return new o(l,c)}function y(t,o){f.setPixelMargin(o);const n=f,r=-o,s=e+o;let l=[],c=!1,i=0;for(;i<t.length;){const o=[],e=t[i];n.reset(2);let[f,u]=e[0];if(c)n.moveTo(f,u);else{if(f<r||f>s||u<r||u>s){c=!0;continue}o.push({x:f,y:u})}let h=!1;const d=e.length;for(let t=1;t<d;++t)if(f+=e[t][0],u+=e[t][1],c)n.lineTo(f,u);else{if(f<r||f>s||u<r||u>s){h=!0;break}o.push({x:f,y:u})}if(h)c=!0;else{if(c){const t=n.resultWithStarts();if(t)for(const o of t)l.push(o)}else l.push({line:o,start:0});i++,c=!1}}return l=l.filter((t=>t.line.length>1)),0===l.length?null:l}function b(t,o,e=0){const n=-e,r=o+e;let s=0,l=0,c=0;for(let i=0;i<t.lengths.length;i++){const o=t.lengths[i],e=c+o;let f=0,u=null;for(;s!==e;){let o=t.coords[2*s],c=t.coords[2*s+++1],i=o<n||o>=r||c<n||c>=r;const h=i;for(;s!==e&&i===h;)i||(t.coords[2*l]=o,t.coords[2*l+++1]=c,f++),o=t.coords[2*s],c=t.coords[2*s+++1],i=o<n||o>=r||c<n||c>=r;if(s===e){i?u&&(t.coords[2*l]=u.x,t.coords[2*l+++1]=u.y,f++):(t.coords[2*l]=o,t.coords[2*l+++1]=c,f++);continue}const d=t.coords[2*(s-2)],g=t.coords[2*(s-2)+1],a=p(d,g,o,c,n,n,r,n)||p(d,g,o,c,r,n,r,r)||p(d,g,o,c,r,r,n,r)||p(d,g,o,c,n,n,n,r);a&&(t.coords[2*l]=a.x,t.coords[2*l+++1]=a.y,f++,u||(u=a)),i||(t.coords[2*l]=o,t.coords[2*l+++1]=c,f++)}t.lengths[i]=f,c+=o}}i.setExtent(e),f.setExtent(e);export{u as area,b as clip,y as clipLinesMarshall,x as clipMarshall,h as triangleArea,d as triangulate,g as triangulateEarcut,a as triangulateLibtess};\n"]},"metadata":{},"sourceType":"module"}