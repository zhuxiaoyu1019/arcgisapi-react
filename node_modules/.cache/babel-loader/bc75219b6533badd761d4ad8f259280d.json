{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../../../chunks/tslib.es6.js\";\nimport i from \"../../../../../core/has.js\";\nimport { Milliseconds as e } from \"../../../../../core/time.js\";\nimport \"../../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../../core/Logger.js\";\nimport { subclass as r } from \"../../../../../core/accessorSupport/decorators/subclass.js\";\nimport { g as s, l as o, f as a, a as n, b as m, h as c, n as h } from \"../../../../../chunks/vec3.js\";\nimport { c as p } from \"../../../../../chunks/vec3f64.js\";\nimport { getReferenceEllipsoid as l } from \"../../../../../geometry/projectionEllipsoid.js\";\nimport { c as y } from \"../../../../../chunks/sphere.js\";\nimport { applyAll as f } from \"../../../camera/constraintUtils.js\";\nimport { PointToPointAnimationController as g } from \"../PointToPointAnimationController.js\";\nimport { decideNavigationMode as u, NavigationMode as w, panToPosition as d } from \"../../utils/navigationUtils.js\";\nimport { fromScreenAtEye as j } from \"../../../support/geometryUtils/ray.js\";\nimport { intersectScreen as C } from \"../../../support/geometryUtils/sphere.js\";\nimport D from \"../../../webgl-engine/lib/Camera.js\";\nimport { Intersector as v } from \"../../../webgl-engine/lib/Intersector.js\";\nimport { outExpo as R } from \"../../../../animation/easing.js\";\nimport { applySurfaceCollisionConstraint as b } from \"../../../camera/constraintUtils/surfaceCollision.js\";\nconst S = .6,\n      z = 4,\n      M = 12,\n      L = 60,\n      V = 20;\nlet O = class extends g {\n  constructor() {\n    super(...arguments), this.zoomLocation = p(), this.tmpCamera = new D(), this.tmpViewDir = p(), this.tmpRayDir = {\n      origin: p(),\n      direction: p()\n    }, this.targetOnSphere = p(), this.tmpCenter = p(), this.constraintOptions = {\n      selection: 7,\n      interactionType: 1,\n      interactionFactor: null,\n      interactionStartCamera: new D(),\n      interactionDirection: null,\n      tiltMode: 0\n    }, this.sphere = y();\n  }\n\n  initialize() {\n    this.intersector = new v(this.view.state.viewingMode);\n  }\n\n  zoomStep(t, i) {\n    if (!this.active) return;\n    const e = this.view.state,\n          {\n      interactionStartCamera: r\n    } = this.constraintOptions;\n    this.animation.finished ? r.copyFrom(e.camera) : this.animation.cameraAt(1, r);\n    let o = !1,\n        a = !1;\n    this.intersectionHelper.intersectScreen(i, this.zoomLocation) && (o = t > 0, a = !0), this.tmpCamera.copyFrom(e.camera), o ? this.intersectionHelper.intersectRay(this.tmpCamera.ray, this.intersector, this.tmpCenter) && (this.tmpCamera.center = this.tmpCenter) : this.intersectionHelper.intersectRay(this.tmpCamera.ray, this.intersector, this.zoomLocation) ? this.tmpCamera.center = this.zoomLocation : s(this.zoomLocation, this.tmpCamera.center), this.updateCamera(this.tmpCamera, t, this.zoomLocation, i, a), this.begin(this.tmpCamera);\n  }\n\n  animationSettings() {\n    return {\n      apex: null,\n      duration: e(600),\n      easing: R\n    };\n  }\n\n  updateCamera(t, e, r, s, p) {\n    const y = l(this.view.spatialReference);\n\n    if (u(t, s, p, y) === w.Horizontal || i(\"disable-feature:context-navigation\")) {\n      let i = S ** e;\n      this.sphere[3] = o(r), a(this.tmpViewDir, t.center, t.eye);\n      const h = o(this.tmpViewDir);\n      let p = h * i;\n      if (i <= 1 && p < z && (p = z, i = p / h), Math.abs(h - p) < 1e-6) return;\n      const l = o(t.center);\n\n      if (this.sphere[3] !== l) {\n        const e = this.sphere[3] + i * (l - this.sphere[3]);\n        t.center = n(x, t.center, e / l);\n      }\n\n      n(this.tmpViewDir, this.tmpViewDir, -i), t.eye = m(x, t.center, this.tmpViewDir), f(this.view, t, this.constraintOptions), c(r, t.center) > 1e-12 && C(this.sphere, t, s, this.targetOnSphere) && d(this.sphere, t, r, this.targetOnSphere, this.view.camera.heading, this.view.camera.tilt, !0);\n    } else {\n      let i = S ** Math.abs(e);\n      const o = e > 0 ? 1 : -1;\n      let a;\n      j(t, s, this.tmpRayDir), h(this.tmpRayDir.direction, this.tmpRayDir.direction), this.view.camera.position.hasZ && (a = Math.abs(this.view.camera.position.z));\n      let c = Math.max(M * a, V);\n\n      const p = this.view._stage.renderView.getMinimalDepthForArea(s[0], s[1], this.view.state.camera, L);\n\n      c = c > p ? p : c, n(this.tmpRayDir.direction, this.tmpRayDir.direction, c), m(r, this.tmpRayDir.origin, this.tmpRayDir.direction);\n      let l = c * i;\n      if (e > 0 && l < z && (l = z, i = l / c), Math.abs(c - l) < 1e-6) return;\n      n(this.tmpRayDir.direction, this.tmpRayDir.direction, o * (1 - i)), t.eye = m(x, t.eye, this.tmpRayDir.direction), t.center = m(x, t.center, this.tmpRayDir.direction);\n    }\n\n    b(this.view, t);\n  }\n\n};\nO = t([r(\"esri.views.3d.state.controllers.global.ZoomStepController\")], O);\nconst x = p();\nexport { O as ZoomStepController };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/state/controllers/global/ZoomStepController.js"],"names":["_","t","i","Milliseconds","e","subclass","r","g","s","l","o","f","a","n","b","m","h","c","p","getReferenceEllipsoid","y","applyAll","PointToPointAnimationController","decideNavigationMode","u","NavigationMode","w","panToPosition","d","fromScreenAtEye","j","intersectScreen","C","D","Intersector","v","outExpo","R","applySurfaceCollisionConstraint","S","z","M","L","V","O","constructor","arguments","zoomLocation","tmpCamera","tmpViewDir","tmpRayDir","origin","direction","targetOnSphere","tmpCenter","constraintOptions","selection","interactionType","interactionFactor","interactionStartCamera","interactionDirection","tiltMode","sphere","initialize","intersector","view","state","viewingMode","zoomStep","active","animation","finished","copyFrom","camera","cameraAt","intersectionHelper","intersectRay","ray","center","updateCamera","begin","animationSettings","apex","duration","easing","spatialReference","Horizontal","eye","Math","abs","x","heading","tilt","position","hasZ","max","_stage","renderView","getMinimalDepthForArea","ZoomStepController"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../../chunks/tslib.es6.js\";import i from\"../../../../../core/has.js\";import{Milliseconds as e}from\"../../../../../core/time.js\";import\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as r}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{g as s,l as o,f as a,a as n,b as m,h as c,n as h}from\"../../../../../chunks/vec3.js\";import{c as p}from\"../../../../../chunks/vec3f64.js\";import{getReferenceEllipsoid as l}from\"../../../../../geometry/projectionEllipsoid.js\";import{c as y}from\"../../../../../chunks/sphere.js\";import{applyAll as f}from\"../../../camera/constraintUtils.js\";import{PointToPointAnimationController as g}from\"../PointToPointAnimationController.js\";import{decideNavigationMode as u,NavigationMode as w,panToPosition as d}from\"../../utils/navigationUtils.js\";import{fromScreenAtEye as j}from\"../../../support/geometryUtils/ray.js\";import{intersectScreen as C}from\"../../../support/geometryUtils/sphere.js\";import D from\"../../../webgl-engine/lib/Camera.js\";import{Intersector as v}from\"../../../webgl-engine/lib/Intersector.js\";import{outExpo as R}from\"../../../../animation/easing.js\";import{applySurfaceCollisionConstraint as b}from\"../../../camera/constraintUtils/surfaceCollision.js\";const S=.6,z=4,M=12,L=60,V=20;let O=class extends g{constructor(){super(...arguments),this.zoomLocation=p(),this.tmpCamera=new D,this.tmpViewDir=p(),this.tmpRayDir={origin:p(),direction:p()},this.targetOnSphere=p(),this.tmpCenter=p(),this.constraintOptions={selection:7,interactionType:1,interactionFactor:null,interactionStartCamera:new D,interactionDirection:null,tiltMode:0},this.sphere=y()}initialize(){this.intersector=new v(this.view.state.viewingMode)}zoomStep(t,i){if(!this.active)return;const e=this.view.state,{interactionStartCamera:r}=this.constraintOptions;this.animation.finished?r.copyFrom(e.camera):this.animation.cameraAt(1,r);let o=!1,a=!1;this.intersectionHelper.intersectScreen(i,this.zoomLocation)&&(o=t>0,a=!0),this.tmpCamera.copyFrom(e.camera),o?this.intersectionHelper.intersectRay(this.tmpCamera.ray,this.intersector,this.tmpCenter)&&(this.tmpCamera.center=this.tmpCenter):this.intersectionHelper.intersectRay(this.tmpCamera.ray,this.intersector,this.zoomLocation)?this.tmpCamera.center=this.zoomLocation:s(this.zoomLocation,this.tmpCamera.center),this.updateCamera(this.tmpCamera,t,this.zoomLocation,i,a),this.begin(this.tmpCamera)}animationSettings(){return{apex:null,duration:e(600),easing:R}}updateCamera(t,e,r,s,p){const y=l(this.view.spatialReference);if(u(t,s,p,y)===w.Horizontal||i(\"disable-feature:context-navigation\")){let i=S**e;this.sphere[3]=o(r),a(this.tmpViewDir,t.center,t.eye);const h=o(this.tmpViewDir);let p=h*i;if(i<=1&&p<z&&(p=z,i=p/h),Math.abs(h-p)<1e-6)return;const l=o(t.center);if(this.sphere[3]!==l){const e=this.sphere[3]+i*(l-this.sphere[3]);t.center=n(x,t.center,e/l)}n(this.tmpViewDir,this.tmpViewDir,-i),t.eye=m(x,t.center,this.tmpViewDir),f(this.view,t,this.constraintOptions),c(r,t.center)>1e-12&&C(this.sphere,t,s,this.targetOnSphere)&&d(this.sphere,t,r,this.targetOnSphere,this.view.camera.heading,this.view.camera.tilt,!0)}else{let i=S**Math.abs(e);const o=e>0?1:-1;let a;j(t,s,this.tmpRayDir),h(this.tmpRayDir.direction,this.tmpRayDir.direction),this.view.camera.position.hasZ&&(a=Math.abs(this.view.camera.position.z));let c=Math.max(M*a,V);const p=this.view._stage.renderView.getMinimalDepthForArea(s[0],s[1],this.view.state.camera,L);c=c>p?p:c,n(this.tmpRayDir.direction,this.tmpRayDir.direction,c),m(r,this.tmpRayDir.origin,this.tmpRayDir.direction);let l=c*i;if(e>0&&l<z&&(l=z,i=l/c),Math.abs(c-l)<1e-6)return;n(this.tmpRayDir.direction,this.tmpRayDir.direction,o*(1-i)),t.eye=m(x,t.eye,this.tmpRayDir.direction),t.center=m(x,t.center,this.tmpRayDir.direction)}b(this.view,t)}};O=t([r(\"esri.views.3d.state.controllers.global.ZoomStepController\")],O);const x=p();export{O as ZoomStepController};\n"]},"metadata":{},"sourceType":"module"}