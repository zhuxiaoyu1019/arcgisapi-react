{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport \"../../../../geometry.js\";\nimport { isSome as t } from \"../../../../core/maybe.js\";\nimport { projectBuffer as i } from \"../../../../geometry/projection.js\";\nimport { pathsToTriangulationInfo as o } from \"../../../../geometry/support/triangulationUtils.js\";\nimport { applyPerVertexElevationAlignment as n } from \"./elevationAlignmentUtils.js\";\nimport { DRAPED_Z as e } from \"../../terrain/OverlayRenderer.js\";\nimport { Geometry as s } from \"../../webgl-engine/lib/Geometry.js\";\nimport a from \"../../../../geometry/Extent.js\";\nimport r from \"../../../../geometry/Polygon.js\";\n\nfunction p(i) {\n  const o = [[\"position\", i.indices]],\n        n = [[\"position\", {\n    size: 3,\n    data: i.attributeData.position,\n    exclusive: !0\n  }]];\n  return t(i.attributeData.color) && (n.push([\"color\", {\n    size: 4,\n    data: i.attributeData.color,\n    exclusive: !0\n  }]), o.push([\"color\", new Uint32Array(i.indices.length)])), t(i.attributeData.uvMapSpace) && (n.push([\"uvMapSpace\", {\n    size: 4,\n    data: i.attributeData.uvMapSpace,\n    exclusive: !0\n  }]), o.push([\"uvMapSpace\", i.indices])), t(i.attributeData.boundingRect) && (n.push([\"boundingRect\", {\n    size: 9,\n    data: i.attributeData.boundingRect,\n    exclusive: !0\n  }]), o.push([\"boundingRect\", i.indices])), t(i.attributeData.mapPosition) && (n.push([\"mapPos\", {\n    size: 3,\n    data: i.attributeData.mapPosition,\n    exclusive: !0\n  }]), o.push([\"mapPos\", i.indices])), new s(n, o);\n}\n\nfunction u(i) {\n  const o = [[\"position\", i.indices], [\"uv0\", i.indices]],\n        n = [[\"position\", {\n    size: 3,\n    data: i.attributeData.position,\n    exclusive: !0\n  }], [\"uv0\", {\n    size: 2,\n    data: i.attributeData.uv0,\n    exclusive: !0\n  }]];\n  return t(i.attributeData.mapPosition) && (n.push([\"mapPos\", {\n    size: 3,\n    data: i.attributeData.mapPosition,\n    exclusive: !0\n  }]), o.push([\"mapPos\", i.indices])), new s(n, o);\n}\n\nfunction c(t) {\n  switch (t.type) {\n    case \"extent\":\n      if (t instanceof a) return r.fromExtent(t);\n      break;\n\n    case \"polygon\":\n      return t;\n  }\n\n  return null;\n}\n\nfunction l(t, i, e, s) {\n  const a = o(t.rings, t.hasZ, 1),\n        r = new Float64Array(a.position.length),\n        p = n(a.position, t.spatialReference, 0, r, 0, a.position, 0, a.position.length / 3, i, e, s),\n        u = null != p;\n  return {\n    position: a.position,\n    mapPosition: r,\n    polygons: g(a.polygons, a.position, r),\n    outlines: d(a.outlines, a.position, r),\n    projectionSuccess: u,\n    sampledElevation: p\n  };\n}\n\nfunction m(t, n) {\n  const s = o(t.rings, !1, 1),\n        a = i(s.position, t.spatialReference, 0, s.position, n, 0, s.position.length / 3);\n\n  for (let i = 2; i < s.position.length; i += 3) s.position[i] = e;\n\n  return {\n    position: s.position,\n    polygons: g(s.polygons, s.position),\n    outlines: d(s.outlines, s.position),\n    projectionSuccess: a\n  };\n}\n\nfunction d(t, i, o) {\n  const n = new Array();\n\n  for (const {\n    index: e,\n    count: s\n  } of t) {\n    if (s <= 1) continue;\n    const t = 3 * e,\n          a = t + 3 * s;\n    n.push({\n      index: e,\n      count: s,\n      position: i.subarray(t, a),\n      mapPosition: o ? o.subarray(t, a) : void 0\n    });\n  }\n\n  return n;\n}\n\nfunction g(t, i, o) {\n  const n = new Array();\n\n  for (const {\n    index: e,\n    count: s,\n    holeIndices: a,\n    pathLengths: r\n  } of t) {\n    if (s <= 1) continue;\n    const t = 3 * e,\n          p = t + 3 * s,\n          u = a.map(t => t - e);\n    n.push({\n      index: e,\n      count: s,\n      holeIndices: u,\n      pathLengths: r,\n      position: i.subarray(t, p),\n      mapPosition: o ? o.subarray(t, p) : void 0\n    });\n  }\n\n  return n;\n}\n\nexport { p as createColorGeometry, u as createWaterGeometry, c as geometryAsPolygon, l as geometryToRenderInfo, m as geometryToRenderInfoDraped };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/layers/graphics/polygonUtils.js"],"names":["isSome","t","projectBuffer","i","pathsToTriangulationInfo","o","applyPerVertexElevationAlignment","n","DRAPED_Z","e","Geometry","s","a","r","p","indices","size","data","attributeData","position","exclusive","color","push","Uint32Array","length","uvMapSpace","boundingRect","mapPosition","u","uv0","c","type","fromExtent","l","rings","hasZ","Float64Array","spatialReference","polygons","g","outlines","d","projectionSuccess","sampledElevation","m","Array","index","count","subarray","holeIndices","pathLengths","map","createColorGeometry","createWaterGeometry","geometryAsPolygon","geometryToRenderInfo","geometryToRenderInfoDraped"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../../../geometry.js\";import{isSome as t}from\"../../../../core/maybe.js\";import{projectBuffer as i}from\"../../../../geometry/projection.js\";import{pathsToTriangulationInfo as o}from\"../../../../geometry/support/triangulationUtils.js\";import{applyPerVertexElevationAlignment as n}from\"./elevationAlignmentUtils.js\";import{DRAPED_Z as e}from\"../../terrain/OverlayRenderer.js\";import{Geometry as s}from\"../../webgl-engine/lib/Geometry.js\";import a from\"../../../../geometry/Extent.js\";import r from\"../../../../geometry/Polygon.js\";function p(i){const o=[[\"position\",i.indices]],n=[[\"position\",{size:3,data:i.attributeData.position,exclusive:!0}]];return t(i.attributeData.color)&&(n.push([\"color\",{size:4,data:i.attributeData.color,exclusive:!0}]),o.push([\"color\",new Uint32Array(i.indices.length)])),t(i.attributeData.uvMapSpace)&&(n.push([\"uvMapSpace\",{size:4,data:i.attributeData.uvMapSpace,exclusive:!0}]),o.push([\"uvMapSpace\",i.indices])),t(i.attributeData.boundingRect)&&(n.push([\"boundingRect\",{size:9,data:i.attributeData.boundingRect,exclusive:!0}]),o.push([\"boundingRect\",i.indices])),t(i.attributeData.mapPosition)&&(n.push([\"mapPos\",{size:3,data:i.attributeData.mapPosition,exclusive:!0}]),o.push([\"mapPos\",i.indices])),new s(n,o)}function u(i){const o=[[\"position\",i.indices],[\"uv0\",i.indices]],n=[[\"position\",{size:3,data:i.attributeData.position,exclusive:!0}],[\"uv0\",{size:2,data:i.attributeData.uv0,exclusive:!0}]];return t(i.attributeData.mapPosition)&&(n.push([\"mapPos\",{size:3,data:i.attributeData.mapPosition,exclusive:!0}]),o.push([\"mapPos\",i.indices])),new s(n,o)}function c(t){switch(t.type){case\"extent\":if(t instanceof a)return r.fromExtent(t);break;case\"polygon\":return t}return null}function l(t,i,e,s){const a=o(t.rings,t.hasZ,1),r=new Float64Array(a.position.length),p=n(a.position,t.spatialReference,0,r,0,a.position,0,a.position.length/3,i,e,s),u=null!=p;return{position:a.position,mapPosition:r,polygons:g(a.polygons,a.position,r),outlines:d(a.outlines,a.position,r),projectionSuccess:u,sampledElevation:p}}function m(t,n){const s=o(t.rings,!1,1),a=i(s.position,t.spatialReference,0,s.position,n,0,s.position.length/3);for(let i=2;i<s.position.length;i+=3)s.position[i]=e;return{position:s.position,polygons:g(s.polygons,s.position),outlines:d(s.outlines,s.position),projectionSuccess:a}}function d(t,i,o){const n=new Array;for(const{index:e,count:s}of t){if(s<=1)continue;const t=3*e,a=t+3*s;n.push({index:e,count:s,position:i.subarray(t,a),mapPosition:o?o.subarray(t,a):void 0})}return n}function g(t,i,o){const n=new Array;for(const{index:e,count:s,holeIndices:a,pathLengths:r}of t){if(s<=1)continue;const t=3*e,p=t+3*s,u=a.map((t=>t-e));n.push({index:e,count:s,holeIndices:u,pathLengths:r,position:i.subarray(t,p),mapPosition:o?o.subarray(t,p):void 0})}return n}export{p as createColorGeometry,u as createWaterGeometry,c as geometryAsPolygon,l as geometryToRenderInfo,m as geometryToRenderInfoDraped};\n"]},"metadata":{},"sourceType":"module"}