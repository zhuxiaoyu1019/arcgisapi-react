{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../../chunks/tslib.es6.js\";\nimport \"../../../../../geometry.js\";\nimport t from \"../../../../../core/Evented.js\";\nimport i from \"../../../../../core/Handles.js\";\nimport { isSome as r } from \"../../../../../core/maybe.js\";\nimport { init as o } from \"../../../../../core/watchUtils.js\";\nimport { property as s } from \"../../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../../core/has.js\";\nimport \"../../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../../core/Logger.js\";\nimport { subclass as n } from \"../../../../../core/accessorSupport/decorators/subclass.js\";\nimport { createCoordinateHelper as m } from \"../../../../interactive/coordinateHelper.js\";\nimport { EditGeometry as a, Component as h } from \"../../../../interactive/editGeometry/EditGeometry.js\";\nexport { Component, Edge, EditGeometry, Vertex } from \"../../../../interactive/editGeometry/EditGeometry.js\";\nimport { AppendVertex as l } from \"../../../../interactive/editGeometry/operations/AppendVertex.js\";\nimport { SetVertexPosition as c } from \"../../../../interactive/editGeometry/operations/SetVertexPosition.js\";\nimport { CloseComponent as d } from \"../../../../interactive/editGeometry/operations/CloseComponent.js\";\nimport p from \"../../../../../geometry/Point.js\";\nlet y = class extends t.EventedAccessor {\n  constructor(e = {}) {\n    super(e), this._handles = new i(), this._version = 0, this._internalGeometryChange = !1;\n  }\n\n  set areaMeasurement(e) {\n    this._set(\"areaMeasurement\", e), r(e) && r(this.view) && this._initialize(e, this.view);\n  }\n\n  set view(e) {\n    this._set(\"view\", e), r(e) && r(this.areaMeasurement) && this._initialize(this.areaMeasurement, e);\n  }\n\n  get initialized() {\n    return r(this.areaMeasurement) && r(this.view);\n  }\n\n  get version() {\n    return this._version;\n  }\n\n  get isValidPolygon() {\n    return this.initialized && this._editGeometry.components.length > 0 && this._editGeometry.components[0].isClosed();\n  }\n\n  _initialize(e, t) {\n    this._handles.removeAll(), this._handles.add(o(e, \"geometry\", () => this._updateEditGeometryFromModelGeometry(e, t), !0)), this._makeDirty(!0);\n  }\n\n  _makeDirty(e = !1) {\n    this.notifyChange(\"isValidPolygon\"), this.notifyChange(\"initialized\"), e && this.notifyChange(\"numVertices\");\n  }\n\n  _updateEditGeometryFromModelGeometry(e, t) {\n    this._version++, this._internalGeometryChange || (this._handles.remove(\"EditGeometry\"), this._editGeometry = r(e.geometry) ? a.fromGeometry(e.geometry, t.viewingMode) : new a(m(!0, !1, t.spatialReference, t.viewingMode)), this._makeDirty(!0), this.emit(\"change\", {\n      type: \"change\"\n    }), this._handles.add(this._editGeometry.on(\"change\", t => {\n      this._makeDirty(null != t.addedVertices || null != t.removedVertices), this._internalGeometryChange = !0, e.geometry = this.numVertices > 0 ? this._editGeometry.toPolygon() : null, this._internalGeometryChange = !1;\n    }), \"EditGeometry\"));\n  }\n\n  get vertices() {\n    const e = [];\n    return this.forEachVertex(t => {\n      e.push(t);\n    }), e;\n  }\n\n  get numVertices() {\n    return this.initialized && this._editGeometry.components.length > 0 ? this._editGeometry.components[0].vertices.length : 0;\n  }\n\n  get lastPoint() {\n    if (this.initialized && this._editGeometry.components.length > 0) {\n      const e = this._editGeometry.components[0].getLastVertex();\n\n      if (r(e)) return this._editGeometry.coordinateHelper.createPoint(e.pos);\n    }\n\n    return null;\n  }\n\n  getVertex(e) {\n    if (!this.initialized || 0 === this._editGeometry.components.length || 0 === this._editGeometry.components[0].vertices.length) return null;\n    const t = this._editGeometry.components[0].vertices[0];\n    let i = t;\n\n    do {\n      if (i.index === e) return i;\n      i = i.right.right;\n    } while (i !== t && null != i);\n\n    return null;\n  }\n\n  getVertexPositionAsPoint(e) {\n    return this._editGeometry.coordinateHelper.createPoint(e.pos);\n  }\n\n  getVertexPositionAsPointFromIndex(e) {\n    return this._editGeometry.coordinateHelper.createPoint(this.getVertex(e).pos);\n  }\n\n  forEachVertex(e) {\n    this.initialized && this._editGeometry.components.length > 0 && this._editGeometry.components[0].iterateVertices(e);\n  }\n\n  forEachVertexPosition(e) {\n    const t = this._editGeometry.coordinateHelper;\n    this.forEachVertex((i, r) => {\n      t.toPoint(i.pos, u), e(u, r);\n    });\n  }\n\n  clear() {\n    r(this.areaMeasurement) && (this.areaMeasurement.geometry = null);\n  }\n\n  add(e) {\n    if (!this.initialized) return null;\n    0 === this._editGeometry.components.length && this._editGeometry.components.push(new h(this._editGeometry));\n    const t = new l(this._editGeometry, this._editGeometry.components[0], this._editGeometry.coordinateHelper.fromPoint(e));\n    return this._editGeometry.apply(t), this.emit(\"change\", {\n      type: \"change\"\n    }), t;\n  }\n\n  close() {\n    if (!this.initialized) return null;\n    if (0 === this._editGeometry.components.length) return null;\n    const e = this._editGeometry.components[0],\n          t = new d(this._editGeometry, e);\n    return this._editGeometry.apply(t), this.emit(\"change\", {\n      type: \"change\"\n    }), t;\n  }\n\n  ensureContains(e, t = \"\") {\n    let i = !1;\n    if (this._editGeometry.components.forEach(t => {\n      t.iterateVertices(t => {\n        t === e && (i = !0);\n      });\n    }), !i) throw new Error(`vertex doesnt exist ${t}`);\n    return i;\n  }\n\n  setVertexPosition(e, t) {\n    if (!this.initialized) return null;\n    const i = new c(this._editGeometry, e, this._editGeometry.coordinateHelper.fromPoint(t));\n    return this._editGeometry.apply(i), this.emit(\"change\", {\n      type: \"change\"\n    }), i;\n  }\n\n  equals(e) {\n    if (this.numVertices !== e.numVertices) return !1;\n    let t = !0;\n    return this.forEachVertexPosition((i, r) => {\n      const o = e.getVertexPositionAsPointFromIndex(r);\n      i.equals(o) || (t = !1);\n    }), !!t;\n  }\n\n};\ne([s({\n  value: null\n})], y.prototype, \"areaMeasurement\", null), e([s({\n  value: null\n})], y.prototype, \"view\", null), e([s()], y.prototype, \"isValidPolygon\", null), e([s()], y.prototype, \"numVertices\", null), y = e([n(\"esri.views.3d.interactive.graphics.AreaMeasurement3D.AreaMeasurement3DPathHelper\")], y);\nconst u = new p();\nexport { y as AreaMeasurement3DPathHelper };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/layers/analysis/AreaMeasurement/AreaMeasurementPathHelper.js"],"names":["_","e","t","i","isSome","r","init","o","property","s","subclass","n","createCoordinateHelper","m","EditGeometry","a","Component","h","Edge","Vertex","AppendVertex","l","SetVertexPosition","c","CloseComponent","d","p","y","EventedAccessor","constructor","_handles","_version","_internalGeometryChange","areaMeasurement","_set","view","_initialize","initialized","version","isValidPolygon","_editGeometry","components","length","isClosed","removeAll","add","_updateEditGeometryFromModelGeometry","_makeDirty","notifyChange","remove","geometry","fromGeometry","viewingMode","spatialReference","emit","type","on","addedVertices","removedVertices","numVertices","toPolygon","vertices","forEachVertex","push","lastPoint","getLastVertex","coordinateHelper","createPoint","pos","getVertex","index","right","getVertexPositionAsPoint","getVertexPositionAsPointFromIndex","iterateVertices","forEachVertexPosition","toPoint","u","clear","fromPoint","apply","close","ensureContains","forEach","Error","setVertexPosition","equals","value","prototype","AreaMeasurement3DPathHelper"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../geometry.js\";import t from\"../../../../../core/Evented.js\";import i from\"../../../../../core/Handles.js\";import{isSome as r}from\"../../../../../core/maybe.js\";import{init as o}from\"../../../../../core/watchUtils.js\";import{property as s}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as n}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{createCoordinateHelper as m}from\"../../../../interactive/coordinateHelper.js\";import{EditGeometry as a,Component as h}from\"../../../../interactive/editGeometry/EditGeometry.js\";export{Component,Edge,EditGeometry,Vertex}from\"../../../../interactive/editGeometry/EditGeometry.js\";import{AppendVertex as l}from\"../../../../interactive/editGeometry/operations/AppendVertex.js\";import{SetVertexPosition as c}from\"../../../../interactive/editGeometry/operations/SetVertexPosition.js\";import{CloseComponent as d}from\"../../../../interactive/editGeometry/operations/CloseComponent.js\";import p from\"../../../../../geometry/Point.js\";let y=class extends t.EventedAccessor{constructor(e={}){super(e),this._handles=new i,this._version=0,this._internalGeometryChange=!1}set areaMeasurement(e){this._set(\"areaMeasurement\",e),r(e)&&r(this.view)&&this._initialize(e,this.view)}set view(e){this._set(\"view\",e),r(e)&&r(this.areaMeasurement)&&this._initialize(this.areaMeasurement,e)}get initialized(){return r(this.areaMeasurement)&&r(this.view)}get version(){return this._version}get isValidPolygon(){return this.initialized&&this._editGeometry.components.length>0&&this._editGeometry.components[0].isClosed()}_initialize(e,t){this._handles.removeAll(),this._handles.add(o(e,\"geometry\",(()=>this._updateEditGeometryFromModelGeometry(e,t)),!0)),this._makeDirty(!0)}_makeDirty(e=!1){this.notifyChange(\"isValidPolygon\"),this.notifyChange(\"initialized\"),e&&this.notifyChange(\"numVertices\")}_updateEditGeometryFromModelGeometry(e,t){this._version++,this._internalGeometryChange||(this._handles.remove(\"EditGeometry\"),this._editGeometry=r(e.geometry)?a.fromGeometry(e.geometry,t.viewingMode):new a(m(!0,!1,t.spatialReference,t.viewingMode)),this._makeDirty(!0),this.emit(\"change\",{type:\"change\"}),this._handles.add(this._editGeometry.on(\"change\",(t=>{this._makeDirty(null!=t.addedVertices||null!=t.removedVertices),this._internalGeometryChange=!0,e.geometry=this.numVertices>0?this._editGeometry.toPolygon():null,this._internalGeometryChange=!1})),\"EditGeometry\"))}get vertices(){const e=[];return this.forEachVertex((t=>{e.push(t)})),e}get numVertices(){return this.initialized&&this._editGeometry.components.length>0?this._editGeometry.components[0].vertices.length:0}get lastPoint(){if(this.initialized&&this._editGeometry.components.length>0){const e=this._editGeometry.components[0].getLastVertex();if(r(e))return this._editGeometry.coordinateHelper.createPoint(e.pos)}return null}getVertex(e){if(!this.initialized||0===this._editGeometry.components.length||0===this._editGeometry.components[0].vertices.length)return null;const t=this._editGeometry.components[0].vertices[0];let i=t;do{if(i.index===e)return i;i=i.right.right}while(i!==t&&null!=i);return null}getVertexPositionAsPoint(e){return this._editGeometry.coordinateHelper.createPoint(e.pos)}getVertexPositionAsPointFromIndex(e){return this._editGeometry.coordinateHelper.createPoint(this.getVertex(e).pos)}forEachVertex(e){this.initialized&&this._editGeometry.components.length>0&&this._editGeometry.components[0].iterateVertices(e)}forEachVertexPosition(e){const t=this._editGeometry.coordinateHelper;this.forEachVertex(((i,r)=>{t.toPoint(i.pos,u),e(u,r)}))}clear(){r(this.areaMeasurement)&&(this.areaMeasurement.geometry=null)}add(e){if(!this.initialized)return null;0===this._editGeometry.components.length&&this._editGeometry.components.push(new h(this._editGeometry));const t=new l(this._editGeometry,this._editGeometry.components[0],this._editGeometry.coordinateHelper.fromPoint(e));return this._editGeometry.apply(t),this.emit(\"change\",{type:\"change\"}),t}close(){if(!this.initialized)return null;if(0===this._editGeometry.components.length)return null;const e=this._editGeometry.components[0],t=new d(this._editGeometry,e);return this._editGeometry.apply(t),this.emit(\"change\",{type:\"change\"}),t}ensureContains(e,t=\"\"){let i=!1;if(this._editGeometry.components.forEach((t=>{t.iterateVertices((t=>{t===e&&(i=!0)}))})),!i)throw new Error(`vertex doesnt exist ${t}`);return i}setVertexPosition(e,t){if(!this.initialized)return null;const i=new c(this._editGeometry,e,this._editGeometry.coordinateHelper.fromPoint(t));return this._editGeometry.apply(i),this.emit(\"change\",{type:\"change\"}),i}equals(e){if(this.numVertices!==e.numVertices)return!1;let t=!0;return this.forEachVertexPosition(((i,r)=>{const o=e.getVertexPositionAsPointFromIndex(r);i.equals(o)||(t=!1)})),!!t}};e([s({value:null})],y.prototype,\"areaMeasurement\",null),e([s({value:null})],y.prototype,\"view\",null),e([s()],y.prototype,\"isValidPolygon\",null),e([s()],y.prototype,\"numVertices\",null),y=e([n(\"esri.views.3d.interactive.graphics.AreaMeasurement3D.AreaMeasurement3DPathHelper\")],y);const u=new p;export{y as AreaMeasurement3DPathHelper};\n"]},"metadata":{},"sourceType":"module"}