{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { WGLGeometryType as e } from \"../enums.js\";\nimport { createProgramDescriptor as t } from \"../Utils.js\";\nimport a from \"./WGLGeometryBrush.js\";\nimport { TextMaterialKey as o } from \"../materialKey/MaterialKey.js\";\n\nconst i = e => t(e.data, {\n  geometry: [{\n    location: 0,\n    name: \"a_pos\",\n    count: 2,\n    type: 5122\n  }, {\n    location: 1,\n    name: \"a_id\",\n    count: 4,\n    type: 5121\n  }, {\n    location: 2,\n    name: \"a_color\",\n    count: 4,\n    type: 5121,\n    normalized: !0\n  }, {\n    location: 3,\n    name: \"a_haloColor\",\n    count: 4,\n    type: 5121,\n    normalized: !0\n  }, {\n    location: 4,\n    name: \"a_texFontSize\",\n    count: 4,\n    type: 5121\n  }, {\n    location: 5,\n    name: \"a_aux\",\n    count: 4,\n    type: 5120\n  }, {\n    location: 6,\n    name: \"a_zoomRange\",\n    count: 2,\n    type: 5123\n  }, {\n    location: 7,\n    name: \"a_vertexOffset\",\n    count: 2,\n    type: 5122\n  }, {\n    location: 8,\n    name: \"a_texCoords\",\n    count: 2,\n    type: 5123\n  }]\n});\n\nclass r extends a {\n  dispose() {}\n\n  getGeometryType() {\n    return e.TEXT;\n  }\n\n  drawGeometry(e, t, a, r) {\n    const {\n      context: s,\n      painter: n,\n      rendererInfo: v,\n      state: l\n    } = e,\n          u = o.load(a.materialKey),\n          {\n      bufferLayouts: m,\n      attributes: f\n    } = i(u),\n          p = n.materialManager.getMaterialProgram(e, u, \"materials/text\", f, r);\n\n    if (s.useProgram(p), this._setSharedUniforms(p, e, t), n.textureManager.bindTextures(s, p, u), p.setUniformMatrix3fv(\"u_displayMat3\", l.displayMat3), p.setUniformMatrix3fv(\"u_displayViewMat3\", l.displayViewMat3), u.vvSizeMinMaxValue && p.setUniform4fv(\"u_vvSizeMinMaxValue\", v.vvSizeMinMaxValue), u.vvSizeScaleStops && p.setUniform1f(\"u_vvSizeScaleStopsValue\", v.vvSizeScaleStopsValue), u.vvSizeFieldStops) {\n      const e = v.getSizeVVFieldStops(t.key.level);\n      p.setUniform1fv(\"u_vvSizeFieldStopsValues\", e.values), p.setUniform1fv(\"u_vvSizeFieldStopsSizes\", e.sizes);\n    }\n\n    u.vvSizeUnitValue && p.setUniform1f(\"u_vvSizeUnitValueWorldToPixelsRatio\", v.vvSizeUnitValueToPixelsRatio), u.vvColor && (p.setUniform1fv(\"u_vvColorValues\", v.vvColorValues), p.setUniform4fv(\"u_vvColors\", v.vvColors)), u.vvOpacity && (p.setUniform1fv(\"u_vvOpacityValues\", v.vvOpacityValues), p.setUniform1fv(\"u_vvOpacities\", v.vvOpacities)), u.vvRotation && p.setUniform1f(\"u_vvRotationType\", \"geographic\" === v.vvMaterialParameters.vvRotationType ? 0 : 1), p.setUniform1f(\"u_isHalo\", 1), a.draw(s, m, f), p.setUniform1f(\"u_isHalo\", 0), a.draw(s, m, f);\n  }\n\n}\n\nexport default r;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/WGLGeometryBrushText.js"],"names":["WGLGeometryType","e","createProgramDescriptor","t","a","TextMaterialKey","o","i","data","geometry","location","name","count","type","normalized","r","dispose","getGeometryType","TEXT","drawGeometry","context","s","painter","n","rendererInfo","v","state","l","u","load","materialKey","bufferLayouts","m","attributes","f","p","materialManager","getMaterialProgram","useProgram","_setSharedUniforms","textureManager","bindTextures","setUniformMatrix3fv","displayMat3","displayViewMat3","vvSizeMinMaxValue","setUniform4fv","vvSizeScaleStops","setUniform1f","vvSizeScaleStopsValue","vvSizeFieldStops","getSizeVVFieldStops","key","level","setUniform1fv","values","sizes","vvSizeUnitValue","vvSizeUnitValueToPixelsRatio","vvColor","vvColorValues","vvColors","vvOpacity","vvOpacityValues","vvOpacities","vvRotation","vvMaterialParameters","vvRotationType","draw"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{WGLGeometryType as e}from\"../enums.js\";import{createProgramDescriptor as t}from\"../Utils.js\";import a from\"./WGLGeometryBrush.js\";import{TextMaterialKey as o}from\"../materialKey/MaterialKey.js\";const i=e=>t(e.data,{geometry:[{location:0,name:\"a_pos\",count:2,type:5122},{location:1,name:\"a_id\",count:4,type:5121},{location:2,name:\"a_color\",count:4,type:5121,normalized:!0},{location:3,name:\"a_haloColor\",count:4,type:5121,normalized:!0},{location:4,name:\"a_texFontSize\",count:4,type:5121},{location:5,name:\"a_aux\",count:4,type:5120},{location:6,name:\"a_zoomRange\",count:2,type:5123},{location:7,name:\"a_vertexOffset\",count:2,type:5122},{location:8,name:\"a_texCoords\",count:2,type:5123}]});class r extends a{dispose(){}getGeometryType(){return e.TEXT}drawGeometry(e,t,a,r){const{context:s,painter:n,rendererInfo:v,state:l}=e,u=o.load(a.materialKey),{bufferLayouts:m,attributes:f}=i(u),p=n.materialManager.getMaterialProgram(e,u,\"materials/text\",f,r);if(s.useProgram(p),this._setSharedUniforms(p,e,t),n.textureManager.bindTextures(s,p,u),p.setUniformMatrix3fv(\"u_displayMat3\",l.displayMat3),p.setUniformMatrix3fv(\"u_displayViewMat3\",l.displayViewMat3),u.vvSizeMinMaxValue&&p.setUniform4fv(\"u_vvSizeMinMaxValue\",v.vvSizeMinMaxValue),u.vvSizeScaleStops&&p.setUniform1f(\"u_vvSizeScaleStopsValue\",v.vvSizeScaleStopsValue),u.vvSizeFieldStops){const e=v.getSizeVVFieldStops(t.key.level);p.setUniform1fv(\"u_vvSizeFieldStopsValues\",e.values),p.setUniform1fv(\"u_vvSizeFieldStopsSizes\",e.sizes)}u.vvSizeUnitValue&&p.setUniform1f(\"u_vvSizeUnitValueWorldToPixelsRatio\",v.vvSizeUnitValueToPixelsRatio),u.vvColor&&(p.setUniform1fv(\"u_vvColorValues\",v.vvColorValues),p.setUniform4fv(\"u_vvColors\",v.vvColors)),u.vvOpacity&&(p.setUniform1fv(\"u_vvOpacityValues\",v.vvOpacityValues),p.setUniform1fv(\"u_vvOpacities\",v.vvOpacities)),u.vvRotation&&p.setUniform1f(\"u_vvRotationType\",\"geographic\"===v.vvMaterialParameters.vvRotationType?0:1),p.setUniform1f(\"u_isHalo\",1),a.draw(s,m,f),p.setUniform1f(\"u_isHalo\",0),a.draw(s,m,f)}}export default r;\n"]},"metadata":{},"sourceType":"module"}