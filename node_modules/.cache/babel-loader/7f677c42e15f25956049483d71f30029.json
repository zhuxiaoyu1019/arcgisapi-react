{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { bindSliceUniformsWithOrigin as t } from \"../core/shaderLibrary/Slice.glsl.js\";\nimport { bindOutputHighlight as r } from \"../core/shaderLibrary/output/OutputHighlight.glsl.js\";\nimport { bindMultipassTerrainTexture as i } from \"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";\nimport { bindProjectionMatrix as o, bindView as s, bindCameraPosition as a } from \"../core/shaderLibrary/util/View.glsl.js\";\nimport { ReloadableShaderModule as n } from \"../core/shaderTechnique/ReloadableShaderModule.js\";\nimport { ShaderTechnique as p } from \"../core/shaderTechnique/ShaderTechnique.js\";\nimport { ShaderTechniqueConfiguration as l, parameter as c } from \"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";\nimport { blendingDefault as u, OITBlending as d, OITDepthTest as h, OITDepthWrite as m, getOITPolygonOffset as f } from \"../lib/OrderIndependentTransparency.js\";\nimport { Program as g } from \"../lib/Program.js\";\nimport { stencilWriteMaskOn as b, stencilToolMaskBaseParams as y, stencilBaseAllZerosParams as v } from \"../lib/StencilUtils.js\";\nimport { P as T } from \"../../../../chunks/Pattern.glsl.js\";\nimport { makePipelineState as P, cullingParams as S, defaultDepthWriteParams as j, defaultColorWriteParams as w } from \"../../../webgl/renderState.js\";\n\nclass x extends p {\n  initializeProgram(e) {\n    const t = x.shader.get(),\n          r = this.configuration,\n          i = t.build({\n      output: r.output,\n      attributeColor: r.vertexColors,\n      slicePlaneEnabled: r.slicePlaneEnabled,\n      sliceHighlightDisabled: !1,\n      sliceEnabledForVertexPrograms: !1,\n      style: r.style,\n      patternSpacing: r.patternSpacing,\n      lineWidth: r.lineWidth,\n      draped: r.draped,\n      OITEnabled: 0 === r.transparencyPassType,\n      multipassTerrainEnabled: r.multipassTerrainEnabled,\n      cullAboveGround: r.cullAboveGround\n    });\n    return new g(e.rctx, i, W);\n  }\n\n  bindPass(e, t) {\n    o(this.program, t.camera.projectionMatrix), this.program.setUniform4fv(\"matColor\", e.color), this.configuration.draped ? (this.program.setUniform1f(\"worldToScreenRatio\", 1 / t.screenToWorldRatioGlobalWM), this.program.setUniform1f(\"texelSize\", 1 / t.camera.pixelRatio)) : this.program.setUniform1f(\"worldToScreenPerDistanceRatio\", 1 / t.camera.perScreenPixelRatio), 4 === this.configuration.output && r(this.program, t), (1 === this.configuration.output || t.multipassTerrainEnabled) && this.program.setUniform2fv(\"cameraNearFar\", t.camera.nearFar), t.multipassTerrainEnabled && (this.program.setUniform2fv(\"inverseViewport\", t.inverseViewport), i(this.program, t));\n  }\n\n  bindDraw(e) {\n    s(this.program, e), a(this.program, e.origin, e.camera.viewInverseTransposeMatrix), t(this.program, this.configuration, e), this.program.rebindTextures();\n  }\n\n  setPipelineState(e, t) {\n    const r = this.configuration,\n          i = 3 === e,\n          o = 2 === e;\n    return P({\n      blending: 0 === r.output || 7 === r.output ? r.transparent && i ? u : d(e) : null,\n      culling: S(r.cullFace),\n      depthTest: {\n        func: h(e)\n      },\n      depthWrite: i ? r.writeDepth && j : m(e),\n      colorWrite: w,\n      stencilWrite: r.sceneHasOcludees ? b : null,\n      stencilTest: r.sceneHasOcludees ? t ? y : v : null,\n      polygonOffset: i || o ? r.polygonOffset && O : f(r.enableOffset)\n    });\n  }\n\n  initializePipeline() {\n    return this._occludeePipelineState = this.setPipelineState(this.configuration.transparencyPassType, !0), this.setPipelineState(this.configuration.transparencyPassType, !1);\n  }\n\n  getPipelineState(e) {\n    return e ? this._occludeePipelineState : this.pipeline;\n  }\n\n}\n\nx.shader = new n(T, () => import(\"./Pattern.glsl.js\"));\nconst O = {\n  factor: 1,\n  units: 1\n};\n\nclass E extends l {\n  constructor() {\n    super(...arguments), this.output = 0, this.cullFace = 0, this.slicePlaneEnabled = !1, this.vertexColors = !1, this.transparent = !0, this.polygonOffset = !1, this.writeDepth = !0, this.sceneHasOcludees = !1, this.enableOffset = !0, this.transparencyPassType = 3, this.multipassTerrainEnabled = !1, this.cullAboveGround = !1;\n  }\n\n}\n\ne([c({\n  count: 8\n})], E.prototype, \"output\", void 0), e([c({\n  count: 3\n})], E.prototype, \"cullFace\", void 0), e([c()], E.prototype, \"slicePlaneEnabled\", void 0), e([c()], E.prototype, \"vertexColors\", void 0), e([c()], E.prototype, \"transparent\", void 0), e([c()], E.prototype, \"polygonOffset\", void 0), e([c()], E.prototype, \"writeDepth\", void 0), e([c()], E.prototype, \"sceneHasOcludees\", void 0), e([c({\n  count: 6\n})], E.prototype, \"style\", void 0), e([c()], E.prototype, \"patternSpacing\", void 0), e([c()], E.prototype, \"lineWidth\", void 0), e([c()], E.prototype, \"enableOffset\", void 0), e([c()], E.prototype, \"draped\", void 0), e([c({\n  count: 4\n})], E.prototype, \"transparencyPassType\", void 0), e([c()], E.prototype, \"multipassTerrainEnabled\", void 0), e([c()], E.prototype, \"cullAboveGround\", void 0);\nconst W = new Map([[\"position\", 0], [\"color\", 3], [\"uvMapSpace\", 4], [\"boundingRect\", 5]]);\nexport { x as PatternTechnique, E as PatternTechniqueConfiguration, W as patternVertexAttributeLocations };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/3d/webgl-engine/shaders/PatternTechnique.js"],"names":["_","e","bindSliceUniformsWithOrigin","t","bindOutputHighlight","r","bindMultipassTerrainTexture","i","bindProjectionMatrix","o","bindView","s","bindCameraPosition","a","ReloadableShaderModule","n","ShaderTechnique","p","ShaderTechniqueConfiguration","l","parameter","c","blendingDefault","u","OITBlending","d","OITDepthTest","h","OITDepthWrite","m","getOITPolygonOffset","f","Program","g","stencilWriteMaskOn","b","stencilToolMaskBaseParams","y","stencilBaseAllZerosParams","v","P","T","makePipelineState","cullingParams","S","defaultDepthWriteParams","j","defaultColorWriteParams","w","x","initializeProgram","shader","get","configuration","build","output","attributeColor","vertexColors","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","style","patternSpacing","lineWidth","draped","OITEnabled","transparencyPassType","multipassTerrainEnabled","cullAboveGround","rctx","W","bindPass","program","camera","projectionMatrix","setUniform4fv","color","setUniform1f","screenToWorldRatioGlobalWM","pixelRatio","perScreenPixelRatio","setUniform2fv","nearFar","inverseViewport","bindDraw","origin","viewInverseTransposeMatrix","rebindTextures","setPipelineState","blending","transparent","culling","cullFace","depthTest","func","depthWrite","writeDepth","colorWrite","stencilWrite","sceneHasOcludees","stencilTest","polygonOffset","O","enableOffset","initializePipeline","_occludeePipelineState","getPipelineState","pipeline","factor","units","E","constructor","arguments","count","prototype","Map","PatternTechnique","PatternTechniqueConfiguration","patternVertexAttributeLocations"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindOutputHighlight as r}from\"../core/shaderLibrary/output/OutputHighlight.glsl.js\";import{bindMultipassTerrainTexture as i}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as o,bindView as s,bindCameraPosition as a}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as n}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as p}from\"../core/shaderTechnique/ShaderTechnique.js\";import{ShaderTechniqueConfiguration as l,parameter as c}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{blendingDefault as u,OITBlending as d,OITDepthTest as h,OITDepthWrite as m,getOITPolygonOffset as f}from\"../lib/OrderIndependentTransparency.js\";import{Program as g}from\"../lib/Program.js\";import{stencilWriteMaskOn as b,stencilToolMaskBaseParams as y,stencilBaseAllZerosParams as v}from\"../lib/StencilUtils.js\";import{P as T}from\"../../../../chunks/Pattern.glsl.js\";import{makePipelineState as P,cullingParams as S,defaultDepthWriteParams as j,defaultColorWriteParams as w}from\"../../../webgl/renderState.js\";class x extends p{initializeProgram(e){const t=x.shader.get(),r=this.configuration,i=t.build({output:r.output,attributeColor:r.vertexColors,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,style:r.style,patternSpacing:r.patternSpacing,lineWidth:r.lineWidth,draped:r.draped,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new g(e.rctx,i,W)}bindPass(e,t){o(this.program,t.camera.projectionMatrix),this.program.setUniform4fv(\"matColor\",e.color),this.configuration.draped?(this.program.setUniform1f(\"worldToScreenRatio\",1/t.screenToWorldRatioGlobalWM),this.program.setUniform1f(\"texelSize\",1/t.camera.pixelRatio)):this.program.setUniform1f(\"worldToScreenPerDistanceRatio\",1/t.camera.perScreenPixelRatio),4===this.configuration.output&&r(this.program,t),(1===this.configuration.output||t.multipassTerrainEnabled)&&this.program.setUniform2fv(\"cameraNearFar\",t.camera.nearFar),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),i(this.program,t))}bindDraw(e){s(this.program,e),a(this.program,e.origin,e.camera.viewInverseTransposeMatrix),t(this.program,this.configuration,e),this.program.rebindTextures()}setPipelineState(e,t){const r=this.configuration,i=3===e,o=2===e;return P({blending:0===r.output||7===r.output?r.transparent&&i?u:d(e):null,culling:S(r.cullFace),depthTest:{func:h(e)},depthWrite:i?r.writeDepth&&j:m(e),colorWrite:w,stencilWrite:r.sceneHasOcludees?b:null,stencilTest:r.sceneHasOcludees?t?y:v:null,polygonOffset:i||o?r.polygonOffset&&O:f(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}x.shader=new n(T,(()=>import(\"./Pattern.glsl.js\")));const O={factor:1,units:1};class E extends l{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.vertexColors=!1,this.transparent=!0,this.polygonOffset=!1,this.writeDepth=!0,this.sceneHasOcludees=!1,this.enableOffset=!0,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([c({count:8})],E.prototype,\"output\",void 0),e([c({count:3})],E.prototype,\"cullFace\",void 0),e([c()],E.prototype,\"slicePlaneEnabled\",void 0),e([c()],E.prototype,\"vertexColors\",void 0),e([c()],E.prototype,\"transparent\",void 0),e([c()],E.prototype,\"polygonOffset\",void 0),e([c()],E.prototype,\"writeDepth\",void 0),e([c()],E.prototype,\"sceneHasOcludees\",void 0),e([c({count:6})],E.prototype,\"style\",void 0),e([c()],E.prototype,\"patternSpacing\",void 0),e([c()],E.prototype,\"lineWidth\",void 0),e([c()],E.prototype,\"enableOffset\",void 0),e([c()],E.prototype,\"draped\",void 0),e([c({count:4})],E.prototype,\"transparencyPassType\",void 0),e([c()],E.prototype,\"multipassTerrainEnabled\",void 0),e([c()],E.prototype,\"cullAboveGround\",void 0);const W=new Map([[\"position\",0],[\"color\",3],[\"uvMapSpace\",4],[\"boundingRect\",5]]);export{x as PatternTechnique,E as PatternTechniqueConfiguration,W as patternVertexAttributeLocations};\n"]},"metadata":{},"sourceType":"module"}