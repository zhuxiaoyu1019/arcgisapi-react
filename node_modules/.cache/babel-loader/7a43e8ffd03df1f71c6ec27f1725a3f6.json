{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport { JSONSupport as r } from \"../../core/JSONSupport.js\";\nimport { aliasOf as o } from \"../../core/accessorSupport/decorators/aliasOf.js\";\nimport \"../../core/has.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport \"../../core/Logger.js\";\nimport { property as t } from \"../../core/accessorSupport/decorators/property.js\";\nimport { subclass as i } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { writer as s } from \"../../core/accessorSupport/decorators/writer.js\";\nimport { isSupportedRendererType as n, combineRenderingRules as p, convertRendererToRenderingRule as a } from \"./imageryRendererUtils.js\";\nimport l from \"./MosaicRule.js\";\nimport { interpolationKebab as c, noDataInterpretationKebab as m } from \"./rasterEnums.js\";\nimport y from \"./RasterFunction.js\";\nlet d = class extends r {\n  constructor() {\n    super(...arguments), this.layer = null, this.adjustAspectRatio = void 0, this.bandIds = void 0, this.compression = void 0, this.compressionQuality = void 0, this.compressionTolerance = .01, this.format = null, this.interpolation = null, this.noData = null, this.noDataInterpretation = void 0, this.pixelType = void 0, this.lercVersion = 2;\n  }\n\n  writeAdjustAspectRatio(e, r, o) {\n    this.layer.version < 10.3 || (r[o] = e);\n  }\n\n  writeCompressionQuality(e, r, o) {\n    this.format && this.format.toLowerCase().indexOf(\"jpg\") > -1 && null != e && (r[o] = e);\n  }\n\n  writeCompressionTolerance(e, r, o) {\n    \"lerc\" === this.format && null != e && (r[o] = e);\n  }\n\n  writeLercVersion(e, r, o) {\n    \"lerc\" === this.format && this.layer.version >= 10.5 && (r[o] = e);\n  }\n\n  get version() {\n    const e = this.layer;\n    return e.commitProperty(\"bandIds\"), e.commitProperty(\"format\"), e.commitProperty(\"compressionQuality\"), e.commitProperty(\"compressionTolerance\"), e.commitProperty(\"interpolation\"), e.commitProperty(\"noData\"), e.commitProperty(\"noDataInterpretation\"), e.commitProperty(\"mosaicRule\"), e.commitProperty(\"renderingRule\"), e.commitProperty(\"adjustAspectRatio\"), e.commitProperty(\"pixelFilter\"), e.commitProperty(\"renderer\"), e.commitProperty(\"definitionExpression\"), (this._get(\"version\") || 0) + 1;\n  }\n\n  set version(e) {\n    this._set(\"version\", e);\n  }\n\n  get mosaicRule() {\n    const e = this.layer;\n    let r = e.mosaicRule;\n    const o = e.definitionExpression;\n    return r ? o && o !== r.where && (r = r.clone(), r.where = o) : o && (r = new l({\n      where: o\n    })), r;\n  }\n\n  get renderingRule() {\n    const e = this.layer;\n    let r = e.renderingRule;\n    const o = e.pixelFilter,\n          t = !e.format || e.format.indexOf(\"jpg\") > -1 || e.format.indexOf(\"png\") > -1;\n    return r = this._addResampleRasterFunction(r), t && !o && (r = this.combineRendererWithRenderingRule()), r;\n  }\n\n  combineRendererWithRenderingRule() {\n    var e;\n    const r = this.layer,\n          {\n      rasterInfo: o,\n      renderingRule: t,\n      renderer: i\n    } = r;\n    if (!i || !n(i)) return t;\n    return p(a(i, {\n      rasterAttributeTable: o.attributeTable,\n      pixelType: o.pixelType,\n      dataType: o.dataType,\n      bandProperties: null == (e = o.keyProperties) ? void 0 : e.BandProperties,\n      convertColorRampToColormap: r.version < 10.6\n    }), t);\n  }\n\n  _addResampleRasterFunction(e) {\n    var r;\n    if (!(\"vector-field\" === (null == (r = this.layer.renderer) ? void 0 : r.type)) || \"Resample\" === (null == e ? void 0 : e.functionName)) return e;\n    const o = \"esriImageServiceDataTypeVector-UV\" === this.layer.serviceDataType ? 7 : 10,\n          t = new y({\n      functionName: \"Resample\",\n      functionArguments: {\n        ResamplingType: o,\n        InputCellSize: {\n          x: this.layer.pixelSizeX,\n          y: this.layer.pixelSizeY\n        }\n      }\n    });\n    return p(t, e);\n  }\n\n};\ne([t()], d.prototype, \"layer\", void 0), e([t({\n  json: {\n    write: !0\n  }\n})], d.prototype, \"adjustAspectRatio\", void 0), e([s(\"adjustAspectRatio\")], d.prototype, \"writeAdjustAspectRatio\", null), e([t({\n  json: {\n    write: !0\n  }\n}), o(\"layer.bandIds\")], d.prototype, \"bandIds\", void 0), e([t({\n  json: {\n    write: !0\n  }\n})], d.prototype, \"compression\", void 0), e([t({\n  json: {\n    write: !0\n  }\n}), o(\"layer.compressionQuality\")], d.prototype, \"compressionQuality\", void 0), e([s(\"compressionQuality\")], d.prototype, \"writeCompressionQuality\", null), e([t({\n  json: {\n    write: !0\n  }\n}), o(\"layer.compressionTolerance\")], d.prototype, \"compressionTolerance\", void 0), e([s(\"compressionTolerance\")], d.prototype, \"writeCompressionTolerance\", null), e([t({\n  json: {\n    write: !0\n  }\n}), o(\"layer.format\")], d.prototype, \"format\", void 0), e([t({\n  type: String,\n  json: {\n    read: {\n      reader: c.read\n    },\n    write: {\n      writer: c.write\n    }\n  }\n}), o(\"layer.interpolation\")], d.prototype, \"interpolation\", void 0), e([t({\n  json: {\n    write: !0\n  }\n}), o(\"layer.noData\")], d.prototype, \"noData\", void 0), e([t({\n  type: String,\n  json: {\n    read: {\n      reader: m.read\n    },\n    write: {\n      writer: m.write\n    }\n  }\n}), o(\"layer.noDataInterpretation\")], d.prototype, \"noDataInterpretation\", void 0), e([t({\n  json: {\n    write: !0\n  }\n})], d.prototype, \"pixelType\", void 0), e([t({\n  json: {\n    write: !0\n  }\n})], d.prototype, \"lercVersion\", void 0), e([s(\"lercVersion\")], d.prototype, \"writeLercVersion\", null), e([t({\n  type: Number\n})], d.prototype, \"version\", null), e([t({\n  json: {\n    write: !0\n  }\n})], d.prototype, \"mosaicRule\", null), e([t({\n  json: {\n    write: !0\n  }\n})], d.prototype, \"renderingRule\", null), d = e([i(\"esri.layers.mixins.ExportImageServiceParameters\")], d);\nexport { d as ExportImageServiceParameters };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/layers/support/ExportImageServiceParameters.js"],"names":["_","e","JSONSupport","r","aliasOf","o","property","t","subclass","i","writer","s","isSupportedRendererType","n","combineRenderingRules","p","convertRendererToRenderingRule","a","l","interpolationKebab","c","noDataInterpretationKebab","m","y","d","constructor","arguments","layer","adjustAspectRatio","bandIds","compression","compressionQuality","compressionTolerance","format","interpolation","noData","noDataInterpretation","pixelType","lercVersion","writeAdjustAspectRatio","version","writeCompressionQuality","toLowerCase","indexOf","writeCompressionTolerance","writeLercVersion","commitProperty","_get","_set","mosaicRule","definitionExpression","where","clone","renderingRule","pixelFilter","_addResampleRasterFunction","combineRendererWithRenderingRule","rasterInfo","renderer","rasterAttributeTable","attributeTable","dataType","bandProperties","keyProperties","BandProperties","convertColorRampToColormap","type","functionName","serviceDataType","functionArguments","ResamplingType","InputCellSize","x","pixelSizeX","pixelSizeY","prototype","json","write","String","read","reader","Number","ExportImageServiceParameters"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{JSONSupport as r}from\"../../core/JSONSupport.js\";import{aliasOf as o}from\"../../core/accessorSupport/decorators/aliasOf.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as s}from\"../../core/accessorSupport/decorators/writer.js\";import{isSupportedRendererType as n,combineRenderingRules as p,convertRendererToRenderingRule as a}from\"./imageryRendererUtils.js\";import l from\"./MosaicRule.js\";import{interpolationKebab as c,noDataInterpretationKebab as m}from\"./rasterEnums.js\";import y from\"./RasterFunction.js\";let d=class extends r{constructor(){super(...arguments),this.layer=null,this.adjustAspectRatio=void 0,this.bandIds=void 0,this.compression=void 0,this.compressionQuality=void 0,this.compressionTolerance=.01,this.format=null,this.interpolation=null,this.noData=null,this.noDataInterpretation=void 0,this.pixelType=void 0,this.lercVersion=2}writeAdjustAspectRatio(e,r,o){this.layer.version<10.3||(r[o]=e)}writeCompressionQuality(e,r,o){this.format&&this.format.toLowerCase().indexOf(\"jpg\")>-1&&null!=e&&(r[o]=e)}writeCompressionTolerance(e,r,o){\"lerc\"===this.format&&null!=e&&(r[o]=e)}writeLercVersion(e,r,o){\"lerc\"===this.format&&this.layer.version>=10.5&&(r[o]=e)}get version(){const e=this.layer;return e.commitProperty(\"bandIds\"),e.commitProperty(\"format\"),e.commitProperty(\"compressionQuality\"),e.commitProperty(\"compressionTolerance\"),e.commitProperty(\"interpolation\"),e.commitProperty(\"noData\"),e.commitProperty(\"noDataInterpretation\"),e.commitProperty(\"mosaicRule\"),e.commitProperty(\"renderingRule\"),e.commitProperty(\"adjustAspectRatio\"),e.commitProperty(\"pixelFilter\"),e.commitProperty(\"renderer\"),e.commitProperty(\"definitionExpression\"),(this._get(\"version\")||0)+1}set version(e){this._set(\"version\",e)}get mosaicRule(){const e=this.layer;let r=e.mosaicRule;const o=e.definitionExpression;return r?o&&o!==r.where&&(r=r.clone(),r.where=o):o&&(r=new l({where:o})),r}get renderingRule(){const e=this.layer;let r=e.renderingRule;const o=e.pixelFilter,t=!e.format||e.format.indexOf(\"jpg\")>-1||e.format.indexOf(\"png\")>-1;return r=this._addResampleRasterFunction(r),t&&!o&&(r=this.combineRendererWithRenderingRule()),r}combineRendererWithRenderingRule(){var e;const r=this.layer,{rasterInfo:o,renderingRule:t,renderer:i}=r;if(!i||!n(i))return t;return p(a(i,{rasterAttributeTable:o.attributeTable,pixelType:o.pixelType,dataType:o.dataType,bandProperties:null==(e=o.keyProperties)?void 0:e.BandProperties,convertColorRampToColormap:r.version<10.6}),t)}_addResampleRasterFunction(e){var r;if(!(\"vector-field\"===(null==(r=this.layer.renderer)?void 0:r.type))||\"Resample\"===(null==e?void 0:e.functionName))return e;const o=\"esriImageServiceDataTypeVector-UV\"===this.layer.serviceDataType?7:10,t=new y({functionName:\"Resample\",functionArguments:{ResamplingType:o,InputCellSize:{x:this.layer.pixelSizeX,y:this.layer.pixelSizeY}}});return p(t,e)}};e([t()],d.prototype,\"layer\",void 0),e([t({json:{write:!0}})],d.prototype,\"adjustAspectRatio\",void 0),e([s(\"adjustAspectRatio\")],d.prototype,\"writeAdjustAspectRatio\",null),e([t({json:{write:!0}}),o(\"layer.bandIds\")],d.prototype,\"bandIds\",void 0),e([t({json:{write:!0}})],d.prototype,\"compression\",void 0),e([t({json:{write:!0}}),o(\"layer.compressionQuality\")],d.prototype,\"compressionQuality\",void 0),e([s(\"compressionQuality\")],d.prototype,\"writeCompressionQuality\",null),e([t({json:{write:!0}}),o(\"layer.compressionTolerance\")],d.prototype,\"compressionTolerance\",void 0),e([s(\"compressionTolerance\")],d.prototype,\"writeCompressionTolerance\",null),e([t({json:{write:!0}}),o(\"layer.format\")],d.prototype,\"format\",void 0),e([t({type:String,json:{read:{reader:c.read},write:{writer:c.write}}}),o(\"layer.interpolation\")],d.prototype,\"interpolation\",void 0),e([t({json:{write:!0}}),o(\"layer.noData\")],d.prototype,\"noData\",void 0),e([t({type:String,json:{read:{reader:m.read},write:{writer:m.write}}}),o(\"layer.noDataInterpretation\")],d.prototype,\"noDataInterpretation\",void 0),e([t({json:{write:!0}})],d.prototype,\"pixelType\",void 0),e([t({json:{write:!0}})],d.prototype,\"lercVersion\",void 0),e([s(\"lercVersion\")],d.prototype,\"writeLercVersion\",null),e([t({type:Number})],d.prototype,\"version\",null),e([t({json:{write:!0}})],d.prototype,\"mosaicRule\",null),e([t({json:{write:!0}})],d.prototype,\"renderingRule\",null),d=e([i(\"esri.layers.mixins.ExportImageServiceParameters\")],d);export{d as ExportImageServiceParameters};\n"]},"metadata":{},"sourceType":"module"}