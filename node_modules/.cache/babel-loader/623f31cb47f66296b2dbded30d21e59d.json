{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { TEXTURE_BINDING_BITMAP as e } from \"../definitions.js\";\nimport t from \"../VertexStream.js\";\nimport i from \"./WGLBrush.js\";\n\nconst s = {\n  nearest: {\n    defines: [],\n    samplingMode: 9728,\n    mips: !1\n  },\n  bilinear: {\n    defines: [],\n    samplingMode: 9729,\n    mips: !1\n  },\n  bicubic: {\n    defines: [\"bicubic\"],\n    samplingMode: 9729,\n    mips: !1\n  },\n  trilinear: {\n    defines: [],\n    samplingMode: 9987,\n    mips: !0\n  }\n},\n      n = (e, t, i) => {\n  if (\"dynamic\" === i.samplingMode) {\n    const {\n      state: i\n    } = e,\n          n = t.resolution / t.pixelRatio / i.resolution,\n          a = Math.round(e.pixelRatio) !== e.pixelRatio,\n          r = n > 1.05 || n < .95;\n    return i.rotation || r || a || t.isSourceScaled || t.rotation ? s.bilinear : s.nearest;\n  }\n\n  return s[i.samplingMode];\n};\n\nclass a extends i {\n  constructor() {\n    super(...arguments), this._desc = {\n      vsPath: \"raster/bitmap\",\n      fsPath: \"raster/bitmap\",\n      attributes: new Map([[\"a_position\", 0], [\"a_texcoord\", 1]])\n    };\n  }\n\n  dispose() {\n    this._quad && this._quad.dispose();\n  }\n\n  prepareState({\n    context: e\n  }, t) {\n    e.setBlendingEnabled(!0), \"additive\" === t.blendFunction ? e.setBlendFunctionSeparate(1, 1, 1, 1) : e.setBlendFunctionSeparate(1, 771, 1, 771), e.setColorMask(!0, !0, !0, !0), e.setStencilWriteMask(0), e.setStencilTestEnabled(!0), e.setStencilFunction(514, t.stencilRef, 255);\n  }\n\n  draw(i, s) {\n    const {\n      context: a,\n      renderingOptions: r,\n      painter: o\n    } = i;\n    if (!s.source) return;\n    i.timeline.begin(this.name), this._quad || (this._quad = new t(a, [0, 0, 1, 0, 0, 1, 1, 1]));\n    const d = n(i, s, r),\n          c = o.materialManager.getProgram(i, this._desc, d.defines),\n          {\n      coordScale: l,\n      computedOpacity: m,\n      transforms: p\n    } = s;\n    s.setSamplingProfile(d), s.bind(i.context, e), a.useProgram(c), c.setUniformMatrix3fv(\"u_dvsMat3\", p.dvs), c.setUniform1i(\"u_texture\", e), c.setUniform2fv(\"u_coordScale\", l), c.setUniform1f(\"u_opacity\", m), this._quad.draw(), i.timeline.end(this.name);\n  }\n\n}\n\nexport default a;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/BrushBitmap.js"],"names":["TEXTURE_BINDING_BITMAP","e","t","i","s","nearest","defines","samplingMode","mips","bilinear","bicubic","trilinear","n","state","resolution","pixelRatio","a","Math","round","r","rotation","isSourceScaled","constructor","arguments","_desc","vsPath","fsPath","attributes","Map","dispose","_quad","prepareState","context","setBlendingEnabled","blendFunction","setBlendFunctionSeparate","setColorMask","setStencilWriteMask","setStencilTestEnabled","setStencilFunction","stencilRef","draw","renderingOptions","painter","o","source","timeline","begin","name","d","c","materialManager","getProgram","coordScale","l","computedOpacity","m","transforms","p","setSamplingProfile","bind","useProgram","setUniformMatrix3fv","dvs","setUniform1i","setUniform2fv","setUniform1f","end"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{TEXTURE_BINDING_BITMAP as e}from\"../definitions.js\";import t from\"../VertexStream.js\";import i from\"./WGLBrush.js\";const s={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:[\"bicubic\"],samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}},n=(e,t,i)=>{if(\"dynamic\"===i.samplingMode){const{state:i}=e,n=t.resolution/t.pixelRatio/i.resolution,a=Math.round(e.pixelRatio)!==e.pixelRatio,r=n>1.05||n<.95;return i.rotation||r||a||t.isSourceScaled||t.rotation?s.bilinear:s.nearest}return s[i.samplingMode]};class a extends i{constructor(){super(...arguments),this._desc={vsPath:\"raster/bitmap\",fsPath:\"raster/bitmap\",attributes:new Map([[\"a_position\",0],[\"a_texcoord\",1]])}}dispose(){this._quad&&this._quad.dispose()}prepareState({context:e},t){e.setBlendingEnabled(!0),\"additive\"===t.blendFunction?e.setBlendFunctionSeparate(1,1,1,1):e.setBlendFunctionSeparate(1,771,1,771),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0),e.setStencilFunction(514,t.stencilRef,255)}draw(i,s){const{context:a,renderingOptions:r,painter:o}=i;if(!s.source)return;i.timeline.begin(this.name),this._quad||(this._quad=new t(a,[0,0,1,0,0,1,1,1]));const d=n(i,s,r),c=o.materialManager.getProgram(i,this._desc,d.defines),{coordScale:l,computedOpacity:m,transforms:p}=s;s.setSamplingProfile(d),s.bind(i.context,e),a.useProgram(c),c.setUniformMatrix3fv(\"u_dvsMat3\",p.dvs),c.setUniform1i(\"u_texture\",e),c.setUniform2fv(\"u_coordScale\",l),c.setUniform1f(\"u_opacity\",m),this._quad.draw(),i.timeline.end(this.name)}}export default a;\n"]},"metadata":{},"sourceType":"module"}