{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { PinchAndPanController as t } from \"../../state/controllers/global/PinchAndPanController.js\";\nimport { PinchAndPanController as e } from \"../../state/controllers/local/PinchAndPanController.js\";\nimport { InputHandler as s } from \"../../../input/InputHandler.js\";\nimport { eventMatchesMousePointerAction as r } from \"../../../input/handlers/support.js\";\n\nclass i extends s {\n  constructor(t, e, s) {\n    super(!0), this.view = t, this.pointerAction = e, this.lastEndTimestamp = 0, this.lastTimestamp = 0, this.registerIncoming(\"drag\", s, t => this.handleDrag(t));\n  }\n\n  handleDrag(t) {\n    if (\"mouse\" === t.data.pointerType && !r(t.data, this.pointerAction)) return;\n    const e = t.timestamp - this.lastEndTimestamp,\n          s = 40,\n          i = this.momentum && this.momentum.active && e < s;\n\n    switch (t.data.action) {\n      case \"start\":\n      case \"update\":\n        if (i) break;\n        this.controller && this.controller.active ? t.data.timestamp - this.lastTimestamp > 2 && (this.controller.update(t.data), this.lastTimestamp = t.timestamp) : this.startController(t);\n        break;\n\n      case \"end\":\n      case \"removed\":\n        this.endController(t, !0);\n        break;\n\n      case \"added\":\n        this.endController(t, !1), this.startController(t);\n    }\n\n    t.stopPropagation();\n  }\n\n  endController(t, e) {\n    if (this.controller && this.controller.active) {\n      this.lastEndTimestamp = t.timestamp;\n      const s = this.controller.end(t.data);\n      e && s && (this.momentum = s, this.view.state.switchCameraController(this.momentum));\n    }\n\n    this.controller = null;\n  }\n\n  startController(t) {\n    this.controller = this.createController(), this.view.state.switchCameraController(this.controller), this.controller.begin(t.data), this.lastTimestamp = t.timestamp;\n  }\n\n  createController() {\n    return this.view.state.isGlobal ? new t({\n      view: this.view\n    }) : new e({\n      view: this.view\n    });\n  }\n\n}\n\nexport { i as PinchAndPanNavigation };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/views/3d/input/handlers/PinchAndPanNavigation.js"],"names":["PinchAndPanController","t","e","InputHandler","s","eventMatchesMousePointerAction","r","i","constructor","view","pointerAction","lastEndTimestamp","lastTimestamp","registerIncoming","handleDrag","data","pointerType","timestamp","momentum","active","action","controller","update","startController","endController","stopPropagation","end","state","switchCameraController","createController","begin","isGlobal","PinchAndPanNavigation"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{PinchAndPanController as t}from\"../../state/controllers/global/PinchAndPanController.js\";import{PinchAndPanController as e}from\"../../state/controllers/local/PinchAndPanController.js\";import{InputHandler as s}from\"../../../input/InputHandler.js\";import{eventMatchesMousePointerAction as r}from\"../../../input/handlers/support.js\";class i extends s{constructor(t,e,s){super(!0),this.view=t,this.pointerAction=e,this.lastEndTimestamp=0,this.lastTimestamp=0,this.registerIncoming(\"drag\",s,(t=>this.handleDrag(t)))}handleDrag(t){if(\"mouse\"===t.data.pointerType&&!r(t.data,this.pointerAction))return;const e=t.timestamp-this.lastEndTimestamp,s=40,i=this.momentum&&this.momentum.active&&e<s;switch(t.data.action){case\"start\":case\"update\":if(i)break;this.controller&&this.controller.active?t.data.timestamp-this.lastTimestamp>2&&(this.controller.update(t.data),this.lastTimestamp=t.timestamp):this.startController(t);break;case\"end\":case\"removed\":this.endController(t,!0);break;case\"added\":this.endController(t,!1),this.startController(t)}t.stopPropagation()}endController(t,e){if(this.controller&&this.controller.active){this.lastEndTimestamp=t.timestamp;const s=this.controller.end(t.data);e&&s&&(this.momentum=s,this.view.state.switchCameraController(this.momentum))}this.controller=null}startController(t){this.controller=this.createController(),this.view.state.switchCameraController(this.controller),this.controller.begin(t.data),this.lastTimestamp=t.timestamp}createController(){return this.view.state.isGlobal?new t({view:this.view}):new e({view:this.view})}}export{i as PinchAndPanNavigation};\n"]},"metadata":{},"sourceType":"module"}