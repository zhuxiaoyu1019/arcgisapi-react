{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from \"../../../../../Color.js\";\nimport { interpolate as e } from \"../GeometryUtils.js\";\nimport { ops as r, createExpression as i, Interpolate as a, Zoom as l } from \"../expression/expression.js\";\nimport { arrayType as s, ValueType as o, valueToString as n, NumberType as u, ColorType as p, StringType as d, BooleanType as f } from \"../expression/types.js\";\n\nclass h {\n  constructor(t, e) {\n    let n;\n\n    switch (this.isDataDriven = !1, this.interpolator = null, t.type) {\n      case \"number\":\n      case \"color\":\n        n = !0;\n        break;\n\n      case \"array\":\n        n = \"number\" === t.value;\n        break;\n\n      default:\n        n = !1;\n    }\n\n    if (null == e && (e = t.default), Array.isArray(e) && e.length > 0 && r[e[0]]) {\n      const r = {\n        number: u,\n        color: p,\n        string: d,\n        boolean: f,\n        enum: d\n      };\n\n      try {\n        const n = \"array\" === t.type ? s(r[t.value] || o, t.length) : r[t.type],\n              u = i(e, null, n);\n        this.getValue = this._buildExpression(u, t), this.isDataDriven = !0, u instanceof a && u.input instanceof l && (this.interpolator = u);\n      } catch (c) {\n        console.log(c.message), this.getValue = this._buildSimple(t.default);\n      }\n\n      return;\n    }\n\n    n && \"interval\" === e.type && (n = !1);\n    const h = e && e.stops && e.stops.length > 0;\n    if (h) for (const r of e.stops) r[1] = this._validate(r[1], t);\n    if (this.isDataDriven = !!e && !!e.property, this.isDataDriven) {\n      if (void 0 !== e.default && (e.default = this._validate(e.default, t)), h) switch (e.type) {\n        case \"identity\":\n          this.getValue = this._buildIdentity(e, t);\n          break;\n\n        case \"categorical\":\n          this.getValue = this._buildCategorical(e, t);\n          break;\n\n        default:\n          this.getValue = n ? this._buildInterpolate(e, t) : this._buildInterval(e, t);\n      } else this.getValue = this._buildIdentity(e, t);\n    } else h ? this.getValue = n ? this._buildZoomInterpolate(e) : this._buildZoomInterval(e) : (e = this._validate(e, t), this.getValue = this._buildSimple(e));\n  }\n\n  _validate(t, e) {\n    if (\"number\" === e.type) {\n      if (t < e.minimum) return e.minimum;\n      if (t > e.maximum) return e.maximum;\n    } else \"color\" === e.type ? t = h._parseColor(t) : \"enum\" === e.type ? \"string\" == typeof t && (t = e.values.indexOf(t)) : \"array\" === e.type && \"enum\" === e.value ? t = t.map(r => \"string\" == typeof t ? e.values.indexOf(r) : r) : \"string\" === e.type && (t = n(t));\n\n    return t;\n  }\n\n  _buildSimple(t) {\n    return () => t;\n  }\n\n  _buildExpression(t, e) {\n    return (r, i) => {\n      try {\n        const a = t.evaluate(i, r);\n        return void 0 === a ? e.default : this._validate(a, e);\n      } catch (a) {\n        return console.log(a.message), e.default;\n      }\n    };\n  }\n\n  _buildIdentity(t, e) {\n    return (r, i) => {\n      let a;\n      return i && (a = i.values[t.property]), void 0 !== a ? this._validate(a, e) : void 0 !== t.default ? t.default : e.default;\n    };\n  }\n\n  _buildCategorical(t, e) {\n    return (r, i) => {\n      let a;\n      return i && (a = i.values[t.property]), a = this._categorical(a, t.stops), void 0 !== a ? a : void 0 !== t.default ? t.default : e.default;\n    };\n  }\n\n  _buildInterval(t, e) {\n    return (r, i) => {\n      let a;\n      return i && (a = i.values[t.property]), \"number\" == typeof a ? this._interval(a, t.stops) : void 0 !== t.default ? t.default : e.default;\n    };\n  }\n\n  _buildInterpolate(t, e) {\n    return (r, i) => {\n      let a;\n      return i && (a = i.values[t.property]), \"number\" == typeof a ? this._interpolate(a, t.stops, t.base || 1) : void 0 !== t.default ? t.default : e.default;\n    };\n  }\n\n  _buildZoomInterpolate(t) {\n    return e => this._interpolate(e, t.stops, t.base || 1);\n  }\n\n  _buildZoomInterval(t) {\n    return e => this._interval(e, t.stops);\n  }\n\n  _categorical(t, e) {\n    const r = e.length;\n\n    for (let i = 0; i < r; i++) if (e[i][0] === t) return e[i][1];\n  }\n\n  _interval(t, e) {\n    const r = e.length;\n    let i = 0;\n\n    for (let a = 0; a < r && e[a][0] <= t; a++) i = a;\n\n    return e[i][1];\n  }\n\n  _interpolate(t, r, i) {\n    let a, l;\n    const s = r.length;\n\n    for (let e = 0; e < s; e++) {\n      const i = r[e];\n\n      if (!(i[0] <= t)) {\n        l = i;\n        break;\n      }\n\n      a = i;\n    }\n\n    if (a && l) {\n      const r = l[0] - a[0],\n            s = t - a[0],\n            o = 1 === i ? s / r : (i ** s - 1) / (i ** r - 1);\n\n      if (Array.isArray(a[1])) {\n        const t = a[1],\n              r = l[1],\n              i = [];\n\n        for (let a = 0; a < t.length; a++) i.push(e(t[a], r[a], o));\n\n        return i;\n      }\n\n      return e(a[1], l[1], o);\n    }\n\n    return a ? a[1] : l ? l[1] : void 0;\n  }\n\n  static _isEmpty(t) {\n    for (const e in t) if (t.hasOwnProperty(e)) return !1;\n\n    return !0;\n  }\n\n  static _parseColor(e) {\n    return Array.isArray(e) ? e : (\"string\" == typeof e && (e = new t(e)), e instanceof t ? this._isEmpty(e) ? void 0 : t.toUnitRGBA(e) : e);\n  }\n\n}\n\nexport default h;","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgisapi-react/node_modules/@arcgis/core/views/2d/engine/vectorTiles/style/StyleProperty.js"],"names":["t","interpolate","e","ops","r","createExpression","i","Interpolate","a","Zoom","l","arrayType","s","ValueType","o","valueToString","n","NumberType","u","ColorType","p","StringType","d","BooleanType","f","h","constructor","isDataDriven","interpolator","type","value","default","Array","isArray","length","number","color","string","boolean","enum","getValue","_buildExpression","input","c","console","log","message","_buildSimple","stops","_validate","property","_buildIdentity","_buildCategorical","_buildInterpolate","_buildInterval","_buildZoomInterpolate","_buildZoomInterval","minimum","maximum","_parseColor","values","indexOf","map","evaluate","_categorical","_interval","_interpolate","base","push","_isEmpty","hasOwnProperty","toUnitRGBA"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from\"../../../../../Color.js\";import{interpolate as e}from\"../GeometryUtils.js\";import{ops as r,createExpression as i,Interpolate as a,Zoom as l}from\"../expression/expression.js\";import{arrayType as s,ValueType as o,valueToString as n,NumberType as u,ColorType as p,StringType as d,BooleanType as f}from\"../expression/types.js\";class h{constructor(t,e){let n;switch(this.isDataDriven=!1,this.interpolator=null,t.type){case\"number\":case\"color\":n=!0;break;case\"array\":n=\"number\"===t.value;break;default:n=!1}if(null==e&&(e=t.default),Array.isArray(e)&&e.length>0&&r[e[0]]){const r={number:u,color:p,string:d,boolean:f,enum:d};try{const n=\"array\"===t.type?s(r[t.value]||o,t.length):r[t.type],u=i(e,null,n);this.getValue=this._buildExpression(u,t),this.isDataDriven=!0,u instanceof a&&u.input instanceof l&&(this.interpolator=u)}catch(c){console.log(c.message),this.getValue=this._buildSimple(t.default)}return}n&&\"interval\"===e.type&&(n=!1);const h=e&&e.stops&&e.stops.length>0;if(h)for(const r of e.stops)r[1]=this._validate(r[1],t);if(this.isDataDriven=!!e&&!!e.property,this.isDataDriven)if(void 0!==e.default&&(e.default=this._validate(e.default,t)),h)switch(e.type){case\"identity\":this.getValue=this._buildIdentity(e,t);break;case\"categorical\":this.getValue=this._buildCategorical(e,t);break;default:this.getValue=n?this._buildInterpolate(e,t):this._buildInterval(e,t)}else this.getValue=this._buildIdentity(e,t);else h?this.getValue=n?this._buildZoomInterpolate(e):this._buildZoomInterval(e):(e=this._validate(e,t),this.getValue=this._buildSimple(e))}_validate(t,e){if(\"number\"===e.type){if(t<e.minimum)return e.minimum;if(t>e.maximum)return e.maximum}else\"color\"===e.type?t=h._parseColor(t):\"enum\"===e.type?\"string\"==typeof t&&(t=e.values.indexOf(t)):\"array\"===e.type&&\"enum\"===e.value?t=t.map((r=>\"string\"==typeof t?e.values.indexOf(r):r)):\"string\"===e.type&&(t=n(t));return t}_buildSimple(t){return()=>t}_buildExpression(t,e){return(r,i)=>{try{const a=t.evaluate(i,r);return void 0===a?e.default:this._validate(a,e)}catch(a){return console.log(a.message),e.default}}}_buildIdentity(t,e){return(r,i)=>{let a;return i&&(a=i.values[t.property]),void 0!==a?this._validate(a,e):void 0!==t.default?t.default:e.default}}_buildCategorical(t,e){return(r,i)=>{let a;return i&&(a=i.values[t.property]),a=this._categorical(a,t.stops),void 0!==a?a:void 0!==t.default?t.default:e.default}}_buildInterval(t,e){return(r,i)=>{let a;return i&&(a=i.values[t.property]),\"number\"==typeof a?this._interval(a,t.stops):void 0!==t.default?t.default:e.default}}_buildInterpolate(t,e){return(r,i)=>{let a;return i&&(a=i.values[t.property]),\"number\"==typeof a?this._interpolate(a,t.stops,t.base||1):void 0!==t.default?t.default:e.default}}_buildZoomInterpolate(t){return e=>this._interpolate(e,t.stops,t.base||1)}_buildZoomInterval(t){return e=>this._interval(e,t.stops)}_categorical(t,e){const r=e.length;for(let i=0;i<r;i++)if(e[i][0]===t)return e[i][1]}_interval(t,e){const r=e.length;let i=0;for(let a=0;a<r&&e[a][0]<=t;a++)i=a;return e[i][1]}_interpolate(t,r,i){let a,l;const s=r.length;for(let e=0;e<s;e++){const i=r[e];if(!(i[0]<=t)){l=i;break}a=i}if(a&&l){const r=l[0]-a[0],s=t-a[0],o=1===i?s/r:(i**s-1)/(i**r-1);if(Array.isArray(a[1])){const t=a[1],r=l[1],i=[];for(let a=0;a<t.length;a++)i.push(e(t[a],r[a],o));return i}return e(a[1],l[1],o)}return a?a[1]:l?l[1]:void 0}static _isEmpty(t){for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}static _parseColor(e){return Array.isArray(e)?e:(\"string\"==typeof e&&(e=new t(e)),e instanceof t?this._isEmpty(e)?void 0:t.toUnitRGBA(e):e)}}export default h;\n"]},"metadata":{},"sourceType":"module"}