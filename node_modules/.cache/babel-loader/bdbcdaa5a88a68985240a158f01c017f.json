{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport \"../../../geometry.js\";\nimport e from \"../../../core/Error.js\";\nimport { isSome as n } from \"../../../core/maybe.js\";\nimport { getMetersPerUnitForSR as t } from \"../../../core/unitUtils.js\";\nimport { isLoaded as o, isSupported as r, load as i, getTransformation as a, project as s } from \"../../../geometry/projection.js\";\nimport { project as l } from \"../../../geometry/support/webMercatorUtils.js\";\nimport c from \"../../../geometry/Extent.js\";\nimport x from \"../../../geometry/Point.js\";\n\nconst m = 5e-4,\n      u = function (e, n) {\n  const t = (e.isWGS84 || e.isWebMercator) && (n.isWGS84 || n.isWebMercator);\n  return !(e.equals(n) || t);\n},\n      f = function (e, n) {\n  const t = (e[0] + e[4] + e[4 * n.cols] + e[4 * n.cols + 4]) / 4,\n        o = (e[1] + e[5] + e[4 * n.rows + 1] + e[4 * n.rows + 5]) / 4;\n  return [Math.abs(t - e[2 * n.rows + 2]), Math.abs(o - e[2 * n.rows + 3])];\n},\n      p = {\n  3395: 20037508.342789244,\n  3410: 17334193.943686873,\n  3832: 3339584.723798206,\n  3857: 20037508.342788905,\n  3975: 17367530.445161372,\n  4087: 20037508.342789244,\n  4088: 20015108.787169147,\n  6933: 17367530.445161372,\n  8858: 7396237.374497803,\n  8859: 2465412.4581659334,\n  32662: 20037508.342789244,\n  53001: 20015086.79602057,\n  53002: 10007543.39801029,\n  53003: 20015086.79602057,\n  53004: 20015086.79602057,\n  53016: 14152803.599503474,\n  53017: 17333573.624304302,\n  53025: 7276828.3848298555,\n  53031: 10384677.558821043,\n  53034: 20015086.79602057,\n  53036: 7389443.187332862,\n  53037: 2463147.729110953,\n  53079: 20015114.352186374,\n  53080: 20015114.352186374,\n  54001: 20037508.342789244,\n  54002: 10018754.171394624,\n  54003: 20037508.342789244,\n  54004: 20037508.342789244,\n  54016: 14168658.027268292,\n  54017: 17367530.44516137,\n  54025: 7311399.09166516,\n  54031: 10396310.810074743,\n  54034: 20037508.342789244,\n  54050: 808820.9223376509,\n  54053: 1920897.3915568967,\n  54079: 20037508.342789244,\n  54080: 20037508.342789244,\n  54099: 13524439.768288724,\n  54100: 20037508.342789244,\n  54101: 20037508.342789244,\n  102038: 4297258.582585486,\n  102299: 5013965.117483125\n},\n      h = 32;\n\nasync function y() {\n  if (o() || !r()) return null;\n  await i();\n}\n\nfunction M(n, t, r) {\n  if (!u(n.spatialReference, t)) return null;\n  if (!o()) throw new e(\"rasterprojectionhelper-projectResolution\", \"projection engine is not loaded\");\n  return r ? a(t, n.spatialReference, n) : a(n.spatialReference, t, n);\n}\n\nfunction g(n, t, r, i = null) {\n  if (n.spatialReference.equals(t)) return n;\n  const a = u(n.spatialReference, t);\n  if (a && !o()) throw new e(\"rasterprojectionhelper-projectResolution\", \"projection engine is not loaded\");\n  const x = r.center,\n        m = new c({\n    xmin: x.x - n.x / 2,\n    xmax: x.x + n.x / 2,\n    ymin: x.y - n.y / 2,\n    ymax: x.y + n.y / 2,\n    spatialReference: n.spatialReference\n  }),\n        f = a ? s(m, t, i) : l(m, t);\n  if (null == f) return null;\n  return {\n    x: f.xmax - f.xmin,\n    y: f.ymax - f.ymin\n  };\n}\n\nfunction d(e, n = .01) {\n  return t(e) ? n / t(e) : 0;\n}\n\nfunction w(n, t, r = null, i = !0) {\n  const a = n.spatialReference;\n  if (a.equals(t)) return n;\n  const c = u(a, t);\n  if (c && !o()) throw new e(\"rasterprojectionhelper-projectResolution\", \"projection engine is not loaded\");\n  const x = c ? s(n, t, r) : l(n, t);\n\n  if (x && i && t.isGeographic) {\n    const [e, t] = v(a, !0),\n          o = d(a);\n    o && null != e && null != t && (Math.abs(n.x - e) < o && Math.abs(180 - x.x) < m ? x.x -= 360 : Math.abs(n.x - t) < o && Math.abs(180 + x.x) < m && (x.x += 360));\n  }\n\n  return x;\n}\n\nfunction R(e) {\n  const t = S(e[0].spatialReference);\n  if (e.length < 2 || !n(t)) return e[0];\n  let {\n    xmin: o,\n    xmax: r,\n    ymin: i,\n    ymax: a\n  } = e[0];\n\n  for (let n = 1; n < e.length; n++) {\n    const o = e[n];\n    r = o.xmax + t * n, i = Math.min(i, o.ymin), a = Math.max(a, o.ymax);\n  }\n\n  return new c({\n    xmin: o,\n    xmax: r,\n    ymin: i,\n    ymax: a,\n    spatialReference: e[0].spatialReference\n  });\n}\n\nfunction j(e, t, o = null, r = !0) {\n  if (e.spatialReference.equals(t)) return e;\n  const i = W(e),\n        a = S(e.spatialReference, !0);\n  if (!n(a) || 0 === i) return b(e, t, o, r);\n  return R(e.clone().normalize().map(e => b(e, t, o, r)));\n}\n\nfunction b(n, t, r = null, i = !0) {\n  const a = n.spatialReference;\n  if (a.equals(t)) return n;\n  const c = u(a, t);\n  if (c && !o()) throw new e(\"rasterprojectionhelper-projectExtent\", \"projection engine is not loaded\");\n  const f = c ? s(n, t, r) : l(n, t);\n  let [p, h] = v(a, !0);\n\n  if (f && i && a.isWebMercator && t.isGeographic && null != p && null != h) {\n    const e = .001,\n          o = 1e3;\n\n    if (Math.abs(n.xmin - p) < e && Math.abs(h - n.xmax) > o && Math.abs(180 - f.xmax) < m) {\n      f.xmin = -180;\n      const e = [];\n      e.push(new x(n.xmax, n.ymin, a)), e.push(new x(n.xmax, (n.ymin + n.ymax) / 2, a)), e.push(new x(n.xmax, n.ymax, a));\n      const o = e.map(e => w(e, t, r)).filter(e => !isNaN(null == e ? void 0 : e.x)).map(e => e.x);\n      f.xmax = Math.max.apply(null, o);\n    }\n\n    if (Math.abs(n.xmax - h) < e && Math.abs(p - n.xmin) > o && Math.abs(180 + f.xmin) < m) {\n      f.xmax = 180;\n      const e = [];\n      e.push(new x(n.xmin, n.ymin, a)), e.push(new x(n.xmin, (n.ymin + n.ymax) / 2, a)), e.push(new x(n.xmin, n.ymax, a));\n      const o = e.map(e => w(e, t, r)).filter(e => !isNaN(null == e ? void 0 : e.x)).map(e => e.x);\n      f.xmin = Math.min.apply(null, o);\n    }\n  }\n\n  [p, h] = v(t, !0);\n  const y = d(t);\n  return y && null != p && null != h && (Math.abs(f.xmin - p) < y && (f.xmin = p), Math.abs(f.xmax - h) < y && (f.xmax = h)), f;\n}\n\nfunction S(e, n = !1) {\n  const t = n ? 20037508.342787 : 20037508.342788905;\n  return e.isWebMercator ? 2 * t : e.wkid && e.isGeographic ? 360 : 2 * p[e.wkid] || null;\n}\n\nfunction v(e, t = !1) {\n  const o = [],\n        r = S(e, t);\n  return n(r) && (o.push(-r / 2), o.push(r / 2)), o;\n}\n\nfunction N(e, n, t, o) {\n  let r = (e - n) / t;\n  return r - Math.floor(r) != 0 ? r = Math.floor(r) : o && (r -= 1), r;\n}\n\nfunction W(e, t = !1) {\n  const o = S(e.spatialReference);\n  if (!n(o)) return 0;\n  const r = t ? 0 : -(o / 2);\n  return N(e.xmax, r, o, !0) - N(e.xmin, r, o, !1);\n}\n\nfunction z(e) {\n  const t = e.storageInfo.origin.x,\n        o = S(e.spatialReference, !0);\n  if (!n(o)) return {\n    originX: t,\n    halfWorldWidth: null,\n    pyramidsInfo: null\n  };\n  const r = o / 2,\n        {\n    nativePixelSize: i,\n    storageInfo: a,\n    extent: s\n  } = e,\n        {\n    maximumPyramidLevel: l,\n    blockWidth: c,\n    pyramidScalingFactor: x\n  } = a;\n  let m = i.x;\n  const u = [],\n        f = n(e.transform) && \"gcs-shift\" === e.transform.type,\n        p = t + r,\n        h = f ? o - t : r - t;\n\n  for (let n = 0; n <= l; n++) {\n    const e = (s.xmax - t) / m / c,\n          n = e - Math.floor(e) == 0 ? e : Math.ceil(e),\n          r = (o / 2 - t) / m / c,\n          i = r - Math.floor(r) == 0 ? r : Math.ceil(r),\n          a = Math.floor(p / m / c),\n          l = Math.round(p / m) % c,\n          f = (c - Math.round(h / m) % c) % c;\n    u.push({\n      resolutionX: m,\n      blockWidth: c,\n      datsetColumnCount: n,\n      worldColumnCountFromOrigin: i,\n      leftMargin: l,\n      rightPadding: f,\n      originColumnOffset: a\n    }), m *= x;\n  }\n\n  return {\n    originX: t,\n    halfWorldWidth: r,\n    pyramidsInfo: u,\n    hasGCSSShiftTransform: f\n  };\n}\n\nfunction G(t, r, i, a = null, s = null, l = !1, c = [h, h]) {\n  if (u(t.spatialReference, r.spatialReference) && !o()) throw new e(\"rasterprojectionhelper-projectResolution\", \"projection engine is not loaded\");\n  if (!(t && r && i)) return null;\n  const {\n    xmin: m,\n    ymin: p,\n    xmax: y,\n    ymax: M\n  } = t,\n        g = t.spatialReference,\n        d = r.spatialReference,\n        R = S(d);\n  l = l || \"gcs-shift\" === (null == s ? void 0 : s.type);\n  const j = {\n    x: c[0] * i.x,\n    y: c[1] * i.y\n  },\n        b = {\n    cols: Math.ceil((y - m) / j.x - .1) + 1,\n    rows: Math.ceil((M - p) / j.y - .1) + 1\n  },\n        v = j.x,\n        N = j.y,\n        W = [];\n  let z,\n      G = !1;\n\n  for (let e = 0; e < b.cols; e++) {\n    const t = [];\n\n    for (let o = 0; o < b.rows; o++) {\n      let i = w(new x({\n        x: m + v * e,\n        y: M - N * o,\n        spatialReference: g\n      }), d, a);\n      s && (i = s.inverseTransform(i)), t.push(i), e > 0 && l && i && z[o] && n(R) && i.x < z[o].x && (i.x += R), i ? (W.push((i.x - r.xmin) / (r.xmax - r.xmin)), W.push((r.ymax - i.y) / (r.ymax - r.ymin))) : (W.push(NaN), W.push(NaN), G = !0);\n    }\n\n    z = t;\n  }\n\n  const P = f(W, b),\n        C = new Float32Array((b.cols - 1) * (b.rows - 1) * 2 * 6),\n        L = new Float32Array([-0, -1, 1, -1, 1, -0, 1, -0, -0]),\n        k = new Float32Array([-1, 1, 0, 0, -1, 1, 1, 0, 0]);\n\n  for (let e = 0; e < b.cols - 1; e++) {\n    for (let n = 0; n < b.rows - 1; n++) {\n      let t = e * b.rows * 2 + 2 * n;\n      const o = W[t],\n            r = W[t + 1],\n            i = W[t + 2],\n            a = W[t + 3];\n      t += 2 * b.rows;\n      const s = W[t],\n            l = W[t + 1],\n            c = W[t + 2],\n            x = W[t + 3];\n      let m = 0,\n          u = 12 * (n * (b.cols - 1) + e);\n\n      for (let e = 0; e < 3; e++) C[u++] = L[m++] * o + L[m++] * i + L[m++] * c;\n\n      m = 0;\n\n      for (let e = 0; e < 3; e++) C[u++] = L[m++] * r + L[m++] * a + L[m++] * x;\n\n      m = 0;\n\n      for (let e = 0; e < 3; e++) C[u++] = k[m++] * o + k[m++] * s + k[m++] * c;\n\n      m = 0;\n\n      for (let e = 0; e < 3; e++) C[u++] = k[m++] * r + k[m++] * l + k[m++] * x;\n    }\n\n    if (G) for (let e = 0; e < C.length; e++) isNaN(C[e]) && (C[e] = -1);\n  }\n\n  return {\n    offsets: W,\n    error: P,\n    coefficients: C,\n    spacing: c,\n    size: [b.cols - 1, b.rows - 1]\n  };\n}\n\nfunction P(e) {\n  const n = e.clone().normalize();\n  return 1 === n.length ? n[0] : R(n);\n}\n\nfunction C(e, t, o) {\n  const {\n    storageInfo: r,\n    pixelSize: i\n  } = t;\n  let a,\n      s = !1;\n  const {\n    pyramidResolutions: l\n  } = r;\n\n  if (n(l) && l.length) {\n    const n = (e.x + e.y) / 2,\n          r = l[l.length - 1],\n          c = (r.x + r.y) / 2,\n          m = (i.x + i.y) / 2;\n    if (n <= m) a = 0;else if (n >= c) a = l.length, s = n / c > 8;else {\n      let e,\n          t = m;\n\n      for (let r = 1; r <= l.length; r++) {\n        if (e = (l[r - 1].x + l[r - 1].y) / 2, n <= e) {\n          n === e ? a = r : \"down\" === o ? (a = r - 1, s = n / t > 8) : a = \"up\" === o || n - t > e - n || n / t > 2 ? r : r - 1;\n          break;\n        }\n\n        t = e;\n      }\n    }\n    const u = 0 === a ? i : l[a - 1];\n    return {\n      pyramidLevel: a,\n      pyramidResolution: new x({\n        x: u.x,\n        y: u.y,\n        spatialReference: t.spatialReference\n      }),\n      excessiveReading: s\n    };\n  }\n\n  const c = Math.log(e.x / i.x) / Math.LN2,\n        m = Math.log(e.y / i.y) / Math.LN2,\n        u = t.storageInfo.maximumPyramidLevel || 0;\n  a = \"down\" === o ? Math.floor(Math.min(c, m)) : \"up\" === o ? Math.ceil(Math.max(c, m)) : Math.round((c + m) / 2), a < 0 ? a = 0 : a > u && (s = a > u + 3, a = u);\n  const f = 2 ** a;\n  return {\n    pyramidLevel: a,\n    pyramidResolution: new x({\n      x: f * t.nativePixelSize.x,\n      y: f * t.nativePixelSize.y,\n      spatialReference: t.spatialReference\n    }),\n    excessiveReading: s\n  };\n}\n\nfunction L(e, n, o = 512, r = !0) {\n  const {\n    extent: i,\n    spatialReference: a,\n    pixelSize: s\n  } = e,\n        l = g(new x({\n    x: s.x,\n    y: s.y,\n    spatialReference: a\n  }), n, i);\n  if (null == l) return {\n    projectedPixelSize: null,\n    scales: null,\n    srcResolutions: null,\n    isCustomTilingScheme: !1\n  };\n  const c = (l.x + l.y) / 2,\n        m = t(n),\n        u = c * m * 96 * 39.37,\n        f = n.isGeographic ? 256 / o * 295828763.7958547 : 256 / o * 591657527.591555;\n  let p = !1;\n  const h = j(i, n);\n  r && (n.isGeographic || n.isWebMercator) && (p = h.xmin * h.xmax < 0);\n  let y,\n      M = u;\n  const d = 1.001;\n\n  if (p) {\n    M = f;\n    const e = n.isGeographic ? 1341104507446289e-21 : .29858214164761665,\n          t = e * (96 * m * 39.37),\n          o = n.isGeographic ? 4326 : 3857;\n    y = g(new x({\n      x: e,\n      y: e,\n      spatialReference: {\n        wkid: o\n      }\n    }), a, h), y.x *= M / t, y.y *= M / t;\n  } else {\n    y = {\n      x: s.x,\n      y: s.y\n    };\n    const n = Math.ceil(Math.log(Math.min(e.width, e.height) / 32) / Math.LN2);\n    let t = 0;\n\n    for (; M < f * (d / 2) && t < n;) t++, M *= 2, y.x *= 2, y.y *= 2;\n\n    Math.max(M, f) / Math.min(M, f) <= d && (M = f);\n  }\n\n  const w = [M],\n        R = [{\n    x: y.x,\n    y: y.y\n  }],\n        b = 70.5310735,\n        S = Math.min(b, u) / d;\n\n  for (; M >= S;) M /= 2, y.x /= 2, y.y /= 2, w.push(M), R.push({\n    x: y.x,\n    y: y.y\n  });\n\n  return {\n    projectedPixelSize: l,\n    scales: w,\n    srcResolutions: R,\n    isCustomTilingScheme: !p\n  };\n}\n\nexport { L as computeProjectedScales, h as defaultGridSpacing, M as getDefaultDatumTransformationForDataset, G as getProjectionOffsetGrid, z as getRasterDatasetAlignmentInfo, W as getWorldWrapCount, y as load, j as projectExtent, w as projectPoint, g as projectResolution, P as snapExtent, C as snapPyramid };","map":{"version":3,"sources":["/Users/xiaoyuzhu/Desktop/arcgis-api-react/node_modules/@arcgis/core/layers/support/rasterFunctions/rasterProjectionHelper.js"],"names":["e","isSome","n","getMetersPerUnitForSR","t","isLoaded","o","isSupported","r","load","i","getTransformation","a","project","s","l","c","x","m","u","isWGS84","isWebMercator","equals","f","cols","rows","Math","abs","p","h","y","M","spatialReference","g","center","xmin","xmax","ymin","ymax","d","w","isGeographic","v","R","S","length","min","max","j","W","b","clone","normalize","map","push","filter","isNaN","apply","wkid","N","floor","z","storageInfo","origin","originX","halfWorldWidth","pyramidsInfo","nativePixelSize","extent","maximumPyramidLevel","blockWidth","pyramidScalingFactor","transform","type","ceil","round","resolutionX","datsetColumnCount","worldColumnCountFromOrigin","leftMargin","rightPadding","originColumnOffset","hasGCSSShiftTransform","G","inverseTransform","NaN","P","C","Float32Array","L","k","offsets","error","coefficients","spacing","size","pixelSize","pyramidResolutions","pyramidLevel","pyramidResolution","excessiveReading","log","LN2","projectedPixelSize","scales","srcResolutions","isCustomTilingScheme","width","height","computeProjectedScales","defaultGridSpacing","getDefaultDatumTransformationForDataset","getProjectionOffsetGrid","getRasterDatasetAlignmentInfo","getWorldWrapCount","projectExtent","projectPoint","projectResolution","snapExtent","snapPyramid"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../../geometry.js\";import e from\"../../../core/Error.js\";import{isSome as n}from\"../../../core/maybe.js\";import{getMetersPerUnitForSR as t}from\"../../../core/unitUtils.js\";import{isLoaded as o,isSupported as r,load as i,getTransformation as a,project as s}from\"../../../geometry/projection.js\";import{project as l}from\"../../../geometry/support/webMercatorUtils.js\";import c from\"../../../geometry/Extent.js\";import x from\"../../../geometry/Point.js\";const m=5e-4,u=function(e,n){const t=(e.isWGS84||e.isWebMercator)&&(n.isWGS84||n.isWebMercator);return!(e.equals(n)||t)},f=function(e,n){const t=(e[0]+e[4]+e[4*n.cols]+e[4*n.cols+4])/4,o=(e[1]+e[5]+e[4*n.rows+1]+e[4*n.rows+5])/4;return[Math.abs(t-e[2*n.rows+2]),Math.abs(o-e[2*n.rows+3])]},p={3395:20037508.342789244,3410:17334193.943686873,3832:3339584.723798206,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,8858:7396237.374497803,8859:2465412.4581659334,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53025:7276828.3848298555,53031:10384677.558821043,53034:20015086.79602057,53036:7389443.187332862,53037:2463147.729110953,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54025:7311399.09166516,54031:10396310.810074743,54034:20037508.342789244,54050:808820.9223376509,54053:1920897.3915568967,54079:20037508.342789244,54080:20037508.342789244,54099:13524439.768288724,54100:20037508.342789244,54101:20037508.342789244,102038:4297258.582585486,102299:5013965.117483125},h=32;async function y(){if(o()||!r())return null;await i()}function M(n,t,r){if(!u(n.spatialReference,t))return null;if(!o())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");return r?a(t,n.spatialReference,n):a(n.spatialReference,t,n)}function g(n,t,r,i=null){if(n.spatialReference.equals(t))return n;const a=u(n.spatialReference,t);if(a&&!o())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");const x=r.center,m=new c({xmin:x.x-n.x/2,xmax:x.x+n.x/2,ymin:x.y-n.y/2,ymax:x.y+n.y/2,spatialReference:n.spatialReference}),f=a?s(m,t,i):l(m,t);if(null==f)return null;return{x:f.xmax-f.xmin,y:f.ymax-f.ymin}}function d(e,n=.01){return t(e)?n/t(e):0}function w(n,t,r=null,i=!0){const a=n.spatialReference;if(a.equals(t))return n;const c=u(a,t);if(c&&!o())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");const x=c?s(n,t,r):l(n,t);if(x&&i&&t.isGeographic){const[e,t]=v(a,!0),o=d(a);o&&null!=e&&null!=t&&(Math.abs(n.x-e)<o&&Math.abs(180-x.x)<m?x.x-=360:Math.abs(n.x-t)<o&&Math.abs(180+x.x)<m&&(x.x+=360))}return x}function R(e){const t=S(e[0].spatialReference);if(e.length<2||!n(t))return e[0];let{xmin:o,xmax:r,ymin:i,ymax:a}=e[0];for(let n=1;n<e.length;n++){const o=e[n];r=o.xmax+t*n,i=Math.min(i,o.ymin),a=Math.max(a,o.ymax)}return new c({xmin:o,xmax:r,ymin:i,ymax:a,spatialReference:e[0].spatialReference})}function j(e,t,o=null,r=!0){if(e.spatialReference.equals(t))return e;const i=W(e),a=S(e.spatialReference,!0);if(!n(a)||0===i)return b(e,t,o,r);return R(e.clone().normalize().map((e=>b(e,t,o,r))))}function b(n,t,r=null,i=!0){const a=n.spatialReference;if(a.equals(t))return n;const c=u(a,t);if(c&&!o())throw new e(\"rasterprojectionhelper-projectExtent\",\"projection engine is not loaded\");const f=c?s(n,t,r):l(n,t);let[p,h]=v(a,!0);if(f&&i&&a.isWebMercator&&t.isGeographic&&null!=p&&null!=h){const e=.001,o=1e3;if(Math.abs(n.xmin-p)<e&&Math.abs(h-n.xmax)>o&&Math.abs(180-f.xmax)<m){f.xmin=-180;const e=[];e.push(new x(n.xmax,n.ymin,a)),e.push(new x(n.xmax,(n.ymin+n.ymax)/2,a)),e.push(new x(n.xmax,n.ymax,a));const o=e.map((e=>w(e,t,r))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));f.xmax=Math.max.apply(null,o)}if(Math.abs(n.xmax-h)<e&&Math.abs(p-n.xmin)>o&&Math.abs(180+f.xmin)<m){f.xmax=180;const e=[];e.push(new x(n.xmin,n.ymin,a)),e.push(new x(n.xmin,(n.ymin+n.ymax)/2,a)),e.push(new x(n.xmin,n.ymax,a));const o=e.map((e=>w(e,t,r))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));f.xmin=Math.min.apply(null,o)}}[p,h]=v(t,!0);const y=d(t);return y&&null!=p&&null!=h&&(Math.abs(f.xmin-p)<y&&(f.xmin=p),Math.abs(f.xmax-h)<y&&(f.xmax=h)),f}function S(e,n=!1){const t=n?20037508.342787:20037508.342788905;return e.isWebMercator?2*t:e.wkid&&e.isGeographic?360:2*p[e.wkid]||null}function v(e,t=!1){const o=[],r=S(e,t);return n(r)&&(o.push(-r/2),o.push(r/2)),o}function N(e,n,t,o){let r=(e-n)/t;return r-Math.floor(r)!=0?r=Math.floor(r):o&&(r-=1),r}function W(e,t=!1){const o=S(e.spatialReference);if(!n(o))return 0;const r=t?0:-(o/2);return N(e.xmax,r,o,!0)-N(e.xmin,r,o,!1)}function z(e){const t=e.storageInfo.origin.x,o=S(e.spatialReference,!0);if(!n(o))return{originX:t,halfWorldWidth:null,pyramidsInfo:null};const r=o/2,{nativePixelSize:i,storageInfo:a,extent:s}=e,{maximumPyramidLevel:l,blockWidth:c,pyramidScalingFactor:x}=a;let m=i.x;const u=[],f=n(e.transform)&&\"gcs-shift\"===e.transform.type,p=t+r,h=f?o-t:r-t;for(let n=0;n<=l;n++){const e=(s.xmax-t)/m/c,n=e-Math.floor(e)==0?e:Math.ceil(e),r=(o/2-t)/m/c,i=r-Math.floor(r)==0?r:Math.ceil(r),a=Math.floor(p/m/c),l=Math.round(p/m)%c,f=(c-Math.round(h/m)%c)%c;u.push({resolutionX:m,blockWidth:c,datsetColumnCount:n,worldColumnCountFromOrigin:i,leftMargin:l,rightPadding:f,originColumnOffset:a}),m*=x}return{originX:t,halfWorldWidth:r,pyramidsInfo:u,hasGCSSShiftTransform:f}}function G(t,r,i,a=null,s=null,l=!1,c=[h,h]){if(u(t.spatialReference,r.spatialReference)&&!o())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");if(!(t&&r&&i))return null;const{xmin:m,ymin:p,xmax:y,ymax:M}=t,g=t.spatialReference,d=r.spatialReference,R=S(d);l=l||\"gcs-shift\"===(null==s?void 0:s.type);const j={x:c[0]*i.x,y:c[1]*i.y},b={cols:Math.ceil((y-m)/j.x-.1)+1,rows:Math.ceil((M-p)/j.y-.1)+1},v=j.x,N=j.y,W=[];let z,G=!1;for(let e=0;e<b.cols;e++){const t=[];for(let o=0;o<b.rows;o++){let i=w(new x({x:m+v*e,y:M-N*o,spatialReference:g}),d,a);s&&(i=s.inverseTransform(i)),t.push(i),e>0&&l&&i&&z[o]&&n(R)&&i.x<z[o].x&&(i.x+=R),i?(W.push((i.x-r.xmin)/(r.xmax-r.xmin)),W.push((r.ymax-i.y)/(r.ymax-r.ymin))):(W.push(NaN),W.push(NaN),G=!0)}z=t}const P=f(W,b),C=new Float32Array((b.cols-1)*(b.rows-1)*2*6),L=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),k=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let e=0;e<b.cols-1;e++){for(let n=0;n<b.rows-1;n++){let t=e*b.rows*2+2*n;const o=W[t],r=W[t+1],i=W[t+2],a=W[t+3];t+=2*b.rows;const s=W[t],l=W[t+1],c=W[t+2],x=W[t+3];let m=0,u=12*(n*(b.cols-1)+e);for(let e=0;e<3;e++)C[u++]=L[m++]*o+L[m++]*i+L[m++]*c;m=0;for(let e=0;e<3;e++)C[u++]=L[m++]*r+L[m++]*a+L[m++]*x;m=0;for(let e=0;e<3;e++)C[u++]=k[m++]*o+k[m++]*s+k[m++]*c;m=0;for(let e=0;e<3;e++)C[u++]=k[m++]*r+k[m++]*l+k[m++]*x}if(G)for(let e=0;e<C.length;e++)isNaN(C[e])&&(C[e]=-1)}return{offsets:W,error:P,coefficients:C,spacing:c,size:[b.cols-1,b.rows-1]}}function P(e){const n=e.clone().normalize();return 1===n.length?n[0]:R(n)}function C(e,t,o){const{storageInfo:r,pixelSize:i}=t;let a,s=!1;const{pyramidResolutions:l}=r;if(n(l)&&l.length){const n=(e.x+e.y)/2,r=l[l.length-1],c=(r.x+r.y)/2,m=(i.x+i.y)/2;if(n<=m)a=0;else if(n>=c)a=l.length,s=n/c>8;else{let e,t=m;for(let r=1;r<=l.length;r++){if(e=(l[r-1].x+l[r-1].y)/2,n<=e){n===e?a=r:\"down\"===o?(a=r-1,s=n/t>8):a=\"up\"===o||n-t>e-n||n/t>2?r:r-1;break}t=e}}const u=0===a?i:l[a-1];return{pyramidLevel:a,pyramidResolution:new x({x:u.x,y:u.y,spatialReference:t.spatialReference}),excessiveReading:s}}const c=Math.log(e.x/i.x)/Math.LN2,m=Math.log(e.y/i.y)/Math.LN2,u=t.storageInfo.maximumPyramidLevel||0;a=\"down\"===o?Math.floor(Math.min(c,m)):\"up\"===o?Math.ceil(Math.max(c,m)):Math.round((c+m)/2),a<0?a=0:a>u&&(s=a>u+3,a=u);const f=2**a;return{pyramidLevel:a,pyramidResolution:new x({x:f*t.nativePixelSize.x,y:f*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:s}}function L(e,n,o=512,r=!0){const{extent:i,spatialReference:a,pixelSize:s}=e,l=g(new x({x:s.x,y:s.y,spatialReference:a}),n,i);if(null==l)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const c=(l.x+l.y)/2,m=t(n),u=c*m*96*39.37,f=n.isGeographic?256/o*295828763.7958547:256/o*591657527.591555;let p=!1;const h=j(i,n);r&&(n.isGeographic||n.isWebMercator)&&(p=h.xmin*h.xmax<0);let y,M=u;const d=1.001;if(p){M=f;const e=n.isGeographic?1341104507446289e-21:.29858214164761665,t=e*(96*m*39.37),o=n.isGeographic?4326:3857;y=g(new x({x:e,y:e,spatialReference:{wkid:o}}),a,h),y.x*=M/t,y.y*=M/t}else{y={x:s.x,y:s.y};const n=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2);let t=0;for(;M<f*(d/2)&&t<n;)t++,M*=2,y.x*=2,y.y*=2;Math.max(M,f)/Math.min(M,f)<=d&&(M=f)}const w=[M],R=[{x:y.x,y:y.y}],b=70.5310735,S=Math.min(b,u)/d;for(;M>=S;)M/=2,y.x/=2,y.y/=2,w.push(M),R.push({x:y.x,y:y.y});return{projectedPixelSize:l,scales:w,srcResolutions:R,isCustomTilingScheme:!p}}export{L as computeProjectedScales,h as defaultGridSpacing,M as getDefaultDatumTransformationForDataset,G as getProjectionOffsetGrid,z as getRasterDatasetAlignmentInfo,W as getWorldWrapCount,y as load,j as projectExtent,w as projectPoint,g as projectResolution,P as snapExtent,C as snapPyramid};\n"]},"metadata":{},"sourceType":"module"}